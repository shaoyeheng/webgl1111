/*!
 * 
 * // ------------------------------------------
 * // geovisearth.sdk.js - 星图地球 Geovis Earth SDK 工具集
 * // 'VERSION_': "2.0.0"
 * // https://sdk.geovisearth.com/
 * // https://geovisearth.com/
 * // Copyright @中科星图 版权所有
 * // 版权所有 由中科星图股份有限公司与中科星图数字地球合肥有限公司联合运营
 * // -------------------------------------------
 *
 */(()=>{var __webpack_modules__={1071:(e,t,i)=>{"use strict";i.d(t,{Z:()=>d});var r=i(2188);function n(e,t){return e.map(((e,i)=>{if(null==e)return null;if(Array.isArray(e))return n(e,t);if(e.toJSON){if(void 0===e.ignoreDefualt)return e.toJSON(i.toString());{const r=e.ignoreDefualt;e.ignoreDefualt=t;const n=e.toJSON(i.toString());return e.ignoreDefualt=r,n}}return"object"==typeof e?o(e):e}))}function o(e,{defaultOptions:t,filterKeys:i,ignoreDefualt:r}={}){const s={};return Object.keys(e).filter((r=>{const n=r.startsWith("_")||r.startsWith("$"),o=!!i&&i.includes(r),s=!!t&&!function(e,t,i){return e in t&&(null===t[e]||(Array.isArray(t[e])?t[e].length!==i[e].length||!t[e].every(((t,r)=>t===i[e][r])):"object"==typeof t[e]||i[e]!==t[e]))}(r,t,e);return!(n||o||s)})).forEach((i=>{const a=t&&t[i];if(void 0===e[i]||null===e[i])s[i]=null;else if(Array.isArray(e[i]))s[i]=n(e[i],r);else if(e[i].toJSON)if(void 0===e[i].ignoreDefualt)s[i]=e[i].toJSON(i);else{const t=e[i].ignoreDefualt;e[i].ignoreDefualt=r,s[i]=e[i].toJSON(i),e[i].ignoreDefualt=t}else"object"==typeof e[i]?s[i]=o(e[i],{defaultOptions:a,ignoreDefualt:r}):s[i]=e[i]})),s}const s=o;function a(e,t){if(t=t||[],!Array.isArray(t))throw new Error("from json发生意外！");const i=new Array(e.length);e.forEach(((e,t)=>{Array.isArray(e)?i[t]=a(e,i[t]):i[t]="object"==typeof e?l(e,i[t]):e}));const r=10240;if(i.length>=r){let e=i.length,n=r,o=0;const s=new Array(r);for(;;){s.length=0;for(let e=o;e<n;++e)s.push(i[e]);if(t.push(...s),n>=e)break;o=n,n=n+r>e?e:n+r}}else t.splice(0,t.length,...i);return t}function l(e,t,i){return t=t||{},Object.keys(e).filter((e=>!(i&&i.includes(e)))).forEach((r=>{void 0===e[r]||null===e[r]?t[r]=void 0:Array.isArray(e[r])?t[r]=a(e[r],t[r]):"object"==typeof e[r]?(t[r]=t[r]||{},t[r].gvolFromJSON?t[r].gvolFromJSON(e[r]):l(e[r],t[r],i)):t[r]=e[r]})),t}const h=l;var c=i(637);const u=function(e,{positionProperty:t="position",rotationProperty:i="rotation",attachedPathGuidProperty:n="attachedPathGuid"}={}){void 0===e[n]&&(0,r.extendObservable)(e,{[n]:""});let o="_"+n+"_obj";(0,r.extendObservable)(e,{[o]:void 0},{[o]:r.observable.ref});let s=[];return s.push((0,r.reaction)((()=>{const t=e[o];return{position:t&&(t.currentPosition,1)?[...t.currentPosition]:void 0,rotation:t&&(t.currentRotation,1)?[...t.currentRotation]:void 0}}),(r=>{r.position&&e[t]&&(e[t]=r.position),r.rotation&&e[i]&&(e.isCameraLike?e[i]=r.rotation:e[i]=[r.rotation[0]-Cesium.Math.PI_OVER_TWO,r.rotation[1],r.rotation[2]])}))),s.push(e._earth.registerObjectFromGuid(e,n,o)),()=>{s.forEach((e=>e())),s.length=0}};class p{constructor(){(0,r.extendObservable)(this,this._defaultOptions),Object.keys(this._defaultOptions).forEach((e=>{Object.defineProperty(this,e,{configurable:!1})})),this.ignoreDefualt=!0,this._fromJsonFilterKeys=["ignoreDefualt"],this._toJsonFilterKeys=["ignoreDefualt"],(0,r.extendObservable)(this,{_isDestroying:!1,get isDestroying(){return this._isDestroying}},{isDestroying:r.computed}),this._gvolDisposers=[]}get fromJsonFilterKeys(){return this._fromJsonFilterKeys}get toJsonFilterKeys(){return this._toJsonFilterKeys}get _jsonSchema(){if(!this.constructor.gvolSchema)throw new Error("需要为类定义gvolSchema属性！");return this.constructor.gvolSchema}get _classification(){if(!this.constructor.gvolClassification)throw new Error("需要为类定义gvolClassification属性！");return this.constructor.gvolClassification}get _defaultOptions(){if(!this.constructor.defaultOptionsAccum||this.constructor.defaultOptionsAccum===this.constructor.__proto__.defaultOptionsAccum){const e=[];let t=this.__proto__;for(;t.constructor!==p;)e.push(t.constructor),t=t.__proto__;if(t.constructor!==p)throw new Error("currentProto迭代后必须为GvolBase！");e.push(t.constructor),e.reverse();const i={};e.forEach((e=>{e.defaultOptions&&Object.assign(i,e.defaultOptions)})),this.constructor.defaultOptionsAccum=i}return this.constructor.defaultOptionsAccum}get disposers(){return this._gvolDisposers}gvolFromJSON(e){e=Object.assign({},this._defaultOptions,e),p.jsonToPlainObject(e,this,this._fromJsonFilterKeys)}toJSON(e){const t=this._toJsonFilterKeys,i=this.ignoreDefualt?this._defaultOptions:void 0;return p.plainObjectToJSON(this,{defaultOptions:i,filterKeys:t,ignoreDefualt:this.ignoreDefualt})}toAllJSON(e){const t=this.ignoreDefualt;this.ignoreDefualt=!1;const i=this.toJSON(e);return this.ignoreDefualt=t,i}toJSONStr(){return JSON.stringify(this,void 0,"    ")}toAllJSONStr(){return JSON.stringify(this.toAllJSON(),void 0,"    ")}isDestroyed(){return!1}destroy(){return this._isDestroying=!0,this._gvolDisposers.reverse(),this._gvolDisposers.forEach((e=>e())),this._gvolDisposers.length=0,Cesium.destroyObject(this)}}p.plainObjectToJSON=s,p.jsonToPlainObject=h,p.registerProperty=c.gS,p.registerArrayProperty=c.aT,p.registerPosition=c.B$,p.registerRotation=c.DP,p.registerPathAttachedGuid=u;const d=p},637:(e,t,i)=>{"use strict";i.d(t,{aT:()=>u,B$:()=>h,gS:()=>a,DP:()=>c});var r=i(2188);const n={intercept:r.intercept,extendObservable:r.extendObservable,observable:r.observable};const o=function(e,t,i){return n.intercept(e,(e=>{if("splice"===e.type){const r=e.object;for(let t=0;t<e.removedCount;++t)i(r[t+e.index]);if(e.added=e.added.map((e=>t(e))),e.added.some((e=>void 0===e)))return}else if("update"===e.type){const r=e.object[e.index];i(r),e.newValue=t(e.newValue)}return e}))};var s=i(5108);function a(e,t,i){return(0,r.intercept)(e,t,(r=>{if("update"===r.type&&void 0!==r.newValue&&r.object.value!==r.newValue){const n=r.newValue&&r.newValue.toJSON&&r.newValue.toJSON()||r.newValue;if(e[t].gvolFromJSON)e[t].gvolFromJSON(n);else{const r=Object.assign({},i,n),o=e[t];Object.keys(r).forEach((e=>{e in o&&(o[e]=r[e])}))}}return null}))}function l(e,t){const i=[];return i.push((0,r.intercept)(e,t,(i=>("update"===i.type&&i.newValue&&Array.isArray(i.newValue)&&i.object.value!==i.newValue&&e[t].splice(0,e[t].length,...i.newValue),null)))),i.push((0,r.intercept)(e[t],(e=>"splice"===e.type&&e.removedCount!==e.added.length?(s.warn("❌ 数组赋值有误！"),null):e))),()=>{i.forEach((e=>e())),i.length=0}}function h(e,t="position"){return l(e,t)}function c(e,t="rotation"){return l(e,t)}function u(e,t,i,n){const s=[];return s.push((0,r.intercept)(e,t,(i=>("update"===i.type&&i.newValue&&Array.isArray(i.newValue)&&i.object.value!==i.newValue&&e[t].splice(0,e[t].length,...i.newValue),null)))),s.push(o(e[t],(e=>i(e)),(e=>{n(e)}))),()=>{s.forEach((e=>e())),s.length=0}}},7139:(e,t,i)=>{"use strict";i.d(t,{Z:()=>a});var r=i(3192),n=i(2188),o=i(5108);class s extends r.Z{constructor(e,t){super(e,t),this._changedEvent=new Cesium.Event;{const e=()=>{if(this.evalString){const e=this;try{Function('"use strict";return (function(p){'+this.evalString+"})")()(e)}catch(t){o.error(`对象-${e.name}(${e.guid})在执行evalString属性的命令时报错：${t}`)}}};e(),this.disposers.push((0,n.reaction)((()=>this.evalString),e))}{this._preUpdateEvent=void 0,this.disposers.push((()=>{this._preUpdateEvent=this._preUpdateEvent&&this._preUpdateEvent()}));const e=()=>{if(this._preUpdateEvent=this._preUpdateEvent&&this._preUpdateEvent(),this.preUpdateEvalString){const e=this,t=Function('"use strict";return (function(p, scene, time){'+this.preUpdateEvalString+"})")();this._preUpdateEvent=this._earth.czm.scene.preUpdate.addEventListener(((i,r)=>{try{t(e,i,r)}catch(t){o.error(`对象-${e.name}(${e.guid})在执行preUpdateEvalString属性的命令时报错：${t}`)}}))}};e(),this.disposers.push((0,n.reaction)((()=>this.preUpdateEvalString),e))}}get changed(){return o.error("changed已废弃，不要使用!"),this._changedEvent}onclick(){}onclickout(){}onmouseover(){}onmouseout(){}flyTo(){o.log("flyTo do nothing!")}destroy(){if(this.destroyEvalString){const e=this;try{Function('"use strict";return (function(p){'+this.destroyEvalString+"})")()(e)}catch(t){o.error(`对象-${e.name}(${e.guid})在执行destroyEvalString属性的命令时报错：${t}`)}}return super.destroy()}}s.defaultOptions={name:"未命名场景对象",allowPicking:!0,evalString:"",preUpdateEvalString:"",destroyEvalString:"",customProp:""},s.hierachyExec=function(e,t,...i){let r=e;for(;r;){if("function"==typeof r[t]){const n=r[t].call(e,...i);if("boolean"==typeof n&&!n)break}r=r.__proto__}};const a=s},3192:(e,t,i)=>{"use strict";i.d(t,{Z:()=>h});var r=i(2188),n=i(1071),o=i(5108);function s(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))}let a=0;class l extends n.Z{constructor(e,t){if(super(),this._ci=a++,e?this._earth=e:window.gm?this._earth=window.gm.engine:o.warn("警告：当前正在创建的GovlObject对象，没有可用的earth。"),(0,r.extendObservable)(this,{isSelected:!1}),this.gvolGuid=t||s(),this.fromJsonFilterKeys.push("gvolType","gvolGuid"),this._earth){if(this._earth._gvolObjectsMap.has(this.gvolGuid)&&(o.warn(`guid被修改，因为发现原guid已经存在！guid: ${this.gvolGuid}`),this.gvolGuid=s()),this._name=this.gvolGuid,this._earth._gvolObjectOpsEvent||(this._earth._gvolObjectOpsEvent=new Cesium.Event),this._earth._gvolObjectsMap.has(this.gvolGuid))throw new Error("对象的guid不能重复！");this._earth._gvolObjectsMap.set(this.gvolGuid,this),this._earth._gvolObjectOpsEvent.raiseEvent({type:"create",gvolObj:this})}else o.warn("警告：当前正在创建的GovlObject对象，没有指定earth。")}set name(e){this._name=e}get name(){return this._name}get earth(){return this._earth}get guid(){return this.gvolGuid}get gvolType(){if(!this.constructor.gvolType)throw new Error("需要为类定义gvolType属性！");return this.constructor.gvolType}initItem(e){throw new Error("Method not implemented.")}toJSON(e,t=!0){return{gvolType:this.gvolType,...super.toJSON(e,t)}}isDestroyed(){return!1}destroy(){return this._earth&&(this._earth._gvolObjectOpsEvent.raiseEvent({type:"destroy",gvolObj:this}),this._earth._gvolObjectsMap.delete(this.guid)),super.destroy()}}l.typesMap={},l.registerType=function(e,t,i="default"){e.gvolType=t,e.groupType=i,l.typesMap[t]&&o.warn("类型已存在！原类型将被覆盖！"),l.typesMap[t]=e},l.createObject=function(e,t,i,r=void 0){const n=l.typesMap[e];let o;return"Graph"===n.groupType?o=t.serviceManager.actionService.createDraw(r):"GraphicItem"===n.groupType?(o=new n(r),t.graphicLayer.add(o)):o=new n(t,i),o},l.defaultOptions={enabled:!0,gvolGuid:void 0};const h=l},2046:(e,t,i)=>{"use strict";i.d(t,{Z:()=>n});var r=i(2188);i(8588);const n=class{constructor(e,t){if(this._root=e,this._propertyName=t,this._props=t.split("."),this._root._isVue||this._root.$watch)this._type="vue";else if(Array.isArray(this.lastReactObject)&&(0,r.isObservable)(this.lastReactObject)&&(0,r.isObservable)(this.lastReactObject[this.lastPropertyName]))this._type="gvolReact";else{if(Array.isArray(this.lastReactObject)||!(0,r.isObservableProp)(this.lastReactObject,this.lastPropertyName))throw new Error("类型错误！");this._type="gvolReact"}}get type(){return this._type}get d(){const e=this._props.length;let t=this._root;for(let i=0;i<e;++i)t=t[this._props[i]];return t}set d(e){const t=this._props.length-1;let i=this._root;for(let e=0;e<t;++e)i=i[this._props[e]];Array.isArray(i)?i.splice(+this._props[t],1,e):i[this._props[t]]=e}get lastReactObject(){const e=this._props.length-1;let t=this._root;for(let i=0;i<e;++i)t=t[this._props[i]];return t}get lastPropertyName(){return this._props[this._props.length-1]}}},8660:(e,t,i)=>{"use strict";i.d(t,{Z:()=>n,j:()=>r.Z});var r=i(1930);const n=function(e,t,i,n,{r1Tor2:o,r2Tor1:s,equals:a}={}){const l=[];return l.push((0,r.Z)(e,t,i,n,{r2Tor1:s,equals:a})),l.push((0,r.Z)(i,n,e,t,{r2Tor1:o,equals:a?(e,t)=>a(t,e):void 0})),()=>{l.forEach((e=>e())),l.length=0}}},1930:(e,t,i)=>{"use strict";i.d(t,{Z:()=>h});var r=i(2188),n=i(2046),o=i(8588);const s=[];function a(e,t,i,r){Array.isArray(e.d)||(e.d=[]);const n=e.d,o=t.d;s.length=o.length;const a=i?i(o,s):o;(r?r(n,o):a.length===n.length&&a.every(((e,t)=>e===n[t])))||(e.type,a.some(((t,i)=>e.d[i]!==t))&&e.d.splice(0,e.d.length,...a))}function l(e,t,i,r){const n=e.d,o=t.d,s=i?i(o):o;(r?r(n,o):n===s)||(e.d=s)}const h=function(e,t,i,h,{r2Tor1:c,equals:u}={}){const p=new n.Z(e,t),d=new n.Z(i,h),m=[];if("gvolReact"===d.type){const e=()=>{void 0===d.d?p.d=void 0:(0,o.OI)(d.d)?d.d.length===p.d.length&&a(p,d,c,u):(0,o.tY)(d.d)?l(p,d,c,u):Array.isArray(d.d)?d.d.length===p.d.length&&("vue"===p.type?p.d=JSON.parse(JSON.stringify(d.d)):d.d.forEach(((e,t)=>p.d[t]=JSON.parse(JSON.stringify(e))))):p.d=JSON.parse(JSON.stringify(d.d))};let t,i;m.push((()=>i=i&&i()));const n=()=>{if((!t||d.d!==t)&&(t&&(i=i&&i(),t=void 0),Array.isArray(d.d))){if(Array.isArray(p.d)||(p.d=[]),t=d.d,Array.isArray(p.d)&&p.d.length!==d.d.length){s.length=t.length;const e=c?c(t,s):t;e.forEach(((t,i)=>{!(0,o.tY)(t)&&(e[i]=JSON.parse(JSON.stringify(t)))})),p.d.splice(0,p.d.length,...e)}i=(0,r.observe)(t,(e=>{if("splice"===e.type){if(e.added&&e.removed&&e.added.length===e.removed.length&&e.added.every(((t,i)=>e.removed[i]===t||isNaN(e.removed[i])&&isNaN(t))))return;s.length=t.length;const i=c?c(t,s):(s.splice(0,t.length,...t),s);let r=!1;if(r=u?u(p.d,i):i.length===p.d.length&&i.every(((e,t)=>(0,o.tY)(p.d[t])?p.d[t]===e:JSON.stringify(p.d[t])===JSON.stringify(e))),r)return;i.length=e.index+e.added.length,i.splice(0,e.index),i.forEach(((e,t)=>{!(0,o.tY)(e)&&(i[t]=JSON.parse(JSON.stringify(e)))}));const n=e.index,a=e.removedCount;p.d.splice(n,a,...i)}}))}};n(),e(),m.push((0,r.reaction)((()=>d.d),n)),m.push((0,r.reaction)((()=>void 0===d.d?void 0:(0,o.OI)(d.d)?[...d.d]:(0,o.tY)(d.d)?d.d:JSON.stringify(d.d)),e))}else if("vue"===d.type){const e=()=>{void 0===d.d?p.d=void 0:(0,o.OI)(d.d)?a(p,d,c,u):(0,o.tY)(d.d)?l(p,d,c,u):p.d=JSON.parse(JSON.stringify(d.d))};e(),m.push(i.$watch(h,e,{deep:!0}))}return()=>{m.forEach((e=>e())),m.length=0}}},4292:(e,t,i)=>{var r;void 0===(r=function(e){"use strict";var t=Cesium.defaultValue,i=Cesium.defined,r=Object.defineProperties,n=Cesium.DeveloperError,o=Cesium.Event,s=Cesium.createPropertyDescriptor,a=function(e){this._xHalfAngle=void 0,this._xHalfAngleSubscription=void 0,this._yHalfAngle=void 0,this._yHalfAngleSubscription=void 0,this._lateralSurfaceMaterial=void 0,this._lateralSurfaceMaterialSubscription=void 0,this._intersectionColor=void 0,this._intersectionColorSubscription=void 0,this._intersectionWidth=void 0,this._intersectionWidthSubscription=void 0,this._showIntersection=void 0,this._showIntersectionSubscription=void 0,this._radius=void 0,this._radiusSubscription=void 0,this._show=void 0,this._showSubscription=void 0,this._scanPlaneRate=void 0,this._scanPlaneColor=void 0,this._lineColor=void 0,this._showScanPlane=void 0,this._definitionChanged=new o,this.merge(t(e,t.EMPTY_OBJECT))};return r(a.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},xHalfAngle:s("xHalfAngle"),yHalfAngle:s("yHalfAngle"),lateralSurfaceMaterial:s("lateralSurfaceMaterial"),intersectionColor:s("intersectionColor"),intersectionWidth:s("intersectionWidth"),showIntersection:s("showIntersection"),radius:s("radius"),show:s("show"),scanPlaneRate:s("scanPlaneRate"),scanPlaneColor:s("scanPlaneColor"),lineColor:s("lineColor"),showScanPlane:s("showScanPlane")}),a.prototype.clone=function(e){return i(e)||(e=new a),e.xHalfAngle=this.xHalfAngle,e.yHalfAngle=this.yHalfAngle,e.radius=this.radius,e.show=this.show,e.showIntersection=this.showIntersection,e.intersectionColor=this.intersectionColor,e.intersectionWidth=this.intersectionWidth,e.lateralSurfaceMaterial=this.lateralSurfaceMaterial,e.scanPlaneRate=this.scanPlaneRate,e.scanPlaneColor=this.scanPlaneColor,e.lineColor=this.lineColor,e.showScanPlane=this.showScanPlane,e},a.prototype.merge=function(e){if(!i(e))throw new n("source is required.");this.xHalfAngle=t(this.xHalfAngle,e.xHalfAngle),this.yHalfAngle=t(this.yHalfAngle,e.yHalfAngle),this.radius=t(this.radius,e.radius),this.show=t(this.show,e.show),this.showIntersection=t(this.showIntersection,e.showIntersection),this.intersectionColor=t(this.intersectionColor,e.intersectionColor),this.intersectionWidth=t(this.intersectionWidth,e.intersectionWidth),this.scanPlaneRate=t(this.scanPlaneRate,e.scanPlaneRate),this.lateralSurfaceMaterial=t(this.lateralSurfaceMaterial,e.lateralSurfaceMaterial),this.scanPlaneColor=t(this.scanPlaneColor,e.scanPlaneColor),this.lineColor=t(this.lineColor,e.lineColor),this.showScanPlane=t(this.showScanPlane,e.showScanPlane)},a}.call(t,i,t,e))||(e.exports=r)},9495:(e,t,i)=>{"use strict";i.d(t,{Z:()=>r});const r=function(e,t){e.onclick=(...e)=>t.onclick&&t.onclick(...e),e.onclickout=(...e)=>t.onclickout&&t.onclickout(...e),e.onmouseover=(...e)=>t.onmouseover&&t.onmouseover(...e),e.onmouseout=(...e)=>t.onmouseout&&t.onmouseout(...e)}},9563:(e,t,i)=>{"use strict";i.d(t,{ZP:()=>P,lU:()=>w,mD:()=>d,V$:()=>f,Vy:()=>m,Ko:()=>A,vD:()=>g,qg:()=>y,wt:()=>v,ih:()=>C,Ak:()=>u,zC:()=>_,J_:()=>p});var r=i(2188),n=i(1071),o=i(8660);class s extends n.Z{constructor(e,t){super(),(0,r.extendObservable)(this,{position:[0,0,0]}),this._realObject=e,this._realProperty=t,this._unbind=(0,o.Z)(this,"position",e,t)}get realObject(){return this._realObject}get realProperty(){return this._realProperty}destroy(){return this._unbind=this._unbind&&this._unbind(),super.destroy()}}const a=s;class l extends n.Z{constructor(e,t,i){super(),(0,r.extendObservable)(this,{position:[0,0,0],rotation:[0,0,0]}),this._realObject=e,this._positionProperty=t,this._rotationProperty=i,this._disposers=[],this._disposers.push((0,o.Z)(this,"position",e,t)),this._disposers.push((0,o.Z)(this,"rotation",e,i))}get realObject(){return this._realObject}get positionProperty(){return this._realProperty}get rotationProperty(){return this._rotationProperty}destroy(){return this._disposers.forEach((e=>e())),this._disposers.lenght=0,super.destroy()}}const h=l;var c=i(1930);function u(e,t,{positionEditingProperty:i="positionEditing",positionProperty:n="position"}={}){(0,r.extendObservable)(t,{[i]:!1}),t.fromJsonFilterKeys.push(i);const o=[];let s;return"position"!==n?o.push((s=new a(t,n),()=>{s&&s.destroy(),s=void 0})):s=t,o.push((0,r.autorun)((()=>{t[i]=e.interaction.movableObjectBinding.target===s}))),o.push((0,r.reaction)((()=>t[i]),(()=>{t[i]||e.interaction.movableObjectBinding.target!==s?t[i]&&(e.interaction.movableObjectBinding.target=s):e.interaction.movableObjectBinding.target=void 0}),{fireImmediately:!0})),()=>{o.forEach((e=>e())),o.length=0}}function p(e,t,{rotationEditingProperty:i="rotationEditing",positionProperty:n="position",rotationProperty:o="rotation"}={}){(0,r.extendObservable)(t,{[i]:!1}),t.fromJsonFilterKeys.push(i);const s=[];let a;return"position"!==n||"rotation"!==o?s.push((a=new h(t,n,o),()=>{a&&a.destroy(),a=void 0})):a=t,s.push((0,r.autorun)((()=>{t[i]=e.interaction.rotatableObjectBinding.target===a}))),s.push((0,r.reaction)((()=>t[i]),(()=>{t[i]||e.interaction.rotatableObjectBinding.target!==a?t[i]&&(e.interaction.rotatableObjectBinding.target=a):e.interaction.rotatableObjectBinding.target=void 0}))),()=>{s.forEach((e=>e())),s.length=0}}function d(e,t,{positionHeightEditing:i="heightEditing",positionProperty:n="position"}){(0,r.extendObservable)(t,{[i]:!1}),t.fromJsonFilterKeys.push(i);const o=[];let s;"position"!==n?o.push((s=new a(t,n),()=>{s&&s.destroy(),s=void 0})):s=t,o.push((0,r.autorun)((()=>{e.interaction&&e.interaction.heightEditingBinding&&(t[i]=e.interaction.heightEditingBinding.target===s)})));const l=(t,i)=>{e.interaction&&e.interaction.heightEditingBinding&&(t[i]||e.interaction.heightEditingBinding.target!==s?t[i]&&(e.interaction.heightEditingBinding.target=s):e.interaction.heightEditingBinding.target=void 0)};return l(t,i),o.push((0,r.reaction)((()=>t[i]),(()=>{l(t,i)}))),()=>{o.forEach((e=>e())),o.length=0}}function m(e,t,{polygonCreatingWithHeight:i="creatingWithHeight"}){(0,r.extendObservable)(t,{[i]:!1}),t.fromJsonFilterKeys.push(i);const n=[];n.push((0,r.autorun)((()=>{e.interaction&&e.interaction.flattenedPolygonCreatingBinding&&(t[i]=e.interaction.flattenedPolygonCreatingBinding.target===t)})));const o=(t,i)=>{e.interaction&&e.interaction.flattenedPolygonCreatingBinding&&(t[i]||e.interaction.flattenedPolygonCreatingBinding.target!==t?t[i]&&(e.interaction.flattenedPolygonCreatingBinding.target=t):e.interaction.flattenedPolygonCreatingBinding.target=void 0)};return o(t,i),n.push((0,r.reaction)((()=>t[i]),(()=>{o(t,i)}))),()=>{n.forEach((e=>e())),n.length=0}}function f(e,t,{polygonCreating:i="creating"}){(0,r.extendObservable)(t,{[i]:!1}),t.fromJsonFilterKeys.push(i);const n=[];n.push((0,r.autorun)((()=>{e.interaction&&e.interaction.creatingPolygonBinding&&(t[i]=e.interaction.creatingPolygonBinding.target===t)})));const o=(t,i)=>{e.interaction&&e.interaction.creatingPolygonBinding&&(t[i]||e.interaction.creatingPolygonBinding.target!==t?t[i]&&(e.interaction.creatingPolygonBinding.target=t):e.interaction.creatingPolygonBinding.target=void 0)};return o(t,i),n.push((0,r.reaction)((()=>t[i]),(()=>{o(t,i)}))),()=>{n.forEach((e=>e())),n.length=0}}function g(e,t,{polygonHoleCreating:i="holeCreating"}){(0,r.extendObservable)(t,{[i]:!1}),t.fromJsonFilterKeys.push(i);const n=[];n.push((0,r.autorun)((()=>{e.interaction&&e.interaction.creatingPolygonHoleBinding&&(t[i]=e.interaction.creatingPolygonHoleBinding.target===t)})));const o=(t,i)=>{e.interaction&&e.interaction.creatingPolygonHoleBinding&&(t[i]||e.interaction.creatingPolygonHoleBinding.target!==t?t[i]&&(e.interaction.creatingPolygonHoleBinding.target=t):e.interaction.creatingPolygonHoleBinding.target=void 0)};return o(t,i),n.push((0,r.reaction)((()=>t[i]),(()=>{o(t,i)}))),()=>{n.forEach((e=>e())),n.length=0}}function A(e,t,{polygonEditingProperty:i="polygonEditing"}){(0,r.extendObservable)(t,{[i]:!1}),t.fromJsonFilterKeys.push(i);const n=[];n.push((0,r.autorun)((()=>{e.interaction&&e.interaction.editingPolygonBinding&&(t[i]=e.interaction.editingPolygonBinding.target===t)})));const o=(t,i)=>{e.interaction&&e.interaction.editingPolygonBinding&&(t[i]||e.interaction.editingPolygonBinding.target!==t?t[i]&&(e.interaction.editingPolygonBinding.target=t):e.interaction.editingPolygonBinding.target=void 0)};return o(t,i),n.push((0,r.reaction)((()=>t[i]),(()=>{o(t,i)}))),()=>{n.forEach((e=>e())),n.length=0}}function y(e,t,{polygonHoleEditingProperty:i="polygonHoleEditing"}){(0,r.extendObservable)(t,{[i]:!1}),t.fromJsonFilterKeys.push(i);const n=[];n.push((0,r.autorun)((()=>{e.interaction&&e.interaction.editingPolygonHoleBinding&&(t[i]=e.interaction.editingPolygonHoleBinding.target===t)})));const o=(t,i)=>{e.interaction&&e.interaction.editingPolygonHoleBinding&&(t[i]||e.interaction.editingPolygonHoleBinding.target!==t?t[i]&&(e.interaction.editingPolygonHoleBinding.target=t):e.interaction.editingPolygonHoleBinding.target=void 0)};return o(t,i),n.push((0,r.reaction)((()=>t[i]),(()=>{o(t,i)}))),()=>{n.forEach((e=>e())),n.length=0}}function v(e,t,{polylineCreatingProperty:i="creating"}){(0,r.extendObservable)(t,{[i]:!1}),t.fromJsonFilterKeys.push(i);const n=[];n.push((0,r.autorun)((()=>{e.interaction&&e.interaction&&(t[i]=e.interaction.creatingPolylineBinding.target===t)})));const o=(t,i)=>{e.interaction&&e.interaction.creatingPolylineBinding&&(t[i]||e.interaction.creatingPolylineBinding.target!==t?t[i]&&(e.interaction.creatingPolylineBinding.target=t):e.interaction.creatingPolylineBinding.target=void 0)};return o(t,i),n.push((0,r.reaction)((()=>t[i]),(()=>{o(t,i)}))),()=>{n.forEach((e=>e())),n.length=0}}function C(e,t,{polylineEditingProperty:i="polylineEditing"}){(0,r.extendObservable)(t,{[i]:!1}),t.fromJsonFilterKeys.push(i);const n=[];n.push((0,r.autorun)((()=>{e.interaction&&e.interaction.editingPolylineBinding&&(t[i]=e.interaction.editingPolylineBinding.target===t)})));const o=(t,i)=>{e.interaction&&e.interaction.editingPolylineBinding&&(t[i]||e.interaction.editingPolylineBinding.target!==t?t[i]&&(e.interaction.editingPolylineBinding.target=t):e.interaction.editingPolylineBinding.target=void 0)};return o(t,i),n.push((0,r.reaction)((()=>t[i]),(()=>{o(t,i)}))),()=>{n.forEach((e=>e())),n.length=0}}function _(e,t,{positionPickingProperty:i="positionPicking",positionProperty:n="position"}={}){(0,r.extendObservable)(t,{[i]:!1}),t.fromJsonFilterKeys.push(i);const o=[];let s;return"position"!==n?o.push((s=new a(t,n),()=>{s&&s.destroy(),s=void 0})):s=t,o.push((0,r.autorun)((()=>{t[i]=e.interaction.positionPickingBinding.target===s}))),o.push((0,r.reaction)((()=>t[i]),(()=>{t[i]||e.interaction.positionPickingBinding.target!==s?t[i]&&(e.interaction.positionPickingBinding.target=s):e.interaction.positionPickingBinding.target=void 0}))),()=>{o.forEach((e=>e())),o.length=0}}const b=function(e){const t=[];return t.push((0,c.Z)(e,"position",target,"position")),t.push((0,c.Z)(e,"rotation",target,"rotation")),t.push((0,c.Z)(e,"viewDistance",target,"viewDistance")),earth.camera.tracking.isCameraLike=target.isCameraLike,()=>{t.forEach((e=>e())),t.length=0}};function w(e,t,{cameraAttachedProperty:i="cameraAttached",cameraAttachedFunc:n=b}={}){(0,r.extendObservable)(t,{[i]:!1}),t.fromJsonFilterKeys.push(i),t.cameraTrackingFunc=n;const o=[];return o.push((0,r.autorun)((()=>{t[i]=e.interaction.cameraTrackingBinding.target===t}))),o.push((0,r.reaction)((()=>t[i]),(()=>{t[i]||e.interaction.cameraTrackingBinding.target!==t?t[i]&&(e.interaction.cameraTrackingBinding.target=t):e.interaction.cameraTrackingBinding.target=void 0}))),()=>{o.forEach((e=>e())),o.length=0}}const P={registerPositionEditing:u,registerRotationEditing:p,registerPolygonCreatingWithHeight:m,registerPolygonCreating:f,registerPolygonHoleCreating:g,registerPolygonEditing:A,registerPolygonHoleEditing:y,registerPolylineCreating:v,registerPolylineEditing:C,registerPositionPicking:_,registerCameraTracking:w,registerHeightEditing:d}},6452:(e,t,i)=>{"use strict";i.d(t,{Z:()=>l});var r=i(2188),n=i(3192),o=i(7139),s=i(9563);class a extends o.Z{constructor(e,t){super(e,t),this._primitive=this._earth.czm.scene.primitives.add(new Cesium.XbsjClippingPlane),this.disposers.push((()=>{this._primitive&&this._earth.czm.scene.primitives.remove(this._primitive),this._primitive=void 0})),this.disposers.push((0,r.autorun)((()=>{this._primitive.show=this.enabled&&this.show,this._primitive.longitude=this.position[0],this._primitive.latitude=this.position[1],this._primitive.height=this.position[2],this._primitive.heading=this.rotation[0],this._primitive.pitch=this.rotation[1],this._primitive.roll=this.rotation[2]}))),this.disposers.push((0,s.Ak)(this._earth,this)),this.disposers.push((0,s.J_)(this._earth,this)),this.disposers.push((0,s.zC)(this._earth,this,{positionPickingProperty:"creating"}))}get boundingSphere(){return this._boundingSphere}flyTo(){this._earth.czm.scene.camera.flyToBoundingSphere(new Cesium.BoundingSphere(Cesium.Cartesian3.fromRadians(...this.position),100))}}a.defaultOptions={position:[0,0,0],rotation:[0,0,0],showHelper:!1,show:!0},n.Z.registerType(a,"ClippingPlane");const l=a},6020:(e,t,i)=>{"use strict";i.d(t,{Z:()=>d});var r=i(2188),n=i(1071),o=i(7139),s=i(3192),a=i(9563),l=i(8572);class h extends n.Z{constructor(e){super(),this._earth=e,this._polygon=new l.Z(e),this.disposers.push((()=>{this._polygon=this._polygon&&this._polygon.destroy()})),this.disposers.push((0,r.autorun)((()=>{this._polygon.height=this.height}))),this.disposers.push((0,r.reaction)((()=>this.show&&this.showHelper),(e=>{this._polygon.show=e,this._polygon.showHelper=e}),{fireImmediately:!0})),this.disposers.push((0,r.reaction)((()=>[...this.positions]),(e=>{this._polygon.positions=e}),{fireImmediately:!0})),this.disposers.push((0,r.intercept)(this,"positions",(e=>{"update"===e.type&&e.newValue&&Array.isArray(e.newValue)&&this.positions.splice(0,this.positions.length,...e.newValue)}))),this.disposers.push((0,a.Vy)(this._earth,this,{polygonCreatingWithHeight:"creating"})),this.disposers.push((0,a.Ko)(this._earth,this,{polygonEditingProperty:"editing"}))}get boundingSphere(){return this._polygon&&this._polygon.boundingSphere}flyTo(){const e=this._earth.czm.scene.camera;0===this.boundingSphere.radius||Cesium.Cartesian3.magnitudeSquared(this.boundingSphere.center)<1e-4||e.flyToBoundingSphere(this.boundingSphere)}destroy(){return super.destroy()}}h.defaultOptions={positions:[],height:0,show:!0,showHelper:!1};h.gvolSchema={title:"FlattenedPolygon Property",type:"object",properties:{positions:{type:"array",items:{type:"number"},default:[],description:"位置数组"},height:{type:"number",title:"多边形高度",default:0,description:"多边形高度"},show:{type:"boolean",title:"是否在三维窗口中显示",default:!0,description:"是否在三维窗口中显示"},showHelper:{type:"boolean",title:"是否显示辅助线框",default:!0,description:"是否显示辅助线框"}}};h.gvolClassification=[{name:{chinese:"通用",english:"General"},properties:["positions","height","show","showHelper"]}];const c=h;var u=i(5108);class p extends o.Z{constructor(e,t){super(e,t),this._boundingSphere=void 0,(0,r.extendObservable)(this,{_flattenedPolygonTexture:void 0,get boundingSphere(){const e=this.polygons.map((e=>e.boundingSphere)).filter((e=>void 0!==e));return this._boundingSphere=Cesium.BoundingSphere.fromBoundingSpheres(e,this._boundingSphere),this._boundingSphere}},{_flattenedPolygonTexture:r.observable.ref,boundingSphere:r.computed}),this._flattenedPolygonTexture=this._earth.czm.viewer.gvolFlattenning.createFlattenedPolygonTexture();const i=this._flattenedPolygonTexture.getFlattenedPolygons();this._disposers=this._disposers||[],this._disposers.push((0,r.intercept)(this,"polygons",(e=>("update"===e.type&&e.newValue&&Array.isArray(e.newValue)&&e.object.value!==e.newValue&&this.polygons.splice(0,this.polygons.length,...e.newValue),null))));this._disposers.push(n.Z.registerArrayProperty(this,"polygons",(e=>{const t=new c(this._earth);if(e=e&&e.toJSON&&e.toJSON()||e,t.gvolFromJSON(e),t._autorunDisposer)throw new Error("polygon._autorunDisposer should not exists!");return t._autorunDisposer=(0,r.reaction)((()=>({polygonPositions:[...t.positions],polygonHeight:t.height})),(({polygonPositions:e,polygonHeight:r})=>{if(void 0!==t._flattenedPolygon){let e=i.indexOf(t._flattenedPolygon);i.splice(e,1),t._flattenedPolygon=void 0}if(e.length>=6){const n=Cesium.Cartesian3.fromRadiansArray(e);t._flattenedPolygon=Cesium.xbsjCreateFlattenedPolygon(n,r),i.push(t._flattenedPolygon)}this._flattenedPolygonTexture.refreshFlattenedPolygons()}),{fireImmediately:!0}),t}),(e=>{if(void 0!==e._flattenedPolygon){let t=i.indexOf(e._flattenedPolygon);-1===t&&u.error("压平多边形出错！"),i.splice(t,1),e._flattenedPolygon=void 0}e._autorunDisposer=e._autorunDisposer&&e._autorunDisposer(),e.destroy()}))),this._disposers.push((0,r.observe)(this.polygons,(()=>{this._flattenedPolygonTexture.refreshFlattenedPolygons()}))),this._disposers.push((0,r.autorun)((()=>{this._flattenedPolygonTexture.enabled=this.enabled})))}get flattenedPolygonTexture(){return this._flattenedPolygonTexture}flyTo(){const e=this._earth.czm.scene.camera;0===this.boundingSphere.radius||Cesium.Cartesian3.magnitudeSquared(this.boundingSphere.center)<1e-4||e.flyToBoundingSphere(this.boundingSphere)}gvolFromJSON(e){this.polygons.length=0,super.gvolFromJSON(e)}destroy(){return this._disposers&&this._disposers.forEach((e=>e())),this._disposers.length=0,this._earth.czm.viewer.gvolFlattenning.destroyFlattenedPolygonTexture(this._flattenedPolygonTexture),this._flattenedPolygonTexture=void 0,super.destroy()}}p.FlattenedPolygon=c,p.defaultOptions={polygons:[],show:!0,flattenDiscard:!1};p.gvolSchema={title:"FlattenedPolygonCollection Property",type:"object",properties:{polygons:{type:"array",items:{type:"Obj.FlattenedPolygonCollection.FlattenedPolygon"},default:[],description:"多边形集合"},show:{type:"boolean",title:"是否在三维窗口中显示",default:!0,description:"是否在三维窗口中显示"},flattenDiscard:{type:"boolean",title:"是否挖坑",default:!1,description:"是否挖坑"}}};p.gvolClassification=[{name:{chinese:"通用",english:"General"},properties:["polygons","show","flattenDiscard"]}],s.Z.registerType(p,"FlattenedPolygonCollection");const d=p},5011:(e,t,i)=>{"use strict";i.d(t,{Z:()=>h});var r=i(2188),n=i(8660),o=i(7139),s=i(3192);const a={color:[1,1,0,.95],pixelSize:6,position:[0,0,0],show:!0,disableDepthTestDistance:Number.POSITIVE_INFINITY};class l extends o.Z{constructor(e,t){super(e,t),this._primitive=new Cesium.PointPrimitiveCollection;const i=this._primitive.update;var o=this;this._primitive.update=function(e){this._rsOpaque&&!this._rsOpaque.depthMask||(this._rsOpaque=Cesium.RenderState.fromCache({depthTest:{enabled:!0,func:Cesium.WebGLConstants.LESS},depthMask:!1})),i.call(this,e),this._colorCommands.forEach((e=>{o.forcePass?(e.originPass=e.originPass||e.pass,e.pass=o.forcePass):e.originPass&&e.originPass!==e.pass&&(e.pass=e.originPass,e.originPass=void 0)}))},this._primitiveWrapper=new Cesium.PrimitiveCollection,this._primitiveWrapper.add(this._primitive),this._earth.czm.scene.primitives.add(this._primitiveWrapper),this.disposers.push((()=>{this._primitive&&this._primitiveWrapper.remove(this._primitive),this._primitiveWrapper&&this._earth.czm.scene.primitives.remove(this._primitiveWrapper)})),this._boundingSphere=void 0,this.disposers.push((0,n.Z)(this,"enabled",this,"show")),this.disposers.push((0,r.autorun)((()=>{const e=this.show;this._primitiveWrapper&&(this._primitiveWrapper.show=e)}))),this.disposers.push((0,r.reaction)((()=>JSON.stringify(this.points)),(()=>{this._primitive.removeAll();const e=[];this.points.forEach((t=>{const i={};Object.keys(a).forEach((e=>{i[e]=t[e]})),i.color=new Cesium.Color(...t.color),i.position=Cesium.Cartesian3.fromRadians(...t.position),e.push(i.position),this._primitive.add(i)})),this._boundingSphere=Cesium.BoundingSphere.fromPoints(e,this._boundingSphere)}))),this.disposers.push((0,r.intercept)(this,"points",(e=>{"update"===e.type&&Array.isArray(e.newValue)&&this.points.splice(0,this.points.length,...e.newValue)}))),this.disposers.push((0,r.intercept)(this.points,(e=>{if("splice"===e.type)e.added.forEach((e=>{const t=Object.assign({},a,e);Object.assign(e,t)}));else if("update"===e.type){const t=e.newValue,i=Object.assign({},a,t);Object.assign(t,i)}return e})))}get boundingSphere(){return this._boundingSphere}flyTo(){this._earth.czm.scene.camera.flyToBoundingSphere(this._boundingSphere)}destroy(){return super.destroy()}}l.defaultOptions={points:[],forcePass:void 0,show:!0},s.Z.registerType(l,"Points");const h=l},8572:(e,t,i)=>{"use strict";i.d(t,{Z:()=>_});var r=i(2188),n=i(8660),o=i(7139),s=i(3192),a=i(9563),l=i(9562),h=i(6512),c=i(9495);let u,p,d,m,f,g;function A(e,t,i){u=u||new Cesium.Cartesian3,p=p||new Cesium.Cartesian3,d=d||new Cesium.Cartesian3;var r=Cesium.Cartesian3.subtract(t,e,u),n=Cesium.Cartesian3.subtract(i,e,p),o=Cesium.Cartesian3.cross(r,n,d);return.5*Cesium.Cartesian3.magnitude(o)}const y={positions:[],holePositions:[],height:0,extrudedHeight:null,show:!0,color:[1,1,0,.5],showHelper:!1,outline:{show:!0,color:[0,1,0,1],width:2},depthTest:!1,ground:!1,minShowHeight:-Number.MAX_VALUE,maxShowHeight:Number.MAX_VALUE};class v extends o.Z{constructor(e,t){super(e,t),this.disposers.push((0,n.Z)(this,"enabled",this,"show")),this._primitive=void 0,this.disposers.push((()=>this._primitive&&this._earth.czm.scene.primitives.remove(this._primitive))),this._groundPrimitive=void 0,this.disposers.push((()=>this._groundPrimitive&&this._earth.czm.scene.groundPrimitives.remove(this._groundPrimitive))),this._boundingSphere=new Cesium.BoundingSphere;const{camera:i}=e;{const e=new Cesium.Color(...this.color),t=()=>{const t=i.position[2]>=this.minShowHeight&&i.position[2]<=this.maxShowHeight;e.xbsjFromArray(...this.color),this._primitive&&(this._primitive.show=this.show&&t),this._groundPrimitive&&(this._groundPrimitive.show=this.show&&t)};this.disposers.push((0,r.reaction)((()=>({color:[...this.color],show:this.show,height:i.position[2],minShowHeight:this.minShowHeight,maxShowHeight:this.maxShowHeight})),t));const n=()=>{this._primitive&&this._earth.czm.scene.primitives.remove(this._primitive),this._primitive=void 0,this._groundPrimitive&&this._earth.czm.scene.groundPrimitives.remove(this._groundPrimitive),this._groundPrimitive=void 0;const t=(0,l.Z)(this.positions),i=(0,l.Z)(this.holePositions);if(t.length>=6){const e=Cesium.Cartesian3.fromRadiansArray(t);this._totalArea=function(e){if(m=m||new Cesium.Cartesian3,f=f||new Cesium.Cartesian3,g=g||new Cesium.Cartesian3,!(e.length<=2)){var t=Cesium.CoplanarPolygonGeometry.fromPositions({positions:e}),i=Cesium.CoplanarPolygonGeometry.createGeometry(t);if(i){for(var r=i.attributes.position.values,n=i.indices,o=n.length/3,s=0,a=0;a<o;++a)s+=A(Cesium.Cartesian3.fromElements(r[3*n[3*a+0]+0],r[3*n[3*a+0]+1],r[3*n[3*a+0]+2],m),Cesium.Cartesian3.fromElements(r[3*n[3*a+1]+0],r[3*n[3*a+1]+1],r[3*n[3*a+1]+2],f),Cesium.Cartesian3.fromElements(r[3*n[3*a+2]+0],r[3*n[3*a+2]+1],r[3*n[3*a+2]+2],g));return s}}}(e)}else this._totalArea=0;if(this.ground){if(t.length>=6){n=new Cesium.PolygonGeometry({polygonHierarchy:new Cesium.PolygonHierarchy(Cesium.Cartesian3.fromRadiansArray(t),[new Cesium.PolygonHierarchy(i.length>=3?Cesium.Cartesian3.fromRadiansArray(i):[])]),height:this.height}),o=new Cesium.GeometryInstance({geometry:n,id:this});var r=new Cesium.GroundPrimitive({geometryInstances:[o],appearance:new Cesium.MaterialAppearance({material:Cesium.Material.fromType("Color"),faceForward:!0}),asynchronous:!1,allowPicking:this.allowPicking,compressVertices:!1});r.appearance.material.uniforms.color=e,this._groundPrimitive=this._earth.czm.scene.groundPrimitives.add(r)}}else if(t.length>=6){var n=new Cesium.PolygonGeometry({polygonHierarchy:new Cesium.PolygonHierarchy(Cesium.Cartesian3.fromRadiansArray(t),[new Cesium.PolygonHierarchy(i.length>=3?Cesium.Cartesian3.fromRadiansArray(i):[])]),height:this.height,extrudedHeight:this.extrudedHeight}),o=new Cesium.GeometryInstance({geometry:n,id:this}),s=new Cesium.Primitive({geometryInstances:[o],appearance:new Cesium.MaterialAppearance({material:Cesium.Material.fromType("Color"),faceForward:!0,renderState:{depthTest:{enabled:this.depthTest}}}),asynchronous:!1,allowPicking:this.allowPicking,compressVertices:!1});s.appearance.material.uniforms.color=e,this._primitive=this._earth.czm.scene.primitives.add(s)}},o=()=>{const e=this.positions.length/2;if(e>=3){const t=[];for(let i=0;i<e;++i)t.push(this.positions[2*i],this.positions[2*i+1],this.height);const i=Cesium.Cartesian3.fromRadiansArrayHeights(t);this._boundingSphere=Cesium.BoundingSphere.fromPoints(i,this._boundingSphere)}};this.disposers.push((0,r.reaction)((()=>({positions:[...this.positions],holePositions:[...this.holePositions],height:this.height,extrudedHeight:this.extrudedHeight,ground:this.ground,depthTest:this.depthTest})),(()=>{n(),t(),o()})))}this._polyline=new h.Z(e),this.disposers.push((()=>this._polyline=this._polyline&&this._polyline.destroy())),this._holePolyline=new h.Z(e),this.disposers.push((()=>this._holePolyline=this._holePolyline&&this._holePolyline.destroy())),this._polyline.material.type="XbsjColorMaterial",this._polyline.depthTest=this.depthTest,this._polyline.loop=!0,this._holePolyline.material.type="XbsjColorMaterial",this._holePolyline.depthTest=this.depthTest,this._holePolyline.loop=!0,(0,c.Z)(this._polyline,this),this.disposers.push((0,r.autorun)((()=>{this._polyline.material.XbsjColorMaterial.color=this.outline.color,this._polyline.width=this.outline.width,this._polyline.show=this.show&&this.outline.show,this._polyline.ground=this.ground,this._polyline.depthTest=this.depthTest,this._polyline.minShowHeight=this.minShowHeight,this._polyline.maxShowHeight=this.maxShowHeight,this._holePolyline.material.XbsjColorMaterial.color=this.outline.color,this._holePolyline.width=this.outline.width,this._holePolyline.show=this.show&&this.outline.show,this._holePolyline.ground=this.ground,this._holePolyline.depthTest=this.depthTest,this._holePolyline.minShowHeight=this.minShowHeight,this._holePolyline.maxShowHeight=this.maxShowHeight})));{const e=()=>{const e=this.positions.length/2,t=[];for(let i=0;i<e;++i)t.push([this.positions[2*i],this.positions[2*i+1],this.height]);return t},t=e=>this._polyline&&(this._polyline.positions=e);t(e()),this.disposers.push((0,r.reaction)(e,t))}{const e=()=>{const e=this.holePositions.length/2,t=[];for(let i=0;i<e;++i)t.push([this.holePositions[2*i],this.holePositions[2*i+1],this.height]);return t},t=e=>this._holePolyline&&(this._holePolyline.positions=e);t(e()),this.disposers.push((0,r.reaction)(e,t))}this.disposers.push((0,a.Vy)(this._earth,this,{polygonCreatingWithHeight:"creating"})),this.disposers.push((0,a.V$)(this._earth,this,{polygonCreating:"creatingWithoutHeight"})),this.disposers.push((0,a.Ko)(this._earth,this,{polygonEditingProperty:"editing"})),this.disposers.push((0,a.vD)(this._earth,this,{polygonCreatingWithHeight:"holeCreating"})),this.disposers.push((0,a.qg)(this._earth,this,{polygonEditingProperty:"holeEditing"}))}get boundingSphere(){return this._boundingSphere}getTotalArea(){return this._totalArea}flyTo(){this._earth.czm.scene.camera.flyToBoundingSphere(this._boundingSphere)}destroy(){return super.destroy()}}const C={title:"Polygon Property",type:"object",properties:{positions:{type:"array",title:"位置数组",default:[],description:"位置数组"},holePositions:{type:"array",title:"Hole位置数组",default:[],description:"Hole位置数组"},height:{type:"number",title:"多边形的高度",default:0,description:"多边形的高度"},extrudedHeight:{type:"number",title:"多边形的拉伸高度",default:null,description:"多边形的拉伸高度"},show:{type:"boolean",title:"是否在三维窗口中显示",default:!0,description:"是否在三维窗口中显示"},color:{type:"array",items:{type:"number"},minItems:4,maxItems:4,default:[1,1,1,1],description:"颜色叠加"},showHelper:{type:"boolean",title:"是否显示辅助线框",default:!1,description:"是否显示辅助线框"},outline:{title:"Polygon outline Property",type:"object",properties:{show:{type:"boolean",title:"是否在三维窗口中显示",default:!0,description:"是否在三维窗口中显示"},color:{type:"array",items:{type:"number"},minItems:4,maxItems:4,default:[0,1,0,1],description:"颜色叠加"},width:{type:"number",title:"线框的宽度",default:2,description:"线框的宽度"}}},depthTest:{type:"boolean",title:"是否开启深度检测",default:!1,description:"是否开启深度检测"},ground:{type:"boolean",title:"是否贴地",default:!1,description:"是否贴地"},minShowHeight:{type:"number",title:"最低显示海拔高度",default:-Number.MAX_VALUE,description:"最低显示海拔高度"},maxShowHeight:{type:"number",title:"最高显示海拔高度",default:Number.MAX_VALUE,description:"最高显示海拔高度"}}};v.gvolSchema=C;v.gvolClassification=[{name:{chinese:"通用",english:"General"},properties:["positions","holePositions","height","show","color","showHelper","outline","depthTest","ground"]}],v.defaultOptions=y,s.Z.registerType(v,"Polygon");const _=v},6512:(e,t,i)=>{"use strict";i.d(t,{Z:()=>v});var r=i(2188),n=i(8660),o=i(1071),s=i(7139),a=i(3192),l=i(9563);const h=function(e){if(0==e.length)return[];const t=[e[0]];for(let i=1;i<e.length;++i){const r=t[t.length-1];r[0]===e[i][0]&&r[1]===e[i][1]&&r[2]===e[i][2]||t.push([...e[i]])}return t};var c=i(5011);class u extends o.Z{constructor(){super(),(0,r.extendObservable)(this,{_material:Cesium.Material.fromType("Color"),get material(){return this._material}},{material:r.computed}),this._disposers=[],this._disposers.push((0,r.autorun)((()=>{this._material.uniforms.color=new Cesium.Color(...this.color)})))}destroy(){return this._disposers.forEach((e=>e())),this._disposers.length=0,super.destroy()}}u.defaultOptions={color:[1,1,1,1]};class p extends o.Z{constructor(){super(),(0,r.extendObservable)(this,{_material:Cesium.Material.fromType("PolylineDash"),get material(){return this._material}},{material:r.computed}),this.disposers.push((0,r.autorun)((()=>{Object.keys(this._defaultOptions).forEach((e=>{this._material.uniforms[e]="color"===e||"gapColor"===e?new Cesium.Color(...this[e]):this[e]}))})))}}p.defaultOptions={color:[1,0,1,1],gapColor:[0,0,0,0],dashLength:16,dashPattern:255};class d extends o.Z{constructor(){super(),(0,r.extendObservable)(this,{_material:Cesium.Material.fromType("PolylineArrow"),get material(){return this._material}},{material:r.computed}),this.disposers.push((0,r.autorun)((()=>{Object.keys(this._defaultOptions).forEach((e=>{this._material.uniforms[e]="color"===e?new Cesium.Color(...this[e]):this[e]}))})))}}d.defaultOptions={color:[1,1,1,1]};class m extends o.Z{constructor(){super(),(0,r.extendObservable)(this,{_material:Cesium.Material.fromType("PolylineGlow"),get material(){return this._material}},{material:r.computed}),this.disposers.push((0,r.autorun)((()=>{Object.keys(this._defaultOptions).forEach((e=>{this._material.uniforms[e]="color"===e?new Cesium.Color(...this[e]):this[e]}))})))}}m.defaultOptions={color:[1,1,1,1],glowPower:.25,taperPower:1};class f extends o.Z{constructor(){super(),(0,r.extendObservable)(this,{_material:Cesium.Material.fromType("PolylineOutline"),get material(){return this._material}},{material:r.computed}),this.disposers.push((0,r.autorun)((()=>{Object.keys(this._defaultOptions).forEach((e=>{this._material.uniforms[e]="color"===e||"outlineColor"===e?new Cesium.Color(...this[e]):this[e]}))})))}}f.defaultOptions={color:[1,1,1,1],outlineColor:[1,1,1,1],outlineWidth:.25};class g extends o.Z{constructor(){super(),(0,r.extendObservable)(this,{_material:Cesium.Material.fromType("XbsjODLine"),get material(){return this._material}},{material:r.computed}),this.disposers.push((0,r.autorun)((()=>{Object.keys(this._defaultOptions).forEach((e=>{this._material.uniforms[e]="color"===e||"bgColor"===e?new Cesium.Color(...this[e]):"useImageAndRepeat"===e?new Cesium.Cartesian2(...this[e]):this[e]}))})))}}g.defaultOptions={color:[1,1,0,1],bgColor:[.5,.5,.5,1],bidirectional:0,totoalFrameCount:45,image:"",useImageAndRepeat:[0,2]};class A extends s.Z{constructor(e,t){super(e,t),this._pointsColor=[1,1,0,.95],this.material.XbsjColorMaterial=new u,this.material.XbsjPolylineDashMaterial=new p,this.material.XbsjPolylineArrowMaterial=new d,this.material.XbsjODLineMaterial=new g,this.material.XbsjPolylineGlowMaterial=new m,this.material.XbsjPolylineOutlineMaterial=new f,o.Z.registerProperty(this,"material",A.defaultOptions.material),o.Z.registerProperty(this.material,"XbsjColorMaterial"),o.Z.registerProperty(this.material,"XbsjPolylineDashMaterial"),o.Z.registerProperty(this.material,"XbsjPolylineArrowMaterial"),o.Z.registerProperty(this.material,"XbsjODLineMaterial"),o.Z.registerProperty(this.material,"XbsjPolylineGlowMaterial"),o.Z.registerProperty(this.material,"XbsjPolylineOutlineMaterial"),this._primitive=void 0,this.disposers.push((()=>this._primitive&&this._earth.czm.scene.primitives.remove(this._primitive))),this._groundPrimitive=void 0,this.disposers.push((()=>this._groundPrimitive&&this._earth.czm.scene.groundPrimitives.remove(this._groundPrimitive))),this._boundingSphere=void 0,this.disposers.push((0,n.Z)(this,"enabled",this,"show"));const i={GEODESIC:Cesium.ArcType.GEODESIC,NONE:Cesium.ArcType.NONE,RHUMB:Cesium.ArcType.RHUMB};{const t=()=>{const e=h(this.positions);if(e.length<=1)return;const t=e.map((e=>Cesium.Cartesian3.fromRadians(...e)));this.loop&&e.length>=3&&(t.push(t[0]),t.push(t[1]));const r=this.material[this.material.type].material,n=new Cesium.PolylineMaterialAppearance({material:r,renderState:{depthTest:{enabled:this.depthTest}}});n.renderState.depthMask=!1;const o=new Cesium.Primitive({geometryInstances:new Cesium.GeometryInstance({geometry:new Cesium.PolylineGeometry({positions:t,width:this.width,vertexFormat:Cesium.PolylineMaterialAppearance.VERTEX_FORMAT,arcType:i[this.arcType]}),id:this}),appearance:n,asynchronous:!1,allowPicking:this.allowPicking,compressVertices:!1}),s=o.update,a=this;return o.update=function(e){s.call(this,e),this._colorCommands.forEach((e=>{a.forcePass&&(e.pass=a.forcePass)}))},o},n=()=>{const e=h(this.positions);if(e.length<=1)return;const t=e.map((e=>Cesium.Cartesian3.fromRadians(...e)));this.loop&&e.length>=3&&(t.push(t[0]),t.push(t[1]));const r=this.material[this.material.type].material;return new Cesium.GroundPolylinePrimitive({geometryInstances:new Cesium.GeometryInstance({geometry:new Cesium.GroundPolylineGeometry({positions:t,width:this.width,vertexFormat:Cesium.PolylineMaterialAppearance.VERTEX_FORMAT,arcType:i[this.arcType]}),id:this}),appearance:new Cesium.PolylineMaterialAppearance({material:r,renderState:{depthTest:{enabled:this.depthTest}}}),asynchronous:!1,allowPicking:this.allowPicking,compressVertices:!1})},o=()=>{const e=this.positions;this._primitive&&this._earth.czm.scene.primitives.remove(this._primitive),this._primitive=void 0,this._groundPrimitive&&this._earth.czm.scene.groundPrimitives.remove(this._groundPrimitive),this._groundPrimitive=void 0,e.length>=2&&(this.ground?(this._groundPrimitive=n(),this._groundPrimitive&&this._earth.czm.scene.groundPrimitives.add(this._groundPrimitive)):(this._primitive=t(),this._primitive&&this._earth.czm.scene.primitives.add(this._primitive)))},{camera:s}=e,a=()=>{const e=this.show&&s.position[2]>=this.minShowHeight&&s.position[2]<=this.maxShowHeight;this._primitive&&(this._primitive.show=e),this._groundPrimitive&&(this._groundPrimitive.show=e);const t=this.material[this.material.type].material;this._primitive&&(this._primitive.appearance.material=t),this._groundPrimitive&&(this._groundPrimitive.appearance.material=t)},l=()=>{const e=this.positions.map((e=>Cesium.Cartesian3.fromRadians(...e)));this._boundingSphere=Cesium.BoundingSphere.fromPoints(e,this._boundingSphere)};this.disposers.push((0,r.reaction)((()=>({positions:[...this.positions.map((e=>[...e]))],loop:this.loop,ground:this.ground,depthTest:this.depthTest,arcType:this.arcType,width:this.width,allowPicking:this.allowPicking})),(()=>{o(),l(),a()}))),this.disposers.push((0,r.autorun)(a)),this.disposers.push((0,r.reaction)((()=>[...s.position]),a))}this._points=new c.Z(e),this.disposers.push((()=>this._points=this._points&&this._points.destroy())),this.disposers.push((0,r.reaction)((()=>this.positions.map((e=>[...e]))),(e=>{const t=e.length-this._points.points.length;if(t>0)for(let e=0;e<t;++e)this._points.points.push({color:[...this._pointsColor]});else if(t<0)for(let i=0;i<-t;++i)this._points.points[e.length+i].show=!1,this._points.points[e.length+i].color.splice(0,4,...this._pointsColor);e.forEach(((e,t)=>{this._points.points[t].show=this.enabled,this._points.points[t].position.splice(0,3,...e)}))}),{fireImmediately:!0})),this.disposers.push((0,r.reaction)((()=>this.show&&this.showHelper||this.isSelected),(e=>{this._points.show=e}),{fireImmediately:!0})),this.disposers.push((0,l.wt)(this._earth,this,{polylineCreatingProperty:"creating"})),this.disposers.push((0,l.ih)(this._earth,this,{polylineEditingProperty:"editing"}))}get boundingSphere(){return this._boundingSphere}flyTo(){this._earth.czm.scene.camera.flyToBoundingSphere(this._boundingSphere)}destroy(){return super.destroy()}}A.defaultOptions={positions:[],show:!0,showHelper:!1,width:2,depthTest:!1,forcePass:void 0,arcType:"GEODESIC",loop:!1,material:{type:"XbsjColorMaterial",XbsjColorMaterial:{},XbsjPolylineDashMaterial:{},XbsjPolylineArrowMaterial:{},XbsjODLineMaterial:{},XbsjPolylineGlowMaterial:{},XbsjPolylineOutlineMaterial:{}},ground:!1,minShowHeight:-Number.MAX_VALUE,maxShowHeight:Number.MAX_VALUE};const y={title:"Polyline Property",type:"object",properties:{positions:{type:"array",title:"位置数组",default:[],description:"位置数组"},show:{type:"boolean",title:"是否在三维窗口中显示",default:!0,description:"是否在三维窗口中显示"},showHelper:{type:"boolean",title:"是否显示辅助线框",default:!1,description:"是否显示辅助线框"},width:{type:"number",title:"线宽，单位像素",default:2,description:"线宽，单位像素"},depthTest:{type:"boolean",title:"是否开启深度检测",default:!1,description:"是否开启深度检测"},forcePass:{type:["number","undefined"],title:"是否开启深度检测",default:void 0,description:"是否开启深度检测"},arcType:{type:"string",title:"弧线样式",default:"GEODESIC",description:"弧线样式"},material:{},loop:{type:"boolean",title:"是否首尾相连",default:!1,description:"是否首尾相连"},ground:{type:"boolean",title:"是否贴地",default:!0,description:"是否贴地"},minShowHeight:{type:"number",title:"最低显示海拔高度",default:-Number.MAX_VALUE,description:"最低显示海拔高度"},maxShowHeight:{type:"number",title:"最高显示海拔高度",default:Number.MAX_VALUE,description:"最高显示海拔高度"}}};A.gvolSchema=y;A.gvolClassification=[{name:{chinese:"通用",english:"General"},properties:["positions","show","showHelper","width","depthTest","forcePass","arcType","loop","material","ground"]}],a.Z.registerType(A,"Polyline");const v=A},2750:(e,t,i)=>{"use strict";i.d(t,{Z:()=>l});var r=i(1071),n=i(2188),o=i(3765);const s=(new Date).toLocaleString();setTimeout((()=>{const e="undefined"!=typeof Cesium&&Cesium.xbsj&&Cesium.xbsj.copyright&&Cesium.xbsj.copyright,t={v:"190731",v1:"V1.0.1",d1:s,v2:e&&e.VERSION||"",d2:e&&e.date||"",auth:"无",page:window.location.href,RESTRICT:"无",CZMVERSION:"undefined"!=typeof Cesium?Cesium.VERSION:"",earthDir:o.Z.gvolEarthDir,czmDir:o.Z.cesiumDir},i=encodeURIComponent(JSON.stringify(t));fetch("http://lab2.cesiumlab.com/api/earthsdk/record?d="+i).then((()=>{})).catch((()=>{}))}),60*(10*Math.random()+5)*1e3);class a extends r.Z{constructor(){super(),this._disposers=[],this._disposers.push((0,n.intercept)(this,(e=>{if("add"!==e.type||e.name.startsWith("_"))return e})))}destroy(){return this._disposers.forEach((e=>e())),this._disposers.length=0,super.destroy()}}a.defaultOptions={planes:[],edgeWidth:1,edgeColor:[1,1,1,1],unionClippingRegions:!0};a.gvolSchema={title:"Tileset ClippingPlanes Property",type:"object",properties:{planes:{type:"array",items:{type:"string"},minItems:0,default:[],description:"裁剪面的guid集合"},edgeColor:{type:"array",items:{type:"number",minimum:0,maximum:1},minItems:4,maxItems:4,default:[1,1,1,1],description:"The color applied to highlight the edge along which an object is clipped."},edgeWidth:{type:"number",title:"edgeWidth",default:1,description:"The width, in pixels, of the highlight applied to the edge along which an object is clipped."},unionClippingRegions:{type:"boolean",title:"unionClippingRegions",default:!1,description:"If true, a region will be clipped if it is on the outside of any plane in the collection. Otherwise, a region will only be clipped if it is on the outside of every plane."}}},a.gvolClassification=[{name:{chinese:"通用",english:"General"},properties:["planes","edgeWidth","edgeColor","unionClippingRegions"]}];const l=a},5517:(e,t,i)=>{"use strict";i.d(t,{Z:()=>n});const r={url:"",show:!0,backFaceCulling:!0,maximumScreenSpaceError:16,maximumMemoryUsage:512,cullWithChildrenBounds:!0,dynamicScreenSpaceError:!1,dynamicScreenSpaceErrorDensity:.00278,dynamicScreenSpaceErrorFactor:4,dynamicScreenSpaceErrorHeightFalloff:.25,skipLevelOfDetail:!0,baseScreenSpaceError:1024,skipScreenSpaceErrorFactor:16,skipLevels:1,immediatelyLoadDesiredLevelOfDetail:!1,loadSiblings:!1,luminanceAtZenith:.2,preferLeaves:!1,debugFreezeFrame:!1,debugColorizeTiles:!1,debugWireframe:!1,debugShowBoundingVolume:!1,debugShowContentBoundingVolume:!1,debugShowViewerRequestVolume:!1,debugShowGeometricError:!1,debugShowRenderingStatistics:!1,debugShowMemoryUsage:!1,debugShowUrl:!1,colorBlendAmount:.5};Object.assign(r,{classificationType:"ClassificationType.NONE",shadows:"ShadowMode.ENABLED",colorBlendMode:"Cesium3DTileColorBlendMode.HIGHLIGHT",imageBasedLightingFactor:[1,1],lightColor:void 0,specularEnvironmentMaps:void 0}),Object.assign(r,{gvolPosition:[0,0,0],gvolRotation:[0,0,0],gvolScale:[1,1,1],gvolUseOriginTransform:!0,gvolLeftTopView:!0,gvolRightTopView:!0,gvolLeftBottomView:!0,gvolRightBottomView:!0,gvolStyle:"",gvolFlattenGuid:"",gvolClippingPlanes:null,gvolCriticalElevation:-1/0,gvolCriticalElevationColor:[0,1,0,.5],attachedPathGuid:"",gvolCustomShader:{vsHeader:"",vsBody:"",fsHeader:"",fsBody:""},gvolCustomParams:[0,0,0,0],gvolMinViewDistance:0,gvolMaxViewDistance:1/0});const n=r},7047:(e,t,i)=>{"use strict";i.d(t,{Z:()=>r});const r=[{name:{chinese:"通用",english:"General"},properties:["url","show","backFaceCulling","maximumScreenSpaceError","maximumMemoryUsage","cullWithChildrenBounds","dynamicScreenSpaceError","dynamicScreenSpaceErrorDensity","dynamicScreenSpaceErrorFactor","dynamicScreenSpaceErrorHeightFalloff","skipLevelOfDetail","baseScreenSpaceError","skipScreenSpaceErrorFactor","skipLevels","immediatelyLoadDesiredLevelOfDetail","loadSiblings","luminanceAtZenith","classificationType","shadows","imageBasedLightingFactor","lightColor","specularEnvironmentMaps","preferLeaves"]},{name:{chinese:"扩展",english:"Extension"},properties:["gvolPosition","gvolRotation","gvolScale","gvolUseOriginTransform","gvolLeftTopView","gvolRightTopView","gvolLeftBottomView","gvolRightBottomView","gvolStyle","gvolFlattenGuid","gvolClippingPlanes","gvolCriticalElevation","gvolCriticalElevationColor","gvolMinViewDistance","gvolMaxViewDistance"]},{name:{chinese:"调试",english:"Debug"},properties:["debugFreezeFrame","debugColorizeTiles","debugWireframe","debugShowBoundingVolume","debugShowContentBoundingVolume","debugShowViewerRequestVolume","debugShowGeometricError","debugShowRenderingStatistics","debugShowMemoryUsage","debugShowUrl"]}]},6362:(e,t,i)=>{"use strict";i.d(t,{Z:()=>r});const r={title:"Tileset Property",type:"object",properties:{url:{type:"string",title:"url",default:"",description:"url"},show:{type:"boolean",title:"show",default:!0,description:"Determines if the tileset will be shown"},backFaceCulling:{type:"boolean",title:"backFaceCulling",default:!0,description:"Whether to cull back-facing geometry. When true, back face culling is determined by the glTF material's doubleSided property; when false, back face culling is disabled."},maximumScreenSpaceError:{type:"number",default:16,description:"The maximum screen space error used to drive level of detail refinement."},maximumMemoryUsage:{type:"number",default:512,description:"The maximum amount of memory in MB that can be used by the tileset."},cullWithChildrenBounds:{type:"boolean",default:!0,description:"Optimization option. Whether to cull tiles using the union of their children bounding volumes."},dynamicScreenSpaceError:{type:"boolean",default:!1,description:"Optimization option. Reduce the screen space error for tiles that are further away from the camera."},dynamicScreenSpaceErrorDensity:{type:"number",default:.00278,description:"Density used to adjust the dynamic screen space error, similar to fog density."},dynamicScreenSpaceErrorFactor:{type:"number",default:4,description:"A factor used to increase the computed dynamic screen space error."},dynamicScreenSpaceErrorHeightFalloff:{type:"number",default:.25,description:"A ratio of the tileset's height at which the density starts to falloff."},skipLevelOfDetail:{type:"boolean",default:!0,description:"Optimization option. Determines if level of detail skipping should be applied during the traversal."},baseScreenSpaceError:{type:"number",default:1024,description:"When skipLevelOfDetail is true, the screen space error that must be reached before skipping levels of detail."},skipScreenSpaceErrorFactor:{type:"number",default:16,description:"When skipLevelOfDetail is true, a multiplier defining the minimum screen space error to skip. Used in conjunction with skipLevels to determine which tiles to load."},skipLevels:{type:"number",default:1,description:"When skipLevelOfDetail is true, a constant defining the minimum number of levels to skip when loading tiles. When it is 0, no levels are skipped. Used in conjunction with skipScreenSpaceErrorFactor to determine which tiles to load."},immediatelyLoadDesiredLevelOfDetail:{type:"boolean",default:!1,description:"When skipLevelOfDetail is true, only tiles that meet the maximum screen space error will ever be downloaded. Skipping factors are ignored and just the desired tiles are loaded."},loadSiblings:{type:"boolean",default:!1,description:"When skipLevelOfDetail is true, determines whether siblings of visible tiles are always downloaded during traversal."},luminanceAtZenith:{type:"number",default:.5,description:"optional The sun's luminance at the zenith in kilo candela per meter squared to use for this model's procedural environment map."},preferLeaves:{type:"boolean",default:!1,description:"preferLeaves"},debugFreezeFrame:{type:"boolean",default:!1,description:"For debugging only. Determines if only the tiles from last frame should be used for rendering."},debugColorizeTiles:{type:"boolean",default:!1,description:"For debugging only. When true, assigns a random color to each tile."},debugWireframe:{type:"boolean",default:!1,description:"For debugging only. When true, render's each tile's content as a wireframe."},debugShowBoundingVolume:{type:"boolean",default:!1,description:"For debugging only. When true, renders the bounding volume for each tile."},debugShowContentBoundingVolume:{type:"boolean",default:!1,description:"For debugging only. When true, renders the bounding volume for each tile's content."},debugShowViewerRequestVolume:{type:"boolean",default:!1,description:"For debugging only. When true, renders the viewer request volume for each tile."},debugShowGeometricError:{type:"boolean",default:!1,description:"For debugging only. When true, draws labels to indicate the geometric error of each tile."},debugShowRenderingStatistics:{type:"boolean",default:!1,description:"For debugging only. When true, draws labels to indicate the number of commands, points, triangles and features for each tile."},debugShowMemoryUsage:{type:"boolean",default:!1,description:"For debugging only. When true, draws labels to indicate the texture and geometry memory in megabytes used by each tile."},debugShowUrl:{type:"boolean",default:!1,description:"For debugging only. When true, draws labels to indicate the url of each tile."},classificationType:{type:"string",default:"ClassificationType.NONE",enum:["ClassificationType.NONE","ClassificationType.BOTH","ClassificationType.CESIUM_3D_TILE","ClassificationType.TERRAIN"],description:"分类样式"},shadows:{type:"string",default:"ShadowMode.ENABLED",enum:["ShadowMode.DISABLED","ShadowMode.ENABLED","ShadowMode.CAST_ONLY","ShadowMode.RECEIVE_ONLY"],description:"Determines whether the tileset casts or receives shadows from each light source."},imageBasedLightingFactor:{type:"array",items:{type:"number",minimum:0,maximum:1},minItems:2,maxItems:2,default:[1,1],description:"Scales the diffuse and specular image-based lighting from the earth, sky, atmosphere and star skybox."},lightColor:{type:"array",items:{type:"number",minimum:0,maximum:1},minItems:3,maxItems:3,default:[1,1,1],description:"The color and intensity of the sunlight used to shade models."},specularEnvironmentMaps:{type:"string",default:"",description:"URL to a KTX file that contains a cube map of the specular lighting and the convoluted specular mipmaps."},gvolPosition:{type:"array",items:{type:"number"},minItems:3,maxItems:3,default:[0,0,0],description:"位置（经度, 纬度, 高度）"},gvolRotation:{type:"array",items:{type:"number"},minItems:3,maxItems:3,default:[0,0,0],description:"姿态（偏航角, 俯仰角, 翻转角）"},gvolScale:{type:"array",items:{type:"number"},minItems:3,maxItems:3,default:[1,1,1],description:"缩放（x向, y向, z向）"},gvolUseOriginTransform:{type:"boolean",default:!0,description:"是否使用原始矩阵，否则将使用gvolPosition、gvolRotation来设置模型的位置和姿态."},gvolLeftTopView:{type:"boolean",default:!0,description:"是否显示在左上角视口"},gvolRightTopView:{type:"boolean",default:!0,description:"是否显示在右上角视口"},gvolLeftBottomView:{type:"boolean",default:!0,description:"是否显示在左下角视口"},gvolRightBottomView:{type:"boolean",default:!0,description:"是否显示在右下角视口"},gvolStyle:{type:"string",default:"",description:"三维瓦片的样式设置"},gvolFlattenGuid:{type:"string",default:"",description:"绑定压平纹理"},gvolClippingPlanes:i(2750).Z.gvolSchema,gvolCriticalElevation:{type:"number",default:-1/0,description:"水淹高度"},gvolCriticalElevationColor:{type:"array",items:{type:"number",minimum:0,maximum:1},minItems:4,maxItems:4,default:[0,1,0,.5],description:"剖切处的颜色"},gvolMinViewDistance:{type:"number",default:0,description:"最小可视距离"},gvolMaxViewDistance:{type:"number",default:1/0,description:"最大可视距离"}}}},1911:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});var mobx__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(2188),_Core_MVVM_bind__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(8660),_Core_GvolBase__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(1071),_Core_GvolGeoBase__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(7139),_Core_GvolObject__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(3192),_Scene_Interaction_registerInteractionProperty__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(9563),_ClippingPlane__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(6452),_FlattenedPolygonCollection__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(6020),_ClippingPlanes__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(2750),_defaultOptions__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(5517),_initTileset__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(7602),_utils__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(9990),_valueTransforms__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(6593),_gvolClassification__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(7047),_gvolSchema__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(6362),console=__webpack_require__(5108);let sphericalHarmonicCoefficients;function updateCoefficients(e){var t=new Cesium.Cartesian3(.170455150831422,.163151083190219,.196966760289763),i=new Cesium.Cartesian3(-.066550267689383,-.022088055746048,.078835009246127),r=new Cesium.Cartesian3(.038364097478591,.045714300098753,.063498904606215),n=new Cesium.Cartesian3(-.01436536331281,-.026490613715151,-.05018940406602),o=new Cesium.Cartesian3(-.05153278691789,-.050777795729986,-.056449044453032),s=new Cesium.Cartesian3(.043454596136534,.046672590104157,.05753010764661),a=new Cesium.Cartesian3(-.00164046627411,.001286638231156,.007228908989616),l=new Cesium.Cartesian3(-.042260855700641,-.046394335094707,-.057562936365585),h=new Cesium.Cartesian3(-.004953478914091,-.000479681664876,.008508150106928);sphericalHarmonicCoefficients=sphericalHarmonicCoefficients||[t,i,r,n,o,s,a,l,h],e.specularEnvironmentMaps?e.sphericalHarmonicCoefficients=sphericalHarmonicCoefficients:e.sphericalHarmonicCoefficients=void 0}class Tileset extends _Core_GvolGeoBase__WEBPACK_IMPORTED_MODULE_3__.Z{constructor(earth,guid){super(earth,guid),this.gvolClippingPlanes=new _ClippingPlanes__WEBPACK_IMPORTED_MODULE_8__.Z,this._collection=earth.czm.scene.primitives,this._scene=earth.czm.scene,(0,mobx__WEBPACK_IMPORTED_MODULE_0__.extendObservable)(this,{_tileset:void 0,_globalClippingPlanes:[]},{_tileset:mobx__WEBPACK_IMPORTED_MODULE_0__.observable.ref,_globalClippingPlanes:mobx__WEBPACK_IMPORTED_MODULE_0__.observable.shallow}),this._disposers=[],this._disposers.push((0,_Core_MVVM_bind__WEBPACK_IMPORTED_MODULE_1__.Z)(this,"enabled",this,"show")),this._disposers.push(_Core_GvolBase__WEBPACK_IMPORTED_MODULE_2__.Z.registerProperty(this,"gvolCustomShader",{vsHeader:"",vsBody:"",fsHeader:"",fsBody:""})),(0,mobx__WEBPACK_IMPORTED_MODULE_0__.extendObservable)(this,{gvolCustomTexture:void 0},{gvolCustomTexture:mobx__WEBPACK_IMPORTED_MODULE_0__.observable.ref}),this._disposers.push((0,mobx__WEBPACK_IMPORTED_MODULE_0__.reaction)((()=>({url:this.url,classificationType:this.classificationType,gvolCustomShader:JSON.stringify(this.gvolCustomShader),gvolCustomParams:[...this.gvolCustomParams],xbsnCustomTexture:this.gvolCustomTexture})),(()=>{if(this._tileset&&this._collection.remove(this._tileset),this._tileset=void 0,!this.url)return;let e=this.url;if(this.url.startsWith("Ion(")){let t=/Ion\((\d+)/.exec(this.url),i=t[1]&&+t[1];i&&(e=Cesium.IonResource.fromAssetId(i))}this._tileset=new Cesium.Cesium3DTileset({url:e,classificationType:_valueTransforms__WEBPACK_IMPORTED_MODULE_10__.Z.classificationType.jsonToCzm(this.classificationType)}),this._tileset.gvolTileset=this,this._collection.add(this._tileset),(0,_initTileset__WEBPACK_IMPORTED_MODULE_13__.Z)(this._tileset,this._earth),this._originPositionSetTimeoutID&&(clearTimeout(this._originPositionSetTimeoutID),this._originPositionSetTimeoutID=void 0),this._originPositionSetTimeoutID=setTimeout((()=>{this.gvolPosition.every((e=>0===e))&&this._tileset&&this._tileset.readyPromise.then((()=>{this.gvolPosition=this.getOriginPosition()}))}),0);const t=this._tileset;t.gvolCustomShader=this.gvolCustomShader,t._gvolCustomParams||(t._gvolCustomParams=new Cesium.Cartesian4),t._gvolCustomParams.x=this.gvolCustomParams[0],t._gvolCustomParams.y=this.gvolCustomParams[1],t._gvolCustomParams.z=this.gvolCustomParams[2],t._gvolCustomParams.w=this.gvolCustomParams[3],t._gvolCustomTexture=this.gvolCustomTexture}),{fireImmediately:!0})),this._disposers.push((0,mobx__WEBPACK_IMPORTED_MODULE_0__.reaction)((()=>this.show),(()=>{this.show&&setTimeout((()=>{this._tileset&&this._tileset.makeStyleDirty()}),1e3)})));{const e=new Cesium.Cartesian3,t=()=>{if(this._tileset&&this._tileset.ready){const t=Cesium.Matrix4.getTranslation(this._tileset._root.transform,e),i=Cesium.Cartesian3.distance(this._scene.camera.positionWC,t);this._tileset.show=this.show&&i>=this.gvolMinViewDistance&&i<=this.gvolMaxViewDistance}};this._disposers.push((0,mobx__WEBPACK_IMPORTED_MODULE_0__.reaction)((()=>({show:this.show,gvolMinViewDistance:this.gvolMinViewDistance,gvolMaxViewDistance:this.gvolMaxViewDistance,_tileset:this._tileset})),t)),this._disposers.push(this._scene.camera.changed.addEventListener(t)),this._disposers.push((0,mobx__WEBPACK_IMPORTED_MODULE_0__.reaction)((()=>this._tileset),(()=>{this._tileset&&this._tileset.readyPromise.then(t)})))}const updatePropertes=["backFaceCulling","maximumScreenSpaceError","maximumMemoryUsage","cullWithChildrenBounds","dynamicScreenSpaceError","dynamicScreenSpaceErrorDensity","dynamicScreenSpaceErrorFactor","dynamicScreenSpaceErrorHeightFalloff","skipLevelOfDetail","baseScreenSpaceError","skipScreenSpaceErrorFactor","skipLevels","immediatelyLoadDesiredLevelOfDetail","loadSiblings","luminanceAtZenith","preferLeaves","debugFreezeFrame","debugColorizeTiles","debugWireframe","debugShowBoundingVolume","debugShowContentBoundingVolume","debugShowViewerRequestVolume","debugShowGeometricError","debugShowRenderingStatistics","debugShowMemoryUsage","debugShowUrl","colorBlendAmount"],updatePropertes2=["shadows","colorBlendMode","imageBasedLightingFactor","lightColor","specularEnvironmentMaps"];this._disposers.push((0,mobx__WEBPACK_IMPORTED_MODULE_0__.autorun)((()=>{const e=this._tileset;updatePropertes.forEach((t=>{const i=this[t];e&&(e[t]=i)})),updatePropertes2.forEach((t=>{const i=_valueTransforms__WEBPACK_IMPORTED_MODULE_10__.Z[t].jsonToCzm(this[t]);e&&(e[t]=i)})),e&&updateCoefficients(e)}))),this._disposers.push((0,mobx__WEBPACK_IMPORTED_MODULE_0__.reaction)((()=>({guid:this.gvolFlattenGuid,tileset:this._tileset})),(()=>{this._unregisterFlattened=this._unregisterFlattened&&this._unregisterFlattened(),this._tileset&&this.gvolFlattenGuid&&(this._unregisterFlattened=this._earth.registerObject(this.gvolFlattenGuid,(e=>{e instanceof _FlattenedPolygonCollection__WEBPACK_IMPORTED_MODULE_7__.Z&&setTimeout((()=>{this._tileset._flattenedPolygonTexture=e.flattenedPolygonTexture,this._flattenDiscardDisposer=(0,mobx__WEBPACK_IMPORTED_MODULE_0__.autorun)((()=>{this._tileset.flattenDiscard=e.flattenDiscard}))}),0)}),(()=>{this._tileset._flattenedPolygonTexture=void 0,this._tileset.flattenDiscard=!1,this._flattenDiscardDisposer=this._flattenDiscardDisposer&&this._flattenDiscardDisposer()})))}),{fireImmediately:!0})),this._disposers.push((0,mobx__WEBPACK_IMPORTED_MODULE_0__.reaction)((()=>({style:this.gvolStyle,tileset:this._tileset})),(()=>{if(this._tileset){if(this.gvolStyle)try{const e=JSON.parse(this.gvolStyle);this._tileset.customStyle=new Cesium.Cesium3DTileStyle(e)}catch(error){try{var style=eval(this.gvolStyle+";style");this._tileset.customStyle=new Cesium.Cesium3DTileStyle(style)}catch(e){console.warn("3dtiles的style设置不合法！")}}else this._tileset.customStyle=void 0;this._tileset.makeStyleDirty(),this._tileset.style._colorShaderFunctionReady=!1,this._tileset.style._showShaderFunctionReady=!1,this._tileset.style._pointSizeShaderFunctionReady=!1}}),{fireImmediately:!0})),this._disposers.push((0,mobx__WEBPACK_IMPORTED_MODULE_0__.reaction)((()=>({gvolUseOriginTransform:this.gvolUseOriginTransform,gvolPosition:this.gvolPosition.map((e=>e)),gvolRotation:this.gvolRotation.map((e=>e)),gvolScale:this.gvolScale.map((e=>e)),tileset:this._tileset,globalClippingPlanes:this._globalClippingPlanes.filter((e=>e.enabled)).map((e=>({position:[...e.position],rotation:[...e.rotation]})))})),(({globalClippingPlanes:e})=>{if(!this._tileset)return;const t=this._tileset;t.gvolUseOriginTransform=this.gvolUseOriginTransform,t.gvolPosition=this.gvolPosition,t.gvolRotation=this.gvolRotation,t.gvolScale=this.gvolScale,this._modelMatrixUpdaterDisposer&&(this._modelMatrixUpdaterDisposer(),this._modelMatrixUpdaterDisposer=void 0),this._modelMatrixUpdaterDisposer=this._scene.preUpdate.addEventListener((()=>{if(t.ready){t.gvolUseOriginTransform?Cesium.Matrix4.clone(Cesium.Matrix4.IDENTITY,t.modelMatrix):(0,_utils__WEBPACK_IMPORTED_MODULE_14__.Q)(t._root.transform,{gvolPosition:t.gvolPosition,gvolRotation:t.gvolRotation,gvolScale:t.gvolScale},t.modelMatrix),this._scratchPlane=this._scratchPlane||new Cesium.Plane(Cesium.Cartesian3.UNIT_X,0),this._scratchMatrix=this._scratchMatrix||new Cesium.Matrix4,t._root.updateTransform(t._modelMatrix),t._clippingPlanesOriginMatrixDirty=!0;const i=Cesium.Matrix4.inverse(t.clippingPlanesOriginMatrix,this._scratchMatrix);t.clippingPlanes.removeAll(),e.forEach((e=>{const r=(0,_utils__WEBPACK_IMPORTED_MODULE_14__.R)(...e.position,...e.rotation),n=Cesium.Plane.transform(Cesium.Plane.ORIGIN_XY_PLANE,r,this._scratchPlane),o=Cesium.Plane.transform(n,i,this._scratchPlane);t.clippingPlanes.add(Cesium.ClippingPlane.fromPlane(o))})),this._modelMatrixUpdaterDisposer&&(this._modelMatrixUpdaterDisposer(),this._modelMatrixUpdaterDisposer=void 0)}}))}),{fireImmediately:!0})),this._disposers.push((0,mobx__WEBPACK_IMPORTED_MODULE_0__.reaction)((()=>({gvolLeftTopView:this.gvolLeftTopView,gvolRightTopView:this.gvolRightTopView,gvolLeftBottomView:this.gvolLeftBottomView,gvolRightBottomView:this.gvolRightBottomView,tileset:this._tileset})),(()=>{if(!this._tileset)return;let e=0;this.gvolLeftTopView&&(e+=1),this.gvolRightTopView&&(e+=2),this.gvolLeftBottomView&&(e+=4),this.gvolRightBottomView&&(e+=8),this._tileset.gvolViewportIndex=e}),{fireImmediately:!0})),this._disposers.push(_Core_GvolBase__WEBPACK_IMPORTED_MODULE_2__.Z.registerProperty(this,"gvolClippingPlanes")),this._disposers.push((0,mobx__WEBPACK_IMPORTED_MODULE_0__.autorun)((()=>{const e=this.gvolClippingPlanes.edgeWidth,t=this.gvolClippingPlanes.edgeColor,i=this.gvolClippingPlanes.unionClippingRegions,r=this._tileset;r&&(r.clippingPlanes.edgeWidth=e,r.clippingPlanes.edgeColor=new Cesium.Color(...t),r.clippingPlanes.unionClippingRegions=i)}))),this._disposers.push((0,mobx__WEBPACK_IMPORTED_MODULE_0__.reaction)((()=>({gvolClippingPlanes:this.gvolClippingPlanes,gvolClippingPlanesPlanes:this.gvolClippingPlanes.planes.map((e=>e)),edgeWidth:this.gvolClippingPlanes.edgeWidth,tileset:this._tileset})),(()=>{if(this._unregisterClippingPlanesCollection=this._unregisterClippingPlanesCollection||[],this._unregisterClippingPlanesCollection.forEach((e=>e())),this._unregisterClippingPlanesCollection.length=0,!this._tileset)return;const e=this._tileset;e.clippingPlanes.edgeWidth=this.gvolClippingPlanes.edgeWidth,e.clippingPlanes.unionClippingRegions=this.gvolClippingPlanes.unionClippingRegions,this._globalClippingPlanes=this._globalClippingPlanes||[];const t=e=>{if(!e instanceof _ClippingPlane__WEBPACK_IMPORTED_MODULE_6__.Z)throw new Error("裁剪面类型出错！");this._globalClippingPlanes.push(e)},i=e=>{const t=this._globalClippingPlanes.indexOf(e);this._globalClippingPlanes.splice(t,1)};this.gvolClippingPlanes.planes.forEach((e=>{this._unregisterClippingPlanesCollection.push(this._earth.registerObject(e,t,i))}))}),{fireImmediately:!0})),this._disposers.push((0,mobx__WEBPACK_IMPORTED_MODULE_0__.reaction)((()=>({gvolCriticalElevation:this.gvolCriticalElevation,gvolCriticalElevationColor:[...this.gvolCriticalElevationColor],tileset:this._tileset})),(()=>{if(!this._tileset)return;this._tileset.criticalElevation=this.gvolCriticalElevation;const e=this._tileset.criticalElevationColor;e.red=this.gvolCriticalElevationColor[0],e.green=this.gvolCriticalElevationColor[1],e.blue=this.gvolCriticalElevationColor[2],e.alpha=this.gvolCriticalElevationColor[3]}),{fireImmediately:!0})),this._disposers.push((0,_Scene_Interaction_registerInteractionProperty__WEBPACK_IMPORTED_MODULE_5__.Ak)(this._earth,this,{positionProperty:"gvolPosition"})),this._disposers.push((0,_Scene_Interaction_registerInteractionProperty__WEBPACK_IMPORTED_MODULE_5__.J_)(this._earth,this,{positionProperty:"gvolPosition",rotationProperty:"gvolRotation"})),(0,mobx__WEBPACK_IMPORTED_MODULE_0__.extendObservable)(this,{_ready:!1,get ready(){return this._ready},set ready(e){this._ready!==e&&(this._ready=e)}},{ready:mobx__WEBPACK_IMPORTED_MODULE_0__.computed}),this._readyDisposer=void 0,this._disposers.push((()=>this._readyDisposer=this._readyDisposer&&this._readyDisposer())),this._disposers.push((0,mobx__WEBPACK_IMPORTED_MODULE_0__.reaction)((()=>this._tileset),(e=>{this._readyDisposer=this._readyDisposer&&this._readyDisposer(),this.ready=!1,e?this._readyDisposer=(()=>{let t=!0;return e.readyPromise.then((()=>{t&&(this.ready=!0),this._readyDisposer=this._readyDisposer&&this._readyDisposer()})),()=>t=!1})():this.ready=!1}))),this._clickedAttachedInfo=void 0,this._hoveredAttachedInfo=void 0,this.disposers.push(_Core_GvolBase__WEBPACK_IMPORTED_MODULE_2__.Z.registerPathAttachedGuid(this,{positionProperty:"gvolPosition",rotationProperty:"gvolRotation"}))}onclick(e){this._clickedAttachedInfo=e,this._tileset&&this._tileset.makeStyleDirty()}onclickout(e){this._clickedAttachedInfo=void 0,this._tileset&&this._tileset.makeStyleDirty()}onmouseover(e){this._hoveredAttachedInfo=e,this._tileset&&this._tileset.makeStyleDirty()}onmouseout(e){this._hoveredAttachedInfo=void 0,this._tileset&&this._tileset.makeStyleDirty()}flyTo(){const e=this._earth.czm.scene.camera;if(e.cancelFlight(),this._flyToDisposer)throw new Error("_flyToDisposer should be undefined!");e._currentFlight={cancelTween:()=>{this._flyToDisposer=this._flyToDisposer&&this._flyToDisposer()}},this.ready?this._scene.camera.flyToBoundingSphere(this._tileset.boundingSphere):this._flyToDisposer=(0,mobx__WEBPACK_IMPORTED_MODULE_0__.reaction)((()=>this.ready),(e=>{if(e){if(!this._tileset||!this._tileset.ready)throw new Error("this._tileset.ready should be true!");this._scene.camera.flyToBoundingSphere(this._tileset.boundingSphere),this._flyToDisposer=this._flyToDisposer&&this._flyToDisposer()}})),this._flyToOnlyOnce||(this._flyToOnlyOnce=!0,this.disposers.push((()=>{this._flyToDisposer=this._flyToDisposer&&this._flyToDisposer()})))}getOriginPosition(){if(this._tileset&&this._tileset.ready){const e=Cesium.Matrix4.getTranslation(this._tileset._root.transform,new Cesium.Cartesian3),t=Cesium.Cartographic.fromCartesian(e);return[t.longitude,t.latitude,t.height]}}isDestroyed(){return!1}destroy(){return this._originPositionSetTimeoutID&&(clearTimeout(this._originPositionSetTimeoutID),this._originPositionSetTimeoutID=void 0),this._unregisterFlattened=this._unregisterFlattened&&this._unregisterFlattened(),this._modelMatrixUpdaterDisposer=this._modelMatrixUpdaterDisposer&&this._modelMatrixUpdaterDisposer(),this._disposers.forEach((e=>e())),this._disposers.length=0,this._tileset&&this._collection.remove(this._tileset),this._tileset=void 0,super.destroy()}}Tileset.defaultOptions=_defaultOptions__WEBPACK_IMPORTED_MODULE_9__.Z,_Core_GvolObject__WEBPACK_IMPORTED_MODULE_4__.Z.registerType(Tileset,"Tileset"),Tileset.gvolSchema=_gvolSchema__WEBPACK_IMPORTED_MODULE_12__.Z,Tileset.gvolClassification=_gvolClassification__WEBPACK_IMPORTED_MODULE_11__.Z,Tileset.gvolCustomShader={},Tileset.gvolCustomShader.builtinFsBody1="\n    // 可以修改的参数\n    // 注意shader中写浮点数是，一定要带小数点，否则会报错，比如0需要写成0.0，1要写成1.0\n    float _baseHeight = 0.0; // 物体的基础高度，需要修改成一个合适的建筑基础高度\n    float _heightRange = 60.0; // 高亮的范围(_baseHeight ~ _baseHeight + _heightRange) 默认是 0-60米\n    float _glowRange = 300.0; // 光环的移动范围(高度)\n\n    // 建筑基础色\n    float vtxf_height = v_elevationPos.z - _baseHeight;\n    float vtxf_a11 = fract(czm_frameNumber / 120.0) * 3.14159265 * 2.0;\n    float vtxf_a12 = vtxf_height / _heightRange + sin(vtxf_a11) * 0.1;\n    gl_FragColor *= vec4(vtxf_a12, vtxf_a12, vtxf_a12, 1.0);\n\n    // 动态光环\n    float vtxf_a13 = fract(czm_frameNumber / 360.0);\n    float vtxf_h = clamp(vtxf_height / _glowRange, 0.0, 1.0);\n    vtxf_a13 = abs(vtxf_a13 - 0.5) * 2.0;\n    float vtxf_diff = step(0.005, abs(vtxf_h - vtxf_a13));\n    gl_FragColor.rgb += gl_FragColor.rgb * (1.0 - vtxf_diff);\n";const __WEBPACK_DEFAULT_EXPORT__=Tileset},7602:(e,t,i)=>{"use strict";function r(e,t,i){return e&&e.ready&&e.color?e.color.evaluateColor(t,i):Cesium.Color.WHITE}function n(e,t){return!(e&&e.ready&&e.show)||e&&e.show&&e.show.evaluate(t)}i.d(t,{Z:()=>o});const o=function(e,t){e.style=new Cesium.Cesium3DTileStyle({}),e.style.show={evaluate:function(i){let r=n(e.customStyle,i);if(i&&i.content&&i.content._pointCloud)return r;let o=n(t.propertyStyle,i);return r&&o}};const i=e.gvolTileset;i.propertyStyle=t.propertyStyle,i.pickingStyle=t.interaction&&t.interaction.picking._defaultTilesetPickingStyle;const o=new Cesium.Color,s=new Cesium.Color,a=new Cesium.Color;e.style.color={evaluateColor:function(t,n){const l=r(e.customStyle,t,o)||Cesium.Color.WHITE;if(t&&t.content&&t.content._pointCloud)return Cesium.Color.clone(l,n);const h=i.propertyStyle,c=h&&r(h,t,s)||Cesium.Color.WHITE,u=i.pickingStyle,p=u&&r(u,t,a)||Cesium.Color.WHITE;return Cesium.Color.equals(p,Cesium.Color.WHITE)?(n=n||o,Cesium.Color.multiply(l,c,n)):Cesium.Color.clone(p,n)},getShaderFunction:function(...t){return e.customStyle&&e.customStyle.color&&e.customStyle.color.getShaderFunction(...t)},getShaderExpression:function(...t){return e.customStyle&&e.customStyle.color&&e.customStyle.color.getShaderExpression(...t)}},e.style.pointSize={evaluate:function(t,i){const r=e.customStyle;return r&&r.ready&&r.pointSize?r&&r.pointSize&&r.pointSize.evaluate(t):1},getShaderFunction:function(...t){return e.customStyle&&e.customStyle.pointSize&&e.customStyle.pointSize.getShaderFunction(...t)},getShaderExpression:function(...t){return e.customStyle&&e.customStyle.pointSize&&e.customStyle.pointSize.getShaderExpression(...t)}},Object.defineProperties(e.style,{pointOutlineColor:{get:()=>e.customStyle&&e.customStyle.pointOutlineColor,set(){}},pointOutlineWidth:{get:()=>e.customStyle&&e.customStyle.pointOutlineWidth,set(){}},labelColor:{get:()=>e.customStyle&&e.customStyle.labelColor,set(){}},labelOutlineColor:{get:()=>e.customStyle&&e.customStyle.labelOutlineColor,set(){}},labelOutlineWidth:{get:()=>e.customStyle&&e.customStyle.labelOutlineWidth,set(){}},labelStyle:{get:()=>e.customStyle&&e.customStyle.labelStyle,set(){}},font:{get:()=>e.customStyle&&e.customStyle.font,set(){}},labelText:{get:()=>e.customStyle&&e.customStyle.labelText,set(){}},backgroundColor:{get:()=>e.customStyle&&e.customStyle.backgroundColor,set(){}},backgroundPadding:{get:()=>e.customStyle&&e.customStyle.backgroundPadding,set(){}},backgroundEnabled:{get:()=>e.customStyle&&e.customStyle.backgroundEnabled,set(){}},scaleByDistance:{get:()=>e.customStyle&&e.customStyle.scaleByDistance,set(){}},translucencyByDistance:{get:()=>e.customStyle&&e.customStyle.translucencyByDistance,set(){}},distanceDisplayCondition:{get:()=>e.customStyle&&e.customStyle.distanceDisplayCondition,set(){}},heightOffset:{get:()=>e.customStyle&&e.customStyle.heightOffset,set(){}},anchorLineEnabled:{get:()=>e.customStyle&&e.customStyle.anchorLineEnabled,set(){}},anchorLineColor:{get:()=>e.customStyle&&e.customStyle.anchorLineColor,set(){}},image:{get:()=>e.customStyle&&e.customStyle.image,set(){}},disableDepthTestDistance:{get:()=>e.customStyle&&e.customStyle.disableDepthTestDistance,set(){}},horizontalOrigin:{get:()=>e.customStyle&&e.customStyle.horizontalOrigin,set(){}},verticalOrigin:{get:()=>e.customStyle&&e.customStyle.verticalOrigin,set(){}},labelHorizontalOrigin:{get:()=>e.customStyle&&e.customStyle.labelHorizontalOrigin,set(){}},labelVerticalOrigin:{get:()=>e.customStyle&&e.customStyle.labelVerticalOrigin,set(){}},gvolPositionOffset:{get:()=>e.customStyle&&e.customStyle.gvolPositionOffset,set(){}}}),e.clippingPlanes=new Cesium.ClippingPlaneCollection({planes:[],edgeWidth:1,unionClippingRegions:!1})}},9990:(e,t,i)=>{"use strict";let r,n,o,s,a,l;function h(e,{gvolPosition:t,gvolRotation:i,gvolScale:s},a){r=r||new Cesium.Matrix4,n=n||new Cesium.Matrix4,o=o||new Cesium.Cartesian3;const l=Cesium.Matrix4.inverseTransformation(e,r),h=Cesium.Cartesian3.fromRadians(t[0],t[1],t[2],void 0,o),c=new Cesium.HeadingPitchRoll(i[0],i[1],i[2]);let u=Cesium.Transforms.headingPitchRollToFixedFrame(h,c);const p=Cesium.Matrix4.fromScale(new Cesium.Cartesian3(...s),n);return u=Cesium.Matrix4.multiply(u,p,u),Cesium.Matrix4.multiply(u,l,a),a}function c(e,t,i,r,n,o,h){h||(h=new Cesium.Matrix4),s=s||new Cesium.Cartesian3,a=a||new Cesium.HeadingPitchRoll,l=l||new Cesium.Matrix4;var c=Cesium.Cartesian3.fromRadians(e,t,i,void 0,s);a.heading=r,a.pitch=n,a.roll=o;var u=Cesium.Transforms.headingPitchRollToFixedFrame(c,a,void 0,void 0,h);return Cesium.Matrix4.multiply(u,Cesium.Axis.Z_UP_TO_X_UP,u),h}i.d(t,{Q:()=>h,R:()=>c})},6593:(e,t,i)=>{"use strict";i.d(t,{Z:()=>u});var r=i(5108);const n=[["ClassificationType.NONE",void 0],["ClassificationType.BOTH",2],["ClassificationType.CESIUM_3D_TILE",1],["ClassificationType.TERRAIN",0]],o=new Map(n,n.map((([e,t])=>[t,e]))),s=[["ShadowMode.DISABLED",0],["ShadowMode.ENABLED",1],["ShadowMode.CAST_ONLY",2],["ShadowMode.RECEIVE_ONLY",3]],a=new Map(s,s.map((([e,t])=>[t,e]))),l=[["Cesium3DTileColorBlendMode.HIGHLIGHT",0],["Cesium3DTileColorBlendMode.REPLACE",1],["Cesium3DTileColorBlendMode.MIX",2]],h=new Map(l,l.map((([e,t])=>[t,e]))),c=(e,t)=>{if(!e.has(t))throw new Error(`prop ${t} is not right value!!!`);return e.get(t)},u={classificationType:{jsonToCzm:e=>c(o,e),czmToJson:e=>c(o,e)},shadows:{jsonToCzm:e=>c(a,e),czmToJson:e=>c(a,e)},colorBlendMode:{jsonToCzm:e=>c(h,e),czmToJson:e=>c(h,e)},imageBasedLightingFactor:{jsonToCzm:(e,t)=>Cesium.Cartesian2.fromArray(e,0,t),czmToJson:(e,t)=>((t=t||new Array(2))[0]=e.x,t[1]=e.y,t)},lightColor:{jsonToCzm:(e,t)=>e&&3===e.length?(Array.isArray(e)&&3===e.length&&!e.some((e=>"number"!=typeof e))||r.error("lightColor value type error!"),Cesium.Cartesian3.fromArray(e,0,t)):void 0,czmToJson:(e,t)=>(t=t||new Array(3),void 0===e?t=void 0:(t[0]=e.x,t[1]=e.y,t[2]=e.z),t)},specularEnvironmentMaps:{jsonToCzm:e=>void 0===e?void 0:e,czmToJson:e=>void 0===e?void 0:e}}},3765:(e,t,i)=>{"use strict";function r(e,t){var i=document.getElementsByTagName("head")[0],r=document.createElement("script");r.setAttribute("type","text/javascript"),r.setAttribute("src",e),r.onload=r.onreadystatechange=function(){!this.readyState||"loaded"==this.readyState||this.readyState,t&&t(),r.onload=r.onreadystatechange=null},i.appendChild(r)}function n(e,t=!0){if(t){const t=window.L;window.L&&(window.L=void 0);const i=window.define;return window.define&&(window.define=void 0),new Promise(((t,i)=>{r(e,t)})).then((()=>(window.define=i,window.L=t,Promise.resolve())))}return new Promise(((t,i)=>{r(e,t)}))}function o(e){var t=e.url,i="function"==typeof e.callback?e.callback:function(){},r=e.id,n=document.createElement("link"),o="onload"in n,s=+navigator.userAgent.replace(/.*(?:AppleWebKit|AndroidWebKit)\/?(\d+).*/i,"$1")<536;function a(){n.onload=n.onerror=n.onreadystatechange=null,n=null,i()}function l(e,t,i){var r,n=e.sheet;if((i+=1)>3e5)return r=!0,e=null,void t();if(s)n&&(r=!0);else if(n)try{n.cssRules&&(r=!0)}catch(e){"NS_ERROR_DOM_SECURITY_ERR"===e.name&&(r=!0)}setTimeout((function(){r?t():l(e,t,i)}),20)}n.rel="stylesheet",n.type="text/css",n.href=t,void 0!==r&&(n.id=r),document.getElementsByTagName("head")[0].appendChild(n),!s&&o?o?(n.onload=a,n.onerror=function(){a()}):n.onreadystatechange=function(){/loaded|complete/.test(n.readyState)&&a()}:setTimeout((function(){l(n,i,0)}),1)}function s(e){return new Promise(((t,i)=>{o({url:e,callback:t})}))}let a;i.d(t,{Z:()=>h});const l={loadJS:n,loadCSS:s,addCSS:function(e){var t=document.getElementById("styles_js");t||((t=document.createElement("style")).type="text/css",t.id="styles_js",document.getElementsByTagName("head")[0].appendChild(t)),t.appendChild(document.createTextNode(e))},autoLoad:function(e){return e.endsWith(".js")?n(e):e.endsWith(".css")?s(e):void 0},loadCesium:function(e){if("undefined"!=typeof Cesium)return Promise.resolve(Cesium);const t=s(e+"Widgets/widgets.css");let i;return i=n(e+"Cesium.js"),Promise.all([t,i])},loadThreeJS:function(e,t=!0){return n(e,t)},loadMapV:function(){return n(l.gvolEarthDir+"resources/thirdParty/mapv/mapv.min.js")},getScriptBaseUrl:function(e="geovisearth.sdk"){for(var t=new RegExp(`((?:.*/)|^)${e}.js(?:W|$)`,"i"),i=document.getElementsByTagName("script"),r=0,n=i.length;r<n;++r){var o=i[r].getAttribute("src"),s=t.exec(o);if(null!==s)return s[1]}},createElement:function(e){const t=document.createElement("template");return t.innerHTML=e.trim(),t.content.firstChild},div2Canvas:async function(e,t){if(!globalThis._x_20200729_captureWrapper){var i=document.createElement("div");i.style.opacity="0",i.style.position="absolute",document.body.append(i),globalThis._x_20200729_captureWrapper=i}if(!globalThis._x_20200729_capture){var r=document.createElement("div");globalThis._x_20200729_captureWrapper.append(r),globalThis._x_20200729_capture=r}return"string"==typeof e?globalThis._x_20200729_capture.innerHTML=e:e instanceof HTMLElement&&(globalThis._x_20200729_capture.innerHTML="",globalThis._x_20200729_capture.append(e)),await async function(){return void 0!==window.html2canvas?Promise.resolve():(a||(a=l.loadJS(l.gvolEarthDir+"resources/thirdParty/html2canvas/0.5.0-beta4/html2canvas.min.js")),await a)}(),await html2canvas(globalThis._x_20200729_capture,t)},get nativeCesiumDir(){return window.gvolNativeCesiumDir="",window.gvolNativeCesiumDir=window.gvolNativeCesiumDir||window.gvolCesiumDir||l.getScriptBaseUrl("geovisearth.sdk")+"/resources/gvolCesium/",window.gvolNativeCesiumDir?window.gvolNativeCesiumDir:""},get cesiumDir(){return window.gvolCesiumDir="",window.gvolCesiumDir=window.gvolCesiumDir||l.getScriptBaseUrl("geovisearth.sdk")+"/resources/gvolCesium/",window.gvolCesiumDir?window.gvolCesiumDir:""},get gvolEarthDir(){return window.gvolEarthDir="",window.gvolEarthDir=window.gvolEarthDir||l.getScriptBaseUrl("geovisearth.sdk"),window.gvolEarthDir?window.gvolEarthDir:""}},h=l},2647:()=>{let e;Reflect.getOwnPropertyDescriptor(String.prototype,"xeColor")||Object.defineProperties(String.prototype,{xeColor:{get(){e=e||new Cesium.Color;const t=Cesium.Color.fromCssColorString(this,e);if(t)return[t.red,t.green,t.blue,t.alpha]}},xec:{get(){return this.xeColor}}})},8905:()=>{!function(){if(Reflect.getOwnPropertyDescriptor(String.prototype,"xeColor"))return;Object.defineProperties(Array.prototype,{xeptr:{enumerable:!1,get(){if(3!==this.length)throw new Error("ptr只有在表示位置时（只有三个元素），才能使用！");return this[0]=this[0]*Math.PI/180,this[1]=this[1]*Math.PI/180,this}},xePositionToRadians:{enumerable:!1,get(){return this.xeptr}},xeptd:{enumerable:!1,get(){if(3!==this.length)throw new Error("ptd只有在表示位置时（只有三个元素），才能使用！");return this[0]=180*this[0]/Math.PI,this[1]=180*this[1]/Math.PI,this}},xePositionToDegrees:{enumerable:!1,get(){return this.xeptd}},xertr:{enumerable:!1,get(){if(3!==this.length)throw new Error("rtr只有在表示姿态时（只有三个元素），才能使用！");return this[0]=this[0]*Math.PI/180,this[1]=this[1]*Math.PI/180,this[2]=this[2]*Math.PI/180,this}},xeRotationToRadians:{enumerable:!1,get(){return this.xertr}},xertd:{enumerable:!1,get(){if(3!==this.length)throw new Error("rtd只有在表示姿态时（只有三个元素），才能使用！");return this[0]=180*this[0]/Math.PI,this[1]=180*this[1]/Math.PI,this[2]=180*this[2]/Math.PI,this}},xeRotationToDegrees:{enumerable:!1,get(){return this.xertd}}});const e=function(e=0,t=0,i=0){const r=e/(6378137*Math.cos(this[1])),n=t/6378137,o=i;return this[0]+=r,this[1]+=n,this[2]+=o,this};let t,i;Object.defineProperties(Array.prototype,{xePositionMove:{enumerable:!1,get:()=>e},xepm:{enumerable:!1,get:()=>e}});const r=function(e){t=t||new Cesium.Cartesian3,i=i||new Cesium.Cartesian3;const r=Cesium.Cartesian3.fromRadians(...this,void 0,t),n=Cesium.Cartesian3.fromRadians(...e,void 0,i);return Cesium.Cartesian3.distance(r,n)};Object.defineProperties(Array.prototype,{xePositionDistance:{enumerable:!1,get:()=>r},xepd:{enumerable:!1,get:()=>r}});const n=function(e){return Cesium.Math.equalsEpsilon(this[0],e[0],0,Cesium.Math.EPSILON7)&&Cesium.Math.equalsEpsilon(this[1],e[1],0,Cesium.Math.EPSILON7)&&Cesium.Math.equalsEpsilon(this[2],e[2],0,Cesium.Math.EPSILON3)},o=function(e){return Cesium.Math.equalsEpsilon(this[0],e[0],0,Cesium.Math.EPSILON3)&&Cesium.Math.equalsEpsilon(this[1],e[1],0,Cesium.Math.EPSILON3)&&Cesium.Math.equalsEpsilon(this[2],e[2],0,Cesium.Math.EPSILON3)};Object.defineProperties(Array.prototype,{xePositionEqual:{enumerable:!1,get:()=>n},xepe:{enumerable:!1,get:()=>n},xeRotationEqual:{enumerable:!1,get:()=>o},xere:{enumerable:!1,get:()=>o}})}()},3502:(e,t,i)=>{"use strict";i.r(t),i.d(t,{creatJB:()=>o});var r=i(5108);function n(e,t){let i=new Module.GVHelper(t);if(e.length%3!=0)return r.warn("make sure the size of `arr` is multiples of 3"),null;const n=function(e){const t=new Float64Array(e.length);return e.map(((e,i)=>{t[i]=e})),t}(e),o=n.length*n.BYTES_PER_ELEMENT;let s=Module._malloc(o);const a=new Float64Array(Module.HEAPF64.buffer,s,e.length);a.set(new Float64Array(n.buffer)),i.setControlPoints(a.byteOffset,e.length),Module._free(s),i.toVertice();let l=[],h=i.getGeoParams().size();for(let e=0;e<h;e++){let t=i.getGeoParamsByIndex(e).getVtxBuffer();const r=t.size();let n=[];for(var c=0;c<r;c++){const e=t.get(c);n.push(e.getLon(),e.getLat(),e.getAlt())}n.length>2&&l.push(n)}return{geoArray:l}}function o(e,t,i){let r={controlPoint:null,polylinePoint:null,polyNum:null};if(t.length<2)return r;let o=t.length-1;if(t[o][0].toFixed(8)==t[o-1][0].toFixed(8)&&t[o][1].toFixed(8)==t[o-1][1].toFixed(8))return r;let s=[];i||(i=0),t.forEach((e=>{s.push(...e),s.push(i)}));let a=n(s,e),l=[];for(const e of a.geoArray){if(e.length<2||e.length%3!=0)return r;l.push(Cesium.Cartesian3.fromDegreesArrayHeights(e))}return r.controlPoint=t,r.polylineList=l,r.geoCount=a.geoCount,r}},8897:function(e,t,i){var r=i(5108);
/*!
 * html2canvas 1.0.0-rc.5 <https://html2canvas.hertzen.com>
 * Copyright (c) 2019 Niklas von Hertzen <https://hertzen.com>
 * Released under MIT License
 */e.exports=function(){"use strict";
/*! *****************************************************************************
  Copyright (c) Microsoft Corporation. All rights reserved.
  Licensed under the Apache License, Version 2.0 (the "License"); you may not use
  this file except in compliance with the License. You may obtain a copy of the
  License at http://www.apache.org/licenses/LICENSE-2.0
   THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
  WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
  MERCHANTABLITY OR NON-INFRINGEMENT.
   See the Apache Version 2.0 License for specific language governing permissions
  and limitations under the License.
  ***************************************************************************** */var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},e(t,i)};function t(t,i){function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}var i=function(){return i=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},i.apply(this,arguments)};function n(e,t,i,r){return new(i||(i=Promise))((function(n,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?n(e.value):new i((function(t){t(e.value)})).then(s,a)}l((r=r.apply(e,t||[])).next())}))}function o(e,t){var i,r,n,o,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(e){return function(t){return l([e,t])}}function l(o){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,r&&(n=2&o[0]?r.return:o[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,o[1])).done)return n;switch(r=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((n=(n=s.trys).length>0&&n[n.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){s.label=o[1];break}if(6===o[0]&&s.label<n[1]){s.label=n[1],n=o;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(o);break}n[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{i=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}}for(var s=function(){function e(e,t,i,r){this.left=e,this.top=t,this.width=i,this.height=r}return e.prototype.add=function(t,i,r,n){return new e(this.left+t,this.top+i,this.width+r,this.height+n)},e.fromClientRect=function(t){return new e(t.left,t.top,t.width,t.height)},e}(),a=function(e){return s.fromClientRect(e.getBoundingClientRect())},l=function(e){var t=e.body,i=e.documentElement;if(!t||!i)throw new Error("Unable to get document size");var r=Math.max(Math.max(t.scrollWidth,i.scrollWidth),Math.max(t.offsetWidth,i.offsetWidth),Math.max(t.clientWidth,i.clientWidth)),n=Math.max(Math.max(t.scrollHeight,i.scrollHeight),Math.max(t.offsetHeight,i.offsetHeight),Math.max(t.clientHeight,i.clientHeight));return new s(0,0,r,n)},h=function(e){for(var t=[],i=0,r=e.length;i<r;){var n=e.charCodeAt(i++);if(n>=55296&&n<=56319&&i<r){var o=e.charCodeAt(i++);56320==(64512&o)?t.push(((1023&n)<<10)+(1023&o)+65536):(t.push(n),i--)}else t.push(n)}return t},c=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(String.fromCodePoint)return String.fromCodePoint.apply(String,e);var i=e.length;if(!i)return"";for(var r=[],n=-1,o="";++n<i;){var s=e[n];s<=65535?r.push(s):(s-=65536,r.push(55296+(s>>10),s%1024+56320)),(n+1===i||r.length>16384)&&(o+=String.fromCharCode.apply(String,r),r.length=0)}return o},u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",p="undefined"==typeof Uint8Array?[]:new Uint8Array(256),d=0;d<u.length;d++)p[u.charCodeAt(d)]=d;var m,f=function(e){var t,i,r,n,o,s=.75*e.length,a=e.length,l=0;"="===e[e.length-1]&&(s--,"="===e[e.length-2]&&s--);var h="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array&&void 0!==Uint8Array.prototype.slice?new ArrayBuffer(s):new Array(s),c=Array.isArray(h)?h:new Uint8Array(h);for(t=0;t<a;t+=4)i=p[e.charCodeAt(t)],r=p[e.charCodeAt(t+1)],n=p[e.charCodeAt(t+2)],o=p[e.charCodeAt(t+3)],c[l++]=i<<2|r>>4,c[l++]=(15&r)<<4|n>>2,c[l++]=(3&n)<<6|63&o;return h},g=function(e){for(var t=e.length,i=[],r=0;r<t;r+=2)i.push(e[r+1]<<8|e[r]);return i},A=function(e){for(var t=e.length,i=[],r=0;r<t;r+=4)i.push(e[r+3]<<24|e[r+2]<<16|e[r+1]<<8|e[r]);return i},y=5,v=11,C=2,_=65536>>y,b=(1<<y)-1,w=_+(1024>>y)+32,P=65536>>v,S=(1<<v-y)-1,x=function(e,t,i){return e.slice?e.slice(t,i):new Uint16Array(Array.prototype.slice.call(e,t,i))},B=function(e,t,i){return e.slice?e.slice(t,i):new Uint32Array(Array.prototype.slice.call(e,t,i))},M=function(e){var t=f(e),i=Array.isArray(t)?A(t):new Uint32Array(t),r=Array.isArray(t)?g(t):new Uint16Array(t),n=24,o=x(r,n/2,i[4]/2),s=2===i[5]?x(r,(n+i[4])/2):B(i,Math.ceil((n+i[4])/4));return new E(i[0],i[1],i[2],i[3],o,s)},E=function(){function e(e,t,i,r,n,o){this.initialValue=e,this.errorValue=t,this.highStart=i,this.highValueIndex=r,this.index=n,this.data=o}return e.prototype.get=function(e){var t;if(e>=0){if(e<55296||e>56319&&e<=65535)return t=((t=this.index[e>>y])<<C)+(e&b),this.data[t];if(e<=65535)return t=((t=this.index[_+(e-55296>>y)])<<C)+(e&b),this.data[t];if(e<this.highStart)return t=w-P+(e>>v),t=this.index[t],t+=e>>y&S,t=((t=this.index[t])<<C)+(e&b),this.data[t];if(e<=1114111)return this.data[this.highValueIndex]}return this.errorValue},e}(),T=50,O=1,L=2,D=3,I=4,R=5,H=7,F=8,N=9,Q=10,k=11,U=12,j=13,G=14,z=15,Y=16,Z=17,W=18,X=19,J=20,K=21,V=22,q=23,$=24,ee=25,te=26,ie=27,re=28,ne=29,oe=30,se=31,ae=32,le=33,he=34,ce=35,ue=36,pe=37,de=38,me=39,fe=40,ge=41,Ae=42,ye=43,ve="!",Ce="×",_e="÷",be=M("KwAAAAAAAAAACA4AIDoAAPAfAAACAAAAAAAIABAAGABAAEgAUABYAF4AZgBeAGYAYABoAHAAeABeAGYAfACEAIAAiACQAJgAoACoAK0AtQC9AMUAXgBmAF4AZgBeAGYAzQDVAF4AZgDRANkA3gDmAOwA9AD8AAQBDAEUARoBIgGAAIgAJwEvATcBPwFFAU0BTAFUAVwBZAFsAXMBewGDATAAiwGTAZsBogGkAawBtAG8AcIBygHSAdoB4AHoAfAB+AH+AQYCDgIWAv4BHgImAi4CNgI+AkUCTQJTAlsCYwJrAnECeQKBAk0CiQKRApkCoQKoArACuALAAsQCzAIwANQC3ALkAjAA7AL0AvwCAQMJAxADGAMwACADJgMuAzYDPgOAAEYDSgNSA1IDUgNaA1oDYANiA2IDgACAAGoDgAByA3YDfgOAAIQDgACKA5IDmgOAAIAAogOqA4AAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAK8DtwOAAIAAvwPHA88D1wPfAyAD5wPsA/QD/AOAAIAABAQMBBIEgAAWBB4EJgQuBDMEIAM7BEEEXgBJBCADUQRZBGEEaQQwADAAcQQ+AXkEgQSJBJEEgACYBIAAoASoBK8EtwQwAL8ExQSAAIAAgACAAIAAgACgAM0EXgBeAF4AXgBeAF4AXgBeANUEXgDZBOEEXgDpBPEE+QQBBQkFEQUZBSEFKQUxBTUFPQVFBUwFVAVcBV4AYwVeAGsFcwV7BYMFiwWSBV4AmgWgBacFXgBeAF4AXgBeAKsFXgCyBbEFugW7BcIFwgXIBcIFwgXQBdQF3AXkBesF8wX7BQMGCwYTBhsGIwYrBjMGOwZeAD8GRwZNBl4AVAZbBl4AXgBeAF4AXgBeAF4AXgBeAF4AXgBeAGMGXgBqBnEGXgBeAF4AXgBeAF4AXgBeAF4AXgB5BoAG4wSGBo4GkwaAAIADHgR5AF4AXgBeAJsGgABGA4AAowarBrMGswagALsGwwbLBjAA0wbaBtoG3QbaBtoG2gbaBtoG2gblBusG8wb7BgMHCwcTBxsHCwcjBysHMAc1BzUHOgdCB9oGSgdSB1oHYAfaBloHaAfaBlIH2gbaBtoG2gbaBtoG2gbaBjUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHbQdeAF4ANQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQd1B30HNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1B4MH2gaKB68EgACAAIAAgACAAIAAgACAAI8HlwdeAJ8HpweAAIAArwe3B14AXgC/B8UHygcwANAH2AfgB4AA6AfwBz4B+AcACFwBCAgPCBcIogEYAR8IJwiAAC8INwg/CCADRwhPCFcIXwhnCEoDGgSAAIAAgABvCHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIhAiLCI4IMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlggwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAANQc1BzUHNQc1BzUHNQc1BzUHNQc1B54INQc1B6II2gaqCLIIugiAAIAAvgjGCIAAgACAAIAAgACAAIAAgACAAIAAywiHAYAA0wiAANkI3QjlCO0I9Aj8CIAAgACAAAIJCgkSCRoJIgknCTYHLwk3CZYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiAAIAAAAFAAXgBeAGAAcABeAHwAQACQAKAArQC9AJ4AXgBeAE0A3gBRAN4A7AD8AMwBGgEAAKcBNwEFAUwBXAF4QkhCmEKnArcCgAHHAsABz4LAAcABwAHAAd+C6ABoAG+C/4LAAcABwAHAAc+DF4MAAcAB54M3gweDV4Nng3eDaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAEeDqABVg6WDqABoQ6gAaABoAHXDvcONw/3DvcO9w73DvcO9w73DvcO9w73DvcO9w73DvcO9w73DvcO9w73DvcO9w73DvcO9w73DvcO9w73DvcO9w73DncPAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcAB7cPPwlGCU4JMACAAIAAgABWCV4JYQmAAGkJcAl4CXwJgAkwADAAMAAwAIgJgACLCZMJgACZCZ8JowmrCYAAswkwAF4AXgB8AIAAuwkABMMJyQmAAM4JgADVCTAAMAAwADAAgACAAIAAgACAAIAAgACAAIAAqwYWBNkIMAAwADAAMADdCeAJ6AnuCR4E9gkwAP4JBQoNCjAAMACAABUK0wiAAB0KJAosCjQKgAAwADwKQwqAAEsKvQmdCVMKWwowADAAgACAALcEMACAAGMKgABrCjAAMAAwADAAMAAwADAAMAAwADAAMAAeBDAAMAAwADAAMAAwADAAMAAwADAAMAAwAIkEPQFzCnoKiQSCCooKkAqJBJgKoAqkCokEGAGsCrQKvArBCjAAMADJCtEKFQHZCuEK/gHpCvEKMAAwADAAMACAAIwE+QowAIAAPwEBCzAAMAAwADAAMACAAAkLEQswAIAAPwEZCyELgAAOCCkLMAAxCzkLMAAwADAAMAAwADAAXgBeAEELMAAwADAAMAAwADAAMAAwAEkLTQtVC4AAXAtkC4AAiQkwADAAMAAwADAAMAAwADAAbAtxC3kLgAuFC4sLMAAwAJMLlwufCzAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAApwswADAAMACAAIAAgACvC4AAgACAAIAAgACAALcLMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAvwuAAMcLgACAAIAAgACAAIAAyguAAIAAgACAAIAA0QswADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAANkLgACAAIAA4AswADAAMAAwADAAMAAwADAAMAAwADAAMAAwAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACJCR4E6AswADAAhwHwC4AA+AsADAgMEAwwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMACAAIAAGAwdDCUMMAAwAC0MNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQw1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHPQwwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADUHNQc1BzUHNQc1BzUHNQc2BzAAMAA5DDUHNQc1BzUHNQc1BzUHNQc1BzUHNQdFDDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAgACAAIAATQxSDFoMMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAF4AXgBeAF4AXgBeAF4AYgxeAGoMXgBxDHkMfwxeAIUMXgBeAI0MMAAwADAAMAAwAF4AXgCVDJ0MMAAwADAAMABeAF4ApQxeAKsMswy7DF4Awgy9DMoMXgBeAF4AXgBeAF4AXgBeAF4AXgDRDNkMeQBqCeAM3Ax8AOYM7Az0DPgMXgBeAF4AXgBeAF4AXgBeAF4AXgBeAF4AXgBeAF4AXgCgAAANoAAHDQ4NFg0wADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAeDSYNMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAIAAgACAAIAAgACAAC4NMABeAF4ANg0wADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAD4NRg1ODVYNXg1mDTAAbQ0wADAAMAAwADAAMAAwADAA2gbaBtoG2gbaBtoG2gbaBnUNeg3CBYANwgWFDdoGjA3aBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gaUDZwNpA2oDdoG2gawDbcNvw3HDdoG2gbPDdYN3A3fDeYN2gbsDfMN2gbaBvoN/g3aBgYODg7aBl4AXgBeABYOXgBeACUG2gYeDl4AJA5eACwO2w3aBtoGMQ45DtoG2gbaBtoGQQ7aBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gZJDjUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1B1EO2gY1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQdZDjUHNQc1BzUHNQc1B2EONQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHaA41BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1B3AO2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gY1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1B2EO2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gZJDtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBkkOeA6gAKAAoAAwADAAMAAwAKAAoACgAKAAoACgAKAAgA4wADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAD//wQABAAEAAQABAAEAAQABAAEAA0AAwABAAEAAgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAKABMAFwAeABsAGgAeABcAFgASAB4AGwAYAA8AGAAcAEsASwBLAEsASwBLAEsASwBLAEsAGAAYAB4AHgAeABMAHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAFgAbABIAHgAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABYADQARAB4ABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAAUABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAkAFgAaABsAGwAbAB4AHQAdAB4ATwAXAB4ADQAeAB4AGgAbAE8ATwAOAFAAHQAdAB0ATwBPABcATwBPAE8AFgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAB4AUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAFAATwBAAE8ATwBPAEAATwBQAFAATwBQAB4AHgAeAB4AHgAeAB0AHQAdAB0AHgAdAB4ADgBQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgBQAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAkACQAJAAkACQAJAAkABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAFAAHgAeAB4AKwArAFAAUABQAFAAGABQACsAKwArACsAHgAeAFAAHgBQAFAAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUAAeAB4AHgAeAB4AHgArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAYAA0AKwArAB4AHgAbACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAB4ABAAEAB4ABAAEABMABAArACsAKwArACsAKwArACsAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAKwArACsAKwArAFYAVgBWAB4AHgArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AGgAaABoAGAAYAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQAEwAEACsAEwATAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABLAEsASwBLAEsASwBLAEsASwBLABoAGQAZAB4AUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABMAUAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABABQAFAABAAEAB4ABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUAAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAFAABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQAUABQAB4AHgAYABMAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAFAABAAEAAQABAAEAFAABAAEAAQAUAAEAAQABAAEAAQAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArACsAHgArAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAABAAEAAQABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAAQABAANAA0ASwBLAEsASwBLAEsASwBLAEsASwAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQAKwBQAFAAUABQAFAAUABQAFAAKwArAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUAArAFAAKwArACsAUABQAFAAUAArACsABABQAAQABAAEAAQABAAEAAQAKwArAAQABAArACsABAAEAAQAUAArACsAKwArACsAKwArACsABAArACsAKwArAFAAUAArAFAAUABQAAQABAArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAGgAaAFAAUABQAFAAUABMAB4AGwBQAB4AKwArACsABAAEAAQAKwBQAFAAUABQAFAAUAArACsAKwArAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUAArAFAAUAArAFAAUAArAFAAUAArACsABAArAAQABAAEAAQABAArACsAKwArAAQABAArACsABAAEAAQAKwArACsABAArACsAKwArACsAKwArAFAAUABQAFAAKwBQACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwAEAAQAUABQAFAABAArACsAKwArACsAKwArACsAKwArACsABAAEAAQAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUAArAFAAUAArAFAAUABQAFAAUAArACsABABQAAQABAAEAAQABAAEAAQABAArAAQABAAEACsABAAEAAQAKwArAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAAQABAArACsASwBLAEsASwBLAEsASwBLAEsASwAeABsAKwArACsAKwArACsAKwBQAAQABAAEAAQABAAEACsABAAEAAQAKwBQAFAAUABQAFAAUABQAFAAKwArAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQAKwArAAQABAArACsABAAEAAQAKwArACsAKwArACsAKwArAAQABAArACsAKwArAFAAUAArAFAAUABQAAQABAArACsASwBLAEsASwBLAEsASwBLAEsASwAeAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwAEAFAAKwBQAFAAUABQAFAAUAArACsAKwBQAFAAUAArAFAAUABQAFAAKwArACsAUABQACsAUAArAFAAUAArACsAKwBQAFAAKwArACsAUABQAFAAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAAQABAAEAAQAKwArACsABAAEAAQAKwAEAAQABAAEACsAKwBQACsAKwArACsAKwArAAQAKwArACsAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAB4AHgAeAB4AHgAeABsAHgArACsAKwArACsABAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAABAAEAAQABAAEAAQABAArAAQABAAEACsABAAEAAQABAArACsAKwArACsAKwArAAQABAArAFAAUABQACsAKwArACsAKwBQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAB4AUAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAArAAQABAAEACsABAAEAAQABAArACsAKwArACsAKwArAAQABAArACsAKwArACsAKwArAFAAKwBQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAFAABAAEAAQABAAEAAQABAArAAQABAAEACsABAAEAAQABABQAB4AKwArACsAKwBQAFAAUAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQABoAUABQAFAAUABQAFAAKwArAAQABAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQACsAUAArACsAUABQAFAAUABQAFAAUAArACsAKwAEACsAKwArACsABAAEAAQABAAEAAQAKwAEACsABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArAAQABAAeACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAXAAqACoAKgAqACoAKgAqACsAKwArACsAGwBcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAeAEsASwBLAEsASwBLAEsASwBLAEsADQANACsAKwArACsAKwBcAFwAKwBcACsAKwBcAFwAKwBcACsAKwBcACsAKwArACsAKwArAFwAXABcAFwAKwBcAFwAXABcAFwAXABcACsAXABcAFwAKwBcACsAXAArACsAXABcACsAXABcAFwAXAAqAFwAXAAqACoAKgAqACoAKgArACoAKgBcACsAKwBcAFwAXABcAFwAKwBcACsAKgAqACoAKgAqACoAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArAFwAXABcAFwAUAAOAA4ADgAOAB4ADgAOAAkADgAOAA0ACQATABMAEwATABMACQAeABMAHgAeAB4ABAAEAB4AHgAeAB4AHgAeAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUAANAAQAHgAEAB4ABAAWABEAFgARAAQABABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAANAAQABAAEAAQABAANAAQABABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsADQANAB4AHgAeAB4AHgAeAAQAHgAeAB4AHgAeAB4AKwAeAB4ADgAOAA0ADgAeAB4AHgAeAB4ACQAJACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqAFwASwBLAEsASwBLAEsASwBLAEsASwANAA0AHgAeAB4AHgBcAFwAXABcAFwAXAAqACoAKgAqAFwAXABcAFwAKgAqACoAXAAqACoAKgBcAFwAKgAqACoAKgAqACoAKgBcAFwAXAAqACoAKgAqAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAKgAqACoAKgAqACoAKgAqACoAXAAqAEsASwBLAEsASwBLAEsASwBLAEsAKgAqACoAKgAqACoAUABQAFAAUABQAFAAKwBQACsAKwArACsAKwBQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQACsAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwAEAAQABAAeAA0AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQACsAKwANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABYAEQArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAADQANAA0AUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAABAAEAAQAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAA0ADQArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQACsABAAEACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoADQANABUAXAANAB4ADQAbAFwAKgArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArAB4AHgATABMADQANAA4AHgATABMAHgAEAAQABAAJACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAUABQAFAAUABQAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABABQACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwAeACsAKwArABMAEwBLAEsASwBLAEsASwBLAEsASwBLAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAKwBcAFwAXABcAFwAKwArACsAKwArACsAKwArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBcACsAKwArACoAKgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEACsAKwAeAB4AXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAKgAqACoAKgAqACoAKgArACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgArACsABABLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKgAqACoAKgAqACoAKgBcACoAKgAqACoAKgAqACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQAUABQAFAAUABQAFAAUAArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsADQANAB4ADQANAA0ADQAeAB4AHgAeAB4AHgAeAB4AHgAeAAQABAAEAAQABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeACsAKwArAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAUABQAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAHgAeAB4AHgBQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwANAA0ADQANAA0ASwBLAEsASwBLAEsASwBLAEsASwArACsAKwBQAFAAUABLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAA0AUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsABAAEAAQAHgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAUABQAFAABABQAFAAUABQAAQABAAEAFAAUAAEAAQABAArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwAEAAQABAAEAAQAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUAArAFAAKwBQACsAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAHgAeAB4AHgAeAB4AHgAeAFAAHgAeAB4AUABQAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAKwArAB4AHgAeAB4AHgAeACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAUABQAFAAKwAeAB4AHgAeAB4AHgAeAA4AHgArAA0ADQANAA0ADQANAA0ACQANAA0ADQAIAAQACwAEAAQADQAJAA0ADQAMAB0AHQAeABcAFwAWABcAFwAXABYAFwAdAB0AHgAeABQAFAAUAA0AAQABAAQABAAEAAQABAAJABoAGgAaABoAGgAaABoAGgAeABcAFwAdABUAFQAeAB4AHgAeAB4AHgAYABYAEQAVABUAFQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgANAB4ADQANAA0ADQAeAA0ADQANAAcAHgAeAB4AHgArAAQABAAEAAQABAAEAAQABAAEAAQAUABQACsAKwBPAFAAUABQAFAAUAAeAB4AHgAWABEATwBQAE8ATwBPAE8AUABQAFAAUABQAB4AHgAeABYAEQArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAGwAbABsAGwAbABsAGwAaABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAaABsAGwAbABsAGgAbABsAGgAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgBQABoAHgAdAB4AUAAeABoAHgAeAB4AHgAeAB4AHgAeAB4ATwAeAFAAGwAeAB4AUABQAFAAUABQAB4AHgAeAB0AHQAeAFAAHgBQAB4AUAAeAFAATwBQAFAAHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAB4AUABQAFAAUABPAE8AUABQAFAAUABQAE8AUABQAE8AUABPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBQAFAAUABQAE8ATwBPAE8ATwBPAE8ATwBPAE8AUABQAFAAUABQAFAAUABQAFAAHgAeAFAAUABQAFAATwAeAB4AKwArACsAKwAdAB0AHQAdAB0AHQAdAB0AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAeAB0AHQAeAB4AHgAdAB0AHgAeAB0AHgAeAB4AHQAeAB0AGwAbAB4AHQAeAB4AHgAeAB0AHgAeAB0AHQAdAB0AHgAeAB0AHgAdAB4AHQAdAB0AHQAdAB0AHgAdAB4AHgAeAB4AHgAdAB0AHQAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAdAB4AHgAeAB4AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB4AHgAdAB0AHQAdAB4AHgAdAB0AHgAeAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAeAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHQAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABQAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAlACUAHgAeAB4AHgAeAB4AHgAeAB4AFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBQAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB4AHgAeAB4AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAdAB0AHQAdAB0AHQAdAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAeAB0AHQAeAB4AHgAeAB0AHQAeAB4AHgAeAB0AHQAdAB4AHgAdAB4AHgAdAB0AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB0AHQAeAB4AHQAeAB4AHgAeAB0AHQAeAB4AHgAeACUAJQAdAB0AJQAeACUAJQAlACAAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAHgAeAB4AHgAdAB4AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB4AHQAdAB0AHgAdACUAHQAdAB4AHQAdAB4AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAHQAdAB0AHQAlAB4AJQAlACUAHQAlACUAHQAdAB0AJQAlAB0AHQAlAB0AHQAlACUAJQAeAB0AHgAeAB4AHgAdAB0AJQAdAB0AHQAdAB0AHQAlACUAJQAlACUAHQAlACUAIAAlAB0AHQAlACUAJQAlACUAJQAlACUAHgAeAB4AJQAlACAAIAAgACAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHgAeABcAFwAXABcAFwAXAB4AEwATACUAHgAeAB4AFgARABYAEQAWABEAFgARABYAEQAWABEAFgARAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARABYAEQAWABEAFgARABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB0AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAEAAQABAAeAB4AKwArACsAKwArABMADQANAA0AUAATAA0AUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUAANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAA0ADQANAA0ADQANAA0ADQAeAA0AFgANAB4AHgAXABcAHgAeABcAFwAWABEAFgARABYAEQAWABEADQANAA0ADQATAFAADQANAB4ADQANAB4AHgAeAB4AHgAMAAwADQANAA0AHgANAA0AFgANAA0ADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArAA0AEQARACUAJQBHAFcAVwAWABEAFgARABYAEQAWABEAFgARACUAJQAWABEAFgARABYAEQAWABEAFQAWABEAEQAlAFcAVwBXAFcAVwBXAFcAVwBXAAQABAAEAAQABAAEACUAVwBXAFcAVwA2ACUAJQBXAFcAVwBHAEcAJQAlACUAKwBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBRAFcAUQBXAFEAVwBXAFcAVwBXAFcAUQBXAFcAVwBXAFcAVwBRAFEAKwArAAQABAAVABUARwBHAFcAFQBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBRAFcAVwBXAFcAVwBXAFEAUQBXAFcAVwBXABUAUQBHAEcAVwArACsAKwArACsAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwArACUAJQBXAFcAVwBXACUAJQAlACUAJQAlACUAJQAlACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwArACsAKwArACUAJQAlACUAKwArACsAKwArACsAKwArACsAKwArACsAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACsAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAE8ATwBPAE8ATwBPAE8ATwAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQAlACUAJQAlACUAJQAlACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADQATAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABLAEsASwBLAEsASwBLAEsASwBLAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAABAAEAAQABAAeAAQABAAEAAQABAAEAAQABAAEAAQAHgBQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAeAA0ADQANAA0ADQArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAAQAUABQAFAABABQAFAAUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAeAB4AHgAeACsAKwArACsAUABQAFAAUABQAFAAHgAeABoAHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADgAOABMAEwArACsAKwArACsAKwArACsABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwANAA0ASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUAAeAB4AHgBQAA4AUAArACsAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArAB4AWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYACsAKwArAAQAHgAeAB4AHgAeAB4ADQANAA0AHgAeAB4AHgArAFAASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArAB4AHgBcAFwAXABcAFwAKgBcAFwAXABcAFwAXABcAFwAXABcAEsASwBLAEsASwBLAEsASwBLAEsAXABcAFwAXABcACsAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAFAAUABQAAQAUABQAFAAUABQAFAAUABQAAQABAArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAHgANAA0ADQBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAXAAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAKgAqACoAXABcACoAKgBcAFwAXABcAFwAKgAqAFwAKgBcACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcACoAKgBQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAA0ADQBQAFAAUAAEAAQAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQADQAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAVABVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBUAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVACsAKwArACsAKwArACsAKwArACsAKwArAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAKwArACsAKwBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAKwArACsAKwAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAKwArACsAKwArAFYABABWAFYAVgBWAFYAVgBWAFYAVgBWAB4AVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgArAFYAVgBWAFYAVgArAFYAKwBWAFYAKwBWAFYAKwBWAFYAVgBWAFYAVgBWAFYAVgBWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAEQAWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAaAB4AKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAGAARABEAGAAYABMAEwAWABEAFAArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACUAJQAlACUAJQAWABEAFgARABYAEQAWABEAFgARABYAEQAlACUAFgARACUAJQAlACUAJQAlACUAEQAlABEAKwAVABUAEwATACUAFgARABYAEQAWABEAJQAlACUAJQAlACUAJQAlACsAJQAbABoAJQArACsAKwArAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAcAKwATACUAJQAbABoAJQAlABYAEQAlACUAEQAlABEAJQBXAFcAVwBXAFcAVwBXAFcAVwBXABUAFQAlACUAJQATACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXABYAJQARACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAWACUAEQAlABYAEQARABYAEQARABUAVwBRAFEAUQBRAFEAUQBRAFEAUQBRAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcARwArACsAVwBXAFcAVwBXAFcAKwArAFcAVwBXAFcAVwBXACsAKwBXAFcAVwBXAFcAVwArACsAVwBXAFcAKwArACsAGgAbACUAJQAlABsAGwArAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAAQAB0AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsADQANAA0AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsADQBQAFAAUABQACsAKwArACsAUABQAFAAUABQAFAAUABQAA0AUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUAArACsAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQACsAKwArAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgBQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwBQAFAAUABQAFAABAAEAAQAKwAEAAQAKwArACsAKwArAAQABAAEAAQAUABQAFAAUAArAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsABAAEAAQAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsADQANAA0ADQANAA0ADQANAB4AKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AUABQAFAAUABQAFAAUABQAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwArACsAUABQAFAAUABQAA0ADQANAA0ADQANABQAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwANAA0ADQANAA0ADQANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwBQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAA0ADQAeAB4AHgAeAB4AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsASwBLAEsASwBLAEsASwBLAEsASwANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAeAA4AUAArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAADQANAB4ADQAeAAQABAAEAB4AKwArAEsASwBLAEsASwBLAEsASwBLAEsAUAAOAFAADQANAA0AKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAANAA0AHgANAA0AHgAEACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAA0AKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsABAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAUAArACsAKwArACsAKwAEACsAKwArACsAKwBQAFAAUABQAFAABAAEACsAKwAEAAQABAAEAAQABAAEACsAKwArAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAAQABABQAFAAUABQAA0ADQANAA0AHgBLAEsASwBLAEsASwBLAEsASwBLACsADQArAB4AKwArAAQABAAEAAQAUABQAB4AUAArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEACsAKwAEAAQABAAEAAQABAAEAAQABAAOAA0ADQATABMAHgAeAB4ADQANAA0ADQANAA0ADQANAA0ADQANAA0ADQANAA0AUABQAFAAUAAEAAQAKwArAAQADQANAB4AUAArACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAKwAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAXABcAA0ADQANACoASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAFAABAAEAAQABAAOAB4ADQANAA0ADQAOAB4ABAArACsAKwArACsAKwArACsAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAUABQAFAAUAArACsAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAA0ADQANACsADgAOAA4ADQANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAAQABAAEAFAADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAOABMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAArACsAKwAEACsABAAEACsABAAEAAQABAAEAAQABABQAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABIAEgAQwBDAEMAUABQAFAAUABDAFAAUABQAEgAQwBIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABDAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwANAA0AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAANACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAA0ADQANAB4AHgAeAB4AHgAeAFAAUABQAFAADQAeACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAEcARwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwArACsAKwArACsAKwArACsAKwArACsAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQACsAKwAeAAQABAANAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAB4AHgAeAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAHgAeAAQABAAEAAQABAAEAAQAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgAEAAQABAAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAFAAUAArACsAUAArACsAUABQACsAKwBQAFAAUABQACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQACsAUABQAFAAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAKwAeAB4AUABQAFAAUABQACsAUAArACsAKwBQAFAAUABQAFAAUABQACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AKwArAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAEAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAeAB4ADQANAA0ADQAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABAArAAQABAArAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAEAAQABAAEAAQABAAEACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAFgAWAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArAFAAKwArAFAAKwBQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUAArAFAAKwBQACsAKwArACsAKwArAFAAKwArACsAKwBQACsAUAArAFAAKwBQAFAAUAArAFAAUAArAFAAKwArAFAAKwBQACsAUAArAFAAKwBQACsAUABQACsAUAArACsAUABQAFAAUAArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQACsAUABQAFAAUAArAFAAKwBQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwBQAFAAUAArAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAlACUAJQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeACUAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeACUAJQAlACUAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQAlACUAJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeACUAJQAlACUAJQAeACUAJQAlACUAJQAgACAAIAAlACUAIAAlACUAIAAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAIQAhACEAIQAhACUAJQAgACAAJQAlACAAIAAgACAAIAAgACAAIAAgACAAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAIAAgACAAIAAlACUAJQAlACAAJQAgACAAIAAgACAAIAAgACAAIAAlACUAJQAgACUAJQAlACUAIAAgACAAJQAgACAAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeACUAHgAlAB4AJQAlACUAJQAlACAAJQAlACUAJQAeACUAHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAIAAgACUAJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAIAAlACUAJQAlACAAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAIAAgACAAJQAlACUAIAAgACAAIAAgAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFwAXABcAFQAVABUAHgAeAB4AHgAlACUAJQAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAIAAgACAAJQAlACUAJQAlACUAJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACAAIAAlACAAIAAlACUAJQAlACUAJQAgACUAJQAlACUAJQAlACUAJQAlACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAIAAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACsAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsA"),we=[oe,ue],Pe=[O,L,D,R],Se=[Q,F],xe=[ie,te],Be=Pe.concat(Se),Me=[de,me,fe,he,ce],Ee=[z,j],Te=function(e,t){void 0===t&&(t="strict");var i=[],r=[],n=[];return e.forEach((function(e,o){var s=be.get(e);if(s>T?(n.push(!0),s-=T):n.push(!1),-1!==["normal","auto","loose"].indexOf(t)&&-1!==[8208,8211,12316,12448].indexOf(e))return r.push(o),i.push(Y);if(s===I||s===k){if(0===o)return r.push(o),i.push(oe);var a=i[o-1];return-1===Be.indexOf(a)?(r.push(r[o-1]),i.push(a)):(r.push(o),i.push(oe))}return r.push(o),s===se?i.push("strict"===t?K:pe):s===Ae||s===ne?i.push(oe):s===ye?e>=131072&&e<=196605||e>=196608&&e<=262141?i.push(pe):i.push(oe):void i.push(s)})),[r,i,n]},Oe=function(e,t,i,r){var n=r[i];if(Array.isArray(e)?-1!==e.indexOf(n):e===n)for(var o=i;o<=r.length;){if((l=r[++o])===t)return!0;if(l!==Q)break}if(n===Q)for(o=i;o>0;){var s=r[--o];if(Array.isArray(e)?-1!==e.indexOf(s):e===s)for(var a=i;a<=r.length;){var l;if((l=r[++a])===t)return!0;if(l!==Q)break}if(s!==Q)break}return!1},Le=function(e,t){for(var i=e;i>=0;){var r=t[i];if(r!==Q)return r;i--}return 0},De=function(e,t,i,r,n){if(0===i[r])return Ce;var o=r-1;if(Array.isArray(n)&&!0===n[o])return Ce;var s=o-1,a=o+1,l=t[o],h=s>=0?t[s]:0,c=t[a];if(l===L&&c===D)return Ce;if(-1!==Pe.indexOf(l))return ve;if(-1!==Pe.indexOf(c))return Ce;if(-1!==Se.indexOf(c))return Ce;if(Le(o,t)===F)return _e;if(be.get(e[o])===k&&(c===pe||c===ae||c===le))return Ce;if(l===H||c===H)return Ce;if(l===N)return Ce;if(-1===[Q,j,z].indexOf(l)&&c===N)return Ce;if(-1!==[Z,W,X,$,re].indexOf(c))return Ce;if(Le(o,t)===V)return Ce;if(Oe(q,V,o,t))return Ce;if(Oe([Z,W],K,o,t))return Ce;if(Oe(U,U,o,t))return Ce;if(l===Q)return _e;if(l===q||c===q)return Ce;if(c===Y||l===Y)return _e;if(-1!==[j,z,K].indexOf(c)||l===G)return Ce;if(h===ue&&-1!==Ee.indexOf(l))return Ce;if(l===re&&c===ue)return Ce;if(c===J&&-1!==we.concat(J,X,ee,pe,ae,le).indexOf(l))return Ce;if(-1!==we.indexOf(c)&&l===ee||-1!==we.indexOf(l)&&c===ee)return Ce;if(l===ie&&-1!==[pe,ae,le].indexOf(c)||-1!==[pe,ae,le].indexOf(l)&&c===te)return Ce;if(-1!==we.indexOf(l)&&-1!==xe.indexOf(c)||-1!==xe.indexOf(l)&&-1!==we.indexOf(c))return Ce;if(-1!==[ie,te].indexOf(l)&&(c===ee||-1!==[V,z].indexOf(c)&&t[a+1]===ee)||-1!==[V,z].indexOf(l)&&c===ee||l===ee&&-1!==[ee,re,$].indexOf(c))return Ce;if(-1!==[ee,re,$,Z,W].indexOf(c))for(var u=o;u>=0;){if((p=t[u])===ee)return Ce;if(-1===[re,$].indexOf(p))break;u--}if(-1!==[ie,te].indexOf(c))for(u=-1!==[Z,W].indexOf(l)?s:o;u>=0;){var p;if((p=t[u])===ee)return Ce;if(-1===[re,$].indexOf(p))break;u--}if(de===l&&-1!==[de,me,he,ce].indexOf(c)||-1!==[me,he].indexOf(l)&&-1!==[me,fe].indexOf(c)||-1!==[fe,ce].indexOf(l)&&c===fe)return Ce;if(-1!==Me.indexOf(l)&&-1!==[J,te].indexOf(c)||-1!==Me.indexOf(c)&&l===ie)return Ce;if(-1!==we.indexOf(l)&&-1!==we.indexOf(c))return Ce;if(l===$&&-1!==we.indexOf(c))return Ce;if(-1!==we.concat(ee).indexOf(l)&&c===V||-1!==we.concat(ee).indexOf(c)&&l===W)return Ce;if(l===ge&&c===ge){for(var d=i[o],m=1;d>0&&t[--d]===ge;)m++;if(m%2!=0)return Ce}return l===ae&&c===le?Ce:_e},Ie=function(e,t){t||(t={lineBreak:"normal",wordBreak:"normal"});var i=Te(e,t.lineBreak),r=i[0],n=i[1],o=i[2];"break-all"!==t.wordBreak&&"break-word"!==t.wordBreak||(n=n.map((function(e){return-1!==[ee,oe,Ae].indexOf(e)?pe:e})));var s="keep-all"===t.wordBreak?o.map((function(t,i){return t&&e[i]>=19968&&e[i]<=40959})):void 0;return[r,n,s]},Re=function(){function e(e,t,i,r){this.codePoints=e,this.required=t===ve,this.start=i,this.end=r}return e.prototype.slice=function(){return c.apply(void 0,this.codePoints.slice(this.start,this.end))},e}(),He=function(e,t){var i=h(e),r=Ie(i,t),n=r[0],o=r[1],s=r[2],a=i.length,l=0,c=0;return{next:function(){if(c>=a)return{done:!0,value:null};for(var e=Ce;c<a&&(e=De(i,o,n,++c,s))===Ce;);if(e!==Ce||c===a){var t=new Re(i,e,l,c);return l=c,{value:t,done:!1}}return{done:!0,value:null}}}};!function(e){e[e.STRING_TOKEN=0]="STRING_TOKEN",e[e.BAD_STRING_TOKEN=1]="BAD_STRING_TOKEN",e[e.LEFT_PARENTHESIS_TOKEN=2]="LEFT_PARENTHESIS_TOKEN",e[e.RIGHT_PARENTHESIS_TOKEN=3]="RIGHT_PARENTHESIS_TOKEN",e[e.COMMA_TOKEN=4]="COMMA_TOKEN",e[e.HASH_TOKEN=5]="HASH_TOKEN",e[e.DELIM_TOKEN=6]="DELIM_TOKEN",e[e.AT_KEYWORD_TOKEN=7]="AT_KEYWORD_TOKEN",e[e.PREFIX_MATCH_TOKEN=8]="PREFIX_MATCH_TOKEN",e[e.DASH_MATCH_TOKEN=9]="DASH_MATCH_TOKEN",e[e.INCLUDE_MATCH_TOKEN=10]="INCLUDE_MATCH_TOKEN",e[e.LEFT_CURLY_BRACKET_TOKEN=11]="LEFT_CURLY_BRACKET_TOKEN",e[e.RIGHT_CURLY_BRACKET_TOKEN=12]="RIGHT_CURLY_BRACKET_TOKEN",e[e.SUFFIX_MATCH_TOKEN=13]="SUFFIX_MATCH_TOKEN",e[e.SUBSTRING_MATCH_TOKEN=14]="SUBSTRING_MATCH_TOKEN",e[e.DIMENSION_TOKEN=15]="DIMENSION_TOKEN",e[e.PERCENTAGE_TOKEN=16]="PERCENTAGE_TOKEN",e[e.NUMBER_TOKEN=17]="NUMBER_TOKEN",e[e.FUNCTION=18]="FUNCTION",e[e.FUNCTION_TOKEN=19]="FUNCTION_TOKEN",e[e.IDENT_TOKEN=20]="IDENT_TOKEN",e[e.COLUMN_TOKEN=21]="COLUMN_TOKEN",e[e.URL_TOKEN=22]="URL_TOKEN",e[e.BAD_URL_TOKEN=23]="BAD_URL_TOKEN",e[e.CDC_TOKEN=24]="CDC_TOKEN",e[e.CDO_TOKEN=25]="CDO_TOKEN",e[e.COLON_TOKEN=26]="COLON_TOKEN",e[e.SEMICOLON_TOKEN=27]="SEMICOLON_TOKEN",e[e.LEFT_SQUARE_BRACKET_TOKEN=28]="LEFT_SQUARE_BRACKET_TOKEN",e[e.RIGHT_SQUARE_BRACKET_TOKEN=29]="RIGHT_SQUARE_BRACKET_TOKEN",e[e.UNICODE_RANGE_TOKEN=30]="UNICODE_RANGE_TOKEN",e[e.WHITESPACE_TOKEN=31]="WHITESPACE_TOKEN",e[e.EOF_TOKEN=32]="EOF_TOKEN"}(m||(m={}));var Fe=1,Ne=2,Qe=4,ke=8,Ue=10,je=47,Ge=92,ze=9,Ye=32,Ze=34,We=61,Xe=35,Je=36,Ke=37,Ve=39,qe=40,$e=41,et=95,tt=45,it=33,rt=60,nt=62,ot=64,st=91,at=93,lt=61,ht=123,ct=63,ut=125,pt=124,dt=126,mt=128,ft=65533,gt=42,At=43,yt=44,vt=58,Ct=59,_t=46,bt=0,wt=8,Pt=11,St=14,xt=31,Bt=127,Mt=-1,Et=48,Tt=97,Ot=101,Lt=102,Dt=117,It=122,Rt=65,Ht=69,Ft=70,Nt=85,Qt=90,kt=function(e){return e>=Et&&e<=57},Ut=function(e){return e>=55296&&e<=57343},jt=function(e){return kt(e)||e>=Rt&&e<=Ft||e>=Tt&&e<=Lt},Gt=function(e){return e>=Tt&&e<=It},zt=function(e){return e>=Rt&&e<=Qt},Yt=function(e){return Gt(e)||zt(e)},Zt=function(e){return e>=mt},Wt=function(e){return e===Ue||e===ze||e===Ye},Xt=function(e){return Yt(e)||Zt(e)||e===et},Jt=function(e){return Xt(e)||kt(e)||e===tt},Kt=function(e){return e>=bt&&e<=wt||e===Pt||e>=St&&e<=xt||e===Bt},Vt=function(e,t){return e===Ge&&t!==Ue},qt=function(e,t,i){return e===tt?Xt(t)||Vt(t,i):!!Xt(e)||!(e!==Ge||!Vt(e,t))},$t=function(e,t,i){return e===At||e===tt?!!kt(t)||t===_t&&kt(i):kt(e===_t?t:e)},ei=function(e){var t=0,i=1;e[t]!==At&&e[t]!==tt||(e[t]===tt&&(i=-1),t++);for(var r=[];kt(e[t]);)r.push(e[t++]);var n=r.length?parseInt(c.apply(void 0,r),10):0;e[t]===_t&&t++;for(var o=[];kt(e[t]);)o.push(e[t++]);var s=o.length,a=s?parseInt(c.apply(void 0,o),10):0;e[t]!==Ht&&e[t]!==Ot||t++;var l=1;e[t]!==At&&e[t]!==tt||(e[t]===tt&&(l=-1),t++);for(var h=[];kt(e[t]);)h.push(e[t++]);var u=h.length?parseInt(c.apply(void 0,h),10):0;return i*(n+a*Math.pow(10,-s))*Math.pow(10,l*u)},ti={type:m.LEFT_PARENTHESIS_TOKEN},ii={type:m.RIGHT_PARENTHESIS_TOKEN},ri={type:m.COMMA_TOKEN},ni={type:m.SUFFIX_MATCH_TOKEN},oi={type:m.PREFIX_MATCH_TOKEN},si={type:m.COLUMN_TOKEN},ai={type:m.DASH_MATCH_TOKEN},li={type:m.INCLUDE_MATCH_TOKEN},hi={type:m.LEFT_CURLY_BRACKET_TOKEN},ci={type:m.RIGHT_CURLY_BRACKET_TOKEN},ui={type:m.SUBSTRING_MATCH_TOKEN},pi={type:m.BAD_URL_TOKEN},di={type:m.BAD_STRING_TOKEN},mi={type:m.CDO_TOKEN},fi={type:m.CDC_TOKEN},gi={type:m.COLON_TOKEN},Ai={type:m.SEMICOLON_TOKEN},yi={type:m.LEFT_SQUARE_BRACKET_TOKEN},vi={type:m.RIGHT_SQUARE_BRACKET_TOKEN},Ci={type:m.WHITESPACE_TOKEN},_i={type:m.EOF_TOKEN},bi=function(){function e(){this._value=[]}return e.prototype.write=function(e){this._value=this._value.concat(h(e))},e.prototype.read=function(){for(var e=[],t=this.consumeToken();t!==_i;)e.push(t),t=this.consumeToken();return e},e.prototype.consumeToken=function(){var e=this.consumeCodePoint();switch(e){case Ze:return this.consumeStringToken(Ze);case Xe:var t=this.peekCodePoint(0),i=this.peekCodePoint(1),r=this.peekCodePoint(2);if(Jt(t)||Vt(i,r)){var n=qt(t,i,r)?Ne:Fe,o=this.consumeName();return{type:m.HASH_TOKEN,value:o,flags:n}}break;case Je:if(this.peekCodePoint(0)===We)return this.consumeCodePoint(),ni;break;case Ve:return this.consumeStringToken(Ve);case qe:return ti;case $e:return ii;case gt:if(this.peekCodePoint(0)===We)return this.consumeCodePoint(),ui;break;case At:if($t(e,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(e),this.consumeNumericToken();break;case yt:return ri;case tt:var s=e,a=this.peekCodePoint(0),l=this.peekCodePoint(1);if($t(s,a,l))return this.reconsumeCodePoint(e),this.consumeNumericToken();if(qt(s,a,l))return this.reconsumeCodePoint(e),this.consumeIdentLikeToken();if(a===tt&&l===nt)return this.consumeCodePoint(),this.consumeCodePoint(),fi;break;case _t:if($t(e,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(e),this.consumeNumericToken();break;case je:if(this.peekCodePoint(0)===gt)for(this.consumeCodePoint();;){var h=this.consumeCodePoint();if(h===gt&&(h=this.consumeCodePoint())===je)return this.consumeToken();if(h===Mt)return this.consumeToken()}break;case vt:return gi;case Ct:return Ai;case rt:if(this.peekCodePoint(0)===it&&this.peekCodePoint(1)===tt&&this.peekCodePoint(2)===tt)return this.consumeCodePoint(),this.consumeCodePoint(),mi;break;case ot:var u=this.peekCodePoint(0),p=this.peekCodePoint(1),d=this.peekCodePoint(2);if(qt(u,p,d))return o=this.consumeName(),{type:m.AT_KEYWORD_TOKEN,value:o};break;case st:return yi;case Ge:if(Vt(e,this.peekCodePoint(0)))return this.reconsumeCodePoint(e),this.consumeIdentLikeToken();break;case at:return vi;case lt:if(this.peekCodePoint(0)===We)return this.consumeCodePoint(),oi;break;case ht:return hi;case ut:return ci;case Dt:case Nt:var f=this.peekCodePoint(0),g=this.peekCodePoint(1);return f!==At||!jt(g)&&g!==ct||(this.consumeCodePoint(),this.consumeUnicodeRangeToken()),this.reconsumeCodePoint(e),this.consumeIdentLikeToken();case pt:if(this.peekCodePoint(0)===We)return this.consumeCodePoint(),ai;if(this.peekCodePoint(0)===pt)return this.consumeCodePoint(),si;break;case dt:if(this.peekCodePoint(0)===We)return this.consumeCodePoint(),li;break;case Mt:return _i}return Wt(e)?(this.consumeWhiteSpace(),Ci):kt(e)?(this.reconsumeCodePoint(e),this.consumeNumericToken()):Xt(e)?(this.reconsumeCodePoint(e),this.consumeIdentLikeToken()):{type:m.DELIM_TOKEN,value:c(e)}},e.prototype.consumeCodePoint=function(){var e=this._value.shift();return void 0===e?-1:e},e.prototype.reconsumeCodePoint=function(e){this._value.unshift(e)},e.prototype.peekCodePoint=function(e){return e>=this._value.length?-1:this._value[e]},e.prototype.consumeUnicodeRangeToken=function(){for(var e=[],t=this.consumeCodePoint();jt(t)&&e.length<6;)e.push(t),t=this.consumeCodePoint();for(var i=!1;t===ct&&e.length<6;)e.push(t),t=this.consumeCodePoint(),i=!0;if(i){var r=parseInt(c.apply(void 0,e.map((function(e){return e===ct?Et:e}))),16),n=parseInt(c.apply(void 0,e.map((function(e){return e===ct?Ft:e}))),16);return{type:m.UNICODE_RANGE_TOKEN,start:r,end:n}}var o=parseInt(c.apply(void 0,e),16);if(this.peekCodePoint(0)===tt&&jt(this.peekCodePoint(1))){this.consumeCodePoint(),t=this.consumeCodePoint();for(var s=[];jt(t)&&s.length<6;)s.push(t),t=this.consumeCodePoint();return n=parseInt(c.apply(void 0,s),16),{type:m.UNICODE_RANGE_TOKEN,start:o,end:n}}return{type:m.UNICODE_RANGE_TOKEN,start:o,end:o}},e.prototype.consumeIdentLikeToken=function(){var e=this.consumeName();return"url"===e.toLowerCase()&&this.peekCodePoint(0)===qe?(this.consumeCodePoint(),this.consumeUrlToken()):this.peekCodePoint(0)===qe?(this.consumeCodePoint(),{type:m.FUNCTION_TOKEN,value:e}):{type:m.IDENT_TOKEN,value:e}},e.prototype.consumeUrlToken=function(){var e=[];if(this.consumeWhiteSpace(),this.peekCodePoint(0)===Mt)return{type:m.URL_TOKEN,value:""};var t=this.peekCodePoint(0);if(t===Ve||t===Ze){var i=this.consumeStringToken(this.consumeCodePoint());return i.type===m.STRING_TOKEN&&(this.consumeWhiteSpace(),this.peekCodePoint(0)===Mt||this.peekCodePoint(0)===$e)?(this.consumeCodePoint(),{type:m.URL_TOKEN,value:i.value}):(this.consumeBadUrlRemnants(),pi)}for(;;){var r=this.consumeCodePoint();if(r===Mt||r===$e)return{type:m.URL_TOKEN,value:c.apply(void 0,e)};if(Wt(r))return this.consumeWhiteSpace(),this.peekCodePoint(0)===Mt||this.peekCodePoint(0)===$e?(this.consumeCodePoint(),{type:m.URL_TOKEN,value:c.apply(void 0,e)}):(this.consumeBadUrlRemnants(),pi);if(r===Ze||r===Ve||r===qe||Kt(r))return this.consumeBadUrlRemnants(),pi;if(r===Ge){if(!Vt(r,this.peekCodePoint(0)))return this.consumeBadUrlRemnants(),pi;e.push(this.consumeEscapedCodePoint())}else e.push(r)}},e.prototype.consumeWhiteSpace=function(){for(;Wt(this.peekCodePoint(0));)this.consumeCodePoint()},e.prototype.consumeBadUrlRemnants=function(){for(;;){var e=this.consumeCodePoint();if(e===$e||e===Mt)return;Vt(e,this.peekCodePoint(0))&&this.consumeEscapedCodePoint()}},e.prototype.consumeStringSlice=function(e){for(var t=6e4,i="";e>0;){var r=Math.min(t,e);i+=c.apply(void 0,this._value.splice(0,r)),e-=r}return this._value.shift(),i},e.prototype.consumeStringToken=function(e){for(var t="",i=0;;){var r=this._value[i];if(r===Mt||void 0===r||r===e)return t+=this.consumeStringSlice(i),{type:m.STRING_TOKEN,value:t};if(r===Ue)return this._value.splice(0,i),di;if(r===Ge){var n=this._value[i+1];n!==Mt&&void 0!==n&&(n===Ue?(t+=this.consumeStringSlice(i),i=-1,this._value.shift()):Vt(r,n)&&(t+=this.consumeStringSlice(i),t+=c(this.consumeEscapedCodePoint()),i=-1))}i++}},e.prototype.consumeNumber=function(){var e=[],t=Qe,i=this.peekCodePoint(0);for(i!==At&&i!==tt||e.push(this.consumeCodePoint());kt(this.peekCodePoint(0));)e.push(this.consumeCodePoint());i=this.peekCodePoint(0);var r=this.peekCodePoint(1);if(i===_t&&kt(r))for(e.push(this.consumeCodePoint(),this.consumeCodePoint()),t=ke;kt(this.peekCodePoint(0));)e.push(this.consumeCodePoint());i=this.peekCodePoint(0),r=this.peekCodePoint(1);var n=this.peekCodePoint(2);if((i===Ht||i===Ot)&&((r===At||r===tt)&&kt(n)||kt(r)))for(e.push(this.consumeCodePoint(),this.consumeCodePoint()),t=ke;kt(this.peekCodePoint(0));)e.push(this.consumeCodePoint());return[ei(e),t]},e.prototype.consumeNumericToken=function(){var e=this.consumeNumber(),t=e[0],i=e[1],r=this.peekCodePoint(0),n=this.peekCodePoint(1),o=this.peekCodePoint(2);if(qt(r,n,o)){var s=this.consumeName();return{type:m.DIMENSION_TOKEN,number:t,flags:i,unit:s}}return r===Ke?(this.consumeCodePoint(),{type:m.PERCENTAGE_TOKEN,number:t,flags:i}):{type:m.NUMBER_TOKEN,number:t,flags:i}},e.prototype.consumeEscapedCodePoint=function(){var e=this.consumeCodePoint();if(jt(e)){for(var t=c(e);jt(this.peekCodePoint(0))&&t.length<6;)t+=c(this.consumeCodePoint());Wt(this.peekCodePoint(0))&&this.consumeCodePoint();var i=parseInt(t,16);return 0===i||Ut(i)||i>1114111?ft:i}return e===Mt?ft:e},e.prototype.consumeName=function(){for(var e="";;){var t=this.consumeCodePoint();if(Jt(t))e+=c(t);else{if(!Vt(t,this.peekCodePoint(0)))return this.reconsumeCodePoint(t),e;e+=c(this.consumeEscapedCodePoint())}}},e}(),wi=function(){function e(e){this._tokens=e}return e.create=function(t){var i=new bi;return i.write(t),new e(i.read())},e.parseValue=function(t){return e.create(t).parseComponentValue()},e.parseValues=function(t){return e.create(t).parseComponentValues()},e.prototype.parseComponentValue=function(){for(var e=this.consumeToken();e.type===m.WHITESPACE_TOKEN;)e=this.consumeToken();if(e.type===m.EOF_TOKEN)throw new SyntaxError("Error parsing CSS component value, unexpected EOF");this.reconsumeToken(e);var t=this.consumeComponentValue();do{e=this.consumeToken()}while(e.type===m.WHITESPACE_TOKEN);if(e.type===m.EOF_TOKEN)return t;throw new SyntaxError("Error parsing CSS component value, multiple values found when expecting only one")},e.prototype.parseComponentValues=function(){for(var e=[];;){var t=this.consumeComponentValue();if(t.type===m.EOF_TOKEN)return e;e.push(t),e.push()}},e.prototype.consumeComponentValue=function(){var e=this.consumeToken();switch(e.type){case m.LEFT_CURLY_BRACKET_TOKEN:case m.LEFT_SQUARE_BRACKET_TOKEN:case m.LEFT_PARENTHESIS_TOKEN:return this.consumeSimpleBlock(e.type);case m.FUNCTION_TOKEN:return this.consumeFunction(e)}return e},e.prototype.consumeSimpleBlock=function(e){for(var t={type:e,values:[]},i=this.consumeToken();;){if(i.type===m.EOF_TOKEN||Li(i,e))return t;this.reconsumeToken(i),t.values.push(this.consumeComponentValue()),i=this.consumeToken()}},e.prototype.consumeFunction=function(e){for(var t={name:e.value,values:[],type:m.FUNCTION};;){var i=this.consumeToken();if(i.type===m.EOF_TOKEN||i.type===m.RIGHT_PARENTHESIS_TOKEN)return t;this.reconsumeToken(i),t.values.push(this.consumeComponentValue())}},e.prototype.consumeToken=function(){var e=this._tokens.shift();return void 0===e?_i:e},e.prototype.reconsumeToken=function(e){this._tokens.unshift(e)},e}(),Pi=function(e){return e.type===m.DIMENSION_TOKEN},Si=function(e){return e.type===m.NUMBER_TOKEN},xi=function(e){return e.type===m.IDENT_TOKEN},Bi=function(e){return e.type===m.STRING_TOKEN},Mi=function(e,t){return xi(e)&&e.value===t},Ei=function(e){return e.type!==m.WHITESPACE_TOKEN},Ti=function(e){return e.type!==m.WHITESPACE_TOKEN&&e.type!==m.COMMA_TOKEN},Oi=function(e){var t=[],i=[];return e.forEach((function(e){if(e.type===m.COMMA_TOKEN){if(0===i.length)throw new Error("Error parsing function args, zero tokens for arg");return t.push(i),void(i=[])}e.type!==m.WHITESPACE_TOKEN&&i.push(e)})),i.length&&t.push(i),t},Li=function(e,t){return t===m.LEFT_CURLY_BRACKET_TOKEN&&e.type===m.RIGHT_CURLY_BRACKET_TOKEN||t===m.LEFT_SQUARE_BRACKET_TOKEN&&e.type===m.RIGHT_SQUARE_BRACKET_TOKEN||t===m.LEFT_PARENTHESIS_TOKEN&&e.type===m.RIGHT_PARENTHESIS_TOKEN},Di=function(e){return e.type===m.NUMBER_TOKEN||e.type===m.DIMENSION_TOKEN},Ii=function(e){return e.type===m.PERCENTAGE_TOKEN||Di(e)},Ri=function(e){return e.length>1?[e[0],e[1]]:[e[0]]},Hi={type:m.NUMBER_TOKEN,number:0,flags:Qe},Fi={type:m.PERCENTAGE_TOKEN,number:50,flags:Qe},Ni={type:m.PERCENTAGE_TOKEN,number:100,flags:Qe},Qi=function(e,t,i){var r=e[0],n=e[1];return[ki(r,t),ki(void 0!==n?n:r,i)]},ki=function(e,t){if(e.type===m.PERCENTAGE_TOKEN)return e.number/100*t;if(Pi(e))switch(e.unit){case"rem":case"em":return 16*e.number;default:return e.number}return e.number},Ui="deg",ji="grad",Gi="rad",zi="turn",Yi={name:"angle",parse:function(e){if(e.type===m.DIMENSION_TOKEN)switch(e.unit){case Ui:return Math.PI*e.number/180;case ji:return Math.PI/200*e.number;case Gi:return e.number;case zi:return 2*Math.PI*e.number}throw new Error("Unsupported angle type")}},Zi=function(e){return e.type===m.DIMENSION_TOKEN&&(e.unit===Ui||e.unit===ji||e.unit===Gi||e.unit===zi)},Wi=function(e){switch(e.filter(xi).map((function(e){return e.value})).join(" ")){case"to bottom right":case"to right bottom":case"left top":case"top left":return[Hi,Hi];case"to top":case"bottom":return Xi(0);case"to bottom left":case"to left bottom":case"right top":case"top right":return[Hi,Ni];case"to right":case"left":return Xi(90);case"to top left":case"to left top":case"right bottom":case"bottom right":return[Ni,Ni];case"to bottom":case"top":return Xi(180);case"to top right":case"to right top":case"left bottom":case"bottom left":return[Ni,Hi];case"to left":case"right":return Xi(270)}return 0},Xi=function(e){return Math.PI*e/180},Ji={name:"color",parse:function(e){if(e.type===m.FUNCTION){var t=or[e.name];if(void 0===t)throw new Error('Attempting to parse an unsupported color function "'+e.name+'"');return t(e.values)}if(e.type===m.HASH_TOKEN){if(3===e.value.length){var i=e.value.substring(0,1),r=e.value.substring(1,2),n=e.value.substring(2,3);return qi(parseInt(i+i,16),parseInt(r+r,16),parseInt(n+n,16),1)}if(4===e.value.length){i=e.value.substring(0,1),r=e.value.substring(1,2),n=e.value.substring(2,3);var o=e.value.substring(3,4);return qi(parseInt(i+i,16),parseInt(r+r,16),parseInt(n+n,16),parseInt(o+o,16)/255)}if(6===e.value.length)return i=e.value.substring(0,2),r=e.value.substring(2,4),n=e.value.substring(4,6),qi(parseInt(i,16),parseInt(r,16),parseInt(n,16),1);if(8===e.value.length)return i=e.value.substring(0,2),r=e.value.substring(2,4),n=e.value.substring(4,6),o=e.value.substring(6,8),qi(parseInt(i,16),parseInt(r,16),parseInt(n,16),parseInt(o,16)/255)}if(e.type===m.IDENT_TOKEN){var s=sr[e.value.toUpperCase()];if(void 0!==s)return s}return sr.TRANSPARENT}},Ki=function(e){return 0==(255&e)},Vi=function(e){var t=255&e,i=255&e>>8,r=255&e>>16,n=255&e>>24;return t<255?"rgba("+n+","+r+","+i+","+t/255+")":"rgb("+n+","+r+","+i+")"},qi=function(e,t,i,r){return(e<<24|t<<16|i<<8|Math.round(255*r)<<0)>>>0},$i=function(e,t){if(e.type===m.NUMBER_TOKEN)return e.number;if(e.type===m.PERCENTAGE_TOKEN){var i=3===t?1:255;return 3===t?e.number/100*i:Math.round(e.number/100*i)}return 0},er=function(e){var t=e.filter(Ti);if(3===t.length){var i=t.map($i),r=i[0],n=i[1],o=i[2];return qi(r,n,o,1)}if(4===t.length){var s=t.map($i),a=(r=s[0],n=s[1],o=s[2],s[3]);return qi(r,n,o,a)}return 0};function tr(e,t,i){return i<0&&(i+=1),i>=1&&(i-=1),i<1/6?(t-e)*i*6+e:i<.5?t:i<2/3?6*(t-e)*(2/3-i)+e:e}var ir,rr,nr=function(e){var t=e.filter(Ti),i=t[0],r=t[1],n=t[2],o=t[3],s=(i.type===m.NUMBER_TOKEN?Xi(i.number):Yi.parse(i))/(2*Math.PI),a=Ii(r)?r.number/100:0,l=Ii(n)?n.number/100:0,h=void 0!==o&&Ii(o)?ki(o,1):1;if(0===a)return qi(255*l,255*l,255*l,1);var c=l<=.5?l*(a+1):l+a-l*a,u=2*l-c,p=tr(u,c,s+1/3),d=tr(u,c,s),f=tr(u,c,s-1/3);return qi(255*p,255*d,255*f,h)},or={hsl:nr,hsla:nr,rgb:er,rgba:er},sr={ALICEBLUE:4042850303,ANTIQUEWHITE:4209760255,AQUA:16777215,AQUAMARINE:2147472639,AZURE:4043309055,BEIGE:4126530815,BISQUE:4293182719,BLACK:255,BLANCHEDALMOND:4293643775,BLUE:65535,BLUEVIOLET:2318131967,BROWN:2771004159,BURLYWOOD:3736635391,CADETBLUE:1604231423,CHARTREUSE:2147418367,CHOCOLATE:3530104575,CORAL:4286533887,CORNFLOWERBLUE:1687547391,CORNSILK:4294499583,CRIMSON:3692313855,CYAN:16777215,DARKBLUE:35839,DARKCYAN:9145343,DARKGOLDENROD:3095837695,DARKGRAY:2846468607,DARKGREEN:6553855,DARKGREY:2846468607,DARKKHAKI:3182914559,DARKMAGENTA:2332068863,DARKOLIVEGREEN:1433087999,DARKORANGE:4287365375,DARKORCHID:2570243327,DARKRED:2332033279,DARKSALMON:3918953215,DARKSEAGREEN:2411499519,DARKSLATEBLUE:1211993087,DARKSLATEGRAY:793726975,DARKSLATEGREY:793726975,DARKTURQUOISE:13554175,DARKVIOLET:2483082239,DEEPPINK:4279538687,DEEPSKYBLUE:12582911,DIMGRAY:1768516095,DIMGREY:1768516095,DODGERBLUE:512819199,FIREBRICK:2988581631,FLORALWHITE:4294635775,FORESTGREEN:579543807,FUCHSIA:4278255615,GAINSBORO:3705462015,GHOSTWHITE:4177068031,GOLD:4292280575,GOLDENROD:3668254975,GRAY:2155905279,GREEN:8388863,GREENYELLOW:2919182335,GREY:2155905279,HONEYDEW:4043305215,HOTPINK:4285117695,INDIANRED:3445382399,INDIGO:1258324735,IVORY:4294963455,KHAKI:4041641215,LAVENDER:3873897215,LAVENDERBLUSH:4293981695,LAWNGREEN:2096890111,LEMONCHIFFON:4294626815,LIGHTBLUE:2916673279,LIGHTCORAL:4034953471,LIGHTCYAN:3774873599,LIGHTGOLDENRODYELLOW:4210742015,LIGHTGRAY:3553874943,LIGHTGREEN:2431553791,LIGHTGREY:3553874943,LIGHTPINK:4290167295,LIGHTSALMON:4288707327,LIGHTSEAGREEN:548580095,LIGHTSKYBLUE:2278488831,LIGHTSLATEGRAY:2005441023,LIGHTSLATEGREY:2005441023,LIGHTSTEELBLUE:2965692159,LIGHTYELLOW:4294959359,LIME:16711935,LIMEGREEN:852308735,LINEN:4210091775,MAGENTA:4278255615,MAROON:2147483903,MEDIUMAQUAMARINE:1724754687,MEDIUMBLUE:52735,MEDIUMORCHID:3126187007,MEDIUMPURPLE:2473647103,MEDIUMSEAGREEN:1018393087,MEDIUMSLATEBLUE:2070474495,MEDIUMSPRINGGREEN:16423679,MEDIUMTURQUOISE:1221709055,MEDIUMVIOLETRED:3340076543,MIDNIGHTBLUE:421097727,MINTCREAM:4127193855,MISTYROSE:4293190143,MOCCASIN:4293178879,NAVAJOWHITE:4292783615,NAVY:33023,OLDLACE:4260751103,OLIVE:2155872511,OLIVEDRAB:1804477439,ORANGE:4289003775,ORANGERED:4282712319,ORCHID:3664828159,PALEGOLDENROD:4008225535,PALEGREEN:2566625535,PALETURQUOISE:2951671551,PALEVIOLETRED:3681588223,PAPAYAWHIP:4293907967,PEACHPUFF:4292524543,PERU:3448061951,PINK:4290825215,PLUM:3718307327,POWDERBLUE:2967529215,PURPLE:2147516671,REBECCAPURPLE:1714657791,RED:4278190335,ROSYBROWN:3163525119,ROYALBLUE:1097458175,SADDLEBROWN:2336560127,SALMON:4202722047,SANDYBROWN:4104413439,SEAGREEN:780883967,SEASHELL:4294307583,SIENNA:2689740287,SILVER:3233857791,SKYBLUE:2278484991,SLATEBLUE:1784335871,SLATEGRAY:1887473919,SLATEGREY:1887473919,SNOW:4294638335,SPRINGGREEN:16744447,STEELBLUE:1182971135,TAN:3535047935,TEAL:8421631,THISTLE:3636451583,TOMATO:4284696575,TRANSPARENT:0,TURQUOISE:1088475391,VIOLET:4001558271,WHEAT:4125012991,WHITE:4294967295,WHITESMOKE:4126537215,YELLOW:4294902015,YELLOWGREEN:2597139199};(function(e){e[e.VALUE=0]="VALUE",e[e.LIST=1]="LIST",e[e.IDENT_VALUE=2]="IDENT_VALUE",e[e.TYPE_VALUE=3]="TYPE_VALUE",e[e.TOKEN_VALUE=4]="TOKEN_VALUE"})(ir||(ir={})),function(e){e[e.BORDER_BOX=0]="BORDER_BOX",e[e.PADDING_BOX=1]="PADDING_BOX",e[e.CONTENT_BOX=2]="CONTENT_BOX"}(rr||(rr={}));var ar,lr={name:"background-clip",initialValue:"border-box",prefix:!1,type:ir.LIST,parse:function(e){return e.map((function(e){if(xi(e))switch(e.value){case"padding-box":return rr.PADDING_BOX;case"content-box":return rr.CONTENT_BOX}return rr.BORDER_BOX}))}},hr={name:"background-color",initialValue:"transparent",prefix:!1,type:ir.TYPE_VALUE,format:"color"},cr=function(e){var t=Ji.parse(e[0]),i=e[1];return i&&Ii(i)?{color:t,stop:i}:{color:t,stop:null}},ur=function(e,t){var i=e[0],r=e[e.length-1];null===i.stop&&(i.stop=Hi),null===r.stop&&(r.stop=Ni);for(var n=[],o=0,s=0;s<e.length;s++){var a=e[s].stop;if(null!==a){var l=ki(a,t);l>o?n.push(l):n.push(o),o=l}else n.push(null)}var h=null;for(s=0;s<n.length;s++){var c=n[s];if(null===c)null===h&&(h=s);else if(null!==h){for(var u=s-h,p=(c-n[h-1])/(u+1),d=1;d<=u;d++)n[h+d-1]=p*d;h=null}}return e.map((function(e,i){return{color:e.color,stop:Math.max(Math.min(1,n[i]/t),0)}}))},pr=function(e,t,i){var r=t/2,n=i/2,o=ki(e[0],t)-r,s=n-ki(e[1],i);return(Math.atan2(s,o)+2*Math.PI)%(2*Math.PI)},dr=function(e,t,i){var r="number"==typeof e?e:pr(e,t,i),n=Math.abs(t*Math.sin(r))+Math.abs(i*Math.cos(r)),o=t/2,s=i/2,a=n/2,l=Math.sin(r-Math.PI/2)*a,h=Math.cos(r-Math.PI/2)*a;return[n,o-h,o+h,s-l,s+l]},mr=function(e,t){return Math.sqrt(e*e+t*t)},fr=function(e,t,i,r,n){return[[0,0],[0,t],[e,0],[e,t]].reduce((function(e,t){var o=t[0],s=t[1],a=mr(i-o,r-s);return(n?a<e.optimumDistance:a>e.optimumDistance)?{optimumCorner:t,optimumDistance:a}:e}),{optimumDistance:n?1/0:-1/0,optimumCorner:null}).optimumCorner},gr=function(e,t,i,r,n){var o=0,s=0;switch(e.size){case Vr.CLOSEST_SIDE:e.shape===Kr.CIRCLE?o=s=Math.min(Math.abs(t),Math.abs(t-r),Math.abs(i),Math.abs(i-n)):e.shape===Kr.ELLIPSE&&(o=Math.min(Math.abs(t),Math.abs(t-r)),s=Math.min(Math.abs(i),Math.abs(i-n)));break;case Vr.CLOSEST_CORNER:if(e.shape===Kr.CIRCLE)o=s=Math.min(mr(t,i),mr(t,i-n),mr(t-r,i),mr(t-r,i-n));else if(e.shape===Kr.ELLIPSE){var a=Math.min(Math.abs(i),Math.abs(i-n))/Math.min(Math.abs(t),Math.abs(t-r)),l=fr(r,n,t,i,!0),h=l[0],c=l[1];s=a*(o=mr(h-t,(c-i)/a))}break;case Vr.FARTHEST_SIDE:e.shape===Kr.CIRCLE?o=s=Math.max(Math.abs(t),Math.abs(t-r),Math.abs(i),Math.abs(i-n)):e.shape===Kr.ELLIPSE&&(o=Math.max(Math.abs(t),Math.abs(t-r)),s=Math.max(Math.abs(i),Math.abs(i-n)));break;case Vr.FARTHEST_CORNER:if(e.shape===Kr.CIRCLE)o=s=Math.max(mr(t,i),mr(t,i-n),mr(t-r,i),mr(t-r,i-n));else if(e.shape===Kr.ELLIPSE){a=Math.max(Math.abs(i),Math.abs(i-n))/Math.max(Math.abs(t),Math.abs(t-r));var u=fr(r,n,t,i,!1);h=u[0],c=u[1],s=a*(o=mr(h-t,(c-i)/a))}}return Array.isArray(e.size)&&(o=ki(e.size[0],r),s=2===e.size.length?ki(e.size[1],n):o),[o,s]},Ar=function(e){var t=Xi(180),i=[];return Oi(e).forEach((function(e,r){if(0===r){var n=e[0];if(n.type===m.IDENT_TOKEN&&"to"===n.value)return void(t=Wi(e));if(Zi(n))return void(t=Yi.parse(n))}var o=cr(e);i.push(o)})),{angle:t,stops:i,type:ar.LINEAR_GRADIENT}},yr=function(e){var t=Xi(180),i=[];return Oi(e).forEach((function(e,r){if(0===r){var n=e[0];if(n.type===m.IDENT_TOKEN&&-1!==["top","left","right","bottom"].indexOf(n.value))return void(t=Wi(e));if(Zi(n))return void(t=(Yi.parse(n)+Xi(270))%Xi(360))}var o=cr(e);i.push(o)})),{angle:t,stops:i,type:ar.LINEAR_GRADIENT}},vr=function(e){var t=123;if(e.createRange){var i=e.createRange();if(i.getBoundingClientRect){var r=e.createElement("boundtest");r.style.height=t+"px",r.style.display="block",e.body.appendChild(r),i.selectNode(r);var n=i.getBoundingClientRect(),o=Math.round(n.height);if(e.body.removeChild(r),o===t)return!0}}return!1},Cr=function(){return void 0!==(new Image).crossOrigin},_r=function(){return"string"==typeof(new XMLHttpRequest).responseType},br=function(e){var t=new Image,i=e.createElement("canvas"),r=i.getContext("2d");if(!r)return!1;t.src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'></svg>";try{r.drawImage(t,0,0),i.toDataURL()}catch(e){return!1}return!0},wr=function(e){return 0===e[0]&&255===e[1]&&0===e[2]&&255===e[3]},Pr=function(e){var t=e.createElement("canvas"),i=100;t.width=i,t.height=i;var r=t.getContext("2d");if(!r)return Promise.reject(!1);r.fillStyle="rgb(0, 255, 0)",r.fillRect(0,0,i,i);var n=new Image,o=t.toDataURL();n.src=o;var s=Sr(i,i,0,0,n);return r.fillStyle="red",r.fillRect(0,0,i,i),xr(s).then((function(t){r.drawImage(t,0,0);var n=r.getImageData(0,0,i,i).data;r.fillStyle="red",r.fillRect(0,0,i,i);var s=e.createElement("div");return s.style.backgroundImage="url("+o+")",s.style.height=i+"px",wr(n)?xr(Sr(i,i,0,0,s)):Promise.reject(!1)})).then((function(e){return r.drawImage(e,0,0),wr(r.getImageData(0,0,i,i).data)})).catch((function(){return!1}))},Sr=function(e,t,i,r,n){var o="http://www.w3.org/2000/svg",s=document.createElementNS(o,"svg"),a=document.createElementNS(o,"foreignObject");return s.setAttributeNS(null,"width",e.toString()),s.setAttributeNS(null,"height",t.toString()),a.setAttributeNS(null,"width","100%"),a.setAttributeNS(null,"height","100%"),a.setAttributeNS(null,"x",i.toString()),a.setAttributeNS(null,"y",r.toString()),a.setAttributeNS(null,"externalResourcesRequired","true"),s.appendChild(a),a.appendChild(n),s},xr=function(e){return new Promise((function(t,i){var r=new Image;r.onload=function(){return t(r)},r.onerror=i,r.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent((new XMLSerializer).serializeToString(e))}))},Br={get SUPPORT_RANGE_BOUNDS(){var e=vr(document);return Object.defineProperty(Br,"SUPPORT_RANGE_BOUNDS",{value:e}),e},get SUPPORT_SVG_DRAWING(){var e=br(document);return Object.defineProperty(Br,"SUPPORT_SVG_DRAWING",{value:e}),e},get SUPPORT_FOREIGNOBJECT_DRAWING(){var e="function"==typeof Array.from&&"function"==typeof window.fetch?Pr(document):Promise.resolve(!1);return Object.defineProperty(Br,"SUPPORT_FOREIGNOBJECT_DRAWING",{value:e}),e},get SUPPORT_CORS_IMAGES(){var e=Cr();return Object.defineProperty(Br,"SUPPORT_CORS_IMAGES",{value:e}),e},get SUPPORT_RESPONSE_TYPE(){var e=_r();return Object.defineProperty(Br,"SUPPORT_RESPONSE_TYPE",{value:e}),e},get SUPPORT_CORS_XHR(){var e="withCredentials"in new XMLHttpRequest;return Object.defineProperty(Br,"SUPPORT_CORS_XHR",{value:e}),e}},Mr=function(){function e(e){var t=e.id,i=e.enabled;this.id=t,this.enabled=i,this.start=Date.now()}return e.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.enabled&&("undefined"!=typeof window&&window.console&&"function"==typeof r.debug?r.debug.apply(r,[this.id,this.getTime()+"ms"].concat(e)):this.info.apply(this,e))},e.prototype.getTime=function(){return Date.now()-this.start},e.create=function(t){e.instances[t.id]=new e(t)},e.destroy=function(t){delete e.instances[t]},e.getInstance=function(t){var i=e.instances[t];if(void 0===i)throw new Error("No logger instance found with id "+t);return i},e.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.enabled&&"undefined"!=typeof window&&window.console&&"function"==typeof r.info&&r.info.apply(r,[this.id,this.getTime()+"ms"].concat(e))},e.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.enabled&&("undefined"!=typeof window&&window.console&&"function"==typeof r.error?r.error.apply(r,[this.id,this.getTime()+"ms"].concat(e)):this.info.apply(this,e))},e.instances={},e}(),Er=function(){function e(){}return e.create=function(t,i){return e._caches[t]=new Tr(t,i)},e.destroy=function(t){delete e._caches[t]},e.open=function(t){var i=e._caches[t];if(void 0!==i)return i;throw new Error('Cache with key "'+t+'" not found')},e.getOrigin=function(t){var i=e._link;return i?(i.href=t,i.href=i.href,i.protocol+i.hostname+i.port):"about:blank"},e.isSameOrigin=function(t){return e.getOrigin(t)===e._origin},e.setContext=function(t){e._link=t.document.createElement("a"),e._origin=e.getOrigin(t.location.href)},e.getInstance=function(){var t=e._current;if(null===t)throw new Error("No cache instance attached");return t},e.attachInstance=function(t){e._current=t},e.detachInstance=function(){e._current=null},e._caches={},e._origin="about:blank",e._current=null,e}(),Tr=function(){function e(e,t){this.id=e,this._options=t,this._cache={}}return e.prototype.addImage=function(e){var t=Promise.resolve();return this.has(e)?t:Fr(e)||Ir(e)?(this._cache[e]=this.loadImage(e),t):t},e.prototype.match=function(e){return this._cache[e]},e.prototype.loadImage=function(e){return n(this,void 0,void 0,(function(){var t,i,r,n,s=this;return o(this,(function(o){switch(o.label){case 0:return t=Er.isSameOrigin(e),i=!Rr(e)&&!0===this._options.useCORS&&Br.SUPPORT_CORS_IMAGES&&!t,r=!Rr(e)&&!t&&"string"==typeof this._options.proxy&&Br.SUPPORT_CORS_XHR&&!i,t||!1!==this._options.allowTaint||Rr(e)||r||i?(n=e,r?[4,this.proxy(n)]:[3,2]):[2];case 1:n=o.sent(),o.label=2;case 2:return Mr.getInstance(this.id).debug("Added image "+e.substring(0,256)),[4,new Promise((function(e,t){var r=new Image;r.onload=function(){return e(r)},r.onerror=t,(Hr(n)||i)&&(r.crossOrigin="anonymous"),r.src=n,!0===r.complete&&setTimeout((function(){return e(r)}),500),s._options.imageTimeout>0&&setTimeout((function(){return t("Timed out ("+s._options.imageTimeout+"ms) loading image")}),s._options.imageTimeout)}))];case 3:return[2,o.sent()]}}))}))},e.prototype.has=function(e){return void 0!==this._cache[e]},e.prototype.keys=function(){return Promise.resolve(Object.keys(this._cache))},e.prototype.proxy=function(e){var t=this,i=this._options.proxy;if(!i)throw new Error("No proxy defined");var r=e.substring(0,256);return new Promise((function(n,o){var s=Br.SUPPORT_RESPONSE_TYPE?"blob":"text",a=new XMLHttpRequest;if(a.onload=function(){if(200===a.status)if("text"===s)n(a.response);else{var e=new FileReader;e.addEventListener("load",(function(){return n(e.result)}),!1),e.addEventListener("error",(function(e){return o(e)}),!1),e.readAsDataURL(a.response)}else o("Failed to proxy resource "+r+" with status code "+a.status)},a.onerror=o,a.open("GET",i+"?url="+encodeURIComponent(e)+"&responseType="+s),"text"!==s&&a instanceof XMLHttpRequest&&(a.responseType=s),t._options.imageTimeout){var l=t._options.imageTimeout;a.timeout=l,a.ontimeout=function(){return o("Timed out ("+l+"ms) proxying "+r)}}a.send()}))},e}(),Or=/^data:image\/svg\+xml/i,Lr=/^data:image\/.*;base64,/i,Dr=/^data:image\/.*/i,Ir=function(e){return Br.SUPPORT_SVG_DRAWING||!Nr(e)},Rr=function(e){return Dr.test(e)},Hr=function(e){return Lr.test(e)},Fr=function(e){return"blob"===e.substr(0,4)},Nr=function(e){return"svg"===e.substr(-3).toLowerCase()||Or.test(e)},Qr=function(e){var t=Xi(180),i=[],r=ar.LINEAR_GRADIENT,n=Kr.CIRCLE,o=Vr.FARTHEST_CORNER,s=[];return Oi(e).forEach((function(e,t){var n=e[0];if(0===t){if(xi(n)&&"linear"===n.value)return void(r=ar.LINEAR_GRADIENT);if(xi(n)&&"radial"===n.value)return void(r=ar.RADIAL_GRADIENT)}if(n.type===m.FUNCTION)if("from"===n.name){var o=Ji.parse(n.values[0]);i.push({stop:Hi,color:o})}else if("to"===n.name)o=Ji.parse(n.values[0]),i.push({stop:Ni,color:o});else if("color-stop"===n.name){var s=n.values.filter(Ti);if(2===s.length){o=Ji.parse(s[1]);var a=s[0];Si(a)&&i.push({stop:{type:m.PERCENTAGE_TOKEN,number:100*a.number,flags:a.flags},color:o})}}})),r===ar.LINEAR_GRADIENT?{angle:(t+Xi(180))%Xi(360),stops:i,type:r}:{size:o,shape:n,stops:i,position:s,type:r}},kr="closest-side",Ur="farthest-side",jr="closest-corner",Gr="farthest-corner",zr="circle",Yr="ellipse",Zr="cover",Wr="contain",Xr=function(e){var t=Kr.CIRCLE,i=Vr.FARTHEST_CORNER,r=[],n=[];return Oi(e).forEach((function(e,o){var s=!0;if(0===o){var a=!1;s=e.reduce((function(e,r){if(a)if(xi(r))switch(r.value){case"center":return n.push(Fi),e;case"top":case"left":return n.push(Hi),e;case"right":case"bottom":return n.push(Ni),e}else(Ii(r)||Di(r))&&n.push(r);else if(xi(r))switch(r.value){case zr:return t=Kr.CIRCLE,!1;case Yr:return t=Kr.ELLIPSE,!1;case"at":return a=!0,!1;case kr:return i=Vr.CLOSEST_SIDE,!1;case Zr:case Ur:return i=Vr.FARTHEST_SIDE,!1;case Wr:case jr:return i=Vr.CLOSEST_CORNER,!1;case Gr:return i=Vr.FARTHEST_CORNER,!1}else if(Di(r)||Ii(r))return Array.isArray(i)||(i=[]),i.push(r),!1;return e}),s)}if(s){var l=cr(e);r.push(l)}})),{size:i,shape:t,stops:r,position:n,type:ar.RADIAL_GRADIENT}},Jr=function(e){var t=Kr.CIRCLE,i=Vr.FARTHEST_CORNER,r=[],n=[];return Oi(e).forEach((function(e,o){var s=!0;if(0===o?s=e.reduce((function(e,t){if(xi(t))switch(t.value){case"center":return n.push(Fi),!1;case"top":case"left":return n.push(Hi),!1;case"right":case"bottom":return n.push(Ni),!1}else if(Ii(t)||Di(t))return n.push(t),!1;return e}),s):1===o&&(s=e.reduce((function(e,r){if(xi(r))switch(r.value){case zr:return t=Kr.CIRCLE,!1;case Yr:return t=Kr.ELLIPSE,!1;case Wr:case kr:return i=Vr.CLOSEST_SIDE,!1;case Ur:return i=Vr.FARTHEST_SIDE,!1;case jr:return i=Vr.CLOSEST_CORNER,!1;case Zr:case Gr:return i=Vr.FARTHEST_CORNER,!1}else if(Di(r)||Ii(r))return Array.isArray(i)||(i=[]),i.push(r),!1;return e}),s)),s){var a=cr(e);r.push(a)}})),{size:i,shape:t,stops:r,position:n,type:ar.RADIAL_GRADIENT}};!function(e){e[e.URL=0]="URL",e[e.LINEAR_GRADIENT=1]="LINEAR_GRADIENT",e[e.RADIAL_GRADIENT=2]="RADIAL_GRADIENT"}(ar||(ar={}));var Kr,Vr,qr=function(e){return e.type===ar.LINEAR_GRADIENT},$r=function(e){return e.type===ar.RADIAL_GRADIENT};(function(e){e[e.CIRCLE=0]="CIRCLE",e[e.ELLIPSE=1]="ELLIPSE"})(Kr||(Kr={})),function(e){e[e.CLOSEST_SIDE=0]="CLOSEST_SIDE",e[e.FARTHEST_SIDE=1]="FARTHEST_SIDE",e[e.CLOSEST_CORNER=2]="CLOSEST_CORNER",e[e.FARTHEST_CORNER=3]="FARTHEST_CORNER"}(Vr||(Vr={}));var en={name:"image",parse:function(e){if(e.type===m.URL_TOKEN){var t={url:e.value,type:ar.URL};return Er.getInstance().addImage(e.value),t}if(e.type===m.FUNCTION){var i=nn[e.name];if(void 0===i)throw new Error('Attempting to parse an unsupported image function "'+e.name+'"');return i(e.values)}throw new Error("Unsupported image type")}};function tn(e){return e.type!==m.FUNCTION||nn[e.name]}var rn,nn={"linear-gradient":Ar,"-moz-linear-gradient":yr,"-ms-linear-gradient":yr,"-o-linear-gradient":yr,"-webkit-linear-gradient":yr,"radial-gradient":Xr,"-moz-radial-gradient":Jr,"-ms-radial-gradient":Jr,"-o-radial-gradient":Jr,"-webkit-radial-gradient":Jr,"-webkit-gradient":Qr},on={name:"background-image",initialValue:"none",type:ir.LIST,prefix:!1,parse:function(e){if(0===e.length)return[];var t=e[0];return t.type===m.IDENT_TOKEN&&"none"===t.value?[]:e.filter((function(e){return Ti(e)&&tn(e)})).map(en.parse)}},sn={name:"background-origin",initialValue:"border-box",prefix:!1,type:ir.LIST,parse:function(e){return e.map((function(e){if(xi(e))switch(e.value){case"padding-box":return 1;case"content-box":return 2}return 0}))}},an={name:"background-position",initialValue:"0% 0%",type:ir.LIST,prefix:!1,parse:function(e){return Oi(e).map((function(e){return e.filter(Ii)})).map(Ri)}};!function(e){e[e.REPEAT=0]="REPEAT",e[e.NO_REPEAT=1]="NO_REPEAT",e[e.REPEAT_X=2]="REPEAT_X",e[e.REPEAT_Y=3]="REPEAT_Y"}(rn||(rn={}));var ln,hn={name:"background-repeat",initialValue:"repeat",prefix:!1,type:ir.LIST,parse:function(e){return Oi(e).map((function(e){return e.filter(xi).map((function(e){return e.value})).join(" ")})).map(cn)}},cn=function(e){switch(e){case"no-repeat":return rn.NO_REPEAT;case"repeat-x":case"repeat no-repeat":return rn.REPEAT_X;case"repeat-y":case"no-repeat repeat":return rn.REPEAT_Y;default:return rn.REPEAT}};!function(e){e.AUTO="auto",e.CONTAIN="contain",e.COVER="cover"}(ln||(ln={}));var un,pn={name:"background-size",initialValue:"0",prefix:!1,type:ir.LIST,parse:function(e){return Oi(e).map((function(e){return e.filter(dn)}))}},dn=function(e){return xi(e)||Ii(e)},mn=function(e){return{name:"border-"+e+"-color",initialValue:"transparent",prefix:!1,type:ir.TYPE_VALUE,format:"color"}},fn=mn("top"),gn=mn("right"),An=mn("bottom"),yn=mn("left"),vn=function(e){return{name:"border-radius-"+e,initialValue:"0 0",prefix:!1,type:ir.LIST,parse:function(e){return Ri(e.filter(Ii))}}},Cn=vn("top-left"),_n=vn("top-right"),bn=vn("bottom-right"),wn=vn("bottom-left");!function(e){e[e.NONE=0]="NONE",e[e.SOLID=1]="SOLID"}(un||(un={}));var Pn,Sn=function(e){return{name:"border-"+e+"-style",initialValue:"solid",prefix:!1,type:ir.IDENT_VALUE,parse:function(e){return"none"===e?un.NONE:un.SOLID}}},xn=Sn("top"),Bn=Sn("right"),Mn=Sn("bottom"),En=Sn("left"),Tn=function(e){return{name:"border-"+e+"-width",initialValue:"0",type:ir.VALUE,prefix:!1,parse:function(e){return Pi(e)?e.number:0}}},On=Tn("top"),Ln=Tn("right"),Dn=Tn("bottom"),In=Tn("left"),Rn={name:"color",initialValue:"transparent",prefix:!1,type:ir.TYPE_VALUE,format:"color"},Hn={name:"display",initialValue:"inline-block",prefix:!1,type:ir.LIST,parse:function(e){return e.filter(xi).reduce((function(e,t){return e|Fn(t.value)}),0)}},Fn=function(e){switch(e){case"block":return 2;case"inline":return 4;case"run-in":return 8;case"flow":return 16;case"flow-root":return 32;case"table":return 64;case"flex":case"-webkit-flex":return 128;case"grid":case"-ms-grid":return 256;case"ruby":return 512;case"subgrid":return 1024;case"list-item":return 2048;case"table-row-group":return 4096;case"table-header-group":return 8192;case"table-footer-group":return 16384;case"table-row":return 32768;case"table-cell":return 65536;case"table-column-group":return 131072;case"table-column":return 262144;case"table-caption":return 524288;case"ruby-base":return 1048576;case"ruby-text":return 2097152;case"ruby-base-container":return 4194304;case"ruby-text-container":return 8388608;case"contents":return 16777216;case"inline-block":return 33554432;case"inline-list-item":return 67108864;case"inline-table":return 134217728;case"inline-flex":return 268435456;case"inline-grid":return 536870912}return 0};!function(e){e[e.NONE=0]="NONE",e[e.LEFT=1]="LEFT",e[e.RIGHT=2]="RIGHT",e[e.INLINE_START=3]="INLINE_START",e[e.INLINE_END=4]="INLINE_END"}(Pn||(Pn={}));var Nn,Qn={name:"float",initialValue:"none",prefix:!1,type:ir.IDENT_VALUE,parse:function(e){switch(e){case"left":return Pn.LEFT;case"right":return Pn.RIGHT;case"inline-start":return Pn.INLINE_START;case"inline-end":return Pn.INLINE_END}return Pn.NONE}},kn={name:"letter-spacing",initialValue:"0",prefix:!1,type:ir.VALUE,parse:function(e){return e.type===m.IDENT_TOKEN&&"normal"===e.value?0:e.type===m.NUMBER_TOKEN||e.type===m.DIMENSION_TOKEN?e.number:0}};!function(e){e.NORMAL="normal",e.STRICT="strict"}(Nn||(Nn={}));var Un,jn={name:"line-break",initialValue:"normal",prefix:!1,type:ir.IDENT_VALUE,parse:function(e){return"strict"===e?Nn.STRICT:Nn.NORMAL}},Gn={name:"line-height",initialValue:"normal",prefix:!1,type:ir.TOKEN_VALUE},zn=function(e,t){return xi(e)&&"normal"===e.value?1.2*t:e.type===m.NUMBER_TOKEN?t*e.number:Ii(e)?ki(e,t):t},Yn={name:"list-style-image",initialValue:"none",type:ir.VALUE,prefix:!1,parse:function(e){return e.type===m.IDENT_TOKEN&&"none"===e.value?null:en.parse(e)}};!function(e){e[e.INSIDE=0]="INSIDE",e[e.OUTSIDE=1]="OUTSIDE"}(Un||(Un={}));var Zn,Wn={name:"list-style-position",initialValue:"outside",prefix:!1,type:ir.IDENT_VALUE,parse:function(e){return"inside"===e?Un.INSIDE:Un.OUTSIDE}};!function(e){e[e.NONE=-1]="NONE",e[e.DISC=0]="DISC",e[e.CIRCLE=1]="CIRCLE",e[e.SQUARE=2]="SQUARE",e[e.DECIMAL=3]="DECIMAL",e[e.CJK_DECIMAL=4]="CJK_DECIMAL",e[e.DECIMAL_LEADING_ZERO=5]="DECIMAL_LEADING_ZERO",e[e.LOWER_ROMAN=6]="LOWER_ROMAN",e[e.UPPER_ROMAN=7]="UPPER_ROMAN",e[e.LOWER_GREEK=8]="LOWER_GREEK",e[e.LOWER_ALPHA=9]="LOWER_ALPHA",e[e.UPPER_ALPHA=10]="UPPER_ALPHA",e[e.ARABIC_INDIC=11]="ARABIC_INDIC",e[e.ARMENIAN=12]="ARMENIAN",e[e.BENGALI=13]="BENGALI",e[e.CAMBODIAN=14]="CAMBODIAN",e[e.CJK_EARTHLY_BRANCH=15]="CJK_EARTHLY_BRANCH",e[e.CJK_HEAVENLY_STEM=16]="CJK_HEAVENLY_STEM",e[e.CJK_IDEOGRAPHIC=17]="CJK_IDEOGRAPHIC",e[e.DEVANAGARI=18]="DEVANAGARI",e[e.ETHIOPIC_NUMERIC=19]="ETHIOPIC_NUMERIC",e[e.GEORGIAN=20]="GEORGIAN",e[e.GUJARATI=21]="GUJARATI",e[e.GURMUKHI=22]="GURMUKHI",e[e.HEBREW=22]="HEBREW",e[e.HIRAGANA=23]="HIRAGANA",e[e.HIRAGANA_IROHA=24]="HIRAGANA_IROHA",e[e.JAPANESE_FORMAL=25]="JAPANESE_FORMAL",e[e.JAPANESE_INFORMAL=26]="JAPANESE_INFORMAL",e[e.KANNADA=27]="KANNADA",e[e.KATAKANA=28]="KATAKANA",e[e.KATAKANA_IROHA=29]="KATAKANA_IROHA",e[e.KHMER=30]="KHMER",e[e.KOREAN_HANGUL_FORMAL=31]="KOREAN_HANGUL_FORMAL",e[e.KOREAN_HANJA_FORMAL=32]="KOREAN_HANJA_FORMAL",e[e.KOREAN_HANJA_INFORMAL=33]="KOREAN_HANJA_INFORMAL",e[e.LAO=34]="LAO",e[e.LOWER_ARMENIAN=35]="LOWER_ARMENIAN",e[e.MALAYALAM=36]="MALAYALAM",e[e.MONGOLIAN=37]="MONGOLIAN",e[e.MYANMAR=38]="MYANMAR",e[e.ORIYA=39]="ORIYA",e[e.PERSIAN=40]="PERSIAN",e[e.SIMP_CHINESE_FORMAL=41]="SIMP_CHINESE_FORMAL",e[e.SIMP_CHINESE_INFORMAL=42]="SIMP_CHINESE_INFORMAL",e[e.TAMIL=43]="TAMIL",e[e.TELUGU=44]="TELUGU",e[e.THAI=45]="THAI",e[e.TIBETAN=46]="TIBETAN",e[e.TRAD_CHINESE_FORMAL=47]="TRAD_CHINESE_FORMAL",e[e.TRAD_CHINESE_INFORMAL=48]="TRAD_CHINESE_INFORMAL",e[e.UPPER_ARMENIAN=49]="UPPER_ARMENIAN",e[e.DISCLOSURE_OPEN=50]="DISCLOSURE_OPEN",e[e.DISCLOSURE_CLOSED=51]="DISCLOSURE_CLOSED"}(Zn||(Zn={}));var Xn,Jn={name:"list-style-type",initialValue:"none",prefix:!1,type:ir.IDENT_VALUE,parse:function(e){switch(e){case"disc":return Zn.DISC;case"circle":return Zn.CIRCLE;case"square":return Zn.SQUARE;case"decimal":return Zn.DECIMAL;case"cjk-decimal":return Zn.CJK_DECIMAL;case"decimal-leading-zero":return Zn.DECIMAL_LEADING_ZERO;case"lower-roman":return Zn.LOWER_ROMAN;case"upper-roman":return Zn.UPPER_ROMAN;case"lower-greek":return Zn.LOWER_GREEK;case"lower-alpha":return Zn.LOWER_ALPHA;case"upper-alpha":return Zn.UPPER_ALPHA;case"arabic-indic":return Zn.ARABIC_INDIC;case"armenian":return Zn.ARMENIAN;case"bengali":return Zn.BENGALI;case"cambodian":return Zn.CAMBODIAN;case"cjk-earthly-branch":return Zn.CJK_EARTHLY_BRANCH;case"cjk-heavenly-stem":return Zn.CJK_HEAVENLY_STEM;case"cjk-ideographic":return Zn.CJK_IDEOGRAPHIC;case"devanagari":return Zn.DEVANAGARI;case"ethiopic-numeric":return Zn.ETHIOPIC_NUMERIC;case"georgian":return Zn.GEORGIAN;case"gujarati":return Zn.GUJARATI;case"gurmukhi":return Zn.GURMUKHI;case"hebrew":return Zn.HEBREW;case"hiragana":return Zn.HIRAGANA;case"hiragana-iroha":return Zn.HIRAGANA_IROHA;case"japanese-formal":return Zn.JAPANESE_FORMAL;case"japanese-informal":return Zn.JAPANESE_INFORMAL;case"kannada":return Zn.KANNADA;case"katakana":return Zn.KATAKANA;case"katakana-iroha":return Zn.KATAKANA_IROHA;case"khmer":return Zn.KHMER;case"korean-hangul-formal":return Zn.KOREAN_HANGUL_FORMAL;case"korean-hanja-formal":return Zn.KOREAN_HANJA_FORMAL;case"korean-hanja-informal":return Zn.KOREAN_HANJA_INFORMAL;case"lao":return Zn.LAO;case"lower-armenian":return Zn.LOWER_ARMENIAN;case"malayalam":return Zn.MALAYALAM;case"mongolian":return Zn.MONGOLIAN;case"myanmar":return Zn.MYANMAR;case"oriya":return Zn.ORIYA;case"persian":return Zn.PERSIAN;case"simp-chinese-formal":return Zn.SIMP_CHINESE_FORMAL;case"simp-chinese-informal":return Zn.SIMP_CHINESE_INFORMAL;case"tamil":return Zn.TAMIL;case"telugu":return Zn.TELUGU;case"thai":return Zn.THAI;case"tibetan":return Zn.TIBETAN;case"trad-chinese-formal":return Zn.TRAD_CHINESE_FORMAL;case"trad-chinese-informal":return Zn.TRAD_CHINESE_INFORMAL;case"upper-armenian":return Zn.UPPER_ARMENIAN;case"disclosure-open":return Zn.DISCLOSURE_OPEN;case"disclosure-closed":return Zn.DISCLOSURE_CLOSED;default:return Zn.NONE}}},Kn=function(e){return{name:"margin-"+e,initialValue:"0",prefix:!1,type:ir.TOKEN_VALUE}},Vn=Kn("top"),qn=Kn("right"),$n=Kn("bottom"),eo=Kn("left");!function(e){e[e.VISIBLE=0]="VISIBLE",e[e.HIDDEN=1]="HIDDEN",e[e.SCROLL=2]="SCROLL",e[e.AUTO=3]="AUTO"}(Xn||(Xn={}));var to,io={name:"overflow",initialValue:"visible",prefix:!1,type:ir.LIST,parse:function(e){return e.filter(xi).map((function(e){switch(e.value){case"hidden":return Xn.HIDDEN;case"scroll":return Xn.SCROLL;case"auto":return Xn.AUTO;default:return Xn.VISIBLE}}))}};!function(e){e.NORMAL="normal",e.BREAK_WORD="break-word"}(to||(to={}));var ro,no={name:"overflow-wrap",initialValue:"normal",prefix:!1,type:ir.IDENT_VALUE,parse:function(e){return"break-word"===e?to.BREAK_WORD:to.NORMAL}},oo=function(e){return{name:"padding-"+e,initialValue:"0",prefix:!1,type:ir.TYPE_VALUE,format:"length-percentage"}},so=oo("top"),ao=oo("right"),lo=oo("bottom"),ho=oo("left");!function(e){e[e.LEFT=0]="LEFT",e[e.CENTER=1]="CENTER",e[e.RIGHT=2]="RIGHT"}(ro||(ro={}));var co,uo={name:"text-align",initialValue:"left",prefix:!1,type:ir.IDENT_VALUE,parse:function(e){switch(e){case"right":return ro.RIGHT;case"center":case"justify":return ro.CENTER;default:return ro.LEFT}}};!function(e){e[e.STATIC=0]="STATIC",e[e.RELATIVE=1]="RELATIVE",e[e.ABSOLUTE=2]="ABSOLUTE",e[e.FIXED=3]="FIXED",e[e.STICKY=4]="STICKY"}(co||(co={}));var po,mo={name:"position",initialValue:"static",prefix:!1,type:ir.IDENT_VALUE,parse:function(e){switch(e){case"relative":return co.RELATIVE;case"absolute":return co.ABSOLUTE;case"fixed":return co.FIXED;case"sticky":return co.STICKY}return co.STATIC}},fo={name:"text-shadow",initialValue:"none",type:ir.LIST,prefix:!1,parse:function(e){return 1===e.length&&Mi(e[0],"none")?[]:Oi(e).map((function(e){for(var t={color:sr.TRANSPARENT,offsetX:Hi,offsetY:Hi,blur:Hi},i=0,r=0;r<e.length;r++){var n=e[r];Di(n)?(0===i?t.offsetX=n:1===i?t.offsetY=n:t.blur=n,i++):t.color=Ji.parse(n)}return t}))}};!function(e){e[e.NONE=0]="NONE",e[e.LOWERCASE=1]="LOWERCASE",e[e.UPPERCASE=2]="UPPERCASE",e[e.CAPITALIZE=3]="CAPITALIZE"}(po||(po={}));var go,Ao={name:"text-transform",initialValue:"none",prefix:!1,type:ir.IDENT_VALUE,parse:function(e){switch(e){case"uppercase":return po.UPPERCASE;case"lowercase":return po.LOWERCASE;case"capitalize":return po.CAPITALIZE}return po.NONE}},yo={name:"transform",initialValue:"none",prefix:!0,type:ir.VALUE,parse:function(e){if(e.type===m.IDENT_TOKEN&&"none"===e.value)return null;if(e.type===m.FUNCTION){var t=vo[e.name];if(void 0===t)throw new Error('Attempting to parse an unsupported transform function "'+e.name+'"');return t(e.values)}return null}},vo={matrix:function(e){var t=e.filter((function(e){return e.type===m.NUMBER_TOKEN})).map((function(e){return e.number}));return 6===t.length?t:null},matrix3d:function(e){var t=e.filter((function(e){return e.type===m.NUMBER_TOKEN})).map((function(e){return e.number})),i=t[0],r=t[1],n=(t[2],t[3],t[4]),o=t[5],s=(t[6],t[7],t[8],t[9],t[10],t[11],t[12]),a=t[13];return t[14],t[15],16===t.length?[i,r,n,o,s,a]:null}},Co={type:m.PERCENTAGE_TOKEN,number:50,flags:Qe},_o=[Co,Co],bo={name:"transform-origin",initialValue:"50% 50%",prefix:!0,type:ir.LIST,parse:function(e){var t=e.filter(Ii);return 2!==t.length?_o:[t[0],t[1]]}};!function(e){e[e.VISIBLE=0]="VISIBLE",e[e.HIDDEN=1]="HIDDEN",e[e.COLLAPSE=2]="COLLAPSE"}(go||(go={}));var wo,Po={name:"visible",initialValue:"none",prefix:!1,type:ir.IDENT_VALUE,parse:function(e){switch(e){case"hidden":return go.HIDDEN;case"collapse":return go.COLLAPSE;default:return go.VISIBLE}}};!function(e){e.NORMAL="normal",e.BREAK_ALL="break-all",e.KEEP_ALL="keep-all"}(wo||(wo={}));var So,xo={name:"word-break",initialValue:"normal",prefix:!1,type:ir.IDENT_VALUE,parse:function(e){switch(e){case"break-all":return wo.BREAK_ALL;case"keep-all":return wo.KEEP_ALL;default:return wo.NORMAL}}},Bo={name:"z-index",initialValue:"auto",prefix:!1,type:ir.VALUE,parse:function(e){if(e.type===m.IDENT_TOKEN)return{auto:!0,order:0};if(Si(e))return{auto:!1,order:e.number};throw new Error("Invalid z-index number parsed")}},Mo={name:"opacity",initialValue:"1",type:ir.VALUE,prefix:!1,parse:function(e){return Si(e)?e.number:1}},Eo={name:"text-decoration-color",initialValue:"transparent",prefix:!1,type:ir.TYPE_VALUE,format:"color"},To={name:"text-decoration-line",initialValue:"none",prefix:!1,type:ir.LIST,parse:function(e){return e.filter(xi).map((function(e){switch(e.value){case"underline":return 1;case"overline":return 2;case"line-through":return 3;case"none":return 4}return 0})).filter((function(e){return 0!==e}))}},Oo={name:"font-family",initialValue:"",prefix:!1,type:ir.LIST,parse:function(e){return e.filter(Lo).map((function(e){return e.value}))}},Lo=function(e){return e.type===m.STRING_TOKEN||e.type===m.IDENT_TOKEN},Do={name:"font-size",initialValue:"0",prefix:!1,type:ir.TYPE_VALUE,format:"length"},Io={name:"font-weight",initialValue:"normal",type:ir.VALUE,prefix:!1,parse:function(e){return Si(e)?e.number:xi(e)&&"bold"===e.value?700:400}},Ro={name:"font-variant",initialValue:"none",type:ir.LIST,prefix:!1,parse:function(e){return e.filter(xi).map((function(e){return e.value}))}};!function(e){e.NORMAL="normal",e.ITALIC="italic",e.OBLIQUE="oblique"}(So||(So={}));var Ho,Fo={name:"font-style",initialValue:"normal",prefix:!1,type:ir.IDENT_VALUE,parse:function(e){switch(e){case"oblique":return So.OBLIQUE;case"italic":return So.ITALIC;default:return So.NORMAL}}},No=function(e,t){return 0!=(e&t)},Qo={name:"content",initialValue:"none",type:ir.LIST,prefix:!1,parse:function(e){if(0===e.length)return[];var t=e[0];return t.type===m.IDENT_TOKEN&&"none"===t.value?[]:e}},ko={name:"counter-increment",initialValue:"none",prefix:!0,type:ir.LIST,parse:function(e){if(0===e.length)return null;var t=e[0];if(t.type===m.IDENT_TOKEN&&"none"===t.value)return null;for(var i=[],r=e.filter(Ei),n=0;n<r.length;n++){var o=r[n],s=r[n+1];if(o.type===m.IDENT_TOKEN){var a=s&&Si(s)?s.number:1;i.push({counter:o.value,increment:a})}}return i}},Uo={name:"counter-reset",initialValue:"none",prefix:!0,type:ir.LIST,parse:function(e){if(0===e.length)return[];for(var t=[],i=e.filter(Ei),r=0;r<i.length;r++){var n=i[r],o=i[r+1];if(xi(n)&&"none"!==n.value){var s=o&&Si(o)?o.number:0;t.push({counter:n.value,reset:s})}}return t}},jo={name:"quotes",initialValue:"none",prefix:!0,type:ir.LIST,parse:function(e){if(0===e.length)return null;var t=e[0];if(t.type===m.IDENT_TOKEN&&"none"===t.value)return null;var i=[],r=e.filter(Bi);if(r.length%2!=0)return null;for(var n=0;n<r.length;n+=2){var o=r[n].value,s=r[n+1].value;i.push({open:o,close:s})}return i}},Go=function(e,t,i){if(!e)return"";var r=e[Math.min(t,e.length-1)];return r?i?r.open:r.close:""},zo={name:"box-shadow",initialValue:"none",type:ir.LIST,prefix:!1,parse:function(e){return 1===e.length&&Mi(e[0],"none")?[]:Oi(e).map((function(e){for(var t={color:255,offsetX:Hi,offsetY:Hi,blur:Hi,spread:Hi,inset:!1},i=0,r=0;r<e.length;r++){var n=e[r];Mi(n,"inset")?t.inset=!0:Di(n)?(0===i?t.offsetX=n:1===i?t.offsetY=n:2===i?t.blur=n:t.spread=n,i++):t.color=Ji.parse(n)}return t}))}},Yo=function(){function e(e){this.backgroundClip=Xo(lr,e.backgroundClip),this.backgroundColor=Xo(hr,e.backgroundColor),this.backgroundImage=Xo(on,e.backgroundImage),this.backgroundOrigin=Xo(sn,e.backgroundOrigin),this.backgroundPosition=Xo(an,e.backgroundPosition),this.backgroundRepeat=Xo(hn,e.backgroundRepeat),this.backgroundSize=Xo(pn,e.backgroundSize),this.borderTopColor=Xo(fn,e.borderTopColor),this.borderRightColor=Xo(gn,e.borderRightColor),this.borderBottomColor=Xo(An,e.borderBottomColor),this.borderLeftColor=Xo(yn,e.borderLeftColor),this.borderTopLeftRadius=Xo(Cn,e.borderTopLeftRadius),this.borderTopRightRadius=Xo(_n,e.borderTopRightRadius),this.borderBottomRightRadius=Xo(bn,e.borderBottomRightRadius),this.borderBottomLeftRadius=Xo(wn,e.borderBottomLeftRadius),this.borderTopStyle=Xo(xn,e.borderTopStyle),this.borderRightStyle=Xo(Bn,e.borderRightStyle),this.borderBottomStyle=Xo(Mn,e.borderBottomStyle),this.borderLeftStyle=Xo(En,e.borderLeftStyle),this.borderTopWidth=Xo(On,e.borderTopWidth),this.borderRightWidth=Xo(Ln,e.borderRightWidth),this.borderBottomWidth=Xo(Dn,e.borderBottomWidth),this.borderLeftWidth=Xo(In,e.borderLeftWidth),this.boxShadow=Xo(zo,e.boxShadow),this.color=Xo(Rn,e.color),this.display=Xo(Hn,e.display),this.float=Xo(Qn,e.cssFloat),this.fontFamily=Xo(Oo,e.fontFamily),this.fontSize=Xo(Do,e.fontSize),this.fontStyle=Xo(Fo,e.fontStyle),this.fontVariant=Xo(Ro,e.fontVariant),this.fontWeight=Xo(Io,e.fontWeight),this.letterSpacing=Xo(kn,e.letterSpacing),this.lineBreak=Xo(jn,e.lineBreak),this.lineHeight=Xo(Gn,e.lineHeight),this.listStyleImage=Xo(Yn,e.listStyleImage),this.listStylePosition=Xo(Wn,e.listStylePosition),this.listStyleType=Xo(Jn,e.listStyleType),this.marginTop=Xo(Vn,e.marginTop),this.marginRight=Xo(qn,e.marginRight),this.marginBottom=Xo($n,e.marginBottom),this.marginLeft=Xo(eo,e.marginLeft),this.opacity=Xo(Mo,e.opacity);var t=Xo(io,e.overflow);this.overflowX=t[0],this.overflowY=t[t.length>1?1:0],this.overflowWrap=Xo(no,e.overflowWrap),this.paddingTop=Xo(so,e.paddingTop),this.paddingRight=Xo(ao,e.paddingRight),this.paddingBottom=Xo(lo,e.paddingBottom),this.paddingLeft=Xo(ho,e.paddingLeft),this.position=Xo(mo,e.position),this.textAlign=Xo(uo,e.textAlign),this.textDecorationColor=Xo(Eo,e.textDecorationColor||e.color),this.textDecorationLine=Xo(To,e.textDecorationLine),this.textShadow=Xo(fo,e.textShadow),this.textTransform=Xo(Ao,e.textTransform),this.transform=Xo(yo,e.transform),this.transformOrigin=Xo(bo,e.transformOrigin),this.visibility=Xo(Po,e.visibility),this.wordBreak=Xo(xo,e.wordBreak),this.zIndex=Xo(Bo,e.zIndex)}return e.prototype.isVisible=function(){return this.display>0&&this.opacity>0&&this.visibility===go.VISIBLE},e.prototype.isTransparent=function(){return Ki(this.backgroundColor)},e.prototype.isTransformed=function(){return null!==this.transform},e.prototype.isPositioned=function(){return this.position!==co.STATIC},e.prototype.isPositionedWithZIndex=function(){return this.isPositioned()&&!this.zIndex.auto},e.prototype.isFloating=function(){return this.float!==Pn.NONE},e.prototype.isInlineLevel=function(){return No(this.display,4)||No(this.display,33554432)||No(this.display,268435456)||No(this.display,536870912)||No(this.display,67108864)||No(this.display,134217728)},e}(),Zo=function(){function e(e){this.content=Xo(Qo,e.content),this.quotes=Xo(jo,e.quotes)}return e}(),Wo=function(){function e(e){this.counterIncrement=Xo(ko,e.counterIncrement),this.counterReset=Xo(Uo,e.counterReset)}return e}(),Xo=function(e,t){var i=new bi,r=null!=t?t.toString():e.initialValue;i.write(r);var n=new wi(i.read());switch(e.type){case ir.IDENT_VALUE:var o=n.parseComponentValue();return e.parse(xi(o)?o.value:e.initialValue);case ir.VALUE:return e.parse(n.parseComponentValue());case ir.LIST:return e.parse(n.parseComponentValues());case ir.TOKEN_VALUE:return n.parseComponentValue();case ir.TYPE_VALUE:switch(e.format){case"angle":return Yi.parse(n.parseComponentValue());case"color":return Ji.parse(n.parseComponentValue());case"image":return en.parse(n.parseComponentValue());case"length":var s=n.parseComponentValue();return Di(s)?s:Hi;case"length-percentage":var a=n.parseComponentValue();return Ii(a)?a:Hi}}throw new Error("Attempting to parse unsupported css format type "+e.format)},Jo=function(){function e(e){this.styles=new Yo(window.getComputedStyle(e,null)),this.textNodes=[],this.elements=[],null!==this.styles.transform&&Ls(e)&&(e.style.transform="none"),this.bounds=a(e),this.flags=0}return e}(),Ko=function(){function e(e,t){this.text=e,this.bounds=t}return e}(),Vo=function(e,t,i){var r=es(e,t),n=[],o=0;return r.forEach((function(e){if(t.textDecorationLine.length||e.trim().length>0)if(Br.SUPPORT_RANGE_BOUNDS)n.push(new Ko(e,$o(i,o,e.length)));else{var r=i.splitText(e.length);n.push(new Ko(e,qo(i))),i=r}else Br.SUPPORT_RANGE_BOUNDS||(i=i.splitText(e.length));o+=e.length})),n},qo=function(e){var t=e.ownerDocument;if(t){var i=t.createElement("html2canvaswrapper");i.appendChild(e.cloneNode(!0));var r=e.parentNode;if(r){r.replaceChild(i,e);var n=a(i);return i.firstChild&&r.replaceChild(i.firstChild,i),n}}return new s(0,0,0,0)},$o=function(e,t,i){var r=e.ownerDocument;if(!r)throw new Error("Node has no owner document");var n=r.createRange();return n.setStart(e,t),n.setEnd(e,t+i),s.fromClientRect(n.getBoundingClientRect())},es=function(e,t){return 0!==t.letterSpacing?h(e).map((function(e){return c(e)})):ts(e,t)},ts=function(e,t){for(var i,r=He(e,{lineBreak:t.lineBreak,wordBreak:t.overflowWrap===to.BREAK_WORD?"break-word":t.wordBreak}),n=[];!(i=r.next()).done;)i.value&&n.push(i.value.slice());return n},is=function(){function e(e,t){this.text=rs(e.data,t.textTransform),this.textBounds=Vo(this.text,t,e)}return e}(),rs=function(e,t){switch(t){case po.LOWERCASE:return e.toLowerCase();case po.CAPITALIZE:return e.replace(ns,os);case po.UPPERCASE:return e.toUpperCase();default:return e}},ns=/(^|\s|:|-|\(|\))([a-z])/g,os=function(e,t,i){return e.length>0?t+i.toUpperCase():e},ss=function(e){function i(t){var i=e.call(this,t)||this;return i.src=t.currentSrc||t.src,i.intrinsicWidth=t.naturalWidth,i.intrinsicHeight=t.naturalHeight,Er.getInstance().addImage(i.src),i}return t(i,e),i}(Jo),as=function(e){function i(t){var i=e.call(this,t)||this;return i.canvas=t,i.intrinsicWidth=t.width,i.intrinsicHeight=t.height,i}return t(i,e),i}(Jo),ls=function(e){function i(t){var i=e.call(this,t)||this,r=new XMLSerializer;return i.svg="data:image/svg+xml,"+encodeURIComponent(r.serializeToString(t)),i.intrinsicWidth=t.width.baseVal.value,i.intrinsicHeight=t.height.baseVal.value,Er.getInstance().addImage(i.svg),i}return t(i,e),i}(Jo),hs=function(e){function i(t){var i=e.call(this,t)||this;return i.value=t.value,i}return t(i,e),i}(Jo),cs=function(e){function i(t){var i=e.call(this,t)||this;return i.start=t.start,i.reversed="boolean"==typeof t.reversed&&!0===t.reversed,i}return t(i,e),i}(Jo),us=[{type:m.DIMENSION_TOKEN,flags:0,unit:"px",number:3}],ps=[{type:m.PERCENTAGE_TOKEN,flags:0,number:50}],ds=function(e){return e.width>e.height?new s(e.left+(e.width-e.height)/2,e.top,e.height,e.height):e.width<e.height?new s(e.left,e.top+(e.height-e.width)/2,e.width,e.width):e},ms=function(e){var t=e.type===As?new Array(e.value.length+1).join("•"):e.value;return 0===t.length?e.placeholder||"":t},fs="checkbox",gs="radio",As="password",ys=707406591,vs=function(e){function i(t){var i=e.call(this,t)||this;switch(i.type=t.type.toLowerCase(),i.checked=t.checked,i.value=ms(t),i.type!==fs&&i.type!==gs||(i.styles.backgroundColor=3739148031,i.styles.borderTopColor=i.styles.borderRightColor=i.styles.borderBottomColor=i.styles.borderLeftColor=2779096575,i.styles.borderTopWidth=i.styles.borderRightWidth=i.styles.borderBottomWidth=i.styles.borderLeftWidth=1,i.styles.borderTopStyle=i.styles.borderRightStyle=i.styles.borderBottomStyle=i.styles.borderLeftStyle=un.SOLID,i.styles.backgroundClip=[rr.BORDER_BOX],i.styles.backgroundOrigin=[0],i.bounds=ds(i.bounds)),i.type){case fs:i.styles.borderTopRightRadius=i.styles.borderTopLeftRadius=i.styles.borderBottomRightRadius=i.styles.borderBottomLeftRadius=us;break;case gs:i.styles.borderTopRightRadius=i.styles.borderTopLeftRadius=i.styles.borderBottomRightRadius=i.styles.borderBottomLeftRadius=ps}return i}return t(i,e),i}(Jo),Cs=function(e){function i(t){var i=e.call(this,t)||this,r=t.options[t.selectedIndex||0];return i.value=r&&r.text||"",i}return t(i,e),i}(Jo),_s=function(e){function i(t){var i=e.call(this,t)||this;return i.value=t.value,i}return t(i,e),i}(Jo),bs=function(e){return Ji.parse(wi.create(e).parseComponentValue())},ws=function(e){function i(t){var i=e.call(this,t)||this;i.src=t.src,i.width=parseInt(t.width,10)||0,i.height=parseInt(t.height,10)||0,i.backgroundColor=i.styles.backgroundColor;try{if(t.contentWindow&&t.contentWindow.document&&t.contentWindow.document.documentElement){i.tree=Bs(t.contentWindow.document.documentElement);var r=t.contentWindow.document.documentElement?bs(getComputedStyle(t.contentWindow.document.documentElement).backgroundColor):sr.TRANSPARENT,n=t.contentWindow.document.body?bs(getComputedStyle(t.contentWindow.document.body).backgroundColor):sr.TRANSPARENT;i.backgroundColor=Ki(r)?Ki(n)?i.styles.backgroundColor:n:r}}catch(e){}return i}return t(i,e),i}(Jo),Ps=["OL","UL","MENU"],Ss=function(e,t,i){for(var r=e.firstChild,n=void 0;r;r=n)if(n=r.nextSibling,Ts(r)&&r.data.trim().length>0)t.textNodes.push(new is(r,t.styles));else if(Os(r)){var o=xs(r);o.styles.isVisible()&&(Ms(r,o,i)?o.flags|=4:Es(o.styles)&&(o.flags|=2),-1!==Ps.indexOf(r.tagName)&&(o.flags|=8),t.elements.push(o),zs(r)||Fs(r)||Ys(r)||Ss(r,o,i))}},xs=function(e){return ks(e)?new ss(e):Qs(e)?new as(e):Fs(e)?new ls(e):Ds(e)?new hs(e):Is(e)?new cs(e):Rs(e)?new vs(e):Ys(e)?new Cs(e):zs(e)?new _s(e):Us(e)?new ws(e):new Jo(e)},Bs=function(e){var t=xs(e);return t.flags|=4,Ss(e,t,t),t},Ms=function(e,t,i){return t.styles.isPositionedWithZIndex()||t.styles.opacity<1||t.styles.isTransformed()||Ns(e)&&i.styles.isTransparent()},Es=function(e){return e.isPositioned()||e.isFloating()},Ts=function(e){return e.nodeType===Node.TEXT_NODE},Os=function(e){return e.nodeType===Node.ELEMENT_NODE},Ls=function(e){return void 0!==e.style},Ds=function(e){return"LI"===e.tagName},Is=function(e){return"OL"===e.tagName},Rs=function(e){return"INPUT"===e.tagName},Hs=function(e){return"HTML"===e.tagName},Fs=function(e){return"svg"===e.tagName},Ns=function(e){return"BODY"===e.tagName},Qs=function(e){return"CANVAS"===e.tagName},ks=function(e){return"IMG"===e.tagName},Us=function(e){return"IFRAME"===e.tagName},js=function(e){return"STYLE"===e.tagName},Gs=function(e){return"SCRIPT"===e.tagName},zs=function(e){return"TEXTAREA"===e.tagName},Ys=function(e){return"SELECT"===e.tagName},Zs=function(){function e(){this.counters={}}return e.prototype.getCounterValue=function(e){var t=this.counters[e];return t&&t.length?t[t.length-1]:1},e.prototype.getCounterValues=function(e){var t=this.counters[e];return t||[]},e.prototype.pop=function(e){var t=this;e.forEach((function(e){return t.counters[e].pop()}))},e.prototype.parse=function(e){var t=this,i=e.counterIncrement,r=e.counterReset,n=!0;null!==i&&i.forEach((function(e){var i=t.counters[e.counter];i&&0!==e.increment&&(n=!1,i[Math.max(0,i.length-1)]+=e.increment)}));var o=[];return n&&r.forEach((function(e){var i=t.counters[e.counter];o.push(e.counter),i||(i=t.counters[e.counter]=[]),i.push(e.reset)})),o},e}(),Ws={integers:[1e3,900,500,400,100,90,50,40,10,9,5,4,1],values:["M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I"]},Xs={integers:[9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["Ք","Փ","Ւ","Ց","Ր","Տ","Վ","Ս","Ռ","Ջ","Պ","Չ","Ո","Շ","Ն","Յ","Մ","Ճ","Ղ","Ձ","Հ","Կ","Ծ","Խ","Լ","Ի","Ժ","Թ","Ը","Է","Զ","Ե","Դ","Գ","Բ","Ա"]},Js={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,400,300,200,100,90,80,70,60,50,40,30,20,19,18,17,16,15,10,9,8,7,6,5,4,3,2,1],values:["י׳","ט׳","ח׳","ז׳","ו׳","ה׳","ד׳","ג׳","ב׳","א׳","ת","ש","ר","ק","צ","פ","ע","ס","נ","מ","ל","כ","יט","יח","יז","טז","טו","י","ט","ח","ז","ו","ה","ד","ג","ב","א"]},Ks={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["ჵ","ჰ","ჯ","ჴ","ხ","ჭ","წ","ძ","ც","ჩ","შ","ყ","ღ","ქ","ფ","ჳ","ტ","ს","რ","ჟ","პ","ო","ჲ","ნ","მ","ლ","კ","ი","თ","ჱ","ზ","ვ","ე","დ","გ","ბ","ა"]},Vs=function(e,t,i,r,n,o){return e<t||e>i?ca(e,n,o.length>0):r.integers.reduce((function(t,i,n){for(;e>=i;)e-=i,t+=r.values[n];return t}),"")+o},qs=function(e,t,i,r){var n="";do{i||e--,n=r(e)+n,e/=t}while(e*t>=t);return n},$s=function(e,t,i,r,n){var o=i-t+1;return(e<0?"-":"")+(qs(Math.abs(e),o,r,(function(e){return c(Math.floor(e%o)+t)}))+n)},ea=function(e,t,i){void 0===i&&(i=". ");var r=t.length;return qs(Math.abs(e),r,!1,(function(e){return t[Math.floor(e%r)]}))+i},ta=1,ia=2,ra=4,na=8,oa=function(e,t,i,r,n,o){if(e<-9999||e>9999)return ca(e,Zn.CJK_DECIMAL,n.length>0);var s=Math.abs(e),a=n;if(0===s)return t[0]+a;for(var l=0;s>0&&l<=4;l++){var h=s%10;0===h&&No(o,ta)&&""!==a?a=t[h]+a:h>1||1===h&&0===l||1===h&&1===l&&No(o,ia)||1===h&&1===l&&No(o,ra)&&e>100||1===h&&l>1&&No(o,na)?a=t[h]+(l>0?i[l-1]:"")+a:1===h&&l>0&&(a=i[l-1]+a),s=Math.floor(s/10)}return(e<0?r:"")+a},sa="十百千萬",aa="拾佰仟萬",la="マイナス",ha="마이너스",ca=function(e,t,i){var r=i?". ":"",n=i?"、":"",o=i?", ":"",s=i?" ":"";switch(t){case Zn.DISC:return"•"+s;case Zn.CIRCLE:return"◦"+s;case Zn.SQUARE:return"◾"+s;case Zn.DECIMAL_LEADING_ZERO:var a=$s(e,48,57,!0,r);return a.length<4?"0"+a:a;case Zn.CJK_DECIMAL:return ea(e,"〇一二三四五六七八九",n);case Zn.LOWER_ROMAN:return Vs(e,1,3999,Ws,Zn.DECIMAL,r).toLowerCase();case Zn.UPPER_ROMAN:return Vs(e,1,3999,Ws,Zn.DECIMAL,r);case Zn.LOWER_GREEK:return $s(e,945,969,!1,r);case Zn.LOWER_ALPHA:return $s(e,97,122,!1,r);case Zn.UPPER_ALPHA:return $s(e,65,90,!1,r);case Zn.ARABIC_INDIC:return $s(e,1632,1641,!0,r);case Zn.ARMENIAN:case Zn.UPPER_ARMENIAN:return Vs(e,1,9999,Xs,Zn.DECIMAL,r);case Zn.LOWER_ARMENIAN:return Vs(e,1,9999,Xs,Zn.DECIMAL,r).toLowerCase();case Zn.BENGALI:return $s(e,2534,2543,!0,r);case Zn.CAMBODIAN:case Zn.KHMER:return $s(e,6112,6121,!0,r);case Zn.CJK_EARTHLY_BRANCH:return ea(e,"子丑寅卯辰巳午未申酉戌亥",n);case Zn.CJK_HEAVENLY_STEM:return ea(e,"甲乙丙丁戊己庚辛壬癸",n);case Zn.CJK_IDEOGRAPHIC:case Zn.TRAD_CHINESE_INFORMAL:return oa(e,"零一二三四五六七八九",sa,"負",n,ia|ra|na);case Zn.TRAD_CHINESE_FORMAL:return oa(e,"零壹貳參肆伍陸柒捌玖",aa,"負",n,ta|ia|ra|na);case Zn.SIMP_CHINESE_INFORMAL:return oa(e,"零一二三四五六七八九",sa,"负",n,ia|ra|na);case Zn.SIMP_CHINESE_FORMAL:return oa(e,"零壹贰叁肆伍陆柒捌玖",aa,"负",n,ta|ia|ra|na);case Zn.JAPANESE_INFORMAL:return oa(e,"〇一二三四五六七八九","十百千万",la,n,0);case Zn.JAPANESE_FORMAL:return oa(e,"零壱弐参四伍六七八九","拾百千万",la,n,ta|ia|ra);case Zn.KOREAN_HANGUL_FORMAL:return oa(e,"영일이삼사오육칠팔구","십백천만",ha,o,ta|ia|ra);case Zn.KOREAN_HANJA_INFORMAL:return oa(e,"零一二三四五六七八九","十百千萬",ha,o,0);case Zn.KOREAN_HANJA_FORMAL:return oa(e,"零壹貳參四五六七八九","拾百千",ha,o,ta|ia|ra);case Zn.DEVANAGARI:return $s(e,2406,2415,!0,r);case Zn.GEORGIAN:return Vs(e,1,19999,Ks,Zn.DECIMAL,r);case Zn.GUJARATI:return $s(e,2790,2799,!0,r);case Zn.GURMUKHI:return $s(e,2662,2671,!0,r);case Zn.HEBREW:return Vs(e,1,10999,Js,Zn.DECIMAL,r);case Zn.HIRAGANA:return ea(e,"あいうえおかきくけこさしすせそたちつてとなにぬねのはひふへほまみむめもやゆよらりるれろわゐゑをん");case Zn.HIRAGANA_IROHA:return ea(e,"いろはにほへとちりぬるをわかよたれそつねならむうゐのおくやまけふこえてあさきゆめみしゑひもせす");case Zn.KANNADA:return $s(e,3302,3311,!0,r);case Zn.KATAKANA:return ea(e,"アイウエオカキクケコサシスセソタチツテトナニヌネノハヒフヘホマミムメモヤユヨラリルレロワヰヱヲン",n);case Zn.KATAKANA_IROHA:return ea(e,"イロハニホヘトチリヌルヲワカヨタレソツネナラムウヰノオクヤマケフコエテアサキユメミシヱヒモセス",n);case Zn.LAO:return $s(e,3792,3801,!0,r);case Zn.MONGOLIAN:return $s(e,6160,6169,!0,r);case Zn.MYANMAR:return $s(e,4160,4169,!0,r);case Zn.ORIYA:return $s(e,2918,2927,!0,r);case Zn.PERSIAN:return $s(e,1776,1785,!0,r);case Zn.TAMIL:return $s(e,3046,3055,!0,r);case Zn.TELUGU:return $s(e,3174,3183,!0,r);case Zn.THAI:return $s(e,3664,3673,!0,r);case Zn.TIBETAN:return $s(e,3872,3881,!0,r);case Zn.DECIMAL:default:return $s(e,48,57,!0,r)}},ua="data-html2canvas-ignore",pa=function(){function e(e,t){if(this.options=t,this.scrolledElements=[],this.referenceElement=e,this.counters=new Zs,this.quoteDepth=0,!e.ownerDocument)throw new Error("Cloned element does not have an owner document");this.documentElement=this.cloneNode(e.ownerDocument.documentElement)}return e.prototype.toIFrame=function(e,t){var i=this,r=ma(e,t);if(!r.contentWindow)return Promise.reject("Unable to find iframe window");var s=e.defaultView.pageXOffset,a=e.defaultView.pageYOffset,l=r.contentWindow,h=l.document,c=fa(r).then((function(){return n(i,void 0,void 0,(function(){var e;return o(this,(function(i){switch(i.label){case 0:return this.scrolledElements.forEach(va),l&&(l.scrollTo(t.left,t.top),!/(iPad|iPhone|iPod)/g.test(navigator.userAgent)||l.scrollY===t.top&&l.scrollX===t.left||(h.documentElement.style.top=-t.top+"px",h.documentElement.style.left=-t.left+"px",h.documentElement.style.position="absolute")),e=this.options.onclone,void 0===this.clonedReferenceElement?[2,Promise.reject("Error finding the "+this.referenceElement.nodeName+" in the cloned document")]:h.fonts&&h.fonts.ready?[4,h.fonts.ready]:[3,2];case 1:i.sent(),i.label=2;case 2:return"function"==typeof e?[2,Promise.resolve().then((function(){return e(h)})).then((function(){return r}))]:[2,r]}}))}))}));return h.open(),h.write(Aa(document.doctype)+"<html></html>"),ya(this.referenceElement.ownerDocument,s,a),h.replaceChild(h.adoptNode(this.documentElement),h.documentElement),h.close(),c},e.prototype.createElementClone=function(e){return Qs(e)?this.createCanvasClone(e):js(e)?this.createStyleClone(e):e.cloneNode(!1)},e.prototype.createStyleClone=function(e){try{var t=e.sheet;if(t&&t.cssRules){var i=[].slice.call(t.cssRules,0).reduce((function(e,t){return t&&"string"==typeof t.cssText?e+t.cssText:e}),""),r=e.cloneNode(!1);return r.textContent=i,r}}catch(e){if(Mr.getInstance(this.options.id).error("Unable to access cssRules property",e),"SecurityError"!==e.name)throw e}return e.cloneNode(!1)},e.prototype.createCanvasClone=function(e){if(this.options.inlineImages&&e.ownerDocument){var t=e.ownerDocument.createElement("img");try{return t.src=e.toDataURL(),t}catch(e){Mr.getInstance(this.options.id).info("Unable to clone canvas contents, canvas is tainted")}}var i=e.cloneNode(!1);try{i.width=e.width,i.height=e.height;var r=e.getContext("2d"),n=i.getContext("2d");return n&&(r?n.putImageData(r.getImageData(0,0,e.width,e.height),0,0):n.drawImage(e,0,0)),i}catch(e){}return i},e.prototype.cloneNode=function(e){if(Ts(e))return document.createTextNode(e.data);if(!e.ownerDocument)return e.cloneNode(!1);var t=e.ownerDocument.defaultView;if(Ls(e)&&t){var i=this.createElementClone(e),r=t.getComputedStyle(e),n=t.getComputedStyle(e,":before"),o=t.getComputedStyle(e,":after");this.referenceElement===e&&(this.clonedReferenceElement=i),Ns(i)&&Sa(i);for(var s=this.counters.parse(new Wo(r)),a=this.resolvePseudoContent(e,i,n,Ho.BEFORE),l=e.firstChild;l;l=l.nextSibling)Os(l)&&(Gs(l)||l.hasAttribute(ua)||"function"==typeof this.options.ignoreElements&&this.options.ignoreElements(l))||this.options.copyStyles&&Os(l)&&js(l)||i.appendChild(this.cloneNode(l));a&&i.insertBefore(a,i.firstChild);var h=this.resolvePseudoContent(e,i,o,Ho.AFTER);return h&&i.appendChild(h),this.counters.pop(s),r&&this.options.copyStyles&&!Us(e)&&ga(r,i),0===e.scrollTop&&0===e.scrollLeft||this.scrolledElements.push([i,e.scrollLeft,e.scrollTop]),(zs(e)||Ys(e))&&(zs(i)||Ys(i))&&(i.value=e.value),i}return e.cloneNode(!1)},e.prototype.resolvePseudoContent=function(e,t,i,r){var n=this;if(i){var o=i.content,s=t.ownerDocument;if(s&&o&&"none"!==o&&"-moz-alt-content"!==o&&"none"!==i.display){this.counters.parse(new Wo(i));var a=new Zo(i),l=s.createElement("html2canvaspseudoelement");return ga(i,l),a.content.forEach((function(t){if(t.type===m.STRING_TOKEN)l.appendChild(s.createTextNode(t.value));else if(t.type===m.URL_TOKEN){var i=s.createElement("img");i.src=t.value,i.style.opacity="1",l.appendChild(i)}else if(t.type===m.FUNCTION){if("attr"===t.name){var r=t.values.filter(xi);r.length&&l.appendChild(s.createTextNode(e.getAttribute(r[0].value)||""))}else if("counter"===t.name){var o=t.values.filter(Ti),h=o[0],c=o[1];if(h&&xi(h)){var u=n.counters.getCounterValue(h.value),p=c&&xi(c)?Jn.parse(c.value):Zn.DECIMAL;l.appendChild(s.createTextNode(ca(u,p,!1)))}}else if("counters"===t.name){var d=t.values.filter(Ti),f=(h=d[0],d[1]);if(c=d[2],h&&xi(h)){var g=n.counters.getCounterValues(h.value),A=c&&xi(c)?Jn.parse(c.value):Zn.DECIMAL,y=f&&f.type===m.STRING_TOKEN?f.value:"",v=g.map((function(e){return ca(e,A,!1)})).join(y);l.appendChild(s.createTextNode(v))}}}else if(t.type===m.IDENT_TOKEN)switch(t.value){case"open-quote":l.appendChild(s.createTextNode(Go(a.quotes,n.quoteDepth++,!0)));break;case"close-quote":l.appendChild(s.createTextNode(Go(a.quotes,--n.quoteDepth,!1)));break;default:l.appendChild(s.createTextNode(t.value))}})),l.className=ba+" "+wa,t.className+=r===Ho.BEFORE?" "+ba:" "+wa,l}}},e.destroy=function(e){return!!e.parentNode&&(e.parentNode.removeChild(e),!0)},e}();!function(e){e[e.BEFORE=0]="BEFORE",e[e.AFTER=1]="AFTER"}(Ho||(Ho={}));var da,ma=function(e,t){var i=e.createElement("iframe");return i.className="html2canvas-container",i.style.visibility="hidden",i.style.position="fixed",i.style.left="-10000px",i.style.top="0px",i.style.border="0",i.width=t.width.toString(),i.height=t.height.toString(),i.scrolling="no",i.setAttribute(ua,"true"),e.body.appendChild(i),i},fa=function(e){return new Promise((function(t,i){var r=e.contentWindow;if(!r)return i("No window assigned for iframe");var n=r.document;r.onload=e.onload=n.onreadystatechange=function(){r.onload=e.onload=n.onreadystatechange=null;var i=setInterval((function(){n.body.childNodes.length>0&&"complete"===n.readyState&&(clearInterval(i),t(e))}),50)}}))},ga=function(e,t){for(var i=e.length-1;i>=0;i--){var r=e.item(i);"content"!==r&&t.style.setProperty(r,e.getPropertyValue(r))}return t},Aa=function(e){var t="";return e&&(t+="<!DOCTYPE ",e.name&&(t+=e.name),e.internalSubset&&(t+=e.internalSubset),e.publicId&&(t+='"'+e.publicId+'"'),e.systemId&&(t+='"'+e.systemId+'"'),t+=">"),t},ya=function(e,t,i){e&&e.defaultView&&(t!==e.defaultView.pageXOffset||i!==e.defaultView.pageYOffset)&&e.defaultView.scrollTo(t,i)},va=function(e){var t=e[0],i=e[1],r=e[2];t.scrollLeft=i,t.scrollTop=r},Ca=":before",_a=":after",ba="___html2canvas___pseudoelement_before",wa="___html2canvas___pseudoelement_after",Pa='{\n    content: "" !important;\n    display: none !important;\n}',Sa=function(e){xa(e,"."+ba+Ca+Pa+"\n         ."+wa+_a+Pa)},xa=function(e,t){var i=e.ownerDocument;if(i){var r=i.createElement("style");r.textContent=t,e.appendChild(r)}};!function(e){e[e.VECTOR=0]="VECTOR",e[e.BEZIER_CURVE=1]="BEZIER_CURVE"}(da||(da={}));var Ba,Ma=function(e,t){return e.length===t.length&&e.some((function(e,i){return e===t[i]}))},Ea=function(e,t,i,r,n){return e.map((function(e,o){switch(o){case 0:return e.add(t,i);case 1:return e.add(t+r,i);case 2:return e.add(t+r,i+n);case 3:return e.add(t,i+n)}return e}))},Ta=function(){function e(e,t){this.type=da.VECTOR,this.x=e,this.y=t}return e.prototype.add=function(t,i){return new e(this.x+t,this.y+i)},e}(),Oa=function(e,t,i){return new Ta(e.x+(t.x-e.x)*i,e.y+(t.y-e.y)*i)},La=function(){function e(e,t,i,r){this.type=da.BEZIER_CURVE,this.start=e,this.startControl=t,this.endControl=i,this.end=r}return e.prototype.subdivide=function(t,i){var r=Oa(this.start,this.startControl,t),n=Oa(this.startControl,this.endControl,t),o=Oa(this.endControl,this.end,t),s=Oa(r,n,t),a=Oa(n,o,t),l=Oa(s,a,t);return i?new e(this.start,r,s,l):new e(l,a,o,this.end)},e.prototype.add=function(t,i){return new e(this.start.add(t,i),this.startControl.add(t,i),this.endControl.add(t,i),this.end.add(t,i))},e.prototype.reverse=function(){return new e(this.end,this.endControl,this.startControl,this.start)},e}(),Da=function(e){return e.type===da.BEZIER_CURVE},Ia=function(){function e(e){var t=e.styles,i=e.bounds,r=Qi(t.borderTopLeftRadius,i.width,i.height),n=r[0],o=r[1],s=Qi(t.borderTopRightRadius,i.width,i.height),a=s[0],l=s[1],h=Qi(t.borderBottomRightRadius,i.width,i.height),c=h[0],u=h[1],p=Qi(t.borderBottomLeftRadius,i.width,i.height),d=p[0],m=p[1],f=[];f.push((n+a)/i.width),f.push((d+c)/i.width),f.push((o+m)/i.height),f.push((l+u)/i.height);var g=Math.max.apply(Math,f);g>1&&(n/=g,o/=g,a/=g,l/=g,c/=g,u/=g,d/=g,m/=g);var A=i.width-a,y=i.height-u,v=i.width-c,C=i.height-m,_=t.borderTopWidth,b=t.borderRightWidth,w=t.borderBottomWidth,P=t.borderLeftWidth,S=ki(t.paddingTop,e.bounds.width),x=ki(t.paddingRight,e.bounds.width),B=ki(t.paddingBottom,e.bounds.width),M=ki(t.paddingLeft,e.bounds.width);this.topLeftBorderBox=n>0||o>0?Ra(i.left,i.top,n,o,Ba.TOP_LEFT):new Ta(i.left,i.top),this.topRightBorderBox=a>0||l>0?Ra(i.left+A,i.top,a,l,Ba.TOP_RIGHT):new Ta(i.left+i.width,i.top),this.bottomRightBorderBox=c>0||u>0?Ra(i.left+v,i.top+y,c,u,Ba.BOTTOM_RIGHT):new Ta(i.left+i.width,i.top+i.height),this.bottomLeftBorderBox=d>0||m>0?Ra(i.left,i.top+C,d,m,Ba.BOTTOM_LEFT):new Ta(i.left,i.top+i.height),this.topLeftPaddingBox=n>0||o>0?Ra(i.left+P,i.top+_,Math.max(0,n-P),Math.max(0,o-_),Ba.TOP_LEFT):new Ta(i.left+P,i.top+_),this.topRightPaddingBox=a>0||l>0?Ra(i.left+Math.min(A,i.width+P),i.top+_,A>i.width+P?0:a-P,l-_,Ba.TOP_RIGHT):new Ta(i.left+i.width-b,i.top+_),this.bottomRightPaddingBox=c>0||u>0?Ra(i.left+Math.min(v,i.width-P),i.top+Math.min(y,i.height+_),Math.max(0,c-b),u-w,Ba.BOTTOM_RIGHT):new Ta(i.left+i.width-b,i.top+i.height-w),this.bottomLeftPaddingBox=d>0||m>0?Ra(i.left+P,i.top+C,Math.max(0,d-P),m-w,Ba.BOTTOM_LEFT):new Ta(i.left+P,i.top+i.height-w),this.topLeftContentBox=n>0||o>0?Ra(i.left+P+M,i.top+_+S,Math.max(0,n-(P+M)),Math.max(0,o-(_+S)),Ba.TOP_LEFT):new Ta(i.left+P+M,i.top+_+S),this.topRightContentBox=a>0||l>0?Ra(i.left+Math.min(A,i.width+P+M),i.top+_+S,A>i.width+P+M?0:a-P+M,l-(_+S),Ba.TOP_RIGHT):new Ta(i.left+i.width-(b+x),i.top+_+S),this.bottomRightContentBox=c>0||u>0?Ra(i.left+Math.min(v,i.width-(P+M)),i.top+Math.min(y,i.height+_+S),Math.max(0,c-(b+x)),u-(w+B),Ba.BOTTOM_RIGHT):new Ta(i.left+i.width-(b+x),i.top+i.height-(w+B)),this.bottomLeftContentBox=d>0||m>0?Ra(i.left+P+M,i.top+C,Math.max(0,d-(P+M)),m-(w+B),Ba.BOTTOM_LEFT):new Ta(i.left+P+M,i.top+i.height-(w+B))}return e}();!function(e){e[e.TOP_LEFT=0]="TOP_LEFT",e[e.TOP_RIGHT=1]="TOP_RIGHT",e[e.BOTTOM_RIGHT=2]="BOTTOM_RIGHT",e[e.BOTTOM_LEFT=3]="BOTTOM_LEFT"}(Ba||(Ba={}));var Ra=function(e,t,i,r,n){var o=(Math.sqrt(2)-1)/3*4,s=i*o,a=r*o,l=e+i,h=t+r;switch(n){case Ba.TOP_LEFT:return new La(new Ta(e,h),new Ta(e,h-a),new Ta(l-s,t),new Ta(l,t));case Ba.TOP_RIGHT:return new La(new Ta(e,t),new Ta(e+s,t),new Ta(l,h-a),new Ta(l,h));case Ba.BOTTOM_RIGHT:return new La(new Ta(l,t),new Ta(l,t+a),new Ta(e+s,h),new Ta(e,h));case Ba.BOTTOM_LEFT:default:return new La(new Ta(l,h),new Ta(l-s,h),new Ta(e,t+a),new Ta(e,t))}},Ha=function(e){return[e.topLeftBorderBox,e.topRightBorderBox,e.bottomRightBorderBox,e.bottomLeftBorderBox]},Fa=function(e){return[e.topLeftContentBox,e.topRightContentBox,e.bottomRightContentBox,e.bottomLeftContentBox]},Na=function(e){return[e.topLeftPaddingBox,e.topRightPaddingBox,e.bottomRightPaddingBox,e.bottomLeftPaddingBox]},Qa=function(){function e(e,t,i){this.type=0,this.offsetX=e,this.offsetY=t,this.matrix=i,this.target=6}return e}(),ka=function(){function e(e,t){this.type=1,this.target=t,this.path=e}return e}(),Ua=function(e){return 0===e.type},ja=function(e){return 1===e.type},Ga=function(){function e(e){this.element=e,this.inlineLevel=[],this.nonInlineLevel=[],this.negativeZIndex=[],this.zeroOrAutoZIndexOrTransformedOrOpacity=[],this.positiveZIndex=[],this.nonPositionedFloats=[],this.nonPositionedInlineLevel=[]}return e}(),za=function(){function e(e,t){if(this.container=e,this.effects=t.slice(0),this.curves=new Ia(e),null!==e.styles.transform){var i=e.bounds.left+e.styles.transformOrigin[0].number,r=e.bounds.top+e.styles.transformOrigin[1].number,n=e.styles.transform;this.effects.push(new Qa(i,r,n))}if(e.styles.overflowX!==Xn.VISIBLE){var o=Ha(this.curves),s=Na(this.curves);Ma(o,s)?this.effects.push(new ka(o,6)):(this.effects.push(new ka(o,2)),this.effects.push(new ka(s,4)))}}return e.prototype.getParentEffects=function(){var e=this.effects.slice(0);if(this.container.styles.overflowX!==Xn.VISIBLE){var t=Ha(this.curves),i=Na(this.curves);Ma(t,i)||e.push(new ka(i,6))}return e},e}(),Ya=function(e,t,i,r){e.container.elements.forEach((function(n){var o=No(n.flags,4),s=No(n.flags,2),a=new za(n,e.getParentEffects());No(n.styles.display,2048)&&r.push(a);var l=No(n.flags,8)?[]:r;if(o||s){var h=o||n.styles.isPositioned()?i:t,c=new Ga(a);if(n.styles.isPositioned()||n.styles.opacity<1||n.styles.isTransformed()){var u=n.styles.zIndex.order;if(u<0){var p=0;h.negativeZIndex.some((function(e,t){return u>e.element.container.styles.zIndex.order?(p=t,!1):p>0})),h.negativeZIndex.splice(p,0,c)}else if(u>0){var d=0;h.positiveZIndex.some((function(e,t){return u>e.element.container.styles.zIndex.order?(d=t+1,!1):d>0})),h.positiveZIndex.splice(d,0,c)}else h.zeroOrAutoZIndexOrTransformedOrOpacity.push(c)}else n.styles.isFloating()?h.nonPositionedFloats.push(c):h.nonPositionedInlineLevel.push(c);Ya(a,c,o?c:i,l)}else n.styles.isInlineLevel()?t.inlineLevel.push(a):t.nonInlineLevel.push(a),Ya(a,t,i,l);No(n.flags,8)&&Za(n,l)}))},Za=function(e,t){for(var i=e instanceof cs?e.start:1,r=e instanceof cs&&e.reversed,n=0;n<t.length;n++){var o=t[n];o.container instanceof hs&&"number"==typeof o.container.value&&0!==o.container.value&&(i=o.container.value),o.listValue=ca(i,o.container.styles.listStyleType,!0),i+=r?-1:1}},Wa=function(e){var t=new za(e,[]),i=new Ga(t),r=[];return Ya(t,i,i,r),Za(t.container,r),i},Xa=function(e,t){switch(t){case 0:return Ja(e.topLeftBorderBox,e.topLeftPaddingBox,e.topRightBorderBox,e.topRightPaddingBox);case 1:return Ja(e.topRightBorderBox,e.topRightPaddingBox,e.bottomRightBorderBox,e.bottomRightPaddingBox);case 2:return Ja(e.bottomRightBorderBox,e.bottomRightPaddingBox,e.bottomLeftBorderBox,e.bottomLeftPaddingBox);default:return Ja(e.bottomLeftBorderBox,e.bottomLeftPaddingBox,e.topLeftBorderBox,e.topLeftPaddingBox)}},Ja=function(e,t,i,r){var n=[];return Da(e)?n.push(e.subdivide(.5,!1)):n.push(e),Da(i)?n.push(i.subdivide(.5,!0)):n.push(i),Da(r)?n.push(r.subdivide(.5,!0).reverse()):n.push(r),Da(t)?n.push(t.subdivide(.5,!1).reverse()):n.push(t),n},Ka=function(e){var t=e.bounds,i=e.styles;return t.add(i.borderLeftWidth,i.borderTopWidth,-(i.borderRightWidth+i.borderLeftWidth),-(i.borderTopWidth+i.borderBottomWidth))},Va=function(e){var t=e.styles,i=e.bounds,r=ki(t.paddingLeft,i.width),n=ki(t.paddingRight,i.width),o=ki(t.paddingTop,i.width),s=ki(t.paddingBottom,i.width);return i.add(r+t.borderLeftWidth,o+t.borderTopWidth,-(t.borderRightWidth+t.borderLeftWidth+r+n),-(t.borderTopWidth+t.borderBottomWidth+o+s))},qa=function(e,t){return 0===e?t.bounds:2===e?Va(t):Ka(t)},$a=function(e,t){return e===rr.BORDER_BOX?t.bounds:e===rr.CONTENT_BOX?Va(t):Ka(t)},el=function(e,t,i){var r=qa(nl(e.styles.backgroundOrigin,t),e),n=$a(nl(e.styles.backgroundClip,t),e),o=rl(nl(e.styles.backgroundSize,t),i,r),s=o[0],a=o[1],l=Qi(nl(e.styles.backgroundPosition,t),r.width-s,r.height-a);return[ol(nl(e.styles.backgroundRepeat,t),l,o,r,n),Math.round(r.left+l[0]),Math.round(r.top+l[1]),s,a]},tl=function(e){return xi(e)&&e.value===ln.AUTO},il=function(e){return"number"==typeof e},rl=function(e,t,i){var r=t[0],n=t[1],o=t[2],s=e[0],a=e[1];if(Ii(s)&&a&&Ii(a))return[ki(s,i.width),ki(a,i.height)];var l=il(o);if(xi(s)&&(s.value===ln.CONTAIN||s.value===ln.COVER))return il(o)?i.width/i.height<o!=(s.value===ln.COVER)?[i.width,i.width/o]:[i.height*o,i.height]:[i.width,i.height];var h=il(r),c=il(n),u=h||c;if(tl(s)&&(!a||tl(a)))return h&&c?[r,n]:l||u?u&&l?[h?r:n*o,c?n:r/o]:[h?r:i.width,c?n:i.height]:[i.width,i.height];if(l){var p=0,d=0;return Ii(s)?p=ki(s,i.width):Ii(a)&&(d=ki(a,i.height)),tl(s)?p=d*o:a&&!tl(a)||(d=p/o),[p,d]}var m=null,f=null;if(Ii(s)?m=ki(s,i.width):a&&Ii(a)&&(f=ki(a,i.height)),null===m||a&&!tl(a)||(f=h&&c?m/r*n:i.height),null!==f&&tl(s)&&(m=h&&c?f/n*r:i.width),null!==m&&null!==f)return[m,f];throw new Error("Unable to calculate background-size for element")},nl=function(e,t){var i=e[t];return void 0===i?e[0]:i},ol=function(e,t,i,r,n){var o=t[0],s=t[1],a=i[0],l=i[1];switch(e){case rn.REPEAT_X:return[new Ta(Math.round(r.left),Math.round(r.top+s)),new Ta(Math.round(r.left+r.width),Math.round(r.top+s)),new Ta(Math.round(r.left+r.width),Math.round(l+r.top+s)),new Ta(Math.round(r.left),Math.round(l+r.top+s))];case rn.REPEAT_Y:return[new Ta(Math.round(r.left+o),Math.round(r.top)),new Ta(Math.round(r.left+o+a),Math.round(r.top)),new Ta(Math.round(r.left+o+a),Math.round(r.height+r.top)),new Ta(Math.round(r.left+o),Math.round(r.height+r.top))];case rn.NO_REPEAT:return[new Ta(Math.round(r.left+o),Math.round(r.top+s)),new Ta(Math.round(r.left+o+a),Math.round(r.top+s)),new Ta(Math.round(r.left+o+a),Math.round(r.top+s+l)),new Ta(Math.round(r.left+o),Math.round(r.top+s+l))];default:return[new Ta(Math.round(n.left),Math.round(n.top)),new Ta(Math.round(n.left+n.width),Math.round(n.top)),new Ta(Math.round(n.left+n.width),Math.round(n.height+n.top)),new Ta(Math.round(n.left),Math.round(n.height+n.top))]}},sl="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",al="Hidden Text",ll=function(){function e(e){this._data={},this._document=e}return e.prototype.parseMetrics=function(e,t){var i=this._document.createElement("div"),r=this._document.createElement("img"),n=this._document.createElement("span"),o=this._document.body;i.style.visibility="hidden",i.style.fontFamily=e,i.style.fontSize=t,i.style.margin="0",i.style.padding="0",o.appendChild(i),r.src=sl,r.width=1,r.height=1,r.style.margin="0",r.style.padding="0",r.style.verticalAlign="baseline",n.style.fontFamily=e,n.style.fontSize=t,n.style.margin="0",n.style.padding="0",n.appendChild(this._document.createTextNode(al)),i.appendChild(n),i.appendChild(r);var s=r.offsetTop-n.offsetTop+2;i.removeChild(n),i.appendChild(this._document.createTextNode(al)),i.style.lineHeight="normal",r.style.verticalAlign="super";var a=r.offsetTop-i.offsetTop+2;return o.removeChild(i),{baseline:s,middle:a}},e.prototype.getMetrics=function(e,t){var i=e+" "+t;return void 0===this._data[i]&&(this._data[i]=this.parseMetrics(e,t)),this._data[i]},e}(),hl=1e4,cl=function(){function e(e){this._activeEffects=[],this.canvas=e.canvas?e.canvas:document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),this.options=e,e.canvas||(this.canvas.width=Math.floor(e.width*e.scale),this.canvas.height=Math.floor(e.height*e.scale),this.canvas.style.width=e.width+"px",this.canvas.style.height=e.height+"px"),this.fontMetrics=new ll(document),this.ctx.scale(this.options.scale,this.options.scale),this.ctx.translate(-e.x+e.scrollX,-e.y+e.scrollY),this.ctx.textBaseline="bottom",this._activeEffects=[],Mr.getInstance(e.id).debug("Canvas renderer initialized ("+e.width+"x"+e.height+" at "+e.x+","+e.y+") with scale "+e.scale)}return e.prototype.applyEffects=function(e,t){for(var i=this;this._activeEffects.length;)this.popEffect();e.filter((function(e){return No(e.target,t)})).forEach((function(e){return i.applyEffect(e)}))},e.prototype.applyEffect=function(e){this.ctx.save(),Ua(e)&&(this.ctx.translate(e.offsetX,e.offsetY),this.ctx.transform(e.matrix[0],e.matrix[1],e.matrix[2],e.matrix[3],e.matrix[4],e.matrix[5]),this.ctx.translate(-e.offsetX,-e.offsetY)),ja(e)&&(this.path(e.path),this.ctx.clip()),this._activeEffects.push(e)},e.prototype.popEffect=function(){this._activeEffects.pop(),this.ctx.restore()},e.prototype.renderStack=function(e){return n(this,void 0,void 0,(function(){var t;return o(this,(function(i){switch(i.label){case 0:return(t=e.element.container.styles).isVisible()?(this.ctx.globalAlpha=t.opacity,[4,this.renderStackContent(e)]):[3,2];case 1:i.sent(),i.label=2;case 2:return[2]}}))}))},e.prototype.renderNode=function(e){return n(this,void 0,void 0,(function(){return o(this,(function(t){switch(t.label){case 0:return e.container.styles.isVisible()?[4,this.renderNodeBackgroundAndBorders(e)]:[3,3];case 1:return t.sent(),[4,this.renderNodeContent(e)];case 2:t.sent(),t.label=3;case 3:return[2]}}))}))},e.prototype.renderTextWithLetterSpacing=function(e,t){var i=this;if(0===t)this.ctx.fillText(e.text,e.bounds.left,e.bounds.top+e.bounds.height);else{var r=h(e.text).map((function(e){return c(e)}));r.reduce((function(t,r){return i.ctx.fillText(r,t,e.bounds.top+e.bounds.height),t+i.ctx.measureText(r).width}),e.bounds.left)}},e.prototype.createFontStyle=function(e){var t=e.fontVariant.filter((function(e){return"normal"===e||"small-caps"===e})).join(""),i=e.fontFamily.join(", "),r=Pi(e.fontSize)?""+e.fontSize.number+e.fontSize.unit:e.fontSize.number+"px";return[[e.fontStyle,t,e.fontWeight,r,i].join(" "),i,r]},e.prototype.renderTextNode=function(e,t){return n(this,void 0,void 0,(function(){var i,r,n,s,a=this;return o(this,(function(o){return i=this.createFontStyle(t),r=i[0],n=i[1],s=i[2],this.ctx.font=r,e.textBounds.forEach((function(e){a.ctx.fillStyle=Vi(t.color),a.renderTextWithLetterSpacing(e,t.letterSpacing);var i=t.textShadow;i.length&&e.text.trim().length&&(i.slice(0).reverse().forEach((function(t){a.ctx.shadowColor=Vi(t.color),a.ctx.shadowOffsetX=t.offsetX.number*a.options.scale,a.ctx.shadowOffsetY=t.offsetY.number*a.options.scale,a.ctx.shadowBlur=t.blur.number,a.ctx.fillText(e.text,e.bounds.left,e.bounds.top+e.bounds.height)})),a.ctx.shadowColor="",a.ctx.shadowOffsetX=0,a.ctx.shadowOffsetY=0,a.ctx.shadowBlur=0),t.textDecorationLine.length&&(a.ctx.fillStyle=Vi(t.textDecorationColor||t.color),t.textDecorationLine.forEach((function(t){switch(t){case 1:var i=a.fontMetrics.getMetrics(n,s).baseline;a.ctx.fillRect(e.bounds.left,Math.round(e.bounds.top+i),e.bounds.width,1);break;case 2:a.ctx.fillRect(e.bounds.left,Math.round(e.bounds.top),e.bounds.width,1);break;case 3:var r=a.fontMetrics.getMetrics(n,s).middle;a.ctx.fillRect(e.bounds.left,Math.ceil(e.bounds.top+r),e.bounds.width,1)}})))})),[2]}))}))},e.prototype.renderReplacedElement=function(e,t,i){if(i&&e.intrinsicWidth>0&&e.intrinsicHeight>0){var r=Va(e),n=Na(t);this.path(n),this.ctx.save(),this.ctx.clip(),this.ctx.drawImage(i,0,0,e.intrinsicWidth,e.intrinsicHeight,r.left,r.top,r.width,r.height),this.ctx.restore()}},e.prototype.renderNodeContent=function(t){return n(this,void 0,void 0,(function(){var i,r,n,a,l,h,c,u,p,d,m,f,g,A;return o(this,(function(o){switch(o.label){case 0:this.applyEffects(t.effects,4),i=t.container,r=t.curves,n=i.styles,a=0,l=i.textNodes,o.label=1;case 1:return a<l.length?(h=l[a],[4,this.renderTextNode(h,n)]):[3,4];case 2:o.sent(),o.label=3;case 3:return a++,[3,1];case 4:if(!(i instanceof ss))return[3,8];o.label=5;case 5:return o.trys.push([5,7,,8]),[4,this.options.cache.match(i.src)];case 6:return f=o.sent(),this.renderReplacedElement(i,r,f),[3,8];case 7:return o.sent(),Mr.getInstance(this.options.id).error("Error loading image "+i.src),[3,8];case 8:if(i instanceof as&&this.renderReplacedElement(i,r,i.canvas),!(i instanceof ls))return[3,12];o.label=9;case 9:return o.trys.push([9,11,,12]),[4,this.options.cache.match(i.svg)];case 10:return f=o.sent(),this.renderReplacedElement(i,r,f),[3,12];case 11:return o.sent(),Mr.getInstance(this.options.id).error("Error loading svg "+i.svg.substring(0,255)),[3,12];case 12:return i instanceof ws&&i.tree?[4,new e({id:this.options.id,scale:this.options.scale,backgroundColor:i.backgroundColor,x:0,y:0,scrollX:0,scrollY:0,width:i.width,height:i.height,cache:this.options.cache,windowWidth:i.width,windowHeight:i.height}).render(i.tree)]:[3,14];case 13:c=o.sent(),i.width&&i.height&&this.ctx.drawImage(c,0,0,i.width,i.height,i.bounds.left,i.bounds.top,i.bounds.width,i.bounds.height),o.label=14;case 14:if(i instanceof vs&&(u=Math.min(i.bounds.width,i.bounds.height),i.type===fs?i.checked&&(this.ctx.save(),this.path([new Ta(i.bounds.left+.39363*u,i.bounds.top+.79*u),new Ta(i.bounds.left+.16*u,i.bounds.top+.5549*u),new Ta(i.bounds.left+.27347*u,i.bounds.top+.44071*u),new Ta(i.bounds.left+.39694*u,i.bounds.top+.5649*u),new Ta(i.bounds.left+.72983*u,i.bounds.top+.23*u),new Ta(i.bounds.left+.84*u,i.bounds.top+.34085*u),new Ta(i.bounds.left+.39363*u,i.bounds.top+.79*u)]),this.ctx.fillStyle=Vi(ys),this.ctx.fill(),this.ctx.restore()):i.type===gs&&i.checked&&(this.ctx.save(),this.ctx.beginPath(),this.ctx.arc(i.bounds.left+u/2,i.bounds.top+u/2,u/4,0,2*Math.PI,!0),this.ctx.fillStyle=Vi(ys),this.ctx.fill(),this.ctx.restore())),ul(i)&&i.value.length){switch(this.ctx.font=this.createFontStyle(n)[0],this.ctx.fillStyle=Vi(n.color),this.ctx.textBaseline="middle",this.ctx.textAlign=dl(i.styles.textAlign),A=Va(i),p=0,i.styles.textAlign){case ro.CENTER:p+=A.width/2;break;case ro.RIGHT:p+=A.width}d=A.add(p,0,0,-A.height/2+1),this.ctx.save(),this.path([new Ta(A.left,A.top),new Ta(A.left+A.width,A.top),new Ta(A.left+A.width,A.top+A.height),new Ta(A.left,A.top+A.height)]),this.ctx.clip(),this.renderTextWithLetterSpacing(new Ko(i.value,d),n.letterSpacing),this.ctx.restore(),this.ctx.textBaseline="bottom",this.ctx.textAlign="left"}if(!No(i.styles.display,2048))return[3,20];if(null===i.styles.listStyleImage)return[3,19];if((m=i.styles.listStyleImage).type!==ar.URL)return[3,18];f=void 0,g=m.url,o.label=15;case 15:return o.trys.push([15,17,,18]),[4,this.options.cache.match(g)];case 16:return f=o.sent(),this.ctx.drawImage(f,i.bounds.left-(f.width+10),i.bounds.top),[3,18];case 17:return o.sent(),Mr.getInstance(this.options.id).error("Error loading list-style-image "+g),[3,18];case 18:return[3,20];case 19:t.listValue&&i.styles.listStyleType!==Zn.NONE&&(this.ctx.font=this.createFontStyle(n)[0],this.ctx.fillStyle=Vi(n.color),this.ctx.textBaseline="middle",this.ctx.textAlign="right",A=new s(i.bounds.left,i.bounds.top+ki(i.styles.paddingTop,i.bounds.width),i.bounds.width,zn(n.lineHeight,n.fontSize.number)/2+1),this.renderTextWithLetterSpacing(new Ko(t.listValue,A),n.letterSpacing),this.ctx.textBaseline="bottom",this.ctx.textAlign="left"),o.label=20;case 20:return[2]}}))}))},e.prototype.renderStackContent=function(e){return n(this,void 0,void 0,(function(){var t,i,r,n,s,a,l,h,c,u,p,d,m,f,g;return o(this,(function(o){switch(o.label){case 0:return[4,this.renderNodeBackgroundAndBorders(e.element)];case 1:o.sent(),t=0,i=e.negativeZIndex,o.label=2;case 2:return t<i.length?(g=i[t],[4,this.renderStack(g)]):[3,5];case 3:o.sent(),o.label=4;case 4:return t++,[3,2];case 5:return[4,this.renderNodeContent(e.element)];case 6:o.sent(),r=0,n=e.nonInlineLevel,o.label=7;case 7:return r<n.length?(g=n[r],[4,this.renderNode(g)]):[3,10];case 8:o.sent(),o.label=9;case 9:return r++,[3,7];case 10:s=0,a=e.nonPositionedFloats,o.label=11;case 11:return s<a.length?(g=a[s],[4,this.renderStack(g)]):[3,14];case 12:o.sent(),o.label=13;case 13:return s++,[3,11];case 14:l=0,h=e.nonPositionedInlineLevel,o.label=15;case 15:return l<h.length?(g=h[l],[4,this.renderStack(g)]):[3,18];case 16:o.sent(),o.label=17;case 17:return l++,[3,15];case 18:c=0,u=e.inlineLevel,o.label=19;case 19:return c<u.length?(g=u[c],[4,this.renderNode(g)]):[3,22];case 20:o.sent(),o.label=21;case 21:return c++,[3,19];case 22:p=0,d=e.zeroOrAutoZIndexOrTransformedOrOpacity,o.label=23;case 23:return p<d.length?(g=d[p],[4,this.renderStack(g)]):[3,26];case 24:o.sent(),o.label=25;case 25:return p++,[3,23];case 26:m=0,f=e.positiveZIndex,o.label=27;case 27:return m<f.length?(g=f[m],[4,this.renderStack(g)]):[3,30];case 28:o.sent(),o.label=29;case 29:return m++,[3,27];case 30:return[2]}}))}))},e.prototype.mask=function(e){this.ctx.beginPath(),this.ctx.moveTo(0,0),this.ctx.lineTo(this.canvas.width,0),this.ctx.lineTo(this.canvas.width,this.canvas.height),this.ctx.lineTo(0,this.canvas.height),this.ctx.lineTo(0,0),this.formatPath(e.slice(0).reverse()),this.ctx.closePath()},e.prototype.path=function(e){this.ctx.beginPath(),this.formatPath(e),this.ctx.closePath()},e.prototype.formatPath=function(e){var t=this;e.forEach((function(e,i){var r=Da(e)?e.start:e;0===i?t.ctx.moveTo(r.x,r.y):t.ctx.lineTo(r.x,r.y),Da(e)&&t.ctx.bezierCurveTo(e.startControl.x,e.startControl.y,e.endControl.x,e.endControl.y,e.end.x,e.end.y)}))},e.prototype.renderRepeat=function(e,t,i,r){this.path(e),this.ctx.fillStyle=t,this.ctx.translate(i,r),this.ctx.fill(),this.ctx.translate(-i,-r)},e.prototype.resizeImage=function(e,t,i){if(e.width===t&&e.height===i)return e;var r=this.canvas.ownerDocument.createElement("canvas");return r.width=t,r.height=i,r.getContext("2d").drawImage(e,0,0,e.width,e.height,0,0,t,i),r},e.prototype.renderBackgroundImage=function(e){return n(this,void 0,void 0,(function(){var t,i,r,n,s,a;return o(this,(function(l){switch(l.label){case 0:t=e.styles.backgroundImage.length-1,i=function(i){var n,s,a,l,h,c,u,p,d,m,f,g,A,y,v,C,_,b,w,P,S,x,B,M,E,T,O,L,D,I,R;return o(this,(function(o){switch(o.label){case 0:if(i.type!==ar.URL)return[3,5];n=void 0,s=i.url,o.label=1;case 1:return o.trys.push([1,3,,4]),[4,r.options.cache.match(s)];case 2:return n=o.sent(),[3,4];case 3:return o.sent(),Mr.getInstance(r.options.id).error("Error loading background-image "+s),[3,4];case 4:return n&&(a=el(e,t,[n.width,n.height,n.width/n.height]),C=a[0],x=a[1],B=a[2],w=a[3],P=a[4],y=r.ctx.createPattern(r.resizeImage(n,w,P),"repeat"),r.renderRepeat(C,y,x,B)),[3,6];case 5:qr(i)?(l=el(e,t,[null,null,null]),C=l[0],x=l[1],B=l[2],w=l[3],P=l[4],h=dr(i.angle,w,P),c=h[0],u=h[1],p=h[2],d=h[3],m=h[4],(f=document.createElement("canvas")).width=w,f.height=P,g=f.getContext("2d"),A=g.createLinearGradient(u,d,p,m),ur(i.stops,c).forEach((function(e){return A.addColorStop(e.stop,Vi(e.color))})),g.fillStyle=A,g.fillRect(0,0,w,P),w>0&&P>0&&(y=r.ctx.createPattern(f,"repeat"),r.renderRepeat(C,y,x,B))):$r(i)&&(v=el(e,t,[null,null,null]),C=v[0],_=v[1],b=v[2],w=v[3],P=v[4],S=0===i.position.length?[Fi]:i.position,x=ki(S[0],w),B=ki(S[S.length-1],P),M=gr(i,x,B,w,P),E=M[0],T=M[1],E>0&&E>0&&(O=r.ctx.createRadialGradient(_+x,b+B,0,_+x,b+B,E),ur(i.stops,2*E).forEach((function(e){return O.addColorStop(e.stop,Vi(e.color))})),r.path(C),r.ctx.fillStyle=O,E!==T?(L=e.bounds.left+.5*e.bounds.width,D=e.bounds.top+.5*e.bounds.height,R=1/(I=T/E),r.ctx.save(),r.ctx.translate(L,D),r.ctx.transform(1,0,0,I,0,0),r.ctx.translate(-L,-D),r.ctx.fillRect(_,R*(b-D)+D,w,P*R),r.ctx.restore()):r.ctx.fill())),o.label=6;case 6:return t--,[2]}}))},r=this,n=0,s=e.styles.backgroundImage.slice(0).reverse(),l.label=1;case 1:return n<s.length?(a=s[n],[5,i(a)]):[3,4];case 2:l.sent(),l.label=3;case 3:return n++,[3,1];case 4:return[2]}}))}))},e.prototype.renderBorder=function(e,t,i){return n(this,void 0,void 0,(function(){return o(this,(function(r){return this.path(Xa(i,t)),this.ctx.fillStyle=Vi(e),this.ctx.fill(),[2]}))}))},e.prototype.renderNodeBackgroundAndBorders=function(e){return n(this,void 0,void 0,(function(){var t,i,r,n,s,a,l,h,c=this;return o(this,(function(o){switch(o.label){case 0:return this.applyEffects(e.effects,2),t=e.container.styles,i=!Ki(t.backgroundColor)||t.backgroundImage.length,r=[{style:t.borderTopStyle,color:t.borderTopColor},{style:t.borderRightStyle,color:t.borderRightColor},{style:t.borderBottomStyle,color:t.borderBottomColor},{style:t.borderLeftStyle,color:t.borderLeftColor}],n=pl(nl(t.backgroundClip,0),e.curves),i||t.boxShadow.length?(this.ctx.save(),this.path(n),this.ctx.clip(),Ki(t.backgroundColor)||(this.ctx.fillStyle=Vi(t.backgroundColor),this.ctx.fill()),[4,this.renderBackgroundImage(e.container)]):[3,2];case 1:o.sent(),this.ctx.restore(),t.boxShadow.slice(0).reverse().forEach((function(t){c.ctx.save();var i=Ha(e.curves),r=t.inset?0:hl,n=Ea(i,-r+(t.inset?1:-1)*t.spread.number,(t.inset?1:-1)*t.spread.number,t.spread.number*(t.inset?-2:2),t.spread.number*(t.inset?-2:2));t.inset?(c.path(i),c.ctx.clip(),c.mask(n)):(c.mask(i),c.ctx.clip(),c.path(n)),c.ctx.shadowOffsetX=t.offsetX.number+r,c.ctx.shadowOffsetY=t.offsetY.number,c.ctx.shadowColor=Vi(t.color),c.ctx.shadowBlur=t.blur.number,c.ctx.fillStyle=t.inset?Vi(t.color):"rgba(0,0,0,1)",c.ctx.fill(),c.ctx.restore()})),o.label=2;case 2:s=0,a=0,l=r,o.label=3;case 3:return a<l.length?(h=l[a]).style===un.NONE||Ki(h.color)?[3,5]:[4,this.renderBorder(h.color,s,e.curves)]:[3,7];case 4:o.sent(),o.label=5;case 5:s++,o.label=6;case 6:return a++,[3,3];case 7:return[2]}}))}))},e.prototype.render=function(e){return n(this,void 0,void 0,(function(){var t;return o(this,(function(i){switch(i.label){case 0:return this.options.backgroundColor&&(this.ctx.fillStyle=Vi(this.options.backgroundColor),this.ctx.fillRect(this.options.x-this.options.scrollX,this.options.y-this.options.scrollY,this.options.width,this.options.height)),t=Wa(e),[4,this.renderStack(t)];case 1:return i.sent(),this.applyEffects([],2),[2,this.canvas]}}))}))},e}(),ul=function(e){return e instanceof _s||e instanceof Cs||e instanceof vs&&e.type!==gs&&e.type!==fs},pl=function(e,t){switch(e){case rr.BORDER_BOX:return Ha(t);case rr.CONTENT_BOX:return Fa(t);case rr.PADDING_BOX:default:return Na(t)}},dl=function(e){switch(e){case ro.CENTER:return"center";case ro.RIGHT:return"right";case ro.LEFT:default:return"left"}},ml=function(){function e(e){this.canvas=e.canvas?e.canvas:document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),this.options=e,this.canvas.width=Math.floor(e.width*e.scale),this.canvas.height=Math.floor(e.height*e.scale),this.canvas.style.width=e.width+"px",this.canvas.style.height=e.height+"px",this.ctx.scale(this.options.scale,this.options.scale),this.ctx.translate(-e.x+e.scrollX,-e.y+e.scrollY),Mr.getInstance(e.id).debug("EXPERIMENTAL ForeignObject renderer initialized ("+e.width+"x"+e.height+" at "+e.x+","+e.y+") with scale "+e.scale)}return e.prototype.render=function(e){return n(this,void 0,void 0,(function(){var t,i;return o(this,(function(r){switch(r.label){case 0:return t=Sr(Math.max(this.options.windowWidth,this.options.width)*this.options.scale,Math.max(this.options.windowHeight,this.options.height)*this.options.scale,this.options.scrollX*this.options.scale,this.options.scrollY*this.options.scale,e),[4,fl(t)];case 1:return i=r.sent(),this.options.backgroundColor&&(this.ctx.fillStyle=Vi(this.options.backgroundColor),this.ctx.fillRect(0,0,this.options.width*this.options.scale,this.options.height*this.options.scale)),this.ctx.drawImage(i,-this.options.x*this.options.scale,-this.options.y*this.options.scale),[2,this.canvas]}}))}))},e}(),fl=function(e){return new Promise((function(t,i){var r=new Image;r.onload=function(){t(r)},r.onerror=i,r.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent((new XMLSerializer).serializeToString(e))}))},gl=void 0,Al=function(e){return Ji.parse(wi.create(e).parseComponentValue())},yl=function(e,t){return void 0===t&&(t={}),vl(e,t)};Er.setContext(window);var vl=function(e,t){return n(gl,void 0,void 0,(function(){var r,n,h,c,u,p,d,m,f,g,A,y,v,C,_,b,w,P,S,x,B,M,E;return o(this,(function(o){switch(o.label){case 0:if(!(r=e.ownerDocument))throw new Error("Element is not attached to a Document");if(!(n=r.defaultView))throw new Error("Document is not attached to a Window");return h=(Math.round(1e3*Math.random())+Date.now()).toString(16),c=Ns(e)||Hs(e)?l(r):a(e),u=c.width,p=c.height,d=c.left,m=c.top,f=i({},{allowTaint:!1,imageTimeout:15e3,proxy:void 0,useCORS:!1},t),g={backgroundColor:"#ffffff",cache:t.cache?t.cache:Er.create(h,f),logging:!0,removeContainer:!0,foreignObjectRendering:!1,scale:n.devicePixelRatio||1,windowWidth:n.innerWidth,windowHeight:n.innerHeight,scrollX:n.pageXOffset,scrollY:n.pageYOffset,x:d,y:m,width:Math.ceil(u),height:Math.ceil(p),id:h},A=i({},g,f,t),y=new s(A.scrollX,A.scrollY,A.windowWidth,A.windowHeight),Mr.create({id:h,enabled:A.logging}),Mr.getInstance(h).debug("Starting document clone"),v=new pa(e,{id:h,onclone:A.onclone,ignoreElements:A.ignoreElements,inlineImages:A.foreignObjectRendering,copyStyles:A.foreignObjectRendering}),(C=v.clonedReferenceElement)?[4,v.toIFrame(r,y)]:[2,Promise.reject("Unable to find element in cloned iframe")];case 1:return _=o.sent(),b=r.documentElement?Al(getComputedStyle(r.documentElement).backgroundColor):sr.TRANSPARENT,w=r.body?Al(getComputedStyle(r.body).backgroundColor):sr.TRANSPARENT,P=t.backgroundColor,S="string"==typeof P?Al(P):null===P?sr.TRANSPARENT:4294967295,x=e===r.documentElement?Ki(b)?Ki(w)?S:w:b:S,B={id:h,cache:A.cache,canvas:A.canvas,backgroundColor:x,scale:A.scale,x:A.x,y:A.y,scrollX:A.scrollX,scrollY:A.scrollY,width:A.width,height:A.height,windowWidth:A.windowWidth,windowHeight:A.windowHeight},A.foreignObjectRendering?(Mr.getInstance(h).debug("Document cloned, using foreign object rendering"),[4,new ml(B).render(C)]):[3,3];case 2:return M=o.sent(),[3,5];case 3:return Mr.getInstance(h).debug("Document cloned, using computed rendering"),Er.attachInstance(A.cache),Mr.getInstance(h).debug("Starting DOM parsing"),E=Bs(C),Er.detachInstance(),x===E.styles.backgroundColor&&(E.styles.backgroundColor=sr.TRANSPARENT),Mr.getInstance(h).debug("Starting renderer"),[4,new cl(B).render(E)];case 4:M=o.sent(),o.label=5;case 5:return!0===A.removeContainer&&(pa.destroy(_)||Mr.getInstance(h).error("Cannot detach cloned iframe as it is not in the DOM anymore")),Mr.getInstance(h).debug("Finished rendering"),Mr.destroy(h),Er.destroy(h),[2,M]}}))}))};return yl}()},5285:function(e,t,i){var r=i(5108);e.exports=function(){"use strict";function e(e,t){if(e[t])return e[t];for(var i,r=Object.keys(e),n=t.toLowerCase().replace(ve,""),o=-1;++o<r.length;)if((i=r[o]).toLowerCase().replace(ve,"")===n)return e[i]}function t(e){if("string"!=typeof e)throw new Error("not a string");this.text=e.trim(),this.level=0,this.place=0,this.root=null,this.stack=[],this.currentObject=null,this.state=_e}function i(e){return new t(e).output()}function n(e,t,i){Array.isArray(t)&&(i.unshift(t),t=null);var r=t?{}:e,n=i.reduce((function(e,t){return o(t,e),e}),r);t&&(e[t]=n)}function o(e,t){if(Array.isArray(e)){var i,r=e.shift();if("PARAMETER"===r&&(r=e.shift()),1===e.length)return Array.isArray(e[0])?(t[r]={},void o(e[0],t[r])):void(t[r]=e[0]);if(e.length)if("TOWGS84"!==r)switch(Array.isArray(r)||(t[r]={}),r){case"UNIT":case"PRIMEM":case"VERT_DATUM":return t[r]={name:e[0].toLowerCase(),convert:e[1]},void(3===e.length&&o(e[2],t[r]));case"SPHEROID":case"ELLIPSOID":return t[r]={name:e[0],a:e[1],rf:e[2]},void(4===e.length&&o(e[3],t[r]));case"PROJECTEDCRS":case"PROJCRS":case"GEOGCS":case"GEOCCS":case"PROJCS":case"LOCAL_CS":case"GEODCRS":case"GEODETICCRS":case"GEODETICDATUM":case"EDATUM":case"ENGINEERINGDATUM":case"VERT_CS":case"VERTCRS":case"VERTICALCRS":case"COMPD_CS":case"COMPOUNDCRS":case"ENGINEERINGCRS":case"ENGCRS":case"FITTED_CS":case"LOCAL_DATUM":case"DATUM":return e[0]=["name",e[0]],void n(t,r,e);default:for(i=-1;++i<e.length;)if(!Array.isArray(e[i]))return o(e,t[r]);return n(t,r,e)}else t[r]=e;else t[r]=!0}else t[e]=!0}function s(e,t){var i=t[0],r=t[1];!(i in e)&&r in e&&(e[i]=e[r],3===t.length&&(e[i]=t[2](e[i])))}function a(e){return e*Be}function l(e){function t(t){return t*(e.to_meter||1)}"GEOGCS"===e.type?e.projName="longlat":"LOCAL_CS"===e.type?(e.projName="identity",e.local=!0):"object"==typeof e.PROJECTION?e.projName=Object.keys(e.PROJECTION)[0]:e.projName=e.PROJECTION,e.UNIT&&(e.units=e.UNIT.name.toLowerCase(),"metre"===e.units&&(e.units="meter"),e.UNIT.convert&&("GEOGCS"===e.type?e.DATUM&&e.DATUM.SPHEROID&&(e.to_meter=e.UNIT.convert*e.DATUM.SPHEROID.a):e.to_meter=e.UNIT.convert));var i=e.GEOGCS;"GEOGCS"===e.type&&(i=e),i&&(i.DATUM?e.datumCode=i.DATUM.name.toLowerCase():e.datumCode=i.name.toLowerCase(),"d_"===e.datumCode.slice(0,2)&&(e.datumCode=e.datumCode.slice(2)),"new_zealand_geodetic_datum_1949"!==e.datumCode&&"new_zealand_1949"!==e.datumCode||(e.datumCode="nzgd49"),"wgs_1984"===e.datumCode&&("Mercator_Auxiliary_Sphere"===e.PROJECTION&&(e.sphere=!0),e.datumCode="wgs84"),"_ferro"===e.datumCode.slice(-6)&&(e.datumCode=e.datumCode.slice(0,-6)),"_jakarta"===e.datumCode.slice(-8)&&(e.datumCode=e.datumCode.slice(0,-8)),~e.datumCode.indexOf("belge")&&(e.datumCode="rnb72"),i.DATUM&&i.DATUM.SPHEROID&&(e.ellps=i.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk"),"international"===e.ellps.toLowerCase().slice(0,13)&&(e.ellps="intl"),e.a=i.DATUM.SPHEROID.a,e.rf=parseFloat(i.DATUM.SPHEROID.rf,10)),i.DATUM&&i.DATUM.TOWGS84&&(e.datum_params=i.DATUM.TOWGS84),~e.datumCode.indexOf("osgb_1936")&&(e.datumCode="osgb36"),~e.datumCode.indexOf("osni_1952")&&(e.datumCode="osni52"),(~e.datumCode.indexOf("tm65")||~e.datumCode.indexOf("geodetic_datum_of_1965"))&&(e.datumCode="ire65"),"ch1903+"===e.datumCode&&(e.datumCode="ch1903"),~e.datumCode.indexOf("israel")&&(e.datumCode="isr93")),e.b&&!isFinite(e.b)&&(e.b=e.a),[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_2","Standard_Parallel_2"],["false_easting","False_Easting"],["false_northing","False_Northing"],["central_meridian","Central_Meridian"],["latitude_of_origin","Latitude_Of_Origin"],["latitude_of_origin","Central_Parallel"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_Of_Center"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",a],["longitude_of_center","Longitude_Of_Center"],["longitude_of_center","Longitude_of_center"],["longc","longitude_of_center",a],["x0","false_easting",t],["y0","false_northing",t],["long0","central_meridian",a],["lat0","latitude_of_origin",a],["lat0","standard_parallel_1",a],["lat1","standard_parallel_1",a],["lat2","standard_parallel_2",a],["azimuth","Azimuth"],["alpha","azimuth",a],["srsCode","name"]].forEach((function(t){return s(e,t)})),e.long0||!e.longc||"Albers_Conic_Equal_Area"!==e.projName&&"Lambert_Azimuthal_Equal_Area"!==e.projName||(e.long0=e.longc),e.lat_ts||!e.lat1||"Stereographic_South_Pole"!==e.projName&&"Polar Stereographic (variant B)"!==e.projName||(e.lat0=a(e.lat1>0?90:-90),e.lat_ts=e.lat1)}function h(e){var t=this;if(2===arguments.length){var i=arguments[1];"string"==typeof i?"+"===i.charAt(0)?h[e]=Ce(arguments[1]):h[e]=Me(arguments[1]):h[e]=i}else if(1===arguments.length){if(Array.isArray(e))return e.map((function(e){Array.isArray(e)?h.apply(t,e):h(e)}));if("string"==typeof e){if(e in h)return h[e]}else"EPSG"in e?h["EPSG:"+e.EPSG]=e:"ESRI"in e?h["ESRI:"+e.ESRI]=e:"IAU2000"in e?h["IAU2000:"+e.IAU2000]=e:r.log(e);return}}function c(e){return"string"==typeof e}function u(e){return e in h}function p(e){return Ee.some((function(t){return e.indexOf(t)>-1}))}function d(t){var i=e(t,"authority");if(i){var r=e(i,"epsg");return r&&Te.indexOf(r)>-1}}function m(t){var i=e(t,"extension");if(i)return e(i,"proj4")}function f(e){return"+"===e[0]}function g(e){if(!c(e))return e;if(u(e))return h[e];if(p(e)){var t=Me(e);if(d(t))return h["EPSG:3857"];var i=m(t);return i?Ce(i):t}return f(e)?Ce(e):void 0}function A(e){return e}function y(e,t){var i=Qe.length;return e.names?(Qe[i]=e,e.names.forEach((function(e){Ne[e.toLowerCase()]=i})),this):(r.log(t),!0)}function v(e,t,i,r){var n=e*e,o=t*t,s=(n-o)/n,a=0;return r?(n=(e*=1-s*(le+s*(he+s*ce)))*e,s=0):a=Math.sqrt(s),{es:s,e:a,ep2:(n-o)/o}}function C(t,i,r,n,o){if(!t){var s=e(Ue,n);s||(s=je),t=s.a,i=s.b,r=s.rf}return r&&!i&&(i=(1-1/r)*t),(0===r||Math.abs(t-i)<ue)&&(o=!0,i=t),{a:t,b:i,rf:r,sphere:o}}function _(e,t,i,r,n,o){var s={};return s.datum_type=void 0===e||"none"===e?oe:ne,t&&(s.datum_params=t.map(parseFloat),0===s.datum_params[0]&&0===s.datum_params[1]&&0===s.datum_params[2]||(s.datum_type=ie),s.datum_params.length>3&&(0===s.datum_params[3]&&0===s.datum_params[4]&&0===s.datum_params[5]&&0===s.datum_params[6]||(s.datum_type=re,s.datum_params[3]*=se,s.datum_params[4]*=se,s.datum_params[5]*=se,s.datum_params[6]=s.datum_params[6]/1e6+1))),s.a=i,s.b=r,s.es=n,s.ep2=o,s}function b(t,i){if(!(this instanceof b))return new b(t);i=i||function(e){if(e)throw e};var r=g(t);if("object"==typeof r){var n=b.projections.get(r.projName);if(n){if(r.datumCode&&"none"!==r.datumCode){var o=e(Ge,r.datumCode);o&&(r.datum_params=o.towgs84?o.towgs84.split(","):null,r.ellps=o.ellipse,r.datumName=o.datumName?o.datumName:r.datumCode)}r.k0=r.k0||1,r.axis=r.axis||"enu",r.ellps=r.ellps||"wgs84";var s=C(r.a,r.b,r.rf,r.ellps,r.sphere),a=v(s.a,s.b,s.rf,r.R_A),l=r.datum||_(r.datumCode,r.datum_params,s.a,s.b,a.es,a.ep2);Oe(this,r),Oe(this,n),this.a=s.a,this.b=s.b,this.rf=s.rf,this.sphere=s.sphere,this.es=a.es,this.e=a.e,this.ep2=a.ep2,this.datum=l,this.init(),i(null,this)}else i(t)}else i(t)}function w(e,t){return e.datum_type===t.datum_type&&!(e.a!==t.a||Math.abs(e.es-t.es)>5e-11)&&(e.datum_type===ie?e.datum_params[0]===t.datum_params[0]&&e.datum_params[1]===t.datum_params[1]&&e.datum_params[2]===t.datum_params[2]:e.datum_type!==re||e.datum_params[0]===t.datum_params[0]&&e.datum_params[1]===t.datum_params[1]&&e.datum_params[2]===t.datum_params[2]&&e.datum_params[3]===t.datum_params[3]&&e.datum_params[4]===t.datum_params[4]&&e.datum_params[5]===t.datum_params[5]&&e.datum_params[6]===t.datum_params[6])}function P(e,t,i){var r,n,o,s,a=e.x,l=e.y,h=e.z?e.z:0;if(l<-ae&&l>-1.001*ae)l=-ae;else if(l>ae&&l<1.001*ae)l=ae;else{if(l<-ae)return{x:-1/0,y:-1/0,z:e.z};if(l>ae)return{x:1/0,y:1/0,z:e.z}}return a>Math.PI&&(a-=2*Math.PI),n=Math.sin(l),s=Math.cos(l),o=n*n,{x:((r=i/Math.sqrt(1-t*o))+h)*s*Math.cos(a),y:(r+h)*s*Math.sin(a),z:(r*(1-t)+h)*n}}function S(e,t,i,r){var n,o,s,a,l,h,c,u,p,d,m,f,g,A,y,v=e.x,C=e.y,_=e.z?e.z:0;if(n=Math.sqrt(v*v+C*C),o=Math.sqrt(v*v+C*C+_*_),n/i<1e-12){if(A=0,o/i<1e-12)return y=-r,{x:e.x,y:e.y,z:e.z}}else A=Math.atan2(C,v);s=_/o,u=(a=n/o)*(1-t)*(l=1/Math.sqrt(1-t*(2-t)*a*a)),p=s*l,g=0;do{g++,h=t*(c=i/Math.sqrt(1-t*p*p))/(c+(y=n*u+_*p-c*(1-t*p*p))),f=(m=s*(l=1/Math.sqrt(1-h*(2-h)*a*a)))*u-(d=a*(1-h)*l)*p,u=d,p=m}while(f*f>1e-24&&g<30);return{x:A,y:Math.atan(m/Math.abs(d)),z:y}}function x(e,t,i){if(t===ie)return{x:e.x+i[0],y:e.y+i[1],z:e.z+i[2]};if(t===re){var r=i[0],n=i[1],o=i[2],s=i[3],a=i[4],l=i[5],h=i[6];return{x:h*(e.x-l*e.y+a*e.z)+r,y:h*(l*e.x+e.y-s*e.z)+n,z:h*(-a*e.x+s*e.y+e.z)+o}}}function B(e,t,i){if(t===ie)return{x:e.x-i[0],y:e.y-i[1],z:e.z-i[2]};if(t===re){var r=i[0],n=i[1],o=i[2],s=i[3],a=i[4],l=i[5],h=i[6],c=(e.x-r)/h,u=(e.y-n)/h,p=(e.z-o)/h;return{x:c+l*u-a*p,y:-l*c+u+s*p,z:a*c-s*u+p}}}function M(e){return e===ie||e===re}function E(e){if("function"==typeof Number.isFinite){if(Number.isFinite(e))return;throw new TypeError("coordinates must be finite numbers")}if("number"!=typeof e||e!=e||!isFinite(e))throw new TypeError("coordinates must be finite numbers")}function T(e,t){return(e.datum.datum_type===ie||e.datum.datum_type===re)&&"WGS84"!==t.datumCode||(t.datum.datum_type===ie||t.datum.datum_type===re)&&"WGS84"!==e.datumCode}function O(e,t,i){var r;return Array.isArray(i)&&(i=Ze(i)),We(i),e.datum&&t.datum&&T(e,t)&&(i=O(e,r=new b("WGS84"),i),e=r),"enu"!==e.axis&&(i=Ye(e,!1,i)),"longlat"===e.projName?i={x:i.x*pe,y:i.y*pe,z:i.z||0}:(e.to_meter&&(i={x:i.x*e.to_meter,y:i.y*e.to_meter,z:i.z||0}),i=e.inverse(i)),e.from_greenwich&&(i.x+=e.from_greenwich),i=ze(e.datum,t.datum,i),t.from_greenwich&&(i={x:i.x-t.from_greenwich,y:i.y,z:i.z||0}),"longlat"===t.projName?i={x:i.x*de,y:i.y*de,z:i.z||0}:(i=t.forward(i),t.to_meter&&(i={x:i.x/t.to_meter,y:i.y/t.to_meter,z:i.z||0})),"enu"!==t.axis?Ye(t,!0,i):i}function L(e,t,i){var r,n,o;return Array.isArray(i)?(r=O(e,t,i)||{x:NaN,y:NaN},i.length>2?void 0!==e.name&&"geocent"===e.name||void 0!==t.name&&"geocent"===t.name?"number"==typeof r.z?[r.x,r.y,r.z].concat(i.splice(3)):[r.x,r.y,i[2]].concat(i.splice(3)):[r.x,r.y].concat(i.splice(2)):[r.x,r.y]):(n=O(e,t,i),2===(o=Object.keys(i)).length||o.forEach((function(r){if(void 0!==e.name&&"geocent"===e.name||void 0!==t.name&&"geocent"===t.name){if("x"===r||"y"===r||"z"===r)return}else if("x"===r||"y"===r)return;n[r]=i[r]})),n)}function D(e){return e instanceof b?e:e.oProj?e.oProj:b(e)}function I(e,t,i){e=D(e);var r,n=!1;return void 0===t?(t=e,e=Xe,n=!0):(void 0!==t.x||Array.isArray(t))&&(i=t,t=e,e=Xe,n=!0),t=D(t),i?L(e,t,i):(r={forward:function(i){return L(e,t,i)},inverse:function(i){return L(t,e,i)}},n&&(r.oProj=t),r)}function R(e,t){return t=t||5,j(Q({lat:e[1],lon:e[0]}),t)}function H(e){var t=k(Z(e.toUpperCase()));return t.lat&&t.lon?[t.lon,t.lat]:[(t.left+t.right)/2,(t.top+t.bottom)/2]}function F(e){return e*(Math.PI/180)}function N(e){return e/Math.PI*180}function Q(e){var t,i,r,n,o,s,a=e.lat,l=e.lon,h=6378137,c=F(a),u=F(l);s=Math.floor((l+180)/6)+1,180===l&&(s=60),a>=56&&a<64&&l>=3&&l<12&&(s=32),a>=72&&a<84&&(l>=0&&l<9?s=31:l>=9&&l<21?s=33:l>=21&&l<33?s=35:l>=33&&l<42&&(s=37)),o=F(6*(s-1)-180+3),t=h/Math.sqrt(1-.00669438*Math.sin(c)*Math.sin(c)),i=Math.tan(c)*Math.tan(c),r=.006739496752268451*Math.cos(c)*Math.cos(c);var p=.9996*t*((n=Math.cos(c)*(u-o))+(1-i+r)*n*n*n/6+(5-18*i+i*i+72*r-.39089081163157013)*n*n*n*n*n/120)+5e5,d=.9996*(h*(.9983242984503243*c-.002514607064228144*Math.sin(2*c)+2639046602129982e-21*Math.sin(4*c)-3.418046101696858e-9*Math.sin(6*c))+t*Math.tan(c)*(n*n/2+(5-i+9*r+4*r*r)*n*n*n*n/24+(61-58*i+i*i+600*r-2.2240339282485886)*n*n*n*n*n*n/720));return a<0&&(d+=1e7),{northing:Math.round(d),easting:Math.round(p),zoneNumber:s,zoneLetter:U(a)}}function k(e){var t=e.northing,i=e.easting,r=e.zoneLetter,n=e.zoneNumber;if(n<0||n>60)return null;var o,s,a,l,h,c,u,p,d=6378137,m=(1-Math.sqrt(.99330562))/(1+Math.sqrt(.99330562)),f=i-5e5,g=t;r<"N"&&(g-=1e7),c=6*(n-1)-180+3,p=(u=g/.9996/6367449.145945056)+(3*m/2-27*m*m*m/32)*Math.sin(2*u)+(21*m*m/16-55*m*m*m*m/32)*Math.sin(4*u)+151*m*m*m/96*Math.sin(6*u),o=d/Math.sqrt(1-.00669438*Math.sin(p)*Math.sin(p)),s=Math.tan(p)*Math.tan(p),a=.006739496752268451*Math.cos(p)*Math.cos(p),l=.99330562*d/Math.pow(1-.00669438*Math.sin(p)*Math.sin(p),1.5),h=f/(.9996*o);var A=p-o*Math.tan(p)/l*(h*h/2-(5+3*s+10*a-4*a*a-.06065547077041606)*h*h*h*h/24+(61+90*s+298*a+45*s*s-1.6983531815716497-3*a*a)*h*h*h*h*h*h/720);A=N(A);var y,v=(h-(1+2*s+a)*h*h*h/6+(5-2*a+28*s-3*a*a+.05391597401814761+24*s*s)*h*h*h*h*h/120)/Math.cos(p);if(v=c+N(v),e.accuracy){var C=k({northing:e.northing+e.accuracy,easting:e.easting+e.accuracy,zoneLetter:e.zoneLetter,zoneNumber:e.zoneNumber});y={top:C.lat,right:C.lon,bottom:A,left:v}}else y={lat:A,lon:v};return y}function U(e){var t="Z";return 84>=e&&e>=72?t="X":72>e&&e>=64?t="W":64>e&&e>=56?t="V":56>e&&e>=48?t="U":48>e&&e>=40?t="T":40>e&&e>=32?t="S":32>e&&e>=24?t="R":24>e&&e>=16?t="Q":16>e&&e>=8?t="P":8>e&&e>=0?t="N":0>e&&e>=-8?t="M":-8>e&&e>=-16?t="L":-16>e&&e>=-24?t="K":-24>e&&e>=-32?t="J":-32>e&&e>=-40?t="H":-40>e&&e>=-48?t="G":-48>e&&e>=-56?t="F":-56>e&&e>=-64?t="E":-64>e&&e>=-72?t="D":-72>e&&e>=-80&&(t="C"),t}function j(e,t){var i="00000"+e.easting,r="00000"+e.northing;return e.zoneNumber+e.zoneLetter+G(e.easting,e.northing,e.zoneNumber)+i.substr(i.length-5,t)+r.substr(r.length-5,t)}function G(e,t,i){var r=z(i);return Y(Math.floor(e/1e5),Math.floor(t/1e5)%20,r)}function z(e){var t=e%Je;return 0===t&&(t=Je),t}function Y(e,t,i){var r=i-1,n=Ke.charCodeAt(r),o=Ve.charCodeAt(r),s=n+e-1,a=o+t,l=!1;return s>it&&(s=s-it+qe-1,l=!0),(s===$e||n<$e&&s>$e||(s>$e||n<$e)&&l)&&s++,(s===et||n<et&&s>et||(s>et||n<et)&&l)&&++s===$e&&s++,s>it&&(s=s-it+qe-1),a>tt?(a=a-tt+qe-1,l=!0):l=!1,(a===$e||o<$e&&a>$e||(a>$e||o<$e)&&l)&&a++,(a===et||o<et&&a>et||(a>et||o<et)&&l)&&++a===$e&&a++,a>tt&&(a=a-tt+qe-1),String.fromCharCode(s)+String.fromCharCode(a)}function Z(e){if(e&&0===e.length)throw"MGRSPoint coverting from nothing";for(var t,i=e.length,r=null,n="",o=0;!/[A-Z]/.test(t=e.charAt(o));){if(o>=2)throw"MGRSPoint bad conversion from: "+e;n+=t,o++}var s=parseInt(n,10);if(0===o||o+3>i)throw"MGRSPoint bad conversion from: "+e;var a=e.charAt(o++);if(a<="A"||"B"===a||"Y"===a||a>="Z"||"I"===a||"O"===a)throw"MGRSPoint zone letter "+a+" not handled: "+e;r=e.substring(o,o+=2);for(var l=z(s),h=W(r.charAt(0),l),c=X(r.charAt(1),l);c<J(a);)c+=2e6;var u=i-o;if(u%2!=0)throw"MGRSPoint has to have an even number \nof digits after the zone letter and two 100km letters - front \nhalf for easting meters, second half for \nnorthing meters"+e;var p,d,m,f=u/2,g=0,A=0;return f>0&&(p=1e5/Math.pow(10,f),d=e.substring(o,o+f),g=parseFloat(d)*p,m=e.substring(o+f),A=parseFloat(m)*p),{easting:g+h,northing:A+c,zoneLetter:a,zoneNumber:s,accuracy:p}}function W(e,t){for(var i=Ke.charCodeAt(t-1),r=1e5,n=!1;i!==e.charCodeAt(0);){if(++i===$e&&i++,i===et&&i++,i>it){if(n)throw"Bad character: "+e;i=qe,n=!0}r+=1e5}return r}function X(e,t){if(e>"V")throw"MGRSPoint given invalid Northing "+e;for(var i=Ve.charCodeAt(t-1),r=0,n=!1;i!==e.charCodeAt(0);){if(++i===$e&&i++,i===et&&i++,i>tt){if(n)throw"Bad character: "+e;i=qe,n=!0}r+=1e5}return r}function J(e){var t;switch(e){case"C":t=11e5;break;case"D":t=2e6;break;case"E":t=28e5;break;case"F":t=37e5;break;case"G":t=46e5;break;case"H":t=55e5;break;case"J":t=64e5;break;case"K":t=73e5;break;case"L":t=82e5;break;case"M":t=91e5;break;case"N":t=0;break;case"P":t=8e5;break;case"Q":t=17e5;break;case"R":t=26e5;break;case"S":t=35e5;break;case"T":t=44e5;break;case"U":t=53e5;break;case"V":t=62e5;break;case"W":t=7e6;break;case"X":t=79e5;break;default:t=-1}if(t>=0)return t;throw"Invalid zone letter: "+e}function K(e,t,i){if(!(this instanceof K))return new K(e,t,i);if(Array.isArray(e))this.x=e[0],this.y=e[1],this.z=e[2]||0;else if("object"==typeof e)this.x=e.x,this.y=e.y,this.z=e.z||0;else if("string"==typeof e&&void 0===t){var n=e.split(",");this.x=parseFloat(n[0],10),this.y=parseFloat(n[1],10),this.z=parseFloat(n[2],10)||0}else this.x=e,this.y=t,this.z=i||0;r.warn("proj4.Point will be removed in version 3, use proj4.toPoint")}function V(e){var t,i=[];return i[0]=e*kt,t=e*e,i[0]+=t*Ut,i[1]=t*Gt,t*=e,i[0]+=t*jt,i[1]+=t*zt,i[2]=t*Yt,i}function q(e,t){var i=e+e;return e+t[0]*Math.sin(i)+t[1]*Math.sin(i+i)+t[2]*Math.sin(i+i+i)}function $(e,t,i,r){var n;return e<ue?(r.value=ui.AREA_0,n=0):(n=Math.atan2(t,i),Math.abs(n)<=me?r.value=ui.AREA_0:n>me&&n<=ae+me?(r.value=ui.AREA_1,n-=ae):n>ae+me||n<=-(ae+me)?(r.value=ui.AREA_2,n=n>=0?n-ge:n+ge):(r.value=ui.AREA_3,n+=ae)),n}function ee(e,t){var i=e+t;return i<-ge?i+=fe:i>+ge&&(i-=fe),i}function te(e,t,i,r){for(var n=t;r;--r){var o=e(n);if(n-=o,Math.abs(o)<i)break}return n}var ie=1,re=2,ne=4,oe=5,se=484813681109536e-20,ae=Math.PI/2,le=.16666666666666666,he=.04722222222222222,ce=.022156084656084655,ue=1e-10,pe=.017453292519943295,de=57.29577951308232,me=Math.PI/4,fe=2*Math.PI,ge=3.14159265359,Ae={greenwich:0,lisbon:-9.131906111111,paris:2.337229166667,bogota:-74.080916666667,madrid:-3.687938888889,rome:12.452333333333,bern:7.439583333333,jakarta:106.807719444444,ferro:-17.666666666667,brussels:4.367975,stockholm:18.058277777778,athens:23.7163375,oslo:10.722916666667},ye={ft:{to_meter:.3048},"us-ft":{to_meter:1200/3937}},ve=/[\s_\-\/\(\)]/g,Ce=function(t){var i,r,n,o={},s=t.split("+").map((function(e){return e.trim()})).filter((function(e){return e})).reduce((function(e,t){var i=t.split("=");return i.push(!0),e[i[0].toLowerCase()]=i[1],e}),{}),a={proj:"projName",datum:"datumCode",rf:function(e){o.rf=parseFloat(e)},lat_0:function(e){o.lat0=e*pe},lat_1:function(e){o.lat1=e*pe},lat_2:function(e){o.lat2=e*pe},lat_ts:function(e){o.lat_ts=e*pe},lon_0:function(e){o.long0=e*pe},lon_1:function(e){o.long1=e*pe},lon_2:function(e){o.long2=e*pe},alpha:function(e){o.alpha=parseFloat(e)*pe},lonc:function(e){o.longc=e*pe},x_0:function(e){o.x0=parseFloat(e)},y_0:function(e){o.y0=parseFloat(e)},k_0:function(e){o.k0=parseFloat(e)},k:function(e){o.k0=parseFloat(e)},a:function(e){o.a=parseFloat(e)},b:function(e){o.b=parseFloat(e)},r_a:function(){o.R_A=!0},zone:function(e){o.zone=parseInt(e,10)},south:function(){o.utmSouth=!0},towgs84:function(e){o.datum_params=e.split(",").map((function(e){return parseFloat(e)}))},to_meter:function(e){o.to_meter=parseFloat(e)},units:function(t){o.units=t;var i=e(ye,t);i&&(o.to_meter=i.to_meter)},from_greenwich:function(e){o.from_greenwich=e*pe},pm:function(t){var i=e(Ae,t);o.from_greenwich=(i||parseFloat(t))*pe},nadgrids:function(e){"@null"===e?o.datumCode="none":o.nadgrids=e},axis:function(e){3===e.length&&-1!=="ewnsud".indexOf(e.substr(0,1))&&-1!=="ewnsud".indexOf(e.substr(1,1))&&-1!=="ewnsud".indexOf(e.substr(2,1))&&(o.axis=e)}};for(i in s)r=s[i],i in a?"function"==typeof(n=a[i])?n(r):o[n]=r:o[i]=r;return"string"==typeof o.datumCode&&"WGS84"!==o.datumCode&&(o.datumCode=o.datumCode.toLowerCase()),o},_e=1,be=/\s/,we=/[A-Za-z]/,Pe=/[A-Za-z84]/,Se=/[,\]]/,xe=/[\d\.E\-\+]/;t.prototype.readCharicter=function(){var e=this.text[this.place++];if(4!==this.state)for(;be.test(e);){if(this.place>=this.text.length)return;e=this.text[this.place++]}switch(this.state){case _e:return this.neutral(e);case 2:return this.keyword(e);case 4:return this.quoted(e);case 5:return this.afterquote(e);case 3:return this.number(e);case-1:return}},t.prototype.afterquote=function(e){if('"'===e)return this.word+='"',void(this.state=4);if(Se.test(e))return this.word=this.word.trim(),void this.afterItem(e);throw new Error("havn't handled \""+e+'" in afterquote yet, index '+this.place)},t.prototype.afterItem=function(e){return","===e?(null!==this.word&&this.currentObject.push(this.word),this.word=null,void(this.state=_e)):"]"===e?(this.level--,null!==this.word&&(this.currentObject.push(this.word),this.word=null),this.state=_e,this.currentObject=this.stack.pop(),void(this.currentObject||(this.state=-1))):void 0},t.prototype.number=function(e){if(!xe.test(e)){if(Se.test(e))return this.word=parseFloat(this.word),void this.afterItem(e);throw new Error("havn't handled \""+e+'" in number yet, index '+this.place)}this.word+=e},t.prototype.quoted=function(e){'"'!==e?this.word+=e:this.state=5},t.prototype.keyword=function(e){if(Pe.test(e))this.word+=e;else{if("["===e){var t=[];return t.push(this.word),this.level++,null===this.root?this.root=t:this.currentObject.push(t),this.stack.push(this.currentObject),this.currentObject=t,void(this.state=_e)}if(!Se.test(e))throw new Error("havn't handled \""+e+'" in keyword yet, index '+this.place);this.afterItem(e)}},t.prototype.neutral=function(e){if(we.test(e))return this.word=e,void(this.state=2);if('"'===e)return this.word="",void(this.state=4);if(xe.test(e))return this.word=e,void(this.state=3);if(!Se.test(e))throw new Error("havn't handled \""+e+'" in neutral yet, index '+this.place);this.afterItem(e)},t.prototype.output=function(){for(;this.place<this.text.length;)this.readCharicter();if(-1===this.state)return this.root;throw new Error('unable to parse string "'+this.text+'". State is '+this.state)};var Be=.017453292519943295,Me=function(e){var t=i(e),r=t.shift(),n=t.shift();t.unshift(["name",n]),t.unshift(["type",r]);var s={};return o(t,s),l(s),s};!function(e){e("EPSG:4326","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),e("EPSG:4269","+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees"),e("EPSG:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs"),e.WGS84=e["EPSG:4326"],e["EPSG:3785"]=e["EPSG:3857"],e.GOOGLE=e["EPSG:3857"],e["EPSG:900913"]=e["EPSG:3857"],e["EPSG:102113"]=e["EPSG:3857"]}(h);var Ee=["PROJECTEDCRS","PROJCRS","GEOGCS","GEOCCS","PROJCS","LOCAL_CS","GEODCRS","GEODETICCRS","GEODETICDATUM","ENGCRS","ENGINEERINGCRS"],Te=["3857","900913","3785","102113"],Oe=function(e,t){var i,r;if(e=e||{},!t)return e;for(r in t)void 0!==(i=t[r])&&(e[r]=i);return e},Le=function(e,t,i){var r=e*t;return i/Math.sqrt(1-r*r)},De=function(e){return e<0?-1:1},Ie=function(e){return Math.abs(e)<=ge?e:e-De(e)*fe},Re=function(e,t,i){var r=e*i,n=.5*e;return r=Math.pow((1-r)/(1+r),n),Math.tan(.5*(ae-t))/r},He=function(e,t){for(var i,r,n=.5*e,o=ae-2*Math.atan(t),s=0;s<=15;s++)if(i=e*Math.sin(o),o+=r=ae-2*Math.atan(t*Math.pow((1-i)/(1+i),n))-o,Math.abs(r)<=1e-10)return o;return-9999},Fe=[{init:function(){var e=this.b/this.a;this.es=1-e*e,"x0"in this||(this.x0=0),"y0"in this||(this.y0=0),this.e=Math.sqrt(this.es),this.lat_ts?this.sphere?this.k0=Math.cos(this.lat_ts):this.k0=Le(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k?this.k0=this.k:this.k0=1)},forward:function(e){var t,i,r=e.x,n=e.y;if(n*de>90&&n*de<-90&&r*de>180&&r*de<-180)return null;if(Math.abs(Math.abs(n)-ae)<=ue)return null;if(this.sphere)t=this.x0+this.a*this.k0*Ie(r-this.long0),i=this.y0+this.a*this.k0*Math.log(Math.tan(me+.5*n));else{var o=Math.sin(n),s=Re(this.e,n,o);t=this.x0+this.a*this.k0*Ie(r-this.long0),i=this.y0-this.a*this.k0*Math.log(s)}return e.x=t,e.y=i,e},inverse:function(e){var t,i,r=e.x-this.x0,n=e.y-this.y0;if(this.sphere)i=ae-2*Math.atan(Math.exp(-n/(this.a*this.k0)));else{var o=Math.exp(-n/(this.a*this.k0));if(-9999===(i=He(this.e,o)))return null}return t=Ie(this.long0+r/(this.a*this.k0)),e.x=t,e.y=i,e},names:["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","merc"]},{init:function(){},forward:A,inverse:A,names:["longlat","identity"]}],Ne={},Qe=[],ke={start:function(){Fe.forEach(y)},add:y,get:function(e){if(!e)return!1;var t=e.toLowerCase();return void 0!==Ne[t]&&Qe[Ne[t]]?Qe[Ne[t]]:void 0}},Ue={MERIT:{a:6378137,rf:298.257,ellipseName:"MERIT 1983"},SGS85:{a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"},GRS80:{a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"},IAU76:{a:6378140,rf:298.257,ellipseName:"IAU 1976"},airy:{a:6377563.396,b:6356256.91,ellipseName:"Airy 1830"},APL4:{a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"},NWL9D:{a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"},mod_airy:{a:6377340.189,b:6356034.446,ellipseName:"Modified Airy"},andrae:{a:6377104.43,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"},aust_SA:{a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"},GRS67:{a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"},bessel:{a:6377397.155,rf:299.1528128,ellipseName:"Bessel 1841"},bess_nam:{a:6377483.865,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"},clrk66:{a:6378206.4,b:6356583.8,ellipseName:"Clarke 1866"},clrk80:{a:6378249.145,rf:293.4663,ellipseName:"Clarke 1880 mod."},clrk58:{a:6378293.645208759,rf:294.2606763692654,ellipseName:"Clarke 1858"},CPM:{a:6375738.7,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"},delmbr:{a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"},engelis:{a:6378136.05,rf:298.2566,ellipseName:"Engelis 1985"},evrst30:{a:6377276.345,rf:300.8017,ellipseName:"Everest 1830"},evrst48:{a:6377304.063,rf:300.8017,ellipseName:"Everest 1948"},evrst56:{a:6377301.243,rf:300.8017,ellipseName:"Everest 1956"},evrst69:{a:6377295.664,rf:300.8017,ellipseName:"Everest 1969"},evrstSS:{a:6377298.556,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"},fschr60:{a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"},fschr60m:{a:6378155,rf:298.3,ellipseName:"Fischer 1960"},fschr68:{a:6378150,rf:298.3,ellipseName:"Fischer 1968"},helmert:{a:6378200,rf:298.3,ellipseName:"Helmert 1906"},hough:{a:6378270,rf:297,ellipseName:"Hough"},intl:{a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"},kaula:{a:6378163,rf:298.24,ellipseName:"Kaula 1961"},lerch:{a:6378139,rf:298.257,ellipseName:"Lerch 1979"},mprts:{a:6397300,rf:191,ellipseName:"Maupertius 1738"},new_intl:{a:6378157.5,b:6356772.2,ellipseName:"New International 1967"},plessis:{a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"},krass:{a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"},SEasia:{a:6378155,b:6356773.3205,ellipseName:"Southeast Asia"},walbeck:{a:6376896,b:6355834.8467,ellipseName:"Walbeck"},WGS60:{a:6378165,rf:298.3,ellipseName:"WGS 60"},WGS66:{a:6378145,rf:298.25,ellipseName:"WGS 66"},WGS7:{a:6378135,rf:298.26,ellipseName:"WGS 72"}},je=Ue.WGS84={a:6378137,rf:298.257223563,ellipseName:"WGS 84"};Ue.sphere={a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"};var Ge={wgs84:{towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"},ch1903:{towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"},ggrs87:{towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"},nad83:{towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"},nad27:{nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"},potsdam:{towgs84:"606.0,23.0,413.0",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"},carthage:{towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"},hermannskogel:{towgs84:"653.0,-212.0,449.0",ellipse:"bessel",datumName:"Hermannskogel"},osni52:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"airy",datumName:"Irish National"},ire65:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"},rassadiran:{towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"},nzgd49:{towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"},osgb36:{towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Airy 1830"},s_jtsk:{towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"},beduaram:{towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"},gunung_segara:{towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"},rnb72:{towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"}};b.projections=ke,b.projections.start();var ze=function(e,t,i){return w(e,t)||e.datum_type===oe||t.datum_type===oe?i:e.es!==t.es||e.a!==t.a||M(e.datum_type)||M(t.datum_type)?(i=P(i,e.es,e.a),M(e.datum_type)&&(i=x(i,e.datum_type,e.datum_params)),M(t.datum_type)&&(i=B(i,t.datum_type,t.datum_params)),S(i,t.es,t.a,t.b)):i},Ye=function(e,t,i){var r,n,o,s=i.x,a=i.y,l=i.z||0,h={};for(o=0;o<3;o++)if(!t||2!==o||void 0!==i.z)switch(0===o?(r=s,n="x"):1===o?(r=a,n="y"):(r=l,n="z"),e.axis[o]){case"e":case"n":h[n]=r;break;case"w":case"s":h[n]=-r;break;case"u":void 0!==i[n]&&(h.z=r);break;case"d":void 0!==i[n]&&(h.z=-r);break;default:return null}return h},Ze=function(e){var t={x:e[0],y:e[1]};return e.length>2&&(t.z=e[2]),e.length>3&&(t.m=e[3]),t},We=function(e){E(e.x),E(e.y)},Xe=b("WGS84"),Je=6,Ke="AJSAJS",Ve="AFAFAF",qe=65,$e=73,et=79,tt=86,it=90,rt={forward:R,inverse:function(e){var t=k(Z(e.toUpperCase()));return t.lat&&t.lon?[t.lon,t.lat,t.lon,t.lat]:[t.left,t.bottom,t.right,t.top]},toPoint:H};K.fromMGRS=function(e){return new K(H(e))},K.prototype.toMGRS=function(e){return R([this.x,this.y],e)};var nt,ot=.01068115234375,st=function(e){var t=[];t[0]=1-e*(.25+e*(.046875+e*(.01953125+e*ot))),t[1]=e*(.75-e*(.046875+e*(.01953125+e*ot)));var i=e*e;return t[2]=i*(.46875-e*(.013020833333333334+.007120768229166667*e)),i*=e,t[3]=i*(.3645833333333333-.005696614583333333*e),t[4]=i*e*.3076171875,t},at=function(e,t,i,r){return i*=t,t*=t,r[0]*e-i*(r[1]+t*(r[2]+t*(r[3]+t*r[4])))},lt=function(e,t,i){for(var r=1/(1-t),n=e,o=20;o;--o){var s=Math.sin(n),a=1-t*s*s;if(n-=a=(at(n,s,Math.cos(n),i)-e)*(a*Math.sqrt(a))*r,Math.abs(a)<ue)return n}return n},ht={init:function(){this.x0=void 0!==this.x0?this.x0:0,this.y0=void 0!==this.y0?this.y0:0,this.long0=void 0!==this.long0?this.long0:0,this.lat0=void 0!==this.lat0?this.lat0:0,this.es&&(this.en=st(this.es),this.ml0=at(this.lat0,Math.sin(this.lat0),Math.cos(this.lat0),this.en))},forward:function(e){var t,i,r,n=e.x,o=e.y,s=Ie(n-this.long0),a=Math.sin(o),l=Math.cos(o);if(this.es){var h=l*s,c=Math.pow(h,2),u=this.ep2*Math.pow(l,2),p=Math.pow(u,2),d=Math.abs(l)>ue?Math.tan(o):0,m=Math.pow(d,2),f=Math.pow(m,2);t=1-this.es*Math.pow(a,2),h/=Math.sqrt(t);var g=at(o,a,l,this.en);i=this.a*(this.k0*h*(1+c/6*(1-m+u+c/20*(5-18*m+f+14*u-58*m*u+c/42*(61+179*f-f*m-479*m)))))+this.x0,r=this.a*(this.k0*(g-this.ml0+a*s*h/2*(1+c/12*(5-m+9*u+4*p+c/30*(61+f-58*m+270*u-330*m*u+c/56*(1385+543*f-f*m-3111*m))))))+this.y0}else{var A=l*Math.sin(s);if(Math.abs(Math.abs(A)-1)<ue)return 93;if(i=.5*this.a*this.k0*Math.log((1+A)/(1-A))+this.x0,r=l*Math.cos(s)/Math.sqrt(1-Math.pow(A,2)),(A=Math.abs(r))>=1){if(A-1>ue)return 93;r=0}else r=Math.acos(r);o<0&&(r=-r),r=this.a*this.k0*(r-this.lat0)+this.y0}return e.x=i,e.y=r,e},inverse:function(e){var t,i,r,n,o=(e.x-this.x0)*(1/this.a),s=(e.y-this.y0)*(1/this.a);if(this.es)if(t=this.ml0+s/this.k0,i=lt(t,this.es,this.en),Math.abs(i)<ae){var a=Math.sin(i),l=Math.cos(i),h=Math.abs(l)>ue?Math.tan(i):0,c=this.ep2*Math.pow(l,2),u=Math.pow(c,2),p=Math.pow(h,2),d=Math.pow(p,2);t=1-this.es*Math.pow(a,2);var m=o*Math.sqrt(t)/this.k0,f=Math.pow(m,2);r=i-(t*=h)*f/(1-this.es)*.5*(1-f/12*(5+3*p-9*c*p+c-4*u-f/30*(61+90*p-252*c*p+45*d+46*c-f/56*(1385+3633*p+4095*d+1574*d*p)))),n=Ie(this.long0+m*(1-f/6*(1+2*p+c-f/20*(5+28*p+24*d+8*c*p+6*c-f/42*(61+662*p+1320*d+720*d*p))))/l)}else r=ae*De(s),n=0;else{var g=Math.exp(o/this.k0),A=.5*(g-1/g),y=this.lat0+s/this.k0,v=Math.cos(y);t=Math.sqrt((1-Math.pow(v,2))/(1+Math.pow(A,2))),r=Math.asin(t),s<0&&(r=-r),n=0===A&&0===v?0:Ie(Math.atan2(A,v)+this.long0)}return e.x=n,e.y=r,e},names:["Transverse_Mercator","Transverse Mercator","tmerc"]},ct=function(e){var t=Math.exp(e);return(t-1/t)/2},ut=function(e,t){e=Math.abs(e),t=Math.abs(t);var i=Math.max(e,t),r=Math.min(e,t)/(i||1);return i*Math.sqrt(1+Math.pow(r,2))},pt=function(e){var t=1+e,i=t-1;return 0===i?e:e*Math.log(t)/i},dt=function(e){var t=Math.abs(e);return t=pt(t*(1+t/(ut(1,t)+1))),e<0?-t:t},mt=function(e,t){for(var i,r=2*Math.cos(2*t),n=e.length-1,o=e[n],s=0;--n>=0;)i=r*o-s+e[n],s=o,o=i;return t+i*Math.sin(2*t)},ft=function(e,t){for(var i,r=2*Math.cos(t),n=e.length-1,o=e[n],s=0;--n>=0;)i=r*o-s+e[n],s=o,o=i;return Math.sin(t)*i},gt=function(e){var t=Math.exp(e);return(t+1/t)/2},At=function(e,t,i){for(var r,n,o=Math.sin(t),s=Math.cos(t),a=ct(i),l=gt(i),h=2*s*l,c=-2*o*a,u=e.length-1,p=e[u],d=0,m=0,f=0;--u>=0;)r=m,n=d,p=h*(m=p)-r-c*(d=f)+e[u],f=c*m-n+h*d;return[(h=o*l)*p-(c=s*a)*f,h*f+c*p]},yt={init:function(){if(void 0===this.es||this.es<=0)throw new Error("incorrect elliptical usage");this.x0=void 0!==this.x0?this.x0:0,this.y0=void 0!==this.y0?this.y0:0,this.long0=void 0!==this.long0?this.long0:0,this.lat0=void 0!==this.lat0?this.lat0:0,this.cgb=[],this.cbg=[],this.utg=[],this.gtu=[];var e=this.es/(1+Math.sqrt(1-this.es)),t=e/(2-e),i=t;this.cgb[0]=t*(2+t*(-2/3+t*(t*(116/45+t*(26/45+t*(-2854/675)))-2))),this.cbg[0]=t*(t*(2/3+t*(4/3+t*(-82/45+t*(32/45+t*(4642/4725)))))-2),i*=t,this.cgb[1]=i*(7/3+t*(t*(-227/45+t*(2704/315+t*(2323/945)))-1.6)),this.cbg[1]=i*(5/3+t*(-16/15+t*(-13/9+t*(904/315+t*(-1522/945))))),i*=t,this.cgb[2]=i*(56/15+t*(-136/35+t*(-1262/105+t*(73814/2835)))),this.cbg[2]=i*(-26/15+t*(34/21+t*(1.6+t*(-12686/2835)))),i*=t,this.cgb[3]=i*(4279/630+t*(-332/35+t*(-399572/14175))),this.cbg[3]=i*(1237/630+t*(t*(-24832/14175)-2.4)),i*=t,this.cgb[4]=i*(4174/315+t*(-144838/6237)),this.cbg[4]=i*(-734/315+t*(109598/31185)),i*=t,this.cgb[5]=i*(601676/22275),this.cbg[5]=i*(444337/155925),i=Math.pow(t,2),this.Qn=this.k0/(1+t)*(1+i*(.25+i*(1/64+i/256))),this.utg[0]=t*(t*(2/3+t*(-37/96+t*(1/360+t*(81/512+t*(-96199/604800)))))-.5),this.gtu[0]=t*(.5+t*(-2/3+t*(5/16+t*(41/180+t*(-127/288+t*(7891/37800)))))),this.utg[1]=i*(-1/48+t*(-1/15+t*(437/1440+t*(-46/105+t*(1118711/3870720))))),this.gtu[1]=i*(13/48+t*(t*(557/1440+t*(281/630+t*(-1983433/1935360)))-.6)),i*=t,this.utg[2]=i*(-17/480+t*(37/840+t*(209/4480+t*(-5569/90720)))),this.gtu[2]=i*(61/240+t*(-103/140+t*(15061/26880+t*(167603/181440)))),i*=t,this.utg[3]=i*(-4397/161280+t*(11/504+t*(830251/7257600))),this.gtu[3]=i*(49561/161280+t*(-179/168+t*(6601661/7257600))),i*=t,this.utg[4]=i*(-4583/161280+t*(108847/3991680)),this.gtu[4]=i*(34729/80640+t*(-3418889/1995840)),i*=t,this.utg[5]=-.03233083094085698*i,this.gtu[5]=.6650675310896665*i;var r=mt(this.cbg,this.lat0);this.Zb=-this.Qn*(r+ft(this.gtu,2*r))},forward:function(e){var t=Ie(e.x-this.long0),i=e.y;i=mt(this.cbg,i);var r=Math.sin(i),n=Math.cos(i),o=Math.sin(t),s=Math.cos(t);i=Math.atan2(r,s*n),t=Math.atan2(o*n,ut(r,n*s)),t=dt(Math.tan(t));var a,l,h=At(this.gtu,2*i,2*t);return i+=h[0],t+=h[1],Math.abs(t)<=2.623395162778?(a=this.a*(this.Qn*t)+this.x0,l=this.a*(this.Qn*i+this.Zb)+this.y0):(a=1/0,l=1/0),e.x=a,e.y=l,e},inverse:function(e){var t,i,r=(e.x-this.x0)*(1/this.a),n=(e.y-this.y0)*(1/this.a);if(n=(n-this.Zb)/this.Qn,r/=this.Qn,Math.abs(r)<=2.623395162778){var o=At(this.utg,2*n,2*r);n+=o[0],r+=o[1],r=Math.atan(ct(r));var s=Math.sin(n),a=Math.cos(n),l=Math.sin(r),h=Math.cos(r);n=Math.atan2(s*h,ut(l,h*a)),r=Math.atan2(l,h*a),t=Ie(r+this.long0),i=mt(this.cgb,n)}else t=1/0,i=1/0;return e.x=t,e.y=i,e},names:["Extended_Transverse_Mercator","Extended Transverse Mercator","etmerc"]},vt=function(e,t){if(void 0===e){if((e=Math.floor(30*(Ie(t)+Math.PI)/Math.PI)+1)<0)return 0;if(e>60)return 60}return e},Ct={init:function(){var e=vt(this.zone,this.long0);if(void 0===e)throw new Error("unknown utm zone");this.lat0=0,this.long0=(6*Math.abs(e)-183)*pe,this.x0=5e5,this.y0=this.utmSouth?1e7:0,this.k0=.9996,yt.init.apply(this),this.forward=yt.forward,this.inverse=yt.inverse},names:["Universal Transverse Mercator System","utm"],dependsOn:"etmerc"},_t=function(e,t){return Math.pow((1-e)/(1+e),t)},bt=20,wt={init:function(){var e=Math.sin(this.lat0),t=Math.cos(this.lat0);t*=t,this.rc=Math.sqrt(1-this.es)/(1-this.es*e*e),this.C=Math.sqrt(1+this.es*t*t/(1-this.es)),this.phic0=Math.asin(e/this.C),this.ratexp=.5*this.C*this.e,this.K=Math.tan(.5*this.phic0+me)/(Math.pow(Math.tan(.5*this.lat0+me),this.C)*_t(this.e*e,this.ratexp))},forward:function(e){var t=e.x,i=e.y;return e.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*i+me),this.C)*_t(this.e*Math.sin(i),this.ratexp))-ae,e.x=this.C*t,e},inverse:function(e){for(var t=e.x/this.C,i=e.y,r=Math.pow(Math.tan(.5*i+me)/this.K,1/this.C),n=bt;n>0&&(i=2*Math.atan(r*_t(this.e*Math.sin(e.y),-.5*this.e))-ae,!(Math.abs(i-e.y)<1e-14));--n)e.y=i;return n?(e.x=t,e.y=i,e):null},names:["gauss"]},Pt={init:function(){wt.init.apply(this),this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))},forward:function(e){var t,i,r,n;return e.x=Ie(e.x-this.long0),wt.forward.apply(this,[e]),t=Math.sin(e.y),i=Math.cos(e.y),r=Math.cos(e.x),n=this.k0*this.R2/(1+this.sinc0*t+this.cosc0*i*r),e.x=n*i*Math.sin(e.x),e.y=n*(this.cosc0*t-this.sinc0*i*r),e.x=this.a*e.x+this.x0,e.y=this.a*e.y+this.y0,e},inverse:function(e){var t,i,r,n,o;if(e.x=(e.x-this.x0)/this.a,e.y=(e.y-this.y0)/this.a,e.x/=this.k0,e.y/=this.k0,o=Math.sqrt(e.x*e.x+e.y*e.y)){var s=2*Math.atan2(o,this.R2);t=Math.sin(s),i=Math.cos(s),n=Math.asin(i*this.sinc0+e.y*t*this.cosc0/o),r=Math.atan2(e.x*t,o*this.cosc0*i-e.y*this.sinc0*t)}else n=this.phic0,r=0;return e.x=r,e.y=n,wt.inverse.apply(this,[e]),e.x=Ie(e.x+this.long0),e},names:["Stereographic_North_Pole","Oblique_Stereographic","Polar_Stereographic","sterea","Oblique Stereographic Alternative","Double_Stereographic"]},St={init:function(){this.coslat0=Math.cos(this.lat0),this.sinlat0=Math.sin(this.lat0),this.sphere?1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=ue&&(this.k0=.5*(1+De(this.lat0)*Math.sin(this.lat_ts))):(Math.abs(this.coslat0)<=ue&&(this.lat0>0?this.con=1:this.con=-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=ue&&(this.k0=.5*this.cons*Le(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/Re(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=Le(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(this.ssfn_(this.lat0,this.sinlat0,this.e))-ae,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))},forward:function(e){var t,i,r,n,o,s,a=e.x,l=e.y,h=Math.sin(l),c=Math.cos(l),u=Ie(a-this.long0);return Math.abs(Math.abs(a-this.long0)-Math.PI)<=ue&&Math.abs(l+this.lat0)<=ue?(e.x=NaN,e.y=NaN,e):this.sphere?(t=2*this.k0/(1+this.sinlat0*h+this.coslat0*c*Math.cos(u)),e.x=this.a*t*c*Math.sin(u)+this.x0,e.y=this.a*t*(this.coslat0*h-this.sinlat0*c*Math.cos(u))+this.y0,e):(i=2*Math.atan(this.ssfn_(l,h,this.e))-ae,n=Math.cos(i),r=Math.sin(i),Math.abs(this.coslat0)<=ue?(o=Re(this.e,l*this.con,this.con*h),s=2*this.a*this.k0*o/this.cons,e.x=this.x0+s*Math.sin(a-this.long0),e.y=this.y0-this.con*s*Math.cos(a-this.long0),e):(Math.abs(this.sinlat0)<ue?(t=2*this.a*this.k0/(1+n*Math.cos(u)),e.y=t*r):(t=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*r+this.cosX0*n*Math.cos(u))),e.y=t*(this.cosX0*r-this.sinX0*n*Math.cos(u))+this.y0),e.x=t*n*Math.sin(u)+this.x0,e))},inverse:function(e){e.x-=this.x0,e.y-=this.y0;var t,i,r,n,o,s=Math.sqrt(e.x*e.x+e.y*e.y);if(this.sphere){var a=2*Math.atan(s/(2*this.a*this.k0));return t=this.long0,i=this.lat0,s<=ue?(e.x=t,e.y=i,e):(i=Math.asin(Math.cos(a)*this.sinlat0+e.y*Math.sin(a)*this.coslat0/s),t=Ie(Math.abs(this.coslat0)<ue?this.lat0>0?this.long0+Math.atan2(e.x,-1*e.y):this.long0+Math.atan2(e.x,e.y):this.long0+Math.atan2(e.x*Math.sin(a),s*this.coslat0*Math.cos(a)-e.y*this.sinlat0*Math.sin(a))),e.x=t,e.y=i,e)}if(Math.abs(this.coslat0)<=ue){if(s<=ue)return i=this.lat0,t=this.long0,e.x=t,e.y=i,e;e.x*=this.con,e.y*=this.con,r=s*this.cons/(2*this.a*this.k0),i=this.con*He(this.e,r),t=this.con*Ie(this.con*this.long0+Math.atan2(e.x,-1*e.y))}else n=2*Math.atan(s*this.cosX0/(2*this.a*this.k0*this.ms1)),t=this.long0,s<=ue?o=this.X0:(o=Math.asin(Math.cos(n)*this.sinX0+e.y*Math.sin(n)*this.cosX0/s),t=Ie(this.long0+Math.atan2(e.x*Math.sin(n),s*this.cosX0*Math.cos(n)-e.y*this.sinX0*Math.sin(n)))),i=-1*He(this.e,Math.tan(.5*(ae+o)));return e.x=t,e.y=i,e},names:["stere","Stereographic_South_Pole","Polar Stereographic (variant B)"],ssfn_:function(e,t,i){return t*=i,Math.tan(.5*(ae+e))*Math.pow((1-t)/(1+t),.5*i)}},xt={init:function(){var e=this.lat0;this.lambda0=this.long0;var t=Math.sin(e),i=this.a,r=1/this.rf,n=2*r-Math.pow(r,2),o=this.e=Math.sqrt(n);this.R=this.k0*i*Math.sqrt(1-n)/(1-n*Math.pow(t,2)),this.alpha=Math.sqrt(1+n/(1-n)*Math.pow(Math.cos(e),4)),this.b0=Math.asin(t/this.alpha);var s=Math.log(Math.tan(Math.PI/4+this.b0/2)),a=Math.log(Math.tan(Math.PI/4+e/2)),l=Math.log((1+o*t)/(1-o*t));this.K=s-this.alpha*a+this.alpha*o/2*l},forward:function(e){var t=Math.log(Math.tan(Math.PI/4-e.y/2)),i=this.e/2*Math.log((1+this.e*Math.sin(e.y))/(1-this.e*Math.sin(e.y))),r=-this.alpha*(t+i)+this.K,n=2*(Math.atan(Math.exp(r))-Math.PI/4),o=this.alpha*(e.x-this.lambda0),s=Math.atan(Math.sin(o)/(Math.sin(this.b0)*Math.tan(n)+Math.cos(this.b0)*Math.cos(o))),a=Math.asin(Math.cos(this.b0)*Math.sin(n)-Math.sin(this.b0)*Math.cos(n)*Math.cos(o));return e.y=this.R/2*Math.log((1+Math.sin(a))/(1-Math.sin(a)))+this.y0,e.x=this.R*s+this.x0,e},inverse:function(e){for(var t=e.x-this.x0,i=e.y-this.y0,r=t/this.R,n=2*(Math.atan(Math.exp(i/this.R))-Math.PI/4),o=Math.asin(Math.cos(this.b0)*Math.sin(n)+Math.sin(this.b0)*Math.cos(n)*Math.cos(r)),s=Math.atan(Math.sin(r)/(Math.cos(this.b0)*Math.cos(r)-Math.sin(this.b0)*Math.tan(n))),a=this.lambda0+s/this.alpha,l=0,h=o,c=-1e3,u=0;Math.abs(h-c)>1e-7;){if(++u>20)return;l=1/this.alpha*(Math.log(Math.tan(Math.PI/4+o/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(h))/2)),c=h,h=2*Math.atan(Math.exp(l))-Math.PI/2}return e.x=a,e.y=h,e},names:["somerc"]},Bt={init:function(){this.no_off=this.no_off||!1,this.no_rot=this.no_rot||!1,isNaN(this.k0)&&(this.k0=1);var e=Math.sin(this.lat0),t=Math.cos(this.lat0),i=this.e*e;this.bl=Math.sqrt(1+this.es/(1-this.es)*Math.pow(t,4)),this.al=this.a*this.bl*this.k0*Math.sqrt(1-this.es)/(1-i*i);var r,n,o=Re(this.e,this.lat0,e),s=this.bl/t*Math.sqrt((1-this.es)/(1-i*i));if(s*s<1&&(s=1),isNaN(this.longc)){var a=Re(this.e,this.lat1,Math.sin(this.lat1)),l=Re(this.e,this.lat2,Math.sin(this.lat2));this.lat0>=0?this.el=(s+Math.sqrt(s*s-1))*Math.pow(o,this.bl):this.el=(s-Math.sqrt(s*s-1))*Math.pow(o,this.bl);var h=Math.pow(a,this.bl),c=Math.pow(l,this.bl);n=.5*((r=this.el/h)-1/r);var u=(this.el*this.el-c*h)/(this.el*this.el+c*h),p=(c-h)/(c+h),d=Ie(this.long1-this.long2);this.long0=.5*(this.long1+this.long2)-Math.atan(u*Math.tan(.5*this.bl*d)/p)/this.bl,this.long0=Ie(this.long0);var m=Ie(this.long1-this.long0);this.gamma0=Math.atan(Math.sin(this.bl*m)/n),this.alpha=Math.asin(s*Math.sin(this.gamma0))}else r=this.lat0>=0?s+Math.sqrt(s*s-1):s-Math.sqrt(s*s-1),this.el=r*Math.pow(o,this.bl),n=.5*(r-1/r),this.gamma0=Math.asin(Math.sin(this.alpha)/s),this.long0=this.longc-Math.asin(n*Math.tan(this.gamma0))/this.bl;this.no_off?this.uc=0:this.lat0>=0?this.uc=this.al/this.bl*Math.atan2(Math.sqrt(s*s-1),Math.cos(this.alpha)):this.uc=-1*this.al/this.bl*Math.atan2(Math.sqrt(s*s-1),Math.cos(this.alpha))},forward:function(e){var t,i,r,n=e.x,o=e.y,s=Ie(n-this.long0);if(Math.abs(Math.abs(o)-ae)<=ue)r=o>0?-1:1,i=this.al/this.bl*Math.log(Math.tan(me+r*this.gamma0*.5)),t=-1*r*ae*this.al/this.bl;else{var a=Re(this.e,o,Math.sin(o)),l=this.el/Math.pow(a,this.bl),h=.5*(l-1/l),c=.5*(l+1/l),u=Math.sin(this.bl*s),p=(h*Math.sin(this.gamma0)-u*Math.cos(this.gamma0))/c;i=Math.abs(Math.abs(p)-1)<=ue?Number.POSITIVE_INFINITY:.5*this.al*Math.log((1-p)/(1+p))/this.bl,t=Math.abs(Math.cos(this.bl*s))<=ue?this.al*this.bl*s:this.al*Math.atan2(h*Math.cos(this.gamma0)+u*Math.sin(this.gamma0),Math.cos(this.bl*s))/this.bl}return this.no_rot?(e.x=this.x0+t,e.y=this.y0+i):(t-=this.uc,e.x=this.x0+i*Math.cos(this.alpha)+t*Math.sin(this.alpha),e.y=this.y0+t*Math.cos(this.alpha)-i*Math.sin(this.alpha)),e},inverse:function(e){var t,i;this.no_rot?(i=e.y-this.y0,t=e.x-this.x0):(i=(e.x-this.x0)*Math.cos(this.alpha)-(e.y-this.y0)*Math.sin(this.alpha),t=(e.y-this.y0)*Math.cos(this.alpha)+(e.x-this.x0)*Math.sin(this.alpha),t+=this.uc);var r=Math.exp(-1*this.bl*i/this.al),n=.5*(r-1/r),o=.5*(r+1/r),s=Math.sin(this.bl*t/this.al),a=(s*Math.cos(this.gamma0)+n*Math.sin(this.gamma0))/o,l=Math.pow(this.el/Math.sqrt((1+a)/(1-a)),1/this.bl);return Math.abs(a-1)<ue?(e.x=this.long0,e.y=ae):Math.abs(a+1)<ue?(e.x=this.long0,e.y=-1*ae):(e.y=He(this.e,l),e.x=Ie(this.long0-Math.atan2(n*Math.cos(this.gamma0)-s*Math.sin(this.gamma0),Math.cos(this.bl*t/this.al))/this.bl)),e},names:["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","omerc"]},Mt={init:function(){if(this.lat2||(this.lat2=this.lat1),this.k0||(this.k0=1),this.x0=this.x0||0,this.y0=this.y0||0,!(Math.abs(this.lat1+this.lat2)<ue)){var e=this.b/this.a;this.e=Math.sqrt(1-e*e);var t=Math.sin(this.lat1),i=Math.cos(this.lat1),r=Le(this.e,t,i),n=Re(this.e,this.lat1,t),o=Math.sin(this.lat2),s=Math.cos(this.lat2),a=Le(this.e,o,s),l=Re(this.e,this.lat2,o),h=Re(this.e,this.lat0,Math.sin(this.lat0));Math.abs(this.lat1-this.lat2)>ue?this.ns=Math.log(r/a)/Math.log(n/l):this.ns=t,isNaN(this.ns)&&(this.ns=t),this.f0=r/(this.ns*Math.pow(n,this.ns)),this.rh=this.a*this.f0*Math.pow(h,this.ns),this.title||(this.title="Lambert Conformal Conic")}},forward:function(e){var t=e.x,i=e.y;Math.abs(2*Math.abs(i)-Math.PI)<=ue&&(i=De(i)*(ae-2*ue));var r,n,o=Math.abs(Math.abs(i)-ae);if(o>ue)r=Re(this.e,i,Math.sin(i)),n=this.a*this.f0*Math.pow(r,this.ns);else{if((o=i*this.ns)<=0)return null;n=0}var s=this.ns*Ie(t-this.long0);return e.x=this.k0*(n*Math.sin(s))+this.x0,e.y=this.k0*(this.rh-n*Math.cos(s))+this.y0,e},inverse:function(e){var t,i,r,n,o,s=(e.x-this.x0)/this.k0,a=this.rh-(e.y-this.y0)/this.k0;this.ns>0?(t=Math.sqrt(s*s+a*a),i=1):(t=-Math.sqrt(s*s+a*a),i=-1);var l=0;if(0!==t&&(l=Math.atan2(i*s,i*a)),0!==t||this.ns>0){if(i=1/this.ns,r=Math.pow(t/(this.a*this.f0),i),-9999===(n=He(this.e,r)))return null}else n=-ae;return o=Ie(l/this.ns+this.long0),e.x=o,e.y=n,e},names:["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_2SP","lcc"]},Et={init:function(){this.a=6377397.155,this.es=.006674372230614,this.e=Math.sqrt(this.es),this.lat0||(this.lat0=.863937979737193),this.long0||(this.long0=.4334234309119251),this.k0||(this.k0=.9999),this.s45=.785398163397448,this.s90=2*this.s45,this.fi0=this.lat0,this.e2=this.es,this.e=Math.sqrt(this.e2),this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2)),this.uq=1.04216856380474,this.u0=Math.asin(Math.sin(this.fi0)/this.alfa),this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2),this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g,this.k1=this.k0,this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2)),this.s0=1.37008346281555,this.n=Math.sin(this.s0),this.ro0=this.k1*this.n0/Math.tan(this.s0),this.ad=this.s90-this.uq},forward:function(e){var t,i,r,n,o,s,a,l=e.x,h=e.y,c=Ie(l-this.long0);return t=Math.pow((1+this.e*Math.sin(h))/(1-this.e*Math.sin(h)),this.alfa*this.e/2),i=2*(Math.atan(this.k*Math.pow(Math.tan(h/2+this.s45),this.alfa)/t)-this.s45),r=-c*this.alfa,n=Math.asin(Math.cos(this.ad)*Math.sin(i)+Math.sin(this.ad)*Math.cos(i)*Math.cos(r)),o=Math.asin(Math.cos(i)*Math.sin(r)/Math.cos(n)),s=this.n*o,a=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(n/2+this.s45),this.n),e.y=a*Math.cos(s)/1,e.x=a*Math.sin(s)/1,this.czech||(e.y*=-1,e.x*=-1),e},inverse:function(e){var t,i,r,n,o,s,a,l=e.x;e.x=e.y,e.y=l,this.czech||(e.y*=-1,e.x*=-1),o=Math.sqrt(e.x*e.x+e.y*e.y),n=Math.atan2(e.y,e.x)/Math.sin(this.s0),r=2*(Math.atan(Math.pow(this.ro0/o,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45),t=Math.asin(Math.cos(this.ad)*Math.sin(r)-Math.sin(this.ad)*Math.cos(r)*Math.cos(n)),i=Math.asin(Math.cos(r)*Math.sin(n)/Math.cos(t)),e.x=this.long0-i/this.alfa,s=t,a=0;var h=0;do{e.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(t/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(s))/(1-this.e*Math.sin(s)),this.e/2))-this.s45),Math.abs(s-e.y)<1e-10&&(a=1),s=e.y,h+=1}while(0===a&&h<15);return h>=15?null:e},names:["Krovak","krovak"]},Tt=function(e,t,i,r,n){return e*n-t*Math.sin(2*n)+i*Math.sin(4*n)-r*Math.sin(6*n)},Ot=function(e){return 1-.25*e*(1+e/16*(3+1.25*e))},Lt=function(e){return.375*e*(1+.25*e*(1+.46875*e))},Dt=function(e){return.05859375*e*e*(1+.75*e)},It=function(e){return e*e*e*(35/3072)},Rt=function(e,t,i){var r=t*i;return e/Math.sqrt(1-r*r)},Ht=function(e){return Math.abs(e)<ae?e:e-De(e)*Math.PI},Ft=function(e,t,i,r,n){var o,s;o=e/t;for(var a=0;a<15;a++)if(o+=s=(e-(t*o-i*Math.sin(2*o)+r*Math.sin(4*o)-n*Math.sin(6*o)))/(t-2*i*Math.cos(2*o)+4*r*Math.cos(4*o)-6*n*Math.cos(6*o)),Math.abs(s)<=1e-10)return o;return NaN},Nt={init:function(){this.sphere||(this.e0=Ot(this.es),this.e1=Lt(this.es),this.e2=Dt(this.es),this.e3=It(this.es),this.ml0=this.a*Tt(this.e0,this.e1,this.e2,this.e3,this.lat0))},forward:function(e){var t,i,r=e.x,n=e.y;if(r=Ie(r-this.long0),this.sphere)t=this.a*Math.asin(Math.cos(n)*Math.sin(r)),i=this.a*(Math.atan2(Math.tan(n),Math.cos(r))-this.lat0);else{var o=Math.sin(n),s=Math.cos(n),a=Rt(this.a,this.e,o),l=Math.tan(n)*Math.tan(n),h=r*Math.cos(n),c=h*h,u=this.es*s*s/(1-this.es);t=a*h*(1-c*l*(1/6-(8-l+8*u)*c/120)),i=this.a*Tt(this.e0,this.e1,this.e2,this.e3,n)-this.ml0+a*o/s*c*(.5+(5-l+6*u)*c/24)}return e.x=t+this.x0,e.y=i+this.y0,e},inverse:function(e){e.x-=this.x0,e.y-=this.y0;var t,i,r=e.x/this.a,n=e.y/this.a;if(this.sphere){var o=n+this.lat0;t=Math.asin(Math.sin(o)*Math.cos(r)),i=Math.atan2(Math.tan(r),Math.cos(o))}else{var s=this.ml0/this.a+n,a=Ft(s,this.e0,this.e1,this.e2,this.e3);if(Math.abs(Math.abs(a)-ae)<=ue)return e.x=this.long0,e.y=ae,n<0&&(e.y*=-1),e;var l=Rt(this.a,this.e,Math.sin(a)),h=l*l*l/this.a/this.a*(1-this.es),c=Math.pow(Math.tan(a),2),u=r*this.a/l,p=u*u;t=a-l*Math.tan(a)/h*u*u*(.5-(1+3*c)*u*u/24),i=u*(1-p*(c/3+(1+3*c)*c*p/15))/Math.cos(a)}return e.x=Ie(i+this.long0),e.y=Ht(t),e},names:["Cassini","Cassini_Soldner","cass"]},Qt=function(e,t){var i;return e>1e-7?(1-e*e)*(t/(1-(i=e*t)*i)-.5/e*Math.log((1-i)/(1+i))):2*t},kt=.3333333333333333,Ut=.17222222222222222,jt=.10257936507936508,Gt=.06388888888888888,zt=.0664021164021164,Yt=.016415012942191543,Zt={init:function(){var e,t=Math.abs(this.lat0);if(Math.abs(t-ae)<ue?this.mode=this.lat0<0?this.S_POLE:this.N_POLE:Math.abs(t)<ue?this.mode=this.EQUIT:this.mode=this.OBLIQ,this.es>0)switch(this.qp=Qt(this.e,1),this.mmf=.5/(1-this.es),this.apa=V(this.es),this.mode){case this.N_POLE:case this.S_POLE:this.dd=1;break;case this.EQUIT:this.rq=Math.sqrt(.5*this.qp),this.dd=1/this.rq,this.xmf=1,this.ymf=.5*this.qp;break;case this.OBLIQ:this.rq=Math.sqrt(.5*this.qp),e=Math.sin(this.lat0),this.sinb1=Qt(this.e,e)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*e*e)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd}else this.mode===this.OBLIQ&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))},forward:function(e){var t,i,r,n,o,s,a,l,h,c,u=e.x,p=e.y;if(u=Ie(u-this.long0),this.sphere){if(o=Math.sin(p),c=Math.cos(p),r=Math.cos(u),this.mode===this.OBLIQ||this.mode===this.EQUIT){if((i=this.mode===this.EQUIT?1+c*r:1+this.sinph0*o+this.cosph0*c*r)<=ue)return null;t=(i=Math.sqrt(2/i))*c*Math.sin(u),i*=this.mode===this.EQUIT?o:this.cosph0*o-this.sinph0*c*r}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(r=-r),Math.abs(p+this.phi0)<ue)return null;i=me-.5*p,t=(i=2*(this.mode===this.S_POLE?Math.cos(i):Math.sin(i)))*Math.sin(u),i*=r}}else{switch(a=0,l=0,h=0,r=Math.cos(u),n=Math.sin(u),o=Math.sin(p),s=Qt(this.e,o),this.mode!==this.OBLIQ&&this.mode!==this.EQUIT||(a=s/this.qp,l=Math.sqrt(1-a*a)),this.mode){case this.OBLIQ:h=1+this.sinb1*a+this.cosb1*l*r;break;case this.EQUIT:h=1+l*r;break;case this.N_POLE:h=ae+p,s=this.qp-s;break;case this.S_POLE:h=p-ae,s=this.qp+s}if(Math.abs(h)<ue)return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:h=Math.sqrt(2/h),i=this.mode===this.OBLIQ?this.ymf*h*(this.cosb1*a-this.sinb1*l*r):(h=Math.sqrt(2/(1+l*r)))*a*this.ymf,t=this.xmf*h*l*n;break;case this.N_POLE:case this.S_POLE:s>=0?(t=(h=Math.sqrt(s))*n,i=r*(this.mode===this.S_POLE?h:-h)):t=i=0}}return e.x=this.a*t+this.x0,e.y=this.a*i+this.y0,e},inverse:function(e){e.x-=this.x0,e.y-=this.y0;var t,i,r,n,o,s,a,l=e.x/this.a,h=e.y/this.a;if(this.sphere){var c,u=0,p=0;if((i=.5*(c=Math.sqrt(l*l+h*h)))>1)return null;switch(i=2*Math.asin(i),this.mode!==this.OBLIQ&&this.mode!==this.EQUIT||(p=Math.sin(i),u=Math.cos(i)),this.mode){case this.EQUIT:i=Math.abs(c)<=ue?0:Math.asin(h*p/c),l*=p,h=u*c;break;case this.OBLIQ:i=Math.abs(c)<=ue?this.phi0:Math.asin(u*this.sinph0+h*p*this.cosph0/c),l*=p*this.cosph0,h=(u-Math.sin(i)*this.sinph0)*c;break;case this.N_POLE:h=-h,i=ae-i;break;case this.S_POLE:i-=ae}t=0!==h||this.mode!==this.EQUIT&&this.mode!==this.OBLIQ?Math.atan2(l,h):0}else{if(a=0,this.mode===this.OBLIQ||this.mode===this.EQUIT){if(l/=this.dd,h*=this.dd,(s=Math.sqrt(l*l+h*h))<ue)return e.x=0,e.y=this.phi0,e;n=2*Math.asin(.5*s/this.rq),r=Math.cos(n),l*=n=Math.sin(n),this.mode===this.OBLIQ?(a=r*this.sinb1+h*n*this.cosb1/s,o=this.qp*a,h=s*this.cosb1*r-h*this.sinb1*n):(a=h*n/s,o=this.qp*a,h=s*r)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(h=-h),!(o=l*l+h*h))return e.x=0,e.y=this.phi0,e;a=1-o/this.qp,this.mode===this.S_POLE&&(a=-a)}t=Math.atan2(l,h),i=q(Math.asin(a),this.apa)}return e.x=Ie(this.long0+t),e.y=i,e},names:["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"],S_POLE:1,N_POLE:2,EQUIT:3,OBLIQ:4},Wt=function(e){return Math.abs(e)>1&&(e=e>1?1:-1),Math.asin(e)},Xt={init:function(){Math.abs(this.lat1+this.lat2)<ue||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.t1=this.sin_po,this.con=this.sin_po,this.ms1=Le(this.e3,this.sin_po,this.cos_po),this.qs1=Qt(this.e3,this.sin_po,this.cos_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=Le(this.e3,this.sin_po,this.cos_po),this.qs2=Qt(this.e3,this.sin_po,this.cos_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=Qt(this.e3,this.sin_po,this.cos_po),Math.abs(this.lat1-this.lat2)>ue?this.ns0=(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.ns0=this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)},forward:function(e){var t=e.x,i=e.y;this.sin_phi=Math.sin(i),this.cos_phi=Math.cos(i);var r=Qt(this.e3,this.sin_phi,this.cos_phi),n=this.a*Math.sqrt(this.c-this.ns0*r)/this.ns0,o=this.ns0*Ie(t-this.long0),s=n*Math.sin(o)+this.x0,a=this.rh-n*Math.cos(o)+this.y0;return e.x=s,e.y=a,e},inverse:function(e){var t,i,r,n,o,s;return e.x-=this.x0,e.y=this.rh-e.y+this.y0,this.ns0>=0?(t=Math.sqrt(e.x*e.x+e.y*e.y),r=1):(t=-Math.sqrt(e.x*e.x+e.y*e.y),r=-1),n=0,0!==t&&(n=Math.atan2(r*e.x,r*e.y)),r=t*this.ns0/this.a,this.sphere?s=Math.asin((this.c-r*r)/(2*this.ns0)):(i=(this.c-r*r)/this.ns0,s=this.phi1z(this.e3,i)),o=Ie(n/this.ns0+this.long0),e.x=o,e.y=s,e},names:["Albers_Conic_Equal_Area","Albers","aea"],phi1z:function(e,t){var i,r,n,o,s=Wt(.5*t);if(e<ue)return s;for(var a=e*e,l=1;l<=25;l++)if(s+=o=.5*(n=1-(r=e*(i=Math.sin(s)))*r)*n/Math.cos(s)*(t/(1-a)-i/n+.5/e*Math.log((1-r)/(1+r))),Math.abs(o)<=1e-7)return s;return null}},Jt={init:function(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0),this.infinity_dist=1e3*this.a,this.rc=1},forward:function(e){var t,i,r,n,o,s,a,l=e.x,h=e.y;return r=Ie(l-this.long0),t=Math.sin(h),i=Math.cos(h),n=Math.cos(r),(o=this.sin_p14*t+this.cos_p14*i*n)>0||Math.abs(o)<=ue?(s=this.x0+1*this.a*i*Math.sin(r)/o,a=this.y0+1*this.a*(this.cos_p14*t-this.sin_p14*i*n)/o):(s=this.x0+this.infinity_dist*i*Math.sin(r),a=this.y0+this.infinity_dist*(this.cos_p14*t-this.sin_p14*i*n)),e.x=s,e.y=a,e},inverse:function(e){var t,i,r,n,o,s;return e.x=(e.x-this.x0)/this.a,e.y=(e.y-this.y0)/this.a,e.x/=this.k0,e.y/=this.k0,(t=Math.sqrt(e.x*e.x+e.y*e.y))?(n=Math.atan2(t,this.rc),i=Math.sin(n),r=Math.cos(n),s=Wt(r*this.sin_p14+e.y*i*this.cos_p14/t),o=Math.atan2(e.x*i,t*this.cos_p14*r-e.y*this.sin_p14*i),o=Ie(this.long0+o)):(s=this.phic0,o=0),e.x=o,e.y=s,e},names:["gnom"]},Kt=function(e,t){var i=1-(1-e*e)/(2*e)*Math.log((1-e)/(1+e));if(Math.abs(Math.abs(t)-i)<1e-6)return t<0?-1*ae:ae;for(var r,n,o,s,a=Math.asin(.5*t),l=0;l<30;l++)if(n=Math.sin(a),o=Math.cos(a),s=e*n,a+=r=Math.pow(1-s*s,2)/(2*o)*(t/(1-e*e)-n/(1-s*s)+.5/e*Math.log((1-s)/(1+s))),Math.abs(r)<=1e-10)return a;return NaN},Vt={init:function(){this.sphere||(this.k0=Le(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))},forward:function(e){var t,i,r=e.x,n=e.y,o=Ie(r-this.long0);if(this.sphere)t=this.x0+this.a*o*Math.cos(this.lat_ts),i=this.y0+this.a*Math.sin(n)/Math.cos(this.lat_ts);else{var s=Qt(this.e,Math.sin(n));t=this.x0+this.a*this.k0*o,i=this.y0+this.a*s*.5/this.k0}return e.x=t,e.y=i,e},inverse:function(e){var t,i;return e.x-=this.x0,e.y-=this.y0,this.sphere?(t=Ie(this.long0+e.x/this.a/Math.cos(this.lat_ts)),i=Math.asin(e.y/this.a*Math.cos(this.lat_ts))):(i=Kt(this.e,2*e.y*this.k0/this.a),t=Ie(this.long0+e.x/(this.a*this.k0))),e.x=t,e.y=i,e},names:["cea"]},qt={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Equidistant Cylindrical (Plate Carre)",this.rc=Math.cos(this.lat_ts)},forward:function(e){var t=e.x,i=e.y,r=Ie(t-this.long0),n=Ht(i-this.lat0);return e.x=this.x0+this.a*r*this.rc,e.y=this.y0+this.a*n,e},inverse:function(e){var t=e.x,i=e.y;return e.x=Ie(this.long0+(t-this.x0)/(this.a*this.rc)),e.y=Ht(this.lat0+(i-this.y0)/this.a),e},names:["Equirectangular","Equidistant_Cylindrical","eqc"]},$t=20,ei={init:function(){this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=Ot(this.es),this.e1=Lt(this.es),this.e2=Dt(this.es),this.e3=It(this.es),this.ml0=this.a*Tt(this.e0,this.e1,this.e2,this.e3,this.lat0)},forward:function(e){var t,i,r,n=e.x,o=e.y,s=Ie(n-this.long0);if(r=s*Math.sin(o),this.sphere)Math.abs(o)<=ue?(t=this.a*s,i=-1*this.a*this.lat0):(t=this.a*Math.sin(r)/Math.tan(o),i=this.a*(Ht(o-this.lat0)+(1-Math.cos(r))/Math.tan(o)));else if(Math.abs(o)<=ue)t=this.a*s,i=-1*this.ml0;else{var a=Rt(this.a,this.e,Math.sin(o))/Math.tan(o);t=a*Math.sin(r),i=this.a*Tt(this.e0,this.e1,this.e2,this.e3,o)-this.ml0+a*(1-Math.cos(r))}return e.x=t+this.x0,e.y=i+this.y0,e},inverse:function(e){var t,i,r,n,o,s,a,l,h;if(r=e.x-this.x0,n=e.y-this.y0,this.sphere)if(Math.abs(n+this.a*this.lat0)<=ue)t=Ie(r/this.a+this.long0),i=0;else{var c;for(s=this.lat0+n/this.a,a=r*r/this.a/this.a+s*s,l=s,o=$t;o;--o)if(l+=h=-1*(s*(l*(c=Math.tan(l))+1)-l-.5*(l*l+a)*c)/((l-s)/c-1),Math.abs(h)<=ue){i=l;break}t=Ie(this.long0+Math.asin(r*Math.tan(l)/this.a)/Math.sin(i))}else if(Math.abs(n+this.ml0)<=ue)i=0,t=Ie(this.long0+r/this.a);else{var u,p,d,m,f;for(s=(this.ml0+n)/this.a,a=r*r/this.a/this.a+s*s,l=s,o=$t;o;--o)if(f=this.e*Math.sin(l),u=Math.sqrt(1-f*f)*Math.tan(l),p=this.a*Tt(this.e0,this.e1,this.e2,this.e3,l),d=this.e0-2*this.e1*Math.cos(2*l)+4*this.e2*Math.cos(4*l)-6*this.e3*Math.cos(6*l),l-=h=(s*(u*(m=p/this.a)+1)-m-.5*u*(m*m+a))/(this.es*Math.sin(2*l)*(m*m+a-2*s*m)/(4*u)+(s-m)*(u*d-2/Math.sin(2*l))-d),Math.abs(h)<=ue){i=l;break}u=Math.sqrt(1-this.es*Math.pow(Math.sin(i),2))*Math.tan(i),t=Ie(this.long0+Math.asin(r*u/this.a)/Math.sin(i))}return e.x=t,e.y=i,e},names:["Polyconic","poly"]},ti={init:function(){this.A=[],this.A[1]=.6399175073,this.A[2]=-.1358797613,this.A[3]=.063294409,this.A[4]=-.02526853,this.A[5]=.0117879,this.A[6]=-.0055161,this.A[7]=.0026906,this.A[8]=-.001333,this.A[9]=67e-5,this.A[10]=-34e-5,this.B_re=[],this.B_im=[],this.B_re[1]=.7557853228,this.B_im[1]=0,this.B_re[2]=.249204646,this.B_im[2]=.003371507,this.B_re[3]=-.001541739,this.B_im[3]=.04105856,this.B_re[4]=-.10162907,this.B_im[4]=.01727609,this.B_re[5]=-.26623489,this.B_im[5]=-.36249218,this.B_re[6]=-.6870983,this.B_im[6]=-1.1651967,this.C_re=[],this.C_im=[],this.C_re[1]=1.3231270439,this.C_im[1]=0,this.C_re[2]=-.577245789,this.C_im[2]=-.007809598,this.C_re[3]=.508307513,this.C_im[3]=-.112208952,this.C_re[4]=-.15094762,this.C_im[4]=.18200602,this.C_re[5]=1.01418179,this.C_im[5]=1.64497696,this.C_re[6]=1.9660549,this.C_im[6]=2.5127645,this.D=[],this.D[1]=1.5627014243,this.D[2]=.5185406398,this.D[3]=-.03333098,this.D[4]=-.1052906,this.D[5]=-.0368594,this.D[6]=.007317,this.D[7]=.0122,this.D[8]=.00394,this.D[9]=-.0013},forward:function(e){var t,i=e.x,r=e.y-this.lat0,n=i-this.long0,o=r/se*1e-5,s=n,a=1,l=0;for(t=1;t<=10;t++)a*=o,l+=this.A[t]*a;var h,c=l,u=s,p=1,d=0,m=0,f=0;for(t=1;t<=6;t++)h=d*c+p*u,p=p*c-d*u,d=h,m=m+this.B_re[t]*p-this.B_im[t]*d,f=f+this.B_im[t]*p+this.B_re[t]*d;return e.x=f*this.a+this.x0,e.y=m*this.a+this.y0,e},inverse:function(e){var t,i,r=e.x,n=e.y,o=r-this.x0,s=(n-this.y0)/this.a,a=o/this.a,l=1,h=0,c=0,u=0;for(t=1;t<=6;t++)i=h*s+l*a,l=l*s-h*a,h=i,c=c+this.C_re[t]*l-this.C_im[t]*h,u=u+this.C_im[t]*l+this.C_re[t]*h;for(var p=0;p<this.iterations;p++){var d,m=c,f=u,g=s,A=a;for(t=2;t<=6;t++)d=f*c+m*u,m=m*c-f*u,f=d,g+=(t-1)*(this.B_re[t]*m-this.B_im[t]*f),A+=(t-1)*(this.B_im[t]*m+this.B_re[t]*f);m=1,f=0;var y=this.B_re[1],v=this.B_im[1];for(t=2;t<=6;t++)d=f*c+m*u,m=m*c-f*u,f=d,y+=t*(this.B_re[t]*m-this.B_im[t]*f),v+=t*(this.B_im[t]*m+this.B_re[t]*f);var C=y*y+v*v;c=(g*y+A*v)/C,u=(A*y-g*v)/C}var _=c,b=u,w=1,P=0;for(t=1;t<=9;t++)w*=_,P+=this.D[t]*w;var S=this.lat0+P*se*1e5,x=this.long0+b;return e.x=x,e.y=S,e},names:["New_Zealand_Map_Grid","nzmg"]},ii={init:function(){},forward:function(e){var t=e.x,i=e.y,r=Ie(t-this.long0),n=this.x0+this.a*r,o=this.y0+this.a*Math.log(Math.tan(Math.PI/4+i/2.5))*1.25;return e.x=n,e.y=o,e},inverse:function(e){e.x-=this.x0,e.y-=this.y0;var t=Ie(this.long0+e.x/this.a),i=2.5*(Math.atan(Math.exp(.8*e.y/this.a))-Math.PI/4);return e.x=t,e.y=i,e},names:["Miller_Cylindrical","mill"]},ri=20,ni={init:function(){this.sphere?(this.n=1,this.m=0,this.es=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=st(this.es)},forward:function(e){var t,i,r=e.x,n=e.y;if(r=Ie(r-this.long0),this.sphere){if(this.m)for(var o=this.n*Math.sin(n),s=ri;s;--s){var a=(this.m*n+Math.sin(n)-o)/(this.m+Math.cos(n));if(n-=a,Math.abs(a)<ue)break}else n=1!==this.n?Math.asin(this.n*Math.sin(n)):n;t=this.a*this.C_x*r*(this.m+Math.cos(n)),i=this.a*this.C_y*n}else{var l=Math.sin(n),h=Math.cos(n);i=this.a*at(n,l,h,this.en),t=this.a*r*h/Math.sqrt(1-this.es*l*l)}return e.x=t,e.y=i,e},inverse:function(e){var t,i,r,n;return e.x-=this.x0,r=e.x/this.a,e.y-=this.y0,t=e.y/this.a,this.sphere?(t/=this.C_y,r/=this.C_x*(this.m+Math.cos(t)),this.m?t=Wt((this.m*t+Math.sin(t))/this.n):1!==this.n&&(t=Wt(Math.sin(t)/this.n)),r=Ie(r+this.long0),t=Ht(t)):(t=lt(e.y/this.a,this.es,this.en),(n=Math.abs(t))<ae?(n=Math.sin(t),i=this.long0+e.x*Math.sqrt(1-this.es*n*n)/(this.a*Math.cos(t)),r=Ie(i)):n-ue<ae&&(r=this.long0)),e.x=r,e.y=t,e},names:["Sinusoidal","sinu"]},oi={init:function(){},forward:function(e){for(var t=e.x,i=e.y,r=Ie(t-this.long0),n=i,o=Math.PI*Math.sin(i);;){var s=-(n+Math.sin(n)-o)/(1+Math.cos(n));if(n+=s,Math.abs(s)<ue)break}n/=2,Math.PI/2-Math.abs(i)<ue&&(r=0);var a=.900316316158*this.a*r*Math.cos(n)+this.x0,l=1.4142135623731*this.a*Math.sin(n)+this.y0;return e.x=a,e.y=l,e},inverse:function(e){var t,i;e.x-=this.x0,e.y-=this.y0,i=e.y/(1.4142135623731*this.a),Math.abs(i)>.999999999999&&(i=.999999999999),t=Math.asin(i);var r=Ie(this.long0+e.x/(.900316316158*this.a*Math.cos(t)));r<-Math.PI&&(r=-Math.PI),r>Math.PI&&(r=Math.PI),i=(2*t+Math.sin(2*t))/Math.PI,Math.abs(i)>1&&(i=1);var n=Math.asin(i);return e.x=r,e.y=n,e},names:["Mollweide","moll"]},si={init:function(){Math.abs(this.lat1+this.lat2)<ue||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=Ot(this.es),this.e1=Lt(this.es),this.e2=Dt(this.es),this.e3=It(this.es),this.sinphi=Math.sin(this.lat1),this.cosphi=Math.cos(this.lat1),this.ms1=Le(this.e,this.sinphi,this.cosphi),this.ml1=Tt(this.e0,this.e1,this.e2,this.e3,this.lat1),Math.abs(this.lat1-this.lat2)<ue?this.ns=this.sinphi:(this.sinphi=Math.sin(this.lat2),this.cosphi=Math.cos(this.lat2),this.ms2=Le(this.e,this.sinphi,this.cosphi),this.ml2=Tt(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=Tt(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))},forward:function(e){var t,i=e.x,r=e.y;if(this.sphere)t=this.a*(this.g-r);else{var n=Tt(this.e0,this.e1,this.e2,this.e3,r);t=this.a*(this.g-n)}var o=this.ns*Ie(i-this.long0),s=this.x0+t*Math.sin(o),a=this.y0+this.rh-t*Math.cos(o);return e.x=s,e.y=a,e},inverse:function(e){var t,i,r,n;e.x-=this.x0,e.y=this.rh-e.y+this.y0,this.ns>=0?(i=Math.sqrt(e.x*e.x+e.y*e.y),t=1):(i=-Math.sqrt(e.x*e.x+e.y*e.y),t=-1);var o=0;if(0!==i&&(o=Math.atan2(t*e.x,t*e.y)),this.sphere)return n=Ie(this.long0+o/this.ns),r=Ht(this.g-i/this.a),e.x=n,e.y=r,e;var s=this.g-i/this.a;return r=Ft(s,this.e0,this.e1,this.e2,this.e3),n=Ie(this.long0+o/this.ns),e.x=n,e.y=r,e},names:["Equidistant_Conic","eqdc"]},ai={init:function(){this.R=this.a},forward:function(e){var t,i,r=e.x,n=e.y,o=Ie(r-this.long0);Math.abs(n)<=ue&&(t=this.x0+this.R*o,i=this.y0);var s=Wt(2*Math.abs(n/Math.PI));(Math.abs(o)<=ue||Math.abs(Math.abs(n)-ae)<=ue)&&(t=this.x0,i=n>=0?this.y0+Math.PI*this.R*Math.tan(.5*s):this.y0+Math.PI*this.R*-Math.tan(.5*s));var a=.5*Math.abs(Math.PI/o-o/Math.PI),l=a*a,h=Math.sin(s),c=Math.cos(s),u=c/(h+c-1),p=u*u,d=u*(2/h-1),m=d*d,f=Math.PI*this.R*(a*(u-m)+Math.sqrt(l*(u-m)*(u-m)-(m+l)*(p-m)))/(m+l);o<0&&(f=-f),t=this.x0+f;var g=l+u;return f=Math.PI*this.R*(d*g-a*Math.sqrt((m+l)*(l+1)-g*g))/(m+l),i=n>=0?this.y0+f:this.y0-f,e.x=t,e.y=i,e},inverse:function(e){var t,i,r,n,o,s,a,l,h,c,u,p;return e.x-=this.x0,e.y-=this.y0,u=Math.PI*this.R,o=(r=e.x/u)*r+(n=e.y/u)*n,u=3*(n*n/(l=-2*(s=-Math.abs(n)*(1+o))+1+2*n*n+o*o)+(2*(a=s-2*n*n+r*r)*a*a/l/l/l-9*s*a/l/l)/27)/(h=(s-a*a/3/l)/l)/(c=2*Math.sqrt(-h/3)),Math.abs(u)>1&&(u=u>=0?1:-1),p=Math.acos(u)/3,i=e.y>=0?(-c*Math.cos(p+Math.PI/3)-a/3/l)*Math.PI:-(-c*Math.cos(p+Math.PI/3)-a/3/l)*Math.PI,t=Math.abs(r)<ue?this.long0:Ie(this.long0+Math.PI*(o-1+Math.sqrt(1+2*(r*r-n*n)+o*o))/2/r),e.x=t,e.y=i,e},names:["Van_der_Grinten_I","VanDerGrinten","vandg"]},li={init:function(){this.sin_p12=Math.sin(this.lat0),this.cos_p12=Math.cos(this.lat0)},forward:function(e){var t,i,r,n,o,s,a,l,h,c,u,p,d,m,f,g,A,y,v,C,_,b,w=e.x,P=e.y,S=Math.sin(e.y),x=Math.cos(e.y),B=Ie(w-this.long0);return this.sphere?Math.abs(this.sin_p12-1)<=ue?(e.x=this.x0+this.a*(ae-P)*Math.sin(B),e.y=this.y0-this.a*(ae-P)*Math.cos(B),e):Math.abs(this.sin_p12+1)<=ue?(e.x=this.x0+this.a*(ae+P)*Math.sin(B),e.y=this.y0+this.a*(ae+P)*Math.cos(B),e):(y=this.sin_p12*S+this.cos_p12*x*Math.cos(B),A=(g=Math.acos(y))/Math.sin(g),e.x=this.x0+this.a*A*x*Math.sin(B),e.y=this.y0+this.a*A*(this.cos_p12*S-this.sin_p12*x*Math.cos(B)),e):(t=Ot(this.es),i=Lt(this.es),r=Dt(this.es),n=It(this.es),Math.abs(this.sin_p12-1)<=ue?(o=this.a*Tt(t,i,r,n,ae),s=this.a*Tt(t,i,r,n,P),e.x=this.x0+(o-s)*Math.sin(B),e.y=this.y0-(o-s)*Math.cos(B),e):Math.abs(this.sin_p12+1)<=ue?(o=this.a*Tt(t,i,r,n,ae),s=this.a*Tt(t,i,r,n,P),e.x=this.x0+(o+s)*Math.sin(B),e.y=this.y0+(o+s)*Math.cos(B),e):(a=S/x,l=Rt(this.a,this.e,this.sin_p12),h=Rt(this.a,this.e,S),c=Math.atan((1-this.es)*a+this.es*l*this.sin_p12/(h*x)),v=0===(u=Math.atan2(Math.sin(B),this.cos_p12*Math.tan(c)-this.sin_p12*Math.cos(B)))?Math.asin(this.cos_p12*Math.sin(c)-this.sin_p12*Math.cos(c)):Math.abs(Math.abs(u)-Math.PI)<=ue?-Math.asin(this.cos_p12*Math.sin(c)-this.sin_p12*Math.cos(c)):Math.asin(Math.sin(B)*Math.cos(c)/Math.sin(u)),p=this.e*this.sin_p12/Math.sqrt(1-this.es),g=l*v*(1-(C=v*v)*(f=(d=this.e*this.cos_p12*Math.cos(u)/Math.sqrt(1-this.es))*d)*(1-f)/6+(_=C*v)/8*(m=p*d)*(1-2*f)+(b=_*v)/120*(f*(4-7*f)-3*p*p*(1-7*f))-b*v/48*m),e.x=this.x0+g*Math.sin(u),e.y=this.y0+g*Math.cos(u),e))},inverse:function(e){var t,i,r,n,o,s,a,l,h,c,u,p,d,m,f,g,A,y,v,C,_,b;if(e.x-=this.x0,e.y-=this.y0,this.sphere){if((t=Math.sqrt(e.x*e.x+e.y*e.y))>2*ae*this.a)return;return i=t/this.a,r=Math.sin(i),n=Math.cos(i),o=this.long0,Math.abs(t)<=ue?s=this.lat0:(s=Wt(n*this.sin_p12+e.y*r*this.cos_p12/t),a=Math.abs(this.lat0)-ae,o=Ie(Math.abs(a)<=ue?this.lat0>=0?this.long0+Math.atan2(e.x,-e.y):this.long0-Math.atan2(-e.x,e.y):this.long0+Math.atan2(e.x*r,t*this.cos_p12*n-e.y*this.sin_p12*r))),e.x=o,e.y=s,e}return l=Ot(this.es),h=Lt(this.es),c=Dt(this.es),u=It(this.es),Math.abs(this.sin_p12-1)<=ue?(p=this.a*Tt(l,h,c,u,ae),t=Math.sqrt(e.x*e.x+e.y*e.y),s=Ft((p-t)/this.a,l,h,c,u),o=Ie(this.long0+Math.atan2(e.x,-1*e.y)),e.x=o,e.y=s,e):Math.abs(this.sin_p12+1)<=ue?(p=this.a*Tt(l,h,c,u,ae),t=Math.sqrt(e.x*e.x+e.y*e.y),s=Ft((t-p)/this.a,l,h,c,u),o=Ie(this.long0+Math.atan2(e.x,e.y)),e.x=o,e.y=s,e):(t=Math.sqrt(e.x*e.x+e.y*e.y),f=Math.atan2(e.x,e.y),d=Rt(this.a,this.e,this.sin_p12),g=Math.cos(f),y=-(A=this.e*this.cos_p12*g)*A/(1-this.es),v=3*this.es*(1-y)*this.sin_p12*this.cos_p12*g/(1-this.es),b=1-y*(_=(C=t/d)-y*(1+y)*Math.pow(C,3)/6-v*(1+3*y)*Math.pow(C,4)/24)*_/2-C*_*_*_/6,m=Math.asin(this.sin_p12*Math.cos(_)+this.cos_p12*Math.sin(_)*g),o=Ie(this.long0+Math.asin(Math.sin(f)*Math.sin(_)/Math.cos(m))),s=Math.atan((1-this.es*b*this.sin_p12/Math.sin(m))*Math.tan(m)/(1-this.es)),e.x=o,e.y=s,e)},names:["Azimuthal_Equidistant","aeqd"]},hi={init:function(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0)},forward:function(e){var t,i,r,n,o,s,a,l=e.x,h=e.y;return r=Ie(l-this.long0),t=Math.sin(h),i=Math.cos(h),n=Math.cos(r),((o=this.sin_p14*t+this.cos_p14*i*n)>0||Math.abs(o)<=ue)&&(s=1*this.a*i*Math.sin(r),a=this.y0+1*this.a*(this.cos_p14*t-this.sin_p14*i*n)),e.x=s,e.y=a,e},inverse:function(e){var t,i,r,n,o,s,a;return e.x-=this.x0,e.y-=this.y0,t=Math.sqrt(e.x*e.x+e.y*e.y),i=Wt(t/this.a),r=Math.sin(i),n=Math.cos(i),s=this.long0,Math.abs(t)<=ue?(a=this.lat0,e.x=s,e.y=a,e):(a=Wt(n*this.sin_p14+e.y*r*this.cos_p14/t),o=Math.abs(this.lat0)-ae,Math.abs(o)<=ue?(s=Ie(this.lat0>=0?this.long0+Math.atan2(e.x,-e.y):this.long0-Math.atan2(-e.x,e.y)),e.x=s,e.y=a,e):(s=Ie(this.long0+Math.atan2(e.x*r,t*this.cos_p14*n-e.y*this.sin_p14*r)),e.x=s,e.y=a,e))},names:["ortho"]},ci={FRONT:1,RIGHT:2,BACK:3,LEFT:4,TOP:5,BOTTOM:6},ui={AREA_0:1,AREA_1:2,AREA_2:3,AREA_3:4},pi={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Quadrilateralized Spherical Cube",this.lat0>=ae-me/2?this.face=ci.TOP:this.lat0<=-(ae-me/2)?this.face=ci.BOTTOM:Math.abs(this.long0)<=me?this.face=ci.FRONT:Math.abs(this.long0)<=ae+me?this.face=this.long0>0?ci.RIGHT:ci.LEFT:this.face=ci.BACK,0!==this.es&&(this.one_minus_f=1-(this.a-this.b)/this.a,this.one_minus_f_squared=this.one_minus_f*this.one_minus_f)},forward:function(e){var t,i,r,n,o,s,a={x:0,y:0},l={value:0};if(e.x-=this.long0,t=0!==this.es?Math.atan(this.one_minus_f_squared*Math.tan(e.y)):e.y,i=e.x,this.face===ci.TOP)n=ae-t,i>=me&&i<=ae+me?(l.value=ui.AREA_0,r=i-ae):i>ae+me||i<=-(ae+me)?(l.value=ui.AREA_1,r=i>0?i-ge:i+ge):i>-(ae+me)&&i<=-me?(l.value=ui.AREA_2,r=i+ae):(l.value=ui.AREA_3,r=i);else if(this.face===ci.BOTTOM)n=ae+t,i>=me&&i<=ae+me?(l.value=ui.AREA_0,r=-i+ae):i<me&&i>=-me?(l.value=ui.AREA_1,r=-i):i<-me&&i>=-(ae+me)?(l.value=ui.AREA_2,r=-i-ae):(l.value=ui.AREA_3,r=i>0?-i+ge:-i-ge);else{var h,c,u,p,d,m;this.face===ci.RIGHT?i=ee(i,+ae):this.face===ci.BACK?i=ee(i,+ge):this.face===ci.LEFT&&(i=ee(i,-ae)),p=Math.sin(t),d=Math.cos(t),m=Math.sin(i),h=d*Math.cos(i),c=d*m,u=p,this.face===ci.FRONT?r=$(n=Math.acos(h),u,c,l):this.face===ci.RIGHT?r=$(n=Math.acos(c),u,-h,l):this.face===ci.BACK?r=$(n=Math.acos(-h),u,-c,l):this.face===ci.LEFT?r=$(n=Math.acos(-c),u,h,l):(n=r=0,l.value=ui.AREA_0)}return s=Math.atan(12/ge*(r+Math.acos(Math.sin(r)*Math.cos(me))-ae)),o=Math.sqrt((1-Math.cos(n))/(Math.cos(s)*Math.cos(s))/(1-Math.cos(Math.atan(1/Math.cos(r))))),l.value===ui.AREA_1?s+=ae:l.value===ui.AREA_2?s+=ge:l.value===ui.AREA_3&&(s+=1.5*ge),a.x=o*Math.cos(s),a.y=o*Math.sin(s),a.x=a.x*this.a+this.x0,a.y=a.y*this.a+this.y0,e.x=a.x,e.y=a.y,e},inverse:function(e){var t,i,r,n,o,s,a,l,h,c,u,p,d={lam:0,phi:0},m={value:0};if(e.x=(e.x-this.x0)/this.a,e.y=(e.y-this.y0)/this.a,i=Math.atan(Math.sqrt(e.x*e.x+e.y*e.y)),t=Math.atan2(e.y,e.x),e.x>=0&&e.x>=Math.abs(e.y)?m.value=ui.AREA_0:e.y>=0&&e.y>=Math.abs(e.x)?(m.value=ui.AREA_1,t-=ae):e.x<0&&-e.x>=Math.abs(e.y)?(m.value=ui.AREA_2,t=t<0?t+ge:t-ge):(m.value=ui.AREA_3,t+=ae),h=ge/12*Math.tan(t),o=Math.sin(h)/(Math.cos(h)-1/Math.sqrt(2)),s=Math.atan(o),(a=1-(r=Math.cos(t))*r*(n=Math.tan(i))*n*(1-Math.cos(Math.atan(1/Math.cos(s)))))<-1?a=-1:a>1&&(a=1),this.face===ci.TOP)l=Math.acos(a),d.phi=ae-l,m.value===ui.AREA_0?d.lam=s+ae:m.value===ui.AREA_1?d.lam=s<0?s+ge:s-ge:m.value===ui.AREA_2?d.lam=s-ae:d.lam=s;else if(this.face===ci.BOTTOM)l=Math.acos(a),d.phi=l-ae,m.value===ui.AREA_0?d.lam=-s+ae:m.value===ui.AREA_1?d.lam=-s:m.value===ui.AREA_2?d.lam=-s-ae:d.lam=s<0?-s-ge:-s+ge;else{var f,g,A;h=(f=a)*f,g=(h+=(A=h>=1?0:Math.sqrt(1-h)*Math.sin(s))*A)>=1?0:Math.sqrt(1-h),m.value===ui.AREA_1?(h=g,g=-A,A=h):m.value===ui.AREA_2?(g=-g,A=-A):m.value===ui.AREA_3&&(h=g,g=A,A=-h),this.face===ci.RIGHT?(h=f,f=-g,g=h):this.face===ci.BACK?(f=-f,g=-g):this.face===ci.LEFT&&(h=f,f=g,g=-h),d.phi=Math.acos(-A)-ae,d.lam=Math.atan2(g,f),this.face===ci.RIGHT?d.lam=ee(d.lam,-ae):this.face===ci.BACK?d.lam=ee(d.lam,-ge):this.face===ci.LEFT&&(d.lam=ee(d.lam,+ae))}return 0!==this.es&&(c=d.phi<0?1:0,u=Math.tan(d.phi),p=this.b/Math.sqrt(u*u+this.one_minus_f_squared),d.phi=Math.atan(Math.sqrt(this.a*this.a-p*p)/(this.one_minus_f*p)),c&&(d.phi=-d.phi)),d.lam+=this.long0,e.x=d.lam,e.y=d.phi,e},names:["Quadrilateralized Spherical Cube","Quadrilateralized_Spherical_Cube","qsc"]},di=[[1,22199e-21,-715515e-10,31103e-10],[.9986,-482243e-9,-24897e-9,-13309e-10],[.9954,-83103e-8,-448605e-10,-9.86701e-7],[.99,-.00135364,-59661e-9,36777e-10],[.9822,-.00167442,-449547e-11,-572411e-11],[.973,-.00214868,-903571e-10,1.8736e-8],[.96,-.00305085,-900761e-10,164917e-11],[.9427,-.00382792,-653386e-10,-26154e-10],[.9216,-.00467746,-10457e-8,481243e-11],[.8962,-.00536223,-323831e-10,-543432e-11],[.8679,-.00609363,-113898e-9,332484e-11],[.835,-.00698325,-640253e-10,9.34959e-7],[.7986,-.00755338,-500009e-10,9.35324e-7],[.7597,-.00798324,-35971e-9,-227626e-11],[.7186,-.00851367,-701149e-10,-86303e-10],[.6732,-.00986209,-199569e-9,191974e-10],[.6213,-.010418,883923e-10,624051e-11],[.5722,-.00906601,182e-6,624051e-11],[.5322,-.00677797,275608e-9,624051e-11]],mi=[[-520417e-23,.0124,121431e-23,-845284e-16],[.062,.0124,-1.26793e-9,4.22642e-10],[.124,.0124,5.07171e-9,-1.60604e-9],[.186,.0123999,-1.90189e-8,6.00152e-9],[.248,.0124002,7.10039e-8,-2.24e-8],[.31,.0123992,-2.64997e-7,8.35986e-8],[.372,.0124029,9.88983e-7,-3.11994e-7],[.434,.0123893,-369093e-11,-4.35621e-7],[.4958,.0123198,-102252e-10,-3.45523e-7],[.5571,.0121916,-154081e-10,-5.82288e-7],[.6176,.0119938,-241424e-10,-5.25327e-7],[.6769,.011713,-320223e-10,-5.16405e-7],[.7346,.0113541,-397684e-10,-6.09052e-7],[.7903,.0109107,-489042e-10,-104739e-11],[.8435,.0103431,-64615e-9,-1.40374e-9],[.8936,.00969686,-64636e-9,-8547e-9],[.9394,.00840947,-192841e-9,-42106e-10],[.9761,.00616527,-256e-6,-42106e-10],[1,.00328947,-319159e-9,-42106e-10]],fi=.8487,gi=1.3523,Ai=de/5,yi=1/Ai,vi=18,Ci=function(e,t){return e[0]+t*(e[1]+t*(e[2]+t*e[3]))},_i=function(e,t){return e[1]+t*(2*e[2]+3*t*e[3])},bi={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.es=0,this.title=this.title||"Robinson"},forward:function(e){var t=Ie(e.x-this.long0),i=Math.abs(e.y),r=Math.floor(i*Ai);r<0?r=0:r>=vi&&(r=vi-1),i=de*(i-yi*r);var n={x:Ci(di[r],i)*t,y:Ci(mi[r],i)};return e.y<0&&(n.y=-n.y),n.x=n.x*this.a*fi+this.x0,n.y=n.y*this.a*gi+this.y0,n},inverse:function(e){var t={x:(e.x-this.x0)/(this.a*fi),y:Math.abs(e.y-this.y0)/(this.a*gi)};if(t.y>=1)t.x/=di[vi][0],t.y=e.y<0?-ae:ae;else{var i=Math.floor(t.y*vi);for(i<0?i=0:i>=vi&&(i=vi-1);;)if(mi[i][0]>t.y)--i;else{if(!(mi[i+1][0]<=t.y))break;++i}var r=mi[i],n=5*(t.y-r[0])/(mi[i+1][0]-r[0]);n=te((function(e){return(Ci(r,e)-t.y)/_i(r,e)}),n,ue,100),t.x/=Ci(di[i],n),t.y=(5*i+n)*pe,e.y<0&&(t.y=-t.y)}return t.x=Ie(t.x+this.long0),t},names:["Robinson","robin"]},wi={init:function(){this.name="geocent"},forward:function(e){return P(e,this.es,this.a)},inverse:function(e){return S(e,this.es,this.a,this.b)},names:["Geocentric","geocentric","geocent","Geocent"]};return I.defaultDatum="WGS84",I.Proj=b,I.WGS84=new I.Proj("WGS84"),I.Point=K,I.toPoint=Ze,I.defs=h,I.transform=O,I.mgrs=rt,I.version="2.6.1-alpha",(nt=I).Proj.projections.add(ht),nt.Proj.projections.add(yt),nt.Proj.projections.add(Ct),nt.Proj.projections.add(Pt),nt.Proj.projections.add(St),nt.Proj.projections.add(xt),nt.Proj.projections.add(Bt),nt.Proj.projections.add(Mt),nt.Proj.projections.add(Et),nt.Proj.projections.add(Nt),nt.Proj.projections.add(Zt),nt.Proj.projections.add(Xt),nt.Proj.projections.add(Jt),nt.Proj.projections.add(Vt),nt.Proj.projections.add(qt),nt.Proj.projections.add(ei),nt.Proj.projections.add(ti),nt.Proj.projections.add(ii),nt.Proj.projections.add(ni),nt.Proj.projections.add(oi),nt.Proj.projections.add(si),nt.Proj.projections.add(ai),nt.Proj.projections.add(li),nt.Proj.projections.add(hi),nt.Proj.projections.add(pi),nt.Proj.projections.add(bi),nt.Proj.projections.add(wi),I}()},8588:(e,t,i)=>{"use strict";function r(e,t){return void 0!==t?typeof e===t:"object"!=typeof e&&"function"!=typeof e}function n(e,t,i){return Array.isArray(e)&&e.every((e=>r(e,i)))&&(void 0===t||e.length===t)}if(i.d(t,{OI:()=>n,tY:()=>r}),!Array.prototype.flat){function o(e){if(e.length<1||!e instanceof Array)return e;let t=[];for(let i of e.values())i instanceof Array?t=[...t,...o(i)]:t.push(i);return t}Array.prototype.flat=o}},9562:(e,t,i)=>{"use strict";i.d(t,{Z:()=>r});const r=function(e){if(0==e.length)return[];const t=[e[0],e[1]],i=e.length/2|0;for(let r=1;r<i;++r){const i=t.length;t[i-2]===e[2*r+0]&&t[i-1]===e[2*r+1]||t.push(e[2*r+0],e[2*r+1])}return t}},6700:(e,t,i)=>{var r={"./af":2786,"./af.js":2786,"./ar":867,"./ar-dz":4130,"./ar-dz.js":4130,"./ar-kw":6135,"./ar-kw.js":6135,"./ar-ly":6440,"./ar-ly.js":6440,"./ar-ma":7702,"./ar-ma.js":7702,"./ar-sa":6040,"./ar-sa.js":6040,"./ar-tn":7100,"./ar-tn.js":7100,"./ar.js":867,"./az":1083,"./az.js":1083,"./be":9808,"./be.js":9808,"./bg":8338,"./bg.js":8338,"./bm":7438,"./bm.js":7438,"./bn":6180,"./bn-bd":6225,"./bn-bd.js":6225,"./bn.js":6180,"./bo":1560,"./bo.js":1560,"./br":1278,"./br.js":1278,"./bs":622,"./bs.js":622,"./ca":2468,"./ca.js":2468,"./cs":5822,"./cs.js":5822,"./cv":877,"./cv.js":877,"./cy":7373,"./cy.js":7373,"./da":864,"./da.js":864,"./de":9740,"./de-at":217,"./de-at.js":217,"./de-ch":894,"./de-ch.js":894,"./de.js":9740,"./dv":5300,"./dv.js":5300,"./el":837,"./el.js":837,"./en-au":8348,"./en-au.js":8348,"./en-ca":7925,"./en-ca.js":7925,"./en-gb":2243,"./en-gb.js":2243,"./en-ie":6436,"./en-ie.js":6436,"./en-il":7207,"./en-il.js":7207,"./en-in":4175,"./en-in.js":4175,"./en-nz":6319,"./en-nz.js":6319,"./en-sg":1662,"./en-sg.js":1662,"./eo":2915,"./eo.js":2915,"./es":5655,"./es-do":5251,"./es-do.js":5251,"./es-mx":6112,"./es-mx.js":6112,"./es-us":1146,"./es-us.js":1146,"./es.js":5655,"./et":5603,"./et.js":5603,"./eu":7763,"./eu.js":7763,"./fa":6959,"./fa.js":6959,"./fi":1897,"./fi.js":1897,"./fil":2549,"./fil.js":2549,"./fo":4694,"./fo.js":4694,"./fr":4470,"./fr-ca":3049,"./fr-ca.js":3049,"./fr-ch":2330,"./fr-ch.js":2330,"./fr.js":4470,"./fy":5044,"./fy.js":5044,"./ga":9295,"./ga.js":9295,"./gd":2101,"./gd.js":2101,"./gl":8794,"./gl.js":8794,"./gom-deva":7884,"./gom-deva.js":7884,"./gom-latn":3168,"./gom-latn.js":3168,"./gu":5349,"./gu.js":5349,"./he":4206,"./he.js":4206,"./hi":94,"./hi.js":94,"./hr":316,"./hr.js":316,"./hu":2138,"./hu.js":2138,"./hy-am":1423,"./hy-am.js":1423,"./id":9218,"./id.js":9218,"./is":135,"./is.js":135,"./it":626,"./it-ch":150,"./it-ch.js":150,"./it.js":626,"./ja":9183,"./ja.js":9183,"./jv":4286,"./jv.js":4286,"./ka":2105,"./ka.js":2105,"./kk":7772,"./kk.js":7772,"./km":8758,"./km.js":8758,"./kn":3926,"./kn.js":3926,"./ko":3730,"./ko.js":3730,"./ku":1408,"./ku.js":1408,"./ky":3291,"./ky.js":3291,"./lb":6841,"./lb.js":6841,"./lo":5466,"./lo.js":5466,"./lt":7010,"./lt.js":7010,"./lv":7595,"./lv.js":7595,"./me":9861,"./me.js":9861,"./mi":5493,"./mi.js":5493,"./mk":5966,"./mk.js":5966,"./ml":7341,"./ml.js":7341,"./mn":5115,"./mn.js":5115,"./mr":370,"./mr.js":370,"./ms":9847,"./ms-my":1237,"./ms-my.js":1237,"./ms.js":9847,"./mt":2126,"./mt.js":2126,"./my":6165,"./my.js":6165,"./nb":4924,"./nb.js":4924,"./ne":6744,"./ne.js":6744,"./nl":3901,"./nl-be":9814,"./nl-be.js":9814,"./nl.js":3901,"./nn":3877,"./nn.js":3877,"./oc-lnc":2135,"./oc-lnc.js":2135,"./pa-in":5858,"./pa-in.js":5858,"./pl":4495,"./pl.js":4495,"./pt":9520,"./pt-br":7971,"./pt-br.js":7971,"./pt.js":9520,"./ro":6459,"./ro.js":6459,"./ru":238,"./ru.js":238,"./sd":950,"./sd.js":950,"./se":490,"./se.js":490,"./si":124,"./si.js":124,"./sk":4249,"./sk.js":4249,"./sl":4985,"./sl.js":4985,"./sq":1104,"./sq.js":1104,"./sr":9131,"./sr-cyrl":9915,"./sr-cyrl.js":9915,"./sr.js":9131,"./ss":5893,"./ss.js":5893,"./sv":8760,"./sv.js":8760,"./sw":1172,"./sw.js":1172,"./ta":7333,"./ta.js":7333,"./te":3110,"./te.js":3110,"./tet":2095,"./tet.js":2095,"./tg":7321,"./tg.js":7321,"./th":9041,"./th.js":9041,"./tk":9005,"./tk.js":9005,"./tl-ph":5768,"./tl-ph.js":5768,"./tlh":9444,"./tlh.js":9444,"./tr":2397,"./tr.js":2397,"./tzl":8254,"./tzl.js":8254,"./tzm":1106,"./tzm-latn":699,"./tzm-latn.js":699,"./tzm.js":1106,"./ug-cn":9288,"./ug-cn.js":9288,"./uk":7691,"./uk.js":7691,"./ur":3795,"./ur.js":3795,"./uz":6791,"./uz-latn":588,"./uz-latn.js":588,"./uz.js":6791,"./vi":5666,"./vi.js":5666,"./x-pseudo":4378,"./x-pseudo.js":4378,"./yo":5805,"./yo.js":5805,"./zh-cn":3839,"./zh-cn.js":3839,"./zh-hk":5726,"./zh-hk.js":5726,"./zh-mo":9807,"./zh-mo.js":9807,"./zh-tw":4152,"./zh-tw.js":4152};function n(e){var t=o(e);return i(t)}function o(e){if(!i.o(r,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return r[e]}n.keys=function(){return Object.keys(r)},n.resolve=o,e.exports=n,n.id=6700},5058:(e,t,i)=>{var r,n=i(5108),o=function(){function e(){this._registerList=new Map,this._registerList.set(r.ImageItem,new Map),this._registerList.set(r.GraphicItem,new Map),this._registerList.set(r.EfficentItem,new Map),this._registerList.set(r.TileItem,new Map)}return e.prototype.REGISTER=function(e,t){if(t){var i=this._registerList.get(e);if(i){var r=t.type;r?i.get(r)?n.warn("注册类".concat(t.name,"失败：已存在注册type：").concat(r,"一致的构造器")):i.set(r,t):n.warn("注册类".concat(t.name,"失败：注册类为设置有效type值例如: static get type() {return 'itemType'}"))}else n.warn("注册类".concat(t.name,"失败：无该注册类型").concat(e))}else n.warn("注册类为空")},e.prototype.GET_CONSTRUCTOR=function(e,t){var i=this._registerList.get(e);if(i){if(i.get(t))return i.get(t);n.warn("未找到".concat(t,"类型注册构造器"))}else n.warn("未找到".concat(e,"类型注册列表"))},e.prototype.GET_REGISTER_LIST=function(){return this._registerList},e}();!function(e){e.ImageItem="ImageItem",e.GraphicItem="GraphicItem",e.EfficentItem="EfficentItem",e.TileItem="TileItem"}(r||(r={}));var s=new o;window.GVOL||(window.GVOL={}),window.GVOL.REGISTER=s.REGISTER.bind(s)},6389:(e,t,i)=>{"use strict";var r={};i.r(r),i.d(r,{bindDegreeRadian:()=>zs,bindPosition:()=>Zs,bindRotation:()=>Ys});var n=i(5108);const o=(new Date).toLocaleString(),s=`\n------------------------------------------\n\ngeovisearth.sdk.js\n\nhttps://geovisearth.com/\n\n版本日期：${o}\n授权使用：无\n网址限制：无\n\nCopyright @中科星图 版权所有\n由中科星图股份有限公司与中科星图数字地球合肥有限公司联合运营\n-------------------------------------------\n`;const a={source:"中科星图股份有限公司",dest:"无",restrict:"无".split("/").join(" "),info:s,date:o,_printVersion:function(){n.log(`%c🌌%c\nGeovis Earth SDK %c\n天眼感知世界，创新、融合、奋斗、幸福！%c\n\n版本号：V1.0.1\n编译日期：${o}\nCesium版本号：${Cesium.VERSION}\n授权信息：无\n限制网址：${"无".split("/").join(" ")}\n\nGeovis Earth SDK 网址: https://sdk.geovisearth.com/ 🌏\nCopyright @中科星图 版权所有\n由中科星图股份有限公司与中科星图数字地球合肥有限公司联合运营\n\n`,'\n\tfont-size: 100px;\n\tline-height: 1.5;\n\tfont-weight: 1000;\n\tfont-family: "微软雅黑";\n\tcolor: rgb(0, 120, 215);\n','\n\tfont-size: 25px;\n\tline-height: 1.5;\n\tfont-weight: 1000;\n\tfont-family: "微软雅黑";\n\tcolor: rgb(0, 120, 215);\n','\n\tfont-size: 14px;\n\tline-height: 1.5;\n\tfont-family: "微软雅黑";\n\tfont-style: italic;\n\tcolor: rgb(0, 120, 215);\n\tpadding-bottom: 20px;\n','\n\tfont-size: 12px;\n\tline-height: 1.5;\n\tfont-family: "微软雅黑";\n\tcolor: rgb(0, 120, 215);\n\t')}};i(5058);var l,h=i(1071),c=i(3192),u=i(7139),p=function(){function e(){}return e.prototype.on=function(e,t,i){return this._on(e,t,i),this},e.prototype._on=function(e,t,i){this._events=this._events||{};var r=this._events[e];r||(r=[],this._events[e]=r),i===this&&(i=void 0);for(var n={fn:t,ctx:i},o=r,s=0,a=o.length;s<a;s++)if(o[s].fn===t&&o[s].ctx===i)return;o.push(n)},e.prototype.off=function(e,t,i){e?this._off(e,t,i):delete this._events},e.prototype._off=function(e,t,i){if(this._events){var r=this._events[e];if(r)if(t){for(var n=0,o=r.length;n<o;n++)if(t===r[n].fn&&i===r[n].context)return void r.splice(n,1)}else delete this._events}},e.prototype.fire=function(e,t){if(!this.listens(e))return this;if(this._events){var i=this._events[e];if(i){this._firingCount=this._firingCount+1||1;for(var r=0,n=i.length;r<n;r++){var o=i[r];o.fn.call(o.ctx||this,t)}this._firingCount--}}return this},e.prototype.listens=function(e){var t=this._events&&this._events[e];return!!(t&&t.length>0)},e}(),d=(l=function(e,t){return l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},l(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}l(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),m=function(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],r=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},f=function(e){function t(){var t=e.call(this)||this;return t._itemList=[],t}return d(t,e),t.prototype.add=function(e){return this._itemList.push(e),this.fire("add",e),e},t.prototype.remove=function(e){var t=this.getItemById(e);if(t){var i=this._itemList.indexOf(t);return this._itemList.splice(i,1),this.fire("remove",t),t}},t.prototype.getItemById=function(e){var t=this._itemList.filter((function(t){if(t.id===e)return!0}));if(t.length)return t[0]},t.prototype.getItemByName=function(e){var t=this._itemList.filter((function(t){if(t.name===e)return!0}));if(t.length)return t[0]},t.prototype.toJson=function(){var e,t,i=[];try{for(var r=m(this._itemList),n=r.next();!n.done;n=r.next()){var o=n.value;i.push(o.toJson())}}catch(t){e={error:t}}finally{try{n&&!n.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}return i},t.prototype.parseJson=function(e){},t.prototype.getItemList=function(){return this._itemList},t}(p),g=i(5108),A=function(){function e(e,t,i,r){this.lon=0,this.lat=0,this.alt=0,this.lon=e,this.lat=t,this.time=r,this.alt=i}return e.prototype.toJson=function(){return[this.lon,this.lat,this.alt]},e._transformlat=function(e,t){var i=3.141592653589793,r=2*e-100+3*t+.2*t*t+.1*e*t+.2*Math.sqrt(Math.abs(e));return r+=2*(20*Math.sin(6*e*i)+20*Math.sin(2*e*i))/3,r+=2*(20*Math.sin(t*i)+40*Math.sin(t/3*i))/3,r+=2*(160*Math.sin(t/12*i)+320*Math.sin(t*i/30))/3},e._transformlng=function(e,t){var i=3.141592653589793,r=300+e+2*t+.1*e*e+.1*e*t+.1*Math.sqrt(Math.abs(e));return r+=2*(20*Math.sin(6*e*i)+20*Math.sin(2*e*i))/3,r+=2*(20*Math.sin(e*i)+40*Math.sin(e/3*i))/3,r+=2*(150*Math.sin(e/12*i)+300*Math.sin(e/30*i))/3},e.fromCartesian3=function(t){var i=Cesium.Ellipsoid.WGS84.cartesianToCartographic(t),r=Cesium.Math.toDegrees(i.latitude);return new e(Cesium.Math.toDegrees(i.longitude),r,i.height)},e.toCartesian3=function(e){var t=Cesium.Cartographic.fromDegrees(e.lon,e.lat,e.alt);return Cesium.Ellipsoid.WGS84.cartographicToCartesian(t)},e.fromMercator=function(t,i){var r=i/20037508.34*180;return new e(t/20037508.34*180,r=180/Math.PI*(2*Math.atan(Math.exp(r*Math.PI/180))-Math.PI/2))},e.toMercator=function(e){var t={x:0,y:0},i=6378137;t.x=e.lon*Math.PI/180*i;var r=e.lat*Math.PI/180;return t.y=3189068.5*Math.log((1+Math.sin(r))/(1-Math.sin(r))),t},e.fromScreen=function(e,t,i){var r,n=new Cesium.Cartesian2(e,t);try{return r=i.scene.globe.pick(i.camera.getPickRay(n),i.scene),this.fromCartesian3(r)}catch(e){g.log("fromScreen:输入的x，y值未在地球上找到相应经纬度值")}},e.toScreen=function(t,i){var r=e.toCartesian3(t);return Cesium.SceneTransforms.wgs84ToWindowCoordinates(i.scene,r)},e.fromGCJ02=function(t){var i=3.141592653589793,r=6378245,n=.006693421622965943,o=e._transformlat(t.x-105,t.y-35),s=e._transformlng(t.x-105,t.y-35),a=t.y/180*i,l=Math.sin(a);l=1-n*l*l;var h=Math.sqrt(l);o=180*o/(r*(1-n)/(l*h)*i),s=180*s/(r/h*Math.cos(a)*i);var c=t.y+o,u=t.x+s;return new e(2*t.x-u,2*t.y-c)},e.toGCJ02=function(t){var i=3.141592653589793,r=6378245,n=.006693421622965943,o=e._transformlat(t.lon-105,t.lat-35),s=e._transformlng(t.lon-105,t.lat-35),a=t.lat/180*i,l=Math.sin(a);l=1-n*l*l;var h=Math.sqrt(l);o=180*o/(r*(1-n)/(l*h)*i),s=180*s/(r/h*Math.cos(a)*i);var c=t.lat+o;return{x:t.lon+s,y:c}},e.pack=function(e){var t=[];return t.push(e.lon),t.push(e.lat),e.alt&&t.push(e.alt),t},e.unpack=function(t){var i,r=t.length;if(2==r)for(var n=0;n<r-1;n+=2)i=new e(t[n],t[n+1]);else if(3==r)for(n=0;n<r-2;n+=3)i=new e(t[n],t[n+1],t[n+2]);else g.warn("GvolPoint数据不规范");return i},e.packArray=function(e){var t=this;return e.map((function(e){return t.pack(e)}))},e.unpackArray=function(e){var t=this;return e.map((function(e){return t.unpack(e)}))},e.isEqual=function(t,i){return t===i||t instanceof e&&i instanceof e&&(t.lon===i.lon&&(t.lat===i.lat&&t.alt===i.alt))},e.isEqualArr=function(t,i){if(t===i)return!0;if(!(t instanceof Array&&i instanceof Array))return!1;if(t.length!=t.length)return!1;for(var r=0;r<t.length;r++)if(!e.isEqual(t[r],i[r]))return!1;return!0},e.clone=function(t,i){return i?(i.lon=t.lon,i.lat=t.lat,i.alt=t.alt,i):new e(t.lon,t.lat,t.alt)},e._formatDegree=function(e){e=Math.abs(e);var t=Math.floor(e);return[t,Math.floor(60*(e-t)),Math.round(3600*(e-t)%60)]},e._degreeConvertBack=function(e){var t=0;return t+=e[0],t+=e[1]/60,t+=e[2]/3600},e.formatDegree=function(t){var i=new y;t.lon<0?i.lon.direction="west":i.lon.direction="east";var r=e._formatDegree(t.lon);i.lon.degrees=r[0],i.lon.minutes=r[1],i.lon.seconds=r[2],t.lat<0?i.lat.direction="south":i.lat.direction="north";var n=e._formatDegree(t.lat);return i.lat.degrees=n[0],i.lat.minutes=n[1],i.lat.seconds=n[2],i},e.degreeConvertBack=function(t){var i=e._degreeConvertBack([t.lon.degrees,t.lon.minutes,t.lon.seconds]);"west"===t.lon.direction&&(i=-i);var r=e._degreeConvertBack([t.lat.degrees,t.lat.minutes,t.lat.seconds]);return"west"===t.lat.direction&&(r=-r),new e(i,r)},e}(),y=function(){};var v=i(5108);function C(e,t){const i=new Cesium.ClearCommand({pass:7});return i.boundingVolume=new Cesium.BoundingSphere,i.cull=!1,i._renderParams={},i.renderState=Cesium.RenderState.fromCache({}),i.execute=(r,n)=>{if(i.renderCallback){!function(e,t,i,r){var n=e._currentRenderState,o=e._currentPassState;e._currentRenderState=t,e._currentPassState=i,Cesium.RenderState.partialApply(e._gl,n,t,o,i,r)}(r,i.renderState,n,!1),i._renderParams.gl=r._gl,i._renderParams.owner=e,i._renderParams.id=t,i._renderParams.czm=i._renderParams.czm||{},i._renderParams.czm.context=r,i._renderParams.czm.passState=n,i._renderParams.czm.renderState=i.renderState,i._renderParams.czm.frameState=i.frameState,i._renderParams.czm.uniformState=r.uniformState,i._renderParams.czm.useLogDepth=i.frameState.useLogDepth;try{i.renderCallback(i._renderParams)}catch(e){v.log("renderCallback执行有错: "+e)}}},i}class _{constructor(){this.show=!0,this.commands=[]}update(e){this.show&&this.commands.forEach((t=>{t.frameState=e,e.commandList.push(t)}))}isDestroyed(){return!1}destroy(){return this.commands.length=0,Cesium.destroyObject(this)}}_.createCommand=C;const b={GvolBase:h.Z,GvolObject:c.Z,GvolGeoBase:u.Z,GvolLayer:f,GvolPoint:A,Event:p,CommandPrimitive:_};var w=i(1911),P=i(2188);class S extends h.Z{constructor(){super()}destroy(){return super.destroy()}}S.defaultOptions={url:"",requestVertexNormals:!1,requestWaterMask:!1,requestMetadata:!0};S.gvolSchema={title:"XbsjCesiumTerrainProvider Property",type:"object",properties:{url:{type:"string",title:"url",default:"",description:"url"},requestVertexNormals:{type:"boolean",title:"requestVertexNormals",default:!1,description:"requestVertexNormals"},requestWaterMask:{type:"boolean",title:"requestWaterMask",default:!1,description:"requestWaterMask"},requestMetadata:{type:"boolean",title:"requestMetadata",default:!0,description:"requestMetadata"}}},S.gvolClassification=[{name:{chinese:"通用",english:"General"},properties:["url","requestVertexNormals","requestWaterMask","requestMetadata"]}];const x=S;class B extends h.Z{constructor(){super()}destroy(){return super.destroy()}}B.defaultOptions={url:""};B.gvolSchema={title:"GoogleEarthEnterpriseTerrainProvider Property",type:"object",properties:{url:{type:"string",title:"url",default:"",description:"url"}}},B.gvolClassification=[{name:{chinese:"通用",english:"General"},properties:["url"]}];const M=B;class E extends h.Z{constructor(){super()}}E.defaultOptions={tilingScheme:"GeographicTilingScheme"};E.gvolSchema={title:"XbsjEllipsoidTerrainProvider Property",type:"object",properties:{tilingScheme:{type:"string",default:"GeographicTilingScheme",enum:["GeographicTilingScheme","WebMercatorTilingScheme"],description:"tilingScheme类型"}}},E.gvolClassification=[{name:{chinese:"通用",english:"General"},properties:["tilingScheme"]}];const T={XbsjCesiumTerrainProvider:x,XbsjEllipsoidTerrainProvider:E,GoogleEarthEnterpriseTerrainProvider:M};var O=i(8660);class L extends u.Z{constructor(e,t){super(e,t);const i=e.czm.scene;this._scene=i,e._gvolTerrains.push(this),this._terrainProvider=void 0,this._disposers=[],this._disposers.push((0,O.Z)(this,"enabled",this,"show")),h.Z.registerProperty(this,"gvolTerrainProvider",L.defaultOptions.gvolTerrainProvider),this.gvolTerrainProvider.XbsjCesiumTerrainProvider=new T.XbsjCesiumTerrainProvider,this.gvolTerrainProvider.XbsjEllipsoidTerrainProvider=new T.XbsjEllipsoidTerrainProvider,this.gvolTerrainProvider.GoogleEarthEnterpriseTerrainProvider=new T.GoogleEarthEnterpriseTerrainProvider,h.Z.registerProperty(this.gvolTerrainProvider,"XbsjCesiumTerrainProvider"),h.Z.registerProperty(this.gvolTerrainProvider,"XbsjEllipsoidTerrainProvider"),h.Z.registerProperty(this.gvolTerrainProvider,"GoogleEarthEnterpriseTerrainProvider"),this._disposers.push((0,P.reaction)((()=>{let e={_opt:this.gvolTerrainProvider[this.gvolTerrainProvider.type]};return{provider:this.gvolTerrainProvider,type:this.gvolTerrainProvider.type,providerOptions:e}}),(()=>{if("XbsjCesiumTerrainProvider"===this.gvolTerrainProvider.type){const e=this.gvolTerrainProvider.XbsjCesiumTerrainProvider;let t=e.url;if(e.url.startsWith("Ion(")){let i=/Ion\((\d+)/.exec(e.url),r=i[1]&&+i[1];r&&(t=Cesium.IonResource.fromAssetId(r))}this._terrainProvider=new Cesium.CesiumTerrainProvider({url:t,requestVertexNormals:e.requestVertexNormals,requestWaterMask:e.requestWaterMask,requestMetadata:e.requestMetadata})}else if("XbsjEllipsoidTerrainProvider"===this.gvolTerrainProvider.type){"WebMercatorTilingScheme"===this.gvolTerrainProvider.XbsjEllipsoidTerrainProvider.tilingScheme?this._terrainProvider=new Cesium.EllipsoidTerrainProvider({tilingScheme:new Cesium.WebMercatorTilingScheme}):this._terrainProvider=new Cesium.EllipsoidTerrainProvider}else{if("GoogleEarthEnterpriseTerrainProvider"!==this.gvolTerrainProvider.type)throw new Error("gvolTerrainProvider 未知类型！");{let e=this.gvolTerrainProvider.GoogleEarthEnterpriseTerrainProvider.url;this._terrainProvider=new Cesium.GoogleEarthEnterpriseTerrainProvider({url:e})}}this._terrainProvider&&(this._terrainProvider.show=this.show),this._earth._gvolTerrainZIndexDirty=!0}),{fireImmediately:!0})),this._disposers.push((0,P.autorun)((()=>{const e=this.show;this._terrainProvider&&(this._terrainProvider.show=e)}))),this._disposers.push((0,P.reaction)((()=>[this.show,this.gvolZIndex]),(()=>{this._earth._gvolTerrainZIndexDirty=!0}),{fireImmediately:!0}))}flyTo(){this.rectangle&&4===this.rectangle.length&&this._scene.camera.flyTo({destination:new Cesium.Rectangle(...this.rectangle)})}gvolFromJSON(e){return super.gvolFromJSON(e)}isDestroyed(){return!1}destroy(){const e=this._earth._gvolTerrains.indexOf(this);if(-1===e)throw new Error("this._earth._gvolTerrains must contain!");return this._earth._gvolTerrains.splice(e,1),this._terrainProvider=void 0,this._earth._gvolTerrainZIndexDirty=!0,this._disposers.forEach((e=>e())),this._disposers.length=0,super.destroy()}}L.TerrainProvider=T,L.defaultOptions={gvolTerrainProvider:{type:"XbsjEllipsoidTerrainProvider",XbsjEllipsoidTerrainProvider:null,XbsjCesiumTerrainProvider:null,GoogleEarthEnterpriseTerrainProvider:null},gvolZIndex:0,show:!0,rectangle:[-Math.PI,.5*-Math.PI,Math.PI,.5*Math.PI]};const D={title:"Terrain Property",type:"object",properties:{gvolTerrainProvider:{type:"object",title:"地形资源提供",description:"地形资源提供",properties:{type:{type:"string",default:"XbsjEllipsoidTerrainProvider",enum:["XbsjEllipsoidTerrainProvider","XbsjCesiumTerrainProvider","GoogleEarthEnterpriseTerrainProvider"],description:"provider类型"},XbsjEllipsoidTerrainProvider:T.XbsjEllipsoidTerrainProvider.gvolSchema,XbsjCesiumTerrainProvider:T.XbsjCesiumTerrainProvider.gvolSchema,GoogleEarthEnterpriseTerrainProvider:T.GoogleEarthEnterpriseTerrainProvider.gvolSchema}},gvolZIndex:{type:"number",title:"显示优先级",default:0,description:"显示优先级"},show:{type:"boolean",title:"显示",default:!0,description:"显示"},rectangle:{type:"array",title:"作用范围 [西, 南, 东, 北]",default:[-Math.PI,.5*-Math.PI,Math.PI,.5*Math.PI],description:"作用范围 [西, 南, 东, 北]"}}};L.gvolSchema=D;L.gvolClassification=[{name:{chinese:"通用",english:"General"},properties:["show","gvolTerrainProvider","gvolZIndex","rectangle"]}],c.Z.registerType(L,"Terrain");const I=L;var R=i(3765);const H=[{name:{chinese:"通用",english:"General"},properties:["show","alpha","brightness","contrast","hue","saturation","gamma","colorToAlphaThreshold","splitDirection","rectangle","gvolZIndex","gvolImageryProvider"]},{name:{chinese:"调试",english:"Debug"},properties:[]}];class F extends h.Z{constructor(){super(),(0,P.extendObservable)(this,{_imageryProvider:void 0,get provider(){return this._imageryProvider}},{_imageryProvider:P.observable.ref,provider:P.computed}),this._disposers=[],this._disposers.push((0,P.autorun)((()=>{this._imageryProvider=this.createImageryProvider()})))}createImageryProvider(){const e=null!=this.rectangle?Cesium.Rectangle.fromRadians(...this.rectangle):this.rectangle;let t;e&&(e=Cesium.Rectangle.MAX_VALUE),"WebMercator"===this.tilingScheme?t=new Cesium.WebMercatorTilingScheme:"Geographic"===this.tilingScheme&&(t=new Cesium.GeographicTilingScheme);let i={url:this.url,rectangle:e,token:this.token,layers:this.layers,tileWidth:this.tileWidth,tileHeight:this.tileHeight,tilingScheme:t,credit:this.credit,maximumLevel:this.maximumLevel};if(this.token||delete i.token,!this.url)return;return new Cesium.ArcGisMapServerImageryProvider(i)}destory(){this._disposers.forEach((e=>e())),this._disposers.length=0}}F.defaultOptions={url:"",rectangle:void 0,token:"",layers:"",tileWidth:256,tileHeight:256,tilingScheme:"Geographic",credit:"",maximumLevel:18};F.gvolSchema={title:"ArcGisMapServerImageryProvider Property",type:"object",properties:{url:{type:"string",title:"url",default:"",description:"url"},token:{type:"string",title:"token",default:"",description:"token"},layers:{type:"string",title:"layers",default:"",description:"layers"},tileWidth:{type:"number",title:"tileWidth",default:"256",description:"tileWidth"},tileHeight:{type:"number",title:"tileHeight",default:"256",description:"tileHeight"},tilingScheme:{type:"string",title:"tilingScheme",default:"WebMercator",description:"tilingScheme"},credit:{type:"string",title:"credit",default:"",description:"credit"},rectangle:{type:"string",title:"rectangle",default:"undefined",description:"rectangle"},maximumLevel:{type:"number",title:"maximumLevel",default:"0",description:"maximumLevel"}}},F.gvolClassification=[{name:{chinese:"通用",english:"General"},properties:["url","rectangle","token","layers","tileWidth","tileHeight","tilingScheme","credit","maximumLevel"]}];const N=F;class Q extends h.Z{constructor(){super(),(0,P.extendObservable)(this,{_imageryProvider:void 0},{_imageryProvider:P.observable.ref}),this._disposers=[];const e=()=>{this._imageryProvider=this.createImageryProvider()};e(),this._disposers.push((0,P.reaction)((()=>({url:this.url,rectangle:this.rectangle&&[...this.rectangle],tilingScheme:this.tilingScheme})),e))}get provider(){return this._imageryProvider}createImageryProvider(){const e=null!=this.rectangle?Cesium.Rectangle.fromRadians(...this.rectangle):this.rectangle;let t;"WebMercator"===this.tilingScheme?t=new Cesium.WebMercatorTilingScheme:"Geographic"===this.tilingScheme&&(t=new Cesium.GeographicTilingScheme);return new Cesium.UrlTemplateImageryProvider({url:this.url,rectangle:e,tilingScheme:t,minimumLevel:this.minimumLevel,maximumLevel:this.maximumLevel})}destory(){this._disposers.forEach((e=>e())),this._disposers.length=0}}Q.defaultOptions={url:"",rectangle:void 0,tilingScheme:"WebMercator",minimumLevel:0,maximumLevel:void 0};const k={title:"UrlTemplateImageryProvider Property",type:"object",properties:{url:{type:"string",title:"url",default:"",description:"url"},rectangle:{type:"array | undefined",items:{type:"number",minimum:-Math.PI,maximum:Math.PI},minItems:4,maxItems:4,default:void 0,description:"rectangle"},tilingScheme:{type:"string",title:"tilingScheme",default:"WebMercator",description:"tilingScheme"},minimumLevel:{type:"string",title:"minimumLevel",default:"0",description:"minimumLevel"},maximumLevel:{type:"string",title:"maximumLevel",default:"undefined",description:"maximumLevel"}}};Q.gvolSchema=k,Q.gvolClassification=[{name:{chinese:"通用",english:"General"},properties:["url","rectangle","tilingScheme"]}];const U=Q;class j extends h.Z{constructor(){super(),(0,P.extendObservable)(this,{_imageryProvider:void 0,get provider(){return this._imageryProvider}},{_imageryProvider:P.observable.ref,provider:P.computed}),this._disposers=[],this._disposers.push((0,P.autorun)((()=>{this._imageryProvider=this.createImageryProvider()})))}createImageryProvider(){const e=null!=this.rectangle?Cesium.Rectangle.fromRadians(...this.rectangle):this.rectangle;let t;"WebMercator"===this.tilingScheme?t=new Cesium.WebMercatorTilingScheme:"Geographic"===this.tilingScheme&&(t=new Cesium.GeographicTilingScheme);const i=this.tileMatrixLabels||void 0;return new Cesium.WebMapTileServiceImageryProvider({url:this.url,format:this.format,layer:this.layer,style:this.style,tileMatrixSetID:this.tileMatrixSetID,tileMatrixLabels:i,tileWidth:this.tileWidth,tileHeight:this.tileHeight,tilingScheme:t,rectangle:e,minimumLevel:this.minimumLevel,maximumLevel:this.maximumLevel})}destory(){this._disposers.forEach((e=>e())),this._disposers.length=0}}j.defaultOptions={url:"",format:"image/jpeg",layer:"",style:"",tileMatrixSetID:"",tileMatrixLabels:"",tileWidth:256,tileHeight:256,tilingScheme:"WebMercator",rectangle:void 0,minimumLevel:0,maximumLevel:18};j.gvolSchema={title:"WebMapTileServiceImageryProvider Property",type:"object",properties:{url:{type:"string",title:"url",default:"",description:"url"},format:{type:"string",title:"format",default:"image/jpeg",description:"format"},layer:{type:"string",title:"layer",default:"",description:"layer"},style:{type:"string",title:"style",default:"",description:"style"},tileMatrixSetID:{type:"string",title:"tileMatrixSetID",default:"",description:"tileMatrixSetID"},tileMatrixLabels:{type:"string",title:"tileMatrixLabels",default:"",description:"tileMatrixLabels"},tileWidth:{type:"number",title:"tileWidth",default:"256",description:"tileWidth"},tileHeight:{type:"number",title:"tileHeight",default:"256",description:"tileHeight"},tilingScheme:{type:"string",title:"tilingScheme",default:"WebMercator",description:"tilingScheme"},rectangle:{type:"string",title:"url",default:"undefined",description:"url"},minimumLevel:{type:"number",title:"minimumLevel",default:0,description:"minimumLevel"},maximumLevel:{type:"number",title:"maximumLevel",default:24,description:"maximumLevel"}}},j.gvolClassification=[{name:{chinese:"通用",english:"General"},properties:["url","format","layer","style","tileMatrixSetID","tileMatrixLabels","tileWidth","tileHeight","tilingScheme","rectangle","minimumLevel","maximumLevel"]}];const G=j;class z extends h.Z{constructor(){super(),(0,P.extendObservable)(this,{_imageryProvider:void 0},{_imageryProvider:P.observable.ref}),this._disposers=[],this._disposers.push((0,P.autorun)((()=>{this._imageryProvider=this.createImageryProvider()})))}get provider(){return this._imageryProvider}createImageryProvider(){let e;"WebMercator"===this.tilingScheme?e=new Cesium.WebMercatorTilingScheme:"Geographic"===this.tilingScheme&&(e=new Cesium.GeographicTilingScheme);const t=null!=this.rectangle?Cesium.Rectangle.fromRadians(...this.rectangle):this.rectangle;return Cesium.XbsjImageryProviderTools.createImageryProvider({uri:this.url,srcCoordType:this.srcCoordType,dstCoordType:this.dstCoordType,rectangle:t,minimumLevel:this.minimumLevel,maximumLevel:this.maximumLevel,tilingScheme:e})}destory(){this._disposers.forEach((e=>e())),this._disposers.length=0}}z.defaultOptions={url:"",srcCoordType:"WGS84",dstCoordType:"WGS84",rectangle:void 0,tilingScheme:"WebMercator",minimumLevel:0,maximumLevel:18};const Y={title:"XbsjImageryProvider Property",type:"object",properties:{url:{type:"string",title:"url",default:"",description:"url"},srcCoordType:{type:"string",title:"srcCoordType",default:"WGS84",description:"srcCoordType"},dstCoordType:{type:"string",title:"dstCoordType",default:"WGS84",description:"dstCoordType"},rectangle:{type:"array",items:{type:"number",minimum:-Math.PI,maximum:Math.PI},minItems:4,maxItems:4,default:void 0,description:"rectangle"},minimumLevel:{type:"number",title:"minimumLevel",default:0,description:"最小级别"},maximumLevel:{type:"number",title:"maximumLevel",default:18,description:"最大级别"}}};z.gvolSchema=Y,z.gvolClassification=[{name:{chinese:"通用",english:"General"},properties:["url","srcCoordType","dstCoordType","rectangle","minimumLevel","maximumLevel"]}];const Z=z;class W extends h.Z{constructor(){super(),(0,P.extendObservable)(this,{_imageryProvider:void 0},{_imageryProvider:P.observable.ref}),this._disposers=[],this._disposers.push((0,P.autorun)((()=>{this._imageryProvider=this.createImageryProvider()})))}get provider(){return this._imageryProvider}createImageryProvider(){if(!this.url)return;const e=this.rectangle&&Cesium.Rectangle.fromRadians(...this.rectangle);return new Cesium.TileMapServiceImageryProvider({url:this.url,rectangle:e,fileExtension:this.fileExtension,maximumLevel:this.maximumLevel})}destory(){this._disposers.forEach((e=>e())),this._disposers.length=0}}W.defaultOptions={url:"",fileExtension:"png",maximumLevel:void 0,rectangle:void 0};const X={title:"TileMapServiceImageryProvider Property",type:"object",properties:{url:{type:"string",title:"url",default:"",description:"url"},rectangle:{type:["array","null"],items:{type:"number",minimum:-Math.PI,maximum:Math.PI},minItems:4,maxItems:4,default:null,description:"rectangle"},fileExtension:{type:"string",title:"fileExtension",default:"png",description:"fileExtension"},maximumLevel:{type:["integer","null"],title:"maximumLevel",default:null,description:"maximumLevel"}}};W.gvolSchema=X,W.gvolClassification=[{name:{chinese:"通用",english:"General"},properties:["url","rectangle","fileExtension","maximumLevel"]}];const J=W;class K extends h.Z{constructor(){super(),(0,P.extendObservable)(this,{_imageryProvider:void 0,get provider(){return this._imageryProvider}},{_imageryProvider:P.observable.ref,provider:P.computed}),this._disposers=[],this._disposers.push((0,P.autorun)((()=>{this._imageryProvider=this.createImageryProvider()})))}createImageryProvider(){const e=null!=this.rectangle?Cesium.Rectangle.fromRadians(...this.rectangle):this.rectangle;let t;"WebMercator"===this.tilingScheme?t=new Cesium.WebMercatorTilingScheme:"Geographic"===this.tilingScheme&&(t=new Cesium.GeographicTilingScheme);const i=this.tileMatrixLabels||void 0;return new Cesium.WebMapServiceImageryProvider({url:this.url,format:this.format,layers:this.layers,credit:this.credit,style:this.style,tileMatrixSetID:this.tileMatrixSetID,tileMatrixLabels:i,tileWidth:this.tileWidth,tileHeight:this.tileHeight,tilingScheme:t,rectangle:e,minimumLevel:this.minimumLevel,maximumLevel:this.maximumLevel,enablePickFeatures:!1,crs:this.crs,srs:this.srs})}destory(){this._disposers.forEach((e=>e())),this._disposers.length=0}}K.defaultOptions={url:"",format:"image/jpeg",layers:"",credit:"",style:"",tileMatrixSetID:"",tileMatrixLabels:"",tileWidth:256,tileHeight:256,tilingScheme:"WebMercator",rectangle:void 0,minimumLevel:0,maximumLevel:18,crs:"",srs:""};K.gvolSchema={title:"WebMapServiceImageryProvider Property",type:"object",properties:{url:{type:"string",title:"url",default:"",description:"url"},format:{type:"string",title:"format",default:"image/jpeg",description:"format"},layers:{type:"string",title:"layers",default:"",description:"layers"},credit:{type:"string",title:"credit",default:"",description:"credit"},style:{type:"string",title:"style",default:"",description:"style"},tileMatrixSetID:{type:"string",title:"tileMatrixSetID",default:"",description:"tileMatrixSetID"},tileMatrixLabels:{type:"string",title:"tileMatrixLabels",default:"",description:"tileMatrixLabels"},tileWidth:{type:"number",title:"tileWidth",default:"256",description:"tileWidth"},tileHeight:{type:"number",title:"tileHeight",default:"256",description:"tileHeight"},tilingScheme:{type:"string",title:"tilingScheme",default:"WebMercator",description:"tilingScheme"},rectangle:{type:"string",title:"url",default:"undefined",description:"url"},minimumLevel:{type:"string",title:"minimumLevel",default:"0",description:"minimumLevel"},maximumLevel:{type:"string",title:"maximumLevel",default:"0",description:"maximumLevel"},crs:{type:"string",title:"crs",default:"",description:"crs"},srs:{type:"string",title:"srs",default:"",description:"srs"}}},K.gvolClassification=[{name:{chinese:"通用",english:"General"},properties:["url","format","layers","credit","style","tileMatrixSetID","tileMatrixLabels","tileWidth","tileHeight","tilingScheme","rectangle","minimumLevel","maximumLevel","crs","srs"]}];const V=K;class q extends h.Z{constructor(){super(),(0,P.extendObservable)(this,{_imageryProvider:void 0},{_imageryProvider:P.observable.ref}),this._disposers=[];this._disposers.push((0,P.reaction)((()=>({url:this.url})),(()=>{this._imageryProvider=this.createImageryProvider()})))}get provider(){return this._imageryProvider||(this._imageryProvider=this.createImageryProvider()),this._imageryProvider}createImageryProvider(){return new Cesium.GoogleEarthEnterpriseImageryProvider({url:this.url})}destory(){this._disposers.forEach((e=>e())),this._disposers.length=0}}q.defaultOptions={url:""};q.gvolSchema={title:"GoogleEarthEnterpriseImageryProvider Property",type:"object",properties:{url:{type:"string",title:"url",default:"",description:"url"}}},q.gvolClassification=[{name:{chinese:"通用",english:"General"},properties:["url"]}];const $={UrlTemplateImageryProvider:U,XbsjImageryProvider:Z,WebMapServiceImageryProvider:V,WebMapTileServiceImageryProvider:G,TileMapServiceImageryProvider:J,ArcGisMapServerImageryProvider:N,GoogleEarthEnterpriseImageryProvider:q},ee={title:"Imagery Property",type:"object",properties:{show:{type:"boolean",title:"show",default:!0,description:"是否在三维窗口中显示"},alpha:{type:"number",title:"alpha",default:1,description:"The alpha blending value of this layer, from 0.0 to 1.0."},brightness:{type:"number",title:"brightness",default:1,description:"The brightness of this layer.  1.0 uses the unmodified imagery"},contrast:{type:"number",title:"contrast",default:1,description:"The contrast of this layer.  1.0 uses the unmodified imagery color."},hue:{type:"number",title:"hue",default:0,description:"The hue of this layer.  0.0 uses the unmodified imagery color."},saturation:{type:"number",title:"saturation",default:1,description:"The saturation of this layer.  1.0 uses the unmodified imagery color."},gamma:{type:"number",title:"gamma",default:1,description:"The gamma correction to apply to this layer.  1.0 uses the unmodified imagery color."},colorToAlphaThreshold:{type:"number",title:"colorToAlphaThreshold",default:.004,description:"Threshold for color-to-alpha."},splitDirection:{type:"string",enum:["ImagerySplitDirection.NONE","ImagerySplitDirection.LEFT","ImagerySplitDirection.RIGHT"],title:"splitDirection",default:"ImagerySplitDirection.NONE",description:"The ImagerySplitDirection split to apply to this layer."},rectangle:{type:["array","undefined"],title:"rectangle",items:{type:"number"},default:void 0,minItems:4,maxItems:4,uniqueItems:!1,description:"The rectangle of the layer.  This rectangle can limit the visible portion of the imagery provider."},gvolImageryProvider:{type:"object",title:"gvolImageryProvider",description:"影像资源信息配置",properties:{type:{type:"string",default:"XbsjImageryProvider",enum:["XbsjImageryProvider","UrlTemplateImageryProvider","WebMapServiceImageryProvider","WebMapTileServiceImageryProvider","TileMapServiceImageryProvider","ArcGisMapServerImageryProvider"],description:"provider类型"},XbsjImageryProvider:$.XbsjImageryProvider.gvolSchema,UrlTemplateImageryProvider:$.UrlTemplateImageryProvider.gvolSchema,WebMapServiceImageryProvider:$.WebMapServiceImageryProvider.gvolSchema,WebMapTileServiceImageryProvider:$.WebMapTileServiceImageryProvider.gvolSchema,createTileMapServiceImageryProvider:$.TileMapServiceImageryProvider.gvolSchema,TileMapServiceImageryProvider:$.TileMapServiceImageryProvider.gvolSchema,ArcGisMapServerImageryProvider:$.ArcGisMapServerImageryProvider.gvolSchema}},gvolZIndex:{type:"number",title:"gvolZIndex",default:0,description:"确定影像的叠加顺序，zIndex越大约靠近顶层"}}},te={alpha:1,brightness:1,contrast:1,hue:0,saturation:1,gamma:1,show:!0,colorToAlphaThreshold:.004};Object.assign(te,{splitDirection:"ImagerySplitDirection.NONE",rectangle:void 0}),Object.assign(te,{gvolImageryProvider:{XbsjImageryProvider:{},UrlTemplateImageryProvider:{},WebMapServiceImageryProvider:{},WebMapTileServiceImageryProvider:{},ArcGisMapServerImageryProvider:{},GoogleEarthEnterpriseImageryProvider:{},createTileMapServiceImageryProvider:{},TileMapServiceImageryProvider:{},type:"XbsjImageryProvider"},gvolZIndex:0});const ie=[["ImagerySplitDirection.NONE",0],["ImagerySplitDirection.LEFT",-1],["ImagerySplitDirection.RIGHT",1]],re=new Map(ie,ie.map((([e,t])=>[t,e]))),ne=(e,t)=>{if(!e.has(t))throw new Error(`prop ${t} is not right value!!!`);return e.get(t)};class oe extends u.Z{constructor(e,t){super(e,t);const i=e.czm.scene;this._scene=i,(0,P.extendObservable)(this,{_imageryLayer:void 0},{_imageryLayer:P.observable.ref}),this.disposers.push((()=>{this._imageryLayer&&this._scene.imageryLayers.remove(this._imageryLayer),this._imageryLayer=void 0})),e._gvolImageries.push(this),this.disposers.push((()=>{const t=e._gvolImageries.indexOf(this);if(-1===t)throw new Error("earth._gvolImageries must contain!");e._gvolImageries.splice(t,1)})),this.disposers.push((0,O.Z)(this,"enabled",this,"show")),this.gvolImageryProvider.UrlTemplateImageryProvider=new $.UrlTemplateImageryProvider,this.gvolImageryProvider.XbsjImageryProvider=new $.XbsjImageryProvider,this.gvolImageryProvider.WebMapServiceImageryProvider=new $.WebMapServiceImageryProvider,this.gvolImageryProvider.WebMapTileServiceImageryProvider=new $.WebMapTileServiceImageryProvider,this.gvolImageryProvider.createTileMapServiceImageryProvider=new $.TileMapServiceImageryProvider,this.gvolImageryProvider.TileMapServiceImageryProvider=new $.TileMapServiceImageryProvider,this.gvolImageryProvider.ArcGisMapServerImageryProvider=new $.ArcGisMapServerImageryProvider,this.gvolImageryProvider.GoogleEarthEnterpriseImageryProvider=new $.GoogleEarthEnterpriseImageryProvider,this.disposers.push(h.Z.registerProperty(this,"gvolImageryProvider",oe.defaultOptions.gvolImageryProvider)),this.disposers.push(h.Z.registerProperty(this.gvolImageryProvider,"UrlTemplateImageryProvider",$.UrlTemplateImageryProvider.defaultOptions)),this.disposers.push(h.Z.registerProperty(this.gvolImageryProvider,"XbsjImageryProvider",$.XbsjImageryProvider.defaultOptions)),this.disposers.push(h.Z.registerProperty(this.gvolImageryProvider,"WebMapServiceImageryProvider",$.WebMapServiceImageryProvider.defaultOptions)),this.disposers.push(h.Z.registerProperty(this.gvolImageryProvider,"WebMapTileServiceImageryProvider",$.WebMapTileServiceImageryProvider.defaultOptions)),this.disposers.push(h.Z.registerProperty(this.gvolImageryProvider,"createTileMapServiceImageryProvider",$.TileMapServiceImageryProvider.defaultOptions)),this.disposers.push(h.Z.registerProperty(this.gvolImageryProvider,"TileMapServiceImageryProvider",$.TileMapServiceImageryProvider.defaultOptions)),this.disposers.push(h.Z.registerProperty(this.gvolImageryProvider,"ArcGisMapServerImageryProvider",$.ArcGisMapServerImageryProvider.defaultOptions)),this.disposers.push(h.Z.registerProperty(this.gvolImageryProvider,"GoogleEarthEnterpriseImageryProvider",$.GoogleEarthEnterpriseImageryProvider.defaultOptions)),this.disposers.push((0,P.reaction)((()=>{const e=this.gvolImageryProvider.type;return{provider:this.gvolImageryProvider&&this.gvolImageryProvider[e]&&this.gvolImageryProvider[e].provider,rectangle:this.rectangle}}),(({provider:e,rectangle:t})=>{this._imageryLayer&&this._scene.imageryLayers.remove(this._imageryLayer),e&&(this._imageryLayer=new Cesium.ImageryLayer(e,{alpha:this.alpha,brightness:this.brightness,contrast:this.contrast,hue:this.hue,saturation:this.saturation,gamma:this.gamma,show:this.show,colorToAlphaThreshold:this.colorToAlphaThreshold,splitDirection:ne(re,this.splitDirection),rectangle:t&&Cesium.Rectangle.fromRadians(...t)}),this._scene.imageryLayers.add(this._imageryLayer),this._earth._gvolImageryZIndexDirty=!0)}),{fireImmediately:!0})),this.disposers.push((0,P.autorun)((()=>{const e=this.alpha,t=this.brightness,i=this.contrast,r=this.hue,n=this.saturation,o=this.gamma,s=this.show,a=this.colorToAlphaThreshold,l=this.gvolZIndex,h=ne(re,this.splitDirection);this._imageryLayer&&(this._imageryLayer.alpha=e,this._imageryLayer.brightness=t,this._imageryLayer.contrast=i,this._imageryLayer.hue=r,this._imageryLayer.saturation=n,this._imageryLayer.gamma=o,this._imageryLayer.show=s,this._imageryLayer.colorToAlphaThreshold=a,this._imageryLayer.splitDirection=h,this._imageryLayer.gvolZIndex=l)}))),this.disposers.push((0,P.reaction)((()=>[this.show,this.gvolZIndex]),(()=>{this._imageryLayer&&(this._imageryLayer.show=this.show,this._imageryLayer.gvolZIndex=this.gvolZIndex),this._earth._gvolImageryZIndexDirty=!0})))}flyTo(){this.rectangle&&4===this.rectangle.length&&this._scene.camera.flyTo({destination:new Cesium.Rectangle(this.rectangle[0],this.rectangle[1],this.rectangle[2],this.rectangle[3])})}gvolFromJSON(e){return super.gvolFromJSON(e)}isDestroyed(){return!1}destroy(){return super.destroy()}}oe.ImageryProvider=$,oe.defaultImageryProviderConfig=Object.freeze({TileMapServiceImageryProvider:{url:R.Z.cesiumDir+"Assets/Textures/NaturalEarthII",fileExtension:"jpg"},type:"TileMapServiceImageryProvider"}),oe.defaultOptions=te,c.Z.registerType(oe,"Imagery"),oe.gvolSchema=ee,oe.gvolClassification=H;const se=oe;var ae=i(9563);let le,he,ce,ue,pe,de,me,fe,ge,Ae;const ye=function(e,t,i,r){le=le||new Cesium.Cartesian3,he=he||new Cesium.HeadingPitchRoll,ce=ce||new Cesium.Matrix4,ue=ue||new Cesium.Cartesian4,pe=pe||new Cesium.Cartesian3,de=de||new Cesium.Quaternion,me=me||new Cesium.Cartesian3(1,1,1),fe=fe||new Cesium.Matrix4,ge=ge||new Cesium.Cartesian3,Ae=Ae||new Cesium.Cartographic;const n=Cesium.Cartesian3.fromRadians(e[0],e[1],0,void 0,le),o=he;o.xbsjFromArray(t,0,0);const s=Cesium.Transforms.headingPitchRollToFixedFrame(n,o,void 0,void 0,ce),a=Cesium.Matrix4.getColumn(s,1,ue),l=pe;l.x=a.x,l.y=a.y,l.z=a.z;const h=Cesium.Quaternion.fromAxisAngle(l,i*Cesium.Ellipsoid.WGS84.oneOverRadii.x,de),c=Cesium.Matrix4.fromTranslationQuaternionRotationScale(Cesium.Cartesian3.ZERO,h,me,fe),u=Cesium.Matrix4.multiplyByPoint(c,n,ge),p=Cesium.Cartographic.fromCartesian(u,void 0,Ae);return(r=r||[0,0,0])[0]=p.longitude,r[1]=p.latitude,r[2]=e[2],r};let ve;const Ce=function(e,t){return ve=ve||new Cesium.EllipsoidGeodesic,ve.start.longitude=e[0],ve.start.latitude=e[1],ve.start.height=0,ve.end.longitude=t[0],ve.end.latitude=t[1],ve.end.height=0,ve.setEndPoints(ve.start,ve.end),ve.surfaceDistance};let _e,be,we,Pe;const Se=function(e,t,i,r){_e=_e||new Cesium.Cartesian3,be=be||new Cesium.Cartesian3,we=we||new Cesium.Cartesian3,Pe=Pe||new Cesium.Cartographic;const n=Cesium.Cartesian3.fromRadians(...e,void 0,_e),o=Cesium.Cartesian3.fromRadians(...t,void 0,be),s=Cesium.Cartesian3.lerp(n,o,i,we);if(!s)return;const a=Cesium.Cartographic.fromCartesian(s,void 0,Pe);return a?((r=r||[]).splice(0,r.length,a.longitude,a.latitude,a.height),r):void 0};let xe,Be,Me,Ee,Te,Oe;const Le=function(e,t,i){try{xe=xe||new Cesium.Camera(window.gvol_hpr_scene),Be=Be||new Cesium.Cartesian3,Me=Me||new Cesium.Cartesian3,Ee=Ee||new Cesium.Cartesian3,Te=Te||new Cesium.Cartesian3,Oe=Oe||new Cesium.HeadingPitchRoll;const r=Cesium.Cartesian3.fromRadians(...e,void 0,Be),n=Cesium.Cartesian3.fromRadians(...t,void 0,Me);if(Cesium.Cartesian3.equals(r,n))return;let o=Cesium.Cartesian3.subtract(n,r,Ee);o=Cesium.Cartesian3.normalize(o,o);let s=Cesium.Cartesian3.normalize(r,Te);s=Cesium.Cartesian3.normalize(s,s),xe.setView({destination:r,orientation:{direction:o,up:s}}),i=i||[0,0,0];let a=xe.heading;return a-=Cesium.Math.PI_OVER_TWO,a<0&&(a+=Cesium.Math.TWO_PI),i.splice(0,i.length,a,xe.pitch,xe.roll),i}catch(e){return}};let De,Ie;function Re(e,t){De=De||new Cesium.Cartesian3,Ie=Ie||new Cesium.Cartesian3;const i=Cesium.Cartesian3.fromRadians(...e,void 0,De),r=Cesium.Cartesian3.fromRadians(...t,void 0,Ie);return Cesium.Cartesian3.distance(i,r)}const He=function(e,t){return void 0===t&&Array.isArray(e)?function(e){const t=e.length;let i=0;for(let r=0;r<t-1;++r)i+=Re(e[r],e[r+1]);return i}(e):Re(e,t)};i(8905),i(2647);let Fe,Ne,Qe,ke,Ue,je,Ge,ze,Ye,Ze,We,Xe,Je,Ke,Ve,qe,$e,et,tt,it,rt,nt,ot,st,at,lt,ht;function ct(e,t,i,r,n){Fe=Fe||new Cesium.Cartesian3,Ne=Ne||new Cesium.Cartesian3,Qe=Qe||new Cesium.Cartesian3;const o=Cesium.Cartesian3.multiplyByScalar(e,(1-r)*(1-r),Fe),s=Cesium.Cartesian3.multiplyByScalar(t,2*r*(1-r),Ne),a=Cesium.Cartesian3.multiplyByScalar(i,r*r,Qe);return(n=n||new Cesium.Cartesian3).x=o.x+s.x+a.x,n.y=o.y+s.y+a.y,n.z=o.z+s.z+a.z,n}function ut(e,t,i,r,n,o){ke=ke||new Cesium.Cartesian3,Ue=Ue||new Cesium.Cartesian3,je=je||new Cesium.Cartesian3,Ge=Ge||new Cesium.Cartesian3;const s=Cesium.Cartesian3.multiplyByScalar(e,(1-n)*(1-n)*(1-n),ke),a=Cesium.Cartesian3.multiplyByScalar(t,3*n*(1-n)*(1-n),Ue),l=Cesium.Cartesian3.multiplyByScalar(i,3*n*n*(1-n),je),h=Cesium.Cartesian3.multiplyByScalar(r,n*n*n,Ge);return(o=o||new Cesium.Cartesian3).x=s.x+a.x+l.x+h.x,o.y=s.y+a.y+l.y+h.y,o.z=s.z+a.z+l.z+h.z,o}let pt,dt,mt,ft;const gt=function(e,t,i,r){pt=pt||new Cesium.Matrix4,dt=dt||new Cesium.Matrix4,mt=mt||new Cesium.Cartesian3,ft=ft||new Cesium.HeadingPitchRoll,r||(r=new Cesium.Matrix4);const n=Cesium.Cartesian3.fromRadians(e[0],e[1],e[2],void 0,mt),o=ft;o.xbsjFromArray(...t);let s=Cesium.Transforms.headingPitchRollToFixedFrame(n,o,void 0,void 0,r);const a=Cesium.Matrix4.fromScale(new Cesium.Cartesian3(...i),dt);return r=Cesium.Matrix4.multiply(s,a,r)};function At(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]}var yt,vt,Ct=(vt=function(){const e={create:()=>new Cesium.Cartesian3,fromValues:Cesium.Cartesian3.fromElements,dot:Cesium.Cartesian3.dot,cross:(e,t,i)=>Cesium.Cartesian3.cross(t,i,e),len:Cesium.Cartesian3.magnitude,normalize:(e,t)=>Cesium.Cartesian3.normalize(t,e)};let t=e.create(),i=e.fromValues(1,0,0),r=e.fromValues(0,1,0);return function(n,o,s){let a=e.dot(o,s);return a<-.999999?(e.cross(t,i,o),e.len(t)<1e-6&&e.cross(t,r,o),e.normalize(t,t),((e,t,i)=>{Cesium.Quaternion.fromAxisAngle(t,i,e)})(n,t,Math.PI),n):a>.999999?(n.x=0,n.y=0,n.z=0,n.w=1,n):(e.cross(t,o,s),n.x=t.x,n.y=t.y,n.z=t.z,n.w=1+a,((e,t)=>Cesium.Quaternion.normalize(t,e))(n,n))}},function(e,t,i,r){yt||(yt=vt());var n=Cesium.Transforms.eastNorthUpToFixedFrame(i),o=new Cesium.Matrix4;o=Cesium.Matrix4.inverse(n,o);var s=new Cesium.Cartesian3;s=Cesium.Matrix4.multiplyByPoint(o,i,s);var a=new Cesium.Cartesian3;a=Cesium.Matrix4.multiplyByPoint(o,r,a);var l=new Cesium.Cartesian3;Cesium.Cartesian3.subtract(t,e,l);var h=new Cesium.Cartesian3;Cesium.Cartesian3.subtract(a,s,h);var c=Cesium.Cartesian3.magnitude(l);Cesium.Cartesian3.normalize(l,l);var u=Cesium.Cartesian3.magnitude(h);Cesium.Cartesian3.normalize(h,h);var p=new Cesium.Quaternion;yt(p,l,h);var d=u/c,m=Cesium.Matrix4.fromTranslationQuaternionRotationScale(Cesium.Cartesian3.ZERO,p,Cesium.Cartesian3.fromElements(d,d,d)),f=new Cesium.Cartesian3;f=Cesium.Matrix4.multiplyByPoint(m,e,f);var g=Cesium.Cartesian3.subtract(s,f,new Cesium.Cartesian3),A=Cesium.Matrix4.multiplyByPoint(n,g,new Cesium.Cartesian3),y=new Cesium.Matrix4;{const e=Cesium.Transforms.eastNorthUpToFixedFrame(A);Cesium.Matrix4.multiply(e,m,y)}var v=Cesium.Cartographic.fromCartesian(A),C={longitude:Cesium.Math.toDegrees(v.longitude),latitude:Cesium.Math.toDegrees(v.latitude),height:v.height},_=Cesium.HeadingPitchRoll.fromQuaternion(p);return{scale:d,rotation:p,positionInCartesian:A,positionInRadians:v,positionInDegrees:C,hpr:_,hprInDegrees:{heading:Cesium.Math.toDegrees(_.heading),pitch:Cesium.Math.toDegrees(_.pitch),roll:Cesium.Math.toDegrees(_.roll)},modelMatrix:y}});const _t={geoMove:ye,geoDistance:Ce,geoLerp:Se,hpr:Le,distance:He,Bezier:{bezier2Length:function(e,t,i,r=100){ze=ze||new Cesium.Cartesian3,Ye=Ye||new Cesium.Cartesian3,Ze=Ze||new Cesium.Cartesian3,We=We||new Cesium.Cartesian3;const n=Cesium.Cartesian3.fromRadians(...e,void 0,ze),o=Cesium.Cartesian3.fromRadians(...t,void 0,Ye),s=Cesium.Cartesian3.fromRadians(...i,void 0,Ze);let a=0,l=1/r,h=n;for(let e=1;e<=r;e++){const t=ct(n,o,s,l*e,We);a+=Cesium.Cartesian3.distance(h,t),h=t}return a},bezier2:function(e,t,i,r=100,n){Xe=Xe||new Cesium.Cartesian3,Je=Je||new Cesium.Cartesian3,Ke=Ke||new Cesium.Cartesian3,Ve=Ve||new Cesium.Cartesian3,qe=qe||new Cesium.Cartographic;const o=Cesium.Cartesian3.fromRadians(...e,void 0,Xe),s=Cesium.Cartesian3.fromRadians(...t,void 0,Je),a=Cesium.Cartesian3.fromRadians(...i,void 0,Ke);(n=n||[]).length=0;let l=0,h=1/r,c=o;n.push([...e]);for(let e=1;e<=r;e++){const t=ct(o,s,a,h*e,Ve),i=Cesium.Cartographic.fromCartesian(t,void 0,qe);n.push([i.longitude,i.latitude,i.height]);l+=Cesium.Cartesian3.distance(c,t),c=t}return l},bezier3Length:function(e,t,i,r,n=100){$e=$e||new Cesium.Cartesian3,et=et||new Cesium.Cartesian3,tt=tt||new Cesium.Cartesian3,it=it||new Cesium.Cartesian3,rt=rt||new Cesium.Cartesian3;const o=Cesium.Cartesian3.fromRadians(...e,void 0,$e),s=Cesium.Cartesian3.fromRadians(...t,void 0,et),a=Cesium.Cartesian3.fromRadians(...i,void 0,tt),l=Cesium.Cartesian3.fromRadians(...r,void 0,it);let h=0,c=1/n,u=o;for(let e=1;e<=n;e++){const t=ut(o,s,a,l,c*e,rt);h+=Cesium.Cartesian3.distance(u,t),u=t}return h},bezier3:function(e,t,i,r,n=100,o){nt=nt||new Cesium.Cartesian3,ot=ot||new Cesium.Cartesian3,st=st||new Cesium.Cartesian3,at=at||new Cesium.Cartesian3,lt=lt||new Cesium.Cartesian3,ht=ht||new Cesium.Cartographic;const s=Cesium.Cartesian3.fromRadians(...e,void 0,nt),a=Cesium.Cartesian3.fromRadians(...t,void 0,ot),l=Cesium.Cartesian3.fromRadians(...i,void 0,st),h=Cesium.Cartesian3.fromRadians(...r,void 0,at);(o=o||[]).length=0;let c=0,u=1/n,p=s;o.push([...e]);for(let e=1;e<=n;e++){const t=ut(s,a,l,h,u*e,lt),i=Cesium.Cartographic.fromCartesian(t,void 0,ht);o.push([i.longitude,i.latitude,i.height]);c+=Cesium.Cartesian3.distance(p,t),p=t}return c}},getModelMatrix:gt,hasSamePosition:function(e,t){return void 0!==t?At(e,t):function(e){const t=e.length;let i=!1;for(let r=0;r<t-1;++r)if(At(e[r],e[r+1])){i=!0;break}return i}(e)},abToAb:Ct};var bt=i(5108),wt=function(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],r=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Pt=function(){function e(){}return e.defaultValue=function(e,t){return null!=e?e:t},e.isObject=function(e){return"object"==typeof e&&null!==e},e.isBoolean=function(e){return"boolean"==typeof e},e.isJson=function(e){return"[object Object]"===toString.call(e)},e.isString=function(e){return"string"==typeof e&&e.constructor===String},e.isNumber=function(e){return"number"==typeof e&&e.constructor===Number},e.isArray=function(e){return e instanceof Array},e.isColor=function(e){return new RegExp("^#([0-9a-fA-F]{6}|[0-9a-fA-F]{8})$").test(e)},e.isCssColor=function(e){return new RegExp("(^rgba)|(^rgb)|(^#?([0-9a-fA-F]{3}|[0-9a-fA-F]{6})$)").test(e)},e.CheckIsColor=function(e){if(!e)return"invalid";if(0==e.length)return"invalid";var t="";/^rgb\(/.test(e)?t="^[rR][gG][Bb][(]([\\s]*(2[0-4][0-9]|25[0-5]|[01]?[0-9][0-9]?)[\\s]*,){2}[\\s]*(2[0-4]\\d|25[0-5]|[01]?\\d\\d?)[\\s]*[)]{1}$":/^rgba\(/.test(e)?t="^[rR][gG][Bb][Aa][(]([\\s]*(2[0-4][0-9]|25[0-5]|[01]?[0-9][0-9]?)[\\s]*,){3}[\\s]*(1|1.0|0|0.[0-9])[\\s]*[)]{1}$":/^#/.test(e)?t="^#([0-9a-fA-F]{6}|[0-9a-fA-F]{3})$":/^hsl\(/.test(e)?t="^[hH][Ss][Ll][(]([\\s]*(2[0-9][0-9]|360｜3[0-5][0-9]|[01]?[0-9][0-9]?)[\\s]*,)([\\s]*((100|[0-9][0-9]?)%|0)[\\s]*,)([\\s]*((100|[0-9][0-9]?)%|0)[\\s]*)[)]$":/^hsla\(/.test(e)&&(t="^[hH][Ss][Ll][Aa][(]([\\s]*(2[0-9][0-9]|360｜3[0-5][0-9]|[01]?[0-9][0-9]?)[\\s]*,)([\\s]*((100|[0-9][0-9]?)%|0)[\\s]*,){2}([\\s]*(1|1.0|0|0.[0-9])[\\s]*)[)]$");var i=new RegExp(t);return null==e.match(i)?"invalid":"valid"},e.checkNumber=function(t,i,r,n){return null==t||i===t?i:(e.isString(t)&&(t=parseFloat(t)),e.isNumber(t)?void 0!==r&&t<r?(bt.warn("参数小于最小范围 ".concat(r,"。 当前参数").concat(t,"; 使用最小值: ").concat(r)),r):void 0!==n&&t>n?(bt.warn("参数大于最大范围 ".concat(n,"。 当前参数").concat(t,"; 使用最小值: ").concat(n)),n):t:(bt.warn("参数应为数值类型。当前参数:".concat(t,"; 使用默认参数:").concat(i,";")),i))},e.checkInt=function(e,t,i,r){return null==e||t===e?t:(e=Math.floor(e),void 0!==i&&e<i?(bt.warn("参数小于最小范围 ".concat(i,"。 当前参数").concat(e,"; 使用最小值: ").concat(i)),i):void 0!==r&&e>r?(bt.warn("参数大于最大范围 ".concat(r,"。 当前参数").concat(e,"; 使用最小值: ").concat(r)),r):e)},e.checkEnum=function(e,t,i){var r,n,o,s;if(null==e)return t;if(t===e)return t;try{for(var a=wt(i),l=a.next();!l.done;l=a.next()){if(e===l.value)return e}}catch(e){r={error:e}}finally{try{l&&!l.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}var h="";try{for(var c=wt(i),u=c.next();!u.done;u=c.next()){h=h+u.value+"、"}}catch(e){o={error:e}}finally{try{u&&!u.done&&(s=c.return)&&s.call(c)}finally{if(o)throw o.error}}return bt.warn("无该枚举类型。当前参数: ".concat(e,"; 支持的参数:").concat(h,"; 使用默认参数:").concat(t)),t},e.checkColor=function(t,i){var r=t.match(/^(rgba)/g),n=t.match(/^(#)/g);return e.isString(t)?r?t:!n||4!=t.length&&7!=t.length?i:t:i},e.checkString=function(t,i){return e.isString(t)?t:i},e.isEmpty=function(e){return""===e||("null"===e||("undefined"===e||(!e&&0!==e&&""!==e||(!(!Array.prototype.isPrototypeOf(e)||0!==e.length)||!(!Object.prototype.isPrototypeOf(e)||0!==Object.keys(e).length)))))},e}(),St=i(7949),xt=i(6571),Bt=function(){function e(){}return e.calculateMatrix=function(e,t){var i=A.toCartesian3(e.position),r=Cesium.HeadingPitchRoll.fromDegrees(e.heading,e.pitch,e.roll),n=Cesium.Transforms.headingPitchRollToFixedFrame(i,r,Cesium.Ellipsoid.WGS84,Cesium.Transforms.eastNorthUpToFixedFrame,new Cesium.Matrix4),o=new Cesium.Cartesian3(t.x,t.y,t.z),s=Cesium.HeadingPitchRoll.fromDegrees(t.heading,t.pitch,t.roll),a=Cesium.Transforms.headingPitchRollQuaternion(Cesium.Cartesian3.fromDegrees(0,0),s),l=Cesium.Matrix4.fromTranslationQuaternionRotationScale(o,a,new Cesium.Cartesian3(1,1,1)),h=Cesium.Matrix4.multiply(n,l,new Cesium.Matrix4);return this.matrixToHdr(h)},e.matrixToHdr=function(e){var t=Cesium.Transforms.eastNorthUpToFixedFrame(Cesium.Matrix4.getTranslation(e,new Cesium.Cartesian3),Cesium.Ellipsoid.WGS84,new Cesium.Matrix4),i=Cesium.Matrix4.multiply(Cesium.Matrix4.inverse(t,new Cesium.Matrix4),e,new Cesium.Matrix4),r=Cesium.Matrix4.getRotation(i,new Cesium.Matrix3),n=Cesium.Quaternion.fromRotationMatrix(r),o=Cesium.HeadingPitchRoll.fromQuaternion(n),s=Cesium.Matrix4.getTranslation(e,new Cesium.Cartesian3);return{position:A.fromCartesian3(s),heading:Cesium.Math.toDegrees(o.heading),pitch:Cesium.Math.toDegrees(o.pitch),roll:Cesium.Math.toDegrees(o.roll)}},e._surfaceDistance=function(e){var t=0;if(e.length>1)for(var i=1;i<e.length;i++){var r=e[i],n=e[i-1],o=Cesium.Cartographic.fromDegrees(n.lon,n.lat),s=Cesium.Cartographic.fromDegrees(r.lon,r.lat),a=new Cesium.EllipsoidGeodesic;a.setEndPoints(o,s);var l=a.surfaceDistance;t+=l=Math.sqrt(Math.pow(l,2)+Math.pow(o.height-s.height,2))}return t},e._getAngle=function(e,t,i){var r=this._getBearing(t,e)-this._getBearing(t,i);return r<0&&(r+=360),r},e._getBearing=function(e,t){var i=Math.PI/180,r=180/Math.PI,n=e.lat*i,o=e.lon*i,s=t.lat*i,a=t.lon*i,l=-Math.atan2(Math.sin(o-a)*Math.cos(s),Math.cos(n)*Math.sin(s)-Math.sin(n)*Math.cos(s)*Math.cos(o-a));return l<0&&(l+=2*Math.PI),l*=r},e.spaceArea=function(e){var t=[[]];e.map((function(e){t[0].push([e.lon,e.lat])})),t[0].push([e[0].lon,e[0].lat]);var i=xt.yue(t);return xt.SOn(i)},e.groundArea=function(e){for(var t=0,i=0;i<e.length-2;i++){var r=(i+1)%e.length,n=(i+2)%e.length,o=this._getAngle(e[i],e[r],e[n]);t+=this.spaceDistance([e[r],e[0]])*this.spaceDistance([e[n],e[0]])*Math.sin(o)/2}return t},e.groundDistance=function(t,i){var r=0;if(t.length>1){for(var n=[],o=t.length,s=0;s<o-1;s++){var a=t[s].lon,l=t[s].lat,h=t[s+1].lon,c=t[s+1].lat,u=e._surfaceDistance([t[s],t[s+1]])/1e3;u=Math.floor(u);for(var p=1;p<u;p++){var d=Cesium.Math.lerp(a,h,p/(u-1)),m=Cesium.Math.lerp(l,c,p/(u-1)),f=Cesium.Cartographic.fromDegrees(d,m),g=i.scene.globe.getHeight(f)+10;n.push(new A(d,m,g))}}r=e._surfaceDistance(n)}return r},e.spaceDistance=function(e){for(var t=0,i=0;i<e.length-1;i++)t+=Cesium.Cartesian3.distance(Cesium.Cartesian3.fromDegrees(e[i].lon,e[i].lat,e[i].alt),Cesium.Cartesian3.fromDegrees(e[i+1].lon,e[i+1].lat,e[i+1].alt));return t},e.getBezier=function(e,t){void 0===t&&(t=100);var i=[];return e.map((function(e){i.push(e.lon),i.push(e.lat)})),new St.D(i).getLUT(t).map((function(e){return new A(e.x,e.y)}))},e.getParabola=function(e,t,i,r){void 0===r&&(r=100);var n=[],o=A.toCartesian3(e),s=A.toCartesian3(t),a=Cesium.Cartographic.fromCartesian(o),l=Cesium.Cartographic.fromCartesian(s),h=180*a.longitude/Math.PI,c=180*a.latitude/Math.PI,u=180*l.longitude/Math.PI,p=180*l.latitude/Math.PI,d=Math.sqrt((h-u)*(h-u)+(c-p)*(c-p))*i,m=Cesium.Cartesian3.clone(o),f=Cesium.Cartesian3.clone(s),g=Cesium.Cartesian3.distance(m,Cesium.Cartesian3.ZERO),y=Cesium.Cartesian3.distance(f,Cesium.Cartesian3.ZERO);if(Cesium.Cartesian3.normalize(m,m),Cesium.Cartesian3.normalize(f,f),0==Cesium.Cartesian3.distance(m,f))return n;var v=Cesium.Cartesian3.angleBetween(m,f);n.push(o);for(var C=1;C<r-1;C++){var _=1*C/(r-1),b=1-_,w=Math.sin(b*v)/Math.sin(v),P=Math.sin(_*v)/Math.sin(v),S=Cesium.Cartesian3.multiplyByScalar(m,w,new Cesium.Cartesian3),x=Cesium.Cartesian3.multiplyByScalar(f,P,new Cesium.Cartesian3),B=Cesium.Cartesian3.add(S,x,new Cesium.Cartesian3),M=_*Math.PI,E=g*b+y*_+Math.sin(M)*d;B=Cesium.Cartesian3.multiplyByScalar(B,E,B),n.push(B)}return n.push(s),n.map((function(e){return A.fromCartesian3(e)}))},e.pointInPolygon=function(e,t){var i=A.pack(e);t[0]!=t[t.length-1]&&t.push(t[0]);var r=xt.yue([A.packArray(t)]);return xt.FWy(i,r)},e.pointInCircle=function(t,i,r){return e.spaceDistance([t,i])<r},e.getEllipsePositions=function(e,t,i,r){void 0===r&&(r=64);var n=A.pack(e),o=xt.Hpm(n,t,i,{steps:r,units:"meters"});return A.unpackArray(o.geometry.coordinates[0])},e.getEllipsePositionsArray=function(e,t,i,r){void 0===r&&(r=64);var n=e;return xt.Hpm(n,t,i,{steps:r,units:"meters"}).geometry.coordinates[0]},e.getCirclePositions=function(e,t,i){void 0===i&&(i=64);var r=A.pack(e),n=xt.Xwo(r,t,{steps:i,units:"meters"});return A.unpackArray(n.geometry.coordinates[0])},e.getCirclePositionsArray=function(e,t,i){void 0===i&&(i=64);var r=e;return xt.Xwo(r,t,{steps:i,units:"meters"}).geometry.coordinates[0]},e.getSectorPositions=function(e,t,i,r,n){void 0===i&&(i=0),void 0===r&&(r=120),void 0===n&&(n=16);var o=A.pack(e),s=xt.Q$S(xt.xmu(o),t/1e3,i,r,{steps:n});return A.unpackArray(s.geometry.coordinates[0])},e.getSectorPositionsArray=function(e,t,i,r,n){void 0===i&&(i=0),void 0===r&&(r=120),void 0===n&&(n=16);var o=e;return xt.Q$S(xt.xmu(o),t/1e3,i,r,{steps:n}).geometry.coordinates[0]},e.getIntersect=function(e,t){var i=A.packArray(e),r=A.packArray(t),n=xt.yue([i]),o=xt.yue([r]),s=xt.wfr(n,o);return A.unpackArray(s.geometry.coordinates[0])},e.getUnion=function(e,t){var i=A.packArray(e),r=A.packArray(t),n=xt.yue([i]),o=xt.yue([r]),s=xt.G0j(n,o);return A.unpackArray(s.geometry.coordinates[0])},e.getDiffer=function(e,t){var i=A.packArray(e),r=A.packArray(t),n=xt.yue([i]),o=xt.yue([r]),s=xt.e50(n,o);return A.unpackArray(s.geometry.coordinates[0])},e.getAngle=function(e,t){var i=e.lon,r=e.lat,n=t.lon,o=t.lat,s=(90-o)*Math.PI/180,a=(90-r)*Math.PI/180,l=(n-i)*Math.PI/180,h=Math.cos(s)*Math.cos(a)+Math.sin(s)*Math.sin(a)*Math.cos(l),c=Math.sqrt(1-h*h),u=Math.sin(s)*Math.sin(l)/c,p=180*Math.asin(u)/Math.PI,d=0;return n>i&&o>r?d=p:n>i&&o<r||n<i&&o<r?d=180-p:n<i&&o>r?d=360+p:n>i&&o==r?d=90:n<i&&o==r?d=270:n==i&&o>r?d=0:n==i&&o<r&&(d=180),d},e.pointInEarthSide=function(e,t){var i=A.toCartesian3(e),r=t.scene.mapProjection.ellipsoid,n=t.scene.camera.positionWC;return new Cesium.EllipsoidalOccluder(r,n).isPointVisible(i)},e.centerOfMass=function(e){var t=xt.yue([e]),i=xt.MqI(t);return new A(i.geometry.coordinates[0],i.geometry.coordinates[1])},e}(),Mt=function(e,t,i,r){return new(i||(i=Promise))((function(n,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?n(e.value):function(e){return e instanceof i?e:new i((function(t){t(e)}))}(e.value).then(s,a)}l((r=r.apply(e,t||[])).next())}))},Et=function(e,t){var i,r,n,o,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,r&&(n=2&o[0]?r.return:o[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,o[1])).done)return n;switch(r=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(n=s.trys,(n=n.length>0&&n[n.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){s.label=o[1];break}if(6===o[0]&&s.label<n[1]){s.label=n[1],n=o;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(o);break}n[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{i=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},Tt=function(){function e(){}return e.getTianDiTuToken=function(){return"923387da9c04ca5774690c17b71136a1"},e.getGeovisDaasToken=function(){return"fd2cddddcf70866a1a334a47b78b8cba1941af00c93b3a97e49c65ab5182922a"},e.getGeovisTerrainToken=function(){return"da030867e0c0d54e068e7ed7e21a1b3e8562f0b595394c6cbd928085a4e9ccce"},e.decryptVector=function(t,i,r){return Mt(this,void 0,void 0,(function(){var n;return Et(this,(function(o){switch(o.label){case 0:return[4,fetch(t)];case 1:return[4,o.sent().text()];case 2:return n=o.sent(),[2,e.decodeFromJAVA(n,i,r)]}}))}))},e.decodeFromJAVA=function(e,t,i){return new i(128,1e3,t).decrypt("bd3253d9b33854f4c059dc9220f254a9","2879bf6fb9b7956a53be44b6bb96e5c8","1234567891234567",e)},e}();var Ot=i(2605),Lt=function(){function e(){}return e.getMilsymbolImage=function(e,t){return new Ot.Symbol(e,{size:t,square:!0}).toDataURL()},e.getMilsymbolCanvas=function(e,t){return new Ot.Symbol(e,{size:t,additionalInformation:e,infoFields:!1}).asCanvas()},e}(),Dt=i(7098),It=i.n(Dt),Rt=i(5108);const Ht=class{constructor(){this.Layers=[],this.TileMatrixSets=[]}addUrlParam(e){let t=e.lastIndexOf("?");var i={};return t>0&&(i=Cesium.queryToObject(e.substr(t+1)),e=e.substr(0,t)),this.url=e,i.Request="GetCapabilities",i.Service="wmts",this.queryParameters=i,e+"?"+Cesium.objectToQuery(i)}makeTemplate(e){Rt.log(e);var t=this.url+"?REQUEST=GetTile&VERSION=1.0.0&SERVICE=wmts";for(var i in t+="&LAYER="+e,t+="&STYLE={style}",t+="&TILEMATRIXSET={TileMatrixSet}",t+="&TILEMATRIX={TileMatrix}",t+="&TILEROW={TileRow}",t+="&TILECOL={TileCol}",this.queryParameters){let e=i.toLowerCase();"request"!=e&&"service"!=e&&(t+="&"+e+"="+this.queryParameters[e])}return Rt.log("make template",t),t}parser(e,t){return new Promise(((t,i)=>{Cesium.Resource.fetchText({url:e}).then((e=>{var i=new(It());this.Layers=[],this.TileMatrixSets=[];let r=i.xml2js(e).Capabilities.Contents;r.TileMatrixSet instanceof Array?r.TileMatrixSet.forEach((e=>{this.addTileMatrixSet(e)})):r.TileMatrixSet&&this.addTileMatrixSet(r.TileMatrixSet),r.Layer instanceof Array?r.Layer.forEach((e=>{this.addLayer(e)})):r.Layer&&this.addLayer(r.Layer),t(this.Layers)})).otherwise((e=>{i(e)}))}))}addLayer(e){var t={title:e.Title.toString(),urls:[],styles:[],tileMatrixSets:[]};if(e.WGS84BoundingBox){let i=e.WGS84BoundingBox.LowerCorner.toString().split(" "),r=e.WGS84BoundingBox.UpperCorner.toString().split(" "),n=parseFloat(i[0]),o=parseFloat(i[1]),s=parseFloat(r[0]),a=parseFloat(r[1]);n<-180&&(n=-180),s>180&&(s=180),o<-90&&(o=-90),a>90&&(a=90),t.rectangle=[n,o,s,a]}if(e.ResourceURL instanceof Array)e.ResourceURL.forEach((e=>{"tile"==e._resourceType&&t.urls.push({format:e._format,template:e._template})}));else{let i=e.ResourceURL;i&&"tile"==i._resourceType?t.urls.push({format:i._format,template:i._template}):e.Format&&t.urls.push({format:e.Format,template:this.makeTemplate(t.title)})}function i(e){if(e.LegendURL)return{format:e.LegendURL._format,height:parseInt(e.LegendURL._height),width:parseInt(e.LegendURL._width),href:e.LegendURL["_xlink:href"]}}if(e.Style instanceof Array)e.Style.forEach((e=>{t.styles.push({id:e.Identifier.toString(),legend:i(e),title:e.Title?e.Title.toString():e.Identifier.toString(),default:"true"==e._isDefault})}));else{let r=e.Style;t.styles.push({id:r.Identifier.toString(),legend:i(r),title:r.Title?r.Title.toString():r.Identifier.toString(),default:"true"==r._isDefault})}if(e.TileMatrixSetLink instanceof Array)e.TileMatrixSetLink.forEach((e=>{var i=this.TileMatrixSets.find((t=>t.tileMatrixSetID==e.TileMatrixSet));i&&t.tileMatrixSets.push(i)}));else{let i=e.TileMatrixSetLink;var r=this.TileMatrixSets.find((e=>e.tileMatrixSetID==i.TileMatrixSet));r&&t.tileMatrixSets.push(r)}this.Layers.push(t)}getLevelScales28mm(){const e=12756274*Math.PI/256*100/.028;for(var t=[],i=0;i<25;i++)t[i]=e/(1<<i);return t}getLevelScales96dpi(){const e=12756274*Math.PI/256/.0002645833333333333;for(var t=[],i=0;i<25;i++)t[i]=e/(1<<i);return t}getLevel(e,t){for(var i={minimumLevel:0,maximumLevel:0,tileMatrixLabels:[]},r=-1,n=0;n<e.length;n++){var o=e[n],s=t.findIndex((e=>{let t=1e-4*e;return o.scale<e+t&&o.scale>e-t}));if(!(s<0))if(r<0){i.minimumLevel=r=s;for(var a=0;a<i.minimumLevel;a++)i.tileMatrixLabels[i.tileMatrixLabels.length]="0";i.tileMatrixLabels[i.tileMatrixLabels.length]=o.id}else{if(s!=r+1)break;i.maximumLevel=s,i.tileMatrixLabels[i.tileMatrixLabels.length]=o.id,r+=1}}if(0!=i.tileMatrixLabels.length)return i}getLevel4326(e){let t=this.getLevelScales28mm();t.splice(0,1);var i=this.getLevel(e,t);if(i||(t=this.getLevelScales96dpi(),t.splice(0,1),i=this.getLevel(e,t)),i)return i.tilingScheme="Geographic",i}getLevel3857(e){let t=this.getLevelScales28mm();var i=this.getLevel(e,t);if(i||(t=this.getLevelScales96dpi(),i=this.getLevel(e,t)),i)return i.tilingScheme="WebMercator",i}addTileMatrixSet(e){var t={tileMatrixSetID:e.Identifier.toString(),title:e.Title?e.Title.toString():e.Identifier.toString()},i=[];e.TileMatrix.forEach((e=>{i.push({id:e.Identifier.toString(),scale:parseFloat(e.ScaleDenominator)})}));var r=e.SupportedCRS.toString();t.crs=r,r.indexOf(":4490")>0||r.indexOf(":4326")>0||r.indexOf("OGC:2:84")>0||r.indexOf('UNIT["degree",0.0174532925199')>0?(t.params=this.getLevel4326(i),t.params?this.TileMatrixSets.push(t):Rt.log("not support 4326 tilematrixs:",i)):r.indexOf("3857")>0||r.indexOf("900913")>0?(t.params=this.getLevel3857(i),t.params?this.TileMatrixSets.push(t):Rt.log("not support 4326 tilematrixs:",i)):Rt.log("not support crs:",r)}};let Ft,Nt,Qt;const kt=[],Ut=[];function jt(e,t,i,r,n){Ft=Ft||new Cesium.Cartesian3,Qt=Qt||new Cesium.Cartographic,e>t[t.length-1]&&(e=t[t.length-1]);let o=t.findIndex((t=>t>=e));const s=o+1>t.length-1?t.length-1:o+1,a=o-2<0?0:o-2;kt.length=0,Ut.length=0;for(let e=a;e<=s;++e)kt.push(t[e]),Ut.push(i[3*e],i[3*e+1],i[3*e+2]);return n=function(e,t,i,r,n){if(t.length>2)for(let e=t.length-1;e>1;e--)t[e]<=t[e-1]&&(t.splice(e,1),i.splice(3*e,r));return Cesium.HermitePolynomialApproximation.interpolateOrderZero(e,t,i,r,n)}(e,kt,Ut,r,n),n}const Gt=[],zt=[],Yt=[];function Zt(e,t,i=!1,r){Ft=Ft||new Cesium.Cartesian3,Nt=Nt||new Cesium.Cartesian3,Qt=Qt||new Cesium.Cartographic;const n=e.length;let o=0;const s=zt,a=Yt;s.length=0,a.length=0;const l=Cesium.Cartesian3.fromRadians(...e[0],void 0,Ft);s.push(0),a.push(l.x,l.y,l.z);for(let t=0;t<n-1;++t){const i=Cesium.Cartesian3.fromRadians(...e[t],void 0,Ft),r=Cesium.Cartesian3.fromRadians(...e[t+1],void 0,Nt),n=Cesium.Cartesian3.distance(i,r);n>1e-6&&(o+=n,s.push(o),a.push(r.x,r.y,r.z))}if(i){const t=Cesium.Cartesian3.fromRadians(...e[0],void 0,Ft),i=Cesium.Cartesian3.fromRadians(...e[e.length-1],void 0,Nt),r=Cesium.Cartesian3.distance(i,t);r>1e-6&&(o+=r,s.unshift(-r),a.unshift(i.x,i.y,i.z),s.push(o),a.push(t.x,t.y,t.z),s.push(o+s[2]),a.push(a[6],a[7],a[8]))}const h=o/t,c=Gt;r=r||[],c.length=0;for(let e=0;e<=t;++e){const t=jt(e*h,s,a,3),i=Cesium.Cartesian3.fromElements(...t,Ft),r=Cesium.Cartographic.fromCartesian(i,void 0,Qt);t.splice(0,3,r.longitude,r.latitude,r.height),c.push(t)}return r.splice(0,r.length,...c),r}function Wt(e,t,i,r){if(i.length<1)return;if(t.length!==i.length)return;let n=t.findIndex((t=>t>=e));n<0&&(n=t.length-1);const o=n+1>i.length-1?i.length-1:n+1,s=n-2<0?0:n-2;kt.length=0,Ut.length=0;for(let e=s;e<=o;++e){kt.push(t[e]);const r=Cesium.Cartesian3.fromRadians(...i[e],void 0,Ft);Ut.push(r.x,r.y,r.z)}const a=Cesium.HermitePolynomialApproximation.interpolateOrderZero(e,kt,Ut,3),l=Cesium.Cartesian3.fromElements(...a,Ft),h=Cesium.Cartographic.fromCartesian(l,void 0,Qt);return(r=r||[0,0,0]).splice(0,3,h.longitude,h.latitude,h.height),r}let Xt,Jt,Kt,Vt;function qt(e,t,i,r){if(i.length<1)return;if(r=r||[0,0,0],t.length!==i.length)return;Xt=Xt||new Cesium.HeadingPitchRoll,Jt=Jt||new Cesium.Quaternion,Kt=Kt||new Cesium.Quaternion,Vt=Vt||new Cesium.Quaternion;let n=t.findIndex((t=>t>=e));if(n<0&&(n=t.length-1),0===n)return r.splice(0,3,...i[0]),r;let o=0===n?0:(e-t[n-1])/(t[n]-t[n-1]);o>1&&(o=1);const s=Cesium.Quaternion.fromHeadingPitchRoll(Xt.xbsjFromArray(...i[n-1]),Jt),a=Cesium.Quaternion.fromHeadingPitchRoll(Xt.xbsjFromArray(...i[n]),Kt),l=Cesium.Quaternion.fastSlerp(s,a,o,Vt),h=Cesium.HeadingPitchRoll.fromQuaternion(l,Xt);return h?(r.splice(0,3,h.heading,h.pitch,h.roll),r):void 0}function $t(e,t,i=!1,r,n,o){const s=e.length;let a=0;const l=r||[];if(l.length=0,s<=0)return l;l.push(0);for(let t=0;t<s-1;++t){const i=Cesium.Cartesian3.fromRadians(...e[t],void 0,Ft),r=Cesium.Cartesian3.fromRadians(...e[t+1],void 0,Nt);a+=Cesium.Cartesian3.distance(i,r),l.push(a)}if(i&&s>2){n.length=0,n.push(...e),o.length=0,o.push([0,0,0]),o.push(...t),o.push([...t[0]]),o.push([0,0,0]);const i=Cesium.Cartesian3.fromRadians(...e[0],void 0,Ft),r=Cesium.Cartesian3.fromRadians(...e[e.length-1],void 0,Nt),s=Cesium.Cartesian3.distance(r,i);a+=s,l.unshift(-s),n.unshift([...e[e.length-1]]),l.push(a),n.push([...e[0]]),l.push(a+l[2]),n.push([...n[2]])}return l}_t.interpolatePositions=Zt;const ei={WMTSParser:Ht,distance:_t.distance,hpr:_t.hpr,Math:_t,Calculate:Bt,Check:Pt,TokenHelper:Tt,MilsymbolHelper:Lt},ti={url:"",basePath:"",show:!0,scale:1,minimumPixelSize:0,maximumScale:void 0,allowPicking:!0,incrementallyLoadTextures:!0,asynchronous:!0,clampAnimations:!0,shadows:"ShadowMode.ENABLED",debugShowBoundingVolume:!1,debugWireframe:!1,heightReference:"HeightReference.NONE",distanceDisplayCondition:void 0,color:[1,1,1,1],colorBlendMode:"ColorBlendMode.HIGHLIGHT",colorBlendAmount:.5,silhouetteColor:[1,0,0,1],silhouetteSize:0,lightColor:void 0,luminanceAtZenith:.2,specularEnvironmentMaps:void 0,gvolPosition:[0,0,0],gvolRotation:[0,0,0],gvolScale:[1,1,1],attachedPathGuid:"",cameraAttachedOffsetPosition:[0,0,0],cameraAttachedOffsetRotation:[0,-Math.PI/3,0],viewDistance:50};let ii,ri,ni,oi;class si extends u.Z{constructor(e,t){super(e,t);const i=e.czm.scene;(0,P.extendObservable)(this,{_primitive:void 0},{_primitive:P.observable.ref}),this.disposers.push((()=>{this._primitive&&(i.primitives.remove(this._primitive),this._primitive=void 0)})),this.disposers.push((0,O.Z)(this,"enabled",this,"show")),this._createProperties=["url","allowPicking","incrementallyLoadTextures","asynchronous"],this._updateProperties=["show","scale","minimumPixelSize","maximumScale","clampAnimations","debugShowBoundingVolume","debugWireframe","colorBlendAmount","luminanceAtZenith","gvolPosition","gvolRotation","gvolScale","specularEnvironmentMaps"],this._updateProperties2=["shadows","distanceDisplayCondition","color","colorBlendMode","silhouetteColor","silhouetteSize","heightReference","lightColor"],this._scratchCartesian=new Cesium.Cartesian3,this._scratchModelMatrix=new Cesium.Matrix4;const r=()=>{var e,t,i,r,n,o,s,a,l,h;this._primitive&&(ei.Math.getModelMatrix(this.gvolPosition,this.gvolRotation,this.gvolScale,this._scratchModelMatrix),this._primitive.modelMatrix=this._scratchModelMatrix,this._updateProperties.forEach((e=>{this._primitive[e]=this[e]})),e=this._primitive,t=new Cesium.Cartesian3(.170455150831422,.163151083190219,.196966760289763),i=new Cesium.Cartesian3(-.066550267689383,-.022088055746048,.078835009246127),r=new Cesium.Cartesian3(.038364097478591,.045714300098753,.063498904606215),n=new Cesium.Cartesian3(-.01436536331281,-.026490613715151,-.05018940406602),o=new Cesium.Cartesian3(-.05153278691789,-.050777795729986,-.056449044453032),s=new Cesium.Cartesian3(.043454596136534,.046672590104157,.05753010764661),a=new Cesium.Cartesian3(-.00164046627411,.001286638231156,.007228908989616),l=new Cesium.Cartesian3(-.042260855700641,-.046394335094707,-.057562936365585),h=new Cesium.Cartesian3(-.004953478914091,-.000479681664876,.008508150106928),ii=ii||[t,i,r,n,o,s,a,l,h],e.specularEnvironmentMaps?e.sphericalHarmonicCoefficients=ii:e.sphericalHarmonicCoefficients=void 0)};ri=ri||{"ShadowMode.CAST_ONLY":Cesium.ShadowMode.CAST_ONLY,"ShadowMode.DISABLED":Cesium.ShadowMode.DISABLED,"ShadowMode.ENABLED":Cesium.ShadowMode.ENABLED,"ShadowMode.RECEIVE_ONLY":Cesium.ShadowMode.RECEIVE_ONLY},ni=ni||{"ColorBlendMode.HIGHLIGHT":Cesium.ColorBlendMode.HIGHLIGHT,"ColorBlendMode.REPLACE":Cesium.ColorBlendMode.REPLACE,"ColorBlendMode.MIX":Cesium.ColorBlendMode.MIX},oi=oi||{"HeightReference.NONE":Cesium.HeightReference.NONE,"HeightReference.CLAMP_TO_GROUND":Cesium.HeightReference.CLAMP_TO_GROUND,"HeightReference.RELATIVE_TO_GROUND":Cesium.HeightReference.RELATIVE_TO_GROUND};const n=()=>{this._primitive&&(this._primitive.shadows=ri[this.shadows],this.distanceDisplayCondition?(!this._primitive.distanceDisplayCondition&&(this._primitive.distanceDisplayCondition=new Cesium.DistanceDisplayCondition),this._primitive.distanceDisplayCondition.near=this.distanceDisplayCondition[0],this._primitive.distanceDisplayCondition.far=this.distanceDisplayCondition[1]):this._primitive.distanceDisplayCondition=void 0,this._primitive.color.xbsjFromArray(...this.color),this._primitive.colorBlendMode=ni[this.colorBlendMode],this._primitive.silhouetteColor.xbsjFromArray(...this.silhouetteColor),this._primitive.silhouetteSize=this.silhouetteSize,this._primitive.heightReference=oi[this.heightReference],this.lightColor&&Array.isArray(this.lightColor)&&3===this.lightColor.length?(this._primitive.lightColor=this._scratchLightColor,this._primitive.lightColor.x=this.lightColor[0],this._primitive.lightColor.y=this.lightColor[1],this._primitive.lightColor.z=this.lightColor[2]):this._primitive.lightColor=void 0)};this._color=new Cesium.Color(1,1,1,1),this._silhouetteColor=new Cesium.Color(1,0,0,1),this._scratchLightColor=new Cesium.Cartesian3(1,1,1),this.disposers.push((0,P.reaction)((()=>{const e={};return this._createProperties.forEach((t=>{e[t]=this[t]})),e}),(e=>{this._primitive&&(this._earth.czm.scene.primitives.remove(this._primitive),this._primitive=void 0),e.scene=this._earth.czm.scene,this._primitive=this._earth.czm.scene.primitives.add(Cesium.Model.fromGltf(e)),this._primitive.id=this,this._primitive.color=this._color,this._primitive.silhouetteColor=this._silhouetteColor,r(),n()}))),this.disposers.push((0,P.reaction)((()=>{const e={};return this._updateProperties.forEach((t=>{e[t]=this[t]})),JSON.stringify(e)}),(()=>{r()}))),this.disposers.push((0,P.reaction)((()=>{const e={};return this._updateProperties2.forEach((t=>{e[t]=this[t]})),JSON.stringify(e)}),(()=>{n()}))),this.disposers.push((0,ae.Ak)(this._earth,this,{positionProperty:"gvolPosition"})),this.disposers.push((0,ae.zC)(this._earth,this,{positionPickingProperty:"creating",positionProperty:"gvolPosition"})),this.disposers.push((0,ae.J_)(this._earth,this,{positionProperty:"gvolPosition",rotationProperty:"gvolRotation"})),this.disposers.push((0,ae.lU)(this._earth,this,{cameraAttachedFunc:function(e){const t=[],i=()=>{const t=this;for(let i=0;i<3;++i)e.position[i]=t.gvolPosition[i]+t.cameraAttachedOffsetPosition[i],e.rotation[i]=t.gvolRotation[i]+t.cameraAttachedOffsetRotation[i];e.viewDistance=t.viewDistance};return i(),t.push((0,P.reaction)((()=>({position:[...this.gvolPosition],rotation:[...this.gvolRotation],cameraAttachedOffsetPosition:[...this.cameraAttachedOffsetPosition],cameraAttachedOffsetRotation:[...this.cameraAttachedOffsetRotation],viewDistance:this.viewDistance})),i)),this._earth.camera.tracking.isCameraLike=!1,()=>{t.forEach((e=>e())),t.length=0}}})),(0,P.extendObservable)(this,{_ready:!1,get ready(){return this._ready},set ready(e){this._ready!==e&&(this._ready=e)}},{ready:P.computed}),this._readyDisposer=void 0,this.disposers.push((()=>this._readyDisposer=this._readyDisposer&&this._readyDisposer())),this.disposers.push((0,P.reaction)((()=>this._primitive),(e=>{this._readyDisposer=this._readyDisposer&&this._readyDisposer(),this.ready=!1,e?this._readyDisposer=(()=>{let t=!0;return e.readyPromise.then((()=>{t&&(this.ready=!0),this._readyDisposer=this._readyDisposer&&this._readyDisposer()})),()=>t=!1})():this.ready=!1}))),this.disposers.push(h.Z.registerPathAttachedGuid(this,{positionProperty:"gvolPosition",rotationProperty:"gvolRotation"}));{(0,P.extendObservable)(this,{_selfClicked:!1,_slefHovered:!1});const e=this._earth;this.disposers.push((0,P.reaction)((()=>({sc:this._selfClicked,sh:this._slefHovered})),(()=>{this._selfClicked?(this.silhouetteColor.splice(0,4,...e.interaction.picking.clickedColor),this.silhouetteSize=3):this._slefHovered?(this.silhouetteColor.splice(0,4,...e.interaction.picking.hoveredColor),this.silhouetteSize=3):(this.silhouetteColor.splice(0,4,0,0,0,1),this.silhouetteSize=0)})))}}flyTo(){const e=this._earth.czm.scene.camera;if(e.cancelFlight(),this._flyToDisposer)throw new Error("_flyToDisposer should be undefined!");e._currentFlight={cancelTween:()=>{this._flyToDisposer=this._flyToDisposer&&this._flyToDisposer()}},this.ready?this._earth.camera.flyTo(this.gvolPosition,2*this._primitive.boundingSphere.radius):this._flyToDisposer=(0,P.reaction)((()=>this.ready),(e=>{if(e){if(!this._primitive||!this._primitive.ready)throw new Error("this._primitive.ready should be true!");this._earth.camera.flyTo(this.gvolPosition,2*this._primitive.boundingSphere.radius),this._flyToDisposer=this._flyToDisposer&&this._flyToDisposer()}})),this._flyToOnlyOnce||(this._flyToOnlyOnce=!0,this.disposers.push((()=>{this._flyToDisposer=this._flyToDisposer&&this._flyToDisposer()})))}nativeModel(){return this._primitive}onclick(e){this._selfClicked=!0}onclickout(){this._selfClicked=!1}onmouseover(e){this._slefHovered=!0}onmouseout(){this._slefHovered=!1}}si.ShadowMode={CAST_ONLY:"ShadowMode.CAST_ONLY",DISABLED:"ShadowMode.DISABLED",ENABLED:"ShadowMode.ENABLED",RECEIVE_ONLY:"ShadowMode.RECEIVE_ONLY"},si.ColorBlendMode={HIGHLIGHT:"ColorBlendMode.HIGHLIGHT",REPLACE:"ColorBlendMode.REPLACE",MIX:"ColorBlendMode.MIX"},si.HeightReference={NONE:"HeightReference.NONE",CLAMP_TO_GROUND:"HeightReference.CLAMP_TO_GROUND",RELATIVE_TO_GROUND:"HeightReference.RELATIVE_TO_GROUND"};const ai={title:"Model Property",type:"object",properties:{url:{type:"string",title:"资源URL路径",default:"",description:"资源URL路径"},basePath:{type:"string",title:"The base path that paths in the glTF JSON are relative to.",default:"",description:"The base path that paths in the glTF JSON are relative to."},show:{type:"boolean",title:"是否在三维窗口中显示",default:!0,description:"是否在三维窗口中显示"},scale:{type:"number",title:"A uniform scale applied to this model.",default:1,description:"A uniform scale applied to this model."},minimumPixelSize:{type:"number",title:"The approximate minimum pixel size of the model regardless of zoom.",default:0,description:"The approximate minimum pixel size of the model regardless of zoom."},maximumScale:{type:["number","undefined"],title:"The maximum scale for the model.",default:void 0,description:"The maximum scale for the model."},allowPicking:{type:"boolean",title:"When <code>true</code>, each glTF mesh and primitive is pickable with {@link Scene#pick}.",default:!0,description:"When <code>true</code>, each glTF mesh and primitive is pickable with {@link Scene#pick}."},incrementallyLoadTextures:{type:"boolean",default:!0,description:"Determine if textures may continue to stream in after the model is loaded."},asynchronous:{type:"boolean",default:!0,description:"Determines if model WebGL resource creation will be spread out over several frames or block until completion once all glTF files are loaded."},clampAnimations:{type:"boolean",default:!0,description:"Determines if the model's animations should hold a pose over frames where no keyframes are specified."},shadows:{type:"string",default:"ShadowMode.ENABLED",description:"Determines whether the model casts or receives shadows from each light source."},debugShowBoundingVolume:{type:"boolean",default:!0,description:"For debugging only. Draws the bounding sphere for each {@link DrawCommand} in the model."},debugWireframe:{type:"boolean",default:!1,description:"For debugging only. Draws the model in wireframe."},heightReference:{type:"string",default:"HeightReference.NONE",description:"Determines how the model is drawn relative to terrain."},distanceDisplayCondition:{type:["array","undefined"],default:"undefined",description:" 两个元素的数组，分别表示near和far"},color:{type:"array",items:{type:"number"},minItems:4,maxItems:4,default:[1,1,1,1],description:"颜色叠加"},colorBlendMode:{type:"string",default:"ColorBlendMode.HIGHLIGHT",description:"Defines how the color blends with the mode. "},colorBlendAmount:{type:"number",default:.5,description:"colorBlendAmount"},silhouetteColor:{type:"array",items:{type:"number"},minItems:4,maxItems:4,default:[1,0,0,1],description:"silhouetteColor"},silhouetteSize:{type:"number",default:0,description:"The size of the silhouette in pixels."},luminanceAtZenith:{type:"number",default:.2,description:"材质底色"},specularEnvironmentMaps:{type:["string","undefined"],default:void 0,description:"环境贴图"},gvolPosition:{type:"array",items:{type:"number"},minItems:3,maxItems:3,default:[0,0,0],description:"位置 [经度, 纬度, 高度]"},gvolRotation:{type:"array",items:{type:"number"},minItems:3,maxItems:3,default:[0,0,0],description:"姿态数组 [偏航角、俯仰角、翻转角]"},gvolScale:{type:"array",items:{type:"number"},minItems:3,maxItems:3,default:[1,1,1],description:"姿态数组 [偏航角、俯仰角、翻转角]"},attachedPathGuid:{type:"string",default:"",description:"绑定的路径的guid"},cameraAttachedOffsetPosition:{type:"array",items:{type:"number"},minItems:3,maxItems:3,default:[0,0,0],description:"位置偏移[经度偏移量, 纬度偏移量，高度偏移量]"},cameraAttachedOffsetRotation:{type:"array",items:{type:"number"},minItems:3,maxItems:3,default:[0,-Math.PI/3,0],description:"相机绑定后的姿态偏移"},viewDistance:{type:"number",default:50,description:"相机飞入时的视距设定"}}};si.gvolSchema=ai;si.gvolClassification=[{name:{chinese:"通用",english:"General"},properties:["url","basePath","show","scale","minimumPixelSize","maximumScale","allowPicking","incrementallyLoadTextures","asynchronous","clampAnimations","shadows","debugShowBoundingVolume","debugWireframe","heightReference","distanceDisplayCondition","color","colorBlendMode","colorBlendAmount","silhouetteColor","silhouetteSize","luminanceAtZenith","specularEnvironmentMaps","gvolPosition","gvolRotation","gvolScale","attachedPathGuid","cameraAttachedOffsetPosition","cameraAttachedOffsetRotation","viewDistance"]}],si.defaultOptions=ti,si.gvolEnvirement=R.Z.getScriptBaseUrl("geovisearth.sdk")+"images/envirment-003.ktx",c.Z.registerType(si,"Model2");const li=si;function hi(e){var t=document.createElement("video");return t.src=e,t.style.position="absolute",t.style.zIndex="-100",t.style.visibility="hidden",t.style.top="0",t.style.left="0",t.style.width="100px",t.style.height="100px",t.crossOrigin="",t.autoplay=!0,t.loop=!0,t.muted=!0,document.body.appendChild(t),t}function ci(e){document.body.removeChild(e)}let ui,pi;async function di(e){if(e)return e.endsWith(".m3u8")?(await async function(){return void 0!==window.Hls?Promise.resolve():(ui||(ui=R.Z.loadJS(R.Z.gvolEarthDir+"resources/thirdParty/hls/v0.12.4/hls.min.js")),await ui)}(),function(e){return new Promise(((t,i)=>{const r=new Hls,n=hi("");n.gvolHLS=r,r.attachMedia(n),r.on(Hls.Events.MEDIA_ATTACHED,(()=>{r.loadSource(e),r.on(Hls.Events.MANIFEST_PARSED,((e,i)=>{n.play(),t(n)}))})),r.on(Hls.Events.ERROR,((e,t)=>{const{type:o,details:s,fatal:a}=t;a&&(r.destroy(),ci(n),i(s))}))}))}(e)):e.endsWith(".flv")?(await async function(){return void 0!==window.flvjs?Promise.resolve():(pi||(pi=R.Z.loadJS(R.Z.gvolEarthDir+"resources/thirdParty/flv/20200729/flv.min.js")),await pi)}(),function(e){return new Promise(((t,i)=>{if(!flvjs.isSupported())return void i("flvjs不支持！");const r=hi(""),n=e.lastIndexOf("-.flv"),o=e.substr(0,-1!==n?n:void 0);var s=flvjs.createPlayer({type:"flv",url:o});s.attachMediaElement(r),s.load(),s.play(),r.gvolFlvPlayer=s,t(r)}))}(e)):hi(e)}function mi(e){e.gvolHLS&&(e.gvolHLS.destroy(),e.gvolHLS=void 0),ci(e)}const fi={videoUrl:"",maskUrl:"",position:[0,0,0],rotation:[0,0,0],fovH:Math.PI/3,fovV:Math.PI/6,near:1,far:1e4,showHelper:!0,show:!0};let gi,Ai;function yi({position:e,heading:t,pitch:i,roll:r},n){gi=gi||new Cesium.Quaternion,Ai=Ai||new Cesium.Matrix3;const o=Cesium.Transforms.eastNorthUpToFixedFrame(e,void 0,n);var s=Cesium.Matrix3.fromRotationX(Cesium.Math.PI_OVER_TWO,Ai);return Cesium.Matrix4.multiplyByMatrix3(o,s,o),s=Cesium.Matrix3.fromRotationY(-t,Ai),Cesium.Matrix4.multiplyByMatrix3(o,s,o),s=Cesium.Matrix3.fromRotationX(i,Ai),Cesium.Matrix4.multiplyByMatrix3(o,s,o),s=Cesium.Matrix3.fromRotationZ(-r,Ai),Cesium.Matrix4.multiplyByMatrix3(o,s,o),o}class vi extends u.Z{constructor(e,t){super(e,t),(0,P.extendObservable)(this,{_videoElement:void 0,twoPostionsEditing:!1},{_videoElement:P.observable.ref}),this._cameraVideo=void 0,this._videoElement=void 0,this._disposers=this._disposers||[],this._disposers.push((0,O.Z)(this,"enabled",this,"show")),this._settingVideoElement=void 0,this._disposers.push((()=>{this._settingVideoElement&&(this._settingVideoElement.unsubscribe(),this._settingVideoElement=void 0)})),(0,P.extendObservable)(this,{_imageUrl:""});const i=e=>{this._settingVideoElement&&(this._settingVideoElement.unsubscribe(),this._settingVideoElement=void 0),this._videoElement=this._videoElement&&mi(this._videoElement),this._imageUrl="",e.endsWith(".jpg")||e.endsWith(".png")||e.startsWith("data:image")?this._imageUrl=e:[".ogg",".webm",".mp4",".m3u8",".flv"].some((t=>e.endsWith(t)))&&(this._settingVideoElement=rxjs.from(di(e)).subscribe((e=>{this._videoElement=e})))};this._disposers.push((0,P.reaction)((()=>this.videoUrl),(()=>{i(this.videoUrl)}),{fireImmediately:!0})),this._disposers.push((0,P.reaction)((()=>({_videoElement:this._videoElement,_imageUrl:this._imageUrl,position:[...this.position],rotation:[...this.rotation],fovH:this.fovH,fovV:this.fovV,near:this.near,far:this.far,showHelper:this.showHelper,show:this.show})),(()=>{if(this._cameraVideo){yi({position:Cesium.Cartesian3.fromRadians(this.position[0],this.position[1],this.position[2]),heading:this.rotation[0],pitch:this.rotation[1],roll:this.rotation[2]},this._cameraVideo.inverseViewMatrix);const e=Math.tan(.5*this.fovH)/Math.tan(.5*this.fovV),t=this.fovH>this.fovV?this.fovH:this.fovV;this._cameraVideo.frustum.fov=t,this._cameraVideo.frustum.aspectRatio=e,this._cameraVideo.frustum.near=this.near,this._cameraVideo.frustum.far=this.far,this._cameraVideo.videoElement=this._videoElement||this._imageUrl,this._cameraVideo.showHelperPrimitive=this.showHelper,this._cameraVideo.show=this.show,this._cameraVideo.alphaImage=this.maskUrl}else{if(!this._videoElement&&!this._imageUrl)return;var e=yi({position:Cesium.Cartesian3.fromRadians(this.position[0],this.position[1],this.position[2]),heading:this.rotation[0],pitch:this.rotation[1],roll:this.rotation[2]});const i=Math.tan(.5*this.fovH)/Math.tan(.5*this.fovV),r=this.fovH>this.fovV?this.fovH:this.fovV;var t=new Cesium.PerspectiveFrustum({fov:r,aspectRatio:i,near:this.near,far:this.far});const n=new Cesium.XbsjCameraVideo({inverseViewMatrix:e,frustum:t,videoElement:this._videoElement||this._imageUrl,showHelperPrimitive:this.showHelper});this._earth.czm.scene.primitives.add(n),this._cameraVideo=n,this._cameraVideo._primitive.classificationType=2,this._cameraVideo.show=this.show,this._cameraVideo.alphaImage=this.maskUrl}}))),this._disposers.push((0,P.autorun)((()=>{this.twoPostionsEditing=this._earth.interaction.directionCameraBinding.target===this}))),this._disposers.push((0,P.reaction)((()=>this.twoPostionsEditing),(()=>{this.twoPostionsEditing||this._earth.interaction.directionCameraBinding.target!==this?this.twoPostionsEditing&&(this._earth.interaction.directionCameraBinding.target=this):this._earth.interaction.directionCameraBinding.target=void 0}),{fireImmediately:!0})),this._disposers.push((0,ae.Ak)(this._earth,this)),this._disposers.push((0,ae.J_)(this._earth,this)),this._disposers.push((0,P.reaction)((()=>this.maskUrl),(()=>{this._cameraVideo&&this._cameraVideo.alphaImage!==this.maskUrl&&(this._cameraVideo.alphaImage=this.maskUrl)})))}get isCameraLike(){return!0}get videoElement(){return this._videoElement}setFovAndAspectRatioForCesium(e,t){t>1?(this.fovH=e,this.fovV=2*Math.atan(Math.tan(.5*fovH)/t)):(this.fovV=e,this.fovH=2*Math.atan(t*Math.tan(.5*fovV)))}setFovAndAspectRatioForWebGL(e,t){this.fovV=e,this.fovH=2*Math.atan(t*Math.tan(.5*fovV))}get fov(){return this.fovH>this.fovV?this.fovH:this.fovV}get aspectRatio(){return Math.tan(.5*this.fovH)/Math.tan(.5*this.fovV)}flyTo(){this._earth.czm.scene.camera.flyTo({destination:Cesium.Cartesian3.fromRadians(this.position[0],this.position[1],this.position[2]),orientation:{heading:this.rotation[0],pitch:this.rotation[1],roll:this.rotation[2]}})}setPositionWithCurrentCamera(){const e=this._earth.czm.scene.camera,t=e.positionCartographic;this.position=[t.longitude,t.latitude,t.height],this.rotation=[e.heading,e.pitch,e.roll]}destroy(){return this._disposers&&this._disposers.forEach((e=>e())),this._disposers.length=0,this._videoElement=this._videoElement&&mi(this._videoElement),this._cameraVideo&&(this._earth.czm.scene.primitives.remove(this._cameraVideo),this._cameraVideo=void 0),super.destroy()}}vi.defaultOptions=fi,c.Z.registerType(vi,"CameraVideo");const Ci=vi,_i={position:[0,0,0],rotation:[0,0,0],fovH:Math.PI/3,fovV:Math.PI/6,near:5,far:200,show:!0};class bi extends u.Z{constructor(e,t){super(e,t),(0,P.extendObservable)(this,{twoPostionsEditing:!1}),this._viewshed=new Cesium.XbsjViewshed(e.czm.scene),this._earth.czm.scene.primitives.add(this._viewshed),this._disposers=this._disposers||[],this._disposers.push((0,O.Z)(this,"enabled",this,"show")),this._disposers.push((0,P.autorun)((()=>{this._viewshed.position=Cesium.Cartesian3.fromRadians(this.position[0],this.position[1],this.position[2]),this._viewshed.heading=this.rotation[0],this._viewshed.pitch=this.rotation[1],this._viewshed.roll=this.rotation[2],this._viewshed.fovH=this.fovH,this._viewshed.fovV=this.fovV,this._viewshed.near=this.near,this._viewshed.far=this.far,this._viewshed.enabled=this.show}))),this._disposers.push((0,P.autorun)((()=>{this.twoPostionsEditing=this._earth.interaction.directionCameraBinding.target===this}))),this._disposers.push((0,P.reaction)((()=>this.twoPostionsEditing),(()=>{this.twoPostionsEditing||this._earth.interaction.directionCameraBinding.target!==this?this.twoPostionsEditing&&(this._earth.interaction.directionCameraBinding.target=this):this._earth.interaction.directionCameraBinding.target=void 0}),{fireImmediately:!0})),this._disposers.push((0,ae.Ak)(this._earth,this)),this._disposers.push((0,ae.J_)(this._earth,this))}get isCameraLike(){return!0}flyTo(){this._earth.czm.scene.camera.flyTo({destination:Cesium.Cartesian3.fromRadians(this.position[0],this.position[1],this.position[2]),orientation:{heading:this.rotation[0],pitch:this.rotation[1],roll:this.rotation[2]}})}setPositionWithCurrentCamera(){const e=this._earth.czm.scene.camera,t=e.positionCartographic;(0,P.runInAction)((()=>{this.position=[t.longitude,t.latitude,t.height],this.rotation=[e.heading,e.pitch,e.roll]}))}destroy(){return this._disposers.forEach((e=>e())),this._disposers.length=0,this._earth.czm.scene.primitives.remove(this._viewshed),this._viewshed=void 0,super.destroy()}}bi.defaultOptions=_i,c.Z.registerType(bi,"Viewshed");const wi=bi;var Pi=i(8572),Si=i(6512);let xi;function Bi(e){e._cameraModelsPool||(e._cameraModelsPool=[],e._createCameraModel=function(){return e._cameraModelsPool.length>0?e._cameraModelsPool.pop():function(e){xi=xi||R.Z.getScriptBaseUrl("geovisearth.sdk");const t=e.czm.scene.primitives.add(Cesium.Model.fromGltf({url:xi+"models/camera1/camera1.gltf?k=path",allowPicking:!1,forwardAxis:Cesium.Axis.X}));t.opaquePass=Cesium.Pass.OVERLAY,t.cull=!1,t.shadows=Cesium.ShadowMode.DISABLED,t.luminanceAtZenith=1.2;const i=t.modelMatrix,r=e.czm.scene.preUpdate.addEventListener((()=>{const r=Cesium.Cartesian3.fromArray([i[12],i[13],i[14]]),n=Cesium.xbsjGetScreenScale(e.czm.scene,r,30);t.scale=n}));return t._gvol_disposeScale=r,t}(e)},e._destroyCameraModel=function(t){e._cameraModelsPool.push(t)},e.disposers.push((()=>{e._cameraModelsPool.forEach((t=>{e.czm.scene.primitives.remove(t),t._gvol_disposeScale&&(t._gvol_disposeScale(),t._gvol_disposeScale=void 0)})),e._cameraModelsPool.length=0})))}class Mi extends u.Z{constructor(e,t){super(e,t),Bi(e),this.disposers.push(h.Z.registerPosition(this)),this.disposers.push(h.Z.registerRotation(this)),this.disposers.push((0,P.reaction)((()=>({position:[...this.position],rotation:[...this.rotation]})),(()=>{this._updateCameraPostionAndRotation()}))),this._cameraModel=void 0;const i=()=>{const t=this.show;t&&!this._cameraModel?(this._cameraModel=e._createCameraModel(),this._updateCameraPostionAndRotation(),this._cameraModel.show=!0):!t&&this._cameraModel&&(this._cameraModel.show=!1,e._destroyCameraModel(this._cameraModel),this._cameraModel=void 0)};this.disposers.push((0,P.autorun)(i)),this.disposers.push((()=>{this.show=!1,i()}))}_updateCameraPostionAndRotation(){if(this._cameraModel){const e=new Cesium.HeadingPitchRoll(...this.rotation);e.heading-=Cesium.Math.PI_OVER_TWO;const t=Cesium.Cartesian3.fromRadians(...this.position,void 0,new Cesium.Cartesian3);(0,Cesium.Transforms.headingPitchRollToFixedFrame)(t,e,void 0,void 0,this._cameraModel.modelMatrix)}}get isCameraLike(){return!0}}Mi.defaultOptions={position:[0,0,0],rotation:[0,0,0],show:!1},c.Z.registerType(Mi,"CameraHelper");const Ei=Mi;var Ti=i(5011),Oi=i(5108);let Li,Di;function Ii(e,t,i,r,n,o){Di=Di||[0,0,0];const s=Di;let a,l,h=e+.01;return h>r?(h=e-.01,h>=0&&(Wt(h,i,n,s),a=s,l=t)):(Wt(h,i,n,s),a=t,l=s),a&&l&&(ei.Math.hpr(a,l,o),o[0]+=.5*Math.PI),o}class Ri extends u.Z{constructor(e,t){super(e,t),this._polyline=new Si.Z(e),this.disposers.push((()=>this._polyline.destroy())),this.disposers.push((0,O.j)(this._polyline,"positions",this,"positions")),this.disposers.push((0,O.j)(this._polyline,"loop",this,"loop")),this._polyline.show=this.enabled&&this.show&&this.showHelper,this.disposers.push((0,P.reaction)((()=>this.enabled&&this.show&&this.showHelper),(e=>{this._polyline.show=e,this._polyline.showHelper=e}))),this.disposers.push((0,ae.wt)(this._earth,this,{polylineCreatingProperty:"creating"})),this.disposers.push((0,ae.ih)(this._earth,this,{polylineEditingProperty:"editing"})),this._cameras=[],this.disposers.push((()=>{this._cameras.forEach((e=>e.destroy())),this._cameras.length=0})),this.disposers.push((0,P.intercept)(this,"rotations",(e=>("update"===e.type&&this.rotations.splice(0,this.rotations.length,...e.newValue),null)))),this.disposers.push((0,P.intercept)(this.rotations,(e=>{if("splice"===e.type){for(let t=e.index;t<e.index+e.removedCount;++t)this._cameras[t].destroy();const t=e.added.map((()=>new Ei(this._earth)));this._cameras.splice(e.index,e.removedCount,...t)}return e}))),this.disposers.push((0,P.reaction)((()=>({positions:[...this.positions.map((e=>[...e]))],rotations:[...this.rotations.map((e=>[...e]))],show:this.enabled&&this.show&&this.showDirection})),(()=>{if(this.positions.length!==this.rotations.length)return;for(let e=0;e<this.positions.length;++e){const t=this.rotations[e],i=this.positions[e];this._cameras[e].position=i,this._cameras[e].rotation=t}const e=this.enabled&&this.show&&this.showDirection;this._cameras.forEach((t=>t.show=e))}))),this._curve=new Si.Z(e),this._curve.arcType="NONE",this._curve.show=this.enabled&&this.show,this.disposers.push((()=>this._curve=this._curve&&this._curve.destroy())),this.disposers.push((0,P.reaction)((()=>this.enabled&&this.show),(e=>{this._curve.show=e}))),(0,P.extendObservable)(this,{currentD:0,currentShow:!1,_currentPosition:[0,0,0],_currentRotation:[0,0,0],get currentPosition(){return this._currentPosition},get currentRotation(){return this._currentRotation}},{currentPosition:P.computed,currentRotation:P.computed}),this.fromJsonFilterKeys.push("currentD","currentShow"),this.disposers.push((0,P.reaction)((()=>({positions:[...this.positions.map((e=>[...e]))],slices:this.slices,loop:this.loop})),(()=>{this.positions.length<3||Zt(this.positions,this.slices,this.loop,this._curve.positions)}))),(0,P.extendObservable)(this,{_loopPositions:[],_loopRotations:[],_ds:[],get ds(){return this._ds},get length(){if(this.loop&&this._ds.length>2)return this._ds[this._ds.length-2];return 0===this._ds.length?0:this._ds[this._ds.length-1]}},{ds:P.computed,length:P.computed}),this.disposers.push((0,P.reaction)((()=>({cameraAttached:this.cameraAttached,loop:this.loop,positions:[...this.positions.map((e=>[...e]))],rotations:[...this.rotations.map((e=>[...e]))]})),(()=>{this._updateCurrentPositionAndRotation()}),{delay:100})),this.disposers.push((0,P.observe)(this,"currentD",(()=>{this._updateCurrentPositionAndRotation()}))),this._currentCamera=new Ei(this._earth),this._currentPoints=new Ti.Z(this._earth),this.disposers.push((()=>{this._currentCamera=this._currentCamera&&this._currentCamera.destroy(),this._currentPoints=this._currentPoints&&this._currentPoints.destroy()})),this._currentPoints.points.push({});this.disposers.push((0,P.reaction)((()=>({show:this.enabled&&this.currentShow,position:[...this.currentPosition],rotation:[...this.currentRotation]})),(()=>{const e=this.enabled&&this.currentShow;this._currentCamera.show=e,this._currentPoints.show=e,e&&(this._currentPoints.points[0].position=[...this.currentPosition],this._currentCamera.position=this.currentPosition,this._currentCamera.rotation=this.currentRotation)}))),(0,P.extendObservable)(this,{_target:[0,0,0],_targetEnabled:!1}),this.disposers.push((0,P.reaction)((()=>({_targetEnabled:this._targetEnabled,_target:this._target&&[...this._target]||void 0})),(()=>{this._targetEnabled&&this.targetTo(this._target)}))),this.disposers.push((0,ae.zC)(this._earth,this,{positionPickingProperty:"targetPicking",positionProperty:"_target"})),this.disposers.push((0,P.intercept)(this,"targetPicking",(e=>(this._targetEnabled=e.newValue,e)))),(0,P.extendObservable)(this,{_pathPlayingListener:void 0,get playing(){return!!this._pathPlayingListener},set playing(e){e&&!this._pathPlayingListener?this._play():!e&&this._pathPlayingListener&&(this._pathPlayingListener=this._pathPlayingListener&&this._pathPlayingListener())}},{_pathPlayingListener:P.observable.ref,playing:P.computed}),this.disposers.push((()=>{this.playing=!1})),this.disposers.push((0,ae.lU)(this._earth,this,{cameraAttachedFunc:function(e){const t=[];return t.push((0,P.reaction)((()=>({currentPosition:[...this.currentPosition],currentRotation:[...this.currentRotation],cameraAttachedOffsetPosition:[...this.cameraAttachedOffsetPosition],cameraAttachedOffsetRotation:[...this.cameraAttachedOffsetRotation],viewDistance:this.viewDistance})),(t=>{for(let i=0;i<3;++i)e.position[i]=t.currentPosition[i]+t.cameraAttachedOffsetPosition[i],e.rotation[i]=t.currentRotation[i]+t.cameraAttachedOffsetRotation[i];e.viewDistance=t.viewDistance}))),this._earth.camera.tracking.isCameraLike=!0,()=>{t.forEach((e=>e())),t.length=0}}}))}_updateCurrentPositionAndRotation(){const e=this.currentD;this._ds=$t(this.positions,this.rotations,this.loop,this._ds,this._loopPositions,this._loopRotations);const t=this.loop?this._loopPositions:this.positions,i=this.loop?this._loopRotations:this.rotations;Wt(e,this._ds,t,this._currentPosition),this.alwaysAlongThePath?Ii(e,this._currentPosition,this._ds,this.length,t,this._currentRotation):qt(e,this._ds,i,this._currentRotation)}addHeight(e){this.positions.forEach((t=>t[2]+=e))}targetTo(e,t){this.positions.length===this.rotations.length&&this.positions.forEach(((i,r)=>{t&&!~t.indexOf(r)||(ei.Math.hpr(i,e,this.rotations[r]),this.rotations[r][0]+=Cesium.Math.PI_OVER_TWO)}))}directionAlongThePath(e){var t=this.positions.length;for(let i=0;i<t;++i)if(!e||~e.indexOf(i)){const e=i+(this.loop?1:0),t=this.loop?this._loopPositions:this.positions;Ii(this._ds[e],t[e],this._ds,this.length,t,this.rotations[i])}}directionLerpBetween(e=0,t=-1){if(-1===t&&(t=this.positions.length-1),t<e)return void Oi.warn("directionLerpBetween 参数错误！");this.directionLerpBetween_scratchDs=[],$t(this.positions,this.rotations,!1,this.directionLerpBetween_scratchDs);const i=[this._ds[e],this._ds[t]],r=[this.rotations[e],this.rotations[t]];for(let n=e+1;n<t;++n)qt(this._ds[n],i,r,this.rotations[n])}flyTo(){this._polyline.flyTo()}get isCameraLike(){return!0}currentCameraApply(){Li=Li||new Cesium.Cartesian3;const e=this._earth.czm.scene;Cesium.Cartesian3.fromRadians(...this.currentPosition,void 0,Li);e.camera.setView({destination:Li,orientation:{heading:this.currentRotation[0],pitch:this.currentRotation[1],roll:this.currentRotation[2]}})}_play(){const e=this._earth.czm.scene;this.currentSpeed>0&&this.currentD===this.length&&(this.currentD=0),this.currentSpeed<0&&0===this.currentD&&(this.currentD=this.length);let t=Date.now();this._pathPlayingListener=e.postUpdate.addEventListener(((e,i)=>{let r=Date.now(),n=r-t;if(t=r,this.currentSpeed>0){const e=this.currentD+.001*n*this.currentSpeed;this.loopPlay?e>this.length?this.currentD=0:this.currentD=e:e>this.length?(this.currentD=this.length,this._pathPlayingListener=this._pathPlayingListener&&this._pathPlayingListener()):this.currentD=e}else{const e=this.currentD+.001*n*this.currentSpeed;this.loopPlay?this.currentD=e<0?this.length:e:e<0?(this.currentD=0,this._pathPlayingListener=this._pathPlayingListener&&this._pathPlayingListener()):this.currentD=e}}))}destroy(){return super.destroy()}}Ri.defaultOptions={positions:[],rotations:[],show:!0,showHelper:!1,showDirection:!1,loop:!1,slices:100,alwaysAlongThePath:!1,cameraAttachedOffsetPosition:[0,0,0],cameraAttachedOffsetRotation:[0,0,0],viewDistance:0,currentSpeed:50,loopPlay:!1};Ri.gvolSchema={title:"Path Property",type:"object",properties:{show:{type:"boolean",title:"显示路径",default:"true",description:"显示路径"},showHelper:{type:"boolean",title:"辅助线框",default:"false",description:"辅助线框"},showDirection:{type:"boolean",title:"显示方向",default:"true",description:"显示方向"},loop:{type:"boolean",title:"是否为环线",default:"false",description:"是否为环线"},slices:{type:"number",title:"曲线分段数",default:"100",description:"曲线分段数"},alwaysAlongThePath:{type:"boolean",title:"始终沿着路径方向运动",default:"false",description:"始终沿着路径方向运动"},currentSpeed:{type:"number",title:"当前播放速度，单位为米",default:50,description:"当前播放速度，单位为米"},loopPlay:{type:"boolean",title:"是否循环播放",default:"false",description:"是否循环播放"}}};Ri.gvolClassification=[{name:{chinese:"通用",english:"General"},properties:["show","showHelper","showDirection","loop","slices","alwaysAlongThePath"]}],c.Z.registerType(Ri,"Path");const Hi=Ri;var Fi=i(1930),Ni=i(637);class Qi extends h.Z{constructor(){let e,t;super(),(0,P.extendObservable)(this,{mutexCollection:[]}),this.disposers.push((0,Ni.aT)(this,"mutexCollection",(i=>{const r=i,n=(0,P.intercept)(r.binding,r.property,(i=>(!r.isValidFunc(i.newValue)||e&&e===r.binding&&e[t]===r.binding[r.property]||(e=r.binding,t=r.property,this.mutexCollection.forEach((i=>{i.binding===e&&i.property===t||i.validFunc(i.binding,i.property)}))),i)));return i._binding=n,i}),(e=>{e._binding=e._binding&&e._binding()})))}destroy(){return this.mutexCollection=[],super.destroy()}}Qi.isDefined=function(e){return void 0!==e},Qi.setUndefined=function(e,t){void 0!==e[t]&&(e[t]=void 0)},Qi.isTrue=function(e){return!!e},Qi.setFalse=function(e,t){e[t]&&(e[t]=!1)},Qi.isStringValid=function(e){return!!e},Qi.setStringEmpty=function(e,t){e[t]&&(e[t]="")};Qi.createObj=e=>({binding:e[0],property:e[1],isValidFunc:e[2],validFunc:e[3]});const ki=Qi;const Ui={};["airfield","airport","alcohol-shop","america-football","art-gallery","bakery","bank","bar","baseball","basketball","beer","bicycle","building","bus","cafe","camera","campsite","car","cemetery","cesium","chemist","cinema","circle","circle-stroked","city","clothing-store","college","commercial","cricket","cross","dam","danger","disability","dog-park","embassy","emergency-telephone","entrance","farm","fast-food","ferry","fire-station","fuel","garden","gift","golf","grocery","hairdresser","harbor","heart","heliport","hospital","ice-cream","industrial","land-use","laundry","library","lighthouse","lodging","logging","london-underground","marker","marker-stroked","minefield","mobilephone","monument","museum","music","oil-well","park","park2","parking","parking-garage","pharmacy","pitch","place-of-worship","playground","police","polling-place","post","prison","rail","rail-above","rail-light","rail-metro","rail-underground","religious-christian","religious-jewish","religious-muslim","restaurant","roadblock","rocket","school","scooter","shop","skiing","slaughterhouse","soccer","square","square-stroked","star","star-stroked","suitcase","swimming","telephone","tennis","theatre","toilets","town","town-hall","triangle","triangle-stroked","village","warehouse","waste-basket","water","wetland","zoo"].forEach((e=>Ui[e]=e));const ji=Ui;class Gi{constructor(){const e=document.createElement("div");e.style.position="absolute",e.style.width="500px",e.style.height="400px",e._width=500,e._height=400,e.style.left="0px",e._left=0,e.style.bottom="0px",e._bottom=0,document.body.appendChild(e);const t=document.createElement("iframe");t.style.width="100%",t.style.height="100%",e.appendChild(t),e.style.display="none",e._show=!1,this._wrapper=e,this._iframe=t}setPosition(e,t){const i=this._wrapper;i._left===e&&i._bottom===t||(i.style.left=`${e}px`,i._left=e,i.style.bottom=`${t}px`,i._bottom=t)}set show(e){const t=this._wrapper;t._show!==!!e&&(t._show=!!e,t._show?t.style.display="block":t.style.display="none")}get show(){return this._wrapper._show}set uri(e){const t=this._iframe;t.src!==e&&(t.src=e)}get uri(){return this._iframe.src}set width(e){const t=this._wrapper;t.width!==e&&(t._width=e,t.style.width=`${e}px`)}get width(){return this._wrapper._width}set height(e){const t=this._wrapper;t.height!==e&&(t._height=e,t.style.height=`${e}px`)}get height(){return this._wrapper._height}destroy(){document.body.removeChild(this._wrapper),this._wrapper=void 0,this._iframe=void 0}}var zi=i(5108);class Yi extends u.Z{constructor(e,t){super(e,t),h.Z.registerPosition(this),h.Z.registerProperty(this,"pinBuilder"),this.disposers.push((0,ae.Ak)(this._earth,this,{positionEditingProperty:"editing"})),this.disposers.push((0,ae.zC)(this._earth,this,{positionPickingProperty:"creating"})),this.disposers.push((0,ae.lU)(this._earth,this,{cameraAttachedFunc:function(e){const t=[];return t.push((0,Fi.Z)(e,"position",this,"position")),e.rotation=[0,-Math.PI/3,0],t.push((0,Fi.Z)(e,"viewDistance",this,"viewDistance")),this._earth.camera.tracking.isCameraLike=!1,t.push((0,P.reaction)((()=>({position:[...this.position],cameraAttachedOffsetPosition:[...this.cameraAttachedOffsetPosition],cameraAttachedOffsetRotation:[...this.cameraAttachedOffsetRotation],viewDistance:this.viewDistance})),(t=>{for(let i=0;i<3;++i)e.position[i]=t.position[i]+t.cameraAttachedOffsetPosition[i],e.rotation[i]=t.cameraAttachedOffsetRotation[i];e.viewDistance=t.viewDistance}))),this._earth.camera.tracking.isCameraLike=!1,()=>{t.forEach((e=>e())),t.length=0}}})),this._pinBuilder=this._earth._pinBuilder;const i=this._earth.czm.viewer;(0,P.extendObservable)(this,{_winPos:[0,0,0,0],get winPos(){return this._winPos}},{winPos:P.computed}),this._cartesian=new Cesium.Cartesian3,this._winCartesian=new Cesium.Cartesian2;const r=()=>{if(this.computingWinPos||this.imageUrl&&this.isDivImage)try{const t=this._earth.czm.scene,i=Cesium.Cartesian3.fromRadians(...this.position,void 0,this._cartesian);if(i){const r=t.cartesianToCanvasCoordinates(i,this._winCartesian);if(r){const t=e.czm.viewer.canvas.clientHeight,i=e.czm.viewer.canvas.clientWidth;this._winPos.splice(0,4,r.x,r.y,i-r.x,t-r.y)}}}catch(e){zi.warn("Pin计算窗口坐标时有误")}};this.disposers.push((0,P.autorun)((()=>r()))),this.disposers.push((()=>{const e=this._earth,t=rxjs.race(e.eventSource.contextSizeChanged,e.eventSource.cameraChanged).subscribe(r);return()=>{t.unsubscribe()}})()),this._position=Cesium.Cartesian3.fromDegrees(0,0,0),this._billboardEnt=i.entities.add({name:this.name,position:this._position,point:{pixelSize:5,color:Cesium.Color.YELLOW,outlineColor:Cesium.Color.BLACK,outlineWidth:1},billboard:{verticalOrigin:Cesium.VerticalOrigin.BOTTOM,horizontalOrigin:Cesium.HorizontalOrigin.CENTER,scale:1},label:{text:"",style:Cesium.LabelStyle.FILL_AND_OUTLINE,font:"48px 楷体",fillColor:Cesium.Color.WHITE,outlineColor:Cesium.Color.BLACK,outlineWidth:6,scale:.5,disableDepthTestDistance:1e9,verticalOrigin:Cesium.VerticalOrigin.BOTTOM,horizontalOrigin:Cesium.HorizontalOrigin.LEFT,pixelOffset:new Cesium.Cartesian2(20,-25),verticalOrigin:Cesium.VerticalOrigin.BOTTOM},polyline:{show:!1,positions:[]}}),this.disposers.push((()=>{i.entities.remove(this._billboardEnt)})),this._billboardEnt._gvolOwner=this,this.disposers.push((()=>{this._billboardEnt&&i.entities.remove(this._billboardEnt),this._billboardEnt=void 0})),this._fillColor=new Cesium.Color(...this.pinBuilder.fillColor),this._outlineColor=new Cesium.Color(...this.pinBuilder.outlineColor),this.disposers.push((0,P.autorun)((()=>{this._fillColor.xbsjFromArray(...this.pinBuilder.fillColor),this._outlineColor.xbsjFromArray(...this.pinBuilder.outlineColor),this.imageUrl&&this.isDivImage?this._billboardEnt.show=!1:(this.imageUrl&&!this.isDivImage?this._billboardEnt.billboard.image=this.imageUrl:this.pinBuilder.makiIcon?this._billboardEnt.billboard.image=this._pinBuilder.fromMakiIconId(this.pinBuilder.makiIcon,this._outlineColor,this.pinBuilder.size,this._fillColor):this.pinBuilder.text?this._billboardEnt.billboard.image=this._pinBuilder.fromText(this.pinBuilder.text,this._outlineColor,this.pinBuilder.size,this._fillColor):this._billboardEnt.billboard.image=this._pinBuilder.fromColor(this._outlineColor,this.pinBuilder.size,this._fillColor),this._billboardEnt.label.outlineColor=this._outlineColor,this._billboardEnt.label.fillColor=this._fillColor,this._billboardEnt.polyline.material=this._outlineColor)}))),(0,P.extendObservable)(this,{_innerShow:!1});const n=()=>{const e=this.position.xepd(this._earth.camera.position);e>this.near&&e<this.far?this._innerShow=!0:this._innerShow=!1};n(),this.disposers.push((0,P.reaction)((()=>({cameraPos:[...this._earth.camera.position],pos:[...this.position],near:this.near,far:this.far})),n));const o=()=>{if(this.imageUrl&&this.isDivImage){if(!this._divImage){const e=document.createElement("img");this.earth.czm.viewer.container.appendChild(e),this._divImage=e,this.disposers.push((()=>{this.earth.czm.viewer.container.removeChild(this._divImage),this._divImage=void 0}))}this._currentImageUrl&&this._currentImageUrl===this.imageUrl||(this._divImage.src=this.imageUrl,this._currentImageUrl=this.imageUrl,this._divImage.style.position="absolute",this._divImage.style.left="0px",this._divImage.style.bottom="0px",this._divImage.style.pointerEvents="none",this._divImage.style.display="none",this._divImage.onload=()=>{zi.log("divImage onload, width: ",this._divImage.naturalWidth),o()})}const e=!!this.imageUrl&&this.isDivImage&&this._divImage&&this.enabled&&this.show&&this._innerShow;if(this._divImage){const t=this._divImage;t.style.display=e?"block":"none",t.style.width!==this.scale*t.naturalWidth+"px"&&(t.style.width=this.scale*t.naturalWidth+"px"),t.style.height!==this.scale*t.naturalHeight+"px"&&(t.style.height=this.scale*t.naturalHeight+"px"),t.style.left!==`${this.winPos[0]}px`&&(t.style.left=this.winPos[0]-this.origin[0]*t.naturalWidth*this.scale+"px"),t.style.bottom!==`${this.winPos[3]}px`&&(t.style.bottom=this.winPos[3]-this.origin[1]*t.naturalHeight*this.scale+"px")}const t=this.enabled&&this.show&&!this.isDivImage;this._billboardEnt.show=t};o(),this.disposers.push((0,P.reaction)((()=>({enabled:this.enabled,show:this.show,isDivImage:this.isDivImage,_innerShow:this._innerShow,imageUrl:this.imageUrl,origin:[...this.origin],winPos:[...this.winPos]})),o)),this.disposers.push((0,P.autorun)((()=>{this._billboardEnt.label.text=this.pinBuilder.extText,this._billboardEnt.label.font=this.pinBuilder.extTextFont,this._billboardEnt.label.pixelOffset=new Cesium.Cartesian2(this.pinBuilder.extTextPixelOffset[0],this.pinBuilder.extTextPixelOffset[1])}))),(0,P.extendObservable)(this,{_innerScale:1}),this.disposers.push((0,P.autorun)((()=>{this._billboardEnt.name=this.name,this._position=Cesium.Cartesian3.fromRadians(...this.position,void 0,this._position),this._billboardEnt.position=this._position;const e=this.scale*this._innerScale;this._billboardEnt.billboard.scale=e})));const s=()=>{const e=[Cesium.HorizontalOrigin.LEFT,Cesium.HorizontalOrigin.CENTER,Cesium.HorizontalOrigin.RIGHT],t=[Cesium.VerticalOrigin.BOTTOM,Cesium.VerticalOrigin.CENTER,Cesium.VerticalOrigin.TOP];this._billboardEnt.billboard.horizontalOrigin=e[2*this.origin[0]|0],this._billboardEnt.billboard.verticalOrigin=t[2*this.origin[1]|0]};s(),this.disposers.push((0,P.reaction)((()=>[...this.origin]),s)),this._distanceDisplayCondition=new Cesium.DistanceDisplayCondition(this.near,this.far),this.disposers.push((0,P.autorun)((()=>{this.near<this.far?(this._distanceDisplayCondition.near=this.near,this._distanceDisplayCondition.far=this.far,this._billboardEnt.billboard.distanceDisplayCondition=this._distanceDisplayCondition,this._billboardEnt.point.distanceDisplayCondition=this._distanceDisplayCondition,this._billboardEnt.label.distanceDisplayCondition=this._distanceDisplayCondition):zi.warn("this.near >= this.far, pin error!");const e=this.disableDepthTestDistance>1e7?1e7:this.disableDepthTestDistance;this._billboardEnt.billboard.disableDepthTestDistance=e,this._billboardEnt.point.disableDepthTestDistance=e,this._billboardEnt.label.disableDepthTestDistance=e}))),this.disposers.push((0,P.autorun)((()=>{this._billboardEnt.point.show=this.enabled&&this.show&&this.pointShow})));const a=new Cesium.Cartesian3,l=new Cesium.Cartesian3,c=()=>{this._billboardEnt.polyline.show=this.enabled&&this.show&&this.lineShow;const e=Cesium.Cartesian3.fromRadians(this.position[0],this.position[1],this.position[2],void 0,a),t=Cesium.Cartesian3.fromRadians(this.position[0],this.position[1],this.position[2]-this.lineHeight,void 0,l);this._billboardEnt.polyline.positions=[e,t]};c(),this.disposers.push((0,P.reaction)((()=>({position:[...this.position],lineShow:this.lineShow,lineHieght:this.lineHeight})),c));{this._mutex=new ki,this.disposers.push((()=>this._mutex=this._mutex&&this._mutex.destroy()));const e=ki.isStringValid,t=ki.setStringEmpty,i=[ki.createObj([this,"imageUrl",e,t]),ki.createObj([this.pinBuilder,"text",e,t]),ki.createObj([this.pinBuilder,"makiIcon",e,t])];this._mutex.mutexCollection=i}this.disposers.push(h.Z.registerPathAttachedGuid(this)),h.Z.registerProperty(this,"iframe"),this._popupIframe=void 0,this.disposers.push((()=>{this._popupIframe=this._popupIframe&&this._popupIframe.destroy()})),this.disposers.push((0,P.reaction)((()=>this.iframe.uri),(()=>{""===this.iframe.uri?this._popupIframe&&(this._popupIframe.show=!1,this._popupIframe.uri=""):(this._createPopupIframe(),this._popupIframe.show&&this._popupIframe.uri!==this.iframe.uri&&(this._popupIframe.uri=this.iframe.uri))}))),this.disposers.push((0,P.reaction)((()=>({width:this.iframe.width,height:this.iframe.height})),(()=>{if(this._popupIframe&&this._popupIframe.show){const{width:e,height:t}=this.iframe;this._popupIframe.width=e,this._popupIframe.height=t}}))),this.disposers.push((0,P.reaction)((()=>({winPos:[...this.winPos],offsetX:this.iframe.offsetX,offsetY:this.iframe.offsetY})),(()=>{if(this._popupIframe&&this._popupIframe.show){const{winPos:[e,t,i,r]}=this;this._popupIframe.setPosition(e+this.iframe.offsetX,r+this.iframe.offsetY)}})))}_createPopupIframe(){if(!this._popupIframe){this._popupIframe=new Gi,this._popupIframe.show=!1,this._popupIframe.width=this.iframe.width,this._popupIframe.height=this.iframe.height;const{winPos:[e,t,i,r]}=this;this._popupIframe.setPosition(e+this.iframe.offsetX,r+this.iframe.offsetY)}}onmouseover(){this._innerScale=1.1}onmouseout(){this._innerScale=1}onclick(){if(""!==this.iframe.uri&&this._popupIframe&&!this._popupIframe.show){this._popupIframe.show=!0,this._popupIframe.uri!==this.iframe.uri&&(this._popupIframe.uri=this.iframe.uri);const{width:e,height:t}=this.iframe;this._popupIframe.width=e,this._popupIframe.height=t;const{winPos:[i,r,n,o]}=this;this._popupIframe.setPosition(i+this.iframe.offsetX,o+this.iframe.offsetY)}}onclickout(){this._popupIframe&&this._popupIframe.show&&(this._popupIframe.show=!1)}flyTo(){this._earth.camera.flyTo(this.position,this.viewDistance,[0,-Math.PI/3,0])}destroy(){return super.destroy()}}Yi.defaultOptions={position:[0,0,0],scale:1,imageUrl:"",isDivImage:!1,origin:[.5,0],pinBuilder:{text:"",extText:"",extTextFont:"48px 楷体",extTextPixelOffset:[30,-20],makiIcon:"",size:48,fillColor:[1,1,1,1],outlineColor:[0,.5,0,1]},iframe:{uri:"",width:500,height:400,offsetX:-250,offsetY:60},near:0,far:Number.MAX_VALUE,disableDepthTestDistance:Number.MAX_VALUE,show:!0,attachedPathGuid:"",pointShow:!1,lineShow:!1,lineHeight:0,computingWinPos:!0,cameraAttachedOffsetPosition:[0,0,0],cameraAttachedOffsetRotation:[0,-Math.PI/3,0],viewDistance:100},Yi.MakiIcon=ji;const Zi={title:"Pin Property",type:"object",properties:{show:{type:"boolean",title:"显示路径",default:!0,description:"显示路径"},origin:{type:"array",title:"原点",default:[.5,0],description:"原点"},position:{type:"array",title:"位置数组",default:[0,0,0],description:"位置数组"},viewDistance:{type:"number",title:"显示路径",default:100,description:"显示路径"},scale:{type:"number",title:"缩放比例",default:1,description:"缩放比例"},imageUrl:{type:"string",title:"图像路径",default:"",description:"图像路径"},isDivImage:{type:"boolean",title:"image是否用div绘制",default:"false",description:"image是否用div绘制"},pinBuilder:{title:"pinBuilder属性",type:"object",properties:{text:{type:"string",title:"文本",default:"",description:"文本"},extText:{type:"string",title:"附带文本",default:"",description:"附带文本"},extTextFont:{type:"string",title:"附带文本字体样式",default:"",description:"附带文本字体样式"},extTextPixelOffset:{type:"array",title:"像素偏移",default:[0,0],description:"像素偏移"},makiIcon:{type:"string",title:"图像字符",default:"",description:"图像字符"},size:{type:"number",title:"尺寸",default:48,description:"尺寸"},fillColor:{type:"array",title:"填充颜色",default:[1,1,1,1],description:"填充颜色"},outlineColor:{type:"array",title:"轮廓颜色",default:[0,.5,0,1],description:"轮廓颜色"}}},iframe:{uri:"",width:500,height:400,offsetX:-250,offsetY:60},pointShow:{type:"boolean",title:"点是否可见",default:!1,description:"点是否可见"},lineShow:{type:"boolean",title:"点是否可见",default:!1,description:"点是否可见"},lineHeight:{type:"number",title:"指示线条长度",default:0,description:"指示线条长度"},near:{type:"number",title:"最近可视距离",default:0,description:"最近可视距离"},far:{type:"number",title:"最远可视距离",default:Number.MAX_VALUE,description:"最远可视距离"},disableDepthTestDistance:{type:"number",title:"深度检测失效距离",default:Number.MAX_VALUE,description:"让深度检测失效的距离（在该距离以内不论是否被遮挡，都显示），设置为0时表示始终会被遮挡。"}}};Yi.gvolSchema=Zi;Yi.gvolClassification=[{name:{chinese:"通用",english:"General"},properties:["disableDepthTestDistance","far","imageUrl","isDivImage","near","origin","pinBuilder","iframe","pointShow","lineShow","lineHeight","position","scale","show","viewDistance"]}],c.Z.registerType(Yi,"Pin");const Wi=Yi;class Xi extends u.Z{constructor(e,t){super(e,t),this.disposers.push((0,O.Z)(this,"enabled",this,"show"));const i=this._earth.czm.scene;this._primitive=void 0,this.disposers.push((()=>{this._primitive&&(i.primitives.remove(this._primitive),this._primitive=void 0)})),window.updateTimeRatioInner=new Function("instanceIndex","frameState","result","self","\n            // return result;\n            var data = self._cloneData[instanceIndex];\n            var st = data.startTime;\n            var dr = data.duration;\n            const color = data.color;\n            const bgColor = data.bgColor;\n            const bidirectional = data.bidirectional;\n            const repeat = data.repeat;\n            const time = self.currentTime;\n            var diff = time > st ? time - st : time + self.timeDuration - st;\n            var timeRatio = Math.min(diff / dr, 1.0);\n            // return timeRatio;\n            result.timeRatio = timeRatio;\n            color && result.color.splice(0, 4, ...color);\n            if (bgColor) {\n                if (!result.bgColor) {\n                    result.bgColor = [0, 0, 0, 0.2];\n                }\n                result.bgColor.splice(0, 4, ...bgColor);\n            } else {\n                result.bgColor = [color[0], color[1], color[2], 0.2];\n            }\n            result.bidirectional = (typeof bidirectional === 'number') ? bidirectional : 0;\n            Number.isFinite(repeat) && (result.repeat = repeat);\n            return result;\n        ");const r=(e,t,i)=>window.updateTimeRatioInner(e,t,i,this),n=()=>{const e=this.color,t=this.show,i=this._primitive;if(i){i.show=t;const r=i.appearance.material.uniforms.color;r.red=e[0],r.green=e[1],r.blue=e[2],r.alpha=e[3]}};this.disposers.push((0,P.reaction)((()=>({data:JSON.stringify(this.data),translucentPass:this.translucentPass})),(()=>{this._primitive&&(i.primitives.remove(this._primitive),this._primitive=void 0),this._cloneData=JSON.parse(JSON.stringify(this.data));const e=Cesium.xbsjCreateODLinesPrimitive(this._cloneData,this.color,r,this.translucentPass);this._primitive=i.primitives.add(e),n()}))),this.disposers.push((0,P.reaction)((()=>({color:[...this.color],show:this.show,timeDuration:this.timeDuration,currentTime:this.currentTime,loopPlay:this.loopPlay})),n)),(0,P.extendObservable)(this,{_pathPlayingListener:void 0,get playing(){return!!this._pathPlayingListener},set playing(e){e&&!this._pathPlayingListener?this._play():!e&&this._pathPlayingListener&&(this._pathPlayingListener=this._pathPlayingListener&&this._pathPlayingListener())}},{_pathPlayingListener:P.observable.ref,playing:P.computed}),this.disposers.push((()=>{this.playing=!1}))}_play(){const e=this._earth.czm.scene;this.currentD===this.timeDuration&&(this.currentD=0);let t=Date.now();this._pathPlayingListener=e.postUpdate.addEventListener(((e,i)=>{let r=Date.now(),n=r-t;t=r;const o=this.currentTime+.001*n;this.loopPlay?o>this.timeDuration?this.currentTime=0:this.currentTime=o:o>this.timeDuration?(this.currentTime=this.timeDuration,this._pathPlayingListener=this._pathPlayingListener&&this._pathPlayingListener()):this.currentTime=o}))}destroy(){return super.destroy()}}Xi.defaultOptions={data:[],color:[1,1,1,1],show:!0,timeDuration:5,currentTime:0,loopPlay:!0,translucentPass:!0};Xi.gvolSchema={title:"ODLines Property",type:"object",properties:{data:[],translucentPass:!0,show:{type:"boolean",title:"显示",default:!0,description:"显示"},timeDuration:{type:"number",title:"播放总时长",default:5,description:"播放总时长"},currentTime:{type:"number",title:"当前播放时刻",default:0,description:"当前播放时刻"},loopPlay:{type:"boolean",title:"是否循环播放",default:!0,description:"是否循环播放"}}};Xi.gvolClassification=[{name:{chinese:"通用",english:"General"},properties:["show","data","color","timeDuration","currentTime","loopPlay","translucentPass"]}],c.Z.registerType(Xi,"ODLines");const Ji=Xi;var Ki,Vi,qi,$i,er=i(5108),tr=function(e,t,i,r,n,o,s){Ki=Ki||new Cesium.Matrix4,Vi=Vi||new Cesium.Quaternion,qi=qi||new Cesium.Matrix4;const a=r,l=n,h=[($i=$i||Cesium.Cartesian3.fromElements)(-a,-l,0),$i(1-a,-l,0),$i(1-a,1-l,0),$i(-a,1-l,0)];var c=Cesium.Transforms.eastNorthUpToFixedFrame(e,Cesium.Ellipsoid.WGS84,Ki),u=Cesium.Quaternion.fromAxisAngle(Cesium.Cartesian3.UNIT_Z,o,Vi),p=(0,Cesium.Matrix4.fromTranslationQuaternionRotationScale)(Cesium.Cartesian3.ZERO,u,$i(t,i),qi),d=Cesium.Matrix4.multiply(c,p,p);return void 0===s&&(s=[]),h.forEach((function(e,t){void 0===s[t]&&(s[t]=new Cesium.Cartesian3),Cesium.Matrix4.multiplyByPoint(d,e,s[t])})),s};let ir;const rr=function(e,t,i,r=i,n=.5,o=.5,s=0,a="",l,h,c){if(void 0===t||void 0===i)return void er.error("必须设置center和width！");ir=ir||new Cesium.Cartesian3;const u=Cesium.Cartesian3.fromRadians(t[0],t[1],t[2],void 0,ir);r=r||i,s=s||0,l=l||new Cesium.Color(1,1,1,1),a=a||"";var p=tr(u,i,r,n,o,s),d=new Cesium.Material({fabric:{type:"Image",uniforms:{image:a}}});return d.uniforms.color.xbsjFromArray(...l),new Cesium.GroundPrimitive({geometryInstances:new Cesium.GeometryInstance({geometry:new Cesium.PolygonGeometry({polygonHierarchy:new Cesium.PolygonHierarchy(p),stRotation:-s}),id:e}),appearance:new Cesium.MaterialAppearance({material:d}),classificationType:h,asynchronous:!1,allowPicking:void 0===c||!!c})};class nr extends u.Z{constructor(e,t){super(e,t),this.disposers.push((0,ae.Ak)(this._earth,this,{positionEditingProperty:"editing"})),this.disposers.push((0,ae.zC)(this._earth,this,{positionPickingProperty:"creating"}));const i=this._earth.czm.scene;this._primitive=void 0,this.disposers.push((()=>{this._primitive&&(i.groundPrimitives.remove(this._primitive),this._primitive=void 0)})),this.disposers.push((0,O.Z)(this,"enabled",this,"show"));const r=()=>{const e=this.currentTime/this.timeDuration,t=this.color,i=this.show,r=this._primitive;if(r){r.show=i,r.appearance.material.uniforms.time=e;const n=r.appearance.material.uniforms.color;n.red=t[0],n.green=t[1],n.blue=t[2],n.alpha=t[3]}};this.disposers.push((0,P.reaction)((()=>({position:[...this.position],radius:this.radius})),(()=>{this._primitive&&(i.groundPrimitives.remove(this._primitive),this._primitive=void 0);const e=rr(this,this.position,this.radius,void 0,void 0,void 0,void 0,void 0,void 0,void 0,!1);e.appearance.material=Cesium.Material.fromType("XbsjGroundScanline"),this._primitive=i.groundPrimitives.add(e),r()}))),this.disposers.push((0,P.autorun)(r)),(0,P.extendObservable)(this,{_pathPlayingListener:void 0,get playing(){return!!this._pathPlayingListener},set playing(e){e&&!this._pathPlayingListener?this._play():!e&&this._pathPlayingListener&&(this._pathPlayingListener=this._pathPlayingListener&&this._pathPlayingListener())}},{_pathPlayingListener:P.observable.ref,playing:P.computed}),this.disposers.push((()=>{this.playing=!1}))}_play(){const e=this._earth.czm.scene;this.currentTime===this.timeDuration&&(this.currentTime=0);let t=Date.now();this._pathPlayingListener=e.postUpdate.addEventListener(((e,i)=>{let r=Date.now(),n=r-t;t=r;const o=this.currentTime+.001*n;this.loopPlay?o>this.timeDuration?this.currentTime=0:this.currentTime=o:o>this.timeDuration?(this.currentTime=this.timeDuration,this._pathPlayingListener=this._pathPlayingListener&&this._pathPlayingListener()):this.currentTime=o}))}flyTo(){this._earth.camera.flyTo(this.position,2*this.radius,[0,-Math.PI/3,0])}}nr.defaultOptions={position:[0,0,0],radius:100,color:[1,1,0,1],show:!0,timeDuration:1,currentTime:0,loopPlay:!0};nr.gvolSchema={title:"Scanline Property",type:"object",properties:{position:{type:"array",items:{type:"number"},minItems:3,maxItems:3,default:[0,0,0],description:"位置 [经度, 纬度, 高度]"},radius:{type:"number",title:"半径",default:100,description:"半径"},color:{type:"array",items:{type:"number"},minItems:4,maxItems:4,default:[1,1,0,1],description:"颜色叠加"},show:{type:"boolean",title:"显示",default:!0,description:"显示"},timeDuration:{type:"number",title:"播放持续时间，单位秒",default:1,description:"播放持续时间，单位秒"},currentTime:{type:"number",title:"当前时间，单位秒",default:0,description:"当前时间，单位秒"},loopPlay:{type:"boolean",title:"是否循环播放",default:!0,description:"是否循环播放"}}};nr.gvolClassification=[{name:{chinese:"通用",english:"General"},properties:["position","radius","color","show","timeDuration","currentTime","loopPlay"]}],c.Z.registerType(nr,"Scanline");const or=nr;var sr=i(6020),ar=i(6452);class lr extends u.Z{constructor(e,t){super(e,t),(0,P.extendObservable)(this,{editingPolylineShow:!1}),this.disposers.push((0,ae.wt)(this._earth,this,{polylineCreatingProperty:"creating"})),this.disposers.push((0,ae.ih)(this._earth,this,{polylineEditingProperty:"editing"})),this.disposers.push((0,O.Z)(this,"enabled",this,"show"))}get onlyMove(){return!0}get fixedPositionsNum(){}}lr.defaultOptions={positions:[],show:!0,ground:!0};lr.gvolSchema={title:"PlotBase Property",type:"object",properties:{show:{type:"boolean",title:"是否在三维窗口中显示",default:!0,description:"是否在三维窗口中显示"},ground:{type:"boolean",title:"是否贴地",default:!0,description:"是否贴地"},positions:{type:"array",title:"位置数组",default:[],description:"位置数组"}}};lr.gvolClassification=[{name:{chinese:"通用",english:"General"},properties:["show","ground","positions"]}];const hr=lr;const cr=function(e,t,{positionProperty:i="position",screenScalePropery:r="_realSceneScale",fixScreenSizeProperty:n="fixScreenSize",scaleProperty:o="scale"}={}){const s=e.czm.scene,a=new Cesium.Cartesian3,l=()=>{const e=t[o],l=t[n],h=t[i];if(t.enabled){const i=Cesium.Cartesian3.fromRadians(...h,void 0,a);t[r]=l>0?Cesium.xbsjGetScreenScale(s,i,l):e}},h=[];return h.push((()=>{const t=rxjs.race(e.eventSource.contextSizeChanged,e.eventSource.cameraChanged).subscribe(l);return()=>{t.unsubscribe()}})()),h.push((0,P.autorun)(l)),()=>{h.forEach((e=>e())),h.length=0}};function ur(e,t){e[0]=t[0],e[1]=t[1],e[2]=t[2]}const pr=6378137;function dr(e){e[0]=1,e[1]=1,e[2]=0,e[3]=1}class mr extends u.Z{constructor(e,t){super(e,t),(0,P.extendObservable)(this,{_realSceneScale:1}),this._disposers=[],this._disposers.push(cr(this._earth,this)),this._xAxis=new Si.Z(e),this._yAxis=new Si.Z(e),this._zAxis=new Si.Z(e),this._xAxis.arcType="RHUMB",this._yAxis.arcType="RHUMB",this._zAxis.arcType="NONE",[this._xAxis,this._yAxis,this._zAxis].forEach((e=>{e.material={type:"XbsjPolylineArrowMaterial"},e.width=20})),this._xAxis.show=!1,this._yAxis.show=!1,this._zAxis.show=!1,this._xAxis.material.XbsjPolylineArrowMaterial.color=[1,0,0,1],this._yAxis.material.XbsjPolylineArrowMaterial.color=[0,1,0,1],this._zAxis.material.XbsjPolylineArrowMaterial.color=[0,0,1,1],this._xAxis.depthTest=!1,this._yAxis.depthTest=!1,this._zAxis.depthTest=!1,this._xAxis.forcePass=Cesium.Pass.OVERLAY,this._yAxis.forcePass=Cesium.Pass.OVERLAY,this._zAxis.forcePass=Cesium.Pass.OVERLAY,this._xAxis.positions=[[0,0,0],[0,0,0]],this._yAxis.positions=[[0,0,0],[0,0,0]],this._zAxis.positions=[[0,0,0],[0,0,0]],this._disposers.push((0,P.autorun)((()=>{const e=this.fixScreenSize>0?this._realSceneScale:this.scale,t=this.show&&void 0!==e&&e>0;this._xAxis.show=t&&this.xShow,this._yAxis.show=t&&this.yShow,this._zAxis.show=t&&this.zShow,t&&(ur(this._xAxis.positions[0],this.position),ur(this._yAxis.positions[0],this.position),ur(this._zAxis.positions[0],this.position),ur(this._xAxis.positions[1],this.position),ur(this._yAxis.positions[1],this.position),ur(this._zAxis.positions[1],this.position),this._xAxis.positions[1][0]=this.position[0]+e/(pr*Math.cos(this.position[1])),this._yAxis.positions[1][1]=this.position[1]+e/pr,this._zAxis.positions[1][2]=this.position[2]+e,this.xAxisActive?dr(this._xAxis.material.XbsjPolylineArrowMaterial.color):function(e){e[0]=1,e[1]=0,e[2]=0,e[3]=1}(this._xAxis.material.XbsjPolylineArrowMaterial.color),this.yAxisActive?dr(this._yAxis.material.XbsjPolylineArrowMaterial.color):function(e){e[0]=0,e[1]=1,e[2]=0,e[3]=1}(this._yAxis.material.XbsjPolylineArrowMaterial.color),this.zAxisActive?dr(this._zAxis.material.XbsjPolylineArrowMaterial.color):function(e){e[0]=0,e[1]=0,e[2]=1,e[3]=1}(this._zAxis.material.XbsjPolylineArrowMaterial.color))})))}flyTo(){}destroy(){return this._disposers.forEach((e=>e())),this._disposers.length=0,this._primitive&&this._earth.czm.scene.primitives.remove(this._primitive),this._xAxis=this._xAxis&&this._xAxis.destroy(),this._yAxis=this._yAxis&&this._yAxis.destroy(),this._zAxis=this._zAxis&&this._zAxis.destroy(),super.destroy()}}mr.defaultOptions={position:[0,0,0],show:!1,xShow:!0,yShow:!0,zShow:!0,scale:1,fixScreenSize:0,xAxisActive:!1,yAxisActive:!1,zAxisActive:!1},c.Z.registerType(mr,"Coordinates");const fr=mr;class gr extends u.Z{constructor(e,t){super(e,t),h.Z.registerProperty(this,"material",gr.defaultOptions.material),h.Z.registerProperty(this.material,"XbsjColorMaterial",gr.defaultOptions.material.XbsjColorMaterial),h.Z.registerProperty(this.material,"XbsjPolylineDashMaterial",gr.defaultOptions.material.XbsjPolylineDashMaterial),h.Z.registerProperty(this.material,"XbsjPolylineArrowMaterial",gr.defaultOptions.material.XbsjPolylineArrowMaterial),this._arcPolyline=new Si.Z(e),this._edgePolyline=new Si.Z(e),this._arcPolyline.type="NONE",this._edgePolyline.type="NONE",this._edgePolyline.positions=[[0,0,0],[0,0,0],[0,0,0]],this._boundingSphere=new Cesium.BoundingSphere,this._disposers=[],this._disposers.push((0,O.Z)(this,"enabled",this,"show")),this._centerCartesian=new Cesium.Cartesian3,this._hpr=new Cesium.HeadingPitchRoll,this._enu=new Cesium.Matrix4,this._carto=new Cesium.Cartographic,this._scrachCartesian=new Cesium.Cartesian3,(0,P.extendObservable)(this,{_positions:[]}),this._disposers.push((0,P.autorun)((()=>{this._hpr.heading=this.rotation[0],this._hpr.pitch=this.rotation[1],this._hpr.roll=this.rotation[2],this._edgePolyline.positions[1].splice(0,3,...this.center),this._centerCartesian=Cesium.Cartesian3.fromRadians(...this.center,void 0,this._centerCartesian),Cesium.Cartesian3.clone(this._centerCartesian,this._boundingSphere.center),this._boundingSphere.radius=this.radius,this._enu=Cesium.Transforms.headingPitchRollToFixedFrame(this._centerCartesian,this._hpr,void 0,void 0,this._enu);const e=2*Math.PI;if(this._positions.length=0,this.range[0]!==this.range[1]){const t=this.range[0]%e,i=this.range[1]%e,r=i<=t?i+e:i;for(let e=t;e<r;e+=this.granularity)this._positions.push(this._computPosition(e));this._positions.push(this._computPosition(r))}}))),this._disposers.push((0,P.reaction)((()=>this._positions.map((e=>[...e]))),(e=>{this._arcPolyline.positions.splice(0,this._arcPolyline.positions.length,...e),this._positions.length>0&&(this._edgePolyline.positions[0].splice(0,3,...this._positions[0]),this._edgePolyline.positions[2].splice(0,3,...this._positions[this._positions.length-1]))}))),["show","width","depthTest","arcType","material"].forEach((e=>{this._disposers.push((0,O.Z)(this._arcPolyline,e,this,e))})),["width","depthTest","arcType","material"].forEach((e=>{this._disposers.push((0,O.Z)(this,e,this._edgePolyline,e))})),this._disposers.push((0,P.autorun)((()=>{this._edgePolyline.show=this.show&&this.edgeShow}))),this._disposers.push((0,P.reaction)((()=>this.show&&this.showHelper||this.isSelected),(e=>{this._arcPolyline.showHelper=e}),{fireImmediately:!0}))}_computPosition(e){const t=e,i=this.radius,r=Math.cos,n=Math.sin,o=this._scrachCartesian;"pitch"===this.axisType?Cesium.Cartesian3.fromElements(r(t)*i,0,n(t)*i,o):"roll"===this.axisType?Cesium.Cartesian3.fromElements(0,r(t)*i,n(t)*i,o):"heading"===this.axisType&&Cesium.Cartesian3.fromElements(r(-t)*i,n(-t)*i,0,o),Cesium.Matrix4.multiplyByPoint(this._enu,o,o);const s=Cesium.Cartographic.fromCartesian(o,void 0,this._carto);return[s.longitude,s.latitude,s.height]}get boundingSphere(){return this._boundingSphere}flyTo(){this._earth.czm.scene.camera.flyToBoundingSphere(this._boundingSphere)}destroy(){return this._disposers.forEach((e=>e())),this._disposers.length=0,this._arcPolyline=this._arcPolyline&&this._arcPolyline.destroy(),this._edgePolyline=this._edgePolyline&&this._edgePolyline.destroy(),super.destroy()}}gr.defaultOptions={center:[0,0,0],radius:1,rotation:[0,0,0],axisType:"heading",granularity:.02,range:[0,2*Math.PI],edgeShow:!1,show:!0,showHelper:!1,width:2,depthTest:!1,arcType:"NONE",material:{type:"XbsjColorMaterial",XbsjColorMaterial:{color:[1,0,1,1]},XbsjPolylineDashMaterial:{color:[1,0,1,1],gapColor:[0,0,0,0],dashLength:16,dashPattern:255},XbsjPolylineArrowMaterial:{color:[1,0,1,1]}}},c.Z.registerType(gr,"Circle");const Ar=gr;class yr extends u.Z{constructor(e,t){super(e,t),(0,P.extendObservable)(this,{positions:[[0,0,0],[0,0,0]],_realSceneScale:1,_endRealSceneScale:1,_primitive:void 0},{_primitive:P.observable.ref}),this.disposers.push((()=>{this._primitive&&(this._earth.czm.scene.primitives.remove(this._primitive),this._primitive=void 0)})),this.disposers.push((0,O.Z)(this,"positions.0",this,"startPosition")),this.disposers.push((0,O.Z)(this,"positions.1",this,"endPosition")),this._boundingSphere=new Cesium.BoundingSphere,this.disposers.push((0,O.Z)(this,"enabled",this,"show")),this.disposers.push((0,P.autorun)((()=>{this._primitive&&(this._primitive.show=this.show)}))),this.disposers.push(cr(this._earth,this,{positionProperty:"startPosition",screenScalePropery:"_realSceneScale",fixScreenSizeProperty:"fixScreenSize",scaleProperty:"radius"})),this.disposers.push(cr(this._earth,this,{positionProperty:"endPosition",screenScalePropery:"_endRealSceneScale",fixScreenSizeProperty:"fixScreenSize",scaleProperty:"radius"}));var i=this;const r=()=>{if(!this._primitive)return;this._scratchCartesian=this._scratchCartesian||new Cesium.Cartesian3,this._scratchCartesian2=this._scratchCartesian2||new Cesium.Cartesian3,this._scratchCartesian3=this._scratchCartesian3||new Cesium.Cartesian3,this._scratchCartesian4=this._scratchCartesian4||new Cesium.Cartesian3,this._scratchQuat=this._scratchQuat||new Cesium.Quaternion;const e=this._scratchCartesian,t=this._scratchCartesian2,i=this._scratchCartesian3,r=this._scratchCartesian4,n=Cesium.Cartesian3.fromRadians(...this.startPosition,void 0,e),o=Cesium.Cartesian3.fromRadians(...this.endPosition,void 0,t);let s=Cesium.Cartesian3.subtract(o,n,i),a=Cesium.Cartesian3.magnitude(s);if(a>0){a=a>0?a:.001,s=Cesium.Cartesian3.normalize(s,s);const e=Cesium.Cartesian3.angleBetween(s,Cesium.Cartesian3.UNIT_Z),i=Cesium.Cartesian3.cross(Cesium.Cartesian3.UNIT_Z,s,r),o=Math.min(this._realSceneScale,this._endRealSceneScale,this.maxSceneScale),l=Cesium.Cartesian3.fromElements(o,o,a,t),h=Cesium.Quaternion.fromAxisAngle(i,e,this._scratchQuat);Cesium.Matrix4.fromTranslationQuaternionRotationScale(n,h,l,this._primitive.modelMatrix),this._boundingSphere.radius=a,this._boundingSphere.center=n}};this.disposers.push((0,P.autorun)((()=>{r()})));const n=e=>{this._primitive&&(this._earth.czm.scene.primitives.remove(this._primitive),this._primitive=void 0);const t=Cesium.XbsjCSG.cylinder({start:[0,0,0],end:[0,0,1],radius:1,slices:e}).toMesh(),i=new Cesium.XbsjCustomPrimitive({modelMatrix:Cesium.Matrix4.IDENTITY,positions:t.positions,indices:t.indices,normals:t.normals,colors:t.colors,color:void 0,translucent:!1,id:this});this._earth.czm.scene.primitives.add(i),this._primitive=i};n(),this.disposers.push((0,P.reaction)((()=>this.slices),n)),this.disposers.push((0,P.autorun)((()=>r()))),this.disposers.push((0,P.autorun)((()=>{i._primitive&&(i._primitive.color.red=i.color[0],i._primitive.color.green=i.color[1],i._primitive.color.blue=i.color[2],i._primitive.color.alpha=i.color[3])}))),this.disposers.push((0,P.autorun)((()=>{this._primitive&&(this._primitive.show=this.show)}))),this.disposers.push((0,ae.ih)(this._earth,this,{polylineEditingProperty:"editing"}))}get boundingSphere(){return this._boundingSphere}flyTo(){this._earth.czm.scene.camera.flyToBoundingSphere(this._boundingSphere)}destroy(){return super.destroy()}}yr.defaultOptions={startPosition:[0,0,0],endPosition:[0,0,0],radius:1,slices:16,color:[1,0,0,1],show:!0,fixScreenSize:0,maxSceneScale:Number.POSITIVE_INFINITY},c.Z.registerType(yr,"Cylinder");const vr=yr;var Cr=i(5108);class _r extends u.Z{constructor(e,t){super(e,t),this.disposers.push((0,O.Z)(this,"enabled",this,"show")),this.textureWidth=2048,this.textureHeight=2048,h.Z.registerPosition(this),this.disposers.push((0,ae.Ak)(this._earth,this,{positionEditingProperty:"editing"})),this.disposers.push((0,ae.zC)(this._earth,this,{positionPickingProperty:"creating"}));const i=this._earth.czm.scene;this._groundPrimitive=void 0,this.disposers.push((()=>{this._groundPrimitive&&i.groundPrimitives.remove(this._groundPrimitive),this._groundPrimitive=void 0})),this._material=new Cesium.Material({fabric:{type:"ImageMapXC",materials:{left:{type:"ScaleImageXC",uniforms:{image:Cesium.Material.DefaultImageId,repeat:new Cesium.Cartesian2(1,1),color:new Cesium.Color(1,1,1,1),stscale:new Cesium.Cartesian2(1,1)},components:{diffuse:"texture2D(image, fract(repeat * materialInput.st) * stscale).rgb * color.rgb",alpha:"texture2D(image, fract(repeat * materialInput.st) * stscale).a * color.a"}},right:{type:"ScaleImageXC",uniforms:{image:Cesium.Material.DefaultImageId,repeat:new Cesium.Cartesian2(1,1),color:new Cesium.Color(1,1,1,1),stscale:new Cesium.Cartesian2(1,1)},components:{diffuse:"texture2D(image, fract(repeat * materialInput.st) * stscale).rgb * color.rgb",alpha:"texture2D(image, fract(repeat * materialInput.st) * stscale).a * color.a"}}},uniforms:{t:0,opacity:1},components:{diffuse:"left.diffuse * (1.0 - t) + right.diffuse * t",alpha:"(left.alpha * (1.0 - t) + right.alpha * t) * opacity"}}});(()=>{this._leftHeatmapTexture&&this._leftHeatmapTexture.destroy(),this._leftHeatmapTexture=new Cesium.Texture({context:i.context,width:this.textureWidth,height:this.textureHeight}),this._rightHeatmapTexture&&this._rightHeatmapTexture.destroy(),this._rightHeatmapTexture=new Cesium.Texture({context:i.context,width:this.textureWidth,height:this.textureHeight}),this._material.materials.left.uniforms.image=this._leftHeatmapTexture,this._material.materials.right.uniforms.image=this._rightHeatmapTexture})(),this._scratchRect=new Cesium.Rectangle;const r=()=>{this._groundPrimitive&&i.groundPrimitives.remove(this._groundPrimitive),this._groundPrimitive=void 0;const e=this.origin[0],t=this.origin[1],r=rr(this,this.position,this.width,this.height,e,t,this.rotation,void 0);this._groundPrimitive=i.groundPrimitives.add(r),this._groundPrimitive.show=this.show,this._groundPrimitive.appearance.material=this._material};r(),this.disposers.push((0,P.reaction)((()=>({position:[...this.position],origin:[...this.origin],rotation:this.rotation,width:this.width,height:this.height})),(()=>{r()}))),this.disposers.push((0,P.reaction)((()=>this.show),(()=>{this._groundPrimitive.show=this.show}))),(0,P.extendObservable)(this,{_images:[]}),this.disposers.push((0,P.reaction)((()=>[...this.imageUrls]),(e=>{this._fetchTexturesSubscription&&this._fetchTexturesSubscription.unsubscribe(),this._fetchTexturesSubscription=void 0;const t=e.map((e=>new Promise(((t,i)=>{Cesium.Resource.fetchImage({url:e}).then((e=>{t(e)}))})))),i=new rxjs.Observable((e=>{Promise.all(t).then((t=>{e.next(t)}))}));this._fetchTexturesSubscription=i.subscribe((e=>{if(e=e.filter((e=>{let t=e.width>this.textureWidth||e.height>this.textureHeight;return t&&Cr.warn(`警告：图片尺寸大于${this.textureWidth}X${this.textureHeight}，将被忽略。。`),!t})),this._images.splice(0,this._images.length,...e),this._images.length>0){const e=this._images[0];this.autoWidth?this.width=this.height*e.naturalWidth/e.naturalHeight:this.autoHeight&&(this.height=this.width*e.naturalHeight/e.naturalWidth)}}))}))),this._leftImage=void 0,this._rightImage=void 0;const n=new Uint8Array([255,255,255,0]),o=()=>{const e=this._images.length;if(0===e)return this._leftImage=void 0,this._rightImage=void 0,this._material.materials.left.uniforms.image.copyFrom({width:1,height:1,arrayBufferView:n}),this._material.materials.left.uniforms.stscale=new Cesium.Cartesian2(1/this.textureWidth,1/this.textureHeight),this._material.materials.right.uniforms.image.copyFrom({width:1,height:1,arrayBufferView:n}),void(this._material.materials.right.uniforms.stscale=new Cesium.Cartesian2(1/this.textureWidth,1/this.textureHeight));const t=this.currentTime>this.timeDuration?0:this.currentTime;let i=0,r=0;if(e>=2)if(this.times&&0!==this.times.length)i=this.times.findIndex((e=>e>t))-1,i<0?(i=0,r=0):i>=this._images.length-1?(i=this._images.length-2,r=1):r=(t-this.times[i])/(this.times[i+1]-this.times[i]);else{const n=this.timeDuration/(e-1),o=t/n;i=Math.floor(o),r=o-i}if(this._leftImage!==this._images[i]){this._leftImage=this._images[i];const e=this._leftImage;e&&(this._material.materials.left.uniforms.image.copyFrom(e),this._material.materials.left.uniforms.stscale=new Cesium.Cartesian2(e.width/this.textureWidth,e.height/this.textureHeight))}if(e>=2&&this._rightImage!==this._images[i+1]){this._rightImage=this._images[i+1];const e=this._rightImage;e&&(this._material.materials.right.uniforms.image.copyFrom(e),this._material.materials.right.uniforms.stscale=new Cesium.Cartesian2(e.width/this.textureWidth,e.height/this.textureHeight))}this._material.uniforms.t=r};o(),this.disposers.push((0,P.reaction)((()=>({currentTime:this.currentTime,timeDuration:this.timeDuration,images:[...this._images],times:[...this.times]})),o)),(0,P.extendObservable)(this,{_pathPlayingListener:void 0,get playing(){return!!this._pathPlayingListener},set playing(e){e&&!this._pathPlayingListener?this._play():!e&&this._pathPlayingListener&&(this._pathPlayingListener=this._pathPlayingListener&&this._pathPlayingListener())}},{_pathPlayingListener:P.observable.ref,playing:P.computed}),this.disposers.push((()=>{this.playing=!1}));const s=()=>{this._material.uniforms.opacity=this.opacity};s(),this.disposers.push((0,P.reaction)((()=>this.opacity),s))}_play(){const e=this._earth.czm.scene;this.currentTime===this.timeDuration&&(this.currentTime=0);let t=Date.now();this._pathPlayingListener=e.postUpdate.addEventListener(((e,i)=>{let r=Date.now(),n=r-t;t=r;const o=this.currentTime+.001*n;this.loopPlay?o>this.timeDuration?this.currentTime=0:this.currentTime=o:o>this.timeDuration?(this.currentTime=this.timeDuration,this._pathPlayingListener=this._pathPlayingListener&&this._pathPlayingListener()):this.currentTime=o}))}flyTo(){this._earth.camera.flyTo(this.position,this.width,[0,-Math.PI/3,0])}destroy(){return super.destroy()}}_r.defaultOptions={position:[0,0,0],width:100,height:100,autoWidth:!1,autoHeight:!0,origin:[.5,.5],rotation:0,show:!0,imageUrls:[],timeDuration:1,currentTime:0,loopPlay:!0,times:[],opacity:1};_r.gvolSchema={title:"GroundImage Property",type:"object",properties:{show:{type:"boolean",title:"显示",default:!0,description:"显示"},origin:{type:"array",items:{type:"number"},minItems:2,maxItems:2,title:"原点",default:[.5,.5],description:"原点"},rotation:{type:"number",title:"旋转角",default:0,description:"旋转角"},position:{type:"array",items:{type:"number"},minItems:3,maxItems:3,title:"位置数组",default:[0,0,0],description:"位置数组"},width:{type:"number",title:"东西方向长度",default:100,description:"宽度"},height:{type:"number",title:"南北方向长度",default:100,description:"高度"},autoWidth:{type:"boolean",title:"是否自动计算宽度",default:!0,description:"是否自动计算宽度"},autoHeight:{type:"boolean",title:"是否自动计算高度",default:!0,description:"是否自动计算高度"},imageUrls:{type:"array",items:{type:"string"},title:"图像路径",default:[],description:"图像路径"},timeDuration:{type:"number",title:"播放总时长",default:1,description:"播放总时长"},currentTime:{type:"number",title:"当前播放时刻",default:0,description:"当前播放时刻"},loopPlay:{type:"boolean",title:"是否循环播放",default:!0,description:"是否循环播放"},times:{type:"boolean",title:"每个图象的播放时刻",default:[],description:"每个图象的播放时刻"},opacity:{type:"number",title:"不透明度",default:1,description:"不透明度"}}};_r.gvolClassification=[{name:{chinese:"通用",english:"General"},properties:["show","origin","rotation","position","width","height","autoWidth","autoHeight","imageUrls","timeDuration","currentTime","loopPlay","times"]}],c.Z.registerType(_r,"GroundImage");const br=_r;function wr(e,t){const i=e.appearance.material.uniforms;i.baseWaterColor.xbsjFromArray(...t.baseWaterColor),i.blendColor.xbsjFromArray(...t.blendColor),i.frequency=t.frequency,i.animationSpeed=t.animationSpeed,i.amplitude=t.amplitude,i.specularIntensity=t.specularIntensity,i.fadeFactor=t.fadeFactor,i.sizeAndVelocity.z=t.velocity[0],i.sizeAndVelocity.w=t.velocity[1]}class Pr extends u.Z{constructor(e,t){super(e,t),this.disposers.push((0,O.Z)(this,"enabled",this,"show")),this._primitive=void 0,this.disposers.push((()=>this._primitive&&this._earth.czm.scene.gvolWaterManager.destroyWaterPolygonPrimitive(this._primitive))),this._groundPrimitive=void 0,this.disposers.push((()=>this._groundPrimitive&&this._earth.czm.scene.gvolWaterManager.destroyWaterPolygonPrimitive(this._groundPrimitive))),this._boundingSphere=new Cesium.BoundingSphere;{const e=()=>{this._primitive&&(this._primitive.show=this.show,wr(this._primitive,this)),this._groundPrimitive&&(this._groundPrimitive.show=this.show,wr(this._groundPrimitive,this))};this.disposers.push((0,P.reaction)((()=>({show:this.show,baseWaterColor:[...this.baseWaterColor],blendColor:[...this.blendColor],frequency:this.frequency,animationSpeed:this.animationSpeed,amplitude:this.amplitude,specularIntensity:this.specularIntensity,fadeFactor:this.fadeFactor,velocity:[...this.velocity]})),e));const t=()=>{this._primitive&&this._earth.czm.scene.gvolWaterManager.destroyWaterPolygonPrimitive(this._primitive),this._primitive=void 0,this._groundPrimitive&&this._earth.czm.scene.gvolWaterManager.destroyWaterPolygonPrimitive(this._groundPrimitive),this._groundPrimitive=void 0;const e=[],t=this.positions.length/2;if(!(t<3)){for(let i=0;i<t;++i){const t=Cesium.Cartesian3.fromRadians(this.positions[2*i+0],this.positions[2*i+1],this.height);e.push(t)}this.ground?this._groundPrimitive=this._earth.czm.scene.gvolWaterManager.createWaterPolygonPrimitive(e,!0):this._primitive=this._earth.czm.scene.gvolWaterManager.createWaterPolygonPrimitive(e,!1)}},i=()=>{const e=this.positions.length/2;if(e>=3){const t=[];for(let i=0;i<e;++i)t.push(this.positions[2*i],this.positions[2*i+1],this.height);const i=Cesium.Cartesian3.fromRadiansArrayHeights(t);this._boundingSphere=Cesium.BoundingSphere.fromPoints(i,this._boundingSphere)}};this.disposers.push((0,P.reaction)((()=>({positions:[...this.positions],height:this.height,ground:this.ground})),(()=>{t(),e(),i()})))}this._polyline=new Si.Z(e),this.disposers.push((()=>this._polyline=this._polyline&&this._polyline.destroy())),this._polyline.material.type="XbsjColorMaterial",this._polyline.depthTest=!1,this._polyline.loop=!0,this.disposers.push((0,P.autorun)((()=>{this._polyline.material.XbsjColorMaterial.color=this.outline.color,this._polyline.width=this.outline.width,this._polyline.show=this.show&&this.outline.show,this._polyline.ground=this.ground})));{const e=()=>{const e=this.positions.length/2,t=[];for(let i=0;i<e;++i)t.push([this.positions[2*i],this.positions[2*i+1],this.height]);return t},t=e=>this._polyline&&(this._polyline.positions=e);t(e()),this.disposers.push((0,P.reaction)(e,t))}this.disposers.push((0,ae.Vy)(this._earth,this,{polygonCreatingWithHeight:"creating"})),this.disposers.push((0,ae.Ko)(this._earth,this,{polygonEditingProperty:"editing"}))}get boundingSphere(){return this._boundingSphere}flyTo(){this._earth.czm.scene.camera.flyToBoundingSphere(this._boundingSphere)}destroy(){return super.destroy()}}Pr.gvolSchema={title:"Water Property",type:"object",properties:{positions:{type:"array",title:"位置数组",default:[],description:"位置数组"},height:{type:"number",title:"水面高度",default:0,description:"水面高度"},show:{type:"boolean",title:"是否在三维窗口中显示",default:!0,description:"是否在三维窗口中显示"},baseWaterColor:{type:"array",items:{type:"number"},minItems:4,maxItems:4,default:[.2,.3,.6,1],description:"颜色叠加"},blendColor:{type:"array",items:{type:"number"},minItems:4,maxItems:4,default:[.5,.5,.5,.7],description:"颜色叠加"},frequency:{type:"number",title:"频率",default:5e3,description:"频率"},animationSpeed:{type:"number",title:"运动速度",default:.05,description:"运动速度"},amplitude:{type:"number",title:"amplitude",default:2,description:"amplitude"},specularIntensity:{type:"number",title:"specularIntensity",default:.5,description:"specularIntensity"},fadeFactor:{type:"number",title:"fadeFactor",default:1,description:"fadeFactor"},velocity:{type:"array",items:{type:"number"},minItems:2,maxItems:2,default:[10,10],description:"速度数组"},showHelper:{type:"boolean",title:"辅助线框",default:"false",description:"辅助线框"},outline:{},ground:{type:"boolean",title:"是否贴地",default:!0,description:"是否贴地"}}};Pr.gvolClassification=[{name:{chinese:"通用",english:"General"},properties:["positions","height","show","baseWaterColor","blendColor","frequency","animationSpeed","amplitude","specularIntensity","fadeFactor","velocity","showHelper","outline","ground"]}],Pr.defaultOptions={positions:[],height:0,show:!0,baseWaterColor:[.2,.3,.6,1],blendColor:[.5,.5,.5,.7],frequency:5e3,animationSpeed:.05,amplitude:2,specularIntensity:.5,fadeFactor:1,velocity:[10,10],showHelper:!1,outline:{show:!0,color:[0,1,0,1],width:2},ground:!1},c.Z.registerType(Pr,"Water");const Sr=Pr;const xr={frontFace:WebGL2RenderingContext.CCW,cull:{enabled:!1,face:WebGL2RenderingContext.BACK},lineWidth:1,polygonOffset:{enabled:!1,factor:0,units:0},scissorTest:{enabled:!1,rectangle:{x:0,y:0,width:0,height:0}},depthRange:{near:0,far:1},depthTest:{enabled:!1,func:WebGL2RenderingContext.LESS},colorMask:{red:!0,green:!0,blue:!0,alpha:!0},depthMask:!0,stencilMask:-1,blending:{enabled:!1,color:{red:0,green:0,blue:0,alpha:0},equationRgb:WebGL2RenderingContext.ADD,equationAlpha:WebGL2RenderingContext.ADD,functionSourceRgb:WebGL2RenderingContext.ONE,functionSourceAlpha:WebGL2RenderingContext.ONE,functionDestinationRgb:WebGL2RenderingContext.ZERO,functionDestinationAlpha:WebGL2RenderingContext.ZERO},stencilTest:{enabled:!1,frontFunction:WebGL2RenderingContext.ALWAYS,backFunction:WebGL2RenderingContext.ALWAYS,reference:0,mask:-1,frontOperation:{fail:WebGL2RenderingContext.KEEP,zFail:WebGL2RenderingContext.KEEP,zPass:WebGL2RenderingContext.KEEP},backOperation:{fail:WebGL2RenderingContext.KEEP,zFail:WebGL2RenderingContext.KEEP,zPass:WebGL2RenderingContext.KEEP}},sampleCoverage:{enabled:!1,value:1,invert:!1}};function Br(e,t=0,i=e.length,r=0,n=void 0){let o=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY,a=0,l=(i-t)/(r=r<=0?1:r)|0;for(let l=t;l<i;l+=r){const t=n?n(e[l]):e[l];o=o>t?t:o,s=s<t?t:s,a+=t}return[o,s,a,a/l]}let Mr,Er,Tr;const Or={unitSquare:{positions:[-1,-1,0,1,-1,0,1,1,0,-1,1,0],sts:[0,0,1,0,1,1,0,1],indices:[0,1,2,0,2,3]},unitBillboard:{positions:[0,-1,0,0,1,0,0,1,2,0,-1,2],sts:[0,0,1,0,1,1,0,1],indices:[0,1,2,0,2,3]},createCylinder:function(e,t,i,r){r|=0;const n=2*Math.PI/r,o=[...new Array(r).keys()],s=[];o.forEach((e=>{s.push(e,(e+1)%(r+1),e+r+1,(e+1)%(r+1),(e+1)%(r+1)+r+1,e+r+1)})),o.push(r);const a=[],l=[];o.forEach((r=>{a.push(t*Math.cos(r*n),t*Math.sin(r*n),0),l.push(e*Math.cos(r*n),e*Math.sin(r*n),i)}));const h=[...a,...l],c=[];return o.forEach((e=>{c.push(e/r,0)})),o.forEach((e=>{c.push(e/r,1)})),{positions:h,indices:s,sts:c}},getLocalPositions:function(e,t,i=[]){if(Mr=Mr||new Cesium.Cartesian3,Er=Er||new Cesium.Cartesian3,Tr=Tr||new Cesium.Matrix4,!t){const[i,r,n,o]=Br(e,void 0,void 0,void 0,(e=>e[0])),[s,a,l,h]=Br(e,void 0,void 0,void 0,(e=>e[1])),[c,u,p,d]=Br(e,void 0,void 0,void 0,(e=>e[2]));t=[o,h,d]}const r=Cesium.Cartesian3.fromRadians(t[0],t[1],t[2],void 0,Mr),n=Cesium.Transforms.eastNorthUpToFixedFrame(r,void 0,Tr),o=Cesium.Matrix4.inverse(n,n),s=i;return e.forEach((e=>{const t=Cesium.Cartesian3.fromRadians(e[0],e[1],e[2],void 0,Er);Cesium.Matrix4.multiplyByPoint(o,t,t),s.push(t.x,t.y,t.z)})),[s,t]}};function Lr(e,t){var i;return Cesium.defined(t.internalFormat)?i=new Cesium.Texture({context:e,pixelFormat:t.internalFormat,width:t.width,height:t.height,source:{arrayBufferView:t.bufferView}}):(i=new Cesium.Texture({context:e,source:t}),Cesium.Math.isPowerOfTwo(i.width)&&Cesium.Math.isPowerOfTwo(i.height)&&(i.generateMipmap(),i.sampler=new Cesium.Sampler({wrapS:Cesium.TextureWrap.REPEAT,wrapT:Cesium.TextureWrap.REPEAT,minificationFilter:Cesium.TextureMinificationFilter.LINEAR_MIPMAP_LINEAR,magnificationFilter:Cesium.TextureMagnificationFilter.LINEAR_MIPMAP_LINEAR}))),i}var Dr="\n// vtxf 使用double类型的position进行计算\n// attribute vec3 position3DHigh;\n// attribute vec3 position3DLow;\nattribute vec3 position;\nattribute vec3 normal;\nattribute vec2 st;\nattribute vec4 color;\nattribute float batchId;\nvarying vec3 v_positionEC;\nvarying vec3 v_normalEC;\nvarying vec2 v_st;\nvarying vec4 v_color;\nvoid main()\n{\n    v_positionEC = (czm_modelView * vec4(position, 1.0)).xyz;       // position in eye coordinates\n    v_normalEC = czm_normal * normal;                               // normal in eye coordinates\n    v_st = st;\n    v_color = color;\n    gl_Position = czm_modelViewProjection * vec4(position, 1.0);\n}\n",Ir="\nvarying vec3 v_positionEC;\nvarying vec3 v_normalEC;\nvarying vec2 v_st;\nvarying vec4 v_color;\nuniform sampler2D u_image;\nuniform vec4 u_color;\nvoid main()\n{\n    vec3 positionToEyeEC = -v_positionEC;\n    vec3 normalEC = normalize(v_normalEC);\n    normalEC = faceforward(normalEC, vec3(0.0, 0.0, 1.0), -normalEC);\n\n    vec4 imageColor = texture2D(u_image, fract(v_st));\n\n    vec3 diffuse = imageColor.rgb;\n    float alpha = imageColor.a;\n\n    diffuse *= v_color.rgb;\n    alpha *= v_color.a;\n\n    diffuse *= u_color.rgb;\n    alpha *= u_color.a;\n\n    gl_FragColor = vec4(diffuse, alpha);\n}\n";const Rr={position:0,normal:1,textureCoordinates:2};let Hr,Fr;function Nr(e,t,i){const r=e.length/3|0,n=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY],o=[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];for(let t=0;t<r;++t)for(let i=0;i<3;++i)n[i]=e[3*t+i]>n[i]?n[i]:e[3*t+i],o[i]=e[3*t+i]<o[i]?o[i]:e[3*t+i];const s=n.map(((e,t)=>.5*(e+o[t])));s.map((e=>Number.isFinite(e)?e:0));let a=Math.sqrt(n.map(((e,t)=>o[t]-e)).reduce(((e,t)=>t*t+e),0));return a=Number.isFinite(a)?a:0,i?(Cesium.Cartesian3.fromElements(...s,i.center),i.radius=.5*a):i=new Cesium.BoundingSphere(Cesium.Cartesian3.fromElements(...s),.5*a),Cesium.BoundingSphere.transform(i,t,i),i}function Qr(e,t,i){const r=new Cesium.ShaderSource({sources:[i.vertexShaderSource]});let n=i.fragmentShaderSource;n="uniform vec4 czm_pickColor;\n"+n;const o=new Cesium.ShaderSource({sources:[n]}),s=Cesium.ShaderProgram.fromCache({context:e,vertexShaderSource:r,fragmentShaderSource:o,attributeLocations:Rr}),a=new Cesium.Cartesian4(1,1,1,1),l={u_image:function(){return t.texture||e.defaultTexture},u_color:function(){return t._color||a},u_customParams:function(){return t._customParams||a},czm_pickColor:function(){return t._pickId.color||a}},h=Cesium.RenderState.fromCache(i.renderState);try{const t=function(e,t,i,r,n,o,s){t=new Float32Array(t);const a=i?new Cesium.GeometryAttribute({componentDatatype:Cesium.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:new Float32Array(i)}):{componentDatatype:Cesium.ComponentDatatype.FLOAT,componentsPerAttribute:3,normalize:!1,value:[0,0,1]},l=n?new Cesium.GeometryAttribute({componentDatatype:Cesium.ComponentDatatype.FLOAT,componentsPerAttribute:4,values:new Float32Array(n)}):{componentDatatype:Cesium.ComponentDatatype.FLOAT,componentsPerAttribute:4,normalize:!1,value:[1,1,1,1]},h=r?new Cesium.GeometryAttribute({componentDatatype:Cesium.ComponentDatatype.FLOAT,componentsPerAttribute:2,values:new Float32Array(r)}):{componentDatatype:Cesium.ComponentDatatype.FLOAT,componentsPerAttribute:2,normalize:!1,value:[1,1]};var c=new Cesium.Geometry({attributes:{position:new Cesium.GeometryAttribute({componentDatatype:Cesium.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:t}),normal:a,textureCoordinates:h,color:l},indices:new Uint16Array(o),primitiveType:s,boundingSphere:Cesium.BoundingSphere.fromVertices(t)});return Cesium.VertexArray.fromGeometry({context:e,geometry:c,attributeLocations:Rr,bufferUsage:Cesium.BufferUsage.STATIC_DRAW})}(e,i.positions,i.normals,i.sts,i.colors,i.indices,i.primitiveType);return new Cesium.DrawCommand({vertexArray:t,primitiveType:i.primitiveType,renderState:h,shaderProgram:s,uniformMap:l,owner:this,pass:i.pass,modelMatrix:i.modelMatrix})}catch(e){return}}class kr{constructor(e){Fr||(Fr=Fr||Cesium.DrawCommand.shallowClone,Cesium.DrawCommand.shallowClone=function(e,t){return t=Fr.call(this,e,t),e.execute!==Cesium.DrawCommand.prototype.execute&&(t.execute=e.execute),t}),this.show=!0,this._command=void 0,this._modelMatrix=new Cesium.Matrix4,this._bs=new Cesium.BoundingSphere,e.modelMatrix?Cesium.Matrix4.clone(e.modelMatrix,this._modelMatrix):Cesium.Matrix4.clone(Cesium.Matrix4.IDENTITY,this._modelMatrix),Hr=Hr||{positions:[0,0,0,1,0,0,0,.5,0],normals:[0,0,1,0,0,1,0,0,1],sts:[0,0,1,0,0,1],colors:[1,0,0,1,0,1,0,1,0,0,1,1],indices:[0,1,2],vertexShaderSource:Dr,fragmentShaderSource:Ir,pass:Cesium.Pass.OPAQUE,primitiveType:Cesium.PrimitiveType.TRIANGLES,modelMatrix:this._modelMatrix,renderState:{},texture:void 0,color:[1,1,1,1],customParams:[0,0,0,0]},this._options=Object.assign({},Hr,e),this._texture=this._options.texture,this._color=new Cesium.Cartesian4(...this._options.color),this._customParams=new Cesium.Cartesian4(...this._options.customParams),this._bs=Nr(e.positions,this._modelMatrix,this._bs),this._owner=e.owner,this._drawCallback=void 0}get texture(){return this._texture}set texture(e){this._texture=e}get color(){const e=this._color;return[e.x,e.y,e.z,e.w]}set color(e){Cesium.Cartesian4.fromArray(e,0,this._color)}get customParams(){const e=this._customParams;return[e.x,e.y,e.z,e.w]}set customParams(e){Cesium.Cartesian4.fromArray(e,0,this._customParams)}get modelMatrix(){return this._modelMatrix}set modelMatrix(e){Cesium.Matrix4.clone(e,this._modelMatrix),this._bs=Nr(this._options.positions,this._modelMatrix,this._bs)}get boundingSphere(){return this._bs}setDrawCallback(e){this._drawCallback=e}update(e){if(this.show){if(!Cesium.defined(this._command)){this._command=Qr(e.context,this,this._options);{const e=this;this._command.execute=function(...t){Cesium.DrawCommand.prototype.execute.call(this,...t),e._drawCallback&&e._drawCallback(e,...t)}}this._pickId=this._pickId&&this._pickId.destroy(),this._pickId=e.context.createPickId({primitive:this,id:this._owner}),this._command.pickId="czm_pickColor",this._command.boundingVolume=this._bs}Cesium.defined(this._command)&&e.commandList.push(this._command)}}isDestroyed(){return!1}destroy(){return Cesium.defined(this._command)&&(this._command.shaderProgram=this._command.shaderProgram&&this._command.shaderProgram.destroy(),this._command.vertexArray=this._command.vertexArray&&this._command.vertexArray.destroy()),this._pickId=this._pickId&&this._pickId.destroy(),Cesium.destroyObject(this)}}kr.createTextureFromImage=Lr,kr.getRenderState=function(e,t){var i={depthTest:{enabled:!0}};return e&&(i.depthMask=!1,i.blending=Cesium.BlendingState.ALPHA_BLEND),t&&(i.cull={enabled:!0,face:Cesium.CullFace.BACK}),i},kr.defaultVertexShader=Dr,kr.defaultFragmentShader=Ir;const Ur=kr;function jr(e,t){return void 0===t&&(t=[0,0]),t[0]=-e[1],t[1]=e[0],t}function Gr(e,t,i){return void 0===i&&(i=[0,0]),i[0]=e[0]-t[0],i[1]=e[1]-t[1],i}function zr(e,t){void 0===t&&(t=[0,0]);var i=function(e){return Math.sqrt(function(e){return e[0]*e[0]+e[1]*e[1]}(e))}(e);return t[0]=e[0]/i,t[1]=e[1]/i,t}function Yr(e,t){return void 0===t&&(t=[0,0]),t[0]=-e[0],t[1]=-e[1],t}function Zr(e,t,i){return void 0===i&&(i=[0,0]),i[0]=e[0]*t,i[1]=e[1]*t,i}function Wr(e,t,i){return void 0===i&&(i=[0,0]),i[0]=e[0]+t[0],i[1]=e[1]+t[1],i}function Xr(e,t){var i,r,n=(r=t,(i=e)[0]*r[0]+i[1]*r[1]),o=Math.acos(n);return 1/Math.cos(o/2)}function Jr(e,t,i){return void 0===i&&(i=[0,0]),i[0]=e,i[1]=t,i}var Kr=[0,0],Vr=[0,0],qr=[0,0],$r=[0,0],en=[0,0],tn=[0,0],rn=[0,0],nn=[0,0];function on(e,t,i,r,n,o){var s=Gr(e,t,nn),a=jr(zr(s,s),$r),l=Gr(i,e,nn),h=jr(zr(l,l),tn),c=Yr(a,en),u=Yr(h,rn),p=Wr(a,h);zr(p,p);var d,m,f=(m=h,(d=a)[0]*m[1]-d[1]*m[0]);if(Math.abs(f)<.1)Wr(y=Zr(p,r,nn),e,y),o.push(y[0],y[1]),n.push(o.length/2),o.push(e[0],e[1]),n.push(o.length/2),Zr(v=Yr(p,nn),r,v),Wr(v,e,v),o.push(v[0],v[1]),n.push(o.length/2);else if(f<0){Wr(y=Zr(a,r,nn),e,y),o.push(y[0],y[1]);var g=Zr(p,r,nn);Wr(g,e,g),o.push(g[0],g[1]),Wr(v=Zr(h,r,nn),e,v),o.push(v[0],v[1]),n.push(o.length/2),o.push(e[0],e[1]),n.push(o.length/2),A=(A=Xr(u,c))>3?3:A,Zr(C=Yr(p,nn),A*r,C),Wr(C,e,C),o.push(C[0],C[1]),n.push(o.length/2)}else{var A,y,v;Wr(y=Zr(p,(A=(A=Xr(a,h))>3?3:A)*r,nn),e,y),o.push(y[0],y[1]),n.push(o.length/2),o.push(e[0],e[1]),n.push(o.length/2),Wr(v=Zr(c,r,nn),e,v),o.push(v[0],v[1]);var C,_=Yr(p,nn);Zr(_,r,_),Wr(_,e,_),o.push(_[0],_[1]),Wr(C=Zr(u,r,nn),e,C),o.push(C[0],C[1]),n.push(o.length/2)}}var sn=[];function an(e,t,i,r,n,o){void 0===i&&(i=!1),r=null!=r?r:[],n=null!=n?n:[],o=null!=o?o:[];var s=sn;s.length=0,function(e,t,i,r,n){if(void 0===i&&(i=!1),e.length%2!=0)throw new Error("positions.length % 2 !== 0");r=null!=r?r:[],n=null!=n?n:[];var o=e,s=o.length/2;if(!(s<2)){if(i){if(!(s>=3))throw new Error("loop should have >= 3 vertex!");var a=Jr(o[0],o[1],Kr),l=Jr(o[2],o[3],qr);on(a,Jr(o[2*(s-1)+0],o[2*(s-1)+1],Vr),l,t,n,r)}else{a=Jr(o[0],o[1],Kr);var h=Gr(l=Jr(o[2],o[3],qr),a,nn),c=jr(zr(h,h),tn);Wr(p=Zr(c,t,nn),a,p),r.push(p[0],p[1]),n.push(r.length/2),r.push(a[0],a[1]),n.push(r.length/2),Zr(d=Yr(c,nn),t,d),Wr(d,a,d),r.push(d[0],d[1]),n.push(r.length/2)}if(s>=3)for(var u=1;u<s-1;++u)a=Jr(o[2*u+0],o[2*u+1],Kr),l=Jr(o[2*(u+1)+0],o[2*(u+1)+1],qr),on(a,Jr(o[2*(u-1)+0],o[2*(u-1)+1],Vr),l,t,n,r);if(i){if(!(s>=3))throw new Error("loop should have >= 3 vertex!");a=Jr(o[2*(s-1)+0],o[2*(s-1)+1],Kr),l=Jr(o[0],o[1],qr),on(a,Jr(o[2*(s-2)+0],o[2*(s-2)*1],Vr),l,t,n,r)}else{var p,d,m=Gr(a=Jr(o[2*(s-1)+0],o[2*(s-1)+1],Kr),Jr(o[2*(s-2)+0],o[2*(s-2)+1],Vr),nn),f=jr(zr(m,m),$r);Wr(p=Zr(f,t,nn),a,p),r.push(p[0],p[1]),n.push(r.length/2),r.push(a[0],a[1]),n.push(r.length/2),Zr(d=Yr(f,nn),t,d),Wr(d,a,d),r.push(d[0],d[1]),n.push(r.length/2)}}}(e,.5*t,i,r,s),function(e,t,i,r,n){if(r=r||[],n=n||[],e.length%2!=0)throw new Error("extrudedPositions.length % 2 !== 0");if(i.length%3!=0)throw new Error("extrudesSegments.length % 3 !== 0");for(var o=i.length/3,s=0,a=0;a<o;++a){for(var l=i[3*a+0],h=i[3*a+1],c=i[3*a+2],u=s;u<l;++u)r.push(0,0);if(l-s>=2)for(var p=s+1;p<l;++p)n.push(l,p,p-1);r.push(0,.5);for(var d=h;d<c;++d)r.push(0,1);if(c-h>=2)for(var m=h+1;m<c;++m)n.push(l,m-1,m);s=c}for(s=0,a=0;a<o-1;++a){var f=i[3*a+0]-1,g=i[3*a+1]-1,A=i[3*a+2]-1,y=i[3*a+2],v=i[3*(a+1)+0],C=i[3*(a+1)+1];n.push(f,g,v),n.push(f,v,y),n.push(g,A,C),n.push(g,C,v)}t&&(f=i[3*(o-1)+0]-1,g=i[3*(o-1)+1]-1,A=i[3*(o-1)+2]-1,y=0,v=i[0],C=i[1],n.push(f,g,v),n.push(f,v,y),n.push(g,A,C),n.push(g,C,v))}(r,i,s,n,o)}var ln=function(){function e(e){e&&(this._resouceRef={resouce:e,ref:1})}return Object.defineProperty(e.prototype,"valid",{get:function(){return!!this._resouceRef},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"raw",{get:function(){var e;return null===(e=this._resouceRef)||void 0===e?void 0:e.resouce},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ref",{get:function(){var e;return null===(e=this._resouceRef)||void 0===e?void 0:e.ref},enumerable:!1,configurable:!0}),e.prototype.getRef=function(t){return(t=null!=t?t:new e).reset(this),t},e.prototype.equal=function(e){return e._resouceRef===this._resouceRef},e.prototype.reset=function(e){if(this._resouceRef){if(this._resouceRef.ref<=0)throw new Error("ref <= 0!");--this._resouceRef.ref,0===this._resouceRef.ref&&this._resouceRef.resouce.destroy(),this._resouceRef=void 0}if(e){if(!e._resouceRef)throw new Error("handler._resouceRef is undefined!");e._resouceRef.ref+=1,this._resouceRef=e._resouceRef}return this},e}(),hn=i(5108),cn=function(e,t,i,r){return new(i||(i=Promise))((function(n,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?n(e.value):function(e){return e instanceof i?e:new i((function(t){t(e)}))}(e.value).then(s,a)}l((r=r.apply(e,t||[])).next())}))},un=function(e,t){var i,r,n,o,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,r&&(n=2&o[0]?r.return:o[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,o[1])).done)return n;switch(r=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(n=s.trys,(n=n.length>0&&n[n.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){s.label=o[1];break}if(6===o[0]&&s.label<n[1]){s.label=n[1],n=o;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(o);break}n[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{i=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},pn=function(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],r=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},dn=function(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var r,n,o=i.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){n={error:e}}finally{try{r&&!r.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}return s},mn=function(){function e(e){this._context=e,this._map=new Map,this._loadingMap=new Map}return e.prototype.getImage=function(e){return cn(this,void 0,void 0,(function(){var t,i,r=this;return un(this,(function(n){if(this._map.has(e)){if((t=this._map.get(e))&&t.valid)return[2,t];this._map.delete(e)}return this._loadingMap.has(e)?i=this._loadingMap.get(e):(i=new Promise((function(t,i){Cesium.Resource.createIfNeeded(e).fetchImage().then((function(i){var n=Lr(r._context,i),o=new ln(n);r._map.set(e,o),r._loadingMap.delete(e),t(o)})).otherwise((function(){hn.error("loading image error!"),r._loadingMap.delete(e),i()}))})),this._loadingMap.set(e,i)),[2,i]}))}))},e.prototype.clearUnused=function(){var e,t,i,r,n=[];try{for(var o=pn(this._map),s=o.next();!s.done;s=o.next()){var a=dn(s.value,2),l=a[0];1===a[1].ref&&n.push(l)}}catch(t){e={error:t}}finally{try{s&&!s.done&&(t=o.return)&&t.call(o)}finally{if(e)throw e.error}}try{for(var h=pn(n),c=h.next();!c.done;c=h.next()){l=c.value;this._map.get(l).reset(),this._map.delete(l)}}catch(e){i={error:e}}finally{try{c&&!c.done&&(r=h.return)&&r.call(h)}finally{if(i)throw i.error}}},e}(),fn=i(5108);const gn=new Function("fs","vs","vts","vns","vcs","\n    const nfs = [];\n    const indices = [];\n\n    for (let fe of fs) {\n        // let index = nfs.indexOf(fe);\n        let index = nfs.findIndex(nfse => nfse[0] === fe[0] && nfse[1] === fe[1] && nfse[2] === fe[2]);\n        if (-1 === index) {\n            index = nfs.length;\n            nfs.push(fe);\n        }\n        indices.push(index);\n    }\n\n    const positions = [];\n    const normals = [];\n    const colors = [];\n    const sts = [];\n    for (let e of nfs) {\n        // const is = e.split('/').map(e => +e - 1);\n        const is = e;\n        positions.push(vs[is[0] * 3 + 0], vs[is[0] * 3 + 1], vs[is[0] * 3 + 2]);\n        vts.length > 0 && sts.push(vts[is[1] * 2 + 0], vts[is[1] * 2 + 1]);\n        vns.length > 0 && normals.push(vns[is[2] * 3 + 0], vns[is[2] * 3 + 1], vns[is[2] * 3 + 2]);\n        vcs.length > 0 && colors.push(vcs[is[0] * 4 + 0], vcs[is[0] * 4 + 1], vcs[is[0] * 4 + 2], vcs[is[0] * 4 + 3]);\n    }\n    return { positions, normals, sts, colors, indices };\n"),An={position:[0,0,0],rotation:[0,0,0],scale:[1,1,1],show:!0,modelMatrix:void 0,positions:[0,0,0,1,0,0,0,.5,0],normals:void 0,sts:void 0,colors:void 0,indices:[0,1,2],vertexShaderSource:Ur.defaultVertexShader,fragmentShaderSource:Ur.defaultFragmentShader,pass:7,primitiveType:WebGLRenderingContext.TRIANGLES,renderState:xr,color:[1,1,1,1],customParams:[0,0,0,0],canvasWidth:0,canvasHeight:0,autoRegisterEditing:!1,imageUrl:"",objUrl:""};let yn=new Map;function vn(e){return yn.has(e)||yn.set(e,new mn(e)),yn.get(e)}class Cn extends u.Z{constructor(e,t){super(e,t),this.disposers.push((0,O.Z)(this,"enabled",this,"show")),this.disposers.push(h.Z.registerProperty(this,"renderState",xr)),this.disposers.push(h.Z.registerProperty(this.renderState,"cull",xr.cull)),this.disposers.push(h.Z.registerProperty(this.renderState,"polygonOffset",xr.polygonOffset)),this.disposers.push(h.Z.registerProperty(this.renderState,"scissorTest",xr.scissorTest)),this.disposers.push(h.Z.registerProperty(this.renderState.scissorTest,"rectangle",xr.scissorTest.rectangle)),this.disposers.push(h.Z.registerProperty(this.renderState,"depthRange",xr.depthRange)),this.disposers.push(h.Z.registerProperty(this.renderState,"depthTest",xr.depthTest)),this.disposers.push(h.Z.registerProperty(this.renderState,"colorMask",xr.colorMask)),this.disposers.push(h.Z.registerProperty(this.renderState,"blending",xr.blending)),this.disposers.push(h.Z.registerProperty(this.renderState.blending,"color",xr.blending.color)),this.disposers.push(h.Z.registerProperty(this.renderState,"stencilTest",xr.stencilTest)),this.disposers.push(h.Z.registerProperty(this.renderState.stencilTest,"frontOperation",xr.stencilTest.frontOperation)),this.disposers.push(h.Z.registerProperty(this.renderState.stencilTest,"backOperation",xr.stencilTest.backOperation)),this.disposers.push(h.Z.registerProperty(this.renderState,"sampleCoverage",xr.sampleCoverage)),(0,P.extendObservable)(this,{_texture:void 0},{_texture:P.observable.ref}),this.disposers.push((()=>{this._texture=this._texture&&this._texture.destroy()})),(0,P.extendObservable)(this,{_sharedTexture:void 0},{_sharedTexture:P.observable.ref}),this.disposers.push((()=>{this._sharedTexture&&this._sharedTexture.valid&&this._sharedTexture.reset(),this._sharedTexture=void 0})),this._scratchMatrix4=this._scratchMatrix4||new Cesium.Matrix4,this._primitive=void 0,this.disposers.push((()=>{this._primitive&&(e.czm.scene.primitives.remove(this._primitive),this._primitive=void 0)})),this._modelMatrix=new Cesium.Matrix4;const i=()=>{this.modelMatrix?Cesium.Matrix4.fromColumnMajorArray(this.modelMatrix,this._modelMatrix):gt(this.position,this.rotation,this.scale,this._modelMatrix),this._primitive&&(this._primitive.modelMatrix=this._modelMatrix)};i(),this.disposers.push((0,P.reaction)((()=>({position:[...this.position],rotation:[...this.rotation],scale:[...this.scale],modelMatrix:this.modelMatrix?[...this.modelMatrix]:void 0})),i)),(0,P.extendObservable)(this,{drawCallback:void 0},{drawCallback:P.observable.ref});const r=()=>{this._primitive&&(this._primitive.show=this.show,this._primitive.color=this.color,this._primitive.setDrawCallback(this.drawCallback))};r(),this.disposers.push((0,P.reaction)((()=>({show:this.show,color:[...this.color],drawCallback:this.drawCallback})),r));const n=()=>{const t=this._positions,i=this._normals,n=this._sts,o=this._colors,s=this._indices,a=t.length/3;0===a||i&&a!==i.length/3||n&&a!==n.length/2||o&&a!==o.length/4?fn.warn("必须保证位置、法向、纹理坐标数量相等！"):~s.findIndex((e=>e>=a))?fn.warn("有索引超出范围！"):(this._primitive&&(e.czm.scene.primitives.remove(this._primitive),this._primitive=void 0),this._primitive=e.czm.scene.primitives.add(new Ur({positions:t,normals:i,sts:n,colors:o,indices:s,modelMatrix:this._modelMatrix,renderState:this.renderState,vertexShaderSource:this.vertexShaderSource,fragmentShaderSource:this.fragmentShaderSource,pass:this.pass,primitiveType:this.primitiveType,renderState:this.renderState,texture:void 0,owner:this})),this._primitive.customParams=this.customParams,this._sharedTexture&&this._sharedTexture.valid?this._primitive.texture=this._sharedTexture.raw:this._primitive.texture=this._texture,this._primitive.modelMatrix=this._modelMatrix,r())};this._loadObj=void 0,this.disposers.push((()=>{this._loadObj&&(this._loadObj.unsubscribe(),this._loadObj=void 0)}));const o=()=>{this.objUrl!==this._objUrl?(this._objUrl=this.objUrl,this._loadObj&&(this._loadObj.unsubscribe(),this._loadObj=void 0),this._loadObj=rxjs.from((async()=>{try{const e=await fetch(this._objUrl),t=(await e.text()).split("\n"),i=[],r=[],n=[],o=[],s=[];t.forEach((e=>{if(e.startsWith("v ")){const t=e.split(" ");i.push(+t[1],+t[2],+t[3]),7===t.length&&r.push(+t[4],+t[5],+t[6],1)}if(e.startsWith("vt ")){const t=e.split(" ");n.push(+t[1],+t[2])}if(e.startsWith("vn ")){const t=e.split(" ");o.push(+t[1],+t[2],+t[3])}if(e.startsWith("f ")){const t=e.split(" ");s.push(t[1],t[2],t[3]),5===t.length&&s.push(t[1],t[3],t[4])}})),0!==n.length&&i.length/3!=n.length/2&&(fn.warn("纹理坐标数组长度不匹配！将被忽略！"),n.length=0),0!==o.length&&i.length/3!=o.length/3&&(fn.warn("法向数组长度不匹配！将被忽略！"),o.length=0),0!==r.length&&i.length/3!=r.length/4&&(fn.warn("颜色数组长度不等！将被忽略!"),r.length=0),s.forEach(((e,t)=>{s[t]=e.split("/").map((e=>+e-1))}));if(s.every((e=>e[0]===e[1]&&e[0]===e[2]))){const e=[];for(let t of s)e.push(t[0]);return{positions:i,normals:o,sts:n,colors:r,indices:e}}{const{positions:e,normals:t,sts:a,colors:l,indices:h}=gn(s,i,n,o,r);return{positions:e,normals:t,sts:a,colors:l,indices:h}}}catch(e){return{}}})()).subscribe((({positions:e,normals:t,sts:i,colors:r,indices:o})=>{this._positions=e,this._normals=t&&t.length>0?t:void 0,this._sts=i&&i.length>0?i:void 0,this._colors=r&&r.length>0?r:void 0,this._indices=o,n()}))):n()};this._objUrl="";const s=()=>{void 0!==this.objUrl&&""!==this.objUrl?o():(this._positions=this.positions,this._normals=this.normals,this._sts=this.sts,this._colors=this.colors,this._indices=this.indices,n())};s(),this.disposers.push((0,P.reaction)((()=>({positions:this.positions?[...this.positions]:void 0,normals:this.normals?[...this.normals]:void 0,sts:this.sts?[...this.sts]:void 0,colors:this.colors?[...this.colors]:void 0,indices:this.indices?[...this.indices]:void 0,customParams:[...this.customParams],vertexShaderSource:[...this.vertexShaderSource],fragmentShaderSource:[...this.fragmentShaderSource],pass:this.pass,primitiveType:this.primitiveType,renderState:JSON.stringify(this.renderState),texture:this._texture,_sharedTexture:this._sharedTexture,objUrl:this.objUrl})),s));const a=()=>{if(!(this._texture&&this.canvasWidth===this._texture.width&&this.canvasHeight===this._texture.height)&&(this._texture=this._texture&&this._texture.destroy(),this.canvasWidth>0&&this.canvasHeight>0&&(this._texture=new Cesium.Texture({context:e.czm.scene.context,width:this.canvasWidth,height:this.canvasHeight,source:void 0,flipY:!0}),Cesium.Math.isPowerOfTwo(this._texture.width)&&Cesium.Math.isPowerOfTwo(this._texture.height)&&(this._texture.generateMipmap(),this._texture.sampler=new Cesium.Sampler({wrapS:Cesium.TextureWrap.REPEAT,wrapT:Cesium.TextureWrap.REPEAT,minificationFilter:Cesium.TextureMinificationFilter.LINEAR_MIPMAP_LINEAR,magnificationFilter:Cesium.TextureMagnificationFilter.LINEAR_MIPMAP_LINEAR})))),!this._canvas){const e=document.createElement("canvas");this._canvas=e,this._ctx=e.getContext("2d")}this._canvas.width===this.canvasWidth&&this._canvas.height===this.canvasHeight||(this._canvas.width=this.canvasWidth,this._canvas.height=this.canvasHeight)};this._updateCanvas=a,a(),this.disposers.push((0,P.reaction)((()=>({canvasWidth:this.canvasWidth,canvasHeight:this.canvasHeight})),a));const l=()=>{this.autoRegisterEditing&&!this.creating&&this.registerEditing()};l(),this.disposers.push((0,P.reaction)((()=>this.autoRegisterEditing),l)),this._videoElement=void 0,this._videoAnimation=void 0,this.disposers.push((()=>{this._videoElement=this._videoElement&&mi(this._videoElement),this._videoAnimation&&(cancelAnimationFrame(this._videoAnimation),this._videoAnimation=void 0)})),this._settingVideoElement=void 0,this.disposers.push((()=>{this._settingVideoElement&&(this._settingVideoElement.unsubscribe(),this._settingVideoElement=void 0)}));const c=()=>{if(this._imageSubscription&&(this._imageSubscription.unsubscribe(),this._imageSubscription=void 0),this._videoAnimation&&(cancelAnimationFrame(this._videoAnimation),this._videoAnimation=void 0),this._videoElement=this._videoElement&&mi(this._videoElement),this._settingVideoElement&&(this._settingVideoElement.unsubscribe(),this._settingVideoElement=void 0),"string"==typeof this.imageUrl)if(this.imageUrl.endsWith(".jpg")||this.imageUrl.endsWith(".png")||this.imageUrl.startsWith("data:image")){const e=new rxjs.Observable((e=>{vn(this.earth.czm.scene.context).getImage(this.imageUrl).then((t=>{e.next(t)}))}));this._imageSubscription=e.subscribe((e=>{this._sharedTexture&&(this._sharedTexture.reset(),this._sharedTexture=void 0);const t=new ln;t.reset(e),this._sharedTexture=t}))}else[".ogg",".webm",".mp4",".m3u8",".flv"].some((e=>this.imageUrl.endsWith(e)))?this._settingVideoElement=rxjs.from(di(this.imageUrl)).subscribe((e=>{if(this._videoElement=e,this._videoElement){const t=()=>{this._videoAnimation=requestAnimationFrame(t),e.videoWidth>0&&e.videoHeight>0&&4===e.readyState&&(this.canvasWidth===e.videoWidth&&this.canvasHeight===e.videoHeight||(this.canvasWidth=e.videoWidth,this.canvasHeight=e.videoHeight),this._updateCanvas(),this._texture&&this._texture.copyFrom(e))};this._videoAnimation=requestAnimationFrame(t)}})):(this.canvasWidth=1,this.canvasHeight=1,this.drawCanvas((e=>{e.clearRect(0,0,1,1),e.fillStyle="white",e.fillRect(0,0,1,1)})),this._videoElement=void 0,this._sharedTexture&&(this._sharedTexture.reset(),this._sharedTexture=void 0))};c(),this.disposers.push((0,P.reaction)((()=>this.imageUrl),c))}drawCanvas(e){this.canvasWidth>0&&this.canvasHeight>0?(this._updateCanvas(),e(this._ctx,this._canvas),this._texture.copyFrom(this._canvas),Cesium.Math.isPowerOfTwo(this._texture.width)&&Cesium.Math.isPowerOfTwo(this._texture.height)&&this._texture.generateMipmap()):fn.warn("canvas尺寸未设置，无法绘制！")}get texture(){return this._texture}set texture(e){this._texture=e}flyTo(){if(this._primitive){const e=this._primitive.boundingSphere,t=Cesium.Cartographic.fromCartesian(e.center),i=e.radius;this._earth.camera.flyTo([t.longitude,t.latitude,t.height],3*i)}}registerEditing(){this.disposers.push((0,ae.Ak)(this._earth,this,{})),this.disposers.push((0,ae.zC)(this._earth,this,{positionPickingProperty:"creating"})),this.disposers.push((0,ae.J_)(this._earth,this,{}))}}const _n={title:"CustomPrimitive Property",type:"object",properties:{position:{type:"array",items:{type:"number"},minItems:3,maxItems:3,default:[0,0,0],description:"位置 [经度, 纬度, 高度]"},rotation:{type:"array",items:{type:"number"},minItems:3,maxItems:3,default:[0,0,0],description:"姿态数组 [偏航角、俯仰角、翻转角]"},scale:{type:"array",items:{type:"number"},minItems:3,maxItems:3,default:[1,1,1],description:"姿态数组 [偏航角、俯仰角、翻转角]"},show:{type:"boolean",title:"是否在三维窗口中显示",default:!0,description:"是否在三维窗口中显示"},modelMatrix:{type:["array","undefined"],items:{type:"number"},minItems:16,maxItems:16,default:void 0,description:"姿态矩阵"},positions:{type:"array",items:{type:"number"},minItems:0,default:[0,0,0,1,0,0,0,.5,0],description:"位置数组"},normals:{type:["array","undefined"],items:{type:"number"},minItems:0,default:void 0,description:"法向数组"},sts:{type:["array","undefined"],items:{type:"number"},minItems:0,default:void 0,description:"纹理坐标数组"},colors:{type:["array","undefined"],items:{type:"number"},minItems:0,default:void 0,description:"颜色数组"},indices:{type:"array",items:{type:"number"},minItems:3,maxItems:3,default:[0,1,2],description:"索引数组"},vertexShaderSource:{type:"string",default:Ur.defaultVertexShader,description:"顶点shader"},fragmentShaderSource:{type:"string",default:Ur.defaultFragmentShader,description:"片元shader"},pass:{type:"number",title:"渲染顺次",default:7,description:"渲染顺次"},primitiveType:{type:"number",title:"绘制图元类型",default:4,description:"绘制图元类型"},renderState:{type:"object",title:"WebGL渲染状态",default:{},description:"WebGL渲染状态"},color:{type:"array",items:{type:"number"},minItems:4,maxItems:4,default:[1,1,1,1],description:"颜色叠加"},customParams:{type:"array",items:{type:"number"},minItems:4,maxItems:4,default:[0,0,0,0],description:"自定义参数"},canvasWidth:{type:"number",title:"画布宽度，单位像素",default:0,description:"画布宽度，单位像素"},canvasHeight:{type:"number",title:"画布高度，单位像素",default:0,description:"画布高度，单位像素"},imageUrl:{type:"string",title:"纹理对应的图像url",default:0,description:"纹理对应的图像url"},objUrl:{type:"string",title:"obj文件url",default:0,description:"obj文件url"},autoRegisterEditing:{type:"boolean",title:"是否自动注册编辑功能",default:!1,description:"是否自动注册编辑功能"}}};Cn.gvolSchema=_n;Cn.gvolClassification=[{name:{chinese:"通用",english:"General"},properties:["position","rotation","scale","show","modelMatrix","positions","normals","sts","colors","indices","vertexShaderSource","fragmentShaderSource","pass","primitiveType","renderState","color","customParams","canvasWidth","canvasHeight","imageUrl","objUrl","autoRegisterEditing"]}],Cn.createTextureFromImage=Ur.createTextureFromImage,Cn.createDynamicPoi=function({earth:e,imageUrl:t,configUrl:i,position:r,scale:n=100,color:o=[1,1,1,1]}){const s={imageUrl:t,position:[...r],scale:[1,256,256],positions:[0,-1,0,0,1,0,0,1,2,0,-1,2,0,1,0,0,-1,0,0,-1,2,0,1,2],sts:[0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,1],indices:[0,1,2,0,2,3,4,5,6,4,6,7],customParams:[0,0,1,16],vertexShaderSource:"\n        attribute vec3 position;\n        attribute vec3 normal;\n        attribute vec2 st;\n        attribute vec4 color;\n        attribute float batchId;\n        varying vec3 v_positionEC;\n        varying vec3 v_normalEC;\n        varying vec2 v_st;\n        varying vec4 v_color;\n        void main()\n        {\n            v_positionEC = (czm_modelView * vec4(position, 1.0)).xyz;       // position in eye coordinates\n            v_normalEC = czm_normal * normal;                               // normal in eye coordinates\n            v_st = st;\n            v_color = color;\n            gl_Position = czm_modelViewProjection * vec4(position, 1.0);\n        }\n    ",fragmentShaderSource:"\n        varying vec3 v_positionEC;\n        varying vec3 v_normalEC;\n        varying vec2 v_st;\n        varying vec4 v_color;\n        uniform sampler2D u_image;\n        uniform vec4 u_color;\n        uniform vec4 u_customParams; // 用来指定图像的部分区域 x y width height 都在0-1之间，是比例！\n        void main()\n        {\n            vec3 positionToEyeEC = -v_positionEC;\n            vec3 normalEC = normalize(v_normalEC);\n            normalEC = faceforward(normalEC, vec3(0.0, 0.0, 1.0), -normalEC);\n\n            vec2 subTexSize = u_customParams.xy;\n            float maxCount = floor(u_customParams.z);\n            float velocity = floor(u_customParams.w); // 每秒多少张\n\n            float maxRowCount = floor(1.0 / subTexSize.x);\n            float ti = floor(mod(czm_frameNumber * (velocity / 60.0) + u_color.a * 60.0, maxCount));\n            float tx = mod(ti, maxRowCount) * subTexSize.x;\n            float ty = 1.0 - (floor(ti/maxRowCount) + 1.0) * subTexSize.y;\n            vec2 subTexCoord = vec2(tx, ty);\n            vec4 imageColor = texture2D(u_image, fract(subTexCoord.xy + v_st * subTexSize));\n\n            // vec4 imageColor = texture2D(u_image, fract(u_customParams.xy + v_st * u_customParams.zw));\n            // imageColor = czm_gammaCorrect(imageColor);\n            vec3 diffuse = imageColor.rgb;\n            float alpha = imageColor.a;\n\n            diffuse *= v_color.rgb;\n            alpha *= v_color.a;\n\n            diffuse *= u_color.rgb;\n            // alpha *= u_color.a; // alpha被用来设置随机数\n\n            // gl_FragColor = vec4(czm_inverseGamma(diffuse), alpha);\n            gl_FragColor = vec4((diffuse), alpha);\n        }\n    ",evalString:`\n        Cesium.Resource.fetchJson('${i}').then(json => {\n            const { count, files } = json;\n            if (files.length > 0) {\n                const { width, height, scaleU, scaleV } = files[0];\n                p.scale[1] = ${n} * width;\n                p.scale[2] = ${n} * height;\n                p._xx_files = files;\n                p.customParams = [scaleU, scaleV, count, p.customParams[3]];\n            }\n        });\n\n        const setFPS = fps => {\n            p.customParams.splice(3, 1, fps);\n        }\n        p.setFPS = setFPS;\n\n        const setStartTime = startTime => {\n            p.color.splice(3, 1, startTime);\n        }\n        p.setStartTime = setStartTime;\n    `,pass:Cesium.Pass.TRANSLUCENT,preUpdateEvalString:"\n        // if (p._xx_files) {\n        //     if (typeof p._xx_i === 'undefined') {\n        //         p._xx_i = 0;\n        //     }\n        //     p._xx_i = (++p._xx_i) % (p._xx_files.length);\n\n        //     const {\n        //         file,\n        //         // height,\n        //         offsetU,\n        //         offsetV,\n        //         scaleU,\n        //         scaleV,\n        //         // width,\n        //     } = p._xx_files[p._xx_i];\n        //     //p.customParams = [offsetU, 1.0 - (offsetV + scaleV), scaleU, scaleV];\n        // }\n\n        if (p.earth.camera.rotation[0] + Math.PI*0.5 !== p.rotation[0]) {\n            p.rotation[0] = p.earth.camera.rotation[0] + Math.PI*0.5;\n        }\n    ",renderState:{cull:{enabled:!0},polygonOffset:{},scissorTest:{rectangle:{}},depthRange:{},depthTest:{enabled:!0},colorMask:{},depthMask:!1,blending:{enabled:!0,color:{},equationRgb:32774,equationAlpha:32774,functionSourceRgb:770,functionDestinationRgb:771,functionDestinationAlpha:771},stencilTest:{frontOperation:{},backOperation:{}},sampleCoverage:{}},color:[...o],autoRegisterEditing:!0},a=new GVOL.Obj.CustomPrimitive(e);return a.gvolFromJSON(s),a},Cn.creatNumberPoi=function({earth:e,position:t,scale:i=32,color:r=[1,1,1,1]}){const n={imageUrl:R.Z.gvolEarthDir+"images/numbers/numbers-sdf.png",position:[...t],scale:[1,i,i],positions:[0,-1,0,0,1,0,0,1,2,0,-1,2,0,1,0,0,-1,0,0,-1,2,0,1,2],sts:[0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,1],indices:[0,1,2,0,2,3,4,5,6,4,6,7],evalString:"\n        function setNumber(num) {\n            const offsetU = (num % 32) / 32;\n            const offsetV = (num / 32 | 0) / 32;\n            const scaleU = 1 / 32;\n            const scaleV = 1 / 32;\n            this.customParams = [offsetU, 1.0 - (offsetV + scaleV), scaleU, scaleV];\n            this._xx_i = num;\n        }\n        p.setNumber = setNumber.bind(p);\n\n        function setFinal(final) {\n            final = final > 1000 ? 1000 : final;\n            final = final < 0 ? 0 : final;\n            this._xx_final = final;\n        }\n        p.setFinal = setFinal.bind(p);\n\n        p.setNumber(0);\n        p.setFinal(0);\n        setTimeout(() => {\n            p.setNumber(0);\n        }, 0);\n    ",preUpdateEvalString:"\n        if (p._xx_i !== p._xx_final) {\n            let add = 1;\n            if (p._xx_final < p._xx_i) {\n                add = -1;\n            }\n\n            p.setNumber(p._xx_i + add);\n        }\n\n        if (p.earth.camera.rotation[0] + Math.PI*0.5 !== p.rotation[0]) {\n            p.rotation[0] = p.earth.camera.rotation[0] + Math.PI*0.5;\n        }\n    ",vertexShaderSource:"\n        attribute vec3 position;\n        attribute vec3 normal;\n        attribute vec2 st;\n        attribute vec4 color;\n        attribute float batchId;\n        varying vec3 v_positionEC;\n        varying vec3 v_normalEC;\n        varying vec2 v_st;\n        varying vec4 v_color;\n        void main()\n        {\n            v_positionEC = (czm_modelView * vec4(position, 1.0)).xyz;       // position in eye coordinates\n            v_normalEC = czm_normal * normal;                               // normal in eye coordinates\n            v_st = st;\n            v_color = color;\n            gl_Position = czm_modelViewProjection * vec4(position, 1.0);\n        }\n    ",fragmentShaderSource:"\n        varying vec3 v_positionEC;\n        varying vec3 v_normalEC;\n        varying vec2 v_st;\n        varying vec4 v_color;\n        uniform sampler2D u_image;\n        uniform vec4 u_color;\n        uniform vec4 u_customParams; // 用来指定图像的部分区域 x y width height 都在0-1之间，是比例！\n        void main()\n        {\n            vec3 positionToEyeEC = -v_positionEC;\n            vec3 normalEC = normalize(v_normalEC);\n            normalEC = faceforward(normalEC, vec3(0.0, 0.0, 1.0), -normalEC);\n\n            vec4 sdfColor = texture2D(u_image, fract(u_customParams.xy + v_st * u_customParams.zw));\n            float distance = sdfColor.r;\n\n            float _SmoothDelta = 0.02;\n            float _DistanceMark = 0.7;\n\n            // do some anti-aliasing\n            vec4 imageColor = vec4(1.0, 1.0, 1.0, 1.0);\n            imageColor.a = smoothstep(_DistanceMark - _SmoothDelta, _DistanceMark + _SmoothDelta, distance);\n\n            //vec4 imageColor = texture2D(u_image, fract(u_customParams.xy + v_st * u_customParams.zw));\n\n            // imageColor = czm_gammaCorrect(imageColor);\n            vec3 diffuse = imageColor.rgb;\n            float alpha = imageColor.a;\n\n            diffuse *= v_color.rgb;\n            alpha *= v_color.a;\n\n            diffuse *= u_color.rgb;\n            alpha *= u_color.a;\n\n            // gl_FragColor = vec4(czm_inverseGamma(diffuse), alpha);\n            gl_FragColor = vec4((diffuse), alpha);\n        }\n    ",pass:Cesium.Pass.OVERLAY,renderState:{cull:{enabled:!0},polygonOffset:{enabled:!0,factor:-1,units:-10},scissorTest:{rectangle:{}},depthRange:{},depthTest:{enabled:!0},colorMask:{},depthMask:!1,blending:{enabled:!0,color:{},equationRgb:32774,equationAlpha:32774,functionSourceRgb:770,functionDestinationRgb:771,functionDestinationAlpha:771},stencilTest:{frontOperation:{},backOperation:{}},sampleCoverage:{}},color:[...r],autoRegisterEditing:!0},o=new GVOL.Obj.CustomPrimitive(e);return o.gvolFromJSON(n),o},Cn.createDynamicCountour=function({earth:e,imageUrl:t,configUrl:i,positions:r,height:n,loop:o,color:s=[1,1,1,1]}){const a=`\n        Cesium.Resource.fetchJson('${i}').then(json => {\n            const { count, files } = json;\n            if (files.length > 0) {\n                const { width, height, scaleU, scaleV } = files[0];\n                p._xx_files = files;\n                p.customParams = [scaleU, scaleV, count, p.customParams[3]];\n            }\n        });\n\n        const setFPS = fps => {\n            p.customParams.splice(3, 1, fps);\n        }\n        p.setFPS = setFPS;\n\n        const setStartTime = startTime => {\n            p.color.splice(3, 1, startTime);\n        }\n        p.setStartTime = setStartTime;\n    `,[l,h]=Or.getLocalPositions(r),c=[],u=[],p=[],d=r.length;for(let e=0;e<d;++e)c.push(l[3*e+0],l[3*e+1],l[3*e+2]),c.push(l[3*e+0],l[3*e+1],l[3*e+2]+n),u.push(.5,0,.5,1);if(o){const e=0;c.push(l[3*e+0],l[3*e+1],l[3*e+2]),c.push(l[3*e+0],l[3*e+1],l[3*e+2]+n),u.push(.5,0,.5,1)}let m=o?d:d-1;for(let e=0;e<m;++e){const t=2*e;p.push(0+t,2+t,1+t,2+t,3+t,1+t)}const f={imageUrl:t,position:[...h],scale:[1,1,1],positions:c,sts:u,indices:p,customParams:[0,0,1,16],vertexShaderSource:"\n        attribute vec3 position;\n        attribute vec3 normal;\n        attribute vec2 st;\n        attribute vec4 color;\n        attribute float batchId;\n        varying vec3 v_positionEC;\n        varying vec3 v_normalEC;\n        varying vec2 v_st;\n        varying vec4 v_color;\n        void main()\n        {\n            v_positionEC = (czm_modelView * vec4(position, 1.0)).xyz;       // position in eye coordinates\n            v_normalEC = czm_normal * normal;                               // normal in eye coordinates\n            v_st = st;\n            v_color = color;\n            gl_Position = czm_modelViewProjection * vec4(position, 1.0);\n        }\n    ",fragmentShaderSource:"\n        varying vec3 v_positionEC;\n        varying vec3 v_normalEC;\n        varying vec2 v_st;\n        varying vec4 v_color;\n        uniform sampler2D u_image;\n        uniform vec4 u_color;\n        uniform vec4 u_customParams; // 用来指定图像的部分区域 x y width height 都在0-1之间，是比例！\n        void main()\n        {\n            vec3 positionToEyeEC = -v_positionEC;\n            vec3 normalEC = normalize(v_normalEC);\n            normalEC = faceforward(normalEC, vec3(0.0, 0.0, 1.0), -normalEC);\n\n            vec2 subTexSize = u_customParams.xy;\n            float maxCount = floor(u_customParams.z);\n            float velocity = floor(u_customParams.w); // 每秒多少张\n\n            float maxRowCount = floor(1.0 / subTexSize.x);\n            float ti = floor(mod(czm_frameNumber * (velocity / 60.0) + u_color.a * 60.0, maxCount));\n            float tx = mod(ti, maxRowCount) * subTexSize.x;\n            float ty = 1.0 - (floor(ti/maxRowCount) + 1.0) * subTexSize.y;\n            vec2 subTexCoord = vec2(tx, ty);\n            vec4 imageColor = texture2D(u_image, fract(subTexCoord.xy + v_st * subTexSize));\n\n            // vec4 imageColor = texture2D(u_image, fract(u_customParams.xy + v_st * u_customParams.zw));\n            // imageColor = czm_gammaCorrect(imageColor);\n            vec3 diffuse = imageColor.rgb;\n            float alpha = imageColor.a;\n\n            diffuse *= v_color.rgb;\n            alpha *= v_color.a;\n\n            diffuse *= u_color.rgb;\n            // alpha *= u_color.a; // alpha被用来设置随机数\n\n            // gl_FragColor = vec4(czm_inverseGamma(diffuse), alpha);\n            gl_FragColor = vec4((diffuse), alpha);\n        }\n    ",evalString:a,pass:Cesium.Pass.TRANSLUCENT,renderState:{cull:{enabled:!1},polygonOffset:{},scissorTest:{rectangle:{}},depthRange:{},depthTest:{enabled:!0},colorMask:{},depthMask:!1,blending:{enabled:!0,color:{},equationRgb:32774,equationAlpha:32774,functionSourceRgb:770,functionDestinationRgb:771,functionDestinationAlpha:771},stencilTest:{frontOperation:{},backOperation:{}},sampleCoverage:{}},color:[...s],autoRegisterEditing:!0},g=new GVOL.Obj.CustomPrimitive(e);return g.gvolFromJSON(f),window.p=g,g},Cn.createDynamicCountour2=function({earth:e,imageUrl:t,configUrl:i,positions:r,width:n,loop:o,color:s=[1,1,1,1]}){const a=`\n        Cesium.Resource.fetchJson('${i}').then(json => {\n            const { count, files } = json;\n            if (files.length > 0) {\n                const { width, height, scaleU, scaleV } = files[0];\n                p._xx_files = files;\n                p.customParams = [scaleU, scaleV, count, p.customParams[3]];\n            }\n        });\n\n        const setFPS = fps => {\n            p.customParams.splice(3, 1, fps);\n        }\n        p.setFPS = setFPS;\n\n        const setStartTime = startTime => {\n            p.color.splice(3, 1, startTime);\n        }\n        p.setStartTime = setStartTime;\n    `,[l,h]=Or.getLocalPositions(r),c=[],u=[],p=[],d=[];{const e=l.length/3;for(let t=0;t<e;++t)d.push(l[3*t+0],l[3*t+1])}an(d,n,o,c,u,p);const m=[];{const e=c.length/2;for(let t=0;t<e;++t)m.push(c[2*t+0],c[2*t+1],0)}const f={imageUrl:t,position:[...h],scale:[1,1,1],positions:m,sts:u,indices:p,customParams:[0,0,1,16],primitiveType:4,vertexShaderSource:"\n        attribute vec3 position;\n        attribute vec3 normal;\n        attribute vec2 st;\n        attribute vec4 color;\n        attribute float batchId;\n        varying vec3 v_positionEC;\n        varying vec3 v_normalEC;\n        varying vec2 v_st;\n        varying vec4 v_color;\n        void main()\n        {\n            v_positionEC = (czm_modelView * vec4(position, 1.0)).xyz;       // position in eye coordinates\n            v_normalEC = czm_normal * normal;                               // normal in eye coordinates\n            v_st = st;\n            v_color = color;\n            gl_Position = czm_modelViewProjection * vec4(position, 1.0);\n        }\n    ",fragmentShaderSource:"\n        varying vec3 v_positionEC;\n        varying vec3 v_normalEC;\n        varying vec2 v_st;\n        varying vec4 v_color;\n        uniform sampler2D u_image;\n        uniform vec4 u_color;\n        uniform vec4 u_customParams; // 用来指定图像的部分区域 x y width height 都在0-1之间，是比例！\n        void main()\n        {\n            vec3 positionToEyeEC = -v_positionEC;\n            vec3 normalEC = normalize(v_normalEC);\n            normalEC = faceforward(normalEC, vec3(0.0, 0.0, 1.0), -normalEC);\n\n            vec2 subTexSize = u_customParams.xy;\n            float maxCount = floor(u_customParams.z);\n            float velocity = floor(u_customParams.w); // 每秒多少张\n\n            float maxRowCount = floor(1.0 / subTexSize.x);\n            float ti = floor(mod(czm_frameNumber * (velocity / 60.0) + u_color.a * 60.0, maxCount));\n            float tx = mod(ti, maxRowCount) * subTexSize.x;\n            float ty = 1.0 - (floor(ti/maxRowCount) + 1.0) * subTexSize.y;\n            vec2 subTexCoord = vec2(tx, ty);\n            vec4 imageColor = texture2D(u_image, fract(subTexCoord.xy + v_st * subTexSize));\n\n            // vec4 imageColor = texture2D(u_image, fract(u_customParams.xy + v_st * u_customParams.zw));\n            // imageColor = czm_gammaCorrect(imageColor);\n            vec3 diffuse = imageColor.rgb;\n            float alpha = imageColor.a;\n\n            diffuse *= v_color.rgb;\n            alpha *= v_color.a;\n\n            diffuse *= u_color.rgb;\n            // alpha *= u_color.a; // alpha被用来设置随机数\n\n            // gl_FragColor = vec4(czm_inverseGamma(diffuse), alpha);\n            gl_FragColor = vec4((diffuse), alpha);\n            // gl_FragColor = vec4(1.0, 1.0, 1.0, 1.0);\n        }\n    ",evalString:a,pass:Cesium.Pass.TRANSLUCENT,renderState:{cull:{enabled:!1},polygonOffset:{},scissorTest:{rectangle:{}},depthRange:{},depthTest:{enabled:!0},colorMask:{},depthMask:!1,blending:{enabled:!0,color:{},equationRgb:32774,equationAlpha:32774,functionSourceRgb:770,functionDestinationRgb:771,functionDestinationAlpha:771},stencilTest:{frontOperation:{},backOperation:{}},sampleCoverage:{}},color:[...s],autoRegisterEditing:!0},g=new GVOL.Obj.CustomPrimitive(e);return g.gvolFromJSON(f),window.p=g,g},Cn.getSharedTexturePool=vn,Cn.getRenderState=Ur.getRenderState,Cn.Geometry=Or,Cn.defaultOptions=An,c.Z.registerType(Cn,"CustomPrimitive");const bn=Cn;var wn=i(5108);class Pn extends u.Z{constructor(e,t){super(e,t),this.disposers.push((0,O.Z)(this,"enabled",this,"show")),(0,P.extendObservable)(this,{_texture:void 0,_groundPrimitive:void 0},{_texture:P.observable.ref,_groundPrimitive:P.observable.ref}),this.disposers.push((()=>{this._groundPrimitive&&(e.czm.scene.groundPrimitives.remove(this._groundPrimitive),this._groundPrimitive=void 0),this._texture&&(this._texture=this._texture&&this._texture.destroy())}));const i=()=>{if(!(this._texture&&this.canvasWidth===this._texture.width&&this.canvasHeight===this._texture.height)&&(this._texture=this._texture&&this._texture.destroy(),this.canvasWidth>0&&this.canvasHeight>0&&(this._texture=new Cesium.Texture({context:e.czm.scene.context,width:this.canvasWidth,height:this.canvasHeight,source:void 0,flipY:!0}))),!this._canvas){const e=document.createElement("canvas");this._canvas=e,this._ctx=e.getContext("2d")}this._canvas.width===this.canvasWidth&&this._canvas.height===this.canvasHeight||(this._canvas.width=this.canvasWidth,this._canvas.height=this.canvasHeight)};this._updateCanvas=i,i(),this.disposers.push((0,P.reaction)((()=>({canvasWidth:this.canvasWidth,canvasHeight:this.canvasHeight})),i));const r=()=>{this.autoRegisterEditing&&!this.creating&&this.registerEditing()};r(),this.disposers.push((0,P.reaction)((()=>this.autoRegisterEditing),r)),this._scratchColor=new Cesium.Color;const n=()=>{this._groundPrimitive&&(e.czm.scene.groundPrimitives.remove(this._groundPrimitive),this._groundPrimitive=void 0);const t=Cesium.ClassificationType.BOTH,i=rr(this,this.position,this.width,this.height,this.origin[0],this.origin[1],this.rotation,undefined,undefined,t);i.appearance.material._uniforms.image_0=()=>this._texture||e.czm.scene.context.defaultTexture,["red","green","blue","alpha"].forEach(((e,t)=>this._scratchColor[e]=this.color[t])),i.appearance.material.uniforms.color=this._scratchColor,this._groundPrimitive=e.czm.scene.groundPrimitives.add(i)};n(),this.disposers.push((0,P.reaction)((()=>({position:[...this.position],origin:[...this.origin],rotation:this.rotation,width:this.width,height:this.height,color:[...this.color]})),n));const o=()=>{this._groundPrimitive&&(this._groundPrimitive.show=this.show)};o(),this.disposers.push((0,P.reaction)((()=>({show:this.show,_groundPrimitive:this._groundPrimitive})),o)),this._videoElement=void 0,this._videoAnimation=void 0,this.disposers.push((()=>{this._videoElement=this._videoElement&&mi(this._videoElement),this._videoAnimation&&(cancelAnimationFrame(this._videoAnimation),this._videoAnimation=void 0)})),this._settingVideoElement=void 0,this.disposers.push((()=>{this._settingVideoElement&&(this._settingVideoElement.unsubscribe(),this._settingVideoElement=void 0)}));const s=()=>{if(this._imageSubscription&&(this._imageSubscription.unsubscribe(),this._imageSubscription=void 0),this._videoAnimation&&(cancelAnimationFrame(this._videoAnimation),this._videoAnimation=void 0),this._videoElement=this._videoElement&&mi(this._videoElement),this._settingVideoElement&&(this._settingVideoElement.unsubscribe(),this._settingVideoElement=void 0),"string"==typeof this.imageUrl)if(this.imageUrl.endsWith(".jpg")||this.imageUrl.endsWith(".png")||this.imageUrl.startsWith("data:image")){const e=new rxjs.Observable((e=>{Cesium.Resource.createIfNeeded(this.imageUrl).fetchImage().then((function(t){e.next(t)}))}));this._imageSubscription=e.subscribe((e=>{this.canvasWidth=e.naturalWidth,this.canvasHeight=e.naturalHeight,this.drawCanvas((t=>{t.clearRect(0,0,e.naturalWidth,e.naturalHeight),t.drawImage(e,0,0)}))}))}else[".ogg",".webm",".mp4",".m3u8",".flv"].some((e=>this.imageUrl.endsWith(e)))?this._settingVideoElement=rxjs.from(di(this.imageUrl)).subscribe((e=>{if(this._videoElement=e,this._videoElement){const t=()=>{this._videoAnimation=requestAnimationFrame(t),e.videoWidth>0&&e.videoHeight>0&&4===e.readyState&&(this.canvasWidth===e.videoWidth&&this.canvasHeight===e.videoHeight||(this.canvasWidth=e.videoWidth,this.canvasHeight=e.videoHeight),this._updateCanvas(),this._texture&&this._texture.copyFrom(e))};this._videoAnimation=requestAnimationFrame(t)}})):(this.canvasWidth=1,this.canvasHeight=1,this.drawCanvas((e=>{e.clearRect(0,0,1,1),e.fillStyle="white",e.fillRect(0,0,1,1)})),this._videoElement=void 0)};s(),this.disposers.push((0,P.reaction)((()=>this.imageUrl),s))}drawCanvas(e){this.canvasWidth>0&&this.canvasHeight>0?(this._updateCanvas(),e(this._ctx,this._canvas),this._texture.copyFrom(this._canvas)):wn.warn("canvas尺寸未设置，无法绘制！")}get texture(){return this._texture}set texture(e){this._texture=e}flyTo(){const e=Math.sqrt(this.width*this.width+this.height*this.height);this._earth.camera.flyTo(this.position,3*e)}registerEditing(){this.disposers.push((0,ae.Ak)(this._earth,this,{})),this.disposers.push((0,ae.zC)(this._earth,this,{positionPickingProperty:"creating"}))}}Pn.gvolSchema={title:"CustomGroundRectangle Property",type:"object",properties:{position:{type:"array",items:{type:"number"},minItems:3,maxItems:3,default:[0,0,0],description:"位置（经度, 纬度, 高度）"},origin:{type:"array",items:{type:"number"},minItems:2,maxItems:2,default:[.5,.5],description:"原点在纹理上的位置，旋转的中心点"},rotation:{type:"number",title:"偏航角",default:0,description:"偏航角"},width:{type:"number",title:"宽度，单位米",default:1e3,description:"宽度，单位米"},height:{type:"number",title:"高度，单位米",default:1e3,description:"高度，单位米"},canvasWidth:{type:"number",title:"画布宽度，单位像素",default:512,description:"画布宽度，单位像素"},canvasHeight:{type:"number",title:"画布高度，单位像素",default:512,description:"画布高度，单位像素"},show:{type:"boolean",title:"是否在三维窗口中显示",default:!0,description:"是否在三维窗口中显示"},color:{type:"array",items:{type:"number"},minItems:4,maxItems:4,default:[1,1,1,1],description:"颜色叠加"},imageUrl:{type:"string",title:"纹理对应的图像url",default:0,description:"纹理对应的图像url"},autoRegisterEditing:{type:"boolean",title:"是否自动注册编辑功能",default:!1,description:"是否自动注册编辑功能"}}};Pn.gvolClassification=[{name:{chinese:"通用",english:"General"},properties:["position","origin","rotation","width","height","canvasWidth","canvasHeight","show","color","imageUrl","autoRegisterEditing"]}],Pn.defaultOptions={position:[0,0,0],origin:[.5,.5],rotation:0,width:1e3,height:1e3,canvasWidth:512,canvasHeight:512,show:!0,color:[1,1,1,1],imageUrl:"",autoRegisterEditing:!1},c.Z.registerType(Pn,"CustomGroundRectangle");const Sn=Pn;if(!Array.prototype.xe_max){const e=function(){return Math.max.apply(null,this)},t=function(){return Math.min.apply(null,this)},i=function(){var e,t;for(e=0,t=0;e<this.length;e++)t+=this[e];return t/this.length},r=function(e){return Array.apply(null,new Array(e)).map(Number.prototype.valueOf,this[0])},n=function(e,t){var i,r,n=!1;for(i=0,r=this.length-1;i<this.length;r=i++)this[i][1]>t!=this[r][1]>t&&e<(this[r][0]-this[i][0])*(t-this[i][1])/(this[r][1]-this[i][1])+this[i][0]&&(n=!n);return n};Object.defineProperties(Array.prototype,{xe_max:{enumerable:!1,get:()=>e},xe_min:{enumerable:!1,get:()=>t},xe_mean:{enumerable:!1,get:()=>i},xe_rep:{enumerable:!1,get:()=>r},xe_pip:{enumerable:!1,get:()=>n}})}var xn=function(){var e={},t=function(e,t){var i,r=[0].xe_rep(t*t);for(i=0;i<t;i++)r[i*t+i]=e;return r},i=function(e,t,i,r){var n,o,s=Array(i*r);for(n=0;n<i;n++)for(o=0;o<r;o++)s[n*r+o]=e[n*r+o]+t[n*r+o];return s},r=function(e,t,i,r,n){var o,s,a,l=Array(i*n);for(o=0;o<i;o++)for(s=0;s<n;s++)for(l[o*n+s]=0,a=0;a<r;a++)l[o*n+s]+=e[o*r+a]*t[a*n+s];return l},n=function(e,t){var i,r,n,o=Array(t);for(i=0;i<t;i++)o[i]=e[i*t+i];for(i=0;i<t;i++){for(r=0;r<i;r++)o[i]-=e[i*t+r]*e[i*t+r];if(o[i]<=0)return!1;for(o[i]=Math.sqrt(o[i]),r=i+1;r<t;r++){for(n=0;n<i;n++)e[r*t+i]-=e[r*t+n]*e[i*t+n];e[r*t+i]/=o[i]}}for(i=0;i<t;i++)e[i*t+i]=o[i];return!0},o=function(e,t){var i,r,n,o;for(i=0;i<t;i++)for(e[i*t+i]=1/e[i*t+i],r=i+1;r<t;r++){for(o=0,n=i;n<r;n++)o-=e[r*t+n]*e[n*t+i];e[r*t+i]=o/e[r*t+r]}for(i=0;i<t;i++)for(r=i+1;r<t;r++)e[i*t+r]=0;for(i=0;i<t;i++){for(e[i*t+i]*=e[i*t+i],n=i+1;n<t;n++)e[i*t+i]+=e[n*t+i]*e[n*t+i];for(r=i+1;r<t;r++)for(n=r;n<t;n++)e[i*t+r]+=e[n*t+i]*e[n*t+r]}for(i=0;i<t;i++)for(r=0;r<i;r++)e[i*t+r]=e[r*t+i]},s=function(e,t){var i,r,n,o,s,a,l,h,c,u,p,d=t,m=Array(t*t),f=Array(t),g=Array(t),A=Array(t);for(i=0;i<t;i++)for(o=0;o<t;o++)m[i*t+o]=i==o?1:0;for(o=0;o<t;o++)A[o]=0;for(i=0;i<t;i++){for(h=0,o=0;o<t;o++)if(1!=A[o])for(s=0;s<t;s++)0==A[s]&&Math.abs(e[o*t+s])>=h&&(h=Math.abs(e[o*t+s]),n=o,r=s);if(++A[r],n!=r){for(a=0;a<t;a++)p=e[n*t+a],e[n*t+a]=e[r*t+a],e[r*t+a]=p;for(a=0;a<d;a++)p=m[n*t+a],m[n*t+a]=m[r*t+a],m[r*t+a]=p}if(g[i]=n,f[i]=r,0==e[r*t+r])return!1;for(u=1/e[r*t+r],e[r*t+r]=1,a=0;a<t;a++)e[r*t+a]*=u;for(a=0;a<d;a++)m[r*t+a]*=u;for(l=0;l<t;l++)if(l!=r){for(c=e[l*t+r],e[l*t+r]=0,a=0;a<t;a++)e[l*t+a]-=e[r*t+a]*c;for(a=0;a<d;a++)m[l*t+a]-=m[r*t+a]*c}}for(a=t-1;a>=0;a--)if(g[a]!=f[a])for(s=0;s<t;s++)p=e[s*t+g[a]],e[s*t+g[a]]=e[s*t+f[a]],e[s*t+f[a]]=p;return!0},a=function(e,t,i,r,n){return t+(r-t)/i*(1-Math.exp(-1/n*Math.pow(e/i,2)))},l=function(e,t,i,r,n){return t+(r-t)/i*(1-Math.exp(-1/n*(e/i)))},h=function(e,t,i,r,n){return e>i?t+(r-t)/i:t+(r-t)/i*(e/i*1.5-.5*Math.pow(e/i,3))};return e.train=function(e,c,u,p,d,m){var f={t:e,x:c,y:u,nugget:0,range:0,sill:0,A:1/3,n:0};switch(p){case"gaussian":f.model=a;break;case"exponential":f.model=l;break;case"spherical":f.model=h}var g,A,y,v,C=e.length,_=Array((C*C-C)/2);for(g=0,y=0;g<C;g++)for(A=0;A<g;A++,y++)_[y]=Array(2),_[y][0]=Math.pow(Math.pow(c[g]-c[A],2)+Math.pow(u[g]-u[A],2),.5),_[y][1]=Math.abs(e[g]-e[A]);_.sort((function(e,t){return e[0]-t[0]})),f.range=_[(C*C-C)/2-1][0];var b=(C*C-C)/2>30?30:(C*C-C)/2,w=f.range/b,P=[0].xe_rep(b),S=[0].xe_rep(b);if(b<30)for(v=0;v<b;v++)P[v]=_[v][0],S[v]=_[v][1];else{for(g=0,A=0,y=0,v=0;g<b&&A<(C*C-C)/2;g++,y=0){for(;_[A][0]<=(g+1)*w&&(P[v]+=_[A][0],S[v]+=_[A][1],y++,!(++A>=(C*C-C)/2)););y>0&&(P[v]/=y,S[v]/=y,v++)}if(v<2)return f}C=v,f.range=P[C-1]-P[0];var x=[1].xe_rep(2*C),B=Array(C),M=f.A;for(g=0;g<C;g++){switch(p){case"gaussian":x[2*g+1]=1-Math.exp(-1/M*Math.pow(P[g]/f.range,2));break;case"exponential":x[2*g+1]=1-Math.exp(-1/M*P[g]/f.range);break;case"spherical":x[2*g+1]=P[g]/f.range*1.5-.5*Math.pow(P[g]/f.range,3)}B[g]=S[g]}var E=function(e,t,i){var r,n,o=Array(i*t);for(r=0;r<t;r++)for(n=0;n<i;n++)o[n*t+r]=e[r*i+n];return o}(x,C,2),T=r(E,x,2,C,2),O=(T=i(T,t(1/m,2),2,2)).slice(0);n(T,2)?o(T,2):(s(O,2),T=O);var L=r(r(T,E,2,2,C),B,2,C,1);f.nugget=L[0],f.sill=L[1]*f.range+f.nugget,f.n=c.length,C=c.length;var D=Array(C*C);for(g=0;g<C;g++){for(A=0;A<g;A++)D[g*C+A]=f.model(Math.pow(Math.pow(c[g]-c[A],2)+Math.pow(u[g]-u[A],2),.5),f.nugget,f.range,f.sill,f.A),D[A*C+g]=D[g*C+A];D[g*C+g]=f.model(0,f.nugget,f.range,f.sill,f.A)}var I=i(D,t(d,C),C,C),R=I.slice(0);n(I,C)?o(I,C):(s(R,C),I=R);D=I.slice(0);var H=r(I,e,C,C,1);return f.K=D,f.M=H,f},e.predict=function(e,t,i){var n,o=Array(i.n);for(n=0;n<i.n;n++)o[n]=i.model(Math.pow(Math.pow(e-i.x[n],2)+Math.pow(t-i.y[n],2),.5),i.nugget,i.range,i.sill,i.A);return r(o,i.M,1,i.n,1)[0]},e.variance=function(e,t,i){var n,o=Array(i.n);for(n=0;n<i.n;n++)o[n]=i.model(Math.pow(Math.pow(e-i.x[n],2)+Math.pow(t-i.y[n],2),.5),i.nugget,i.range,i.sill,i.A);return i.model(0,i.nugget,i.range,i.sill,i.A)+r(r(o,i.K,1,i.n,i.n),o,1,i.n,1)[0]},e.grid=function(t,i,r){var n,o,s,a=t.length;if(0!=a){var l,h,c=[t[0][0][0],t[0][0][0]],u=[t[0][0][1],t[0][0][1]];for(n=0;n<a;n++)for(o=0;o<t[n].length;o++)t[n][o][0]<c[0]&&(c[0]=t[n][o][0]),t[n][o][0]>c[1]&&(c[1]=t[n][o][0]),t[n][o][1]<u[0]&&(u[0]=t[n][o][1]),t[n][o][1]>u[1]&&(u[1]=t[n][o][1]);var p=Array(2),d=Array(2),m=Array(2),f=Array(2),g=Math.ceil((c[1]-c[0])/r),A=Math.ceil((u[1]-u[0])/r),y=Array(g+1);for(n=0;n<=g;n++)y[n]=Array(A+1);for(n=0;n<a;n++){for(m[0]=t[n][0][0],m[1]=m[0],f[0]=t[n][0][1],f[1]=f[0],o=1;o<t[n].length;o++)t[n][o][0]<m[0]&&(m[0]=t[n][o][0]),t[n][o][0]>m[1]&&(m[1]=t[n][o][0]),t[n][o][1]<f[0]&&(f[0]=t[n][o][1]),t[n][o][1]>f[1]&&(f[1]=t[n][o][1]);for(p[0]=Math.floor((m[0]-(m[0]-c[0])%r-c[0])/r),p[1]=Math.ceil((m[1]-(m[1]-c[1])%r-c[0])/r),d[0]=Math.floor((f[0]-(f[0]-u[0])%r-u[0])/r),d[1]=Math.ceil((f[1]-(f[1]-u[1])%r-u[0])/r),o=p[0];o<=p[1];o++)for(s=d[0];s<=d[1];s++)l=c[0]+o*r,h=u[0]+s*r,t[n].xe_pip(l,h)&&(y[o][s]=e.predict(l,h,i))}return y.xlim=c,y.ylim=u,y.zlim=[i.t.xe_min(),i.t.xe_max()],y.width=r,y}},e.contour=function(e,t,i){},e.plot=function(e,t,i,r,n){var o=e.getContext("2d");o.clearRect(0,0,e.width,e.height);var s,a,l,h,c,u=[i[1]-i[0],r[1]-r[0],t.zlim[1]-t.zlim[0]],p=t.length,d=t[0].length,m=Math.ceil(t.width*e.width/(i[1]-i[0])),f=Math.ceil(t.width*e.height/(r[1]-r[0]));for(s=0;s<p;s++)for(a=0;a<d;a++)null!=t[s][a]&&(l=e.width*(s*t.width+t.xlim[0]-i[0])/u[0],h=e.height*(1-(a*t.width+t.ylim[0]-r[0])/u[1]),(c=(t[s][a]-t.zlim[0])/u[2])<0&&(c=0),c>1&&(c=1),o.fillStyle=n[Math.floor((n.length-1)*c)],o.fillRect(Math.round(l-m/2),Math.round(h-f/2),m,f))},e}();const Bn=xn;var Mn=i(5108);let En,Tn;function On(e,t,i){const[r,n]=[0,1],o=255*(e=e<r?r:e>n?n:e)|0,s=t[4*o],a=t[4*o+1],l=t[4*o+2],h=t[4*o+3];return i||(i=[255,255,255,255]),i[0]=s,i[1]=a,i[2]=l,i[3]=h,i}class Ln extends u.Z{constructor(e,t){super(e,t),this.disposers.push((0,O.Z)(this,"enabled",this,"show")),h.Z.registerPosition(this),this.disposers.push((0,ae.Ak)(this._earth,this,{positionEditingProperty:"editing"})),this.disposers.push((0,ae.zC)(this._earth,this,{positionPickingProperty:"creating"})),this._customGroundRectangle=new GVOL.Obj.CustomGroundRectangle(e),this.disposers.push((0,Fi.Z)(this._customGroundRectangle,"show",this,"show")),this.disposers.push((()=>{this._customGroundRectangle=this._customGroundRectangle&&this._customGroundRectangle.destroy()}));const i=()=>{const e=this._customGroundRectangle;e.position=this.position,e.width=this.width,e.height=this.height,e.canvasWidth===this.dataWidth&&e.canvasHeight===this.dataHeight||(e.canvasWidth=this.dataWidth,e.canvasHeight=this.dataHeight,e.drawCanvas((e=>{e.fillStyle="white",e.fillRect(0,0,this.dataWidth,this.dataHeight)})))};i(),this.disposers.push((0,P.reaction)((()=>({position:[...this.position],width:this.width,height:this.height,dataWidth:this.dataWidth,dataHeight:this.dataHeight})),i)),this._imageData=void 0,this._colorPalette=new Uint8ClampedArray(1024),this._colorPalette.fill(255),this.disposers.push((()=>{this._imageData=void 0,this._colorPalette=void 0}));const r=()=>{!function(e,t){if(t){if(!t instanceof Uint8ClampedArray)throw new Error("result类型不对！");if(1024!==t.length)throw new Error("result的数组长度不对，必须为256！")}if(!En){var i=document.createElement("canvas"),r=i.getContext("2d");i.width=256,i.height=1,En=r}var n=En.createLinearGradient(0,0,256,1);e.forEach((e=>{n.addColorStop(e[0],e[1])})),En.clearRect(0,0,256,1),En.fillStyle=n,En.fillRect(0,0,256,1);const o=En.getImageData(0,0,256,1).data;t?o.forEach(((e,i)=>t[i]=e)):t=new Uint8ClampedArray(o)}(this.gradient,this._colorPalette)};r(),this.disposers.push((0,P.reaction)((()=>({gradient:[...this.gradient]})),r))}setGridData(e){const t=e;if(t&&t.length&&t.length===this.dataWidth*this.dataHeight){this._imageData&&this._imageData.width===this.dataWidth&&this._imageData.height===this.dataHeight||(this._imageData=new ImageData(this.dataWidth,this.dataHeight));const e=this.maxValue-this.minValue,i=[255,255,255,255],r=this.dataHeight,n=this.dataWidth,o=this._imageData.data,s=this.minValue,a=this._colorPalette;if(!Tn){Tn=Function(`\n                    "use strict";\n                    return (function(data, valueRange, color, dataHeight, dataWidth, imageData, minValue, colorPalette, getColorFromColorPalette){\n                        ${"\n                    for (let j=0; j<dataHeight; ++j) {\n                        for (let i=0; i<dataWidth; ++i) {\n                            const v = data[j*dataWidth+i];\n                            const ratio = (v - minValue) / valueRange;\n                            const c = getColorFromColorPalette(ratio, colorPalette, color);\n                            if (c) {\n                                const offset = (j*dataWidth+i) * 4;\n                                imageData[offset + 0] = c[0];\n                                imageData[offset + 1] = c[1];\n                                imageData[offset + 2] = c[2];\n                                imageData[offset + 3] = c[3];\n                            }\n                        }\n                    }\n                "}\n                    });\n                `)()}Tn(t,e,i,r,n,o,s,a,On);const l=this._customGroundRectangle;l.canvasWidth=this.dataWidth,l.canvasHeight=this.dataHeight,l.drawCanvas((e=>{e.putImageData(this._imageData,0,0)}))}else{const e=this._customGroundRectangle;e.canvasWidth=this.dataWidth,e.canvasHeight=this.dataHeight,e.drawCanvas((e=>{e.fillStyle="white",e.fillRect(0,0,this.dataWidth,this.dataHeight)}))}}copyfromOtherCanvas(e){e.width===this.dataWidth&&e.height===this.dataHeight?this._customGroundRectangle&&this._customGroundRectangle._texture&&this._customGroundRectangle._texture.copyFrom(e):Mn.warn("请确保canvas尺寸一致！")}flyTo(){this._earth.camera.flyTo(this.position,this.width,[0,-Math.PI/3,0])}}Ln.getGridDataFromKriging=function(e,t,i,r,{model:n="exponential",sigma2:o=0,alpha:s=100}={}){const a=r;try{const r=[],l=[],h=[];e.forEach((e=>{l.push(e[0]),h.push(e[1]),r.push(e[2])}));const c=Bn.train(r,l,h,n,o,s);for(let e=0;e<t;++e)for(let r=0;r<i;++r)if(a[r*t+e]=Bn.predict(e,r,c),!isFinite(a[r*t+e]))throw new Error("克里金插值计算出错！");return a}catch(e){return void Mn.warn("error: "+e)}},Ln.interpolateGridData=function(e,t,i,r,n){try{if(!n)return;for(let o=0;o<r;++o)n[o]=t[o]*(1-e)+i[o]*e;return n}catch(e){return}},Ln.defaultOptions={position:[0,0,0],width:100,height:100,origin:[.5,.5],rotation:0,show:!0,gradient:[[0,"green"],[.2,"blue"],[.6,"yellow"],[1,"red"]],minValue:0,maxValue:1,dataWidth:100,dataHeight:100},c.Z.registerType(Ln,"HeatMap");const Dn=Ln;function In(e,t,i){let r;"function"==typeof e.next?r=e:(e[Symbol.iterator],r=e[Symbol.iterator]());let n=i||r.next().value;for(let e of r)n=t(n,e);return n}function Rn(e){return In(e,((e,t)=>e>t?e:t),Number.NEGATIVE_INFINITY)}function Hn(e){return In(e,((e,t)=>e<t?e:t),Number.POSITIVE_INFINITY)}function*Fn(e,...t){const i=e.length;for(let r=0;r<i;++r){let i=e[r];t.forEach((e=>i=i[e])),yield i}}let Nn;const Qn=function(e,t){let i;Nn=Nn||new Cesium.Cartesian3;{const t=Fn,r=e,n=[Hn(t(r,"position","0")),Hn(t(r,"position","1")),Hn(t(r,"position","2"))],o=[Rn(t(r,"position","0")),Rn(t(r,"position","1")),Rn(t(r,"position","2"))],s=[.5*(n[0]+o[0]),.5*(n[1]+o[1]),n[2]],a=Cesium.Cartesian3.fromRadians(...s,void 0,new Cesium.Cartesian3),l=Cesium.Transforms.eastNorthUpToFixedFrame(a,void 0,new Cesium.Matrix4),h=Cesium.Matrix4.inverse(l,new Cesium.Matrix4);e.forEach((e=>{const t=e.position;let i=Cesium.Cartesian3.fromRadians(t[0],t[1],t[2],void 0,Nn);if(i=Cesium.Matrix4.multiplyByPoint(h,i,i),!i)throw new Error("localPosition 计算错误！");e.localPosition=[i.x,i.y,i.z]})),i=l}return i};!function(e=6,t=Math.PI/4,i=1080){Math.tan(.5*t)}();const kn=2*Math.PI*6378137,Un=.1*kn/256,jn=[...new Array(31).keys()].map((e=>Un/(1<<e))),Gn=[...new Array(31).keys()].map((e=>kn/(1<<e)));let zn,Yn,Zn,Wn,Xn;function Jn(e,t,i){zn=zn||new Cesium.Cartesian3,Yn=Yn||new Cesium.Cartesian3,Zn=Zn||new Cesium.Cartesian3,Wn=Wn||new Cesium.Quaternion,Xn=Xn||new Cesium.Matrix4;const r=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY],n=[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];return e.index.forEach((e=>{const o=t[e].localPosition,s=i[t[e].type||0],a=t[e].rotation,l=t[e].scale;let h,c;{const e=Cesium.Quaternion.fromHeadingPitchRoll(new Cesium.HeadingPitchRoll(a[0],a[1],a[2]),Wn),t=Cesium.Cartesian3.fromElements(l[0],l[1],l[2],Zn);h=Cesium.Matrix4.fromTranslationQuaternionRotationScale(Cesium.Cartesian3.ZERO,e,t,Xn)}{const e=s.center,t=s.size.map((e=>.5*e));c=[[e[0]-t[0],e[1]-t[1],e[2]-t[2]],[e[0]+t[0],e[1]-t[1],e[2]-t[2]],[e[0]+t[0],e[1]+t[1],e[2]-t[2]],[e[0]-t[0],e[1]+t[1],e[2]-t[2]],[e[0]-t[0],e[1]-t[1],e[2]+t[2]],[e[0]+t[0],e[1]-t[1],e[2]+t[2]],[e[0]+t[0],e[1]+t[1],e[2]+t[2]],[e[0]-t[0],e[1]+t[1],e[2]+t[2]]],c=c.map((e=>{const t=Cesium.Matrix4.multiplyByPoint(h,Cesium.Cartesian3.fromElements(e[0],e[1],e[2],zn),zn);return[t.x,t.y,t.z]}))}const u=Fn,p=[o[0]+Hn(u(c,"0")),o[1]+Hn(u(c,"1")),o[2]+Hn(u(c,"2"))],d=[o[0]+Rn(u(c,"0")),o[1]+Rn(u(c,"1")),o[2]+Rn(u(c,"2"))];for(let e=0;e<3;++e)r[e]=r[e]<p[e]?r[e]:p[e],n[e]=n[e]>d[e]?n[e]:d[e]})),[r,n]}const Kn=function(e,t){let i,r,n;{const t=Fn,o=e;r=[Hn(t(o,"localPosition","0")),Hn(t(o,"localPosition","1")),Hn(t(o,"localPosition","2"))],n=[Rn(t(o,"localPosition","0")),Rn(t(o,"localPosition","1")),Rn(t(o,"localPosition","2"))];for(let e=0;e<3;++e)r[e]-=.001,n[e]+=.001;const s=n[0]-r[0],a=n[1]-r[1];i=Rn([s,a])}let o=Gn.findIndex((e=>e<i))-1;o<0&&(o=23);const s=e.length;let a={index:[...new Array(s).keys()],level:o,min:r,max:n,children:[],name:"R"};const l=[a];for(;l.length>0;){const t=l.pop(),i=t.level+1;if(i>23)continue;const r=Gn[i];[[0,0],[0,1],[1,0],[1,1]].forEach((n=>{const o=[...t.min];o[0]+=r*n[0],o[1]+=r*n[1];const s=[...o];if(s[0]+=r,s[1]+=r,s[2]=t.max[2],o[0]<t.max[0]&&o[1]<t.max[1]){s[0]=s[0]>t.max[0]?t.max[0]:s[0],s[1]=s[1]>t.max[1]?t.max[1]:s[1];const r={index:[],level:i,min:o,max:s,children:[],name:`${t.name}${n[0]}${n[1]}`};t.index.forEach((t=>{const i=e[t].localPosition;i[0]>=o[0]&&i[0]<s[0]&&i[1]>=o[1]&&i[1]<s[1]&&r.index.push(t)})),r.index.length>0&&(t.children.push(r),l.push(r))}}))}{const i=[a];for(;i.length>0;){const r=i[i.length-1];if(r.children&&r.children.length>0)if(r.children[0].extendMin){const e=r.children,t=Fn;r.extendMin=[Hn(t(e,"extendMin","0")),Hn(t(e,"extendMin","1")),Hn(t(e,"extendMin","2"))],r.extendMax=[Rn(t(e,"extendMax","0")),Rn(t(e,"extendMax","1")),Rn(t(e,"extendMax","2"))],i.pop()}else r.children.forEach((e=>{i.push(e)}));else{const[n,o]=Jn(r,e,t);r.extendMin=n,r.extendMax=o,i.pop()}}}return a};const Vn=function(e,t,i,r){const n={cmptMaps:new Map,treeData:t,treeTypes:i,rootJSON:void 0,tilesetJSON:void 0};let o;{let t;{const i=e.extendMin,r=e.extendMax,n=[.5*(i[0]+r[0]),.5*(i[1]+r[1]),.5*(i[2]+r[2])],o=[.5*(r[0]-i[0]),.5*(r[1]-i[1]),.5*(r[2]-i[2])];t=[n[0],n[1],n[2],o[0],0,0,0,o[1],0,0,0,o[2]]}const i=Cesium.Matrix4.toArray(r),s=jn[e.level],a=`L${e.level}-${e.name}.cmpt`;o={refine:"REPLACE",boundingVolume:{box:t},transform:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],geometricError:16*s,content:{uri:a},extras:{gvolID:Cesium.createGuid(),parentXbsjID:null,level:e.level}};const l={asset:{generatetool:"cesiumlab2@www.cesiumlab.com",gltfUpAxis:"Z",version:"1.0"},root:{refine:"REPLACE",boundingVolume:{box:t},transform:i,geometricError:16*s,content:{uri:"./root.json"}}};n.tilesetJSON=l,n.cmptMaps.set(a,{block:e,geometricError:s})}const s=[{parentBlock:e,parentTile:o}];for(;s.length>0;){const{parentBlock:e,parentTile:i}=s.pop();e.children.forEach((e=>{let r,o;{function*h(i){const r=e.index.length;for(let n=0;n<r;++n){const r=e.index[n];yield t[r].localPosition[i]}}r=[Hn(h(0)),Hn(h(1)),Hn(h(2))],o=[Rn(h(0)),Rn(h(1)),Rn(h(2))]}const a=e.min,l=e.max;if(!(a[0]<=r[0]&&a[1]<=r[1]&&a[2]<=r[2]&&l[0]>o[0]&&l[1]>o[1]&&l[2]>o[2]))throw new Error("fillBlocks error");{let c;{const f=e.extendMin,g=e.extendMax,A=[.5*(f[0]+g[0]),.5*(f[1]+g[1]),.5*(f[2]+g[2])],y=[.5*(g[0]-f[0]),.5*(g[1]-f[1]),.5*(g[2]-f[2])];c=[A[0],A[1],A[2],y[0],0,0,0,y[1],0,0,0,y[2]]}const u=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],p=jn[e.level],d=`L${e.level}-${e.name}.cmpt`,m={refine:"REPLACE",boundingVolume:{box:c},transform:u,geometricError:16*p,extras:{gvolID:Cesium.createGuid(),parentXbsjID:i.gvolID,level:e.level},content:{uri:d}};i.children=i.children||[],i.children.push(m),n.cmptMaps.set(d,{block:e,geometricError:p}),e.children.length>0&&s.push({parentBlock:e,parentTile:m})}}))}const a={asset:{generatetool:"cesiumlab2@www.cesiumlab.com",gltfUpAxis:"Z",version:"1.0"},root:o};return n.rootJSON=a,n};const qn=function(e,t,i=0,r=0,n=t.byteLength){const o=new Uint8Array(t.buffer||t,r,n),s=new Uint8Array(e,i,n);for(let e=0;e<n;++e)s[e]=o[e]},$n=new TextEncoder;const eo=function(e){const t=16+e.reduce(((e,t)=>e+t.byteLength),0),i=e.length,r=$n.encode("cmpt"),n=new ArrayBuffer(t),o=new Uint32Array(n,0,4);o[0]=new DataView(r.buffer).getUint32(0,!0),o[1]=1,o[2]=t,o[3]=i;let s=16;return e.forEach((e=>{if(e.byteLength%8!=0)throw new Error("tileBuffer.byteLength % 8 !== 0");qn(n,e,s),s+=e.byteLength})),n};const to=function(e,t,i,r=0){const n=new Uint8Array(e,t,i);for(let e=0;e<i;++e)n[e]=r},io=new TextEncoder;let ro,no;const oo=function(e,t,i){const r={magic:"i3dm",version:1,byteLength:0,featureTableJSONByteLength:0,featureTableBinaryByteLength:0,batchTableJSONByteLength:0,batchTableBinaryByteLength:0,gltfFormat:0},n={featureTable:{JSON:void 0,JSONExtraByteLength:0,Binary:void 0,BinaryExtraByteLength:0},batchTable:{JSON:void 0,JSONExtraByteLength:0,Binary:void 0,BinaryExtraByteLength:0},urlOrBinaryGltf:void 0,urlOrBinaryGltfExtraByteLength:0};{const r=t.length,o=12*r,s=12*r*2,a=12*r*3;{const e={INSTANCES_LENGTH:r,POSITION:{byteOffset:0},NORMAL_UP:{byteOffset:o},NORMAL_RIGHT:{byteOffset:s},SCALE_NON_UNIFORM:{byteOffset:a},BATCH_ID:{byteOffset:12*r*4}},t=JSON.stringify(e);n.featureTable.JSON=io.encode(t);const i=n.featureTable.JSON.byteLength;n.featureTable.JSONExtraByteLength=(8-i%8)%8}{const i=new ArrayBuffer(50*r),l=new Float32Array(i,0,3*r*4),h=new Uint16Array(i,48*r,r);t.forEach(((t,i)=>{const r=e[t],n=r.localPosition;l[3*i+0]=n[0],l[3*i+1]=n[1],l[3*i+2]=n[2];{ro=ro||new Cesium.Matrix3,no=no||new Cesium.HeadingPitchRoll,no.heading=r.rotation[0],no.pitch=r.rotation[1],no.roll=r.rotation[2];const e=Cesium.Matrix3.fromHeadingPitchRoll(no,ro);l[o/4+3*i+0]=e[6],l[o/4+3*i+1]=e[7],l[o/4+3*i+2]=e[8],l[s/4+3*i+0]=e[0],l[s/4+3*i+1]=e[1],l[s/4+3*i+2]=e[2]}l[a/4+3*i+0]=r.scale[0],l[a/4+3*i+1]=r.scale[1],l[a/4+3*i+2]=r.scale[2],h[i]=i})),n.featureTable.Binary=i;const c=n.featureTable.Binary.byteLength;n.featureTable.BinaryExtraByteLength=(8-c%8)%8}{const e={id:t.map((e=>""+e))},i=JSON.stringify(e);n.batchTable.JSON=io.encode(i);const r=n.batchTable.JSON.byteLength;n.batchTable.JSONExtraByteLength=(8-r%8)%8}{n.urlOrBinaryGltf=io.encode(i);const e=n.urlOrBinaryGltf.byteLength;n.urlOrBinaryGltfExtraByteLength=(8-e%8)%8}}{r.featureTableJSONByteLength=n.featureTable.JSON.byteLength+n.featureTable.JSONExtraByteLength,r.featureTableBinaryByteLength=n.featureTable.Binary.byteLength+n.featureTable.BinaryExtraByteLength,r.batchTableJSONByteLength=(n.batchTable.JSON?n.batchTable.JSON.byteLength:0)+n.batchTable.JSONExtraByteLength,r.batchTableBinaryByteLength=(n.batchTable.Binary?n.batchTable.Binary.byteLength:0)+n.batchTable.BinaryExtraByteLength;const e=r.featureTableJSONByteLength+r.featureTableBinaryByteLength+r.batchTableJSONByteLength+r.batchTableBinaryByteLength+n.urlOrBinaryGltf.byteLength+n.urlOrBinaryGltfExtraByteLength;r.byteLength=32+e}const o=new ArrayBuffer(32);{const e=new Uint8Array(o,0,4);{const t=r.magic.length;for(let i=0;i<t;++i){const t=r.magic.codePointAt(i);if(t>255)throw new Error("codePoint > 255");e[i]=t}}const t=new Uint32Array(o,4,7);t[0]=r.version,t[1]=r.byteLength,t[2]=r.featureTableJSONByteLength,t[3]=r.featureTableBinaryByteLength,t[4]=r.batchTableJSONByteLength,t[5]=r.batchTableBinaryByteLength,t[6]=r.gltfFormat}const s=new ArrayBuffer(r.byteLength);{let e=0;qn(s,o,e),e+=o.byteLength,qn(s,n.featureTable.JSON,e),e+=n.featureTable.JSON.byteLength,to(s,e,n.featureTable.JSONExtraByteLength,32),e+=n.featureTable.JSONExtraByteLength,qn(s,n.featureTable.Binary,e),e+=n.featureTable.Binary.byteLength,to(s,e,n.featureTable.BinaryExtraByteLength,0),e+=n.featureTable.BinaryExtraByteLength,n.batchTable.JSON&&(qn(s,n.batchTable.JSON,e),e+=n.batchTable.JSON.byteLength,to(s,e,n.batchTable.JSONExtraByteLength,32),e+=n.batchTable.JSONExtraByteLength),n.batchTable.Binary&&(qn(s,n.batchTable.Binary,e),e+=n.batchTable.Binary.byteLength,to(s,e,n.batchTable.BinaryExtraByteLength,0),e+=n.batchTable.BinaryExtraByteLength),qn(s,n.urlOrBinaryGltf,e),e+=n.urlOrBinaryGltf.byteLength;const t=0===r.gltfFormat?32:0;if(to(s,e,n.urlOrBinaryGltfExtraByteLength,t),e+=n.urlOrBinaryGltfExtraByteLength,e!==r.byteLength)throw new Error("targetByteOffset !== header.byteLength")}return s};const so=function(e,t,i,r){const n={};e.index.forEach((e=>{const i=t[e].type||0;n[i]=n[i]||[],n[i].push(e)}));const o=Object.keys(n).map((e=>{const o=i[e],s=n[e];let a=o.lods.findIndex((e=>{const t=e[0];return Rn(o.size)<r*t}));a=a<0?o.lods.length-1:a;const l=o.lods[a][1];return oo(t,s,l)}));return eo(o)};var ao=i(5108);const lo=function(e,t){const i=Qn(e,t),r=Kn(e,t),n=Vn(r,e,t,i);return e=>function(e,t){const i=t.treeData,r=t.treeTypes;if(!e.endsWith(".cmpt"))return"tileset.json"===e?t.tilesetJSON:"root.json"===e?t.rootJSON:void 0;if(t.cmptMaps.has(e))try{const n=t.cmptMaps.get(e);return so(n.block,i,r,n.geometricError)}catch(e){return void ao.warn("createCmptFromBlock error!")}}(e,n)};const ho=class{constructor(){this._generators={}}createGenerator(e,t){const i=lo(e,t),r=Cesium.createGuid();return this._generators[r]=i,r}getGenerator(e){return this._generators[e]}destroyGenerator(e){delete this._generators[e]}destroy(){this._generators=void 0}};const co=function(){if(window.gvolTreeGeneratorManager)return;const e=new ho;window.gvolTreeGeneratorManager=e;const t=Cesium.Resource.prototype.fetchJson,i=Cesium.Resource.prototype.fetchArrayBuffer;Cesium.Resource.prototype.fetchJson=function(...i){if(!this.url.startsWith("https://gvoltree.cn/"))return t.call(this,...i);{const t=this.url.substring(20,56),i=this.url.substring(57),r=e.getGenerator(t);if(r){const e=r(i);return Cesium.when.resolve(e)}}},Cesium.Resource.prototype.fetchArrayBuffer=function(...t){if(!this.url.startsWith("https://gvoltree.cn/"))return i.call(this,...t);{const t=this.url.substring(20,56),i=this.url.substring(57),r=e.getGenerator(t);if(r){let e=r(i);if(!(e instanceof ArrayBuffer)){const t=JSON.stringify(e);e=(new TextEncoder).encode(t)}return Cesium.when.resolve(e)}}}};var uo=i(5108);class po extends u.Z{constructor(e,t){super(e,t),this._treeData=[],this._treeTypes=[],this.disposers.push((0,O.Z)(this,"enabled",this,"show")),co(),this._tileset=new w.Z(e),this.disposers.push((()=>{this._tileset=this._tileset&&this._tileset.destroy()})),this._tgid=void 0,this.disposers.push((()=>{window.gvolTreeGeneratorManager.destroyGenerator(this._tgid),this._tgid=void 0})),this._recreatingTreeTileset=void 0,this.disposers.push((()=>{this._recreatingTreeTileset&&this._recreatingTreeTileset.unsubscribe()})),this._loadingTreeMeta=void 0,this.disposers.push((()=>{this._loadingTreeMeta&&(this._loadingTreeMeta.unsubscribe(),this._loadingTreeMeta=void 0)})),this._loadTreeMeta(this.treeMetas),this.disposers.push((0,P.reaction)((()=>JSON.stringify(this.treeMetas)),(()=>{this._loadTreeMeta(this.treeMetas)}))),this._loadingTreeData=void 0,this.disposers.push((()=>{this._loadingTreeData&&(this._loadingTreeData.unsubscribe(),this._loadingTreeData=void 0)})),this._loadTreeData(this.treeDataUrl),this.disposers.push((0,P.reaction)((()=>this.treeDataUrl),(()=>{this._loadTreeData(this.treeDataUrl)})));this.disposers.push((0,P.reaction)((()=>this.show),(()=>{this._tileset.show=this.show})))}flyTo(){this._tileset.flyTo()}reload(){this._loadTreeData(this.treeDataUrl)}recreate(){this._recreateTreeTilesetDelay()}getTreeData(){return this._treeData}getTreeTypes(){return this._treeTypes}_recreateTreeTilesetDelay(){this._recreatingTreeTileset&&this._recreatingTreeTileset.unsubscribe(),this._recreatingTreeTileset=rxjs.timer(3e3).subscribe((()=>this._recreateTreeTileset()),void 0,this._recreatingTreeTileset=void 0)}_recreateTreeTileset(){this._treeTypes&&this._treeTypes.length>0&&this._treeData&&this._treeData.length>0&&(this._tgid=this._tgid&&window.gvolTreeGeneratorManager.destroyGenerator(this._tgid),this._tgid=window.gvolTreeGeneratorManager.createGenerator(this._treeData,this._treeTypes),this._tileset.url=`https://gvoltree.cn/${this._tgid}/tileset.json`)}_loadTreeMeta(e){if(this._loadingTreeMeta&&(this._loadingTreeMeta.unsubscribe(),this._loadingTreeMeta=void 0),!e||0===e.length)return;const t=e.map(((e,t)=>({metaUrl:e.url,index:t})));this._loadingTreeMeta=rxjs.from(t).pipe(rxjs.operators.mergeMap((e=>{const{metaUrl:t,index:i}=e;return function(e){var t=new rxjs.Observable((t=>{try{Cesium.Resource.fetchJson(e).then((e=>{t.next(e),t.complete()})).otherwise((e=>{t.next(void 0),t.complete()}))}catch(e){uo.warn(`catch 获取数据出错: fetchJson(metaUrl) ${e}`),t.next(void 0),t.complete()}}));return t}(t).pipe(rxjs.operators.map((e=>({metaData:e,metaUrl:t,index:i}))))}),void 0,6),rxjs.operators.toArray(),rxjs.operators.map((e=>{if(e.some((e=>void 0!==e.metaData))){const t=new Array(e.length);e.forEach((e=>{const{metaUrl:i,metaData:r,index:n}=e;let o=i.lastIndexOf("?");o=-1===o?void 0:o;const s=i.substring(0,o);if(s.endsWith("meta.json")){const e=function(e,t,i){const{center:r,size:n,lod0Pixel:o}=i;let s=o;return{name:e,center:r,size:n,lods:i.lod.map((e=>{const i=[s,t+e.url];return s*=2,i}))}}("anonymous",s.substring(0,s.lastIndexOf("meta.json")),r);t[n]=e}})),this._treeTypes=t,this._recreateTreeTilesetDelay()}}))).subscribe(void 0,(e=>{uo.error("treeMeta error! "+e),this._loadingTreeMeta=void 0}),(()=>{this._loadingTreeMeta=void 0}))}_loadTreeData(e){if(this._loadingTreeData&&(this._loadingTreeData.unsubscribe(),this._loadingTreeData=void 0),!e)return;const t=(-1===e.lastIndexOf("?")?"?":"&")+"xxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}));var i=new rxjs.Observable((i=>{Cesium.Resource.fetchJson(e+t).then((e=>{i.next(e),i.complete()})).otherwise((e=>{i.error(e)}))}));this._loadingTreeData=i.subscribe((e=>{this._treeData=e,this._recreateTreeTilesetDelay()}),(e=>{uo.error("treeData error! "+e),this._loadingTreeData=void 0}),(()=>{this._loadingTreeData=void 0}))}}po.testRandomTreeData=function(e=500,t,i,r){const n=Math.PI/180;t=t||[116.39*n,39.9*n,0],i=i||3*(0|Math.sqrt(e)),r=r||3*(0|Math.sqrt(e));const o=i/(6378137*Math.cos(t[1])),s=r/6378137,a=[];for(let i=0;i<e;++i){const e=.3*Math.random()+.7,r={position:[t[0]+o*Math.random(),t[1]+s*Math.random(),1*Math.random()],rotation:[Math.random()*Math.PI,0,0],scale:[e,e,e],id:`id${i}`,type:0};a.push(r)}return a},po.defaultOptions={treeDataUrl:"",treeMetas:[],show:!0};po.gvolSchema={title:"Forest Property",type:"object",properties:{show:{type:"boolean",title:"显示",default:!0,description:"显示"},treeDataUrl:{type:"string",title:"点位信息url",default:"",description:"点位信息url"},treeMetas:{type:"array",items:{type:"Obj.Forest.TreeMeta"},minItems:0,title:"实例类型url集合",default:[],description:"实例类型url集合"}}};po.gvolClassification=[{name:{chinese:"通用",english:"General"},properties:["show","treeDataUrl","treeMetas"]}],c.Z.registerType(po,"Forest");const mo=po;const fo=function(e,t){var i;return t=t||{},e>=0?(i=65536*Math.floor(e/65536),t.high=i,t.low=e-i):(i=65536*Math.floor(-e/65536),t.high=-i,t.low=e+i),t};var go=i(5108);const Ao={high:void 0,low:void 0},yo=["size","origin","subImageYOffset","subImageWidth","subImageHeight","animateImageNum","startTime","duration","rotationSpeed","scale","pixelOffset","color","show"],vo={size:void 0,origin:void 0,subImageYOffset:0,subImageWidth:void 0,subImageHeight:void 0,animateImageNum:void 0,startTime:void 0,duration:void 0,rotationSpeed:0,scale:1,pixelOffset:[0,0],color:[255,255,255,255],show:!0},Co=[0,0,0,0];class _o{constructor(e,t){this._disposers=[],this._color=void 0,this._show=void 0,this._dynamicPoisPrimitive=e,yo.forEach((e=>{this[e]=t[e]||vo[e],void 0===this[e]&&go.warn("有属性值未undefined")})),this._instancePositionHigh=[0,0,0],this._instancePositionLow=[0,0,0],this.instancePosition=t.instancePosition}get instancePosition(){return this._instancePosition}get instancePositionHigh(){return this._instancePositionHigh}get instancePositionLow(){return this._instancePositionLow}set instancePosition(e){if(this._instancePosition!==e){this._instancePosition=e;for(let e=0;e<3;++e){const t=fo(this._instancePosition[e],Ao);this._instancePositionHigh[e]=t.high,this._instancePositionLow[e]=t.low}this._dynamicPoisPrimitive._instancePropertyDirty=!0}}get blendColor(){return this._show?this._color:Co}get allowPicking(){return!0}onclick(){this.scale=1.5}onclickout(){this.scale=1}onmouseover(){this.scale=1.2}onmouseout(){this.scale=1}isDestroyed(){return!1}_destroy(){return this._disposers.reverse(),this._disposers.forEach((e=>e())),this._disposers.length=0,Cesium.destroyObject(this)}destroy(){this._dynamicPoisPrimitive.remove(this)}}yo.forEach((function(e){Object.defineProperty(_o.prototype,e,{get(){return this["_"+e]},set(t){this["_"+e]!==t&&(this["_"+e]=t,this._dynamicPoisPrimitive._instancePropertyDirty=!0)}})}));const bo=_o,wo=(e,t)=>`\n        precision highp float;\n\n        attribute vec2 positionOrTexCoord;\n\n        ${e}\n\n        // uniform vec4 czm_viewport;\n        uniform float u_engineTime;\n        uniform vec4 u_animateTextureSize; // u_animateTextureSize => imageWidth, imageHeight, 1.0/imageWidth, 1.0/imageHeight\n\n        varying vec2 v_texCoord;\n        varying vec4 v_color;\n        varying vec4 v_pickColor;\n        void main() {\n            ${t}\n\n            vec4 p = czm_translateRelativeToEye(instancePositionHigh, instancePositionLow);\n            vec4 instancePosition = czm_modelViewProjectionRelativeToEye * p;\n            instancePosition /= instancePosition.w;\n\n            float rotationRatio = 0.0;\n            if (rotationSpeed != 0.0) {\n                float rotationDuration = 2.0 * 3.14159265 / rotationSpeed;\n                rotationRatio = mod(u_engineTime + startTime, rotationDuration) / rotationDuration;\n            }\n            vec2 localPos = (positionOrTexCoord - origin) * size * 2.0;\n            mat2 scaleM = mat2(scale, 0.0, 0.0, scale);\n            vec2 csr = vec2(cos(rotationRatio * 3.14159265 * 2.0), sin(rotationRatio * 3.14159265 * 2.0));\n            mat2 rotateM = mat2(csr, -csr.y, csr.x);\n            localPos = rotateM * scaleM * localPos;\n            localPos /= czm_viewport.zw;\n            vec2 offsetW = pixelOffset * 2.0 / czm_viewport.zw;\n            gl_Position = vec4(localPos + instancePosition.xy + offsetW, instancePosition.z, 1.0);\n\n            vec2 subImageSize = vec2(subImageWidth, subImageHeight);\n\n            float timeRatio = 0.0;\n            if (duration != 0.0) {\n                timeRatio = mod(u_engineTime + startTime, duration) / duration;\n            }\n            float diffX = floor(timeRatio * animateImageNum) * (subImageSize.x * u_animateTextureSize.z);\n            float diffY = subImageYOffset * u_animateTextureSize.w;\n\n            v_texCoord = positionOrTexCoord * subImageSize * u_animateTextureSize.zw + vec2(diffX, diffY);\n            v_color = blendColor;\n            v_pickColor = _pickColor;\n        }\n    `;const Po=function(e,t,i){const r=new Cesium.ShaderSource({sources:[wo(t,i)]}),n=new Cesium.ShaderSource({sources:["\n    precision highp float;\n    varying vec2 v_texCoord;\n    varying vec4 v_color;\n    varying vec4 v_pickColor;\n\n    uniform sampler2D u_animateTexture;\n    void main() {\n        gl_FragColor = texture2D(u_animateTexture, v_texCoord) * v_color;\n    }\n"]});return Cesium.ShaderProgram.fromCache({context:e,vertexShaderSource:r,fragmentShaderSource:n})};const So=function(e,t){var i={depthTest:{enabled:!0}};return e&&(i.depthMask=!1,i.blending=Cesium.BlendingState.ALPHA_BLEND),t&&(i.cull={enabled:!0,face:Cesium.CullFace.BACK}),i};const xo=function(e,t,i,r){const n=Po(e,i,r),o=new Cesium.Cartesian4(1,1,1,1),s={u_animateTexture:function(){return t._texture||e.defaultTexture},u_engineTime:function(){return Date.now()%108e5/1e3},u_animateTextureSize:function(){return t._textureSize?t._textureSize:o}},a=Cesium.RenderState.fromCache(So(!0,!0)),l=Cesium.PrimitiveType.TRIANGLES,h=Cesium.Pass.TRANSLUCENT,c=Cesium.Matrix4.IDENTITY;return new Cesium.DrawCommand({primitiveType:l,renderState:a,shaderProgram:n,uniformMap:s,owner:this,pass:h,modelMatrix:c,cull:!1,instanceCount:t._instanceData.length})};var Bo=i(9351),Mo=i(5108);const Eo=Bo.Z;function To(e){let t=0,i={},r=0;return e.accessors.forEach((e=>{let n;switch(e.type){case WebGL2RenderingContext.BYTE:n=1;break;case WebGL2RenderingContext.SHORT:n=2;break;case WebGL2RenderingContext.UNSIGNED_BYTE:n=1;break;case WebGL2RenderingContext.UNSIGNED_SHORT:n=2;break;case WebGL2RenderingContext.FLOAT:n=4;break;case WebGL2RenderingContext.HALF_FLOAT:default:throw new Error("attributeType类型有误！")}if(n*=e.size,t+=n,e.propName&&!e.composite)i[e.propName]={offset:r,size:e.size,type:e.type,byteLength:n},r+=n;else if(e.type===WebGLRenderingContext.FLOAT&&e.composite)e.composite.forEach(((t,n)=>{if("string"==typeof t[1])i[t[1]]={offset:r,size:t[0],type:e.type,byteLength:4*t[0]};else if(Array.isArray(t[1])){const n=[...t[1]];t[1].forEach(((o,s)=>{i[o[1]]={offset:r,size:t[0],type:e.type,composite:n,byteLength:4*t[0]}}))}r+=4*t[0]}));else{if(e.propName||e.composite)throw new Error("Spec不合法，不能处理！");r+=n,Mo.log("有属性被忽略！")}})),{props:i,vertexByteLength:t}}function Oo(e,{userObjectIteratorOrIterable:t,userObjectLength:i=0,propsSpec:r,arrayBufferResult:n,arrayBufferResultOffset:o=0}={}){if(r=r||To(e),n){if(n.byteLength-o<r.vertexByteLength*i)throw new Error("空间不足！")}else n=new ArrayBuffer(r.vertexByteLength*i),o=0;let s,a=0;if(t){let l=0,h=0;for(let c of t){const t=c.index||h;h++,void 0===s&&(s=t*r.vertexByteLength),a=(t+1)*r.vertexByteLength-s;const u=(e,i,s)=>{const a=r.props[e].offset+r.vertexByteLength*t,l=s;let h;switch(i){case WebGL2RenderingContext.BYTE:h=Int8Array;break;case WebGL2RenderingContext.SHORT:h=Int16Array;break;case WebGL2RenderingContext.UNSIGNED_BYTE:h=Uint8Array;break;case WebGL2RenderingContext.UNSIGNED_SHORT:h=Uint16Array;break;case WebGL2RenderingContext.FLOAT:h=Float32Array;break;case WebGL2RenderingContext.HALF_FLOAT:default:throw new Error("attributeType类型有误！")}var u=new h(n,a+o,l);if(1===l)u[0]=c[e];else for(let t=0;t<l;++t)u[t]=c[e][t]},p=e=>{const i=e[0][1],s=r.props[i].offset+r.vertexByteLength*t;let a=0,l=0;e.forEach((e=>{const t=e[1];l+=c[t]<<a,a+=e[0]})),new DataView(n,s+o,4).setFloat32(0,l,!0)};if(e.accessors.forEach((e=>{e.propName?u(e.propName,e.type,e.size):e.composite&&e.composite.forEach((t=>{"string"==typeof t[1]?u(t[1],e.type,t[0]):Array.isArray(t[1])&&p(t[1])}))})),l++,l>=i)break}}return s+=o,{bufferChangedOffset:s,bufferChangedLength:a,arrayBufferResult:n}}const Lo={accessors:[{type:Eo.FLOAT,size:4,composite:[[2,"size"],[2,"origin"]]},{type:Eo.FLOAT,size:4,composite:[[1,"subImageYOffset"],[1,"subImageWidth"],[1,"subImageHeight"],[1,"animateImageNum"]]},{type:Eo.FLOAT,size:4,composite:[[3,"instancePositionHigh"],[1,"startTime"]]},{type:Eo.FLOAT,size:4,composite:[[3,"instancePositionLow"],[1,"duration"]]},{type:Eo.UNSIGNED_BYTE,size:4,propName:"_pickColor"},{type:Eo.UNSIGNED_BYTE,size:4,propName:"blendColor"},{type:Eo.FLOAT,size:4,composite:[[1,"rotationSpeed"],[1,"scale"],[2,"pixelOffset"]]}]};var Do=i(5108);const Io=function(e,t,i,r){const n=Object.entries(i).map((([e,i])=>{if(!r[e])return void Do.warn(`属性${e}没有使用！`);const n=r[e].index,{size:o,offset:s,type:a,stride:l}=i;return{index:n,vertexBuffer:t,componentsPerAttribute:o,componentDatatype:a,offsetInBytes:s,strideInBytes:l,normalize:a!==Bo.Z.FLOAT,instanceDivisor:1}})).filter((e=>!!e));{const t=Cesium.Buffer.createVertexBuffer({context:e,typedArray:new Float32Array([0,0,1,0,1,1,0,1]),usage:Cesium.BufferUsage.STATIC_DRAW}),i=r.positionOrTexCoord.index;n.push({index:i,vertexBuffer:t,componentsPerAttribute:2,componentDatatype:Bo.Z.FLOAT,offsetInBytes:0,strideInBytes:0,normalize:!1,instanceDivisor:0})}const o=Cesium.Buffer.createIndexBuffer({context:e,typedArray:new Uint16Array([0,1,2,0,2,3]),usage:Cesium.BufferUsage.STATIC_DRAW,indexDatatype:Cesium.IndexDatatype.UNSIGNED_SHORT});return new Cesium.VertexArray({context:e,attributes:n,indexBuffer:o})};const Ro=class{constructor(){this._disposers=[],this._dynamicPois=[],this.show=!0,this._bs=void 0,this._texture=void 0,this._textureSize=new Cesium.Cartesian4(1,1,1,1),this._disposers.push((()=>{this._texture=this._texture&&this._texture.destroy(),this._textureSize=void 0})),this._command=void 0,this._disposers.push((()=>{Cesium.defined(this._command)&&(this._command.shaderProgram=this._command.shaderProgram&&this._command.shaderProgram.destroy(),this._command.vertexArray=this._command.vertexArray&&this._command.vertexArray.destroy(),this._command=void 0)})),this._instancePropertyDirty=!0,this._instanceLengthDirty=!0,this._instanceBuffer=void 0,this._disposers.push((()=>{this._instanceBuffer=this._instanceBuffer&&this._instanceBuffer.destroy()})),this._propLayoutSpec=Lo,this._propsSpec=To(this._propLayoutSpec),this._instanceData=[],this._imageUrl="",this._imageUrlDirty=!1,this._imageSubscription=void 0,this._disposers.push((()=>{this._imageSubscription&&(this._imageSubscription.unsubscribe(),this._imageSubscription=void 0)}))}_updateImage(e){if(this._imageUrlDirty&&(this._imageUrlDirty=!1,this._imageSubscription&&(this._imageSubscription.unsubscribe(),this._imageSubscription=void 0),this._imageUrl)){const t=new rxjs.Observable((e=>{Cesium.Resource.createIfNeeded(this._imageUrl).fetchImage().then((function(t){e.next(t)}))}));this._imageSubscription=t.subscribe((t=>{this._texture=this._texture&&this._texture.destroy(),this._texture=new Cesium.Texture({context:e,source:t});const i=t.naturalWidth,r=t.naturalHeight;this._textureSize.x=i,this._textureSize.y=r,this._textureSize.z=1/i,this._textureSize.w=1/r}))}}set imageUrl(e){this._imageUrl!==e&&(this._imageUrl=e,this._imageUrlDirty=!0)}get imageUrl(){return this._imageUrl}add(e){const t=new bo(this,e);return this._instanceData.push(t),this._instanceLengthDirty=!0,t}remove(e){const t=this._instanceData.indexOf(e);if(-1!==t){const e=this._instanceData[t];e._pickId=e._pickId&&e._pickId.destroy(),e._pickColor=void 0,e._destroy(),this._instanceData.splice(t,1),this._instanceLengthDirty=!0}}get(e){return this._instanceData[e]}getLength(){return this._instanceData.length}removeAll(){const e=this._instanceData.length;for(let t=0;t<e;++t){const e=this._instanceData[t];e._pickId=e._pickId&&e._pickId.destroy(),e._pickColor=void 0,e._destroy()}this._instanceData.length=0,this._instanceLengthDirty=!0}update(e){if(!this.show)return;const t=e.context;if(this._updateImage(t),!Cesium.defined(this._command)){const{attributeLayoutSpec:e,vsDecl:i,vsMainStart:r}=function(e){let t="",i="",r={},n=0,o=0;return e.accessors.forEach((e=>{if(e.propName){const i=1===e.size?"float":`vec${e.size}`;t+=`attribute ${i} ${e.propName}; \n`,r[e.propName]={size:e.size,offset:n,type:e.type}}else if(Array.isArray(e.composite)){let o="cmpt",s=0;e.composite.forEach((e=>{s+=e[0],"string"==typeof e[1]?o+="_"+e[1]:Array.isArray(e[1])&&e[1].forEach((e=>{o+="_"+e[1]}))})),t+=`attribute ${1===s?"float":`vec${s}`} ${o}; \n`,r[o]={size:e.size,offset:n,type:e.type};let a=0;e.composite.forEach((e=>{const t=e[0];if("string"==typeof e[1]){const r="xyzw".substring(a,a+t);i+=`${1===t?"float":`vec${t}`} ${e[1]} = ${o}.${r}; \n`}else if(Array.isArray(e[1])&&1===e[0]){const t="xyzw"[a],r="cmptf_"+e[1].map((e=>e[1])).join("_");i+=`float ${r} = ${o}.${t}; \n`;let n=0,s=e[1].map((e=>{const t=`float ${e[1]} = floor(${r} * ${(1/(1<<n)).toExponential()}); ${r} -= ${e[1]} * ${(1<<n).toExponential()}; \n`;return n+=e[0],t}));s=s.reverse(),i+=s.join("")}a+=t}))}let s;if(e.type===WebGLRenderingContext.FLOAT)s=4*e.size;else{if(e.type!==WebGLRenderingContext.UNSIGNED_BYTE)throw new Error("a.type is not float or unsigned byte.");s=1*e.size}o+=s,n+=s})),Object.values(r).forEach((e=>{e.stride=o})),{vsDecl:t,vsMainStart:i,attributeLayoutSpec:r}}(Lo);this._propLayoutSpec=Lo,this._attributeLayoutSpec=e,this._command=xo(t,this,i,r),this._command.boundingVolume=this._bs,this._command.pickId="v_pickColor"}if(this._instanceLengthDirty){this._instanceLengthDirty=!1,this._instancePropertyDirty=!1,this._instanceBuffer=this._instanceBuffer&&this._instanceBuffer.destroy(),this._instanceArrayBuffer=void 0,this._command.vertexArray&&(this._command.vertexArray.destroy(),this._command.vertexArray=void 0,this._command.instanceCount=0);const t=this._instanceData;if(t.length>0){const i=e.context;t.forEach((e=>{e._pickId||(e._pickId=i.createPickId({primitive:this,id:e}),e._pickColor=e._pickId.color.toBytes())}));const r=this._propLayoutSpec,n=this._propsSpec,[o,s]=function(e,t,i,r){const n=Oo(t,{userObjectIteratorOrIterable:r,userObjectLength:r.length,propsSpec:i}),o=Cesium.Buffer.createVertexBuffer({context:e,typedArray:new Float32Array(n.arrayBufferResult),usage:Cesium.BufferUsage.STATIC_DRAW});return o.vertexArrayDestroyable=!1,[o,n.arrayBufferResult]}(i,r,n,t);this._instanceBuffer=o,this._instanceArrayBuffer=s;const a=this._attributeLayoutSpec,l=this._command.shaderProgram.vertexAttributes,h=Io(i,this._instanceBuffer,a,l);this._command.vertexArray=h,this._command.instanceCount=this._instanceData.length}}else if(this._instancePropertyDirty){this._instancePropertyDirty=!1;!function(e,t,i,r,n){const o=Oo(e,{userObjectIteratorOrIterable:i,userObjectLength:i.length,propsSpec:t,arrayBufferResult:r});n.copyFromArrayView(new Float32Array(o.arrayBufferResult))}(this._propLayoutSpec,this._propsSpec,this._instanceData,this._instanceArrayBuffer,this._instanceBuffer)}Cesium.defined(this._command)&&this._command.vertexArray&&e.commandList.push(this._command)}isDestroyed(){return!1}destroy(){return this._disposers.reverse(),this._disposers.forEach((e=>e())),this._disposers.length=0,Cesium.destroyObject(this)}};class Ho extends u.Z{constructor(e,t){super(e,t),this.disposers.push((0,O.Z)(this,"enabled",this,"show")),this._primitive=void 0,this.disposers.push((()=>{this._primitive&&(e.czm.scene.primitives.remove(this._primitive),this._primitive=void 0)})),this._primitive=new Ro,e.czm.scene.primitives.add(this._primitive)}getPrimitive(){return this._primitive}flyTo(){}}Ho.gvolSchema={title:"DynamicPois Property",type:"object",properties:{show:{type:"boolean",title:"是否在三维窗口中显示",default:!0,description:"是否在三维窗口中显示"},imageUrl:{type:"string",title:"纹理对应的图像url",default:0,description:"纹理对应的图像url"}}};Ho.defaultOptions={show:!0,imageUrl:""},c.Z.registerType(Ho,"DynamicPois");const Fo=Ho;var No=i(5108);class Qo extends hr{constructor(e,t){super(e,t);const i=this._earth.czm.scene;this.disposers.push((0,O.Z)(this,"enabled",this,"show")),this._onlyMove=!1,this._fixedPositionsNum=void 0,this._road=void 0,this.disposers.push((()=>{this._road&&(i.groundPrimitives.remove(this._road),this._road=void 0)})),this._material=void 0,(0,P.extendObservable)(this,{_texture:void 0},{_texture:P.observable.ref}),this.disposers.push((()=>{this._material&&this._material.uniforms.image!==this._texture&&(this._texture.destroy(),this._texture=void 0),this._material&&(this._material.destroy(),this._material=void 0)}));const r=()=>{let e=R.Z.gvolEarthDir+"images/roadImages/4.jpg";""!==this.imageUrl&&(e=this.imageUrl),this._loadingImage=this._loadingImage&&this._loadingImage(),this._loadingImage=(()=>{let t=!0;return Cesium.Resource.fetchImage({url:e}).then((r=>{if(t){const t=r.naturalWidth,o=r.naturalHeight;if(this._texture=new Cesium.Texture({context:i.context,source:r,width:t,height:o}),Cesium.Math.isPowerOfTwo(t)&&Cesium.Math.isPowerOfTwo(o)){var n=new Cesium.Sampler({wrapS:Cesium.TextureWrap.CLAMP_TO_EDGE,wrapT:Cesium.TextureWrap.CLAMP_TO_EDGE,minificationFilter:Cesium.TextureMinificationFilter.LINEAR_MIPMAP_LINEAR,magnificationFilter:Cesium.TextureMagnificationFilter.LINEAR});this._texture.sampler=n,this._texture.generateMipmap(Cesium.MipmapHint.NICEST)}this._currentImageUrl=e}})).otherwise((e=>{No.error("图像加载错误！"),this._loadingImage=this._loadingImage&&this._loadingImage()})),()=>{t=!1}})()};r(),this.disposers.push(GVOL.MVVM.watch((()=>({imageUrl:this.imageUrl})),r)),this._totalDistance=100;const n=()=>{if(!this._material){const e=Cesium.Material.fromType(Cesium.Material.ImageType);e.uniforms.repeat=new Cesium.Cartesian2(100,1),this._material=e}const e=this._material;e.uniforms.image=this._texture,this._texture&&(e.uniforms.repeat.x=this._totalDistance/this.width*(this._texture.height/this._texture.width)/this.scale)};n(),this.disposers.push(GVOL.MVVM.watch((()=>({scale:this.scale,_texture:this._texture})),n)),this._boundingSphere=new Cesium.BoundingSphere(Cesium.Cartesian3.fromDegrees(0,0,0),10);const o=()=>{this._road&&(i.groundPrimitives.remove(this._road),this._road=void 0);const e=this.positions;if(e.length>=2){const t=e.reduce(((e,t)=>(e.push(...t),e)),[]),[r]=e.reduce(((e,t)=>e[1]?(e[0]+=Ce(e[1],t),[e[0],t]):[0,t]),[0,void 0]);this._totalDistance=r,n();const o=Cesium.Cartesian3.fromRadiansArrayHeights(t);this._boundingSphere=Cesium.BoundingSphere.fromPoints(o,this._boundingSphere),this._road=i.groundPrimitives.add(new Cesium.XbsjRoad({geometryInstances:new Cesium.GeometryInstance({geometry:new Cesium.GroundPolylineGeometry({positions:o,width:this.width})}),appearance:new Cesium.PolylineMaterialAppearance({material:this._material}),asynchronous:!1})),this._road.show=this.show}};o(),this.disposers.push(GVOL.MVVM.watch((()=>({positions:[...this.positions.map((e=>[...e]))],width:this.width})),o));const s=()=>{this._road&&(this._road.show=this.show)};s(),this.disposers.push(GVOL.MVVM.watch((()=>({show:this.show})),s))}get onlyMove(){return this._onlyMove}get fixedPositionsNum(){return this._fixedPositionsNum}getTotalDistance(){return this._totalDistance}getTotalArea(){return this._totalDistance*this.width}flyTo(){this._earth.czm.scene.camera.flyToBoundingSphere(this._boundingSphere)}}Qo.defaultOptions={positions:[],show:!0,width:15,scale:1,imageUrl:""},c.Z.registerType(Qo,"Road");const ko=Qo;let Uo;const jo=function(){if(Uo)return Uo;const e=Cesium.Cartesian2,t=Cesium.Cartesian3,i=Cesium.Cartesian4,r=Cesium.Cartographic,n=Cesium.CornerType,o=Cesium.EllipsoidTangentPlane,s=Cesium.Math,a=Cesium.Matrix3,l=Cesium.Matrix4,h=Cesium.PolylinePipeline,c=Cesium.Quaternion,u=Cesium.Transforms;var p=[new t,new t],d=new t,m=new t,f=new t,g=new t,A=new t,y=new t,v=new t,C=new t,_=new t,b=new t,w=new t,P={},S=new r;function x(e,i,r,n){var o,s=e[0],a=e[1],l=t.angleBetween(s,a),h=Math.ceil(l/n),c=new Array(h);if(i===r){for(o=0;o<h;o++)c[o]=i;return c.push(r),c}var u=(r-i)/h;for(o=1;o<h;o++){var p=i+o*u;c[o]=p}return c[0]=i,c.push(r),c}var B=new t,M=new t,E=new t(-1,0,0),T=new l,O=new l,L=new a,D=a.IDENTITY.clone(),I=new t,R=new i,H=new t;function F(i,r,n,s,h,c,p,d){var m=I,f=R;T=u.eastNorthUpToFixedFrame(i,h,T),m=l.multiplyByPointAsVector(T,E,m);var g=function(i,r,n,s){var a=new o(n,s),l=a.projectPointOntoPlane(t.add(n,i,B),B),h=a.projectPointOntoPlane(t.add(n,r,M),M),c=e.angleBetween(l,h);return h.x*l.y-h.y*l.x>=0?-c:c}(m=t.normalize(m,m),r,i,h);L=a.fromRotationZ(g,L),H.z=c,T=l.multiplyTransformation(T,l.fromRotationTranslation(L,H,O),T);var A=D;A[0]=p;for(var y=0;y<d;y++)for(var v=0;v<n.length;v+=3)f=t.fromArray(n,v,f),f=a.multiplyByVector(A,f,f),f=l.multiplyByPoint(T,f,f),s.push(f.x,f.y,f.z);return s}var N=new t;function Q(e,i,r,n,o,s,a){for(var l=0;l<e.length;l+=3){n=F(t.fromArray(e,l,N),i,r,n,o,s[l/3],a,1)}return n}function k(e,t){for(var i=e.length,r=new Array(3*i),n=0,o=t.x+t.width/2,s=t.height/2,a=0;a<i;a++)r[n++]=e[a].x-o,r[n++]=0,r[n++]=e[a].y-s;return r}var U=new c,j=new t,G=new a;function z(e,i,r,o,l,h,u,p,d,m){var f,g,A=t.angleBetween(t.subtract(i,e,b),t.subtract(r,e,w)),y=o===n.BEVELED?0:Math.ceil(A/s.toRadians(5));if(f=l?a.fromQuaternion(c.fromAxisAngle(t.negate(e,b),A/(y+1),U),G):a.fromQuaternion(c.fromAxisAngle(e,A/(y+1),U),G),i=t.clone(i,j),y>0)for(var v=m?2:1,C=0;C<y;C++)i=a.multiplyByVector(f,i,i),g=t.subtract(i,e,b),g=t.normalize(g,g),l||(g=t.negate(g,g)),u=F(h.scaleToGeodeticSurface(i,w),g,p,u,h,d,1,v);else g=t.subtract(i,e,b),g=t.normalize(g,g),l||(g=t.negate(g,g)),u=F(h.scaleToGeodeticSurface(i,w),g,p,u,h,d,1,1),r=t.clone(r,j),g=t.subtract(r,e,b),g=t.normalize(g,g),l||(g=t.negate(g,g)),u=F(h.scaleToGeodeticSurface(r,w),g,p,u,h,d,1,1);return u}P.removeDuplicatesFromShape=function(t){for(var i=t.length,r=[],n=i-1,o=0;o<i;n=o++){var s=t[n],a=t[o];e.equals(s,a)||r.push(a)}return r},P.angleIsGreaterThanPi=function(e,i,r,n){var s=new o(r,n),a=s.projectPointOntoPlane(t.add(r,e,B),B),l=s.projectPointOntoPlane(t.add(r,i,M),M);return l.x*a.y-l.y*a.x>=0};var Y=new t,Z=new t;return P.computePositions=function(e,i,r,o,a){var l=o._ellipsoid,c=function(e,t){for(var i=new Array(e.length),r=0;r<e.length;r++){var n=e[r];S=t.cartesianToCartographic(n,S),i[r]=S.height,e[r]=t.scaleToGeodeticSurface(n,n)}return i}(e,l),u=o._granularity,w=o._cornerType,B=a?function(e,t){var i=e.length,r=new Array(6*i),n=0,o=t.x+t.width/2,s=t.height/2,a=e[0];r[n++]=a.x-o,r[n++]=0,r[n++]=a.y-s;for(var l=1;l<i;l++){var h=(a=e[l]).x-o,c=a.y-s;r[n++]=h,r[n++]=0,r[n++]=c,r[n++]=h,r[n++]=0,r[n++]=c}return a=e[0],r[n++]=a.x-o,r[n++]=0,r[n++]=a.y-s,r}(i,r):k(i,r),M=a?k(i,r):void 0,E=r.height/2,T=r.width/2,O=e.length,L=[],D=a?[]:void 0,I=d,R=m,H=f,N=g,U=A,j=y,G=v,W=C,X=_,J=e[0],K=e[1];N=l.geodeticSurfaceNormal(J,N),I=t.subtract(K,J,I),I=t.normalize(I,I),W=t.cross(N,I,W),W=t.normalize(W,W);var V,q=c[0],$=c[1];a&&(D=F(J,W,M,D,l,q+E,1,1)),X=t.clone(J,X),J=K,R=t.negate(I,R);for(var ee=1;ee<O-1;ee++){var te=a?2:1;K=e[ee+1],I=t.subtract(K,J,I),I=t.normalize(I,I),H=t.add(I,R,H),H=t.normalize(H,H),N=l.geodeticSurfaceNormal(J,N);var ie=t.multiplyByScalar(N,t.dot(I,N),Y);t.subtract(I,ie,ie),t.normalize(ie,ie);var re=t.multiplyByScalar(N,t.dot(R,N),Z);if(t.subtract(R,re,re),t.normalize(re,re),!s.equalsEpsilon(Math.abs(t.dot(ie,re)),1,s.EPSILON7)){H=t.cross(H,N,H),H=t.cross(N,H,H),H=t.normalize(H,H);var ne=1/Math.max(.25,t.magnitude(t.cross(H,R,b))),oe=P.angleIsGreaterThanPi(I,R,J,l);oe?(U=t.add(J,t.multiplyByScalar(H,ne*T,H),U),j=t.add(U,t.multiplyByScalar(W,T,j),j),p[0]=t.clone(X,p[0]),p[1]=t.clone(j,p[1]),V=x(p,q+E,$+E,u),L=Q(h.generateArc({positions:p,granularity:u,ellipsoid:l}),W,B,L,l,V,1),W=t.cross(N,I,W),W=t.normalize(W,W),G=t.add(U,t.multiplyByScalar(W,T,G),G),w===n.ROUNDED||w===n.BEVELED?z(U,j,G,w,oe,l,L,B,$+E,a):L=F(J,H=t.negate(H,H),B,L,l,$+E,ne,te),X=t.clone(G,X)):(U=t.add(J,t.multiplyByScalar(H,ne*T,H),U),j=t.add(U,t.multiplyByScalar(W,-T,j),j),p[0]=t.clone(X,p[0]),p[1]=t.clone(j,p[1]),V=x(p,q+E,$+E,u),L=Q(h.generateArc({positions:p,granularity:u,ellipsoid:l}),W,B,L,l,V,1),W=t.cross(N,I,W),W=t.normalize(W,W),G=t.add(U,t.multiplyByScalar(W,-T,G),G),w===n.ROUNDED||w===n.BEVELED?z(U,j,G,w,oe,l,L,B,$+E,a):L=F(J,H,B,L,l,$+E,ne,te),X=t.clone(G,X)),R=t.negate(I,R)}else L=F(X,W,B,L,l,q+E,1,1),X=J;q=$,$=c[ee+1],J=K}p[0]=t.clone(X,p[0]),p[1]=t.clone(J,p[1]),V=x(p,q+E,$+E,u),L=Q(h.generateArc({positions:p,granularity:u,ellipsoid:l}),W,B,L,l,V,1),a&&(D=F(J,W,M,D,l,$+E,1,1)),O=L.length;var se=a?O+D.length:O,ae=new Float64Array(se);return ae.set(L),a&&ae.set(D,O),ae},Uo=P,Uo};let Go;const zo=function(){if(Go)return Go;const e=Cesium.arrayRemoveDuplicates,t=Cesium.BoundingRectangle,i=Cesium.BoundingSphere,r=(Cesium.Cartesian2,Cesium.Cartesian3),n=Cesium.ComponentDatatype,o=Cesium.CornerType,s=Cesium.defaultValue,a=Cesium.defined,l=Cesium.DeveloperError,h=Cesium.Ellipsoid,c=Cesium.Geometry,u=Cesium.GeometryAttribute,p=Cesium.GeometryAttributes,d=Cesium.GeometryPipeline,m=Cesium.IndexDatatype,f=Cesium.Math,g=Cesium.oneTimeWarning,A=Cesium.PolygonPipeline,y=jo(),v=Cesium.PrimitiveType,C=Cesium.VertexFormat,_=Cesium.WindingOrder;function b(e){var t=(e=s(e,s.EMPTY_OBJECT)).polylinePositions,i=e.shapePositions;if(!a(t))throw new l("options.polylinePositions is required.");if(!a(i))throw new l("options.shapePositions is required.");this._positions=t,this._shape=i,this._ellipsoid=h.clone(s(e.ellipsoid,h.WGS84)),this._cornerType=s(e.cornerType,o.ROUNDED),this._vertexFormat=C.clone(s(e.vertexFormat,C.DEFAULT)),this._granularity=s(e.granularity,f.RADIANS_PER_DEGREE),this._workerName="createPolylineVolumeGeometry";var n=1+t.length*r.packedLength;n+=1+i.length*r.packedLength,this.packedLength=n+h.packedLength+C.packedLength+2}b.pack=function(e,t,i){if(!a(e))throw new l("value is required");if(!a(t))throw new l("array is required");var n;i=s(i,0);var o=e._positions,c=o.length;for(t[i++]=c,n=0;n<c;++n,i+=r.packedLength)r.pack(o[n],t,i);var u=e._shape;for(c=u.length,t[i++]=c,n=0;n<c;++n,i+=r.packedLength)r.pack(u[n],t,i);return h.pack(e._ellipsoid,t,i),i+=h.packedLength,C.pack(e._vertexFormat,t,i),i+=C.packedLength,t[i++]=e._cornerType,t[i]=e._granularity,t};var w=h.clone(h.UNIT_SPHERE),P=new C,S={polylinePositions:void 0,shapePositions:void 0,ellipsoid:w,vertexFormat:P,cornerType:void 0,granularity:void 0};b.unpack=function(e,t,i){if(!a(e))throw new l("array is required");var n;t=s(t,0);var o=e[t++],c=new Array(o);for(n=0;n<o;++n,t+=r.packedLength)c[n]=r.unpack(e,t);o=e[t++];var u=new Array(o);for(n=0;n<o;++n,t+=r.packedLength)u[n]=r.unpack(e,t);var p=h.unpack(e,t,w);t+=h.packedLength;var d=C.unpack(e,t,P);t+=C.packedLength;var m=e[t++],f=e[t];return a(i)?(i._positions=c,i._shape=u,i._ellipsoid=h.clone(p,i._ellipsoid),i._vertexFormat=C.clone(d,i._vertexFormat),i._cornerType=m,i._granularity=f,i):(S.polylinePositions=c,S.shapePositions=u,S.cornerType=m,S.granularity=f,new b(S))};var x=new t;return b.createGeometry=function(o){var s=o._positions,a=e(s,r.equalsEpsilon),l=o._shape;if(l=y.removeDuplicatesFromShape(l),!(a.length<2||l.length<3)){A.computeWindingOrder2D(l)===_.CLOCKWISE&&l.reverse();var h=t.fromPoints(l,x);return function(e,t,r,o){var s=new p;o.position&&(s.position=new u({componentDatatype:n.DOUBLE,componentsPerAttribute:3,values:e}));var a,l,h,f,y,C,_=t.length,b=e.length/3,w=(b-2*_)/(2*_),P=A.triangulate(t),S=(w-1)*_*6+2*P.length,x=m.createTypedArray(b,S),B=2*_,M=0;for(a=0;a<w-1;a++){for(l=0;l<_-1;l++)C=(h=2*l+a*_*2)+B,y=(f=h+1)+B,x[M++]=f,x[M++]=h,x[M++]=y,x[M++]=y,x[M++]=h,x[M++]=C;y=(f=1+(h=2*_-2+a*_*2))+B,C=h+B,x[M++]=f,x[M++]=h,x[M++]=y,x[M++]=y,x[M++]=h,x[M++]=C}let E=[0];for(a=0;a<w-1;a++){const t=e,i=new Cesium.Cartesian3(t[8*a*3],t[8*a*3+1],t[8*a*3+2]),r=new Cesium.Cartesian3(t[8*(a+1)*3],t[8*(a+1)*3+1],t[8*(a+1)*3+2]),n=new Cesium.Cartesian3(t[8*a*3+3],t[8*a*3+3+1],t[8*a*3+3+2]),o=new Cesium.Cartesian3(t[8*(a+1)*3+3],t[8*(a+1)*3+3+1],t[8*(a+1)*3+3+2]),s=Cesium.Cartesian3.distance(i,r),l=Cesium.Cartesian3.distance(n,o);E.push(E[E.length-1]+Math.max(s,l))}if(E=E.map((e=>e/E[E.length-1])),o.st||o.tangent||o.bitangent){var T,O,L=new Float32Array(2*b),D=0;for(a=0;a<w;a++){for(T=E[a],O=t[0].z,L[D++]=T,L[D++]=O,l=1;l<_;l++)O=t[l].z,L[D++]=T,L[D++]=O,L[D++]=T,L[D++]=O;O=t[0].z,L[D++]=T,L[D++]=O}for(l=0;l<_;l++)T=0,O=t[l].z,L[D++]=T,L[D++]=O;for(l=0;l<_;l++)T=1-1e-12,O=t[l].z,L[D++]=T,L[D++]=O;s.st=new u({componentDatatype:n.FLOAT,componentsPerAttribute:2,values:new Float32Array(L)})}var I=b-2*_;for(a=0;a<P.length;a+=3){var R=P[a]+I,H=P[a+1]+I,F=P[a+2]+I;x[M++]=R,x[M++]=H,x[M++]=F,x[M++]=F+_,x[M++]=H+_,x[M++]=R+_}var N=new c({attributes:s,indices:x,boundingSphere:i.fromVertices(e),primitiveType:v.TRIANGLES});if(o.normal&&(N=d.computeNormal(N)),o.tangent||o.bitangent){try{N=d.computeTangentAndBitangent(N)}catch(e){g("polyline-volume-tangent-bitangent","Unable to compute tangents and bitangents for polyline volume geometry")}o.tangent||(N.attributes.tangent=void 0),o.bitangent||(N.attributes.bitangent=void 0),o.st||(N.attributes.st=void 0)}return N}(y.computePositions(a,l,h,o,!0),l,0,o._vertexFormat)}},Go=b,Go};var Yo=i(5108);class Zo extends hr{constructor(e,t){super(e,t);const i=this._earth.czm.scene;this.disposers.push((0,O.Z)(this,"enabled",this,"show")),this._onlyMove=!1,this._fixedPositionsNum=void 0,this._primitive=void 0,this.disposers.push((()=>{this._primitive&&(i.primitives.remove(this._primitive),this._primitive=void 0)})),this._roofPrimitive=void 0,this.disposers.push((()=>{this._roofPrimitive&&(i.primitives.remove(this._roofPrimitive),this._roofPrimitive=void 0)})),this._updateWallMaterialAndTexture(i),this._updateRoofMaterialAndTexture(i),this._boundingSphere=new Cesium.BoundingSphere(Cesium.Cartesian3.fromDegrees(0,0,0),10),this._updateWall(i),this.disposers.push((0,P.reaction)((()=>this.show),(()=>{this._updateShow()})))}_updateMaterial(){this._material||(this._material=Cesium.Material.fromType("Image"));const e=this._material;e.uniforms.image=this._texture,this._texture&&(e.uniforms.repeat.x=this._totalDistance/this.wallImageHeight*(this._texture.height/this._texture.width)/this.scale,e.uniforms.repeat.y=this.height/this.wallImageHeight)}_updateShow(){this._primitive&&(this._primitive.show=this.show),this._roofPrimitive&&(this._roofPrimitive.show=this.show)}_updateWall(e){const t=()=>{this._primitive&&(e.primitives.remove(this._primitive),this._primitive=void 0),this._roofPrimitive&&(e.primitives.remove(this._roofPrimitive),this._roofPrimitive=void 0);const t=this.positions;if(t.length>=2){const n=t.reduce(((e,t)=>(e.push(...t),e)),[]),[o]=t.reduce(((e,t)=>e[1]?(e[0]+=Ce(e[1],t),[e[0],t]):[0,t]),[0,void 0]);this._totalDistance=o,this._updateMaterial(),this._updateRoofMaterial(),this._updateShow();const s=Cesium.Cartesian3.fromRadiansArrayHeights(n),a=Cesium.Cartesian3.fromRadiansArrayHeights(n);this._boundingSphere=Cesium.BoundingSphere.fromPoints(s,this._boundingSphere);{const t=.5*this.depth,r=this.height,n=[new Cesium.Cartesian3(-t,0,0),new Cesium.Cartesian3(t,0,0),new Cesium.Cartesian3(t,r,.99),new Cesium.Cartesian3(-t,r,.99)],o=zo(),a=o.createGeometry(new o({polylinePositions:s,vertexFormat:Cesium.VertexFormat.ALL,shapePositions:n,cornerType:Cesium.CornerType.BEVELED}));if(a){{const e=a.attributes.st.values,t=4,i=e.length-4*t,r=this.depth/this._totalDistance;e[i+2]+=r,e[i+4]+=r,e[i+8]-=r,e[i+14]-=r}{const e=a.attributes.st.values,t=4,i=e.length-4*t,r=this.depth/this.wallImageHeight;for(let t=0;t<i;t+=16)e[t+8+1]=0,e[t+10+1]=r}var i=new Cesium.GeometryInstance({geometry:a});this._primitive=e.primitives.add(new Cesium.Primitive({geometryInstances:[i],appearance:new Cesium.MaterialAppearance({material:this._material,translucent:!1,closed:!0,renderState:this.creating?{depthMask:!1}:void 0}),compressVertices:!1,asynchronous:!1}))}}{const t=.5*this.depth,i=this.height,n=[new Cesium.Cartesian3(-(t-.01),i,0),new Cesium.Cartesian3(t-.01,i,.99),new Cesium.Cartesian3(t,i+.01,.99),new Cesium.Cartesian3(-t,i+.01,0)],o=zo();var r=new Cesium.GeometryInstance({geometry:new o({polylinePositions:a,vertexFormat:Cesium.VertexFormat.ALL,shapePositions:n,cornerType:Cesium.CornerType.BEVELED})});this._roofPrimitive=e.primitives.add(new Cesium.Primitive({geometryInstances:[r],appearance:new Cesium.MaterialAppearance({material:this._roofMaterial,translucent:!1,closed:!0,renderState:this.creating?{depthMask:!1}:void 0}),compressVertices:!1,asynchronous:!1}))}}};t(),this.disposers.push(GVOL.MVVM.watch((()=>({positions:[...this.positions.map((e=>[...e]))],height:this.height,depth:this.depth,creating:this.creating})),t))}_updateWallMaterialAndTexture(e){this._material=void 0,(0,P.extendObservable)(this,{_texture:void 0},{_texture:P.observable.ref}),this.disposers.push((()=>{this._material&&this._material.uniforms.image!==this._texture&&(this._texture.destroy(),this._texture=void 0),this._material&&(this._material.destroy(),this._material=void 0)}));const t=()=>{let t=R.Z.gvolEarthDir+"images/wallImages/4.jpg";""!==this.imageUrl&&(t=this.imageUrl),this._loadingImage=this._loadingImage&&this._loadingImage(),this._loadingImage=(()=>{let i=!0;return Cesium.Resource.fetchImage({url:t}).then((r=>{i&&(this._texture=Xo(r,e),this._currentImageUrl=t)})).otherwise((e=>{Yo.error("图像加载错误！"),this._loadingImage=this._loadingImage&&this._loadingImage()})),()=>{i=!1}})()};t(),this.disposers.push(GVOL.MVVM.watch((()=>({imageUrl:this.imageUrl})),t)),this._totalDistance=100,this._updateMaterial(),this.disposers.push(GVOL.MVVM.watch((()=>({scale:this.scale,_texture:this._texture,_totalDistance:this._totalDistance,wallImageHeight:this.wallImageHeight,height:this.height})),(()=>this._updateMaterial())))}_updateRoofMaterial(){this._roofMaterial||(this._roofMaterial=Cesium.Material.fromType("Image"));const e=this._roofMaterial;e.uniforms.image=this._roofTexture,this._roofTexture&&(e.uniforms.repeat.x=this._totalDistance/this.roofImageHeight*(this._roofTexture.height/this._roofTexture.width)/this.scale,e.uniforms.repeat.y=this.depth/this.roofImageHeight)}_updateRoofMaterialAndTexture(e){this._roofMaterial=void 0,(0,P.extendObservable)(this,{_roofTexture:void 0},{_roofTexture:P.observable.ref}),this.disposers.push((()=>{this._roofMaterial&&this._roofMaterial.uniforms.image!==this._roofTexture&&(this._roofTexture.destroy(),this._roofTexture=void 0),this._roofMaterial&&(this._roofMaterial.destroy(),this._roofMaterial=void 0)}));const t=()=>{let t=R.Z.gvolEarthDir+"images/wallImages/4.jpg";""!==this.roofImageUrl&&(t=this.roofImageUrl),this._loadingRoofImage=this._loadingRoofImage&&this._loadingRoofImage(),this._loadingRoofImage=(()=>{let i=!0;return Cesium.Resource.fetchImage({url:t}).then((r=>{i&&(this._roofTexture=Xo(r,e),this._currentRoofImageUrl=t)})).otherwise((e=>{Yo.error("图像加载错误！"),this._loadingRoofImage=this._loadingRoofImage&&this._loadingRoofImage()})),()=>{i=!1}})()};t(),this.disposers.push(GVOL.MVVM.watch((()=>({roofImageUrl:this.roofImageUrl})),t)),this._totalDistance=100,this._updateRoofMaterial(),this.disposers.push(GVOL.MVVM.watch((()=>({scale:this.scale,_roofTexture:this._roofTexture,_totalDistance:this._totalDistance,roofImageHeight:this.roofImageHeight,depth:this.depth})),(()=>this._updateRoofMaterial())))}get onlyMove(){return this._onlyMove}get fixedPositionsNum(){return this._fixedPositionsNum}flyTo(){this._earth.czm.scene.camera.flyToBoundingSphere(this._boundingSphere)}getTotalDistance(){return this._totalDistance}}Zo.defaultOptions={positions:[],show:!0,depth:.8,height:3,scale:1,imageUrl:"",wallImageHeight:3,roofImageUrl:"",roofImageHeight:3},c.Z.registerType(Zo,"Wall");const Wo=Zo;function Xo(e,t){const i=e.naturalWidth,r=e.naturalHeight,n=new Cesium.Texture({context:t.context,source:e,width:i,height:r});if(Cesium.Math.isPowerOfTwo(i)&&Cesium.Math.isPowerOfTwo(r)){const e=new Cesium.Sampler({wrapS:Cesium.TextureWrap.CLAMP_TO_EDGE,wrapT:Cesium.TextureWrap.CLAMP_TO_EDGE,minificationFilter:Cesium.TextureMinificationFilter.LINEAR_MIPMAP_LINEAR,magnificationFilter:Cesium.TextureMagnificationFilter.LINEAR});n.sampler=e,n.generateMipmap(Cesium.MipmapHint.NICEST)}return n}var Jo=i(9562),Ko=i(9495);class Vo extends u.Z{constructor(e,t){super(e,t),this.disposers.push((0,O.Z)(this,"enabled",this,"show")),this._primitive=void 0,this.disposers.push((()=>this._primitive&&this._earth.czm.scene.primitives.remove(this._primitive))),this._classificationPrimitive=void 0,this.disposers.push((()=>this._classificationPrimitive&&this._earth.czm.scene.primitives.remove(this._classificationPrimitive))),this._boundingSphere=new Cesium.BoundingSphere;{const e=()=>{this._primitive&&(this._primitive.show=this.show&&this.showHelper),this._classificationPrimitive&&(this._classificationPrimitive.show=this.show)};this.disposers.push((0,P.reaction)((()=>({show:this.show,showHelper:this.showHelper})),e));const t=e=>{if(this._primitive&&this._earth.czm.scene.primitives.remove(this._primitive),this._primitive=void 0,e.length>=3){var t=new Cesium.PolygonGeometry({polygonHierarchy:new Cesium.PolygonHierarchy(Cesium.Cartesian3.fromRadiansArray(e)),height:this.height,extrudedHeight:this.extrudedHeight}),i=new Cesium.GeometryInstance({geometry:t,id:this}),r=new Cesium.Primitive({geometryInstances:[i],appearance:new Cesium.MaterialAppearance({material:Cesium.Material.fromType("Color"),faceForward:!0,renderState:{depthTest:{enabled:this.depthTest}},closed:!0}),asynchronous:!1,allowPicking:this.allowPicking,compressVertices:!1});r.appearance.material.uniforms.color=Cesium.Color.YELLOW.withAlpha(.5),this._primitive=this._earth.czm.scene.primitives.add(r)}},i=e=>{if(this._classificationPrimitive&&this._earth.czm.scene.primitives.remove(this._classificationPrimitive),this._classificationPrimitive=void 0,e.length>=3){const n=this.color;var t=new Cesium.PolygonGeometry({vertexFormat:Cesium.PerInstanceColorAppearance.VERTEX_FORMAT,polygonHierarchy:new Cesium.PolygonHierarchy(Cesium.Cartesian3.fromRadiansArray(e)),height:this.height,extrudedHeight:this.extrudedHeight}),i=new Cesium.GeometryInstance({geometry:t,id:this,attributes:{color:Cesium.ColorGeometryInstanceAttribute.fromColor(new Cesium.Color(n[0],n[1],n[2],n[3])),show:new Cesium.ShowGeometryInstanceAttribute(!0)}}),r=new Cesium.ClassificationPrimitive({geometryInstances:[i],asynchronous:!1,allowPicking:this.allowPicking,compressVertices:!1,classificationType:2});this._classificationPrimitive=this._earth.czm.scene.primitives.add(r)}},r=()=>{const e=this.positions.length/2;if(e>=3){const t=[];for(let i=0;i<e;++i)t.push(this.positions[2*i],this.positions[2*i+1],.5*(this.height+this.extrudedHeight));const i=Cesium.Cartesian3.fromRadiansArrayHeights(t);this._boundingSphere=Cesium.BoundingSphere.fromPoints(i,this._boundingSphere)}};this.disposers.push((0,P.reaction)((()=>({positions:[...this.positions],height:this.height,extrudedHeight:this.extrudedHeight,depthTest:this.depthTest})),(()=>{const n=(0,Jo.Z)(this.positions);t(n),i(n),e(),r()}))),this.disposers.push((0,P.reaction)((()=>({color:[...this.color]})),(()=>{const t=(0,Jo.Z)(this.positions);i(t),e()})))}this._polyline=new Si.Z(e),this.disposers.push((()=>this._polyline=this._polyline&&this._polyline.destroy())),this._polyline.material.type="XbsjColorMaterial",this._polyline.depthTest=this.depthTest,this._polyline.loop=!0,(0,Ko.Z)(this._polyline,this),this.disposers.push((0,P.autorun)((()=>{this._polyline.material.XbsjColorMaterial.color=this.outline.color,this._polyline.width=this.outline.width,this._polyline.show=this.show&&this.showHelper&&this.outline.show,this._polyline.depthTest=this.depthTest})));{const e=()=>{const e=this.positions.length/2,t=[];for(let i=0;i<e;++i)t.push([this.positions[2*i],this.positions[2*i+1],this.height]);return t},t=e=>this._polyline&&(this._polyline.positions=e);t(e()),this.disposers.push((0,P.reaction)(e,t))}this.disposers.push((0,ae.Vy)(this._earth,this,{polygonCreatingWithHeight:"creating"})),this.disposers.push((0,ae.Ko)(this._earth,this,{polygonEditingProperty:"editing"})),(0,P.extendObservable)(this,{_extrudedPosition:[0,0,0]});const i=()=>{this.positions.length>0&&this._extrudedPosition.splice(0,3,this.positions[0],this.positions[1],this.extrudedHeight)};i(),this.disposers.push((0,P.reaction)((()=>({positions:[...this.positions],extrudedHeight:this.extrudedHeight})),i));const r=()=>{this.extrudedHeight=this._extrudedPosition[2]};r(),this.disposers.push((0,P.reaction)((()=>[...this._extrudedPosition]),r)),this.disposers.push((0,ae.mD)(this._earth,this,{positionHeightEditing:"extrudedHeightEditing",positionProperty:"_extrudedPosition"}))}get boundingSphere(){return this._boundingSphere}flyTo(){this._earth.czm.scene.camera.flyToBoundingSphere(this._boundingSphere)}destroy(){return super.destroy()}}const qo={title:"ClassificationPolygon Property",type:"object",properties:{positions:{type:"array",title:"位置数组",default:[],description:"位置数组"},height:{type:"number",title:"多边形的高度",default:0,description:"多边形的高度"},show:{type:"boolean",title:"是否在三维窗口中显示",default:!0,description:"是否在三维窗口中显示"},color:{type:"array",items:{type:"number"},minItems:4,maxItems:4,default:[1,1,1,1],description:"颜色叠加"},showHelper:{type:"boolean",title:"是否显示辅助线框",default:!1,description:"是否显示辅助线框"},outline:{title:"ClassificationPolygon outline Property",type:"object",properties:{show:{type:"boolean",title:"是否在三维窗口中显示",default:!0,description:"是否在三维窗口中显示"},color:{type:"array",items:{type:"number"},minItems:4,maxItems:4,default:[0,1,0,1],description:"颜色叠加"},width:{type:"number",title:"线框的宽度",default:2,description:"线框的宽度"}}},depthTest:{type:"boolean",title:"是否开启深度检测",default:!1,description:"是否开启深度检测"}}};Vo.gvolSchema=qo;Vo.gvolClassification=[{name:{chinese:"通用",english:"General"},properties:["positions","height","show","color","showHelper","outline","depthTest"]}],Vo.defaultOptions={positions:[],height:0,extrudedHeight:0,show:!0,color:[1,1,0,.5],showHelper:!1,outline:{show:!0,color:[0,1,0,1],width:2},depthTest:!1},c.Z.registerType(Vo,"ClassificationPolygon");const $o=Vo;var es=i(6066),ts=i(1449),is=i(4871),rs=i(2037);let ns,os,ss,as,ls,hs;function cs(e,t,i){as=as||new Cesium.Cartesian3,ls=ls||new Cesium.Cartesian3,hs=hs||new Cesium.Cartesian3;var r=Cesium.Cartesian3.subtract(t,e,as),n=Cesium.Cartesian3.subtract(i,e,ls),o=Cesium.Cartesian3.cross(r,n,hs);return.5*Cesium.Cartesian3.magnitude(o)}var us=i(5108);class ps extends u.Z{constructor(e,t){super(e,t),this.disposers.push((0,ae.wt)(this._earth,this,{polylineCreatingProperty:"creating"})),this.disposers.push((0,ae.ih)(this._earth,this,{polylineEditingProperty:"editing"})),this.disposers.push((0,O.Z)(this,"enabled",this,"show")),this._createOutline(),this._createInnerPoints(),this._createTin(),this._createTexturePosRot(),this._totalArea=0}_createOutline(){this._polyline=new GVOL.Obj.Polyline(this._earth),this._polyline.loop=!0,this._polyline.ground=!1,this._polyline.material.XbsjColorMaterial.color=[0,1,0,1],this._polyline.width=3,this.disposers.push((()=>{this._polyline=this._polyline&&this._polyline.destroy()})),this._polyline.show=this.showHelper&&this.show,GVOL.GvolEngine.Interaction.Picking.registerPickingParent(this._polyline,this);const e=()=>{this._polyline.show=this.showHelper&&this.show};e(),this.disposers.push(GVOL.MVVM.watch((()=>({show:this.show,showHelper:this.showHelper})),e));const t=()=>{this._polyline.positions=this.positions,e()};t(),this.disposers.push(GVOL.MVVM.watch((()=>({positions:[...this.positions]})),t))}_createTexturePosRot(){(0,P.extendObservable)(this,{_texturePosition:[0,0,0]}),this.disposers.push((0,O.Z)(this,"_texturePosition",this._cp,"position")),this.disposers.push((0,ae.J_)(this._earth,this,{rotationEditingProperty:"textureRotationEditing",positionProperty:"_texturePosition",rotationProperty:"textureRotation"}))}_createInnerPoints(){const e=this.earth;GVOL.MVVM.extend(this,{_innerPolylineShow:!0}),this._innerPolyline=new GVOL.Obj.Polyline(e),this._innerPolyline._pointsColor=[0,1,0,.95],this._innerPolyline.loop=!0,this._innerPolyline.ground=!1,this._innerPolyline.material.XbsjColorMaterial.color=[0,1,0,1],this._innerPolyline.depthTest=!1,this._innerPolyline.width=0,this._innerPolyline.showHelper=!0,(0,P.extendObservable)(this._innerPolyline,{editingPolylineShow:!1}),this.disposers.push((()=>{this._innerPolyline=this._innerPolyline&&this._innerPolyline.destroy()})),GVOL.GvolEngine.Interaction.Picking.registerPickingParent(this._innerPolyline,this);const t=()=>{this._innerPolyline.show=this.showHelper&&this.show};t(),this.disposers.push(GVOL.MVVM.watch((()=>({show:this.show,showHelper:this.showHelper})),t))}_createTin(){this._cp=new bn(this._earth),this._cp.renderState.depthTest.enabled=!0,this._cp.vertexShaderSource="\n// vtxf 使用double类型的position进行计算\n// attribute vec3 position3DHigh;\n// attribute vec3 position3DLow;\nattribute vec3 position;\nattribute vec3 normal;\nattribute vec2 st;\nattribute vec4 color;\nattribute float batchId;\nvarying vec3 v_positionEC;\nvarying vec3 v_normalEC;\nvarying vec2 v_st;\nvarying vec4 v_color;\nvoid main()\n{\n    // vtxf 使用double类型的position进行计算\n    // vec4 p = czm_translateRelativeToEye(position3DHigh, position3DLow);\n    // v_positionEC = (czm_modelViewRelativeToEye * p).xyz;      // position in eye coordinates\n    // v_normalEC = czm_normal * normal;                         // normal in eye coordinates\n    // v_st = st;\n    // gl_Position = czm_modelViewProjectionRelativeToEye * p;\n    v_positionEC = (czm_modelView * vec4(position, 1.0)).xyz;       // position in eye coordinates\n    v_normalEC = czm_normal * normal;                               // normal in eye coordinates\n    v_st = st;\n    v_color = color;\n    gl_Position = czm_modelViewProjection * vec4(position, 1.0);\n}\n",this._cp.fragmentShaderSource="\nvarying vec3 v_positionEC;\nvarying vec3 v_normalEC;\nvarying vec2 v_st;\nvarying vec4 v_color;\nuniform sampler2D u_image;\nuniform vec4 u_color;\nvoid main()\n{\n    vec3 positionToEyeEC = -v_positionEC;\n    vec3 normalEC = normalize(v_normalEC);\n// #ifdef FACE_FORWARD\n    normalEC = faceforward(normalEC, vec3(0.0, 0.0, 1.0), -normalEC);\n// #endif\n\n    czm_materialInput materialInput;\n    materialInput.normalEC = normalEC;\n    materialInput.positionToEyeEC = positionToEyeEC;\n    materialInput.st = v_st;\n    //czm_material material = czm_getMaterial(materialInput);\n    czm_material material = czm_getDefaultMaterial(materialInput);\n    vec4 imageColor = texture2D(u_image, fract(materialInput.st));\n\n    material.diffuse = imageColor.rgb;\n    material.alpha = imageColor.a;\n\n    material.diffuse *= v_color.rgb;\n    material.alpha *= v_color.a;\n    \n    material.diffuse *= u_color.rgb;\n    material.alpha *= u_color.a;\n\n#ifdef FLAT\n    gl_FragColor = vec4(material.diffuse + material.emission, material.alpha);\n#else\n    gl_FragColor = czm_phong(normalize(positionToEyeEC), material, czm_lightDirectionEC);\n#endif\n}\n",this.disposers.push((()=>{this._cp=this._cp&&this._cp.destroy()}));const e=()=>{this._cp.show=this.show};e(),this.disposers.push(GVOL.MVVM.watch((()=>({show:this.show})),e));const t=()=>{if(this.positions.length>=3){const e=this.positions.map((e=>[180*e[0]/Math.PI,180*e[1]/Math.PI])),o=this._innerPolyline.positions.map((e=>[180*e[0]/Math.PI,180*e[1]/Math.PI]));for(var t=(0,ts.Ym)([...e,...o]),i=0;i<this.positions.length;i++)t.features[i].properties.z=this.positions[i][2];for(let e=0;e<this._innerPolyline.positions.length;++e)t.features[e+this.positions.length].properties.z=this._innerPolyline.positions[e][2];e.push(e[0]);const s=(0,ts.yu)([e]);const a=(0,es.Z)(t,"z").features.flatMap((e=>{const t=e.geometry.coordinates[0];{let e=(0,is.Z)((0,ts.xm)(t[0]),(0,ts.xm)(t[1]));e=(0,is.Z)(e,(0,ts.xm)(t[2]));if(!(0,rs.Z)(e,s))return[]}const i=[e.properties.a,e.properties.b,e.properties.c],r=t.map(((e,t)=>[e[0]*Math.PI/180,e[1]*Math.PI/180,i[t]]));return r.length=3,r}));if(0===a.length)return;var[r,n]=Or.getLocalPositions(a);this._totalArea=function(e){ns=ns||new Cesium.Cartesian3,os=os||new Cesium.Cartesian3,ss=ss||new Cesium.Cartesian3;const t=e.length/9;let i=0;for(let r=0;r<t;++r)i+=cs(Cesium.Cartesian3.fromElements(e[9*r+0],e[9*r+1],e[9*r+2],ns),Cesium.Cartesian3.fromElements(e[9*r+3],e[9*r+4],e[9*r+5],os),Cesium.Cartesian3.fromElements(e[9*r+6],e[9*r+7],e[9*r+8],ss));return i}(r);let l,h,c=new Cesium.Matrix4;{this._scratchM3=this._scratchM3||new Cesium.Matrix3,this._scratchHPR=this._scratchHPR||new Cesium.HeadingPitchRoll;let e=this._scratchHPR;e.heading=this.textureRotation[0],e.pitch=this.textureRotation[1],e.roll=this.textureRotation[2];let t=Cesium.Matrix3.fromHeadingPitchRoll(this._scratchHPR,this._scratchM3);Cesium.Matrix3.inverse(t,t),Cesium.Matrix4.fromRotationTranslation(t,void 0,c)}if(this._scratchCartesian3=this._scratchCartesian3||new Cesium.Cartesian3,this._cp.canvasWidth>0&&this._cp.canvasHeight>0){l=new Array(r.length/3*2);for(let e=0;e<r.length/3;e++){const t=r[3*e+0],i=r[3*e+1],n=r[3*e+2];let o=Cesium.Cartesian3.fromElements(t,i,n,this._scratchCartesian3);o=Cesium.Matrix4.multiplyByPoint(c,o,o),l[2*e+0]=o.x/this._cp.canvasWidth*this._cp.canvasHeight/this.imageHeight/this.imageWidthScale,l[2*e+1]=o.y/this._cp.canvasHeight*this._cp.canvasHeight/this.imageHeight}}if(this._normalCs||(this._normalCs=[new Cesium.Cartesian3,new Cesium.Cartesian3,new Cesium.Cartesian3]),h=new Array(r.length),r.length%9!=0)throw new Error("localPositions.length % 9 !== 0");for(let e=0;e<r.length/9;e++){for(let t=0;t<3;++t)Cesium.Cartesian3.fromArray(r,9*e+3*t,this._normalCs[t]);Cesium.Cartesian3.subtract(this._normalCs[1],this._normalCs[0],this._normalCs[1]),Cesium.Cartesian3.normalize(this._normalCs[1],this._normalCs[1]),Cesium.Cartesian3.subtract(this._normalCs[2],this._normalCs[0],this._normalCs[2]),Cesium.Cartesian3.normalize(this._normalCs[2],this._normalCs[2]);const t=Cesium.Cartesian3.cross(this._normalCs[1],this._normalCs[2],this._normalCs[0]);for(let i=0;i<3;++i)Cesium.Cartesian3.pack(t,h,9*e+3*i)}this._cp.positions=r,this._cp.position=n,this._cp.sts=l,this._cp.normals=h,this._cp.indices=[...new Array(r.length/3).keys()]}e()};t(),this.disposers.push(GVOL.MVVM.watch((()=>({positions:[...this.positions],innerPositions:[...this._innerPolyline.positions],canvasWidth:this._cp.canvasWidth,canvasHeight:this._cp.canvasHeight,imageUrl:this._cp.imageUrl,textureRotation:[...this.textureRotation],imageHeight:this.imageHeight,imageWidthScale:this.imageWidthScale})),t));{let e=R.Z.gvolEarthDir+"images/wallImages/4.jpg";const t=()=>{""!==this.imageUrl?this._cp.imageUrl=this.imageUrl:this._cp.imageUrl=e};t(),this.disposers.push((0,P.reaction)((()=>this.imageUrl),t));const i=()=>{this._cp.imageUrl!==e?this.imageUrl=this._cp.imageUrl:this.imageUrl=""};i(),this.disposers.push((0,P.reaction)((()=>this._cp.imageUrl),i))}(0,P.extendObservable)(this,{innerCreating:!1,innerEditing:!1}),this.disposers.push((0,O.Z)(this,"innerCreating",this._innerPolyline,"creating")),this.disposers.push((0,O.Z)(this,"innerEditing",this._innerPolyline,"editing")),this.disposers.push((0,O.Z)(this,"innerPositions",this._innerPolyline,"positions"))}flyTo(){this.positions.length>0&&this._cp?this._cp.flyTo():us.warn("需要先创建，才能飞入！")}getTotalArea(){return this._totalArea}}ps.defaultOptions={positions:[],innerPositions:[],show:!0,showHelper:!0,imageUrl:"",textureRotation:[0,0,0],imageHeight:3,imageWidthScale:1},c.Z.registerType(ps,"Surface");const ds=ps;var ms=i(5108);class fs extends u.Z{constructor(e,t){super(e,t),this.disposers.push((0,ae.Vy)(this._earth,this,{polygonCreatingWithHeight:"creating"})),this.disposers.push((0,ae.Ko)(this._earth,this,{polygonEditingProperty:"editing"})),this.disposers.push((0,O.Z)(this,"enabled",this,"show")),this._createSampledPositions(),this._createBottomSurface(),this._createWall(),this._createDiscard(),this._averageHeight=0}_createDiscard(){const e=()=>{this._fpc.enabled=this.show},t=()=>{this._fpc.polygons[0].positions=[...this.positions]},i=()=>{if(!this._fpc||this._fpc.guid!==this.discardGuid){this._fpc&&(this._fpc=this._fpc&&this._fpc.destroy());var i=new GVOL.Obj.FlattenedPolygonCollection(this._earth,this.discardGuid);i.flattenDiscard=!0,i.polygons.push({}),this._fpc=i,t(),e(),this.discardGuid=this.discardGuid||i.guid}};i(),this.disposers.push((0,P.reaction)((()=>this.discardGuid),i)),this.disposers.push((()=>{this._fpc=this._fpc&&this._fpc.destroy()})),t(),this.disposers.push((0,P.reaction)((()=>({positions:[...this.positions]})),t)),e(),this.disposers.push((0,P.reaction)((()=>this.show),e))}getDiscardGuid(){return this.discardGuid}_createBottomSurface(){this._bottomSurface=new ds(this._earth),this._bottomSurface.showHelper=!1,this.disposers.push((()=>{this._bottomSurface=this._bottomSurface&&this._bottomSurface.destroy()})),GVOL.GvolEngine.Interaction.Picking.registerPickingParent(this._bottomSurface,this);const e=()=>{this._bottomSurface.show=this.showHelper&&this.show};e(),this.disposers.push((0,P.reaction)((()=>({show:this.show,showHelper:this.showHelper})),e));const t=()=>{const t=[],i=this.positions.length/2;for(let e=0;e<i;++e)t.push([this.positions[2*e+0],this.positions[2*e+1],this.height]);this._bottomSurface.positions=t,e()};t(),this.disposers.push((0,P.reaction)((()=>({positions:[...this.positions],height:this.height})),t));{let e=R.Z.gvolEarthDir+"images/wallImages/bottom.jpg";const t=()=>{""!==this.bottomImageUrl?this._bottomSurface.imageUrl=this.bottomImageUrl:this._bottomSurface.imageUrl=e};t(),this.disposers.push((0,P.reaction)((()=>this.bottomImageUrl),t));const i=()=>{this._bottomSurface.imageUrl!==e?this.bottomImageUrl=this._bottomSurface.imageUrl:this.bottomImageUrl=""};i(),this.disposers.push((0,P.reaction)((()=>this._bottomSurface.imageUrl),i))}this.disposers.push((0,O.Z)(this,"bottomTextureRotation",this._bottomSurface,"textureRotation")),this.disposers.push((0,O.Z)(this,"bottomImageHeight",this._bottomSurface,"imageHeight")),this.disposers.push((0,O.Z)(this,"bottomImageWidthScale",this._bottomSurface,"imageWidthScale")),(0,P.extendObservable)(this,{bottomTextureRotationEditing:!1}),this.disposers.push((0,O.Z)(this,"bottomTextureRotationEditing",this._bottomSurface,"textureRotationEditing"))}_createWall(){this._cp=new bn(this._earth),this._cp.renderState.depthTest.enabled=!0,this._cp.vertexShaderSource="\n// vtxf 使用double类型的position进行计算\n// attribute vec3 position3DHigh;\n// attribute vec3 position3DLow;\nattribute vec3 position;\nattribute vec3 normal;\nattribute vec2 st;\nattribute vec4 color;\nattribute float batchId;\nvarying vec3 v_positionEC;\nvarying vec3 v_normalEC;\nvarying vec2 v_st;\nvarying vec4 v_color;\nvoid main()\n{\n    // vtxf 使用double类型的position进行计算\n    // vec4 p = czm_translateRelativeToEye(position3DHigh, position3DLow);\n    // v_positionEC = (czm_modelViewRelativeToEye * p).xyz;      // position in eye coordinates\n    // v_normalEC = czm_normal * normal;                         // normal in eye coordinates\n    // v_st = st;\n    // gl_Position = czm_modelViewProjectionRelativeToEye * p;\n    v_positionEC = (czm_modelView * vec4(position, 1.0)).xyz;       // position in eye coordinates\n    v_normalEC = czm_normal * normal;                               // normal in eye coordinates\n    v_st = st;\n    v_color = color;\n    gl_Position = czm_modelViewProjection * vec4(position, 1.0);\n}\n",this._cp.fragmentShaderSource="\nvarying vec3 v_positionEC;\nvarying vec3 v_normalEC;\nvarying vec2 v_st;\nvarying vec4 v_color;\nuniform sampler2D u_image;\nuniform vec4 u_color;\nvoid main()\n{\n    vec3 positionToEyeEC = -v_positionEC;\n    vec3 normalEC = normalize(v_normalEC);\n// #ifdef FACE_FORWARD\n    normalEC = faceforward(normalEC, vec3(0.0, 0.0, 1.0), -normalEC);\n// #endif\n\n    czm_materialInput materialInput;\n    materialInput.normalEC = normalEC;\n    materialInput.positionToEyeEC = positionToEyeEC;\n    materialInput.st = v_st;\n    //czm_material material = czm_getMaterial(materialInput);\n    czm_material material = czm_getDefaultMaterial(materialInput);\n    vec4 imageColor = texture2D(u_image, fract(materialInput.st));\n\n    material.diffuse = imageColor.rgb;\n    material.alpha = imageColor.a;\n\n    material.diffuse *= v_color.rgb;\n    material.alpha *= v_color.a;\n    \n    material.diffuse *= u_color.rgb;\n    material.alpha *= u_color.a;\n\n#ifdef FLAT\n    gl_FragColor = vec4(material.diffuse + material.emission, material.alpha);\n#else\n    gl_FragColor = czm_phong(normalize(positionToEyeEC), material, czm_lightDirectionEC);\n#endif\n}\n";{let e=R.Z.gvolEarthDir+"images/wallImages/wall.jpg";const t=()=>{""!==this.wallImageUrl?this._cp.imageUrl=this.wallImageUrl:this._cp.imageUrl=e};t(),this.disposers.push((0,P.reaction)((()=>this.wallImageUrl),t));const i=()=>{this._cp.imageUrl!==e?this.wallImageUrl=this._cp.imageUrl:this.wallImageUrl=""};i(),this.disposers.push((0,P.reaction)((()=>this._cp.imageUrl),i))}this.disposers.push((()=>{this._cp=this._cp&&this._cp.destroy()}));const e=()=>{this._cp.show=this.show};e(),this.disposers.push(GVOL.MVVM.watch((()=>({show:this.show})),e));const t=()=>{if(this.sampledPositions){if(this.sampledPositions.length>2){const e=this.sampledPositions.length,r=[];r.push(0);const n=this.sampledPositions;this._scratchCartesian03251552=this._scratchCartesian03251552||new Cesium.Cartesian3,this._scratchCartesian03251553=this._scratchCartesian03251553||new Cesium.Cartesian3;for(let t=0;t<e;++t){const i=Cesium.Cartesian3.fromRadians(n[t][0],n[t][1],0,void 0,this._scratchCartesian03251552),o=Cesium.Cartesian3.fromRadians(n[(t+1)%e][0],n[(t+1)%e][1],0,void 0,this._scratchCartesian03251553),s=Cesium.Cartesian3.distance(i,o);r.push(r[t]+s)}const o=new Array(3*(e+1)*2),s=new Array(2*(e+1)*2);for(let t=0;t<e+1;++t)o[3*t+0]=this.sampledPositions[t%e][0],o[3*t+1]=this.sampledPositions[t%e][1],o[3*t+2]=this.height,s[2*t+0]=r[t],s[2*t+1]=this.height;for(let t=0;t<e+1;++t)o[3*(e+1+t)+0]=this.sampledPositions[t%e][0],o[3*(e+1+t)+1]=this.sampledPositions[t%e][1],o[3*(e+1+t)+2]=this.sampledPositions[t%e][2],s[2*(e+1+t)+0]=r[t],s[2*(e+1+t)+1]=this.sampledPositions[t%e][2];const a=new Array(6*e);for(let t=0;t<e;++t)a[6*t+0]=t,a[6*t+1]=t+1,a[6*t+2]=t+(e+1),a[6*t+3]=t+1,a[6*t+4]=t+1+(e+1),a[6*t+5]=t+(e+1);const l=new Array(6*e),h=new Array(6*e*2);for(let t=0;t<6*e;++t){const e=a[t];l[t]=[o[3*e+0],o[3*e+1],o[3*e+2]];const i=s[2*e+0]/this._cp.canvasWidth*this._cp.canvasHeight/this.wallImageHeight/this.wallImageWidthScale,r=s[2*e+1]/this._cp.canvasHeight*this._cp.canvasHeight/this.wallImageHeight;h[2*t+0]=i,h[2*t+1]=r}var[t,i]=Or.getLocalPositions(l);let c;if(this._normalCs||(this._normalCs=[new Cesium.Cartesian3,new Cesium.Cartesian3,new Cesium.Cartesian3]),c=new Array(t.length),t.length%9!=0)throw new Error("localPositions.length % 9 !== 0");for(let e=0;e<t.length/9;e++){for(let i=0;i<3;++i)Cesium.Cartesian3.fromArray(t,9*e+3*i,this._normalCs[i]);Cesium.Cartesian3.subtract(this._normalCs[1],this._normalCs[0],this._normalCs[1]),Cesium.Cartesian3.normalize(this._normalCs[1],this._normalCs[1]),Cesium.Cartesian3.subtract(this._normalCs[2],this._normalCs[0],this._normalCs[2]),Cesium.Cartesian3.normalize(this._normalCs[2],this._normalCs[2]);const i=Cesium.Cartesian3.cross(this._normalCs[1],this._normalCs[2],this._normalCs[0]);for(let t=0;t<3;++t)Cesium.Cartesian3.pack(i,c,9*e+3*t)}if(t.length<=0)return;this._cp.positions=t,this._cp.position=i,this._cp.sts=h,this._cp.normals=c,this._cp.indices=[...new Array(t.length/3).keys()]}e()}};t(),this.disposers.push(GVOL.MVVM.watch((()=>({sampledPositions:[...this.sampledPositions],height:this.height,canvasWidth:this._cp.canvasWidth,canvasHeight:this._cp.canvasHeight,imageHeight:this.wallImageHeight,imageWidthScale:this.wallImageWidthScale})),t))}_createSampledPositions(){this._scratchCarto=this._scratchCarto||new Cesium.Cartographic(0,0);const e=()=>{const e=this.positions.length/2|0,t=[];this._scratchCC1=this._scratchCC1||new Cesium.Cartesian3,this._scratchCC2=this._scratchCC2||new Cesium.Cartesian3,this._scratchCC3=this._scratchCC3||new Cesium.Cartesian3,this._scratchCarto=this._scratchCarto||new Cesium.Cartographic;for(let i=0;i<e;++i){let r=(i+1)%e;const n=Cesium.Cartesian3.fromRadians(this.positions[2*i+0],this.positions[2*i+1],0,void 0,this._scratchCC1),o=Cesium.Cartesian3.fromRadians(this.positions[2*r+0],this.positions[2*r+1],0,void 0,this._scratchCC2),s=Cesium.Cartesian3.distance(n,o),a=0|Math.ceil(s/this.sampledDistance);t.push(new Cesium.Cartographic(this.positions[2*i+0],this.positions[2*i+1]));for(let e=1;e<a;++e){const i=Cesium.Cartesian3.lerp(n,o,e/a,this._scratchCC3),r=Cesium.Cartographic.fromCartesian(i,void 0,this._scratchCarto);t.push(new Cesium.Cartographic(r.longitude,r.latitude))}}return t};this._updateSampledPositionsTrigger=new rxjs.Subject,this._sampleHeightSubscription=this._updateSampledPositionsTrigger.pipe(rxjs.operators.debounceTime(2e3),rxjs.operators.map((()=>e())),rxjs.operators.switchMap((e=>{const t=[];this._cp&&this._cp._primitive&&t.push(this._cp._primitive),this._bottomSurface&&this._bottomSurface._cp&&t.push(this._bottomSurface._cp);const i=this._earth,r=i.interaction.editingPolygonBinding._editing._editing._polyline,n=i.interaction.editingPolygonBinding._editing._editing._points,o=i.interaction.flattenedPolygonCreatingBinding._polylineCreating._editing._polyline;r&&r._primitive&&t.push(r._primitive),n&&n._primitive&&t.push(n._primitive),o&&o._primitive&&t.push(o._primitive),this._fpc&&(this._fpc.enabled=!1);const s=this.notUseSampleHeightMostDetailed?new Promise(((i,r)=>{try{for(let i of e)i.height=this._earth.czm.scene.sampleHeight(i,t);i(e)}catch(e){r(e)}})):this._earth.czm.scene.sampleHeightMostDetailed(e,t);return rxjs.from(s)}))).subscribe((e=>{if(e.length>0&&e.every((e=>isFinite(e.height)))){this._fpc&&(this._fpc.enabled=!0),this.sampledPositions=e.map((e=>[e.longitude,e.latitude,e.height]));const t=e.reduce(((e,t)=>e+=t.height),0);this._averageHeight=t/e.length}else ms.warn("有位置点不能找到高程值，可能是没有开启地形深度监测！")})),this.disposers.push((()=>{this._sampleHeightSubscription&&(this._sampleHeightSubscription.unsubscribe(),this._sampleHeightSubscription=void 0),this._updateSampledPositionsTrigger&&(this._updateSampledPositionsTrigger.unsubscribe(),this._updateSampledPositionsTrigger=void 0)}));this.disposers.push((0,P.reaction)((()=>({positions:[...this.positions],sampledDistance:this.sampledDistance})),(()=>{this._gvolFromJSONParsing||this._updateSampledPositionsTrigger.next()})))}gvolFromJSON(e){this._gvolFromJSONParsing=!0,super.gvolFromJSON(e),this._gvolFromJSONParsing=!1}flyTo(){this.positions.length>0&&this._cp?this._cp.flyTo():ms.warn("创建后才可以飞入！")}getTotalVolume(){return(this._averageHeight-this.height)*this._bottomSurface.getTotalArea()}getTotalArea(){return this._bottomSurface.getTotalArea()}applyTerrain(){this.earth.terrainEffect.restrict.enabled=!0,this.earth.terrainEffect.restrict.innerDiscard=!0,this.earth.terrainEffect.restrict.positions=JSON.parse(JSON.stringify(this.positions))}}fs.defaultOptions={positions:[],sampledDistance:10,sampledPositions:[],height:0,innerPositions:[],show:!0,showHelper:!0,wallImageUrl:"",wallImageHeight:3,wallImageWidthScale:1,bottomImageUrl:"",bottomTextureRotation:[0,0,0],bottomImageHeight:3,bottomImageWidthScale:1,discardGuid:void 0,notUseSampleHeightMostDetailed:!1},c.Z.registerType(fs,"CutSurface");const gs=fs;var As=i(2046),ys=i(8588),vs=i(5108);const Cs=function(...e){if(1===e.length&&"function"==typeof e[0])return(0,P.autorun)(e[0]);if(e.length>=2&&"function"==typeof e[1]){if("function"==typeof e[0]){const t=Object.assign({fireImmediately:!0},e[2]);return(0,P.reaction)(e[0],e[1],t)}if((0,P.isObservable)(e[0]))return(0,P.observe)(e[0],(t=>{e[1](t.object)}))}if(3===e.length&&"object"==typeof e[0]&&"string"==typeof e[1]&&"function"==typeof e[2]){let t;try{t=new As.Z(e[0],e[1])}catch(e){t=void 0}if(t){const i=e[2];return(0,P.reaction)((()=>void 0===t.d?void 0:(0,ys.OI)(t.d)?[...t.d]:(0,ys.tY)(t.d)?t.d:JSON.parse(JSON.stringify(t.d))),i)}}vs.error("MVVM参数设置错误。")};var _s=i(5108);class bs extends u.Z{constructor(e,t){super(e,t),this._viewer=e.czm.viewer;let i=this;this.disposers.push((0,O.Z)(this,"enabled",this,"show")),this._dataSource=void 0,this.disposers.push((()=>{this._dataSource&&(this._viewer.dataSources.remove(i._dataSource),this._dataSource=void 0)})),this.disposers.push(Cs((()=>({url:i.url})),(()=>{i._dataSource&&(i._viewer.dataSources.remove(i._dataSource),i._dataSource=void 0),i.url.length>0&&Cesium.GeoJsonDataSource.load(i.url).then((function(e){i._dataSource=e,i._viewer.dataSources.add(e),i._dataSource.show=i.show}))}))),this.disposers.push(GVOL.MVVM.watch((()=>({show:i.show})),(()=>{i._dataSource&&(i._dataSource.show=i.show)})))}flyTo(){this._dataSource?this._viewer.flyTo(this._dataSource.entities.values,{duration:1}):_s.warn("没有geojson数据")}}bs.defaultOptions={name:"geoJSON",url:"",show:!0,gvolType:"XbsjGeoJSON"},c.Z.registerType(bs,"XbsjGeoJSON");const ws=bs;var Ps=i(5108);class Ss extends u.Z{constructor(e,t){super(e,t),this._viewer=e.czm.viewer;let i=this;this.disposers.push((0,O.Z)(this,"enabled",this,"show")),this._dataSource=void 0,this.disposers.push((()=>{this._dataSource&&(this._viewer.dataSources.remove(i._dataSource),this._dataSource=void 0)})),this.disposers.push(Cs((()=>({url:i.url})),(()=>{i._dataSource&&i._viewer.dataSources.remove(i._dataSource),i.url.length>0&&Cesium.KmlDataSource.load(i.url).then((function(e){i._dataSource=e,i._viewer.dataSources.add(e),i._dataSource.show=i.show}))}))),this.disposers.push(GVOL.MVVM.watch((()=>({show:i.show})),(()=>{i._dataSource&&(i._dataSource.show=i.show)})))}flyTo(){this._dataSource?this._viewer.flyTo(this._dataSource.entities.values,{duration:1}):Ps.warn("没有geojson数据")}}Ss.defaultOptions={name:"KML",url:"",show:!0,gvolType:"XbsjKML"},c.Z.registerType(Ss,"XbsjKML");const xs=Ss;var Bs=i(5108);class Ms extends u.Z{constructor(e,t){super(e,t),this._viewer=e.czm.viewer;let i=this;this.disposers.push((0,O.Z)(this,"enabled",this,"show")),this._dataSource=void 0,this.disposers.push((()=>{this._dataSource&&(this._viewer.dataSources.remove(i._dataSource),this._dataSource=void 0)})),this.disposers.push(Cs((()=>({url:i.url})),(()=>{i._dataSource&&(i._viewer.dataSources.remove(i._dataSource),i._dataSource=void 0),i.url.length>0&&Cesium.CzmlDataSource.load(i.url).then((function(e){i._dataSource=e,i._viewer.dataSources.add(e),i._dataSource.show=i.show}))}))),this.disposers.push(GVOL.MVVM.watch((()=>({show:i.show})),(()=>{i._dataSource&&(i._dataSource.show=i.show)})))}flyTo(){this._dataSource?this._viewer.zoomTo(this._dataSource):Bs.warn("没有geojson数据")}}Ms.defaultOptions={name:"Czml",url:"",show:!0,gvolType:"XbsjCzml"},c.Z.registerType(Ms,"XbsjCzml");const Es=Ms;var Ts=i(5108);class Os extends u.Z{constructor(e,t){super(e,t),this._viewer=e.czm.viewer,this.disposers.push((0,O.Z)(this,"enabled",this,"show"))}flyTo(){Ts.warn("未实现！")}}Os.defaultOptions={show:!0},c.Z.registerType(Os,"Proxy");const Ls=Os;var Ds=i(5108);class Is extends h.Z{constructor(){super(),this._nativeCommand=C(this),this.disposers.push((()=>this._nativeCommand=void 0));const e=()=>{if(this.renderCallback)try{this._nativeCommand.renderCallback=Function('"use strict";return ('+this.renderCallback+")")()}catch(e){Ds.error("renderCallback函数有问题！"),this._nativeCommand.renderCallback=void 0}};e(),this.disposers.push((0,P.reaction)((()=>this.renderCallback),e));const t=()=>{this.boundingVolume&&Array.isArray(this.boundingVolume)&&4===this.boundingVolume.length?(this._nativeCommand.boundingVolume.center.x=this.boundingVolume[0],this._nativeCommand.boundingVolume.center.y=this.boundingVolume[1],this._nativeCommand.boundingVolume.center.z=this.boundingVolume[2],this._nativeCommand.boundingVolume.radius=this.boundingVolume[3]):Ds.log("boundingVolume设置错误")};t(),this.disposers.push((0,P.reaction)((()=>this.boundingVolume),t)),this._nativeCommand.cull=this.cull,this.disposers.push((0,P.reaction)((()=>this.cull),(()=>{this._nativeCommand.cull=this.cull}))),this._nativeCommand.pass=this.pass,this.disposers.push((0,P.reaction)((()=>this.pass),(()=>{this._nativeCommand.pass=this.pass})));const i=()=>{let e;try{e=JSON.parse(this.renderState)}catch(e){Ds.warn("this.renderState作为JSON对象解析失败！")}e&&(this._nativeCommand.renderState=Cesium.RenderState.fromCache(e))};i(),this.disposers.push((0,P.reaction)((()=>this.renderState),i))}}Is.defaultOptions={renderCallback:null,boundingVolume:[0,0,0,1],cull:!1,pass:7,renderState:"{}"};const Rs=Is;var Hs=i(5108);class Fs extends u.Z{constructor(e,t){super(e,t),this._viewer=e.czm.viewer,this.disposers.push((0,O.Z)(this,"enabled",this,"show")),this._primitive=new _,this._earth.czm.scene.primitives.add(this._primitive),this.disposers.push((()=>{this._primitive&&(this._earth.czm.scene.primitives.remove(this._primitive),this._primitive=void 0)})),this.disposers.push((0,P.intercept)(this,"commands",(e=>("update"===e.type&&e.newValue&&Array.isArray(e.newValue)&&e.object.value!==e.newValue&&this.commands.splice(0,this.commands.length,...e.newValue),null))));this.disposers.push(h.Z.registerArrayProperty(this,"commands",(e=>{const t=new Rs;return e=e&&e.toJSON&&e.toJSON()||e,t.gvolFromJSON(e),this._primitive._commands.push(t._nativeCommand),t}),(e=>{const t=this._primitive._commands.indexOf(e._nativeCommand);-1!==t&&this._primitive._commands.splice(t,1),e.destroy()}))),this.disposers.push((0,P.reaction)((()=>this.show),(()=>{this._primitive.show=this.show})))}flyTo(){Hs.warn("未实现！")}}Fs.defaultOptions={show:!0,commands:[]},c.Z.registerType(Fs,"NativeRender");const Ns=Fs;let Qs,ks,Us;const js=6378137;function Gs(){Qs=Qs||Cesium.Math.toRadians,ks=ks||Cesium.Math.toDegrees,Us=Us||((e,t)=>Cesium.Math.equalsEpsilon(e,t,0,Cesium.Math.EPSILON4))}function zs(e,t,i,r){const n=new As.Z(e,t),o=new As.Z(i,r);if("number"!=typeof n.d||"number"!=typeof o.d)throw new Error("bindDegreeRadian 类型错误");return(0,O.Z)(e,t,i,r,{r1Tor2:e=>Cesium.Math.toRadians(e),r2Tor1:e=>Cesium.Math.toDegrees(e),equals:(e,t)=>Cesium.Math.equalsEpsilon(Cesium.Math.toRadians(e),t,0,Cesium.Math.EPSILON4)})}function Ys(e,t,i,r){Gs();const n=new As.Z(e,t),o=new As.Z(i,r);if(!(0,ys.OI)(n.d,3,"number")||!(0,ys.OI)(o.d,3,"number"))throw new Error("bindRotation 类型错误");return(0,O.Z)(e,t,i,r,{r1Tor2:(e,t)=>(t.splice(0,3,Qs(e[0]),Qs(e[1]),Qs(e[2])),t),r2Tor1:(e,t)=>(t.splice(0,3,ks(e[0]),ks(e[1]),ks(e[2])),t),equals:(e,t)=>Us(Qs(e[0]),t[0])&&Us(Qs(e[1]),t[1])&&Us(Qs(e[2]),t[2])})}function Zs(e,t,i,r){Gs();const n=new As.Z(e,t),o=new As.Z(i,r);if(!(0,ys.OI)(n.d,3,"number")||!(0,ys.OI)(o.d,3,"number"))throw new Error("bindPosition 类型错误");return(0,O.Z)(e,t,i,r,{r1Tor2:(e,t)=>(t.splice(0,3,Qs(e[0]),Qs(e[1]),e[2]),t),r2Tor1:(e,t)=>(t.splice(0,3,ks(e[0]),ks(e[1]),e[2]),t),equals:(e,t)=>Us(Qs(e[0])*js,t[0]*js)&&Us(Qs(e[1])*js,t[1]*js)&&Us(e[2],t[2])})}class Ws{constructor(e,t,{min:i=0,max:r=1,step:n=.01,title:o=t}={}){(0,P.extendObservable)(this,{min:i,max:r,step:n,title:o,value:e[t]});const s=function(){let e=document.getElementById("vtxf_panel");e||(e=document.createElement("div"),e.style.cssText="\n            position: absolute;\n            width: 240px;\n            background: rgba(0, 0, 0, 0.6);\n            min-height: 10px;\n            top: 10px;\n            left: 10px;\n            margin: 5px;\n            padding: 5px 15px 5px 15px;\n            border-radius: 5px;\n            ",document.body.appendChild(e),e.id="vtxf_panel");return e}();this._container=s;const a=document.createElement("span");a.style.cssText="color: white",s.appendChild(a);var l=document.createElement("input");l.style.cssText="width: 100%",l.type="range",s.appendChild(l),l.oninput=e=>{this.value=+e.target.value},this._el=l,this._disposers=[],this._disposers.push((0,P.reaction)((()=>e[t]),((i,r)=>{this.value=e[t]}))),this._disposers.push((0,P.autorun)((()=>{a.innerText=this.title+" "+this.value,l.min=""+this.min,l.max=""+this.max,l.step=""+this.step,l.value=""+this.value,e[t]=this.value})))}destroy(){this._disposers.forEach((e=>e())),this._disposers.length=0,this._container.removeChild(this._el),this._container=void 0,this._el=void 0}}const Xs=function(e,t,i){const r=new Ws(e,t,i);return function(){r.destroy()}},Js={reaction:P,extend:P.extendObservable,watch:Cs,bind:O.Z,track:O.j,binds:r,debugSlider:Xs};var Ks=i(5108);function Vs(e,t){let i=t;for(;i;){if(e===i)return!1;i=i.parent}return!0}class qs extends h.Z{constructor(e){super(),this.fromJsonFilterKeys.push("isSelected"),this.toJsonFilterKeys.push("isSelected"),void 0===e&&Ks.warn("Group的参数earth最好写上，避免以后不兼容！"),this._earth=e,this._parent=void 0,this._autoDestroy=!0,this._gvolID=Cesium.createGuid(),this._event=new Cesium.Event,this._isSelectedIntercept=(0,P.intercept)(this,"isSelected",(e=>{if("boolean"==typeof e.newValue)return e.newValue?(this._earth.sceneTree._currentSelectedNode&&(this._earth.sceneTree._currentSelectedNode.isSelected=!1),this._earth.sceneTree._currentSelectedNode=this):this._earth.sceneTree._currentSelectedNode&&this._earth.sceneTree._currentSelectedNode===this&&(this._earth.sceneTree._currentSelectedNode=void 0),e})),(0,P.intercept)(this,"ref",(e=>"update"===e.type?(e.object.value&&delete this._earth.sceneTree.$refs[e.object.value],e.newValue&&(this._earth.sceneTree.$refs[e.newValue]&&Ks.warn("同一个ref被使用了多次！"),this._earth.sceneTree.$refs[e.newValue]=this),e):null)),this.currentSelectedNode}get event(){return this._event}get gvolID(){return this._gvolID}get parent(){return this._parent}canMoveTo(e){return Vs(this,e)}moveTo(e,t){return function(e,t,i){if(!Vs(e,t))return!1;e._autoDestroy=!1;const r=e.parent,n=r.children.indexOf(e);return r.children.splice(n,1),e._autoDestroy=!0,t.children.splice(i,0,e),!0}(this,e,t=void 0!==t?t:e.children.length)}cloneTo(e,t){t=void 0!==t?t:e.children.length,e.children.splice(t,0,this.toJSON())}destroy(){return this.ref="",this.isSelected=!1,this._isSelectedIntercept=this._isSelectedIntercept&&this._isSelectedIntercept(),super.destroy()}}qs.defaultOptions={title:"未命名",isSelected:!1,ref:""};const $s=qs;var ea=i(5108);class ta extends $s{constructor(e){super(e.earth);var t=["enabled","title"];this.fromJsonFilterKeys.push(...t),this.toJsonFilterKeys.push(...t),(0,P.extendObservable)(this,{get checkStatus(){return this.enabled?"checked":"unchecked"}},{checkStatus:P.computed}),this.gvolObject=e,this._disposers=[],this._disposers.push((0,O.Z)(this,"enabled",this.gvolObject,"enabled")),this._disposers.push((0,O.Z)(this,"isSelected",this.gvolObject,"isSelected")),this._disposers.push((0,O.Z)(this,"title",this.gvolObject,"name")),this._disposers.push(h.Z.registerProperty(this,"gvolObject"))}destroy(){return this._disposers.forEach((e=>e())),this._disposers.length=0,this.gvolObject=this.gvolObject&&this.gvolObject.destroy(),super.destroy()}}ta.gvolFromJSON=function(e,t){const i=e.gvolObject.gvolType,r=e.gvolObject.gvolGuid,n=c.Z.createObject(i,t,r,e.gvolObject);if(n){n.gvolFromJSON(e.gvolObject);const t=new ta(n);return t.gvolFromJSON(e),t}return ea.warn("gvolObject 对象创建失败，返回空。"),null},ta.defaultOptions={enabled:!0,gvolObject:null};const ia=ta;var ra=i(5108);P.intercept,P.extendObservable,P.observable;class na extends $s{constructor(e){super(e),(0,P.extendObservable)(this,{get checkStatus(){const e=this.children.filter((e=>"ignored"!==e.checkStatus));return 0===e.length?"ignored":e.every((e=>"checked"===e.checkStatus))?"checked":e.every((e=>"unchecked"===e.checkStatus))?"unchecked":"indeterminate"}},{checkStatus:P.computed}),this._disposers=[],this._disposers.push(h.Z.registerArrayProperty(this,"children",(t=>{if(t instanceof $s)return void 0===t._parent?(t._parent=this,t):void 0;{let i;return(t=t&&t.toJSON&&t.toJSON()||t).children?(i=new na(e),i.gvolFromJSON(t)):i=ia.gvolFromJSON(t,e),i._parent=this,i}}),(e=>{e._parent=void 0,e._autoDestroy&&e.destroy()})))}set enabled(e){ra.warn("此只写属性将被废弃，请使用setAllChildrenEnabled函数!"),this.children.forEach((t=>t.enabled=!!e))}setAllChildrenEnabled(e){this.children.forEach((t=>{t instanceof na?t.setAllChildrenEnabled(!!e):t instanceof ia&&(t.enabled=!!e)}))}toJSON(){return{_super:super.toJSON(),children:this.children.map((e=>e.toJSON()))}}destroy(){return this._disposers.forEach((e=>e())),this._disposers.length=0,this.children.forEach((e=>e.destroy())),this.children.length=0,super.destroy()}}na.defaultOptions={expand:!0,children:[]};const oa=na;var sa=i(5108);class aa extends h.Z{constructor(e){super(),this.toJsonFilterKeys.push("currentSelectedNode"),this.root=new oa(e),this.disposers.push((()=>this.root.destroy())),this._earth=e,(0,P.extendObservable)(this,{_currentSelectedNode:void 0,get currentSelectedNode(){return this._currentSelectedNode}},{currentSelectedNode:P.computed}),this.disposers.push(h.Z.registerProperty(this,"root")),this._$refs={}}get earth(){return this._earth}get $refs(){return this._$refs}addSceneObject(e){const t=this.currentSelectedNode;if(t&&t.children)t.children.push(e);else if(t&&t.parent){const i=t.parent.children.indexOf(t);t.parent.children.splice(i,0,e)}else this.root.children.push(e)}removeSceneObject(e){let t;if(t=this.currentSelectedNode?this.currentSelectedNode:e,t){const e=t.parent.children.indexOf(t);t.parent.children.splice(e,1)}else sa.warn("未找到该对象的实例。")}getLeafs(){return this.leafs=[],this.leafsloop(this.leafs,this.root),this.leafs}getLeaf(e){let t=this.getLeafs().find((t=>t.gvolObject.gvolGuid&&t.gvolObject.gvolGuid===e));return t||sa.warn("未找到关联的leaf节点"),t}leafsloop(e,t){t.children?t.children.forEach((t=>{this.leafsloop(e,t)})):e.push(t)}}aa.defaultOptions={root:{},leafs:[]};const la={Node:$s,Leaf:ia,Group:oa,Tree:aa};class ha extends h.Z{constructor(e){super(),this._earth=e,this._scene=e.czm.scene}initWithCurrent(){let e=this._scene.camera;this.position=[e.positionCartographic.longitude,e.positionCartographic.latitude,e.positionCartographic.height],this.rotation=[e.heading,e.pitch,e.roll],this.fov=e.frustum.fov,this.near=e.frustum.near,this.far=e.frustum.far}flyTo(e){return new Promise(((t,i)=>{const r=this._scene,n=this.position;r.camera.flyTo({destination:Cesium.Cartesian3.fromRadians(...n),orientation:{heading:this.rotation[0],pitch:this.rotation[1],roll:this.rotation[2]},duration:e,complete:()=>{t(!0)},cancel:()=>{t(!1)}})}))}toReadable(){let e="";return e=Cesium.Math.toDegrees(this.position[0]).toFixed(5)+"°,"+Cesium.Math.toDegrees(this.position[1]).toFixed(5)+"°,"+Cesium.Math.toDegrees(this.position[2]).toFixed(2),e+="\r\n",e+=Cesium.Math.toDegrees(this.rotation[0]).toFixed(1)+"°,"+Cesium.Math.toDegrees(this.rotation[1]).toFixed(1)+"°,"+Cesium.Math.toDegrees(this.rotation[2]).toFixed(1)+"°",e+="\r\n",e+=Cesium.Math.toDegrees(this.fov).toFixed(1)+"°,"+this.near.toFixed(1)+","+this.far.toFixed(1),e}}ha.defaultOptions={position:[0,0,0],rotation:[0,0,0],fov:0,near:0,far:0};const ca=ha;class ua extends ca{constructor(e){super(e)}initWithCurrent(){return new Promise(((e,t)=>{this._earth.capture(64,64).then((t=>{this.thumbnail=t,super.initWithCurrent(),e(!0)})).catch((e=>{t(e)}))}))}flyTo(){return super.flyTo(this.duration)}}ua.defaultOptions={name:"new camera view",duration:.5,thumbnail:""},c.Z.registerType(ua,"CameraView.View");const pa=ua;class da extends h.Z{constructor(e,t){super(),this._earth=e,this._views=t,this._index=-1,this.duration=5e3,(0,P.extendObservable)(this,{_pathPlayingListener:void 0,get playing(){return!!this._pathPlayingListener},set playing(e){e&&!this._pathPlayingListener?this._play():!e&&this._pathPlayingListener&&(this._pathPlayingListener=this._pathPlayingListener&&this._pathPlayingListener())},loopPlay:!0},{_pathPlayingListener:P.observable.ref,playing:P.computed}),this.disposers.push((()=>{this.playing=!1}))}_play(){const e=this._earth.czm.scene;let t=Date.now(),i=0;this._pathPlayingListener=e.postUpdate.addEventListener(((e,r)=>{let n=Date.now();if(n-t>i){t=n;let e=this._index+1;e>=this._views.length&&(this.loopPlay?e=0:(e=-1,this._pathPlayingListener=this._pathPlayingListener&&this._pathPlayingListener())),e>=0&&e<this._views.length&&(this.index=e,i=this.duration)}}))}set index(e){if(this._index!==e&&(this._index=e,this._index>=0&&this._index<this._views.length)){const e=this._views[this._index],{position:t,rotation:i,duration:r}=e;this._earth.camera.flyTo(t,0,i,r)}}get index(){return this._index}}class ma extends h.Z{constructor(e){super(),this._earth=e,this._scene=e.czm.scene,this.globe=new pa(this._earth),this.china=new pa(this._earth),this.lastView=new ca(this._earth),this.defaultGlobe(),this.defaultChina(),this._interceptDisposer=h.Z.registerArrayProperty(this,"views",(e=>{const t=new pa(this._earth);return e=e&&e.toJSON&&e.toJSON()||e,t.gvolFromJSON(e),t}),(e=>{e.destroy()})),(0,P.extendObservable)(this,{get defaultView(){if(!(this.defaultViewIndex>=this.views.length||this.defaultViewIndex<0))return this.views[this.defaultViewIndex]}},{defaultView:P.computed}),this._player=new da(e,this.views)}get player(){return this._player}toJSON(e){return this.lastView.initWithCurrent(),super.toJSON(e)}gvolFromJSON(e){super.gvolFromJSON(e),this.lastView&&this.lastView.flyTo(1)}defaultGlobe(){this.globe.position=[2.1031217486531677,.5042461979915104,22191651.019924622],this.globe.rotation=[0,-1.5704894508531937,0],this.globe.near=.1,this.globe.far=1e10,this.globe.duration=.5}defaultChina(){this.china.position=[1.8770894704964525,.662547523843314,8511735.797037361],this.china.rotation=[0,-1.5701114159178209,0],this.china.near=.1,this.china.far=1e10,this.china.duration=.5}newView(){return new Promise(((e,t)=>{let i=new pa(this._earth);i.initWithCurrent().then((()=>{e(i)})).catch((e=>{t(e)}))}))}getCurrentCameraStatus(){let e=new ca(this._earth);return e.initWithCurrent(),e}destroy(){return this._interceptDisposer&&(this._interceptDisposer(),this._interceptDisposer=void 0),this._observeDisposer&&(this._observeDisposer(),this._observeDisposer=void 0),super.destroy()}}ma.defaultOptions={globe:null,china:null,lastView:null,views:[],defaultViewIndex:0},c.Z.registerType(ma,"CameraView.Manager");const fa={View:pa,Manager:ma,Status:ca};class ga extends c.Z{constructor(e){super(e._earth),this._flight=e,this._running=!1,this._sseh=new Cesium.ScreenSpaceEventHandler(e._earth.czm.viewer.canvas),this._sseh.setInputAction((()=>{this.cancel()}),Cesium.ScreenSpaceEventType.LEFT_DOWN),(0,P.extendObservable)(this,{get mode(){return"rotateGlobe"}},{mode:P.computed})}start(){if(this._running)return;this._flight._started(this);const e=this._earth.czm.viewer.camera,t=e.positionCartographic;e.flyTo({destination:Cesium.Cartesian3.fromRadians(t.longitude,this.latitude,this.height),orientation:{heading:0,pitch:-.5*Cesium.Math.PI,roll:0},complete:()=>{this._running=!0;var t=void 0;this._eventDisposer=this._earth.czm.viewer.scene.postUpdate.addEventListener(((i,r)=>{if(!t)return void(t=(new Date).getTime());const n=((new Date).getTime()-t)/1e3,o=e.positionCartographic.longitude+n*Cesium.Math.PI*2/this.cycle;e.setView({destination:Cesium.Cartesian3.fromRadians(o,this.latitude,this.height),orientation:{heading:0,pitch:-.5*Cesium.Math.PI,roll:0}}),t=(new Date).getTime()}))},duration:.5})}cancel(){this._running&&(this._eventDisposer&&(this._eventDisposer(),this._eventDisposer=void 0),this._flight._canceled(),this._running=!1)}destroy(){return this.cancel(),this._sseh.destroy(),super.destroy()}}ga.defaultOptions={height:1e7,cycle:60,latitude:119.3805188/180},c.Z.registerType(ga,"RotateGlobe");const Aa=ga;var ya=i(5108);class va extends c.Z{constructor(e){super(e._earth),this._flight=e,this._running=!1,this._sseh=new Cesium.ScreenSpaceEventHandler(e._earth.czm.viewer.canvas),this._sseh.setInputAction((()=>{this.cancel()}),Cesium.ScreenSpaceEventType.LEFT_DOWN),(0,P.extendObservable)(this,{get mode(){return"rotateCenter"}},{mode:P.computed})}start(){if(this._running)return;this._flight._started(this);const e=this._earth.czm.viewer.camera,t=this._earth.czm.viewer.scene;var i=e.getPickRay(new Cesium.Cartesian2(.5*t.canvas.width,.5*t.canvas.height)),r=t.globe.pick(i,t);if(r){ya.log(r);var n=Cesium.Transforms.eastNorthUpToFixedFrame(r);e.lookAtTransform(n);var o=this.range*Math.sin(this.pitch),s=this.range*Math.cos(this.pitch),a=new Cesium.Cartesian3(0,o,s),l=(e.cameraToWorldCoordinatesPoint(a),0);e.flyTo({destination:a,orientation:{heading:l,pitch:this.pitch,roll:0},endTransform:n,complete:()=>{this._running=!0;var t=void 0;this._eventDisposer=this._earth.czm.viewer.scene.postUpdate.addEventListener(((i,r)=>{if(!t)return void(t=(new Date).getTime());const o=((new Date).getTime()-t)/1e3;l+=o*Cesium.Math.PI*2/this.cycle,e.lookAtTransform(n,new Cesium.HeadingPitchRange(l,this.pitch,this.range)),t=(new Date).getTime()}))},duration:.5})}}cancel(){if(!this._running)return;this._earth.czm.viewer.camera.lookAtTransform(Cesium.Matrix4.IDENTITY),this._eventDisposer&&(this._eventDisposer(),this._eventDisposer=void 0),this._flight._canceled(),this._running=!1}destroy(){return this.cancel(),this._sseh.destroy(),super.destroy()}}va.defaultOptions={range:5e4,cycle:60,pitch:-94.247778/180},c.Z.registerType(va,"RotateCenter");const Ca=va;class _a extends c.Z{constructor(e){super(e._earth),this._flight=e,(0,P.extendObservable)(this,{get mode(){return"track"}},{mode:P.computed})}start(){this._running}cancel(){this._running&&(this._earth.czm.viewer.trackedEntity=void 0,this._eventDisposer&&(this._eventDisposer(),this._eventDisposer=void 0),this._flight._canceled(),this._running=!1)}destroy(){return this.cancel(),super.destroy()}}c.Z.registerType(_a,"CameraTrack");const ba=_a;class wa extends c.Z{constructor(e){super(e),this.rotateGlobe=new Aa(this),this.rotateCenter=new Ca(this),this.track=new ba(this),this.disposers.push((()=>{this.rotateGlobe=this.rotateGlobe&&this.rotateGlobe.destroy(),this.rotateCenter=this.rotateCenter&&this.rotateCenter.destroy(),this.track=this.track&&this.track.destroy()})),(0,P.extendObservable)(this,{flying:void 0}),this.defaultPathFlyIndex=0,(0,P.extendObservable)(this,{get pathFly(){if(!(this._defaultPathFlyIndex<0||this._defaultPathFlyIndex>=this.paths.length))return this.paths[this.defaultPathFlyIndex]}},{pathFly:P.computed})}_started(e){this.flying=e}_canceled(){this.flying=void 0}destroy(){return super.destroy()}}wa.defaultOptions={rotateGlobe:null,rotateCenter:null,track:null,paths:[],defaultPathFlyIndex:0},c.Z.registerType(wa,"CameraFlight");const Pa=wa;class Sa extends h.Z{constructor(e){super(),(0,P.extendObservable)(this,{_velocity:0,_baseVelocity:0,velocityRatio:1,get velocity(){return this._velocity},get baseVelocity(){return this._baseVelocity}},{velocity:P.computed,baseVelocity:P.computed}),this._earth=e,this._earth.czm.scene.xbsjCameraImmersion&&(this._cameraImmersion=this._earth.czm.scene.xbsjCameraImmersion,this.disposers.push((0,P.autorun)((()=>{this.enabled?this._cameraImmersion.start():this._cameraImmersion.cancel()}))),this.disposers.push(this._cameraImmersion.velocityRatioEvent.addEventListener((e=>{this.velocityRatio!==e&&(this.velocityRatio=e)}))),this.disposers.push((0,P.autorun)((()=>{this._cameraImmersion.velocityRatio=this.velocityRatio}))),this.disposers.push(this._cameraImmersion.velocityEvent.addEventListener((e=>{this._velocity!==e&&(this._velocity=e)}))),this.disposers.push(this._cameraImmersion.baseVelocityEvent.addEventListener((e=>{this._baseVelocity!==e&&(this._baseVelocity=e)}))),this.disposers.push((0,P.autorun)((()=>{this._cameraImmersion.ghostMode.enabled=this.ghostMode}))),this.disposers.push(this._cameraImmersion.ghostMode.changed.addEventListener((()=>{this.ghostMode=this._cameraImmersion.ghostMode.enabled}))))}destroy(){return super.destroy()}}Sa.defaultOptions={enabled:!0,ghostMode:!1};const xa=Sa;class Ba extends h.Z{constructor(e){var t,i;super(),t=".gvolEarthSpliter:hover { background: padding-box #555 !important; }",(i=document.getElementById("styles_js"))||((i=document.createElement("style")).type="text/css",i.id="styles_js",document.getElementsByTagName("head")[0].appendChild(i)),i.appendChild(document.createTextNode(t)),this._earth=e;const r=e.czm.scene,n=this._earth.czm.viewer.cesiumWidget;(0,P.extendObservable)(this,{splitX:1,splitY:1,dividerVisible:!0});var o=document.createElement("div");o.style.cssText="\n        position: absolute; \n        width: 2px; \n        background: black; \n        background-clip: padding-box;\n        height: 100%; \n        left: 50%; \n        top: 0px;\n        border-style: solid;\n        border-color: transparent;\n        border-image: initial;\n        border-width: 0px 5px;\n        box-sizing: content-box;\n        cursor: w-resize;\n        ",o.className="gvolEarthSpliter",n.container.appendChild(o),this._verticalSpliter=o,this.disposers.push((()=>{this._verticalSpliter&&this._verticalSpliter.parentElement.removeChild(this._verticalSpliter)}));var s=document.createElement("div");s.style.cssText="\n        position: absolute; \n        height: 2px; \n        background: black; \n        background-clip: padding-box;\n        width: 100%; \n        top: 50%; \n        left: 0px;\n        border-style: solid;\n        border-color: transparent;\n        border-image: initial;\n        border-width: 5px 0px;\n        box-sizing: content-box;\n        cursor: n-resize;\n        ",s.className="gvolEarthSpliter",n.container.appendChild(s),this._horizontalSpliter=s,this.disposers.push((()=>{this._horizontalSpliter&&this._horizontalSpliter.parentElement.removeChild(this._horizontalSpliter)})),this._handler=function(e,t,i){var r=new Cesium.ScreenSpaceEventHandler(e);let n=!1,o=!1;function s(e){(n||o)&&i({x:n?e.endPosition.x:void 0,y:o?e.endPosition.y:void 0})}const a=i=>{const r=i.position.x,s=i.position.y,a=t.splitX*e.offsetWidth,l=t.splitY*e.offsetHeight,h=t.splitX,c=t.splitY,u=h>0&&h<1||c>0&&c<1;n=r>a-6&&r<a+6&&u,o=s>l-6&&s<l+6&&u};return r.setInputAction((function(e){a(e)}),Cesium.ScreenSpaceEventType.LEFT_DOWN),r.setInputAction((function(e){a(e)}),Cesium.ScreenSpaceEventType.PINCH_START),r.setInputAction(s,Cesium.ScreenSpaceEventType.MOUSE_MOVE),r.setInputAction(s,Cesium.ScreenSpaceEventType.PINCH_MOVE),r.setInputAction((function(){n=!1,o=!1}),Cesium.ScreenSpaceEventType.LEFT_UP),r.setInputAction((function(){n=!1,o=!1}),Cesium.ScreenSpaceEventType.PINCH_END),r}(n.container,this,(({x:e,y:t})=>{void 0!==e&&(this.splitX=e/n.container.offsetWidth),void 0!==t&&(this.splitY=t/n.container.offsetHeight)})),this.disposers.push((()=>{this._handler=this._handler&&this._handler.destroy()})),r.context.viewportSplit=r.context.viewportSplit||new Cesium.Cartesian4(1,1,1,1),this._changed=new Cesium.Event,this.disposers.push((0,P.autorun)((()=>{const e=this.dividerVisible,t=this.splitX,i=this.splitY;this._verticalSpliter.style.left=`calc(${100*t}% - 6px)`,r.context.viewportSplit.x=t,r.imagerySplitPosition=t,this._horizontalSpliter.style.top=`calc(${100*i}% - 6px)`,r.context.viewportSplit.y=i;const n=t>0&&t<1||i>0&&i<1;this._verticalSpliter.style.visibility=n&&e?"visible":"hidden",this._horizontalSpliter.style.visibility=n&&e?"visible":"hidden",this._changed.raiseEvent()})))}destroy(){return super.destroy()}}const Ma=Ba,Ea={showCompass:!1,compassStyle:{top:18,right:18,bottom:void 0,left:void 0},showDistanceLegend:!1,distanceLegendStyle:{top:void 0,right:18,bottom:18,left:void 0}};class Ta extends h.Z{constructor(e){if(super(),this._earth=e,this._disposers=[],h.Z.registerProperty(this,"compassStyle"),h.Z.registerProperty(this,"distanceLegendStyle"),Cesium.viewerCesiumNavigationMixin){let t={enableCompass:!0,enableZoomControls:!1,enableDistanceLegend:!0,enableCompassOuterRing:!0};const i=this._earth.czm.viewer;i.extend(Cesium.viewerCesiumNavigationMixin,t);const r=i.cesiumNavigation.navigationDiv.children[0];r.classList.remove("compass"),r.style["pointer-events"]="auto",r.style.overflow="hidden",r.style.position="absolute",r.style.width="95px",r.style.height="95px";const n=i.cesiumNavigation.distanceLegendDiv.children[0];e.czm.viewer.container.appendChild(e.czm.viewer.cesiumNavigation.container),this._disposers.push((0,P.autorun)((()=>{i.cesiumNavigation.navigationViewModel.showCompass=this.showCompass,i.cesiumNavigation.distanceLegendViewModel.enableDistanceLegend=this.showDistanceLegend;const e=r.style;Object.keys(this.compassStyle).forEach((t=>e[t]=this.compassStyle[t]&&this.compassStyle[t]+"px"||""));const t=n.style;Object.keys(this.distanceLegendStyle).forEach((e=>t[e]=this.distanceLegendStyle[e]&&this.distanceLegendStyle[e]+"px"||""))})))}}desotry(){this._disposers.forEach((e=>e())),this._disposers.length=0}}Ta.defaultOptions=Ea;const Oa=Ta;const La=class{constructor(e){this._earth=e,(0,P.extendObservable)(this,{useCesiumNavigator:!1});const t=e.czm.viewer,i=t.scene;this._originLookEventTypes=i.screenSpaceCameraController.lookEventTypes,this._originZoomEventTypes=i.screenSpaceCameraController.zoomEventTypes,this._disposers=[],this._disposers.push((0,P.autorun)((()=>{this.useCesiumNavigator?(i.screenSpaceCameraController.lookEventTypes=this._originLookEventTypes,i.screenSpaceCameraController.zoomEventTypes=this._originZoomEventTypes):(i.screenSpaceCameraController.lookEventTypes=[{eventType:Cesium.CameraEventType.RIGHT_DRAG},{eventType:Cesium.CameraEventType.RIGHT_DRAG,modifier:Cesium.KeyboardEventModifier.SHIFT}],i.screenSpaceCameraController.zoomEventTypes=[Cesium.CameraEventType.WHEEL,Cesium.CameraEventType.PINCH])}))),t.screenSpaceEventHandler.removeInputAction(Cesium.ScreenSpaceEventType.LEFT_CLICK),t.screenSpaceEventHandler.removeInputAction(Cesium.ScreenSpaceEventType.LEFT_DOUBLE_CLICK);const r=new Cesium.Cartesian3;t.screenSpaceEventHandler.setInputAction((e=>{const i=Cesium.xbsjPickPosition(t.scene,e.position,r);i&&Cesium.xbsjFlyAround(t.camera,i)}),Cesium.ScreenSpaceEventType.LEFT_DOUBLE_CLICK),t.screenSpaceEventHandler.setInputAction((e=>{this._earth.camera&&this._earth.camera.tracking&&this._earth.camera.tracking.enabled||t.camera.cancelFlight()}),Cesium.ScreenSpaceEventType.LEFT_DOWN)}destroy(){this._disposers.forEach((e=>e())),this._disposers.length=0}};const Da=function(e){const t=e._earth.czm.scene;(0,P.extendObservable)(e,{_flying:!1,position:[0,0,0],rotation:[0,0,0],get flying(){return e._flying}},{flying:P.computed}),e.disposers.push(h.Z.registerPosition(e)),e.disposers.push(h.Z.registerRotation(e)),t.camera.currentFlightEvent&&e.disposers.push(t.camera.currentFlightEvent.addEventListener((()=>{e._flying=!!t.camera._currentFlight})));let i=[],r=[];const n=()=>{const n=t.camera,o=n.positionCartographic;i.splice(0,i.length,o.longitude,o.latitude,o.height),r.splice(0,r.length,n.heading,n.pitch,n.roll),(0,P.runInAction)((()=>{e.position.xepe(i)||e.position.splice(0,3,o.longitude,o.latitude,o.height),e.rotation.xere(r)||e.rotation.splice(0,3,n.heading,n.pitch,n.roll)}))};let o;n(),e.disposers.push(t.preUpdate.addEventListener(n)),e.disposers.push((0,P.reaction)((()=>({position:[...e.position],rotation:[...e.rotation]})),(({position:e,rotation:n})=>{const s=t.camera,a=t.camera.positionCartographic;i.splice(0,i.length,a.longitude,a.latitude,a.height),r.splice(0,r.length,s.heading,s.pitch,s.roll);e.xepe(i)&&n.xere(r)||(o=o||new Cesium.Cartesian3,Cesium.Cartesian3.fromRadians(...e,void 0,o),s.setView({destination:o,orientation:{heading:n[0],pitch:n[1],roll:n[2]}}))})))};let Ia,Ra,Ha,Fa;const Na=function(e,t,i,r,n,o){Ia=Ia||new Cesium.Cartesian3;const s=Cesium.Cartesian3.fromRadians(...t,void 0,Ia);let a;if(r=r||[e.heading,e.pitch,e.roll],i){Ra=Ra||new Cesium.HeadingPitchRoll,Ra.xbsjFromArray(...r),Ra.heading-=Cesium.Math.PI_OVER_TWO,Ha=Ha||new Cesium.Matrix4;const e=Cesium.Transforms.headingPitchRollToFixedFrame(s,Ra,void 0,void 0,Ha);Fa=Fa||new Cesium.Cartesian3;const t=Cesium.Matrix4.multiplyByPointAsVector(e,Cesium.Cartesian3.UNIT_X,Fa);Cesium.Cartesian3.multiplyByScalar(t,i,t),Cesium.Cartesian3.subtract(s,t,s)}0===n?(e.setView({destination:s,orientation:{heading:r[0],pitch:r[1],roll:r[2]}}),o&&o.complete&&o.complete()):e.flyTo({destination:s,orientation:{heading:r[0],pitch:r[1],roll:r[2]},complete:()=>{o&&o.complete&&setTimeout((()=>o.complete()),0),a&&a.next("completed")},cancel:()=>{o&&o.cancel&&setTimeout((()=>o.cancel()),0),a&&a.next("cancelled")},duration:n})};let Qa;const ka=function(e,t,i,r,n=3,o=.314){Na(e,t,i,r,n,{complete:()=>{Qa=Qa||new Cesium.Cartesian3;const r=Cesium.Cartesian3.fromRadians(...t,void 0,Qa);Cesium.xbsjFlyAround(e,r,i,void 0,o)}})};i(5108);var Ua=i(5108);class ja extends h.Z{constructor(e){function t(e,t){this._listeners.push(e),this._scopes.push(t);var i=this;return function(){i.removeEventListener(e,t)}}super(),this._earth=e,this._gvolCameraImmersion=new xa(e),this._navigator=new Oa(e),this._interaction=new La(e),this.disposers.push((()=>{this._gvolCameraImmersion.destroy(),this._navigator.desotry(),this._interaction.destroy()})),Da(this);let i=0;try{let t=e.czm.scene.frameState.time.secondsOfDay;i=Math.floor(223*(t-Math.floor(t)))}catch(e){}let r=145+i;try{let i=t.call(e.czm.scene.postRender,(()=>{if(--r<0)try{let r=t.call(e.czm.scene.postRender,(()=>{})),n=t.call(e.czm.scene.postRender,(()=>{r=r&&r(),n()}));i()}catch(e){}}))}catch(e){}try{let t=e.czm.viewer;t.camera.changed.addEventListener((()=>{let e=t.scene.globe.ellipsoid.cartesianToCartographic(t.camera.position).height;this._cameraHeight=e}))}catch(e){}(0,P.extendObservable)(this,{useWebXR:!1}),Cesium.xbsjInstallWebXR&&Cesium.xbsjInstallWebXR(e.czm.viewer).then((()=>{e.czm.viewer.gvolUseWebXRChanged&&this.disposers.push(e.czm.viewer.gvolUseWebXRChanged.addEventListener((e=>{this.useWebXR=e})))})),this.disposers.push((0,P.intercept)(this,"useWebXR",(t=>{if(void 0===e.czm.viewer.gvolUseWebXR&&Cesium.xbsjInstallWebXR&&(Cesium.xbsjInstallWebXR(e.czm.viewer).then((()=>{e.czm.viewer.gvolUseWebXRChanged&&this.disposers.push(e.czm.viewer.gvolUseWebXRChanged.addEventListener((e=>{this.useWebXR=e})))})),Ua.log("载入vr插件成功，但是需要再次点击按钮启动VR！")),void 0!==e.czm.viewer.gvolUseWebXR)return t.newValue!==e.czm.viewer.gvolUseWebXR?void(e.czm.viewer.gvolUseWebXR=t.newValue):t}))),this.disposers.push((0,P.reaction)((()=>this.fov),(()=>{e.czm.camera.frustum.fov!==this.fov&&(e.czm.camera.frustum.fov=this.fov)})))}get immersion(){return this._gvolCameraImmersion}get viewport(){return this._viewport}get navigator(){return this._navigator}get interaction(){return this._interaction}flyTo(e,t,i,r){let n=this._earth.czm.camera;return Na(n,e,t,i,r)}flyAround(e,t,i,r=3,n=Math.PI/10){let o=this._earth.czm.camera;return void 0===t&&(t=ei.distance(this.position,e)),ka(o,e,t,i,r,n)}get isCameraLike(){return!0}get CameraHeight(){return this._cameraHeight}destroy(){return super.destroy()}}ja.Immersion=xa,ja.Viewport=Ma,ja.Navigator=Oa,ja.Interaction=La,ja.defaultOptions={fov:60*Math.PI/180};const Ga=ja;function za(e,t,i,r,n){if(t instanceof w.Z&&i instanceof Cesium.Cesium3DTileFeature&&!i.tileset.isDestroyed()&&!i._content.isDestroyed()){const o=i.getProperty("id"),s=t._tileset;if(e.tileset===s&&e.getProperty("id")===o)return n||(n=new Cesium.Color),n.red=r[0],n.green=r[1],n.blue=r[2],n.alpha=r[3],n}}const Ya=function(e){const t=new Cesium.Cesium3DTileStyle({});return t.color={evaluateColor:(t,i)=>{const r=t&&t.tileset&&t.tileset.gvolTileset;if(r){if(r._clickedAttachedInfo&&za(t,r,r._clickedAttachedInfo,e.clickedColor,i))return i;if(r._hoveredAttachedInfo&&za(t,r,r._hoveredAttachedInfo,e.hoveredColor,i))return i}return Cesium.Color.clone(Cesium.Color.WHITE,i)}},t};class Za extends h.Z{constructor(e){super(),this._earth=e,this._observer=void 0,this._mouseMoveSource$=void 0,(0,P.extendObservable)(this,{enabled:!1,shouldEnabled:!0}),(0,P.extendObservable)(this,{_hoveredObj:void 0,_hoveredAttachedInfo:void 0,_clickedObj:void 0,_clickedAttachedInfo:void 0,get hoveredObj(){return this._hoveredObj},get hoveredAttachedInfo(){return this._hoveredAttachedInfo},get clickedObj(){return this._clickedObj},get clickedAttachedInfo(){return this._clickedAttachedInfo}},{_hoveredObj:P.observable.ref,_hoveredAttachedInfo:P.observable.ref,_clickedObj:P.observable.ref,_clickedAttachedInfo:P.observable.ref,hoveredObj:P.computed,hoveredAttachedInfo:P.computed,clickedObj:P.computed,clickedAttachedInfo:P.computed}),(0,P.extendObservable)(this,{_hoveredPickedObj:void 0,_clickedPickedObj:void 0,get hoveredPickedObj(){return this._hoveredPickedObj},get clickedPickedObj(){return this._clickedPickedObj}},{_hoveredPickedObj:P.observable.ref,_clickedPickedObj:P.observable.ref}),this.disposers.push((0,P.autorun)((()=>{this.enabled&&this.shouldEnabled?this._start():this._cancel()}))),this._defaultTilesetPickingStyle=Ya(this)}_start(){this.enabled&&this.shouldEnabled&&(this._mouseMoveSource$=this._mouseMoveSource$||this._earth.eventSource.mouse.mouseMove,this._mouseMoveSubscription=this._mouseMoveSource$.subscribe(this._onMouseMove.bind(this)),this._leftClickSource$=this._leftClickSource$||this._earth.eventSource.mouse.get("LEFT_CLICK"),this._leftClickSubscription=this._leftClickSource$.subscribe(this._onLeftClick.bind(this)))}_pickFunc(e,t,i,r,n,o=!1){const s=function(e){if(e)return e.primitive&&e.primitive.gvolTileset&&e.primitive.gvolTileset.allowPicking?e.primitive.gvolTileset:e.id&&e.id instanceof Cesium.Entity&&e.id._gvolOwner?e.id._gvolOwner:e.id&&e.id.allowPicking&&"function"==typeof e.id.onclick&&"function"==typeof e.id.onmouseover?e.id:void 0}(e);s?s===this[t]&&e===this[i]?o&&u.Z.hierachyExec(this[t],r,this[i]):(this[t]&&this[i]&&u.Z.hierachyExec(this[t],n,this[i]),this[i]=void 0,this[t]=void 0,this[i]=e,this[t]=s,u.Z.hierachyExec(this[t],r,this[i])):(this[t]&&this[i]&&u.Z.hierachyExec(this[t],n,this[i]),this[i]=void 0,this[t]=void 0)}_onMouseMove(e){if(this.hoverEnable){const t=this._earth.czm.scene.pick(e.endPosition);this._pickFunc(t,"_hoveredObj","_hoveredAttachedInfo","onmouseover","onmouseout"),this._hoveredPickedObj=t}}_onLeftClick(e){const t=this._earth.czm.scene.pick(e.position);this._pickFunc(t,"_clickedObj","_clickedAttachedInfo","onclick","onclickout",!0),this._clickedPickedObj=t}_cancel(){this.enabled&&this.shouldEnabled||(this._mouseMoveSubscription=this._mouseMoveSubscription&&this._mouseMoveSubscription.unsubscribe(),this._leftClickSubscription=this._leftClickSubscription&&this._leftClickSubscription.unsubscribe(),this._pickFunc(void 0,"_hoveredObj","_hoveredAttachedInfo","onmouseover","onmouseout"),this._pickFunc(void 0,"_clickedObj","_clickedAttachedInfo","onclick","onclickout",!0))}destroy(){return this._cancel(),this._mouseMoveSource$=void 0,super.destroy()}}Za.defaultOptions={hoverEnable:!0,clickedColor:[1,0,0,1],hoveredColor:[1,1,0,1]},Za.registerPickingParent=Ko.Z;const Wa=Za;const Xa=class{constructor(e,t){this._earth=e,(0,P.extendObservable)(this,{enabled:!1,_currentStep:-1,get currentStep(){return this._currentStep},get lastStep(){return this._currentStep===this._stepObservables.length},get status(){return this.enabled?"running":-1===this._currentStep?"inital":this._currentStep===this._stepObservables.length?"completed":"cancelled"}},{currentStep:P.computed,lastStep:P.computed,status:P.computed}),this._stepSwitchObserver=void 0;const i=new rxjs.Observable((e=>{this._stepSwitchObserver=e})).pipe(rxjs.operators.map((e=>(this._currentStep=e,e))),rxjs.operators.share());this._stepObservables=t.map((e=>{const t=e.length/2,i=[];for(let r=0;r<t;++r)i.push(e[2*r+0].pipe(rxjs.operators.map(e[2*r+1])));return rxjs.merge(...i)})),this._steps$=i.pipe(rxjs.operators.switchMap((e=>this._stepObservables[e]))),this._disposers=this._disposers||[],this._disposers.push((0,P.observe)(this,"enabled",(e=>{e.newValue&&this._start()}))),this._disposers.push((0,P.intercept)(this,"enabled",(e=>(e.newValue||this._cancel(),e))))}goto(e){e>=0&&e<this._stepObservables.length&&this._stepSwitchObserver.next(e)}next(){this._currentStep+1<this._stepObservables.length?this._stepSwitchObserver.next(this._currentStep+1):(this._currentStep=this._stepObservables.length,this.enabled=!1)}prev(){if(!(this._currentStep>0))throw new Error("steps wrong!");this._stepSwitchObserver.next(this._currentStep-1)}_start(){this._subscription||(this._subscription=this._steps$.subscribe(),this._stepSwitchObserver.next(0))}_cancel(){this._subscription&&(this._subscription.unsubscribe(),this._subscription=void 0)}destroy(){this.enabled=!1,this._disposers.forEach((e=>e())),this._disposers.length=0}};class Ja extends h.Z{constructor(e){super(),this._earth=e,this._steps=void 0,this.disposers.push((()=>this._steps=this._steps&&this._steps.destroy())),this.disposers.push((0,P.observe)(this,"enabled",(e=>{e.newValue&&this._start()}))),this.disposers.push((0,P.intercept)(this,"enabled",(e=>(e.object.value===e.newValue||e.newValue||this._cancel(),e))))}get steps(){return this._steps||this._init(),this._steps}_init(){throw new Error("需要具体实现")}_start(){throw new Error("需要具体实现")}_cancel(){throw new Error("需要具体实现")}destroy(){return super.destroy()}}Ja.defaultOptions={enabled:!1},Ja.enableProperty=function(e,t){e.enabled=!0;const i=(0,P.intercept)(e,(e=>{if("enabled"===e.name&&"update"===e.type){if(e.newValue)throw new Error("changed.newValue should not be true or defined!");return t(),null}return e}));return()=>{if(!i)throw new Error("beforeDisabledDisposer should exits!");i(),e.enabled=!1}};const Ka=Ja;const Va=class extends Ka{constructor(e){super(e),(0,P.extendObservable)(this,{position:[0,0,0]}),this._points=new Ti.Z(e),this._points.points.push({}),this._points.points[0].color.splice(0,4,1,1,0,1),this.disposers.push((()=>this._points=this._points&&this._points.destroy())),this.disposers.push((0,P.autorun)((()=>{if(this.position&&this.enabled){const e=this._points.points[0];this.position.forEach(((t,i)=>e.position[i]=t)),this._points.show=!0}else this._points.show=!1})))}_init(){this.mouseMove$=this.mouseMove$||this._earth.eventSource.mouse.mouseMovePickedPosition,this.leftClick$=this.leftClick$||this._earth.eventSource.mouse.leftClickPickedPosition,this.rightClick$=this.rightClick$||this._earth.eventSource.mouse.rightClick,this._stepsOp=this._stepsOp||[[this.mouseMove$,({position:e})=>{e&&e.forEach(((e,t)=>this.position[t]=e))},this.leftClick$,({position:e})=>{e&&(e.forEach(((e,t)=>this.position[t]=e)),this._steps.next())},this.rightClick$,()=>{this._steps.enabled=!1}]],this._steps||(this._steps=new Xa(this._earth,this._stepsOp))}_start(){if(this._init(),this._steps.enabled)throw new Error("_disableSteps should be undefined!");this._disableSteps=Ka.enableProperty(this._steps,(()=>this.enabled=!1))}_cancel(){this._disableSteps=this._disableSteps&&this._disableSteps()}destroy(){return this.enabled=!1,super.destroy()}};class qa extends h.Z{constructor(e){super(),this._earth=e,(0,P.extendObservable)(this,{target:void 0},{target:P.observable.ref}),this._untargetWhenDestroying=void 0,this.disposers.push((0,P.observe)(this,"target",(e=>{if(e.newValue){const t=e.newValue;if(this._untargetWhenDestroying)throw new Error("_untargetWhenDestroying should not be defined!");this._untargetWhenDestroying=(0,P.reaction)((()=>t.isDestroying),(e=>{e&&(this.target=void 0)})),this._start(t)}}))),this.disposers.push((0,P.intercept)(this,"target",(e=>(e.object.value!==e.newValue&&(this._untargetWhenDestroying=this._untargetWhenDestroying&&this._untargetWhenDestroying(),this._cancel()),e))))}_init(){throw new Error("需要具体实现")}_start(){throw new Error("需要具体实现")}_cancel(){throw new Error("需要具体实现")}destroy(){return super.destroy()}}qa.targetProperty=function(e,t,i){e.target=t;const r=(0,P.intercept)(e,(e=>{if("target"===e.name&&"update"===e.type){if(e.newValue){if(!Array.isArray(e.newValue))throw new Error("changed.newValue should not be true or defined!");return e}return i(),null}return e}));return()=>{if(!r)throw new Error("beforeTargetUndefinedDisposer should exits!");r(),e.target=void 0}};const $a=qa;const el=class extends $a{constructor(e){super(e),this.target=void 0,this.disposers.push((()=>this.target=void 0)),this._positionPicking=new Va(e),this.disposers.push((()=>this._positionPicking=this._positionPicking&&this._positionPicking.destroy()))}_start(e){if(this._disableProperty)throw new Error("_disableProperty should not be defined!");const t=[...e.position],i=(0,O.Z)(this._positionPicking,"position",e,"position"),r=Ka.enableProperty(this._positionPicking,(()=>{this._positionPicking.steps.lastStep||this._positionPicking.position.splice(0,3,...t),this.target=void 0}));this._disableProperty=()=>{r(),i()}}_cancel(){this._disableProperty=this._disableProperty&&this._disableProperty()}get positionPicking(){return this._positionPicking}destroy(){return super.destroy()}};var tl=i(5108);function il(e,t){e[0]=t[0],e[1]=t[1],e[2]=t[2]}const rl=class extends Ka{constructor(e){super(e),(0,P.extendObservable)(this,{position0:void 0,position1:void 0}),this._points=new Ti.Z(e),this.disposers.push((()=>this._points=this._points&&this._points.destroy())),this._points.points.push({}),this._points.points.push({}),this._polylineArrow=new Si.Z(e),this.disposers.push((()=>this._polylineArrow=this._polylineArrow&&this._polylineArrow.destroy())),this._polylineArrow.material={type:"XbsjPolylineArrowMaterial",XbsjPolylineArrowMaterial:{color:[1,1,0,1]}},this._polylineArrow.depthTest=!1,this._polylineArrow.width=20,this._polylineArrow.positions.push([0,0,0]),this._polylineArrow.positions.push([0,0,0]),this.disposers.push((0,P.autorun)((()=>{this.position0&&this.enabled?(this._points.points[0].show=!0,il(this._points.points[0].position,this.position0)):this._points.points[0].show=!1,this.position1&&this.enabled?(this._points.points[1].show=!0,il(this._points.points[1].position,this.position1)):this._points.points[1].show=!1,this.position0&&this.position1&&this.enabled?(this._polylineArrow.show=!0,il(this._polylineArrow.positions[0],this.position0),il(this._polylineArrow.positions[1],this.position1)):this._polylineArrow.show=!1})))}_init(){this.mouseMove$=this.mouseMove$||this._earth.eventSource.mouse.mouseMovePickedPosition,this.leftClick$=this.leftClick$||this._earth.eventSource.mouse.leftClickPickedPosition,this.rightClick$=this.rightClick$||this._earth.eventSource.mouse.rightClick,this._stepsOp=this._stepsOp||[[this.mouseMove$,({position:e})=>{e&&(this.position0=this.position0||[0,0,0],il(this.position0,e))},this.leftClick$,({position:e})=>{e&&(this.position0=this.position0||[0,0,0],il(this.position0,e),this._steps.next())},this.rightClick$,e=>{this._steps.enabled=!1}],[this.mouseMove$,({position:e})=>{e&&(this.position1=this.position1||[0,0,0],il(this.position1,e))},this.leftClick$,({position:e})=>{e&&(this.position1=this.position1||[0,0,0],il(this.position1,e),this._steps.next())},this.rightClick$,e=>{tl.log("rightClick 0"),this.position1=void 0,this._steps.prev()}]],this._steps||(this._steps=new Xa(this._earth,this._stepsOp))}_start(){if(this._init(),this.position0=void 0,this.position1=void 0,this._disableSteps)throw new Error("_disableSteps should be undefined!");this._disableSteps=Ka.enableProperty(this._steps,(()=>this.enabled=!1))}_cancel(){this._disableSteps=this._disableSteps&&this._disableSteps()}destroy(){return this.enabled=!1,super.destroy()}};const nl=class extends $a{constructor(e){super(e),this.target=void 0,this.disposers.push((()=>this.target=void 0)),this._falseCamera=new Cesium.Camera(this._earth.czm.scene),this._directionEditing=new rl(e),this.disposers.push((()=>this._directionEditing=this._directionEditing&&this._directionEditing.destroy()))}_start(e){if(this._disabledProperty)throw new Error("_disabledProperty should not be defined!");const t=e.far,i=[...e.position],r=[...e.rotation],n=(0,P.reaction)((()=>({pos0:this._directionEditing.position0?[...this._directionEditing.position0]:void 0,pos1:this._directionEditing.position1?[...this._directionEditing.position1]:void 0})),(({pos0:t,pos1:i})=>{t&&i&&this._updateCameraLike(t,i,e)})),o=Ka.enableProperty(this._directionEditing,(()=>{this._directionEditing.steps.lastStep||(e.far=t,e.position=i,e.rotation=r),this.target=void 0}));this._disabledProperty=()=>{o(),n()}}_cancel(){this._disabledProperty=this._disabledProperty&&this._disabledProperty()}_updateCameraLike(e,t,i){this._scratchPos0=this._scratchPos0||new Cesium.Cartesian3,this._scratchPos1=this._scratchPos1||new Cesium.Cartesian3,this._scratchUp=this._scratchUp||new Cesium.Cartesian3,this._scratchDir=this._scratchDir||new Cesium.Cartesian3;const r=Cesium.Cartesian3.fromRadians(...e,void 0,this._scratchPos0),n=Cesium.Cartesian3.fromRadians(...t,void 0,this._scratchPos1),o=Cesium.Cartesian3.distance(r,n);i.far=Math.max(o,i.near+.01),i.position=[...e];let s=Cesium.Cartesian3.subtract(n,r,this._scratchDir);s=Cesium.Cartesian3.normalize(s,s);let a=Cesium.Cartesian3.normalize(r,this._scratchUp);a=Cesium.Cartesian3.normalize(a,a),this._falseCamera&&this._falseCamera.setView({destination:r,orientation:{direction:s,up:a}}),i.rotation=[this._falseCamera.heading,this._falseCamera.pitch,this._falseCamera.roll]}destroy(){return super.destroy()}};let ol,sl,al,ll;const hl=function(e,t,i,r){ol=ol||new Cesium.BoundingSphere,sl=sl||new Cesium.Cartesian3,al=al||new Cesium.Ray,ll=ll||new Cesium.Cartographic;const n=e.camera.getPickRay(t,al),o=ol;o.radius=i;const s=Cesium.IntersectionTests.raySphere(n,o);if(s){const e=s.start>0?s.start:s.end;if(e){const t=Cesium.Ray.getPoint(n,e,sl),i=Cesium.Cartographic.fromCartesian(t,void 0,ll);return r||(r=[0,0,0]),r[0]=i.longitude,r[1]=i.latitude,r[2]=i.height,r}}else;};let cl,ul,pl,dl,ml,fl,gl;const Al=function(e,t,i,r){cl=cl||new Cesium.BoundingSphere,ul=ul||new Cesium.Cartesian3,pl=pl||new Cesium.Cartesian3,dl=dl||new Cesium.Cartesian3,ml=ml||new Cesium.Ray,fl=fl||new Cesium.Cartographic,gl=gl||new Cesium.Plane(Cesium.Cartesian3.UNIT_X,0);const n=Cesium.Cartesian3.fromRadians(...t,void 0,ul),o=Cesium.Cartesian3.normalize(n,pl),s=Cesium.Cartesian3.cross(e.camera.right,o,pl);Cesium.Cartesian3.normalize(s,s);const a=Cesium.Plane.fromPointNormal(n,s,gl),l=e.camera.getPickRay(i,ml),h=Cesium.IntersectionTests.rayPlane(l,a,dl);if(!h)return;const c=Cesium.Cartographic.fromCartesian(h,void 0,fl);return r||(r=[0,0,0]),r[0]=c.longitude,r[1]=c.latitude,r[2]=c.height,r};const yl=class extends Ka{constructor(e){super(),this._earth=e,(0,P.extendObservable)(this,{position:[0,0,0],scale:1,fixScreenSize:100,toleranceSize:6,xAxisActive:!1,yAxisActive:!1,zAxisActive:!1,xEnabled:!0,yEnabled:!0,zEnabled:!0,skipFirstStepForZ:!1}),this.onlyOnce=!1,this._centerCartesian=new Cesium.Cartesian3,this._radius=6378137,this.disposers.push((0,P.autorun)((()=>{this._centerCartesian=Cesium.Cartesian3.fromRadians(...this.position,void 0,this._centerCartesian),this._radius=Cesium.Cartesian3.magnitude(this._centerCartesian)}))),(0,P.extendObservable)(this,{_realSceneScale:1,_oldPosition:[0,0,0],_originPosition:[0,0,0],_originPosition2:[0,0,0]}),this.disposers.push(cr(this._earth,this)),this._createCoordinates(),this._createHelperPolyline(),this._createXYPlane()}_createXYPlane(){this._xyPlane=new Si.Z(this._earth),this._xyPlane.arcType="RHUMB",this._xyPlane.material={type:"XbsjPolylineDashMaterial",XbsjPolylineDashMaterial:{color:[1,1,0,1]}},this._xyPlane.positions=[[0,0,0],[0,0,0],[0,0,0]],this.disposers.push((()=>{this._xyPlane=this._xyPlane&&this._xyPlane.destroy()})),this.disposers.push((0,P.autorun)((()=>{const e=this.steps.currentStep,t=this.position,i=this._originPosition,r=this._originPosition2,n=e>0?r:i;this._xyPlane.show=this.steps.enabled&&this.position&&this.xAxisActive&&this.yAxisActive,this._xyPlane.positions[0].splice(0,3,n[0],t[1],t[2]),this._xyPlane.positions[1].splice(0,3,n[0],n[1],t[2]),this._xyPlane.positions[2].splice(0,3,t[0],n[1],t[2])})))}_createCoordinates(){this._coordinates=new fr(this._earth),this.disposers.push((()=>{this._coordinates=this._coordinates&&this._coordinates.destroy()})),this.disposers.push((0,O.Z)(this._coordinates,"show",this,"enabled")),this.disposers.push((0,O.Z)(this._coordinates,"xShow",this,"xEnabled")),this.disposers.push((0,O.Z)(this._coordinates,"yShow",this,"yEnabled")),this.disposers.push((0,O.Z)(this._coordinates,"zShow",this,"zEnabled")),this.disposers.push((0,O.Z)(this._coordinates,"position",this,"position")),this.disposers.push((0,O.Z)(this._coordinates,"scale",this,"_realSceneScale")),this.disposers.push((0,O.Z)(this._coordinates,"xAxisActive",this,"xAxisActive")),this.disposers.push((0,O.Z)(this._coordinates,"yAxisActive",this,"yAxisActive")),this.disposers.push((0,O.Z)(this._coordinates,"zAxisActive",this,"zAxisActive"))}_createHelperPolyline(){this._helperPolyline=new Si.Z(this._earth),this._helperPolyline.arcType="RHUMB",this._helperPolyline.material={type:"XbsjPolylineDashMaterial",XbsjPolylineDashMaterial:{color:[1,1,0,1]}},this._helperPolyline.positions=[[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0]],this.disposers.push((()=>{this._helperPolyline=this._helperPolyline&&this._helperPolyline.destroy()})),this.disposers.push((0,P.autorun)((()=>{const e=this.steps.currentStep,t=[...this._oldPosition],i=[...this.position];this._helperPolyline.show=this.steps.enabled&&e>0&&this._oldPosition&&(this.xAxisActive||this.yAxisActive||this.zAxisActive),this._helperPolyline.positions[0].splice(0,3,t[0],t[1],i[2]),this._helperPolyline.positions[1].splice(0,3,i[0],t[1],i[2]),this._helperPolyline.positions[2].splice(0,3,i[0],i[1],i[2]),this._helperPolyline.positions[3].splice(0,3,t[0],i[1],i[2]),this._helperPolyline.positions[4].splice(0,3,t[0],t[1],i[2]),this._helperPolyline.positions[5].splice(0,3,t[0],t[1],t[2])})))}_createMouseMove$(){const e=this._earth.eventSource;let t={x:0,y:0};return rxjs.merge(e.mouse.mouseMove,e.cameraChanged.pipe(rxjs.operators.throttleTime(100))).pipe(rxjs.operators.map((e=>e&&e.endPosition?(t.x=e.endPosition.x,t.y=e.endPosition.y,e.endPosition):t)))}_init(){this.mouseMove$=this.mouseMove$||this._createMouseMove$(),this.leftClick$=this.leftClick$||this._earth.eventSource.mouse.leftClick,this.rightClick$=this.rightClick$||this._earth.eventSource.mouse.rightClick,this._oldPosition=this._oldPosition||[0,0,0],this._oldScale=1,this._originHeightPosition=this._originHeightPosition||[0,0,0],this._originHeightPosition2=this._originHeightPosition2||[0,0,0];const e=this._earth.czm.scene;this._stepsOp=this._stepsOp||[[this.mouseMove$,t=>{this._step1(e,t)},this.leftClick$,({position:t})=>{this._step1(e,t),(this.xAxisActive||this.yAxisActive||this.zAxisActive)&&(this._oldPosition.splice(0,3,...this.position),this._oldScale=this._realSceneScale,this._step2(e,t),this._steps.next())},this.rightClick$,()=>{this._steps.enabled=!1}],[this.mouseMove$,t=>{this._step2(e,t)},this.leftClick$,({position:t})=>{this._step2(e,t),this.xAxisActive=!1,this.yAxisActive=!1,this.zAxisActive=!1,this.onlyOnce?this._steps.next():this._steps.goto(0)},this.rightClick$,()=>{this.position.splice(0,3,...this._oldPosition),this._steps.enabled=!1}]],this._steps||(this._steps=new Xa(this._earth,this._stepsOp))}_step2(e,t){const i=this._realSceneScale/this._oldScale;(this.xAxisActive||this.yAxisActive)&&hl(e,t,this._radius,this._originPosition2)&&(this.xAxisActive&&(this.position[0]=this._oldPosition[0]+(this._originPosition2[0]-this._originPosition[0])+(this._originPosition[0]-this._oldPosition[0])*(1-i)),this.yAxisActive&&(this.position[1]=this._oldPosition[1]+(this._originPosition2[1]-this._originPosition[1])+(this._originPosition[1]-this._oldPosition[1])*(1-i))),this.zAxisActive&&Al(e,this._oldPosition,t,this._originHeightPosition2)&&(this.position[2]=this._oldPosition[2]+(this._originHeightPosition2[2]-this._originHeightPosition[2])+(this._originHeightPosition[2]-this._oldPosition[2])*(1-i))}skipFirstStep({xAxisActive:e=!1,yAxisActive:t=!1,zAxisActive:i=!1}={}){this._oldPosition.splice(0,3,...this.position),this._originHeightPosition.splice(0,3,...this.position),this._originPosition.splice(0,3,...this.position),this.xAxisActive=e,this.yAxisActive=t,this.zAxisActive=i,this._steps.goto(1)}_step1(e,t){if(Al(e,this.position,t,this._originHeightPosition)){const e=Math.abs(this._originHeightPosition[0]-this.position[0]),t=Math.abs(this._originHeightPosition[1]-this.position[1]),i=this._originHeightPosition[2]-this.position[2],r=this._realSceneScale/this.fixScreenSize*10/this._radius;e<r/Math.cos(this.position[1])&&t<r&&i>0&&i<this._realSceneScale?this.zAxisActive=this.zEnabled:this.zAxisActive=!1}if(this.zAxisActive)return this.xAxisActive=!1,void(this.yAxisActive=!1);if(void 0!==hl(e,t,this._radius,this._originPosition)){const e=this._originPosition[0]-this.position[0],t=this._originPosition[1]-this.position[1],i=this._realSceneScale/this.fixScreenSize*10/this._radius,r=e>i&&e<this._realSceneScale/(this._radius*Math.cos(this.position[1])),n=t>i/Math.cos(this.position[1])&&t<this._realSceneScale/this._radius;r&&n?(this.xAxisActive=this.xEnabled,this.yAxisActive=this.yEnabled):(this.xAxisActive=this.xEnabled&&Math.abs(t)<i&&r,this.yAxisActive=this.yEnabled&&Math.abs(e)<i/Math.cos(this.position[1])&&n)}}_start(){if(this._init(),this._stepsDisable)throw new Error("_stepsDisable should not exists!");this._stepsDisable=Ka.enableProperty(this._steps,(()=>this.enabled=!1)),this.skipFirstStepForZ&&this.skipFirstStep({zAxisActive:!0})}_cancel(){this._stepsDisable=this._stepsDisable&&this._stepsDisable()}destroy(){return this.enabled=!1,super.destroy()}};const vl=class extends $a{constructor(e){super(e),this.target=void 0,this.disposers.push((()=>this.target=void 0)),this._coordinatesMove=new yl(e),this.disposers.push((()=>{this._coordinatesMove=this._coordinatesMove&&this._coordinatesMove.destroy()}))}_start(e){if(this._disableMoving)throw new Error("_disableMoving should not be true!");const t=(0,O.Z)(this._coordinatesMove,"position",e,"position"),i=Ka.enableProperty(this._coordinatesMove,(()=>this.target=void 0));this._disableMoving=()=>{i&&i(),t&&t()}}_cancel(){this._disableMoving=this._disableMoving&&this._disableMoving()}get coordinatesMove(){return this._coordinatesMove}destroy(){return super.destroy()}};let Cl,_l;const bl=function(e,t,i,r,n){n=n||new Cesium.Cartesian3,Cl=Cl||new Cesium.Ray,_l=_l||new Cesium.Plane(Cesium.Cartesian3.UNIT_X,0);const o=e.camera.getPickRay(r,Cl),s=Cesium.Plane.fromPointNormal(t,i,_l);return n=Cesium.IntersectionTests.rayPlane(o,s,n)};class wl extends h.Z{constructor(e){super(e),this._primitive=new bn(e),this.disposers.push((()=>{this._primitive=this._primitive&&this._primitive.destroy()})),this._primitive.modelMatrix=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];{const e=this._primitive;e.positions=[-1,-1,0,1,-1,0,1,1,0,-1,1,0],e.sts=[0,0,1,0,1,1,0,1],e.indices=[0,1,2,0,2,3],e.renderState=GVOL.Obj.CustomPrimitive.getRenderState(!0,!1),e.renderState.depthTest.enabled=!1,e.pass=8}this._texture=new Cesium.Texture({context:e.czm.scene.context,width:256,height:256,source:void 0,flipY:!1}),this._primitive.texture=this._texture,this.disposers.push((()=>{this._texture=this._texture&&this._texture.destroy(),this._primitive.texture=void 0}));const t=document.createElement("canvas");t.width=256,t.height=256,this._canvas=t,this._ctx=t.getContext("2d"),(0,P.extendObservable)(this,{modelMatrix:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],scale:1,show:!0,color:[1,1,0,1],baseRotation:0,rotation:0,startRotation:0,endRotation:0}),this._scratchMatrix=new Cesium.Matrix4,this._scratchMatrix2=new Cesium.Matrix4,this._scratchMatrix3=new Cesium.Matrix4;const i=()=>{const e=Cesium.Matrix4.fromUniformScale(this.scale,this._scratchMatrix),t=Cesium.Matrix4.fromColumnMajorArray(this.modelMatrix,this._scratchMatrix2),i=Cesium.Matrix4.multiply(t,e,this._scratchMatrix3);Cesium.Matrix4.toArray(i,this._primitive.modelMatrix)};i(),this.disposers.push((0,P.reaction)((()=>({modelMatrix:[...this.modelMatrix],scale:this.scale})),i));const r=()=>{this._primitive.show=this.show};r(),this.disposers.push((0,P.reaction)((()=>({show:this.show})),r));const n=()=>{const e=this._ctx,t=this.color,i=`rgba(${255*t[0]|0}, ${255*t[1]|0}, ${255*t[2]|0}, ${t[3]})`;e.clearRect(0,0,256,256),e.lineWidth=6,e.beginPath(),e.arc(128,128,64,0,2*Math.PI,!1),e.strokeStyle=`rgba(0, 0, 0, ${t[3]})`,e.stroke(),e.lineWidth=4,e.beginPath(),e.arc(128,128,64,0,2*Math.PI,!1),e.strokeStyle=i,e.stroke();{e.lineWidth=1,e.beginPath();let t=Cesium.Math.zeroToTwoPi(this.startRotation),i=Cesium.Math.zeroToTwoPi(this.endRotation);i<t&&(i+=2*Math.PI),this.startRotation===this.endRotation&&0===this.startRotation||(e.moveTo(128,128),e.arc(128,128,64,t,i,i-t>Math.PI),e.lineTo(128,128),e.strokeStyle="rgba(255, 255, 0, 1.0)",e.stroke())}let r=Cesium.Math.negativePiToPi(this.rotation);const n=this.baseRotation;e.lineWidth=3,e.beginPath(),e.moveTo(128,128),e.arc(128,128,64,n,r,Cesium.Math.negativePiToPi(r-n)<0),e.lineTo(128,128),e.fillStyle=`rgba(${255*t[0]|0}, ${255*t[1]|0}, ${255*t[2]|0}, 0.5)`,e.fill();{e.save(),e.font="16px console",e.textBaseline="middle";const t=-((180*Cesium.Math.negativePiToPi(r-n)/Math.PI*10|0)/10)+"°";var o=e.measureText(t).width;e.translate(128,128),e.rotate(.5*Math.PI),r=Cesium.Math.negativePiToPi(r-n)+n,e.rotate(.5*(r+n)),e.scale(-1,1),e.translate(-128,-128),e.fillStyle="white",e.fillText(t,128-.5*o,54),e.lineWidth=1,e.restore()}this._texture.copyFrom(this._canvas)};n(),this.disposers.push((0,P.reaction)((()=>({color:[...this.color],rotation:this.rotation,startRotation:this.startRotation,endRotation:this.endRotation,baseRotation:this.baseRotation})),n))}}const Pl=wl;const Sl=class extends Ka{constructor(e){super(e),(0,P.extendObservable)(this,{position:[0,0,0],rotation:[0,0,0],scale:1,fixScreenSize:100,toleranceSize:6,headingCircleActive:!1,pitchCircleActive:!1,rollCircleActive:!1,headingEnabled:!0,pitchEnabled:!0,rollEnabled:!0}),(0,P.extendObservable)(this,{_oldRotation:[0,0,0],_startRotation:[0,0,0],_endRotation:[0,0,0]}),(0,P.extendObservable)(this,{isCameraLike:!1}),this._centerCartesian=new Cesium.Cartesian3,this._enu=new Cesium.Matrix4,this._enuChangedEvent=new Cesium.Event;const t=e=>{this._centerCartesian=Cesium.Cartesian3.fromRadians(...e,void 0,this._centerCartesian),this._enu=Cesium.Transforms.eastNorthUpToFixedFrame(this._centerCartesian,void 0,this._enu),this._enuChangedEvent.raiseEvent()};t(this.position),this.disposers.push((0,P.reaction)((()=>({enabled:this.enabled,position:[...this.position]})),(({enabled:e,position:i})=>{e&&t(i)}))),(0,P.extendObservable)(this,{_realSceneScale:1}),this.disposers.push(cr(this._earth,this)),this._createDirections(),this._createBaseCircles(),this._createCenterModel()}_createDirections(){this._originHeadingDirection=new Cesium.Cartesian3(1,0,0),this._originHeadingUp=new Cesium.Cartesian3(0,0,-1),this._originPitchDirection=new Cesium.Cartesian3(1,0,0),this._originPitchUp=new Cesium.Cartesian3(0,-1,0),this._originRollDirection=new Cesium.Cartesian3(0,1,0),this._originRollUp=new Cesium.Cartesian3(1,0,0),this._headingDirection=new Cesium.Cartesian3(1,0,0),this._headingUp=new Cesium.Cartesian3(0,0,-1),this._pitchDirection=new Cesium.Cartesian3(1,0,0),this._pitchUp=new Cesium.Cartesian3(0,-1,0),this._rollDirection=new Cesium.Cartesian3(0,1,0),this._rollUp=new Cesium.Cartesian3(1,0,0),this._headingHpr=new Cesium.HeadingPitchRoll,this._pitchHpr=new Cesium.HeadingPitchRoll,this._rollHpr=new Cesium.HeadingPitchRoll,this._lastHpr=new Cesium.HeadingPitchRoll,this._headingQuat=new Cesium.Quaternion,this._pitchQuat=new Cesium.Quaternion,this._rollQuat=new Cesium.Quaternion,this._lastQuat=new Cesium.Quaternion,this._headingMat=new Cesium.Matrix3,this._pitchMat=new Cesium.Matrix3,this._rollMat=new Cesium.Matrix3,this._lastMat=new Cesium.Matrix3,this._headingMat4=new Cesium.Matrix4,this._pitchMat4=new Cesium.Matrix4,this._rollMat4=new Cesium.Matrix4,this._lastMat4=new Cesium.Matrix4;const e=()=>{this._pitchHpr.heading=this.rotation[0],this._rollHpr.heading=this.rotation[0],this._rollHpr.pitch=this.rotation[1],this._lastHpr.heading=this.rotation[0],this._lastHpr.pitch=this.rotation[1],this._lastHpr.roll=this.rotation[2],this._headingQuat=Cesium.Quaternion.fromHeadingPitchRoll(this._headingHpr,this._headingQuat),this._pitchQuat=Cesium.Quaternion.fromHeadingPitchRoll(this._pitchHpr,this._pitchQuat),this._rollQuat=Cesium.Quaternion.fromHeadingPitchRoll(this._rollHpr,this._rollQuat),this._lastQuat=Cesium.Quaternion.fromHeadingPitchRoll(this._lastHpr,this._lastQuat),this._headingMat=Cesium.Matrix3.fromQuaternion(this._headingQuat,this._headingMat),this._pitchMat=Cesium.Matrix3.fromQuaternion(this._pitchQuat,this._pitchMat),this._rollMat=Cesium.Matrix3.fromQuaternion(this._rollQuat,this._rollMat),this._lastMat=Cesium.Matrix3.fromQuaternion(this._lastQuat,this._lastMat),this._headingMat4=Cesium.Matrix4.multiplyByMatrix3(this._enu,this._headingMat,this._headingMat4),this._pitchMat4=Cesium.Matrix4.multiplyByMatrix3(this._enu,this._pitchMat,this._pitchMat4),this._rollMat4=Cesium.Matrix4.multiplyByMatrix3(this._enu,this._rollMat,this._rollMat4),this._lastMat4=Cesium.Matrix4.multiplyByMatrix3(this._enu,this._lastMat,this._lastMat4),Cesium.Matrix3.multiplyByVector(this._headingMat,this._originHeadingDirection,this._headingDirection),Cesium.Matrix3.multiplyByVector(this._headingMat,this._originHeadingUp,this._headingUp),Cesium.Matrix3.multiplyByVector(this._pitchMat,this._originPitchDirection,this._pitchDirection),Cesium.Matrix3.multiplyByVector(this._pitchMat,this._originPitchUp,this._pitchUp),Cesium.Matrix3.multiplyByVector(this._rollMat,this._originRollDirection,this._rollDirection),Cesium.Matrix3.multiplyByVector(this._rollMat,this._originRollUp,this._rollUp),Cesium.Matrix4.multiplyByPointAsVector(this._enu,this._headingDirection,this._headingDirection),Cesium.Matrix4.multiplyByPointAsVector(this._enu,this._headingUp,this._headingUp),Cesium.Matrix4.multiplyByPointAsVector(this._enu,this._pitchDirection,this._pitchDirection),Cesium.Matrix4.multiplyByPointAsVector(this._enu,this._pitchUp,this._pitchUp),Cesium.Matrix4.multiplyByPointAsVector(this._enu,this._rollDirection,this._rollDirection),Cesium.Matrix4.multiplyByPointAsVector(this._enu,this._rollUp,this._rollUp)};this.disposers.push((0,P.reaction)((()=>[...this.rotation]),(()=>{e()}))),this.disposers.push(this._enuChangedEvent.addEventListener((()=>{e()})))}_createCenterModel(){this._cameraHelper=new Ei(this._earth),this.disposers.push((()=>{this._cameraHelper=this._cameraHelper&&this._cameraHelper.destroy()})),this.disposers.push((0,P.reaction)((()=>({position:[...this.position],rotation:[...this.rotation]})),(()=>{this._cameraHelper.position=this.position,this._cameraHelper.rotation=[this.rotation[0]+Cesium.Math.PI_OVER_TWO,this.rotation[1],this.rotation[2]]}))),this.disposers.push((0,P.autorun)((()=>{this._cameraHelper.show=this.enabled})))}_createBaseCircles(){this._baseCircles=[...Array(3).keys()].map((e=>new Pl(this._earth))),this.disposers.push((()=>{this._baseCircles.forEach((e=>{e.destroy()})),this._baseCircles.length=0}));const e=[...Array(3).keys()].map((()=>new Cesium.Matrix4)),t=()=>{Cesium.Matrix4.clone(this._headingMat4,e[0]),Cesium.Matrix4.multiply(this._pitchMat4,Cesium.Axis.Y_UP_TO_Z_UP,e[1]),Cesium.Matrix4.multiply(this._rollMat4,Cesium.Axis.X_UP_TO_Z_UP,e[2]),Cesium.Matrix4.toArray(e[0],this._baseCircles[0].modelMatrix),Cesium.Matrix4.toArray(e[1],this._baseCircles[1].modelMatrix),Cesium.Matrix4.toArray(e[2],this._baseCircles[2].modelMatrix)};t(),this.disposers.push((0,P.reaction)((()=>[...this.rotation]),t)),this.disposers.push(this._enuChangedEvent.addEventListener(t)),this.disposers.push((0,P.autorun)((()=>{this._realSceneScale&&this._baseCircles.forEach((e=>e.scale=2*this._realSceneScale))})));let i=[[1,0,0,1],[0,1,0,1],[0,0,1,1]];const r=({actives:e})=>{this._baseCircles[0].baseRotation=this.isCameraLike?.5*Math.PI:0,this._baseCircles.forEach(((t,r)=>{const n=r%2==0?-1:1;if(e[r]){t.color.splice(0,4,1,1,0,1);let e=n*this._startRotation[r],i=n*this._endRotation[r];2===r&&(e+=.5*Math.PI,i+=.5*Math.PI),t.startRotation=e,t.endRotation=i}else t.color=[...i[r]],t.startRotation=0,t.endRotation=0;t.rotation=n*this.rotation[r]}))};r({actives:[this.headingCircleActive,this.pitchCircleActive,this.rollCircleActive]}),this.disposers.push((0,P.reaction)((()=>({actives:[this.headingCircleActive,this.pitchCircleActive,this.rollCircleActive],rotation:[...this.rotation],startRotation:[...this._startRotation],endRotation:[...this._endRotation]})),r));const n=()=>{this._baseCircles&&this._baseCircles.forEach((e=>e.show=this.enabled))};n(),this.disposers.push((0,P.reaction)((()=>this.enabled),n))}_init(){let e={x:0,y:0};const t=this._earth.eventSource;this.mouseMove$=this.mouseMove$||rxjs.merge(t.mouse.mouseMove,t.cameraChanged.pipe(rxjs.operators.throttleTime(100))).pipe(rxjs.operators.map((t=>t&&t.endPosition?(e.x=t.endPosition.x,e.y=t.endPosition.y,t.endPosition):e))),this.leftClick$=this.leftClick$||t.mouse.leftClick.pipe(rxjs.operators.map((e=>e.position))),this.rightClick$=this.rightClick$||t.mouse.rightClick;const i=this._earth.czm.scene;this._stepsOp=this._stepsOp||[[this.mouseMove$,e=>{this._step1(i,e)},this.leftClick$,e=>{this._step1(i,e),(this.headingCircleActive||this.pitchCircleActive||this.rollCircleActive)&&(this._oldRotation.splice(0,3,...this.rotation),this._step2(i,e),this._steps.next())},this.rightClick$,()=>{this._steps.enabled=!1}],[this.mouseMove$,e=>{this._step2(i,e)},this.leftClick$,e=>{this._step2(i,e),this.headingCircleActive=!1,this.pitchCircleActive=!1,this.rollCircleActive=!1,this._steps.goto(0)},this.rightClick$,()=>{this._steps.enabled=!1}]],this._steps||(this._steps=new Xa(this._earth,this._stepsOp))}_step2(e,t){const i=this._realSceneScale/this.fixScreenSize*this.toleranceSize;if(this.headingCircleActive){const r=this._getActiveAngle(e,t,i,this._headingUp,this._headingDirection,!0);void 0!==r&&(this._endRotation[0]=r,this.rotation[0]=Cesium.Math.negativePiToPi(this._endRotation[0]-this._startRotation[0]+this._oldRotation[0]))}else if(this.pitchCircleActive){const r=this._getActiveAngle(e,t,i,this._pitchUp,this._pitchDirection,!0);void 0!==r&&(this._endRotation[1]=r,this.rotation[1]=Cesium.Math.negativePiToPi(this._endRotation[1]-this._startRotation[1]+this._oldRotation[1]))}else if(this.rollCircleActive){const r=this._getActiveAngle(e,t,i,this._rollUp,this._rollDirection,!0);void 0!==r&&(this._endRotation[2]=r,this.rotation[2]=Cesium.Math.negativePiToPi(this._endRotation[2]-this._startRotation[2]+this._oldRotation[2]))}else;}_computeAngle(e,t,i){this._scratchComputeAngleDir1=this._scratchComputeAngleDir1||new Cesium.Cartesian3,this._scratchComputeAngleDir2=this._scratchComputeAngleDir2||new Cesium.Cartesian3,this._scrtachComputeAngleUp=this._scrtachComputeAngleUp||new Cesium.Cartesian3,e=Cesium.Cartesian3.normalize(e,this._scratchComputeAngleDir1),t=Cesium.Cartesian3.normalize(t,this._scratchComputeAngleDir2);let r=Math.acos(Cesium.Cartesian3.dot(e,t));const n=Cesium.Cartesian3.cross(e,t,this._scrtachComputeAngleUp);return Cesium.Cartesian3.dot(n,i)<0&&(r=-r),r}_getActiveAngle(e,t,i,r,n,o=!1){this._scratchUpdateActivesCartesian=this._scratchUpdateActivesCartesian||new Cesium.Cartesian3;const s=bl(e,this._centerCartesian,r,t,this._scratchUpdateActivesCartesian);if(s){const e=Cesium.Cartesian3.subtract(s,this._centerCartesian,s);if(o)return this._computeAngle(n,e,r);{const t=Cesium.Cartesian3.magnitude(e);if(Math.abs(t-this._realSceneScale)<i)return this._computeAngle(n,e,r)}}}_step1(e,t){const i=this._realSceneScale/this.fixScreenSize*this.toleranceSize;this.headingCircleActive=!1,this.pitchCircleActive=!1,this.rollCircleActive=!1;const r=this._getActiveAngle(e,t,i,this._headingUp,this._headingDirection,!1);if(void 0!==r)return this._startRotation[0]=r,this._endRotation[0]=r,void(this.headingCircleActive=!0);const n=this._getActiveAngle(e,t,i,this._pitchUp,this._pitchDirection,!1);if(void 0!==n)return this._startRotation[1]=n,this._endRotation[1]=n,void(this.pitchCircleActive=!0);const o=this._getActiveAngle(e,t,i,this._rollUp,this._rollDirection,!1);return void 0!==o?(this._startRotation[2]=o,this._endRotation[2]=o,void(this.rollCircleActive=!0)):void 0}_start(){if(this._init(),this._stepsDisable)throw new Error("_stepsDisable should not exists!");this._stepsDisable=Ka.enableProperty(this._steps,(()=>this.enabled=!1))}_cancel(){this._stepsDisable=this._stepsDisable&&this._stepsDisable()}destroy(){return this.enabled=!1,super.destroy()}};const xl=class extends $a{constructor(e){super(e),this.target=void 0,this.disposers.push((()=>this.target=void 0)),this._circlesRotating=new Sl(e),this.disposers.push((()=>this._circlesRotating=this._circlesRotating&&this._circlesRotating.destroy()))}_start(e){if(this._disableRotating)throw new Error("_disableRotating should not be true!");this._circlesRotating.isCameraLike=e.isCameraLike;const t=[];e.isCameraLike?(t.push((0,O.Z)(this._circlesRotating,"position",e,"position")),t.push((0,O.Z)(this._circlesRotating,"rotation",e,"rotation",{r1Tor2:(e,t)=>(t.splice(0,3,e[0]+.5*Math.PI,e[1],e[2]),t),r2Tor1:(e,t)=>(t.splice(0,3,e[0]-.5*Math.PI,e[1],e[2]),t),equals:(e,t)=>(0,Cesium.Math.equalsEpsilon)(e[0]+.5*Math.PI,t[0],0,Cesium.Math.EPSILON4)&&e[1]===t[1]&&e[2]===t[2]}))):(t.push((0,O.Z)(this._circlesRotating,"position",e,"position")),t.push((0,O.Z)(this._circlesRotating,"rotation",e,"rotation")));const i=Ka.enableProperty(this._circlesRotating,(()=>this.target=void 0));this._disableRotating=()=>{i&&i(),t.forEach((e=>e()))}}_cancel(){this._disableRotating=this._disableRotating&&this._disableRotating()}get editing(){return this._circlesRotating}destroy(){return super.destroy()}};class Bl extends Ka{constructor(e){super(e),(0,P.extendObservable)(this,{positions:[],rotations:void 0,loop:!1,fixedPositionsNum:void 0,polylineShow:!0}),this.disposers.push((0,P.intercept)(this,"positions",(e=>("update"===e.type&&this.positions.splice(0,this.positions.length,...e.newValue),null)))),this.disposers.push((0,P.intercept)(this.positions,(e=>{if("splice"===e.type&&this.rotations){const t=new Array(e.added.length).fill([0,0,0]);this.rotations.splice(e.index,e.removedCount,...t)}return e}))),this._createHelpers()}_createHelpers(){const e=this._earth;this._points=new Ti.Z(e),this.disposers.push((()=>this._points=this._points&&this._points.destroy())),this._points.forcePass=Cesium.Pass.OVERLAY,this._polyline=new Si.Z(e),this._polyline.material.XbsjColorMaterial.color.splice(0,4,1,1,0,1),this._polyline.depthTest=!1,this._polyline.material.type="XbsjColorMaterial",this._polyline.width=2,this.disposers.push((()=>this._polyline=this._polyline&&this._polyline.destroy())),this.disposers.push((0,O.j)(this._polyline,"loop",this,"loop")),this.disposers.push((0,P.autorun)((()=>{const e=this.positions.length-this._points.points.length;if(e>0)for(let t=0;t<e;++t)this._points.points.push({});else if(e<0)for(let t=0;t<-e;++t)this._points.points[this.positions.length+t].show=!1,this._points.points[this.positions.length+t].color.splice(0,4,1,1,0,1);this.positions.forEach(((e,t)=>{this._points.points[t].show=this.enabled,this._points.points[t].position.splice(0,3,...e)})),this._polyline.positions=this.positions.map((e=>[...e])),this._polyline.show=this.enabled&&this.polylineShow})))}_isNearFirstPos(e,t){return this._currentCartesian=Cesium.Cartesian3.fromRadians(...e,void 0,this._currentCartesian),this._currentPosition=this._earth.czm.scene.cartesianToCanvasCoordinates(this._currentCartesian,this._currentPosition),this._firstCartesian=Cesium.Cartesian3.fromRadians(...this.positions[0],void 0,this._firstCartesian),this._firstPosition=this._earth.czm.scene.cartesianToCanvasCoordinates(this._firstCartesian,this._firstPosition),!(!this._firstPosition||!this._currentPosition)&&Cesium.Cartesian2.distanceSquared(this._currentPosition,this._firstPosition)<t*t}_getClickAction(e){const t=this._earth.eventSource.mouse;return this._actionMap=this._actionMap||{LEFTCLICK:t.leftClick,RIGHTCLICK:t.rightClick,CTRL_LEFTCLICK:t.ctrlLeftClick,CTRL_RIGHTLICK:t.ctrlRightClick,SHIFT_LEFTCLICK:t.shiftLeftClick,SHIFT_RIGHTCLICK:t.shiftRightClick},this._actionMap[e]}_init(){this._actionMapDirty&&(this._actionMapDirty=!1,this._stepsOp=void 0,this._steps=void 0,this.mouseMove$=this.mouseMove$||this._earth.eventSource.mouse.mouseMovePickedPosition,this.leftClick$=this.leftClick$||this._earth.eventSource.mouse.leftClickPickedPosition,this.deletingAction$=this._getClickAction(this.deletingAction),this.endAction$=this._getClickAction(this.endAction)),this._stepsOp||(this._stepsOp=[[this.mouseMove$,({position:e})=>{if(e)if(0===this.positions.length);else{this.positions[this.positions.length-1].splice(0,3,...e)}},this.leftClick$,({position:e})=>{if(e){if(0===this.positions.length)this.positions.push([...e]);else{this.positions[this.positions.length-1].splice(0,3,...e)}this.positions.push([...e]),this.fixedPositionsNum&&this.positions.length>this.fixedPositionsNum&&this._steps.next()}}]],this.deletingAction$&&this._stepsOp[0].push(this.deletingAction$,(()=>{this.positions.length>0&&this.positions.pop()})),this.endAction$&&this._stepsOp[0].push(this.endAction$,(()=>{this._steps.next()}))),this._steps||(this._steps=new Xa(this._earth,this._stepsOp))}_start(){if(this._init(),this.positions.length=0,this.positions.length>0?this.positions.push(this.positions[0]):this.positions.push([0,0,0]),this._disableSteps)throw new Error("_disableSteps should be undefined!");this._disableSteps=Ka.enableProperty(this._steps,(()=>this.enabled=!1))}_cancel(){this.positions.pop(),this._disableSteps=this._disableSteps&&this._disableSteps()}destroy(){return this.enabled=!1,super.destroy()}}!function(e){Object.defineProperty(e.prototype,"_actionMapDirty",{get(){return void 0===this.__actionMapDirty||this.__actionMapDirty},set(e){this.__actionMapDirty=!!e}}),Object.defineProperty(e.prototype,"deletingAction",{get(){return this._deletingAction||"RIGHTCLICK"},set(e){this.deletingAction!==e&&(this._deletingAction=e,this._actionMapDirty=!0)}}),Object.defineProperty(e.prototype,"endAction",{get(){return this._endAction||"SHIFT_RIGHTCLICK"},set(e){this.endAction!==e&&(this._endAction=e,this._actionMapDirty=!0)}})}(Bl);const Ml=Bl;const El=class extends $a{constructor(e){super(e),this.target=void 0,this.disposers.push((()=>this.target=void 0)),this._editing=new Ml(e),this.disposers.push((()=>this._editing=this._editing&&this._editing.destroy()))}_start(){if(this._disableProperty)throw new Error("_disableProperty should be undefined!");const e=[];(0,P.runInAction)((()=>{this.target.positions.length=0,this.target.rotations&&(this.target.rotations.length=0)})),e.push((0,O.Z)(this._editing,"positions",this.target,"positions")),this.target.rotations&&e.push((0,O.Z)(this._editing,"rotations",this.target,"rotations")),void 0!==this.target.loop&&e.push((0,O.Z)(this._editing,"loop",this.target,"loop"))||(this._editing.loop=!1),void 0!==this.target.editingPolylineShow&&e.push((0,O.Z)(this._editing,"polylineShow",this.target,"editingPolylineShow"))||(this._editing.polylineShow=!0),this._editing.fixedPositionsNum=this.target.fixedPositionsNum,e.push(Ka.enableProperty(this._editing,(()=>this.target=void 0))),e.reverse(),this._disableProperty=()=>{e.forEach((e=>e())),e.length=0}}_cancel(){this._disableProperty=this._disableProperty&&this._disableProperty()}get editing(){return this._editing}destroy(){return super.destroy()}};class Tl extends h.Z{constructor(e,t,i,r=!1){super(),(0,P.extendObservable)(this,{positions:[],rotations:void 0,loop:!0}),this._realObject=e,this._heightProperty=i,this._positionArray=t,this._disposers=this._disposers||[];const n=({positionArray:e})=>{const t=this._realObject[this._heightProperty],i=this.positions,r=e.length/2-i.length,n=0===r&&i.every(((t,i)=>e[2*i]===t[0]&&e[2*i+1]===t[1]));if(!n)if(r>0){i.forEach(((t,r)=>{i[r].splice(0,2,e[2*r],e[2*r+1])}));const n=i.length;for(let o=0;o<r;++o)i.push([e[2*(n+o)],e[2*(n+o)+1],t])}else{for(let t=0;t<e.length;t+=2)i[t/2].splice(0,2,e[t],e[t+1]);if(r<0){const t=e.length/2;i.splice(t,-r)}}};this._disposers.push((0,P.reaction)((()=>({positionArray:[...this._positionArray]})),n,{fireImmediately:!1})),n({positionArray:[...this._positionArray]});const o=e=>{this.positions.forEach((t=>{t[2]=e}))};this._disposers.push((0,P.reaction)((()=>this._realObject[this._heightProperty]),o,{fireImmediately:!1})),o(this._realObject[this._heightProperty]),r?(this._originHeights=this.positions.map((e=>e[2])),this._disposers.push((0,P.reaction)((()=>this.positions.map((e=>e[2]))),(e=>{for(let t=0;t<e.length;++t){const i=e[t];if(t>=this._originHeights.length){this._realObject[this._heightProperty]=i;break}if(t<this._originHeights.length&&this._originHeights[t]!==i){this._realObject[this._heightProperty]=i;break}}this._originHeights=e}),{fireImmediately:!0}))):this._disposers.push((0,P.reaction)((()=>this.positions.length>0?this.positions[0][2]:void 0),(e=>{void 0!==e&&(this._realObject[this._heightProperty]=e)}))),this._disposers.push((0,P.reaction)((()=>this.positions.map((e=>[e[0],e[1]]))),(e=>{const t=this._positionArray,i=0===t.length/2-e.length&&e.every(((e,i)=>t[2*i]===e[0]&&t[2*i+1]===e[1]));if(!i){const i=[];e.forEach((e=>i.push(e[0],e[1]))),t.splice(0,2*t.length,...i)}}),{fireImmediately:!0}))}resetHeight(){const e=this.positions.reduce(((e,t)=>e[2]+t[2]),0),t=this.positions.length>0?e/this.positions.length:0;this._realObject[this._heightProperty]=t}get realObject(){return this._realObject}get heightProperty(){return this._heightProperty}get positionsArray(){return this._positionArray}get onlyMove(){return this._realObject.onlyMove}get fixedPositionsNum(){return this._realObject.fixedPositionsNum}destroy(){return this._disposers.forEach((e=>e())),this._disposers.length=0,super.destroy()}}const Ol=Tl;const Ll=class extends $a{constructor(e,t="positions"){super(e),this._positionsProperty=t,this.target=void 0,this.disposers.push((()=>this.target=void 0)),this._editing=new El(e),this.disposers.push((()=>this._editing=this._editing&&this._editing.destroy()))}_start(e){this._editingPolylineLike=new Ol(e,e[this._positionsProperty],"height",!0);const t=()=>this._editingPolylineLike=this._editingPolylineLike&&this._editingPolylineLike.destroy(),i=$a.targetProperty(this._editing,this._editingPolylineLike,(()=>{this.target=void 0}));this._disableProperty=()=>{i(),t()}}_cancel(){this._disableProperty=this._disableProperty&&this._disableProperty()}get editing(){return this._editing}destroy(){return super.destroy()}};const Dl=class extends $a{constructor(e){super(e),(0,P.extendObservable)(this,{onlyOnce:!0}),this.target=void 0,this.disposers.push((()=>this.target=void 0)),this._editing=new yl(e),this._editing.xEnabled=!1,this._editing.yEnabled=!1,this._editing.skipFirstStepForZ=!0,this.disposers.push((()=>{this._editing=this._editing&&this._editing.destroy()})),this.disposers.push((0,P.autorun)((()=>{this._editing.onlyOnce=this.onlyOnce})))}_start(){const e=[...this.target.position];this._editing.position.splice(0,3,...this.target.position);const t=(0,O.Z)(this._editing,"position",this.target,"position"),i=Ka.enableProperty(this._editing,(()=>{this._editing.steps.lastStep||this.onlyOnce&&this.target.position.splice(0,3,e),this.target=void 0}));this._disableEditing=()=>{t&&t(),i&&i()}}_cancel(){this._disableEditing=this._disableEditing&&this._disableEditing()}get editing(){return this._editing}destroy(){return super.destroy()}};class Il{constructor(e,t){this._index=t,this._positionsOwner=e,(0,P.extendObservable)(this,{position:[0,0,0]}),this._disposer=(0,O.Z)(this,"position",this._positionsOwner,`positions.${t}`)}destroy(){this._disposer=this._disposer&&this._disposer()}}const Rl=class extends $a{constructor(e){super(e),(0,P.extendObservable)(this,{onlyOnce:!0}),this.target=void 0,this.disposers.push((()=>this.target=void 0)),this._polylineCreating=new El(e),this.disposers.push((()=>this._polylineCreating=this._polylineCreating&&this._polylineCreating.destroy())),this._heightEditing=new Dl(e),this.disposers.push((()=>this._heightEditing=this._heightEditing&&this._heightEditing.destroy())),this.disposers.push((0,P.autorun)((()=>{this._heightEditing.onlyOnce=this.onlyOnce}))),this._createHelpers()}_createHelpers(){const e=this._earth;this._polygon=new Pi.Z(e),this.disposers.push((()=>this._polygon=this._polygon&&this._polygon.destroy())),this.disposers.push((0,P.autorun)((()=>{this._polygon.height=this.target&&this.target.height}))),this._polygon.show=!1,this._polygon.showHelper=!1,this.disposers.push((0,P.reaction)((()=>!!this._heightEditing.target),(e=>{this._polygon.show=e,this._polygon.showHelper=e}))),this.disposers.push((0,P.reaction)((()=>this.target?[...this.target.positions]:void 0),(e=>{e&&(this._polygon.positions=e)})))}get polylineCreating(){return this._polylineCreating}get heightEditing(){return this._heightEditing}_startPolygonEditing(){if(this._disabledPolygonEditing)throw new Error("_disabledPolygonEditing sholud be undefined!");const e=$a.targetProperty(this._polylineCreating,this._editingPolylineLike,(()=>this._nextStep()));this._disabledPolygonEditing=()=>{e()}}_nextStep(){this._polylineCreating.editing.steps.lastStep&&this._editingPolylineLike.positions.length>=3?this._startHeightEditing():this.target=void 0,this._disabledPolygonEditing=this._disabledPolygonEditing&&this._disabledPolygonEditing()}_startHeightEditing(){if(this._positionWrapper)throw new Error("error");this._positionWrapper=new Il(this._editingPolylineLike,0);const e=$a.targetProperty(this._heightEditing,this._positionWrapper,(()=>{this.target=void 0}));this._disabledHeightEditing=()=>{e()}}_start(){this._editingPolylineLike=new Ol(this.target,this.target.positions,"height"),this._startPolygonEditing()}_cancel(){this._disabledPolygonEditing=this._disabledPolygonEditing&&this._disabledPolygonEditing(),this._disabledHeightEditing=this._disabledHeightEditing&&this._disabledHeightEditing(),this._positionWrapper=this._positionWrapper&&this._positionWrapper.destroy(),this._editingPolylineLike=this._editingPolylineLike&&this._editingPolylineLike.destroy()}destroy(){return super.destroy()}},Hl='\n<svg t="1565617511231" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="11001" width="48" height="48"><path d="M918.557 489.053L794.902 365.398c-12.526-12.526-32.868-12.526-45.394 0-12.526 12.526-12.526 32.868 0 45.394l68.842 68.842H542.983V206.37l68.541 68.541c12.526 12.526 32.868 12.526 45.394 0 12.526-12.526 12.526-32.868 0-45.394L533.663 106.263l-0.301-0.301c-0.301-0.301-0.601-0.601-0.902-0.802-0.1-0.1-0.2-0.2-0.401-0.301-0.301-0.2-0.601-0.501-0.802-0.701-0.1-0.1-0.2-0.2-0.301-0.2a3.584 3.584 0 0 0-1.002-0.701c-0.1 0-0.1-0.1-0.2-0.1-0.401-0.301-0.701-0.501-1.102-0.802-4.209-2.806-9.219-4.71-14.53-5.211h-0.2c-0.501 0-0.902-0.1-1.403-0.1h-3.207c-0.501 0-0.902 0.1-1.403 0.1h-0.2c-5.311 0.501-10.321 2.405-14.53 5.211-0.401 0.301-0.701 0.501-1.102 0.802-0.1 0-0.1 0.1-0.2 0.1-0.301 0.2-0.601 0.501-1.002 0.701-0.1 0.1-0.2 0.2-0.301 0.2-0.301 0.2-0.601 0.501-0.802 0.701-0.1 0.1-0.2 0.2-0.401 0.301-0.301 0.301-0.601 0.501-0.902 0.802l-0.301 0.301-123.353 123.555c-12.526 12.526-12.526 32.868 0 45.394a32.034 32.034 0 0 0 22.647 9.419c8.217 0 16.434-3.106 22.647-9.419l68.742-68.742v273.063H205.386l68.842-68.842c12.526-12.526 12.526-32.868 0-45.394-12.526-12.526-32.868-12.526-45.394 0L105.48 488.752c-6.012 6.012-9.419 14.129-9.419 22.647s3.407 16.634 9.419 22.647l122.753 122.753c6.213 6.213 14.43 9.419 22.647 9.419s16.434-3.106 22.647-9.419c12.526-12.526 12.526-32.868 0-45.394l-67.639-67.74h273.063V817.43l-69.844-69.844c-12.526-12.526-32.868-12.526-45.394 0-12.526 12.526-12.526 32.868 0 45.394L488.27 917.536c6.012 6.012 14.129 9.419 22.647 9.419 8.518 0 16.634-3.407 22.647-9.419l123.755-123.755c12.526-12.526 12.526-32.868 0-45.394-12.526-12.526-32.868-12.526-45.394 0l-68.942 68.942V543.665h275.568l-68.842 68.842c-12.526 12.526-12.526 32.868 0 45.394a32.034 32.034 0 0 0 22.647 9.419c8.217 0 16.434-3.106 22.647-9.419l123.455-123.455c12.625-12.526 12.625-32.868 0.099-45.393z" fill="#1296db" p-id="11002"></path></svg>\n',Fl='\n<svg t="1565617059625" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="6656" width="48" height="48"><path d="M903.37727 439.522292 584.476173 439.522292 584.476173 120.622218c0-32.020274-25.961278-57.981553-57.981553-57.981553l-28.990265 0c-32.020274 0-57.982576 25.962302-57.982576 57.981553l0 318.900074L120.621706 439.522292c-32.020274 0-57.981553 25.962302-57.981553 57.981553l0 28.991288c0 32.020274 25.962302 57.981553 57.981553 57.981553l318.900074 0L439.52178 903.377782c0 32.019251 25.962302 57.981553 57.982576 57.981553l28.990265 0c32.020274 0 57.981553-25.962302 57.981553-57.981553L584.476173 584.476685l318.901097 0c32.020274 0 57.981553-25.961278 57.981553-57.981553l0-28.991288C961.358823 465.484593 935.397544 439.522292 903.37727 439.522292z" p-id="6657" fill="#1296db"></path></svg>\n',Nl='\n<svg t="1565617135691" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="7670" width="48" height="48"><path d="M512 620.544l253.3376 253.3376a76.6976 76.6976 0 1 0 108.544-108.544L620.6464 512l253.2352-253.3376a76.6976 76.6976 0 1 0-108.544-108.544L512 403.3536 258.6624 150.1184a76.6976 76.6976 0 1 0-108.544 108.544L403.3536 512 150.1184 765.3376a76.6976 76.6976 0 1 0 108.544 108.544L512 620.6464z" p-id="7671" fill="#1296db"></path></svg>\n';class Ql extends h.Z{constructor(e){super(),this._earth=e,(0,P.extendObservable)(this,{left:void 0,top:void 0,right:void 0,bottom:void 0}),(0,P.extendObservable)(this,{rotate:!0,show:!1}),this._eventSource=new rxjs.Subject;const t=document.createElement("div"),i=document.createElement("div");this.disposers.push((()=>{r.container.removeChild(t),r.container.removeChild(i)}));R.Z.addCSS("\n            .gvolEarthPanel .icon path {\n                fill: #CCC\t\t\n            }\n\n            .gvolEarthPanel .icon:hover path {\n                fill: #FFF\n            }\n            \n            .gvolEarthPanel .icon {\n                width: 24px;\n                height: 24px;\n            }\n        "),this._setPanel(t),this._setPanel2(i);const r=this._earth.czm.viewer.cesiumWidget;r.container.appendChild(t),r.container.appendChild(i),this.disposers.push((0,P.autorun)((()=>{t.style.visibility=this.rotate&&this.show?"visible":"hidden",i.style.visibility=!this.rotate&&this.show?"visible":"hidden"})))}_setPanel(e){e.style.cssText="\n            position: absolute; \n            left: 0px; \n            top: 0px;   \n            width: 96px;\n            height: 24px;\n            margin: 0px;\n            padding: 5px;\n\n            cursor: pointer;\n\n            font-size: 0px;\n            box-sizing: content-box;\n            border-radius: 5px;            \n\n            background: rgba(0, 0, 0, 0.8);\n        ",e.className="gvolEarthPanel",e.onmouseover=()=>{this.show=!0};[{title:"移动",type:"move",svg:Hl},{title:"旋转",type:"rotate",svg:'\n<svg t="1565617290828" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="8474" width="48" height="48"><path d="M611.392 805.12l27.008 77.12a395.072 395.072 0 0 1-104.128 21.376l-5.568-81.536c28.288-1.92 56.128-7.616 82.688-16.96z m-439.552-84.288c19.136 29.888 42.176 57.152 68.544 81.024l54.848-60.544a314.496 314.496 0 0 1-54.528-64.448l-68.864 43.968z m22.72-167.616l-80.832 11.84c2.88 19.904 7.36 39.744 13.312 58.944l78.08-24.064a312.512 312.512 0 0 1-10.56-46.72z m133.376 308.736a398.016 398.016 0 0 0 100.48 34.816l16.128-80.128a312.64 312.64 0 0 1-79.68-27.52l-36.928 72.832z m358.528-95.104l46.528 67.136a400.64 400.64 0 0 0 78.528-71.488l-62.592-52.544a320 320 0 0 1-62.464 56.896zM506.944 109.632a394.56 394.56 0 0 0-248.768 87.616l-89.6-89.6-61.888 309.504 309.568-61.888-99.712-99.712A313.28 313.28 0 0 1 507.008 191.36a316.096 316.096 0 0 1 287.104 447.232l74.24 34.112a399.36 399.36 0 0 0 36.096-165.568 397.952 397.952 0 0 0-397.504-397.504z" p-id="8475" fill="#1296db"></path></svg>\n'},{title:"添加",type:"add",svg:Fl},{title:"删除",type:"delete",svg:Nl}].forEach((t=>{const i=R.Z.createElement(t.svg);return i.title=t.title,i.onclick=()=>{this._eventSource.next(t.type)},e.appendChild(i),i})),this.disposers.push((0,P.autorun)((()=>{void 0!==this.left?e.style.left=`${this.left}px`:e.style.left="",void 0!==this.top?e.style.top=`${this.top}px`:e.style.top="",void 0!==this.right?e.style.right=`${this.right}px`:e.style.right="",void 0!==this.bottom?e.style.bottom=`${this.bottom}px`:e.style.bottom=""})))}_setPanel2(e){e.style.cssText="\n            position: absolute; \n            left: 0px; \n            top: 0px;   \n            width: 72px;\n            height: 24px;\n            margin: 0px;\n            padding: 5px;\n\n            cursor: pointer;\n\n            font-size: 0px;\n            box-sizing: content-box;\n            border-radius: 5px;            \n\n            background: rgba(0, 0, 0, 0.8);\n        ",e.className="gvolEarthPanel",e.onmouseover=()=>{this.show=!0};[{title:"移动",type:"move",svg:Hl},{title:"添加",type:"add",svg:Fl},{title:"删除",type:"delete",svg:Nl}].forEach((t=>{const i=R.Z.createElement(t.svg);return i.title=t.title,i.onclick=()=>{this._eventSource.next(t.type)},e.appendChild(i),i})),this.disposers.push((0,P.autorun)((()=>{void 0!==this.left?e.style.left=`${this.left}px`:e.style.left="",void 0!==this.top?e.style.top=`${this.top}px`:e.style.top="",void 0!==this.right?e.style.right=`${this.right}px`:e.style.right="",void 0!==this.bottom?e.style.bottom=`${this.bottom}px`:e.style.bottom=""})))}get eventSource(){return this._eventSource}destroy(){return super.destroy()}}const kl=Ql;const Ul=class extends Ka{constructor(e){super(),this._earth=e,(0,P.extendObservable)(this,{positions:[],rotations:void 0,isCameraLike:!1,loop:!1,onlyMove:!1,_nearPointIndex:-1,polylineShow:!0}),this.disposers.push((0,P.intercept)(this,"positions",(e=>("update"===e.type&&this.positions.splice(0,this.positions.length,...e.newValue),null)))),this.disposers.push((0,P.intercept)(this.positions,(e=>{if("splice"===e.type&&this.rotations){const t=new Array(e.added.length).fill([0,0,0]);this.rotations.splice(e.index,e.removedCount,...t)}return e}))),this._currentMovingIndex=-1,this._coordinatesMove=new yl(e),this.disposers.push((()=>{this._coordinatesMove=this._coordinatesMove&&this._coordinatesMove.destroy()})),this._circlesRotating=new Sl(e),this.disposers.push((()=>{this._circlesRotating=this._circlesRotating&&this._circlesRotating.destroy()})),this._panel=new kl(e),this.disposers.push((()=>{this._panel=this._panel&&this._panel.destroy()})),this.disposers.push((0,P.autorun)((()=>{this._panel.rotate=!!this.rotations}))),this._createHelper();{this._nearPointIndex_setting=0,this.disposers.push((()=>this._nearPointIndex_setting>0&&clearTimeout(this._nearPointIndex_setting))),this.disposers.push((0,P.intercept)(this,"_nearPointIndex",(e=>-1!==e.newValue?(this._nearPointIndex_setting>0&&(clearTimeout(this._nearPointIndex_setting),this._nearPointIndex_setting=0),e):0===this._nearPointIndex_setting?(this._nearPointIndex_setting=setTimeout((()=>{this._nearPointIndex_setting=-1,this._nearPointIndex=-1}),500),null):-1===this._nearPointIndex_setting?(this._nearPointIndex_setting=0,e):null)));const e=new Cesium.Cartesian3,t=new Cesium.Cartesian2;this.disposers.push((0,P.autorun)((()=>{const i=this._nearPointIndex;if(this.onlyMove)this._panel.show&&(this._panel.show=!1);else if(-1!==i){this._panel.show=!0;const r=this.positions.length>i&&this.positions[i];if(void 0!==r){const i=Cesium.Cartesian3.fromRadians(r[0],r[1],r[2],void 0,e),n=this._earth.czm.scene.cartesianToCanvasCoordinates(i,t),o=this._earth.czm.scene.canvas.clientHeight;this._panel.left=n.x,this._panel.bottom=o-n.y}}else this._panel.show=!1})))}}_createHelper(){const e=this._earth;this._points=new Ti.Z(e),this.disposers.push((()=>this._points=this._points&&this._points.destroy())),this._points.forcePass=Cesium.Pass.OVERLAY,this._polyline=new Si.Z(e),this._polyline.material.XbsjColorMaterial.color.splice(0,4,1,1,0,1),this._polyline.depthTest=!1,this._polyline.material.type="XbsjColorMaterial",this._polyline.width=2,this.disposers.push((()=>this._polyline=this._polyline&&this._polyline.destroy())),this.disposers.push((0,P.autorun)((()=>{const e=this.positions.length-this._points.points.length;if(e>0)for(let t=0;t<e;++t)this._points.points.push({});else if(e<0)for(let t=0;t<-e;++t)this._points.points[this.positions.length+t].show=!1,this._points.points[this.positions.length+t].color.splice(0,4,1,1,0,1);this.positions.forEach(((e,t)=>{this._points.points[t].show=this.enabled,this._points.points[t].position.splice(0,3,...e)})),this._polyline.positions=this.positions.map((e=>[...e]))}))),this.disposers.push((0,P.autorun)((()=>{this._polyline.loop=this.loop,this._polyline.show=this.enabled&&this.polylineShow})));const t=this._points;this.disposers.push((0,P.autorun)((()=>{if(t.points.forEach((e=>e.pixelSize=6)),this._nearPointIndex>=0&&this._nearPointIndex<t.points.length){const e=this._nearPointIndex;t.points[e].pixelSize=16}})))}_getNearPointIndex(e,t){return this.positions.findIndex(((i,r)=>{const n=Cesium.Cartesian3.fromRadians(...this.positions[r],void 0,this._firstCartesian);if(!n)return!1;const o=this._earth.czm.scene.cartesianToCanvasCoordinates(n,this._firstPosition);return!!o&&Cesium.Cartesian2.distanceSquared(e,o)<t*t}))}_init(){this.mouseMove$=this.mouseMove$||this._earth.eventSource.mouse.mouseMove,this.panel$=this.panel$||this._panel.eventSource,this.leftClick$=this.leftClick$||this._earth.eventSource.mouse.leftClick,this.ctrlLeftClick$=this.ctrlLeftClick$||this._earth.eventSource.mouse.ctrlLeftClick,this.shiftLeftClick$=this.shiftLeftClick$||this._earth.eventSource.mouse.shiftLeftClick,this.rightClick$=this.rightClick$||this._earth.eventSource.mouse.rightClick,this._stepsOp=this._stepsOp||[[this.mouseMove$,e=>{const t=this._getNearPointIndex(e.endPosition,5);-1!==t&&this._currentMovingIndex!==t?this._nearPointIndex=t:this._nearPointIndex=-1},this.leftClick$,()=>{-1!==this._nearPointIndex&&this.onlyMove&&this._startMoving(this._nearPointIndex)},this.panel$,e=>{this._nearPointIndex>=0&&this._nearPointIndex<this.positions.length&&("move"===e?this._startMoving(this._nearPointIndex):"rotate"===e?this._startRotating(this._nearPointIndex):"add"===e?(this.positions.splice(this._nearPointIndex,0,this.positions[this._nearPointIndex]),this._startMoving(this._nearPointIndex+1),this._coordinatesMove.skipFirstStep({xAxisActive:!0,yAxisActive:!0})):"delete"===e&&this.positions.splice(this._nearPointIndex,1),this._nearPointIndex_setting>0&&clearTimeout(this._nearPointIndex_setting),this._nearPointIndex_setting=-1,this._nearPointIndex=-1)},this.rightClick$,()=>{this._cancelMovingFunc||this._cancelRotatingFunc||(this._steps.enabled=!1)}]],this._steps||(this._steps=new Xa(this._earth,this._stepsOp))}_startMoving(e){this._cancelMovingFunc&&this._cancelMoving(),this._cancelRotatingFunc&&this._cancelRotating(),this._currentMovingIndex=e;const t=(0,O.Z)(this._coordinatesMove,"position",this,`positions.${e}`),i=Ka.enableProperty(this._coordinatesMove,(()=>{this._cancelMoving()}));this._cancelMovingFunc=()=>{i(),t(),this._currentMovingIndex=-1}}_cancelMoving(){this._cancelMovingFunc=this._cancelMovingFunc&&this._cancelMovingFunc()}_startRotating(e){if(this._cancelRotatingFunc&&this._cancelRotating(),this._cancelMovingFunc&&this._cancelMoving(),this.rotations){this._currentRotatingIndex=e;const t=(0,O.Z)(this._circlesRotating,"position",this,`positions.${e}`);let i;i=this.isCameraLike?(0,O.Z)(this._circlesRotating,"rotation",this,`rotations.${e}`,{r1Tor2:(e,t)=>(t.splice(0,3,e[0]+.5*Math.PI,e[1],e[2]),t),r2Tor1:(e,t)=>(t.splice(0,3,e[0]-.5*Math.PI,e[1],e[2]),t),equals:(e,t)=>(0,Cesium.Math.equalsEpsilon)(e[0]+.5*Math.PI,t[0],0,Cesium.Math.EPSILON4)&&e[1]===t[1]&&e[2]===t[2]}):(0,O.Z)(this._circlesRotating,"rotation",this,`rotations.${e}`);const r=Ka.enableProperty(this._circlesRotating,(()=>{this._cancelRotating()}));this._cancelRotatingFunc=()=>{r(),i(),t(),this._currentRotatingIndex=-1}}}_cancelRotating(){this._cancelRotatingFunc=this._cancelRotatingFunc&&this._cancelRotatingFunc()}_start(){if(this._init(),this._stepsDisable)throw new Error("_stepsDisable should not exists!");this._stepsDisable=Ka.enableProperty(this._steps,(()=>this.enabled=!1))}_cancel(){this._cancelMoving(),this._cancelRotating(),this._stepsDisable=this._stepsDisable&&this._stepsDisable()}destroy(){return this.enabled=!1,super.destroy()}};const jl=class extends $a{constructor(e){super(e),this.target=void 0,this.disposers.push((()=>this.target=void 0)),this._editing=new Ul(e),this.disposers.push((()=>this._editing=this._editing&&this._editing.destroy()))}_start(){if(this._disableProperty)throw new Error("_disableProperty should not be defined!");const e=[];e.push((0,O.Z)(this._editing,"positions",this.target,"positions")),this.target.rotations&&e.push((0,O.Z)(this._editing,"rotations",this.target,"rotations")),void 0!==this.target.isCameraLike&&(this._editing.isCameraLike=this.target.isCameraLike),void 0!==this.target.onlyMove&&(this._editing.onlyMove=this.target.onlyMove),void 0!==this.target.loop&&e.push((0,O.Z)(this._editing,"loop",this.target,"loop"))||(this._editing.loop=!1),void 0!==this.target.editingPolylineShow&&e.push((0,O.Z)(this._editing,"polylineShow",this.target,"editingPolylineShow"))||(this._editing.polylineShow=!0),e.push(Ka.enableProperty(this._editing,(()=>this.target=void 0))),e.reverse(),this._disableProperty=()=>{e.forEach((e=>e())),e.length=0}}_cancel(){this._disableProperty=this._disableProperty&&this._disableProperty()}get editing(){return this._editing}destroy(){return super.destroy()}};const Gl=class extends $a{constructor(e,t="positions"){super(e),this._positionsProperty=t,this.target=void 0,this.disposers.push((()=>this.target=void 0)),this._editing=new jl(e),this.disposers.push((()=>this._editing=this._editing&&this._editing.destroy()))}_start(e){this._editingPolylineLike=new Ol(e,e[this._positionsProperty],"height",!0);const t=()=>this._editingPolylineLike=this._editingPolylineLike&&this._editingPolylineLike.destroy(),i=$a.targetProperty(this._editing,this._editingPolylineLike,(()=>{this.target=void 0}));this._disableProperty=()=>{i(),t()}}_cancel(){this._disableProperty=this._disableProperty&&this._disableProperty()}get editing(){return this._editing}destroy(){return super.destroy()}};const zl=class extends $a{constructor(e){super(e),this.target=void 0,this.disposers.push((()=>this.target=void 0)),this._cameraTracking=e.camera.tracking}_start(e){if(this._disableOp)throw new Error("_disableOp should not be undefined!");const t=this._earth,i=[];t.camera.tracking.enabled&&(t.camera.tracking.enabled=!1),i.push(e.cameraTrackingFunc(t.camera.tracking)),t.camera.tracking.enabled=!0,i.push((0,P.intercept)(t.camera.tracking,"enabled",(e=>(e.newValue||e.newValue===e.oldValue||(this.target=void 0),e)))),this._disableOp=()=>{i.forEach((e=>e())),t.camera.tracking.enabled=!1}}_cancel(){this._disableOp=this._disableOp&&this._disableOp()}get coordinatesMove(){return this._coordinatesMove}destroy(){return super.destroy()}};function Yl(e,t){Object.defineProperty(e,t.slice(1),{get:()=>e[t]})}!function(){const e=window;e.undebug&&e.undebug(Function),e.unmonitor&&e.unmonitor(Function),e.debug=()=>{},e.debug.toString=()=>"function debug(function, condition) { [Command Line API] }",e.monitor=()=>{},e.monitor.toString=()=>"function monitor(function) { [Command Line API] }"}();class Zl extends h.Z{constructor(e){super(),this._earth=e,this._mutex=new ki,this.disposers.push((()=>this._mutex=this._mutex&&this._mutex.destroy())),this.picking=new Wa(e),this.disposers.push((()=>this.picking=this.picking&&this.picking.destroy())),h.Z.registerProperty(this,"picking"),this._positionPickingBinding=new el(e),Yl(this,"_positionPickingBinding"),this._directionCameraBinding=new nl(e),Yl(this,"_directionCameraBinding"),this._movableObjectBinding=new vl(e),Yl(this,"_movableObjectBinding"),this._rotatableObjectBinding=new xl(e),Yl(this,"_rotatableObjectBinding"),this._creatingPolylineBinding=new El(e),Yl(this,"_creatingPolylineBinding"),this._creatingPolygonBinding=new Ll(e),Yl(this,"_creatingPolygonBinding"),this._creatingPolygonHoleBinding=new Ll(e,"holePositions"),Yl(this,"_creatingPolygonHoleBinding"),this._heightEditingBinding=new Dl(e),Yl(this,"_heightEditingBinding"),this._flattenedPolygonCreatingBinding=new Rl(e),Yl(this,"_flattenedPolygonCreatingBinding"),this._editingPolygonBinding=new Gl(e),Yl(this,"_editingPolygonBinding"),this._editingPolygonHoleBinding=new Gl(e,"holePositions"),Yl(this,"_editingPolygonHoleBinding"),this._editingPolylineBinding=new jl(e),Yl(this,"_editingPolylineBinding"),this._cameraTrackingBinding=new zl(e),Yl(this,"_cameraTrackingBinding"),this.disposers.push((()=>{this._positionPickingBinding=this._positionPickingBinding&&this._positionPickingBinding.destroy(),this._directionCameraBinding=this._directionCameraBinding&&this._directionCameraBinding.destroy(),this._movableObjectBinding=this._movableObjectBinding&&this._movableObjectBinding.destroy(),this._rotatableObjectBinding=this._rotatableObjectBinding&&this._rotatableObjectBinding.destroy(),this._creatingPolylineBinding=this._creatingPolylineBinding&&this._creatingPolylineBinding.destroy(),this._creatingPolygonBinding=this._creatingPolygonBinding&&this._creatingPolygonBinding.destroy(),this._creatingPolygonHoleBinding=this._creatingPolygonHoleBinding&&this._creatingPolygonHoleBinding.destroy(),this._heightEditingBinding=this._heightEditingBinding&&this._heightEditingBinding.destroy(),this._flattenedPolygonCreatingBinding=this._flattenedPolygonCreatingBinding&&this._flattenedPolygonCreatingBinding.destroy(),this._editingPolygonBinding=this._editingPolygonBinding&&this._editingPolygonBinding.destroy(),this._editingPolygonHoleBinding=this._editingPolygonHoleBinding&&this._editingPolygonHoleBinding.destroy(),this._editingPolylineBinding=this._editingPolylineBinding&&this._editingPolylineBinding.destroy(),this._cameraTrackingBinding=this._cameraTrackingBinding&&this._cameraTrackingBinding.destroy()}));const t=ki.setUndefined,i=ki.isDefined,r=e=>({binding:e[0],property:e[1],isValidFunc:e[2],validFunc:e[3]}),n=[r([this._positionPickingBinding,"target",i,t]),r([this._directionCameraBinding,"target",i,t]),r([this._movableObjectBinding,"target",i,t]),r([this._rotatableObjectBinding,"target",i,t]),r([this._creatingPolylineBinding,"target",i,t]),r([this._creatingPolygonBinding,"target",i,t]),r([this._creatingPolygonHoleBinding,"target",i,t]),r([this._heightEditingBinding,"target",i,t]),r([this._flattenedPolygonCreatingBinding,"target",i,t]),r([this._editingPolygonBinding,"target",i,t]),r([this._editingPolygonHoleBinding,"target",i,t]),r([this._editingPolylineBinding,"target",i,t]),r([this._cameraTrackingBinding,"target",i,t])];this._mutex.mutexCollection=n,this.disposers.push((0,P.reaction)((()=>n.some((e=>e.isValidFunc(e.binding[e.property])))),(e=>{this.picking.shouldEnabled=!e})))}}Zl.InteractionProperty=ae.ZP,Zl.Picking=Wa,Zl.defaultOptions={picking:null};const Wl=Zl;class Xl extends h.Z{constructor(e){super(),this._earth=e;const t=e.czm.viewer;t.xbsjMeasurement&&(this._pointM=t.xbsjMeasurement.createPointMeasurement(),this._polylineM=t.xbsjMeasurement.createPolylineMeasurement(),(0,P.extendObservable)(this,{type:"NONE"}),this._listenerDisposer1=this._pointM.getActiveChangedEvent().addEventListener((()=>{this.type=this._pointM.isActive()?"POINT":"NONE"})),this._listenerDisposer2=this._polylineM.getActiveChangedEvent().addEventListener((()=>{this.type=this._polylineM.isActive()?function(e){switch(e){case 1:return"SPACE_DISTANCE";case 2:return"TRIANGLE_DISTANCE";case 3:return"SPACE_AREA";default:return"NONE"}}(this._polylineM.getMode()):"NONE"})),this._observerDisposer=(0,P.observe)(this,"type",(e=>{e.newValue,"POINT"===e.oldValue?this._pointM.end():"SPACE_DISTANCE"!==e.oldValue&&"TRIANGLE_DISTANCE"!==e.oldValue&&"SPACE_AREA"!==e.oldValue||this._polylineM.end(),"POINT"===e.newValue?this._pointM.start():"SPACE_DISTANCE"===e.newValue?(this._polylineM.setMode(1),this._polylineM.start()):"TRIANGLE_DISTANCE"===e.newValue?(this._polylineM.setMode(2),this._polylineM.start()):"SPACE_AREA"===e.newValue&&(this._polylineM.setMode(3),this._polylineM.start())})))}set resultCallback(e){this._pointM.resultCallback=e,this._polylineM.resultCallback=e}get resultCallback(){return this._pointM.resultCallback}clearResults(){this._pointM.clearResults(),this._polylineM.clearResults()}destroy(){return this._listenerDisposer1=this._listenerDisposer1&&this._listenerDisposer1(),this._listenerDisposer2=this._listenerDisposer2&&this._listenerDisposer2(),this._observerDisposer=this._observerDisposer&&this._observerDisposer(),super.destroy()}}const Jl=Xl;class Kl extends h.Z{constructor(e){super(),this._earth=e,this._gvolCutFillComputing=new Cesium.XbsjCutFillComputing,this._resultGraphics=this._earth.czm.scene.primitives.add(new Cesium.XbsjCutFillResultGraphics),(0,P.extendObservable)(this,{enabled:!1,gridWidth:1,height:0,positions:[],computing:!1,progress:0,results:{gridWidth:1,area:0,cut:0,fill:0,total:0},get status(){return this._initial?"initial":this.enabled?"running":this._completed?"completed":"cancelled"},_initial:!0,_completed:!1},{status:P.computed}),this._disposers=this._disposers||[],this._disposers.push((0,P.observe)(this,"enabled",(e=>{this._initial=!1,e.newValue&&this._start()}))),this._disposers.push((0,P.intercept)(this,(e=>("enabled"===e.name&&"update"===e.type&&e.newValue&&(this._initial=!0,this._completed=!1),e)))),this._disposers.push((0,P.intercept)(this,"enabled",(e=>(e.newValue||this._cancel(),e))))}get editingBinding(){return this._earth.interaction.flattenedPolygonCreatingBinding}_start(){this.positions.length=0,this.height=0,this.editingBinding.target=this,this._beforeFlattenedEditingDisabled=(0,P.intercept)(this.editingBinding,(e=>{if("target"===e.name&&"update"===e.type){if(e.newValue)throw new Error("changed.newValue should not be true!");if(this.editingBinding.heightEditing.editing.steps.lastStep){this._cancelFlattenedPolygonEditing();const e=[],t=this.positions.length/2;for(let i=0;i<t;++i)e.push(Cesium.Cartesian3.fromRadians(this.positions[2*i],this.positions[2*i+1],0));this.computing=!0;const i=this._gvolCutFillComputing.area(e),r=this.gridWidth;this.progress=0,this._gvolCutFillComputing.compute(e,r,this.height,this._earth.czm.scene,(e=>{e.area=i,e.gridWidth=r,this._getResult(e),this.computing=!1,this._completed=!0,this.enabled=!1}),(e=>{this.progress=e}),(e=>{this.enabled=!1}))}else this.enabled=!1;return null}return e}))}_cancel(){this.editingBinding.target&&this._cancelFlattenedPolygonEditing(),this.computing&&this._cancelComputing()}_cancelFlattenedPolygonEditing(){if(!this._beforeFlattenedEditingDisabled)throw new Error("should not be undefined!");this._beforeFlattenedEditingDisabled(),this.editingBinding.target=void 0}_cancelComputing(){this.computing&&(this._gvolCutFillComputing.cancel(),this.computing=!1)}_getResult(e){var{heightCartesians:t,clampCartesians:i,diffHeights:r,cut:n,fill:o,total:s,area:a,gridWidth:l}=e;const h=this._resultGraphics;h.heightCartesians=t,h.clampCartesians=i,h.diffHeights=r,h.gridWidth=l,this.results.gridWidth=l,this.results.area=a,this.results.cut=n,this.results.fill=o,this.results.total=s}clearResults(){this._resultGraphics.clear();const e=this.results;this._initial=!0,this._completed=!1,this.computing=!1,e.gridWidth=0,e.area=0,e.cut=0,e.fill=0,e.total=0}destroy(){return this._disposers.forEach((e=>e())),this._earth.czm.scene.primitives.remove(this._resultGraphics),this._gvolCutFillComputing=this._gvolCutFillComputing&&this._gvolCutFillComputing.destroy(),super.destroy()}}const Vl=Kl;var ql=i(5108);class $l extends h.Z{constructor(e){super(),this._earth=e,this._gvolCutFillComputing=new Cesium.XbsjCutFillComputing,this.disposers.push((()=>{this._gvolCutFillComputing.cancel(),this._gvolCutFillComputing=this._gvolCutFillComputing&&this._gvolCutFillComputing.destroy()})),this._resultGraphics=this._earth.czm.scene.primitives.add(new Cesium.XbsjCutFillResultGraphics),this.disposers.push((()=>{this._earth.czm.scene.primitives.remove(this._resultGraphics)})),(0,P.extendObservable)(this,{showHelper:!0,gridWidth:1,height:0,positions:[],computing:!1,progress:0,results:{gridWidth:1,area:0,cut:0,fill:0,total:0}}),this.disposers.push((0,ae.V$)(this._earth,this,{polygonCreating:"polygonCreating"})),this._polygon=new Pi.Z(this._earth),this.disposers.push((()=>{this._polygon=this._polygon&&this._polygon.destroy()}));const t=()=>{this._polygon.positions=[...this.positions],this._polygon.height=this.height,this._polygon.show=this.showHelper};t(),this.disposers.push((0,P.reaction)((()=>({positions:[...this.positions],height:this.height,showHelper:this.showHelper})),t)),this.disposers.push((()=>{this._cancelComputing()}))}get editingBinding(){return this._earth.interaction.editingPolygonBinding}compute(){const e=[],t=this.positions.length/2;for(let i=0;i<t;++i)e.push(Cesium.Cartesian3.fromRadians(this.positions[2*i],this.positions[2*i+1],0));if(e.length<3)return void ql.warn("请创建挖填方区域！");const i=this._gvolCutFillComputing.area(e),r=this.gridWidth;this.progress=0,this._cancelComputing(),this.computing=!0,this._gvolCutFillComputing.compute(e,r,this.height,this._earth.czm.scene,(e=>{e.area=i,e.gridWidth=r,this._getResult(e),this.computing=!1}),(e=>{this.progress=e}),(e=>{this._cancelComputing()}))}_cancelComputing(){this.computing&&(this._gvolCutFillComputing.cancel(),this.computing=!1)}_getResult(e){var{heightCartesians:t,clampCartesians:i,diffHeights:r,cut:n,fill:o,total:s,area:a,gridWidth:l}=e;const h=this._resultGraphics;h.heightCartesians=t,h.clampCartesians=i,h.diffHeights=r,h.gridWidth=l,this.results.gridWidth=l,this.results.area=a,this.results.cut=n,this.results.fill=o,this.results.total=s}clearResults(){this._cancelComputing(),this._resultGraphics.clear();const e=this.results;this._initial=!0,this._completed=!1,this.computing=!1,e.gridWidth=0,e.area=0,e.cut=0,e.fill=0,e.total=0}}const eh=$l;var th=i(6716),ih=i(5108),rh=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),nh=function(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],r=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},oh=function(e){function t(t){var i,r=e.call(this)||this;return r.engineViewer=t,r.measureShow=!1,r.isBrowserPageShow=!1,r.is2D=!1,r.itemList=[{icon:"iconfont gp-celiangzhixian",label:"直线距离",alias:"zhixianjuli"},{icon:"iconfont gp-tiedijuli",label:"贴地距离",alias:"tiedijuli"},{icon:"iconfont gp-celiangmianji",label:"面积量测",alias:"mianji"},{icon:"iconfont gp-celianggaodu",label:"高度量测",alias:"gaodu"},{icon:"iconfont gp-celiangfangwei",label:"方位量测",alias:"fangxiangjiao"},{icon:"iconfont gp-shanchu2",label:"清空",alias:"shanchu"}],r.labelHandler=null,r.areaPointsNum=0,r.measureHandler=null,r.result="",r.measureEntities={line:[],lineTerrain:[],area:[],height:[],angle:[]},r.tempDistanceLabelArr=[],r.anglePosition="",r.currentFeature=[],r.terrainDistance=0,r.areaHierarchy="",r.calculateLevel=1,r.ctlPoints=[],r.measureResultData=[],r.measureResult="noResult",r.browserToolBoxRef$=new th.x,r.isMobileMeasure=!1,r.mobileMeasureComponentRef$=new th.x,r.isUndoEnable=!1,r.pickEyeOffset=1,r.isAddPointEnable=!1,r.isAreaEndShow=!1,r.isRedoEnable=!1,r.pointInHollArr=[],r.isUndoAble=!1,r.isRedoAble=!1,r.mobileOnceMeasureEnd=!1,r.isPositiveOrNegative="positive",r.cxCtlPoints=[],r.heightDataLabels=[],r.heightDrawCtlPoint=[],r.tdLineArr=[],r.tdPointArr=[],r.tdLineTerrain=[],r.mobileItemList=[{icon:"iconfont gp-celiangzhixian",label:"距离量测",alias:"zhixianjuli",unselectPic:"/resources/images/mobile/mobile-distance.svg",selectPic:"/resources/images/mobile/mobile-distance-select.png",units:["公里","米"]},{icon:"iconfont gp-celiangmianji",label:"面积量测",alias:"mianji",unselectPic:"/resources/images/mobile/mobile-areaspace.svg",selectPic:"/resources/images/mobile/mobile-areaspace-select.png",units:["平方公里","平方米"]},{icon:"font_family icon-podu",label:"当前高度",alias:"currentHeight",unselectPic:"/resources/images/mobile/mobile-currentheight.svg",selectPic:"/resources/images/mobile/mobile-currentheight-select.png",units:["米","英尺"]},{icon:"iconfont gp-celianggaodu",label:"高度差",alias:"gaodu",unselectPic:"/resources/images/mobile/mobile-heightspace.svg",selectPic:"/resources/images/mobile/mobile-heightspace-select.png",units:["米","英尺"]}],r.lineTrrrainTemp=[],r.viewer=r.engineViewer,r.depthTest=r.viewer.scene.globe.depthTestAgainstTerrain,r.viewer.scene.globe.depthTestAgainstTerrain=!1,r.addMouseInfoEntity(),r.labelHandler=new Cesium.ScreenSpaceEventHandler(r.viewer.scene.canvas),r.labelHandler.setInputAction((function(e){r.calculateMouseEvent(e);var t=r.viewer.camera.getPickRay(e.endPosition);i=r.viewer.scene.globe.pick(t,r.viewer.scene),Cesium.defined(i)&&(r.pointLabel.position=i)}),Cesium.ScreenSpaceEventType.MOUSE_MOVE),r.createQuickOperator(),r}return rh(t,e),t.prototype.resetSelectItem=function(){this.selectedItem&&("tiedijuli"===this.selectedItem.alias||"gaodu"===this.selectedItem.alias||"currentHeight"===this.selectedItem.alias||"zhixianjuli"===this.selectedItem.alias&&this.isMobileMeasure)&&(this.selectedItem=null)},t.prototype.begin=function(e,t){var i=this;if(void 0===t&&(t=!1),this.mobileOnceMeasureEnd=!1,(this.isBrowserPageShow||this.isMobileMeasure)&&(this.viewer.scene.globe.depthTestAgainstTerrain=!1),this.pointLabel.label.text="",this.pointLabel.show=!1,t||(this.result=""),this.clearHandler(),this.selectedItem&&this.selectedItem.alias===e.alias&&!t&&"shanchu"!==e.alias)return this.selectedItem="",void this.changeMusDefaultType();switch(e.alias){case"zhixianjuli":this.measureDistance("space");break;case"tiedijuli":if(!1===this.measureTdDistance("terrain"))return;break;case"mianji":this.isMobileMeasure?this.mobileAreaSpace():this.areaSpace();break;case"gaodu":if(this.isMobileMeasure){if(!1===this.mobileHeightSpace())return}else if(!1===this.heightSpace())return;break;case"fangxiangjiao":this.azimuthAngle();break;case"shanchu":this.initStatus(),this.selectedItem&&this.begin(this.selectedItem,!0);break;case"currentHeight":if(!1===this.mobileCurrentHeight())return}"shanchu"!==e.alias&&(this.selectedItem=e),this.addMouseInfoEntity(),"mianji"===e.alias||"zhixianjuli"===e.alias||"tiedijuli"===e.alias?(this.pointLabel.label.text=new Cesium.CallbackProperty((function(){return i.areaPointsNum>1?"左键继续绘制,右键取消绘制":"左键单击开始绘制"}),!1),this.pointLabel.show=!0):"gaodu"===e.alias&&(this.pointLabel.show=!0),this.isMobileMeasure&&(this.pointLabel.show=!1)},t.prototype.end=function(e,t){var i=this;void 0===t&&(t=!1),ih.log(e),this.pointLabel.label.text="",this.pointLabel.show=!1,this.clearHandler(),this.selectedItem&&this.selectedItem.alias===e.alias&&!t&&"shanchu"!==e.alias&&(this.selectedItem="",this.changeMusDefaultType()),this.measureHandler=new Cesium.ScreenSpaceEventHandler(this.viewer.scene.canvas),this.measureHandler.setInputAction((function(t){"mianji"===e.alias?(i.objs=i.viewer.scene.pick(t.position,2),i.objs.id._id&&(i.mianjiId=i.objs.id._id)):"zhixianjuli"===e.alias&&(i.objs=i.viewer.scene.pick(t.position,5),ih.log(i.objs.primitive._id._id),ih.log(i.measureEntities),i.zhixianjuliId=i.objs.primitive._id._id)}),Cesium.ScreenSpaceEventType.LEFT_CLICK)},t.prototype.clearHandler=function(){this.measureHandler&&(this.measureHandler.destroy(),this.measureHandler=void 0)},t.prototype.ControlMouseEvent=function(e){this.viewer.scene.screenSpaceCameraController.enableTranslate=e,this.viewer.scene.screenSpaceCameraController.enableLook=e,this.viewer.scene.screenSpaceCameraController.enableTilt=e,this.viewer.scene.screenSpaceCameraController.enableZoom=e,this.viewer.scene.screenSpaceCameraController.enableRotate=e},t.prototype.initStatus=function(){var e,t,i=this;for(var r in this.result="",this.measureEntities){try{for(var n=(e=void 0,nh(this.measureEntities[r])),o=n.next();!o.done;o=n.next()){var s=o.value;this.viewer.entities.removeById(s)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this.measureEntities[r]=[]}this.pointLabel&&(this.pointLabel.show=!1),this.currentFeature.forEach((function(e){i.viewer.entities.removeById(e)})),this.clearHandler(),this.currentFeature=[],this.tempDistanceLabelArr=[],this.measureEntities={line:[],lineTerrain:[],area:[],height:[],angle:[]},this.ctlPoints.forEach((function(e){i.viewer.entities.removeById(e)})),this.ctlPoints=[],this.cxCtlPoints.forEach((function(e){i.viewer.entities.removeById(e)})),this.cxCtlPoints=[],this.endMobileMeasure=null,this.undoMobileMeasure=null,this.redoMobileMeasure=null,this.heightDataLabels.forEach((function(e){i.viewer.entities.removeById(e)})),this.heightDataLabels=[],this.sceneNeedRender()},t.prototype.formatArea=function(e){var t;if(null==e)t="";else if(Number(e)){var i=Number(e);t=i<1?Math.ceil(1e6*i)+" 平方米":i>1e4?(i/1e4).toFixed(2)+"万 平方公里":i.toFixed(2)+" 平方公里"}else t="";return this.measureResult=t,t},t.prototype.formatLength=function(e,t){var i;return i=null===e?"":t?Number(e)>=0?parseInt(e)+" 米":"":Number(e)>=0?(e/1e3).toFixed(2)+" 公里":"","zhixianjuli"!==this.selectedItem.alias&&(this.measureResult=i),i},t.prototype.measureDistance=function(e){var t=this;this.isUndoEnable=!0,this.isRedoEnable=!0;var i=[],r=[];this.areaPointsNum=i.length;var n,o=null,s=null,a=!1;this.measureHandler=new Cesium.ScreenSpaceEventHandler(this.viewer.scene.canvas),this.terrainDistance=0;var l=[];this.isMobileMeasure||this.measureHandler.setInputAction((function(e){if(t.calculateMouseEvent(e),s=t.getPosition(e.endPosition),Cesium.defined(s)&&(1===i.length&&i.push(s),i.length>=2))if(Cesium.defined(o))i.pop(),i.push(s),a=!1,t.getSpaceDistance(i,a,"mousemove");else{var r=t.drawPolyline(i,!1,"zhixianjuli");o=r[0],n=r[1]}}),Cesium.ScreenSpaceEventType.MOUSE_MOVE),this.measureHandler.setInputAction((function(e){if(l=[],t.isUndoAble=!0,t.isRedoAble=!1,t.calculateMouseEvent(e),s=t.getPosition(e.position),t.isMobileMeasure){var n=Cesium.Cartographic.fromCartesian(s),o=Cesium.Math.toDegrees(n.longitude),h=Cesium.Math.toDegrees(n.latitude);s=Cesium.Cartesian3.fromDegrees(o,h,0)}if(Cesium.defined(s)){0===i.length&&(t.result=""),i.push(s),a=!0,i.length>(t.isMobileMeasure?1:2)&&(t.getSpaceDistance(i,a,"leftclick").then((function(e){t.isMobileMeasure&&t.measureEntities.lineTerrain.forEach((function(e){t.viewer.entities.removeById(e)})),t.pointDisplay(i[i.length-1],a,e)})),t.isMobileMeasure&&t.drawPolyline(i,!1,"zhixianjuli")),t.areaPointsNum=i.length;var c=t.addCtlPoint(s.clone());t.ctlPoints.push(c.id),r.push(c.id),t.isUndoAble=!0,t.mobileMeasureComponentRef$.next(1)}}),Cesium.ScreenSpaceEventType.LEFT_CLICK),this.isMobileMeasure||this.measureHandler.setInputAction((function(o){r.forEach((function(e){t.viewer.entities.removeById(e)})),t.sceneNeedRender(),t.calculateMouseEvent(o),t.clearHandler(),i.pop(),t.tempDistanceLabelArr=[],a=!1,"space"===e&&(t.measureEntities.line=t.measureEntities.line.concat(JSON.parse(JSON.stringify(t.currentFeature))),i.length&&(n.position=i[i.length-1],n.label.text=t.result,t.viewer.entities.removeById(n.id),t.sceneNeedRender(),n="")),t.saveMeasureResult(t.selectedItem),t.isBrowserPageShow?(t.selectedItem="",t.pointLabel.show=!1,t.browserToolBoxRef$.next(1)):t.begin(t.selectedItem,!0)}),Cesium.ScreenSpaceEventType.RIGHT_CLICK),this.endMobileMeasure=function(n){t.selectedItem&&(i.length<2&&(r.forEach((function(e){t.viewer.entities.removeById(e)})),t.sceneNeedRender()),t.clearHandler(),t.tempDistanceLabelArr=[],a=!1,"space"===e&&(t.measureEntities.line=t.measureEntities.line.concat(JSON.parse(JSON.stringify(t.currentFeature)))),n&&t.saveMeasureResult(t.selectedItem),t.selectedItem="",t.pointLabel.show=!1)},this.undoMobileMeasure=function(){if(t.selectedItem&&!t.mobileOnceMeasureEnd&&(!i||0!==i.length)){t.ctlPoints.pop();var e=r.pop();e&&t.viewer.entities.removeById(e),l.push(i.pop()),t.isRedoAble=!0,0===i.length&&(t.isUndoAble=!1),a=!0,t.getSpaceDistance(i,a,"leftclick").then((function(e){t.isMobileMeasure&&t.measureEntities.lineTerrain.forEach((function(e){t.viewer.entities.removeById(e)})),i.length>1&&t.pointDisplay(i[i.length-1],a,e),t.sceneNeedRender()})),t.sceneNeedRender()}},this.redoMobileMeasure=function(){if(t.selectedItem&&!t.mobileOnceMeasureEnd&&0!==l.length){var e=l.pop();t.isUndoAble=!0,0===l.length&&(t.isRedoAble=!1),i.push(e);var n=t.addCtlPoint(i[i.length-1].clone());t.ctlPoints.push(n.id),r.push(n.id),a=!0,t.getSpaceDistance(i,a,"leftclick").then((function(e){t.isMobileMeasure&&t.measureEntities.lineTerrain.forEach((function(e){t.viewer.entities.removeById(e)})),i.length>1&&t.pointDisplay(i[i.length-1],a,e),t.sceneNeedRender()})),t.sceneNeedRender()}}},t.prototype.measureTdDistance=function(e){var t=this;if(!this.viewer.terrainProvider.availability)return ih.log("请先开启地形服务"),!1;var i=[],r=[],n=null,o=null;this.measureHandler=new Cesium.ScreenSpaceEventHandler(this.viewer.scene.canvas),this.terrainDistance=0,this.isMobileMeasure||this.measureHandler.setInputAction((function(e){t.calculateMouseEvent(e),o=t.getPosition(e.endPosition),Cesium.defined(o)&&i.length>=2&&(Cesium.defined(n)?(i.pop(),i.push(o)):n=t.drawPolyline(i))}),Cesium.ScreenSpaceEventType.MOUSE_MOVE),this.measureHandler.setInputAction((function(n){if(t.isMobileMeasure){var s=t.viewer.scene.pick(n.position);if(Cesium.defined(s)&&s.id&&s.id.label)return t.measureEntities.lineTerrain.forEach((function(e){var i=t.viewer.entities.getById(e);i&&(i.label.eyeOffset=Cesium.Cartesian3.ZERO)})),t.pickEyeOffset=t.pickEyeOffset+1,void(s.id.label.eyeOffset=new Cesium.Cartesian3(0,0,-5e3))}if(t.calculateMouseEvent(n),o=t.getPosition(n.position),Cesium.defined(o)){0===i.length&&(t.result="",i.push(o.clone())),i.push(o),i.length>2&&("terrain"===e&&t.getTerrainDistance(i),t.isMobileMeasure&&t.drawPolyline(i)),t.areaPointsNum=i.length;var a=t.addCtlPoint(o.clone());t.ctlPoints.push(a.id),r.push(a.id)}}),Cesium.ScreenSpaceEventType.LEFT_CLICK),this.isMobileMeasure||this.measureHandler.setInputAction((function(e){r.forEach((function(e){t.viewer.entities.removeById(e)})),t.calculateMouseEvent(e),t.clearHandler(),i.pop(),t.measureEntities.lineTerrain=t.measureEntities.lineTerrain.concat(JSON.parse(JSON.stringify(t.currentFeature))),t.tempDistanceLabelArr=[],t.saveMeasureResult(t.selectedItem),t.isBrowserPageShow?(t.selectedItem="",t.pointLabel.show=!1,t.browserToolBoxRef$.next(1)):t.begin(t.selectedItem,!0),t.pointLabel.label.text="",t.pointLabel.show=!1,document.getElementById("operator1").style.display="flex"}),Cesium.ScreenSpaceEventType.RIGHT_CLICK),this.endMobileMeasure=function(){t.selectedItem&&(i.length<=2&&r.forEach((function(e){t.viewer.entities.removeById(e)})),t.clearHandler(),t.measureEntities.lineTerrain=t.measureEntities.lineTerrain.concat(JSON.parse(JSON.stringify(t.currentFeature))),t.tempDistanceLabelArr=[],"space"===e&&(t.measureEntities.line=t.measureEntities.line.concat(JSON.parse(JSON.stringify(t.currentFeature)))),t.selectedItem="",t.pointLabel.show=!1,t.sceneNeedRender())}},t.prototype.areaSpace=function(){var e=this;this.isUndoEnable=!0,this.isRedoEnable=!0,this.currentFeature=[],this.measureHandler=new Cesium.ScreenSpaceEventHandler(this.viewer.scene.canvas);var t=[],i=[];this.areaPointsNum=t.length;var r=[],n=null,o=null;this.pointInHollArr=[],this.cxCtlPoints=this.cxCtlPoints.concat(this.ctlPoints),this.ctlPoints=[],this.measureHandler.setInputAction((function(i){if(e.calculateMouseEvent(i),o=e.getPosition(i.endPosition),Cesium.defined(o)&&t.length>=2)if(Cesium.defined(n)){t.pop(),t.push(o),r.pop();var s=Cesium.Cartographic.fromCartesian(t[t.length-1]),a=Cesium.Math.toDegrees(s.longitude),l=Cesium.Math.toDegrees(s.latitude);r.push([a,l]),e.showAvailablePointsInAreaSpace(r)}else n=e.drawPolygon(t)}),Cesium.ScreenSpaceEventType.MOUSE_MOVE),this.measureHandler.setInputAction((function(n){if([],e.isUndoAble=!0,e.isRedoAble=!1,e.calculateMouseEvent(n),o=e.getPosition(n.position),Cesium.defined(o)){var s=Cesium.Cartographic.fromCartesian(o),a=Cesium.Math.toDegrees(s.longitude),l=Cesium.Math.toDegrees(s.latitude);if(o=Cesium.Cartesian3.fromDegrees(a,l,0),0===t.length){e.result="",t.push(o.clone());var h=Cesium.Cartographic.fromCartesian(o),c=Cesium.Math.toDegrees(h.longitude),u=Cesium.Math.toDegrees(h.latitude);r.push([c,u])}t.push(o);var p=Cesium.Cartographic.fromCartesian(t[t.length-1]),d=Cesium.Math.toDegrees(p.longitude),m=Cesium.Math.toDegrees(p.latitude);r.push([d,m]),e.areaPointsNum=t.length;var f=e.addCtlPoint(o.clone());e.ctlPoints.push(f.id),i.push(f.id),e.pointInHollArr[e.pointInHollArr.length-1]&&ih.log("此点不计入面积量测结果"),e.isUndoAble=!0}}),Cesium.ScreenSpaceEventType.LEFT_CLICK),this.measureHandler.setInputAction((function(n){ih.log(n),i.forEach((function(t){e.viewer.entities.removeById(t)})),i.forEach((function(t){e.viewer.entities.removeById(t)})),e.calculateMouseEvent(n),e.clearHandler(),t.pop(),r.pop(),e.drawPolygon(t,!1,r);var o=e.getArea([r]);e.result=e.formatArea(o);var s=e.viewer.entities.getById(e.currentFeature[e.currentFeature.length-1]);if(s){var a=Cesium.BoundingSphere.fromPoints(s.polygon.hierarchy.getValue().positions).center;s.position=a,s.label={text:e.result?e.result:"",font:"15px PingFangSC,arial,sans-serif",fillColor:Cesium.Color.BLACK,style:Cesium.LabelStyle.FILL_AND_OUTLINE,outlineColor:Cesium.Color.WHITE,outlineWidth:4,pixelOffset:new Cesium.Cartesian3(0,-10,0),heightReference:Cesium.HeightReference.CLAMP_TO_GROUND}}e.measureEntities.area=e.measureEntities.area.concat(JSON.parse(JSON.stringify(e.currentFeature))),e.areaPointsNum=t.length;var l=e.areaHierarchy;s&&(s.polygon.hierarchy.setCallback((function(){return l}),!1),s.label.text=e.result),e.showAvailablePointsInAreaSpace(r),e.saveMeasureResult(e.selectedItem),e.isBrowserPageShow?(e.selectedItem="",e.pointLabel.show=!1,e.browserToolBoxRef$.next(1)):e.begin(e.selectedItem,!0)}),Cesium.ScreenSpaceEventType.RIGHT_CLICK)},t.prototype.createQuickOperator=function(){},t.prototype.mobileAreaSpace=function(){var e=this;this.isUndoEnable=!0,this.isRedoEnable=!0,this.currentFeature=[],this.measureHandler=new Cesium.ScreenSpaceEventHandler(this.viewer.scene.canvas);var t=[],i=[];this.areaPointsNum=t.length;var r=[],n=null,o=null,s=[];this.pointInHollArr=[],this.isMobileMeasure||this.isBrowserPageShow||this.measureHandler.setInputAction((function(i){e.calculateMouseEvent(i),o=e.getPosition(i.endPosition),Cesium.defined(o)&&t.length>=2&&(Cesium.defined(n)?(t.pop(),t.push(o)):n=e.drawPolygon(t))}),Cesium.ScreenSpaceEventType.MOUSE_MOVE),this.measureHandler.setInputAction((function(n){if(s=[],e.isUndoAble=!0,e.isRedoAble=!1,e.calculateMouseEvent(n),o=e.getPosition(n.position),Cesium.defined(o)){if(e.isMobileMeasure||e.isBrowserPageShow){var a=Cesium.Cartographic.fromCartesian(o),l=Cesium.Math.toDegrees(a.longitude),h=Cesium.Math.toDegrees(a.latitude);o=Cesium.Cartesian3.fromDegrees(l,h,0)}0===t.length&&(e.result="",e.isMobileMeasure||e.isBrowserPageShow||t.push(o.clone())),t.push(o);var c=Cesium.Cartographic.fromCartesian(t[t.length-1]),u=Cesium.Math.toDegrees(c.longitude),p=Cesium.Math.toDegrees(c.latitude);r.push([u,p]),e.areaPointsNum=t.length;var d=e.addCtlPoint(o.clone());e.ctlPoints.push(d.id),i.push(d.id),(e.isMobileMeasure||e.isBrowserPageShow)&&(e.drawPolygon(t,!1,r),e.endMobileMeasure&&e.endMobileMeasure()),e.pointInHollArr[e.pointInHollArr.length-1]&&ih.log("此点不计入面积量测结果"),e.isUndoAble=!0,e.mobileMeasureComponentRef$.next(1)}}),Cesium.ScreenSpaceEventType.LEFT_CLICK),this.isMobileMeasure||this.measureHandler.setInputAction((function(n){if(e.isBrowserPageShow){e.clearHandler();var o=e.getArea([r.filter((function(t,i){return!e.pointInHollArr[i]}))]);return e.result=e.formatArea(o),e.pointLabel.show=!1,e.saveMeasureResult(e.selectedItem),e.selectedItem="",void e.browserToolBoxRef$.next(1)}t.length<=3&&i.forEach((function(t){e.viewer.entities.removeById(t)})),e.calculateMouseEvent(n),e.clearHandler(),t.pop();var s=e.getArea([r]);e.result=e.formatArea(s);var a=e.viewer.entities.getById(e.currentFeature[e.currentFeature.length-1]);if(a){var l=Cesium.BoundingSphere.fromPoints(a.polygon.hierarchy.getValue(Cesium.JulianDate.now()).positions).center;a.position=l,a.label={text:e.result?e.result:"",font:"15px PingFangSC,arial,sans-serif",fillColor:Cesium.Color.BLACK,style:Cesium.LabelStyle.FILL_AND_OUTLINE,outlineColor:Cesium.Color.WHITE,outlineWidth:4,pixelOffset:new Cesium.Cartesian3(0,-10,0),heightReference:Cesium.HeightReference.CLAMP_TO_GROUND}}e.measureEntities.area=e.measureEntities.area.concat(JSON.parse(JSON.stringify(e.currentFeature))),e.areaPointsNum=t.length;var h=e.areaHierarchy;a&&(a.polygon.hierarchy.setCallback((function(){return h}),!1),a.label.text=e.result),e.saveMeasureResult(e.selectedItem),e.isBrowserPageShow?(e.selectedItem="",e.pointLabel.show=!1,e.browserToolBoxRef$.next(1)):e.begin(e.selectedItem,!0)}),Cesium.ScreenSpaceEventType.RIGHT_CLICK),this.endMobileMeasure=function(o,s){if(void 0===o&&(o=!1),void 0===s&&(s=!1),e.selectedItem){if(t.length<=2&&o&&!s)i.forEach((function(t){e.viewer.entities.removeById(t)}));else if(!o&&t.length<=2)return;if(o)e.clearHandler();else{var a=e.getArea([r.filter((function(t,i){return!e.pointInHollArr[i]}))]);if(e.result=e.formatArea(a),n=e.viewer.entities.getById(e.currentFeature[e.currentFeature.length-1])){var l=Cesium.BoundingSphere.fromPoints(n.polygon.hierarchy.getValue(Cesium.JulianDate.now()).positions).center;n.position=l,n.label={text:e.result?e.result:"",font:"12px PingFangSC,arial,sans-serif",fillColor:Cesium.Color.BLACK,style:Cesium.LabelStyle.FILL_AND_OUTLINE,outlineColor:Cesium.Color.WHITE,outlineWidth:4,horizontalOrigin:Cesium.HorizontalOrigin.CENTER,verticalOrigin:Cesium.VerticalOrigin.CENTER,heightReference:e.is2D?Cesium.HeightReference.NONE:Cesium.HeightReference.CLAMP_TO_GROUND}}e.measureEntities.area=e.measureEntities.area.concat(JSON.parse(JSON.stringify(e.currentFeature))),e.areaPointsNum=t.length;var h=e.areaHierarchy;n&&(n.polygon.hierarchy.setCallback((function(){return h}),!1),n.label.text=e.result)}o&&(e.pointLabel.show=!1,e.saveMeasureResult(e.selectedItem),e.selectedItem=""),e.reDrawPointInAreaSpace(),e.sceneNeedRender()}},this.undoMobileMeasure=function(){var o;if(e.selectedItem&&!e.mobileOnceMeasureEnd&&(!r||0!==r.length)&&0!==t.length){e.ctlPoints.pop();var a=i.pop();a&&e.viewer.entities.removeById(a);var l=t.splice(t.length-1,1)[0];s.push(l),r.pop(),e.isRedoAble=!0,0===t.length&&(e.isUndoAble=!1);var h=null===(o=e.measureEntities.lineTerrain)||void 0===o?void 0:o.pop();h&&e.viewer.entities.removeById(h),r.length>2?(n=e.drawPolygon(t,!1,r),e.endMobileMeasure&&e.endMobileMeasure()):e.viewer.entities.removeById(null==n?void 0:n.id),e.endMobileMeasure&&e.endMobileMeasure(!1,!0),e.sceneNeedRender()}},this.redoMobileMeasure=function(){if(e.selectedItem&&!e.mobileOnceMeasureEnd&&0!==s.length){t.push(s.pop()),e.isUndoAble=!0,0===s.length&&(e.isRedoAble=!1);var n=t[t.length-1],o=Cesium.Cartographic.fromCartesian(n),a=Cesium.Math.toDegrees(o.longitude),l=Cesium.Math.toDegrees(o.latitude);r.push([a,l]),e.areaPointsNum=t.length;var h=e.addCtlPoint(n);e.ctlPoints.push(h.id),i.push(h.id),r.length>2&&(e.drawPolygon(t,!1,r),e.endMobileMeasure&&e.endMobileMeasure()),e.sceneNeedRender()}}},t.prototype.heightSpace=function(){var e=this;if(!this.viewer.terrainProvider.availability)return ih.log("请先开启地形服务"),!1;var t=[],i=[],r=null,n=null;this.measureHandler=new Cesium.ScreenSpaceEventHandler(this.viewer.scene.canvas),this.isMobileMeasure||this.measureHandler.setInputAction((function(i){e.calculateMouseEvent(i),n=e.getPosition(i.endPosition),Cesium.defined(n)&&t.length>=2&&(Cesium.defined(r)?(t.pop(),t.push(n)):r=e.drawPolyline(t))}),Cesium.ScreenSpaceEventType.MOUSE_MOVE),this.measureHandler.setInputAction((function(r){if(e.calculateMouseEvent(r),n=e.getPosition(r.position),Cesium.defined(n)){0===t.length?t.push(n.clone()):2===t.length&&(e.clearHandler(),e.pointLabel.show=!1,e.getHeight(t).then((function(t){e.saveMeasureResult(e.selectedItem),e.isBrowserPageShow?(e.selectedItem="",e.browserToolBoxRef$.next(1)):e.begin(e.selectedItem,!0)})),t.pop()),t.push(n);var o=e.addCtlPoint(n.clone());e.ctlPoints.push(o.id),i.push(o.id),e.heightDrawCtlPoint.push(o.id),ih.log(i,"drawCtlPoint")}}),Cesium.ScreenSpaceEventType.LEFT_CLICK),this.measureHandler.setInputAction((function(e){}),Cesium.ScreenSpaceEventType.RIGHT_CLICK)},t.prototype.mobileHeightSpace=function(){var e=this;if(!this.viewer.terrainProvider.availability)return ih.log("请先开启地形服务"),!1;this.isUndoEnable=!0,this.isRedoEnable=!0;var t=[],i=[],r=[],n=null,o=null,s=[];this.ctlPoints=[],this.heightDataLabels=[],this.measureHandler=new Cesium.ScreenSpaceEventHandler(this.viewer.scene.canvas),this.measureHandler.setInputAction((function(t){if(e.calculateMouseEvent(t),o=e.getPosition(t.position),Cesium.defined(o)){i.push(o),i.length<=2&&e.getCurrentHeight(o.clone()).then((function(t){e.heightDataLabels.push(t.id),s.push(parseFloat(t.label.text.getValue())),2===s.length&&(e.clearHandler(),e.pointLabel.show=!1,Cesium.defined(n)||(n=e.drawPolyline(i,!0)),e.showResultInHeight(Cesium.Cartesian3.lerp(i[0],i[1],.5,new Cesium.Cartesian3),s[1]-s[0]),e.measureResult="".concat(s[1]-s[0]," 米"),e.saveMeasureResult(e.selectedItem),e.selectedItem="",e.browserToolBoxRef$.next(1),e.mobileMeasureComponentRef$.next(1))}));var a=e.addCtlPoint(o.clone());e.ctlPoints.push(a.id),r.push(a.id)}}),Cesium.ScreenSpaceEventType.LEFT_CLICK),this.endMobileMeasure=function(t){e.selectedItem&&(1!==i.length||ih.log("请选择两个点"))},this.undoMobileMeasure=function(){if(e.selectedItem&&!e.mobileOnceMeasureEnd&&(!i||0!==i.length)){var n=e.heightDataLabels.pop();n&&e.viewer.entities.removeById(n);var o=r.pop();o&&e.viewer.entities.removeById(o),s.pop(),t.push(i.pop()),e.isRedoAble=!0,0===i.length&&(e.isUndoAble=!1),!0,e.sceneNeedRender()}},this.redoMobileMeasure=function(){if(e.selectedItem&&!e.mobileOnceMeasureEnd&&0!==t.length){var n=t.pop();e.isUndoAble=!0,0===t.length&&(e.isRedoAble=!1),i.push(n);var o=e.addCtlPoint(i[i.length-1].clone());e.ctlPoints.push(o.id),r.push(o.id),!0,r.length<=2&&e.getCurrentHeight(n.clone()).then((function(t){e.heightDataLabels.push(t.id),s.push(parseFloat(t.label.text.getValue())),e.sceneNeedRender()})),e.sceneNeedRender()}}},t.prototype.mobileCurrentHeight=function(){var e=this;if(!this.viewer.terrainProvider.availability)return ih.log("请先开启地形服务"),!1;this.isUndoEnable=!0,this.isRedoEnable=!0;var t=[],i=[],r=null;this.measureHandler=new Cesium.ScreenSpaceEventHandler(this.viewer.scene.canvas),this.measureHandler.setInputAction((function(n){if(e.calculateMouseEvent(n),r=e.getPosition(n.position),Cesium.defined(r)){t.push(r),1===t.length&&(e.clearHandler(),e.pointLabel.show=!1,e.getCurrentHeight(r).then((function(t){e.saveMeasureResult(e.selectedItem),e.selectedItem="",e.browserToolBoxRef$.next(1),e.mobileMeasureComponentRef$.next(1)})));var o=e.addCtlPoint(r.clone());e.ctlPoints.push(o.id),i.push(o.id)}}),Cesium.ScreenSpaceEventType.LEFT_CLICK),this.isMobileMeasure&&this.measureHandler.setInputAction((function(e){}),Cesium.ScreenSpaceEventType.RIGHT_CLICK),this.endMobileMeasure=function(t){e.selectedItem&&(e.clearHandler(),e.selectedItem="",e.pointLabel.show=!1)}},t.prototype.azimuthAngle=function(){var e=this;this.measureHandler=new Cesium.ScreenSpaceEventHandler(this.viewer.scene.canvas);var t=[],i=this.generateAngleLabel(void 0),r=i[0];r.show=!1,r.polyline.positions=new Cesium.CallbackProperty((function(){return t}),!1);var n=i[1];n.show=!1,n.position=new Cesium.CallbackProperty((function(){return e.anglePosition}),!1),n.label.text=new Cesium.CallbackProperty((function(){return e.result}),!1),this.measureHandler.setInputAction((function(i){e.calculateMouseEvent(i),e.result="",e.ControlMouseEvent(!1);var o=e.viewer.camera.getPickRay(i.position);0==t.length&&t.push(e.viewer.scene.globe.pick(o,e.viewer.scene).clone()),t.push(e.viewer.scene.globe.pick(o,e.viewer.scene)),e.anglePosition=t[t.length-1];var s=e.viewer.camera.pickEllipsoid(i.position,e.viewer.scene.globe.ellipsoid),a=e.viewer.scene.globe.ellipsoid.cartesianToCartographic(s);Cesium.Math.toDegrees(a.longitude).toFixed(4),Cesium.Math.toDegrees(a.latitude).toFixed(4);e.measureHandler.setInputAction((function(i){e.calculateMouseEvent(i);var o=e.getPosition(i.endPosition);if(Cesium.defined(o)){t.pop(),t.push(o),e.anglePosition=t[t.length-1];var s=e.viewer.scene.globe.ellipsoid.cartesianToCartographic(o);Cesium.Math.toDegrees(s.longitude).toFixed(4),Cesium.Math.toDegrees(s.latitude).toFixed(4),e.computedAzimuthAngle(t),n.show=!0,r.show=!0}}),Cesium.ScreenSpaceEventType.MOUSE_MOVE),e.measureHandler.setInputAction((function(i){e.calculateMouseEvent(i),e.clearHandler();var r=e.viewer.camera.getPickRay(i.position),o=e.viewer.scene.globe.pick(r,e.viewer.scene);Cesium.defined(o)&&(t.pop(),t.push(o)),e.computedAzimuthAngle(t),e.ControlMouseEvent(!0),e.measureEntities.angle=e.measureEntities.angle.concat(JSON.parse(JSON.stringify(e.currentFeature))),n.position=e.anglePosition,n.label.text=e.result,e.saveMeasureResult(e.selectedItem),e.isBrowserPageShow||e.isMobileMeasure?(e.selectedItem="",e.pointLabel.show=!1,e.browserToolBoxRef$.next(1)):e.begin(e.selectedItem,!0)}),Cesium.ScreenSpaceEventType.LEFT_UP),ih.log(e.measureEntities.angle,";angleLabel")}),Cesium.ScreenSpaceEventType.LEFT_DOWN),this.measureHandler.setInputAction((function(e){}),Cesium.ScreenSpaceEventType.RIGHT_CLICK)},t.prototype.generateAngleLabel=function(e){this.currentFeature=[];var t=this.viewer.entities.add({name:"",polyline:{positions:e||"",width:10,followSurface:!1,material:new Cesium.PolylineArrowMaterialProperty(new Cesium.Color(227/255,196/255,46/255,1))}});this.currentFeature.push(t.id);var i=this.viewer.entities.add({name:"",position:e&&e.length?e[1]:"",label:{text:this.result?this.result:"",font:"15px PingFangSC,arial,sans-serif",fillColor:Cesium.Color.BLACK,style:Cesium.LabelStyle.FILL_AND_OUTLINE,outlineColor:Cesium.Color.WHITE,outlineWidth:4,pixelOffset:new Cesium.Cartesian3(0,-10,0)}});return this.currentFeature.push(i.id),[t,i]},t.prototype.computedAzimuthAngle=function(e,t){void 0===t&&(t=!1);var i=this.viewer.scene.globe.ellipsoid,r=i.cartesianToCartographic(e[0]),n=Cesium.Math.toDegrees(r.longitude),o=Cesium.Math.toDegrees(r.latitude),s=i.cartesianToCartographic(e[1]),a=Cesium.Math.toDegrees(s.longitude),l=Cesium.Math.toDegrees(s.latitude),h=6356725,c=n*Math.PI/180,u=o*Math.PI/180,p=a*Math.PI/180,d=l*Math.PI/180,m=h+21412*(90-o)/90,f=(p-c)*(m*Math.cos(u)),g=(d-u)*m,A=0;A=180*Math.atan(Math.abs(f/g))/Math.PI;var y=a-n,v=l-o;if(y>0&&v<=0?A=90-A+90:y<=0&&v<0?A+=180:y<0&&v>=0&&(A=90-A+270),this.result=A?"".concat(A.toFixed(2)," 度"):"0",this.measureResult=this.result,t)return this.generateAngleLabel(e)},t.prototype.getSpaceDistance=function(e,t,i){var r=this;return new Promise((function(t){for(var n=0,o=0;o<e.length-1;o++)n+=Cesium.Cartesian3.distance(e[o],e[o+1]);r.result=r.formatLength(n),"leftclick"===i&&(r.measureResult=r.result),t(n)}))},t.prototype.pointDisplay=function(e,t,i){if(t){var r=this.viewer.entities.add({position:e,label:{text:this.result?this.result:"",font:"12px PingFangSC,arial,sans-serif",fillColor:Cesium.Color.BLACK,style:Cesium.LabelStyle.FILL_AND_OUTLINE,outlineColor:Cesium.Color.WHITE,outlineWidth:4,pixelOffset:new Cesium.Cartesian3(0,25,0),backgroundColor:Cesium.Color.fromCssColorString("rgba(255.0, 200.0, 5.0, 1)"),showBackground:!0}});return r.label.heightReference=!this.isMobileMeasure||this.is2D?Cesium.HeightReference.NONE:Cesium.HeightReference.CLAMP_TO_GROUND,"tiedijuli"===this.selectedItem.alias&&(r.label.heightReference=Cesium.HeightReference.CLAMP_TO_GROUND),this.measureEntities.lineTerrain.push(r.id),this.tempDistanceLabelArr.push(this.result),this.sceneNeedRender(),r}},t.prototype.drawPolyline=function(e,t,i){var r,n=this;void 0===t&&(t=!1),void 0===i&&(i="cd"),this.isMobileMeasure&&!t&&(null===(r=this.currentFeature)||void 0===r||r.forEach((function(e){n.viewer.entities.removeById(e)}))),this.currentFeature=[];var o,s={name:"",polyline:{show:!0,positions:[],material:new Cesium.Color(227/255,196/255,46/255,1),width:2,clampToGround:"tiedijuli"===this.selectedItem.alias||"gaodu"===this.selectedItem.alias||!!this.isMobileMeasure}};"zhixianjuli"!==this.selectedItem.alias||t||(o=this.viewer.entities.add({name:"",position:new Cesium.CallbackProperty((function(){return e[e.length-1]}),!0),label:{text:new Cesium.CallbackProperty((function(){return n.result}),!1),font:"15px PingFangSC,arial,sans-serif",fillColor:Cesium.Color.BLACK,style:Cesium.LabelStyle.FILL_AND_OUTLINE,outlineColor:Cesium.Color.WHITE,outlineWidth:4,pixelOffset:new Cesium.Cartesian3(0,-15,0),clampToGround:"tiedijuli"===this.selectedItem.alias||!!this.isMobileMeasure}}),this.isMobileMeasure&&o?this.viewer.entities.removeById(o.id):!this.isMobileMeasure&&o&&this.currentFeature.push(o.id)),s.polyline.positions=new Cesium.CallbackProperty((function(){return e}),!1);var a=this.viewer.entities.add(s);if(this.currentFeature.push(a.id),this.sceneNeedRender(),t&&"cd"===i){for(var l=[],h=2;h<=e.length;h++)l.push(this.getSpaceDistance(e.slice(0,h),!0,void 0));return Promise.all(l).then((function(e){return e.concat(a)}))}return t&&"gd"===i?new Promise((function(e){e(a)})):t||"zhixianjuli"!==i?a:[a,o]},t.prototype.getArea=function(e){var t;if(this.isMobileMeasure&&(e=JSON.parse(JSON.stringify(e))),!(e[0].length<3)){var i=[];null===(t=e[0])||void 0===t||t.forEach((function(e){i.push(xt.xmu(e))})),i.push(i[0]);var r=xt.uf4(i),n=xt.i$2(r);if(n)return xt.SOn(n)/1e6}},t.prototype.getTerrainDistance=function(e){var t=e.length-3>0?e.length-3:0;this.isMobileMeasure&&(t=e.length-2>0?e.length-2:0);var i=Cesium.Cartographic.fromCartesian(e[t]),r=Cesium.Cartographic.fromCartesian(e[t+1]);return this.TerrainMeasure(i,r,e[e.length-1])},t.prototype.TerrainMeasure=function(e,t,i){for(var r=this,n=new Cesium.EllipsoidGeodesic(e,t),o=n.surfaceDistance,s=[e],a=o/20,l=a;l<o;l+=a){var h=n.interpolateUsingSurfaceDistance(l);s.push(h)}s.push(t);var c=this.viewer.terrainProvider.availability._maximumLevel?this.viewer.terrainProvider.availability._maximumLevel:this.calculateLevel;return Cesium.sampleTerrain(this.viewer.terrainProvider,c,s).then((function(e){for(var t=0;t<e.length-1;t++){var n=new Cesium.EllipsoidGeodesic;n.setEndPoints(e[t],e[t+1]);var o=n.surfaceDistance,s=Math.sqrt(Math.pow(o,2)+Math.pow(e[t+1].height-e[t].height,2));r.terrainDistance+=s,r.result=r.formatLength(r.terrainDistance)}r.pointDisplay(i,!0,r.terrainDistance)}))},t.prototype.drawPolygon=function(e,t,i){var r,n,o=this;void 0===t&&(t=!1),i&&1===i.length&&(i[0][0]>0?this.isPositiveOrNegative="positive":this.isPositiveOrNegative="negative"),"positive"===this.isPositiveOrNegative&&i&&i.length?i.forEach((function(e){e[0]<=0&&(e[0]+=360)})):"negative"===this.isPositiveOrNegative&&i&&i.length&&i.forEach((function(e){e[0]>0&&(e[0]-=360)})),null===(r=this.currentFeature)||void 0===r||r.forEach((function(e){o.viewer.entities.removeById(e)})),this.currentFeature=[],n={name:"",polygon:{hierarchy:[],perPositionHeight:!1,material:new Cesium.Color(227/255,196/255,46/255,.6),heightReference:this.isMobileMeasure||this.isBrowserPageShow||this.is2D?Cesium.HeightReference.NONE:Cesium.HeightReference.CLAMP_TO_GROUND}},this.areaHierarchy={positions:e},n.polygon.hierarchy=new Cesium.CallbackProperty((function(){return o.areaHierarchy}),!1);var s=this.viewer.entities.add(n);if(this.isMobileMeasure){var a=[];null==i||i.forEach((function(e){a.push(xt.xmu(e))})),a.push(a[0]);var l=xt.uf4(a),h=xt.i$2(l);h&&(this.pointInHollArr=[],null==i||i.forEach((function(e){var t=xt.xmu(e);o.pointInHollArr.push(xt.FWy(t,h,{ignoreBoundary:!0}))}))),this.areaHierarchy.positions=[],h&&h.geometry.coordinates[0].forEach((function(e){o.areaHierarchy.positions.push(Cesium.Cartesian3.fromDegrees(e[0],e[1]))}))}return this.currentFeature.push(s.id),this.sceneNeedRender(),s},t.prototype.getHeight=function(e){var t=this,i=this.viewer.terrainProvider.availability._maximumLevel?this.viewer.terrainProvider.availability._maximumLevel:this.calculateLevel,r=Cesium.Cartographic.fromCartesian(e[0]),n=Cesium.Cartographic.fromCartesian(e[1]);return new Promise((function(o){Cesium.sampleTerrain(t.viewer.terrainProvider,i,[r,n]).then((function(i){var r,n,s=i[0].height,a=i[1].height;n=Math.abs(s-a),t.result=t.formatLength(n,!0),r=t.viewer.entities.add({name:"",position:e[1],label:{text:t.result,font:"12px PingFangSC,arial,sans-serif",fillColor:Cesium.Color.BLACK,style:Cesium.LabelStyle.FILL_AND_OUTLINE,outlineColor:Cesium.Color.WHITE,outlineWidth:4,pixelOffset:new Cesium.Cartesian3(0,30,0),backgroundColor:Cesium.Color.fromCssColorString("rgba(255.0, 200.0, 5.0, 1)"),showBackground:!0,heightReference:Cesium.HeightReference.CLAMP_TO_GROUND}}),t.currentFeature.push(r.id),t.measureEntities.height=t.measureEntities.height.concat(JSON.parse(JSON.stringify(t.currentFeature))),o(r)}))}))},t.prototype.getCurrentHeight=function(e){var t=this,i=this.viewer.terrainProvider.availability._maximumLevel?this.viewer.terrainProvider.availability._maximumLevel:this.calculateLevel,r=Cesium.Cartographic.fromCartesian(e);return new Promise((function(n){Cesium.sampleTerrain(t.viewer.terrainProvider,i,[r]).then((function(i){var r,o=i[0].height;t.result=t.formatLength(o,!0),r=t.viewer.entities.add({position:e,label:{text:t.result,font:"12px PingFangSC,arial,sans-serif",fillColor:Cesium.Color.BLACK,style:Cesium.LabelStyle.FILL_AND_OUTLINE,outlineColor:Cesium.Color.WHITE,outlineWidth:4,pixelOffset:new Cesium.Cartesian3(0,30,0),backgroundColor:Cesium.Color.fromCssColorString("rgba(255.0, 200.0, 5.0, 1)"),showBackground:!0,heightReference:("zhixianjuli"===t.selectedItem.alias||"gaodu"===t.selectedItem.alias||"currentHeight"===t.selectedItem.alias||"mianji"===t.selectedItem.alias)&&t.is2D?Cesium.HeightReference.NONE:Cesium.HeightReference.CLAMP_TO_GROUND}}),t.currentFeature.push(r.id),n(r)}))}))},t.prototype.Angle=function(e,t,i){var r=this.Bearing(t,e)-this.Bearing(t,i);return r<0&&(r+=360),r},t.prototype.Bearing=function(e,t){var i=Math.PI/180,r=180/Math.PI,n=e.lat*i,o=e.lon*i,s=t.lat*i,a=t.lon*i,l=-Math.atan2(Math.sin(o-a)*Math.cos(s),Math.cos(n)*Math.sin(s)-Math.sin(n)*Math.cos(s)*Math.cos(o-a));return l<0&&(l+=2*Math.PI),l*=r},t.prototype.closeMeasureMethod=function(){this.initStatus(),this.viewer.scene.globe.depthTestAgainstTerrain=this.depthTest,this.measureShow=!1},t.prototype.changeMusDefaultType=function(){document.querySelector(".cesium-viewer").style.cursor="default"},t.prototype.changeMusPicType=function(){document.querySelector(".cesium-viewer").style.cursor="url(/resources/images/ruler.ico), auto"},t.prototype.getPosition=function(e){if(this.is2D)return this.viewer.camera.pickEllipsoid(e,this.viewer.scene.globe.ellipsoid);var t=this.viewer.camera.getPickRay(e);return this.viewer.scene.globe.pick(t,this.viewer.scene)},t.prototype.createCtrlPointCanvas=function(e){var t=document.createElement("canvas");t.width=18,t.height=18;var i=t.getContext("2d");return i.lineWidth=2,e?this.isMobileMeasure?(i.strokeStyle="rgba(243, 183, 19, 0.3)",i.fillStyle="rgba(255, 255, 255, 0.3)"):(i.strokeStyle="rgba(243, 183, 19, 0)",i.fillStyle="rgba(255, 255, 255, 0)"):(i.strokeStyle="#F3B713",i.fillStyle="#ffffff"),i.beginPath(),i.arc(9,9,6,0,2*Math.PI,!1),i.stroke(),i.closePath(),i.fill(),t},t.prototype.addCtlPoint=function(e){var t="zhixianjuli"===this.selectedItem.alias||"gaodu"===this.selectedItem.alias||"currentHeight"===this.selectedItem.alias||"mianji"===this.selectedItem.alias?this.isMobileMeasure&&!this.is2D?Cesium.HeightReference.CLAMP_TO_GROUND:Cesium.HeightReference.NONE:Cesium.HeightReference.CLAMP_TO_GROUND;this.isMobileMeasure||"gaodu"!==this.selectedItem.alias&&"mianji"!==this.selectedItem.alias||(t=Cesium.HeightReference.CLAMP_TO_GROUND);var i=this.viewer.entities.add({position:e,billboard:{image:this.createCtrlPointCanvas(),heightReference:t}});return this.sceneNeedRender(),i},t.prototype.saveMeasureResult=function(e){"noResult"!==this.measureResult&&""!==this.measureResult&&(this.measureResultData.unshift({title:e.label,content:this.measureResult,mobileContent:parseFloat(this.measureResult),mobileUnit:this.measureResult.split(" ")[1],mobileContentCopy:this.measureResult.split(" ")[0],changeUnits:e.units}),this.measureResult="noResult")},t.prototype.clearResult=function(){this.initStatus(),this.measureResultData=[],this.measureResult="noResult"},t.prototype.closeMouseToolTip=function(){this.pointLabel&&(this.pointLabel.show=!1)},t.prototype.addMouseInfoEntity=function(){this.viewer.entities.getById("pointSelectLabel")||this.viewer.entities.add({id:"pointSelectLabel",show:!1,position:"",billboard:{image:this.createCtrlPointCanvas(),heightReference:Cesium.HeightReference.CLAMP_TO_GROUND},label:{text:"",font:"12px PingFangSC,arial,sans-serif",backgroundColor:Cesium.Color.BLACK.withAlpha(.9),showBackground:!0,horizontalOrigin:Cesium.HorizontalOrigin.LEFT,verticalOrigin:Cesium.VerticalOrigin.TOP,pixelOffset:new Cesium.Cartesian2(15,0)}}),this.pointLabel=this.viewer.entities.getById("pointSelectLabel")},t.prototype.showResultInHeight=function(e,t){if(!isNaN(Number(t))){var i=this.viewer.entities.add({position:e,label:{text:"".concat(t," 米"),font:"12px PingFangSC,arial,sans-serif",fillColor:Cesium.Color.BLACK,style:Cesium.LabelStyle.FILL_AND_OUTLINE,outlineColor:Cesium.Color.WHITE,outlineWidth:4,pixelOffset:new Cesium.Cartesian3(0,30,0),backgroundColor:Cesium.Color.fromCssColorString("rgba(255.0, 200.0, 5.0, 1)"),showBackground:!0,heightReference:("zhixianjuli"===this.selectedItem.alias||"gaodu"===this.selectedItem.alias||"currentHeight"===this.selectedItem.alias||"mianji"===this.selectedItem.alias)&&this.is2D?Cesium.HeightReference.NONE:Cesium.HeightReference.CLAMP_TO_GROUND}});return this.measureEntities.height.push(i.id),this.sceneNeedRender(),i}},t.prototype.reDrawPointInAreaSpace=function(){var e=this;this.pointInHollArr.forEach((function(t,i){e.viewer.entities.getById(e.ctlPoints[i])&&(e.viewer.entities.getById(e.ctlPoints[i]).billboard.image=!0!==t?e.createCtrlPointCanvas():e.createCtrlPointCanvas(!0))}))},t.prototype.showAvailablePointsInAreaSpace=function(e){var t=this;if(e.length){var i=[];null==e||e.forEach((function(e){i.push(xt.xmu(e))})),i.push(i[0]);var r=xt.uf4(i),n=xt.i$2(r);n&&(this.pointInHollArr=[],null==e||e.forEach((function(e){var i=xt.xmu(e);t.pointInHollArr.push(xt.FWy(i,n,{ignoreBoundary:!0}))}))),this.areaHierarchy.positions=[],n&&(n.geometry.coordinates[0].forEach((function(e){t.areaHierarchy.positions.push(Cesium.Cartesian3.fromDegrees(e[0],e[1]))})),this.reDrawPointInAreaSpace())}},t.prototype.sceneNeedRender=function(){this.viewer&&!0===this.viewer.scene.requestRenderMode&&this.viewer.scene.requestRender()},t.prototype.calculateMouseEvent=function(e){e.startPosition?(e.endPosition.x=e.endPosition.x/1,e.endPosition.y=e.endPosition.y/1,e.startPosition.x=e.startPosition.x/1,e.startPosition.y=e.startPosition.y/1):e.position&&(e.position.x=e.position.x/1,e.position.y=e.position.y/1)},t}(p);class sh extends h.Z{constructor(e){super(),this._earth=e,this._measurement=new Jl(this._earth),this._cutFillComputingOld=new Vl(this._earth),this._cutFillComputing=new eh(this._earth)}get measurement(){return this._measurement}get cutFillComputing(){return this._cutFillComputing}get cutFillComputingOld(){return this._cutFillComputingOld}destroy(){return this._measurement.destroy(),this._cutFillComputing.destroy(),this._cutFillComputingOld.destroy(),super.destroy()}}sh.CutFillComputing=eh,sh.Measurement=Jl;class ah{constructor(e){this._earth=e,this._measureService=new oh(this._earth.viewer)}get measureService(){return this._measureService}}class lh extends h.Z{constructor(e){super();const t=e.czm.viewer;(0,P.extendObservable)(this,{tilesetInspectorVisibility:!1,cesiumInspectorVisibility:!1,debugForceDoubleSided:!1}),t.extend(Cesium.viewerCesium3DTilesInspectorMixin),t.cesium3DTilesInspector.container.style.visibility="hidden",t.cesium3DTilesInspector.viewModel.picking=!1,t.extend(Cesium.viewerCesiumInspectorMixin),t.cesiumInspector.container.style.visibility="hidden",this.disposers.push((0,P.autorun)((()=>{t.cesium3DTilesInspector.container.style.visibility=this.tilesetInspectorVisibility?"visible":"hidden",t.cesiumInspector.container.style.visibility=this.cesiumInspectorVisibility?"visible":"hidden"}))),this.disposers.push((0,P.autorun)((()=>{const e=this.debugForceDoubleSided;Cesium.Model.gvolDebugForceDoubleSided=e})))}}const hh=lh;class ch{constructor(e){this._earth=e,this._debug=new hh(e)}get debug(){return this._debug}destroy(){this._debug.destroy()}}ch.Debug=hh;const uh=ch;var ph=i(5108);const dh=class{constructor(e){this._earth=e,function(e){e._gvolTerrains||(e._gvolTerrains=[]),e._gvolEllipsoidTerrainProvider||(e._gvolEllipsoidTerrainProvider=new Cesium.EllipsoidTerrainProvider),e._gvolTerrainZIndexDirty||(0,P.extendObservable)(e,{_gvolTerrainZIndexDirty:!1}),e._gvolTerrainZIndexListenerDisposer||(e._gvolTerrainZIndexListenerDisposer=(0,P.reaction)((()=>e._gvolTerrainZIndexDirty),(()=>{if(!e._gvolTerrainZIndexDirty)return;e._gvolTerrainZIndexDirty=!1;const t=e._gvolTerrains.filter((e=>e.show)).sort(((e,t)=>e.gvolZIndex-t.gvolZIndex));t.length>0?e.czm.scene.terrainProvider=t[t.length-1]._terrainProvider:e.czm.scene.terrainProvider=e._gvolEllipsoidTerrainProvider})))}(this._earth)}destroy(){!function(e){e._gvolTerrainZIndexListenerDisposer&&(e._gvolTerrainZIndexListenerDisposer(),e._gvolTerrainZIndexListenerDisposer=void 0,e._gvolEllipsoidTerrainProvider=void 0)}(this._earth)}};const mh=class{constructor(e){this._earth=e,function(e){e._gvolImageries=[],e._options&&!e._options.useDefaultImager&&e.czm.scene.imageryLayers.removeAll(),void 0===e._gvolImageryZIndexDirty&&(0,P.extendObservable)(e,{_gvolImageryZIndexDirty:!1}),e._gvolImageryZIndexListenerDisposer||(e._gvolImageryZIndexListenerDisposer=(0,P.reaction)((()=>e._gvolImageryZIndexDirty),(()=>{if(!e._gvolImageryZIndexDirty)return;e._gvolImageryZIndexDirty=!1;const t=[],i=e.czm.scene.imageryLayers.length;for(let r=0;r<i;++r){const i=e.czm.scene.imageryLayers.get(r);t.push(i)}t.sort(((e,t)=>e.gvolZIndex-t.gvolZIndex)),t.forEach((t=>{e.czm.scene.imageryLayers.raiseToTop(t)}))})))}(this._earth)}destroy(){!function(e){e._gvolImageryZIndexListenerDisposer&&(e._gvolImageryZIndexListenerDisposer(),e._gvolImageryZIndexListenerDisposer=void 0)}(this._earth)}};const fh=function(e,t,i,r){let n,o;e._gvolObjectsMap.has(t)&&(n=e._gvolObjectsMap.get(t),i(n));const s=e.gvolObjectOpsEvent.addEventListener((({type:e,gvolObj:s})=>{if(s.guid===t)if("create"===e){if(n)throw new Error("已经绑定过了！");o=setTimeout((()=>{n=s,n&&i(n),o=void 0}),0)}else"destroy"===e&&(n&&r(n),o&&(clearTimeout(o),o=void 0),n=void 0)}));return function(){n&&r(n),s()}};var gh=i(5108);const Ah=function(e,t,i,r){let n,o=r,s=i,a="",l=[];l.push((()=>{a="",u()}));const h=e=>{t[o]&&gh.error("this._attachedPath should not exists!"),t[o]=e},c=()=>{t[o]=void 0},u=()=>{const i=t[s];i!==a&&(a&&(n=n&&n(),a=""),i&&(n=fh(e,i,h,c),a=i))};return l.push((0,P.autorun)(u)),()=>{l.forEach((e=>e())),l.length=0}};class yh extends h.Z{constructor(e){super(e._earth),this._ramp=e}_apply(){if(!this.enabled)return;let e,t=this._ramp._globe.material;t&&("ElevationContour"==t.type?e=t.uniforms:t.materials&&t.materials.contour&&(e=t.materials.contour.uniforms),e.width=this.width,e.spacing=this.spacing,e.color.red=this.color[0],e.color.green=this.color[1],e.color.blue=this.color[2],e.color.alpha=this.color[3])}}yh.defaultOptions={enabled:!1,width:1,spacing:100,color:[1,0,0,1]};const vh=yh;class Ch extends c.Z{constructor(e){super(e._earth),this._ramp=e}_apply(){if(!this.enabled)return;let e,t=this._ramp._globe.material;t&&("AspectRamp"==t.type?e=t.uniforms:t.materials&&t.materials.shading&&"AspectRamp"==t.materials.shading.type&&(e=t.materials.shading.uniforms),e&&(e.image=this._ramp._createImage(this.image)))}}Ch.defaultOptions={enabled:!1,image:""},c.Z.registerType(Ch,"AspectRamp");const _h=Ch;class bh extends c.Z{constructor(e){super(e._earth),this._ramp=e}_apply(){if(!this.enabled)return;let e,t=this._ramp._globe.material;t&&("ElevationRamp"==t.type?e=t.uniforms:t.materials&&t.materials.shading&&"ElevationRamp"==t.materials.shading.type&&(e=t.materials.shading.uniforms),e&&(e.minimumHeight=this.minHeight,e.maximumHeight=this.maxHeight,e.image=this._ramp._createImage(this.image)))}}bh.defaultOptions={enabled:!1,minHeight:0,maxHeight:5e3,image:""},c.Z.registerType(bh,"ElevationRamp");const wh=bh;class Ph extends c.Z{constructor(e){super(e._earth),this._ramp=e}_apply(){if(!this.enabled)return;let e,t=this._ramp._globe.material;t&&("SlopeRamp"==t.type?e=t.uniforms:t.materials&&t.materials.shading&&"SlopeRamp"==t.materials.shading.type&&(e=t.materials.shading.uniforms),e&&(e.image=this._ramp._createImage(this.image)))}}Ph.defaultOptions={enabled:!1,image:""},c.Z.registerType(Ph,"SlopeRamp");const Sh=Ph;class xh extends h.Z{constructor(e){super(),this._terrainEffect=e,this._earth=e._earth,this._polygon=new Pi.Z(this._earth),this._polygon.color=[1,1,0,0],this.disposers.push((()=>this._polygon.destroy())),this.disposers.push((0,O.j)(this._polygon,"positions",this,"positions")),this.disposers.push((0,O.j)(this._polygon,"height",this,"height")),this.disposers.push((0,ae.V$)(this._earth,this,{polygonPointAddingProperty:"creating"})),this.disposers.push((0,ae.Ko)(this._earth,this,{polygonEditingProperty:"editing"})),this.disposers.push((0,P.reaction)((()=>({creating:this.creating,editing:this.editing})),(()=>{(this.creating||this.editing)&&(this.enabled=!1)}))),this.disposers.push((0,P.autorun)((()=>{this._polygon.show=this.showHelper}))),this._alwayTopImageryLayer=void 0;const t=this._earth.czm.scene;this.disposers.push((0,P.reaction)((()=>({positions:[...this.positions],innerDiscard:this.innerDiscard,enabled:this.enabled})),(()=>{t.gvolRestrictImagery=this.enabled,this._alwayTopImageryLayer&&(t.imageryLayers.remove(this._alwayTopImageryLayer),this._alwayTopImageryLayer=void 0),this.enabled&&(this._alwayTopImageryLayer=new Cesium.ImageryLayer(new Cesium.RestrictImageryProvider({positions:this.positions,innerDiscard:this.innerDiscard})),this._alwayTopImageryLayer.gvolZIndex=Number.MAX_SAFE_INTEGER,t.imageryLayers.add(this._alwayTopImageryLayer)),this._earth._gvolImageryZIndexDirty=!0})))}flyTo(){const e=this.positions.length/2,t=[0,0,0],i=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY],r=[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];for(let n=0;n<e;++n){const e=this.positions[2*n+0],o=this.positions[2*n+1];t[0]+=e,t[1]+=o,i[0]=i[0]<e?i[0]:e,i[1]=i[1]<o?i[1]:o,r[0]=r[0]>e?r[0]:e,r[1]=r[1]>o?r[1]:o}t[0]/=e,t[1]/=e,t[2]=this.height;const n=_t.geoDistance(i,r);this._earth.camera.flyTo(t,n)}destroy(){return super.destroy()}}xh.defaultOptions={positions:[],height:0,enabled:!1,showHelper:!1,edgeWidth:1,edgeColor:[1,1,1,1],innerDiscard:!1};const Bh=xh;class Mh extends h.Z{constructor(e){super(),this._terrainEffect=e,this._earth=e._earth;const t=this._earth.czm.scene.globe,i=()=>{if(t.translucency.backFaceAlpha=this.backFaceAlpha,this.backFaceAlphaByDistance){const[e,i,r,n]=this.backFaceAlphaByDistance;t.translucency.backFaceAlphaByDistance=new Cesium.NearFarScalar(e,i,r,n)}else t.translucency.backFaceAlphaByDistance=void 0;if(t.translucency.frontFaceAlpha=this.frontFaceAlpha,this.frontFaceAlphaByDistance){const[e,i,r,n]=this.frontFaceAlphaByDistance;t.translucency.frontFaceAlphaByDistance=new Cesium.NearFarScalar(e,i,r,n)}else t.translucency.frontFaceAlphaByDistance=void 0;if(t.translucency.rectangle=this.rectangle,this.rectangle){const[e,i,r,n]=this.rectangle;t.translucency.rectangle=new Cesium.Rectangle(e,i,r,n)}else t.translucency.rectangle=void 0;t.translucency.enabled=this.enabled};i(),this.disposers.push((0,P.reaction)((()=>({backFaceAlpha:this.backFaceAlpha,backFaceAlphaByDistance:this.backFaceAlphaByDistance,frontFaceAlpha:this.frontFaceAlpha,frontFaceAlphaByDistance:this.frontFaceAlphaByDistance,rectangle:this.rectangle,enabled:this.enabled})),i))}}Mh.defaultOptions={backFaceAlpha:1,backFaceAlphaByDistance:void 0,frontFaceAlpha:1,frontFaceAlphaByDistance:void 0,rectangle:void 0,enabled:!1};const Eh=Mh;var Th=i(5108);class Oh extends h.Z{constructor(e){super(),this._earth=e,this._scene=e.czm.scene,this._globe=this._scene.globe,this.contour=new vh(this),this.elevation=new wh(this),this.slope=new Sh(this),this.aspect=new _h(this),this.disposers.push((()=>{this.contour=this.contour&&this.contour.destroy(),this.elevation=this.elevation&&this.elevation.destroy(),this.slope=this.slope&&this.slope.destroy(),this.aspect=this.aspect&&this.aspect.destroy()})),this.restrict=new Bh(this),this.disposers.push((()=>this.restrict.destroy())),this.disposers.push(h.Z.registerProperty(this,"restrict")),this.globeTranslucency=new Eh(this),this.disposers.push((()=>this.globeTranslucency.destroy())),this.disposers.push(h.Z.registerProperty(this,"globeTranslucency")),this.disposers.push(h.Z.registerProperty(this,"contour")),this.disposers.push(h.Z.registerProperty(this,"elevation")),this.disposers.push(h.Z.registerProperty(this,"slope")),this.disposers.push(h.Z.registerProperty(this,"aspect")),this._defaultImage="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAMCAgICAgMCAgIDAwMDBAYEBAQEBAgGBgUGCQgKCgkICQkKDA8MCgsOCwkJDRENDg8QEBEQCgwSExIQEw8QEBD/2wBDAQMDAwQDBAgEBAgQCwkLEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBD/wAARCAABAGQDASIAAhEBAxEB/8QAGgABAQACAwAAAAAAAAAAAAAAAAYEBwUICf/EACEQAQAABQUAAwAAAAAAAAAAAAABAgUxcQMEBjJCNEGB/8QAGAEBAAMBAAAAAAAAAAAAAAAABwQGCAX/xAAkEQABAgQFBQAAAAAAAAAAAAAAAQYDBAUzMTJCcXI0NUGxwf/aAAwDAQACEQMRAD8A8x6NaVc0bzgF8bng5U2XdGvKuKV1gB0odtditRriblLsfpR7C8oKC69Q8sXScnP0hhha1wBVTxU0JL4IYU/eGV1xXxiADmsZVJMxbNx8V8Zg7BcF6aX4AMc/cZXn8DR1WDddJ+FIA0/TejhcU9APFuLuf//Z",(0,P.extendObservable)(this,{get shading(){return this.elevation.enabled?this.elevation:this.slope.enabled?this.slope:this.aspect.enabled?this.aspect:void 0}},{shading:P.computed}),this.disposers.push((0,P.reaction)((()=>this.subSurfaceEnabled),(()=>{this._scene.gvolSubsurfaceManager?this._scene.gvolSubsurfaceManager.subsurfaceEnabled=this.subSurfaceEnabled:Th.warn("地下模式插件未启用！此功能无效！")}))),this.disposers.push((0,P.reaction)((()=>this.surfaceOpacity),(()=>{this._scene.gvolSubsurfaceManager?(this.depthTest&&Th.warn("需要首先关闭地形深度检测(depthTest)，此功能才能有效！"),this.surfaceOpacity<=0?this._scene.gvolSubsurfaceManager.transparentEnabled=!1:(this._scene.gvolSubsurfaceManager.transparentEnabled=!0,this._scene.gvolSubsurfaceManager.opacity=this.surfaceOpacity)):Th.warn("地下模式插件未启用！此功能无效！")}))),this.disposers.push((0,P.autorun)((()=>{var e=this.elevation,t=this.slope,i=this.aspect,r=this.contour;this._update(e,t,i,r),this._scene.logarithmicDepthBuffer=this.logDepth,this._globe._surface.tileProvider._debug.wireframe=this.wireFrame,this._globe.depthTestAgainstTerrain=this.depthTest,this._globe.terrainExaggeration=this.terrainExaggeration,this._globe.enableLighting=this.enableLighting,this._globe.show=this.show})));const t=this.baseColor;e.czm.viewer.scene.globe.baseColor=new Cesium.Color(t[0],t[1],t[2],t[3]),this.disposers.push((0,P.reaction)((()=>[...this.baseColor]),(()=>{const t=this.baseColor;e.czm.viewer.scene.globe.baseColor=new Cesium.Color(t[0],t[1],t[2],t[3])})))}_update(){this._updateMaterial(),this.contour._apply(),this.shading&&this.shading._apply()}_newContourMaterial(e){return new Cesium.Material({fabric:{type:"Contour"+e,materials:{contour:{type:"ElevationContour"},shading:{type:e}},components:{diffuse:"contour.alpha == 0.0 ? shading.diffuse : contour.diffuse",alpha:"max(contour.alpha, shading.alpha)"}},translucent:!1})}_updateMaterial(){let e=this._globe.material;if(this.contour.enabled)if(this.shading===this.elevation){if(e&&"ContourElevationRamp"==e.type)return;e=this._newContourMaterial("ElevationRamp")}else if(this.shading==this.slope){if(e&&"ContourSlopeRamp"==e.type)return;e=this._newContourMaterial("SlopeRamp")}else if(this.shading==this.aspect){if(e&&"ContourAspectRamp"==e.type)return;e=this._newContourMaterial("AspectRamp")}else{if(e&&"ElevationContour"==e.type)return;e=Cesium.Material.fromType("ElevationContour")}else if(this.shading===this.elevation){if(e&&"ElevationRamp"==e.type)return;e=Cesium.Material.fromType("ElevationRamp")}else if(this.shading==this.slope){if(e&&"SlopeRamp"==e.type)return;e=Cesium.Material.fromType("SlopeRamp")}else if(this.shading==this.aspect){if(e&&"AspectRamp"==e.type)return;e=Cesium.Material.fromType("AspectRamp")}else e=void 0;this._globe.material=e}destroy(){return super.destroy()}_createImage(e){e&&""!=e||(e=this._defaultImage);var t=document.createElement("img");return t.src=e,t}}Oh.defaultOptions={show:!0,enableLighting:!1,elevation:null,slope:null,aspect:null,contour:null,restrict:null,depthTest:!1,wireFrame:!1,logDepth:!0,terrainExaggeration:1,subSurfaceEnabled:!1,surfaceOpacity:0,baseColor:[0,0,.5,1],globeTranslucency:null};const Lh=Oh;var Dh=i(5108);class Ih extends h.Z{constructor(e){super(),this._earth=e,this.autoUpdateDisposer=(0,P.autorun)((()=>{var e=this._earth.czm.scene.skyAtmosphere;e?(e.show=this.enabled,e.brightnessShift=this.brightnessShift,e.hueShift=this.hueShift,e.saturationShift=this.saturationShift):Dh.warn("cannot get scene.skyAtmosphere!")}))}destroy(){return this.autoUpdateDisposer&&(this.autoUpdateDisposer(),this.autoUpdateDisposer=void 0),super.destroy()}}Ih.defaultOptions={enabled:!0,brightnessShift:0,hueShift:0,saturationShift:0};const Rh=Ih;class Hh extends h.Z{constructor(e){super(),this._earth=e,this.autoUpdateDisposer=(0,P.autorun)((()=>{var e=this._earth.czm.scene.fog;e.enabled=this.enabled,e.density=this.density,e.minimumBrightness=this.minimumBrightness,e.screenSpaceErrorFactor=this.screenSpaceErrorFactor}))}destroy(){return this.autoUpdateDisposer&&(this.autoUpdateDisposer(),this.autoUpdateDisposer=void 0),super.destroy()}}Hh.defaultOptions={enabled:!1,density:2e-4,minimumBrightness:.1,screenSpaceErrorFactor:2};const Fh=Hh;class Nh extends h.Z{constructor(e){super(),this._earth=e,this.autoUpdateDisposer=(0,P.autorun)((()=>{var e=this._earth.czm.scene.moon;e&&(e.show=this.enabled,e.onlySunLighting=this.onlySunLighting)}))}destroy(){return this.autoUpdateDisposer&&(this.autoUpdateDisposer(),this.autoUpdateDisposer=void 0),super.destroy()}}Nh.defaultOptions={enabled:!0,onlySunLighting:!0};const Qh=Nh;class kh extends h.Z{constructor(e){var t;super(),this._earth=e;let i=this._earth.czm.scene;this.autoUpdateDisposer=(0,P.autorun)((()=>{if(this.enabled){if(!t){var e=i.drawingBufferWidth/80,r=1e5,n=new Cesium.Cartesian2(e,2*e),o=new Cesium.Cartesian3;t=new Cesium.ParticleSystem({modelMatrix:new Cesium.Matrix4.fromTranslation(i.camera.position),speed:-1,lifetime:10,emitter:new Cesium.SphereEmitter(r),startScale:this.startScale,endScale:this.endScale,image:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABGdBTUEAALGPC/xhBQAAAAlwSFlzAAAOwgAADsIBFShKgAAAABl0RVh0U29mdHdhcmUAcGFpbnQubmV0IDQuMC4xOdTWsmQAAANMSURBVFhH7dc9j41BGMbx3bVrNwQJEq+dlwpB+AB0FEoaJQU+goSOEC3fAAndNgpaGq0CBRWV0ImIOK7fyT2bk33snuMUu4qd5J9M5r7ua56ZuWfO7sRa++9br9drTIapMB1mwmyYK/SNidHQ9vPGbs2gzNaF9WFD2BK2hR1hV6FvTIyGVs54H9KSgtVYGdOtYXfYFw6F4+FkoW9MjIZWjlweo39EE1eilWwKO8OBcCKcDufChXCx0DcmRkMrRy6P0T+ihG1yW7onHA6nwvlwNVwPt8K9Qt+YGA2tHLk8Fj5i2UYQnJut8/UMjoYz4VK4Ee6HR2E+PCv0jYnR0MqRy4MXz35NLNkEg+JxfrbQKhhdCXfCw/A8vA5vwttC35gYDa0cuTx48eRds/2lJegLbZcico620moYPgkvw7vwKXwJ3wp9Y2I0tHLk8uDFk/dkTddtCTonX6qSFZPztKVWxfhD+Bq+h5/hV6FvTIyGVo5cHrx48p6q6botQQ+JonGdVLSicq621upM8COY9PcijInR0MqRy4MXT97TNV23JahQPCjutGulshWX87XFVjk4eWuDH0FDK0cuD148ec/UdN2WoCfVq+ZhcbddLxWuyJyzrV48eWttnIZWjlwevHjynq3pui1B77qn1evmgXHHXTOVrtja6pdqYjS0cuTy4MWT91xN122CJVq1D1j1I1CE28NgET4OCupzGLUIaeXIHSxC3ssWYbuG+4Orcy08CC/C+zDqNaSVI5cHL55Dr2F7iLzfHg9bdzO4Tq/Cx2ACq7TVJoW+MTEaWjlyefDiOfQhGnyKDwZffjncDU8DY6uzxc5ZsUHfmBgNrRy5PHiN9BTDD8bG4AfkSDgbvGYMrcrWOl9FptKhb0yMhlaOXB68eA79MWq7oBg3h73hWGBkNbbUuSouFe6aQd+YGA2tHLk8eA3/OdYIglpwJRUNA6uwlc5TUans28Edh74xMRpaOXJ58Br+B4lGVLSP8PW20DkqJuaulYk8MNA3JkZDK0fuwuQYqTVxJdo656eIVLLr5E57WLxu0DcmRkMrR+6/Td5aSwrOTfGoYNfIlnpQvGqeVugbE6OhldM/c4zdmkGZWc3K/GOy1lamTUz8Af7rUXt1Ah4SAAAAAElFTkSuQmCC",emissionRate:this.emissionRate,startColor:new Cesium.Color(this.startColor[0],this.startColor[1],this.startColor[2],this.startColor[3]),endColor:new Cesium.Color(this.endColor[0],this.endColor[1],this.endColor[2],this.endColor[3]),imageSize:n,updateCallback:function(e,n){o=Cesium.Cartesian3.normalize(e.position,o),o=Cesium.Cartesian3.multiplyByScalar(o,-1050,o),e.position=Cesium.Cartesian3.add(e.position,o,e.position);var s=Cesium.Cartesian3.distance(i.camera.position,e.position);e.endColor.alpha=s>r?0:t.endColor.alpha/(s/r+.1)}}),t.show=this.enabled,i.primitives.add(t)}}else t&&(i.primitives.remove(t),t=void 0);t&&(t.emissionRate=this.emissionRate,t.startScale=this.startScale,t.endScale=this.endScale,t.startColor=new Cesium.Color(this.startColor[0],this.startColor[1],this.startColor[2],this.startColor[3]),t.endColor=new Cesium.Color(this.endColor[0],this.endColor[1],this.endColor[2],this.endColor[3]))}))}destroy(){return this.autoUpdateDisposer&&(this.autoUpdateDisposer(),this.autoUpdateDisposer=void 0),super.destroy()}}kh.defaultOptions={enabled:!1,emissionRate:5e3,startScale:1,endScale:0,startColor:[.27,.5,.7,0],endColor:[.27,.5,.7,.98]};const Uh=kh;class jh extends h.Z{constructor(e){super(),this._earth=e;let t=e.czm.scene;var i;this.autoUpdateDisposer=(0,P.autorun)((()=>{if(this.enabled){if(!i){var e=t.drawingBufferWidth/100,r=1e5,n=new Cesium.Cartesian2(e,e),o=new Cesium.Cartesian2(2*e,2*e),s=new Cesium.Cartesian3;i=new Cesium.ParticleSystem({modelMatrix:new Cesium.Matrix4.fromTranslation(t.camera.position),minimumSpeed:-1,maximumSpeed:0,lifetime:15,emitter:new Cesium.SphereEmitter(r),startScale:this.startScale,endScale:this.endScale,image:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAABGdBTUEAALGPC/xhBQAAAAlwSFlzAAAOwgAADsIBFShKgAAAABl0RVh0U29mdHdhcmUAcGFpbnQubmV0IDQuMC4xOdTWsmQAAAxDSURBVHhe7dsJjG1FEQbgx1ORRXZBBBEkLAKiEQg+IIBBFpVFUNSASIgYEIn7vhNXFI1CNODKoiIoUYJbUCERcCEmBldUIBE0BFQ2FQSR9/y/Q9fJvTN3nsydYWbAqeRPn9NdXVW9VVf3uXfJIi3SIi3SfNKKFSuWtcf/H0qjVxnAmfXcih9eNNDQwtLgEQ3rBPe21LuyIf4m5qFFAw2oxj4Sli9f/qhg1Tw/GvK8T1K0X+B9VTx57viDoU5p4hcmlZHN4BphDdLg1ZKunnSN4DGQ97WCd+R5RUu7/GCNxquOulDyFmZnNKMGR7sb5TRAg9cM1s7zOsF6wQbBYyH5FwU64NstTxkeS2LtYM08k2HGkDk0K5r6+SNGNNQIGfHVkhpFI6zR6+d9w2DjPG+S9AlJn9jwp7zrgBu9tzI8Gwcb5nn9gIy18k4m2YMzYv5mQylnSAyzbrsRZ2ywbmBEHxdsGmye8i2TbhVsG2yX9z2CnpL3zFa2VV7xbh6oSwZZZJLdzYikdM5PJ5RSBjRDjIx1bbRMY0ZvFjwp2Dpl2yfdMXh6sEuwa/LeEPSUvDe1Mjw7JkudrQMyyCKTbMuDr+Aj5r4TShnFMcB0ZIiRsXY3CozaFsE2wVOCnQIN3iPp3sE+Aa9/btBT8r7ayvbOK95dA3XJIItMsumgy7IoRzk3nVBKKKQ4qClvnVvjmyU1zXcIGL9boNH7BQcGhwYvCF4UXBXenvL+m1aGB6866pJB1g5hI5sOuviHbkkED34nlPCmqGt8Ut7dtGSQNWuknhoYvb2C/YODw3d40iODY4Jjg+OCu5LfU97vbmV4jkyWOgcHZJBFJtl00EXnBuFjA1se3E5ogrvGBzXtjcLjA+u0pjvn9qykBwUacVSgYScErw5eH5wcnkmU/I81HrzqqEvGQSkm09KgY7uATrq7mZDywR1idjuAwGBpFInkyuFZh0aBIQzaOTgtODo4NDxHJNWIEwONfkvwzuCk4MKUT6LkX9R48Kqj7rEpIsvSOCDYM3hO8JHAkmDDeuFhUznG2Y0TmkA9KyAR2FBY017jjQrDjkn+bUnPCYzia4O3Bu8JPhB8ODDKPw/fJEr+LxsPXnXUJeP44OiwmA2fCG4Jnh/QbYsVN7CJbWxk69Jm/swogobWfWCr44kFMvbtavyzAwZ+Mbwa88fg1EBjTgkY/sng9OBmPBMp+X9tPHjVUfddwRsDHXJ14zs7oJNuNrCFTWwb8getGeNThBh9IWite07PdmT6PS3YPTA1eXAO7FXB9eFn6L3BTwKN/kzw+YDx/1E+ilJm9uD9VPDxwIy4OHBqVH59YBehk242sIVNbCt/wOaZzYII6EY/QvWonq2pb0+21dnfOSfr09p/ZfDmwCh2BqM8m7LfCb4UfLdlj6SUfz/QSTrra8FfWpGy+4IPBuVn6LY7sGWLvNdSGNoaW3OmTyoHjrE1+g4w4nVbkelnezoweZyUdVpTlYO6MvmDlKzlvwt+0d5HUivX8N+qcH/u/ZTXHwV0HJ9XOsULbGDLNsljm7CZrTULxusAFYPy/LX2haPdlpeyZUnt0db9ywLOynr9UGDtfy64LXxDlLx+ZoyilP8t+Ed77Sl5twb8Ah100Un3/ilmi22YbWzsfEEw/o6gUlCe3xZTa198rsdFaQIVe7XtisfmtKzbM4Kzgu8FQ6M4LkXMNwKy6aCLTrrZwBY2sa3zBanivFA7wtgd0E3/pM7mjqe8ra3HuhPPGwF7vT3b1DdCnNcXAutdfP/78M2IIsPSIZNsOuiiU4zABmEzm9jmWO34LUIcfxmopHKErB44gXEwjqlOaiIy6+8lgf1e4GJkbF88+NnhOT/pD4JfBSud9iuj1L0nySVJdSjZdNBFJ91s4IfYxLYtA47aMnCzNHYHdOs/qbUk6tskMMUcV005nt+2J3QVvX024MF/HdjPp9zqxiHymtyrgm8F/AzdbGALm9jGRrbWbtD5gdasB04qpbKtpFv/SXlYQYcz+2GB7eibwdXBv1I+5xS9dwVmmF2Dc9w32DZFbO38QFJtmF4HpELvACPAdDLd3x8ISG5M/oKl2PfnwB0jP2GH0BHTc4SYg92Dc4Kx1+8CIfafFezWmve/KczdDEgPCoA4P2uM4+HURsbxC4Vi303BxXk0A54bCN7GmgHVAWJrW6CTn5DTDc1RyXOq4/SuyzNPPecU3fcE1+aRL7JEnxew0QmRzRURjtcBAR/QhcCB/XX7YFngICIUtQ1VAPTl4LLgmmBSBDgbRG7A6doWRZpvD9hwRIoPCNjmMlW80oXEeZ9+MIS5VRrsADezfRAUOJG52nKb+75AlPbpQAxwXtILg8sD2+ItyRuLUtex+rI8XpDUIYkOuuikmw1sGQyG2Dp+B6BUGNoGm9DaBt3eOv5WFOiWx5Jw7D0z+ErAYOGrW55/Rs5YlLp3BjqTTLLpoIvOLhoM2MImtrGRreNvgyiVVknlwUCo7gAmBkKvCezBzu2OwUJWy0EY/PXgmsiYEUXGH5pMsumgi066JwZCdTcwGAhNb/SRSoFQmBBfZaYKhd0BlB+oUNj2aRnYNWbjMESM+4TBUJhOuieFwknFLmx2hzGzs0DQHYYizJVT3QFaa3UUfnlQy+CjQR2GjNio4/BKd4yUW/N3tteeknd7YPrTUdOf7u5IHNT6Z+NGqeIAN+PDUN0GWUuunwePw77lHRK8NHA0fVtQs8Bx+GepN0TJuy64vL2OpJRfEfAbdpOJFyI/Deigi0662cCWweOwDzW1/qfvAJFKwdCFSN5NrfoGIB6wHb4w4IheF7w7ODkYuvfL89+DSwM+QeNWdieonAPlQ4Tet7ciZa7E+AC66KSbDWzpLkTCVifB/iAUTL8DkIrByq7EOB4fQHz1eUVgWzI9bwhfGWwbPC+vfIJGadytyidS8u/Ak0e8lpBLFfv9lcF9jcelqLVPJ91sYMvsXokhlYNRl6JmgYjrGYETmNOhi8oTU35BwNCbA1uXfZtPcNvrTH9uMPKSJPnXNh686qjrY4s7xtPDUrfN5NJJNxvY0o1+MHuXoigCJl6L6+HOFyTPlbRPYaIwzsjUvCPPpu57A8uBT+AYeXA3vfbyK8IziZL/48aDVx11yTgpxS5AnP/NJs5Vh9PNhlr7FfzU6M/840iEDM2CpNZXfRh5cmD61ecqI1cOynLgEzgtnltjrF+e/PzImkTJd67Hg1cddckgi0x7vnUvNUPoZkP/YSRiZm/0iyKomwURrGddNtZScBcv9vZd0PV0fRA1OnyCGaFD+AWNMZVFcULZu1O3p7z/u+XjwauOumSQRSbZOpqunVPNjy4Gvwfw/LM3+kURVrOAV62l0H0Zzrs7OJ0gDN0zz7yy9clJ2aeNnD1b4CJ60zBxvFNkT3m/oZXhwauOumSQdVjYyDbbdsmzg5mgZ+gLcVI2zt7oFxFIcBT4RuiiVCc4I/hRU3XCTklFZJyT62rT1V6tETy30FXDfD26JLw95f2HrQwPXnXUJYOsfcNGNh3VeHd/3eewgE2zO/UHidAGS2HwBxIcj1HwucxBhFPimf3UxYgJVExdIau1q2G+Ip2R8p7yzuMrw4NXnUNSRIatjkyy6aCLTtty9wOJQOO7bQ+a2bNLTXj5g1G/EuGMHEZsSxyUAEWUJlR1dvA9T8NeHByX557yfkISZQ42eNVRt/+JTEA2HXQ57U1s/PhBzwMlCpqi6oRaDpwQT2w7EicIlupXI/2PpJL6oOmjipG9KSly3S1P2VQ/kiJz05TR0f1IKqhpPzeNL6KoKaSYAd3uEGNskaalEXImZ/RUP5PzPe/SpMj612BleCb9TC7vZFpu/c/kgrlvfBGFTTGnYyYwyHTkjY1QdYQZ4YTGaZnC1rAfSmrgKUmRz11Ocsrw4FXHiHcNT9qNelI6qvF0z33jiyhuYEi3JJL2HRE4k/MPpq2GTPyp7OF5t/5dafU/lQ3wqqNu9wtRMgPbXI165+2hmTN/1AzpZkMMtA93MyJgtOnKWWmIUdQoU9moCmL8isRoy1OGZ1111M1zP+JJa4+fv1GfihjUUMui64ygmxVJR/1cHhx+jHCXj6fxdqMdVKP7hkNTuzCpjGwGM9yUtUQm/mFCI/caeK8Gd/zBQ6fRU1EZP4B+hoxA39hCE/PwoomNLLTiRVqkRVqkRZobWrLkv2pLYf4WcPZRAAAAAElFTkSuQmCC",emissionRate:this.emissionRate,startColor:new Cesium.Color(this.startColor[0],this.startColor[1],this.startColor[2],this.startColor[3]),endColor:new Cesium.Color(this.endColor[0],this.endColor[1],this.endColor[2],this.endColor[3]),minimumImageSize:n,maximumImageSize:o,updateCallback:function(e,n){s=Cesium.Cartesian3.normalize(e.position,s),Cesium.Cartesian3.multiplyByScalar(s,Cesium.Math.randomBetween(-30,-300),s),e.velocity=Cesium.Cartesian3.add(e.velocity,s,e.velocity);var o=Cesium.Cartesian3.distance(t.camera.position,e.position);e.endColor.alpha=o>r?0:i.endColor.alpha/(o/r+.1)}}),t.primitives.add(i)}}else i&&(t.primitives.remove(i),i=void 0);i&&(i.emissionRate=this.emissionRate,i.startScale=this.startScale,i.endScale=this.endScale,i.startColor=new Cesium.Color(this.startColor[0],this.startColor[1],this.startColor[2],this.startColor[3]),i.endColor=new Cesium.Color(this.endColor[0],this.endColor[1],this.endColor[2],this.endColor[3]))}))}destroy(){return this.autoUpdateDisposer&&(this.autoUpdateDisposer(),this.autoUpdateDisposer=void 0),super.destroy()}}jh.defaultOptions={enabled:!1,emissionRate:7e3,startScale:.5,endScale:1,startColor:[1,1,1,.5],endColor:[1,1,1,1]};const Gh=jh;class zh extends h.Z{constructor(e){super(),this._earth=e,this.autoUpdateDisposer=(0,P.autorun)((()=>{var e=this._earth.czm.scene.sun;e&&(e.show=this.enabled,e.glowFactor=this.glowFactor);const t=this._earth.czm.scene;t.sunColor&&t.sunColor.x?(this._earth.czm.scene.sunColor.x=this.color[0],this._earth.czm.scene.sunColor.y=this.color[1],this._earth.czm.scene.sunColor.z=this.color[2]):(t.sunBloom=this.bloom,t.light.color=new Cesium.Color(...this.color))}))}destroy(){return this.autoUpdateDisposer&&(this.autoUpdateDisposer(),this.autoUpdateDisposer=void 0),super.destroy()}}zh.defaultOptions={enabled:!0,glowFactor:1,bloom:!0,color:[1.8,1.85,2,1]};const Yh=zh;var Zh=i(5108),Wh=function(e,t,i,r){return new(i||(i=Promise))((function(n,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?n(e.value):function(e){return e instanceof i?e:new i((function(t){t(e)}))}(e.value).then(s,a)}l((r=r.apply(e,t||[])).next())}))},Xh=function(e,t){var i,r,n,o,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,r&&(n=2&o[0]?r.return:o[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,o[1])).done)return n;switch(r=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(n=s.trys,(n=n.length>0&&n[n.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){s.label=o[1];break}if(6===o[0]&&s.label<n[1]){s.label=n[1],n=o;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(o);break}n[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{i=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},Jh=i(8897),Kh=i(5285),Vh=i(8),qh=function(){function e(){}return e.formatUrlByBaseJs=function(e){var t=this.getBaseUrlFromMetaScript();if(void 0!==t)return"".concat(t).concat(e)},e.getBaseUrlFromMetaScript=function(){for(var e=/((?:.*\/)|^)geovisearth[\w-]*\.js(?:\W|$)/i,t=/((?:.*\/)|^)geovisearth.min[\w-]*\.js(?:\W|$)/i,i=/((?:.*\/)|^)geovisearth.sdk[\w-]*\.js(?:\W|$)/i,r=document.getElementsByTagName("script"),n=0,o=r.length;n<o;++n){var s=r[n].getAttribute("src"),a=e.exec(s);if(null!==a)return a[1];if(null!==(a=t.exec(s)))return a[1];if(null!==(a=i.exec(s)))return a[1]}},e.createGuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))},e.defaultValue=function(e,t){return null!=e?e:t},e.formatURLByCustom=function(e,t){if(t){var i=t.split("/");if(!e)return t;var r=e.split("/");r.pop();for(var n="",o=0;o<i.length;o+=1)0===o&&"."===i[o]&&(o+=1),".."===i[o]?r.pop():r.push(i[o]);for(o=0;o<r.length;o+=1){var s=o===r.length-1?"":"/";n+=r[o]+s}return n}},e.formatURL=function(e){if(e){var t=e.split("/"),i=window.location.href;if(!i)return e;(i=i.split("/")).pop();for(var r="",n=0;n<t.length;n+=1)0===n&&"."===t[n]&&(n+=1),".."===t[n]?i.pop():i.push(t[n]);for(n=0;n<i.length;n+=1){var o=n===i.length-1?"":"/";r+=i[n]+o}return r}},e.formatURLByHost=function(e){if(e){var t=window.location.origin;if(!t)return e;for(var i=e.split("/"),r=[t],n="",o=0;o<i.length;o+=1)0===o&&"."===i[o]&&(o+=1),".."===i[o]?o+=1:r.push(i[o]);for(o=0;o<r.length;o+=1){var s=o===r.length-1?"":"/";n+=r[o]+s}return n}},e.a_aToaA=function(e){return e.replace(/_[a-z]/g,(function(e){return e.toUpperCase().charAt(1)}))},e.aAToa_a=function(e){return e.replace(/[A-Z]/g,(function(e){return"_"+e.toLowerCase()}))},e.getLocation=function(e){var t={dir:"",filename:""};new RegExp(/^http:\/\//g).test(e)&&(e=e.substring(6));for(var i=e.split("/"),r=0;r<i.length;r++)r===i.length-1?(t.dir+="/",t.filename=i[r]):null!==i[r]&&""!==i[r]&&(t.dir+="/".concat(i[r]));return t.dir="http:/".concat(t.dir),t},e.syncGetText=function(e){var t=new XMLHttpRequest;if(t.open("GET",e,!1),t.send(),4==t.readyState&&200==t.status)return t.responseText},e.syncGetJson=function(e){var t=this.syncGetText(e);if(t)return JSON.parse(t)},e.formatURL2=function(e,t){if(t){var i=t.split("/"),r=e;if(!r)return t;(r=r.split("/")).pop();for(var n="",o=0;o<i.length;o+=1)0===o&&"."===i[o]&&(o+=1),".."===i[o]?r.pop():r.push(i[o]);for(o=0;o<r.length;o+=1){var s=o===r.length-1?"":"/";n+=r[o]+s}return n}},e.html2canvas=function(e,t,i){Jh(e,t).then((function(e){i(e,t.self||null)}))},e.epsg3857To4326=function(e,t){var i=new Array;return i.push(e),i.push(t),Kh("EPSG:3857","EPSG:4326",i)},e.epsg4326To3857=function(e,t){var i=new Array;return i.push(e),i.push(t),Kh("EPSG:4326","EPSG:3857",i)},e.getRectangleFromcode=function(e,t,i){return(new Cesium.GeographicTilingScheme).tileXYToNativeRectangle(t,i,e)},e.getCodeFromScreenPosition=function(e,t){var i;try{i=e.scene.globe.pick(e.camera.getPickRay(t),e.scene)}catch(e){Zh.log("fromScreen:输入的x，y值未在地球上找到相应经纬度值")}var r=e.scene.globe.ellipsoid.cartesianToCartographic(i),n=(Cesium.Math.toDegrees(r.latitude),Cesium.Math.toDegrees(r.longitude),r.height,e.scene.globe._surface.tileProvider._tilesToRenderByTextureCount),o=new Map;if(o.set(0,"284公里"),o.set(1,"142公里"),o.set(2,"71公里"),o.set(3,"36公里"),o.set(4,"17公里"),o.set(5,"9公里"),o.set(6,"4公里"),o.set(7,"7公里"),o.set(8,"568米"),o.set(9,"549米"),o.set(10,"278米"),o.set(11,"139米"),o.set(12,"69米"),o.set(13,"35米"),o.set(14,"17米"),o.set(15,"8米"),o.set(16,"4米"),o.set(17,"2.15米"),o.set(18,"1.07米"),o.set(19,"0.54米"),o.set(20,"0.27米"),o.set(21,"0.138米"),o.set(22,"0.069米"),Cesium.defined(n)){for(var s=n.length,a=-1,l=-1,h=-1,c=0;c<s;++c){var u=n[c];if(Cesium.defined(u))for(var p=u.length,d=0;d<p;++d){var m=u[d].rectangle;Cesium.Rectangle.contains(m,r)&&u[d].level>a&&(a=u[d].level,l=u[d].x,h=u[d].y)}}return{level:a,x:l,y:h,resolution:o.get(a)}}},e.PrefixInteger=function(e,t){return(Array(t).join("0")+e).slice(-t)},e.calculateNewGeoposition=function(e,t,i,r,n,o){var s=Cesium.Cartesian3.fromDegrees(t,i,r),a=new Cesium.WebMercatorProjection(e.scene.globe.ellipsoid),l=a.project(Cesium.Cartographic.fromCartesian(s)),h=Cesium.Math.toRadians(o),c=new Cesium.Cartesian3(l.x+n*Math.cos(h),l.y+n*Math.sin(h),r),u=a.unproject(c);return{lon:Cesium.Math.toDegrees(u.longitude),lat:Cesium.Math.toDegrees(u.latitude)}},e.drawImgToEarth=function(t,i,r){return Wh(this,void 0,void 0,(function(){return Xh(this,(function(n){switch(n.label){case 0:return[4,e._drawOriginImgToEarth(t,i,r)];case 1:return[2,n.sent()]}}))}))},e._drawOriginImgToEarth=function(e,t,i){return new Promise((function(r,n){fetch(t).then((function(e){if(!e.ok)throw new Error("Network response was not ok");return e.blob()})).then((function(t){var o=new FileReader;o.readAsDataURL(t),o.onload=function(t){var o=t.target.result,s=Vh.dump(Vh.load(o)).match(/(GeoHDVPoint\=\[=?)(\S*)(?=\])/),a=e.scene.imageryLayers;if(s&&3==s.length){var l=s[2].split("&"),h=a.addImageryProvider(new Cesium.SingleTileImageryProvider({url:o,rectangle:Cesium.Rectangle.fromDegrees(l[0],l[1],l[2],l[3])}));r(h)}else if(i){h=a.addImageryProvider(new Cesium.SingleTileImageryProvider({url:o,rectangle:Cesium.Rectangle.fromDegrees(i[0],i[1],i[2],i[3])}));r(h)}else n("找不到图片的地理信息或地理信息不合法。"),alert("找不到图片的地理信息或地理信息不合法。")}})).catch((function(e){n(e),Zh.error("There has been a problem with your fetch operation:",e)}))}))},e.intersectionWithTerrain=function(e,t,i){var r=Cesium.Cartesian3.normalize(Cesium.Cartesian3.subtract(i,t,new Cesium.Cartesian3),new Cesium.Cartesian3),n=new Cesium.Ray(t,r);return e.scene.globe.pick(n,e.scene)},e.isJson=function(e){return!0},e.isObject=function(e){return"object"==typeof e&&null!==e},e.isBoolean=function(e){return"boolean"==typeof e},e.isTrueOrFalse=function(e){return"boolean"==typeof e||"true"===e||"false"===e},e.isString=function(e){return"string"==typeof e&&e.constructor===String},e.isNumber=function(e){return"number"==typeof e&&e.constructor===Number},e.isStrNumber=function(t){return e.isString(t)?!isNaN(parseFloat(t)):"number"==typeof t&&t.constructor===Number},e.isArray=function(e){return e instanceof Array},e.isAddUnit=function(e){return new RegExp(/^(\-|\+)?\d+(m|px)?$/).test(e)},e.filterUnit=function(t){return e.isNumber(t)?t:Number(t.match(/^(\-|\+)?\d+/)[0])},e.isColor=function(e){return new RegExp("^#([0-9a-fA-F]{6}|[0-9a-fA-F]{8})$").test(e)},e.jsonSyncPromise=function(e){},e.getBase64=function(e){return new Promise((function(t,i){var r=new Image,n="";r.src=e,r.setAttribute("crossOrigin","Anonymous"),r.onload=function(){var e=document.createElement("canvas"),i=r.width,o=r.height;return e.width=i,e.height=o,e.getContext("2d").drawImage(r,0,0,i,o),n=e.toDataURL("image/jpeg"),t(n)},r.onerror=function(e){i(e)}}))},e}();const $h=window.Cesium,ec=$h.BoxGeometry,tc=$h.Cartesian3,ic=$h.defaultValue,rc=$h.defined,nc=$h.destroyObject,oc=$h.DeveloperError,sc=$h.GeometryPipeline,ac=$h.Matrix3,lc=$h.Matrix4,hc=$h.Transforms,cc=$h.VertexFormat,uc=$h.BufferUsage,pc=$h.CubeMap,dc=$h.DrawCommand,mc=$h.loadCubeMap,fc=$h.RenderState,gc=$h.VertexArray,Ac=$h.BlendingState,yc=$h.SceneMode,vc=$h.ShaderProgram,Cc=$h.ShaderSource;function _c(e){this.sources=e.sources,this._sources=void 0,this.show=ic(e.show,!0),this._command=new dc({modelMatrix:lc.clone(lc.IDENTITY),owner:this}),this._cubeMap=void 0,this._attributeLocations=void 0,this._useHdr=void 0}$h.defined($h.Matrix4.getRotation)||($h.Matrix4.getRotation=$h.Matrix4.getMatrix3);const bc=new ac;_c.prototype.update=function(e,t){const i=this;if(!this.show)return;if(e.mode!==yc.SCENE3D&&e.mode!==yc.MORPHING)return;if(!e.passes.render)return;const r=e.context;if(this._sources!==this.sources){this._sources=this.sources;const e=this.sources;if(!(rc(e.positiveX)&&rc(e.negativeX)&&rc(e.positiveY)&&rc(e.negativeY)&&rc(e.positiveZ)&&rc(e.negativeZ)))throw new oc("this.sources is required and must have positiveX, negativeX, positiveY, negativeY, positiveZ, and negativeZ properties.");if(typeof e.positiveX!=typeof e.negativeX||typeof e.positiveX!=typeof e.positiveY||typeof e.positiveX!=typeof e.negativeY||typeof e.positiveX!=typeof e.positiveZ||typeof e.positiveX!=typeof e.negativeZ)throw new oc("this.sources properties must all be the same type.");"string"==typeof e.positiveX?mc(r,this._sources).then((function(e){i._cubeMap=i._cubeMap&&i._cubeMap.destroy(),i._cubeMap=e})):(this._cubeMap=this._cubeMap&&this._cubeMap.destroy(),this._cubeMap=new pc({context:r,source:e}))}const n=this._command;if(n.modelMatrix=hc.eastNorthUpToFixedFrame(e.camera._positionWC),!rc(n.vertexArray)){n.uniformMap={u_cubeMap:function(){return i._cubeMap},u_rotateMatrix:function(){return lc.getRotation(n.modelMatrix,bc)}};const e=ec.createGeometry(ec.fromDimensions({dimensions:new tc(2,2,2),vertexFormat:cc.POSITION_ONLY})),t=this._attributeLocations=sc.createAttributeLocations(e);n.vertexArray=gc.fromGeometry({context:r,geometry:e,attributeLocations:t,bufferUsage:uc._DRAW}),n.renderState=fc.fromCache({blending:Ac.ALPHA_BLEND})}if(!rc(n.shaderProgram)||this._useHdr!==t){const e=new Cc({defines:[t?"HDR":""],sources:["uniform samplerCube u_cubeMap;\n  varying vec3 v_texCoord;\n  void main()\n  {\n  vec4 color = textureCube(u_cubeMap, normalize(v_texCoord));\n  gl_FragColor = vec4(czm_gammaCorrect(color).rgb, czm_morphTime);\n  }\n  "]});n.shaderProgram=vc.fromCache({context:r,vertexShaderSource:"attribute vec3 position;\n  varying vec3 v_texCoord;\n  uniform mat3 u_rotateMatrix;\n  void main()\n  {\n  vec3 p = czm_viewRotation * u_rotateMatrix * (czm_temeToPseudoFixed * (czm_entireFrustum.y * position));\n  gl_Position = czm_projection * vec4(p, 1.0);\n  v_texCoord = position.xyz;\n  }\n  ",fragmentShaderSource:e,attributeLocations:this._attributeLocations}),this._useHdr=t}return rc(this._cubeMap)?n:void 0},_c.prototype.isDestroyed=function(){return!1},_c.prototype.destroy=function(){const e=this._command;return e.vertexArray=e.vertexArray&&e.vertexArray.destroy(),e.shaderProgram=e.shaderProgram&&e.shaderProgram.destroy(),this._cubeMap=this._cubeMap&&this._cubeMap.destroy(),nc(this)};const wc=_c;class Pc extends h.Z{constructor(e){super(),this._earth=e,this.disposers.push((0,P.autorun)((()=>{var e=this._earth.czm.scene.skyBox;e&&(e.show=this.enabled)})));const t=this._earth.czm.scene.skyAtmosphere;let i=qh.formatUrlByBaseJs("resources/images/daylight/");const r={positiveX:i+"Daylight_Box_px.jpg",negativeX:i+"Daylight_Box_mx.jpg",positiveY:i+"Daylight_Box_py.jpg",negativeY:i+"Daylight_Box_my.jpg",positiveZ:i+"Daylight_Box_pz.jpg",negativeZ:i+"Daylight_Box_mz.jpg"},n=()=>{this._earth._loadMode&&1===this._loadMode&&this.skyBoxOnGround?(this._earth.czm.scene.skyAtmosphere!==t&&(this._earth.czm.scene.skyAtmosphere.destroy(),this._earth.czm.scene.skyAtmosphere=void 0),this._earth.czm.scene.skyAtmosphere=new Cesium.XbsjSkyAtmosphere(void 0,{negativeX:this.westSkyBoxOnGroundImageUri||r.negativeX,negativeY:this.topSkyBoxOnGroundImageUri||r.negativeY,negativeZ:this.southSkyBoxOnGroundImageUri||r.negativeZ,positiveX:this.eastSkyBoxOnGroundImageUri||r.positiveX,positiveY:this.bottomSkyBoxOnGroundImageUri||r.positiveY,positiveZ:this.northSkyBoxOnGroundImageUri||r.positiveZ})):this._earth.czm.scene.skyAtmosphere=t,this._earth.czm.scene.skyAtmosphere&&(this._earth.czm.scene.skyAtmosphere.show=!this.backgroundImageUri)};n(),this.disposers.push((0,P.reaction)((()=>({skyBoxOnGround:this.skyBoxOnGround,westSkyBoxOnGroundImageUri:this.westSkyBoxOnGroundImageUri,bottomSkyBoxOnGroundImageUri:this.bottomSkyBoxOnGroundImageUri,northSkyBoxOnGroundImageUri:this.northSkyBoxOnGroundImageUri,eastSkyBoxOnGroundImageUri:this.eastSkyBoxOnGroundImageUri,topSkyBoxOnGroundImageUri:this.topSkyBoxOnGroundImageUri,southSkyBoxOnGroundImageUri:this.southSkyBoxOnGroundImageUri})),n));const o=this._earth.czm.scene.skyBox;Cesium.XbsjBackGroundImage?(this._backgroundImage=new Cesium.XbsjBackGroundImage,this._backgroundImage.material=Cesium.Material.fromType("Image")):this._backgroundImage=new wc({sources:{positiveX:i+"Daylight_Box_px.jpg",negativeX:i+"Daylight_Box_mx.jpg",positiveY:i+"Daylight_Box_py.jpg",negativeY:i+"Daylight_Box_my.jpg",positiveZ:i+"Daylight_Box_pz.jpg",negativeZ:i+"Daylight_Box_mz.jpg"}});const s=()=>{"string"==typeof this.backgroundImageUri&&""!==this.backgroundImageUri?(this._earth.czm.scene.skyBox=this._backgroundImage,this._backgroundImage.material.uniforms.image=this.backgroundImageUri):this._earth.czm.scene.skyBox=o,this._earth.czm.scene.skyAtmosphere&&(this._earth.czm.scene.skyAtmosphere.show=!this.backgroundImageUri),this._earth.czm.scene.skyBox&&(this._earth.czm.scene.skyBox.show=this.enabled)};this.disposers.push((0,P.reaction)((()=>({backgroundImage:this.backgroundImageUri,enabled:this.enabled})),s)),s()}}Pc.defaultOptions={enabled:!0,skyBoxOnGround:!1,westSkyBoxOnGroundImageUri:"",southSkyBoxOnGroundImageUri:"",eastSkyBoxOnGroundImageUri:"",northSkyBoxOnGroundImageUri:"",topSkyBoxOnGroundImageUri:"",bottomSkyBoxOnGroundImageUri:"",backgroundImageUri:""};const Sc=Pc;class xc extends h.Z{constructor(e){super(),this.cloudOpacity=.5,this._earth=e,this._disposer=(0,P.autorun)((()=>{if(this.enabled){if(!this._primitive)if(this._earth._loadMode&&1===this._earth._loadMode){const e=R.Z.getScriptBaseUrl();this._primitive=new Cesium.XbsjWorldCloud(e+"resources/images/earthclouds1k.jpg"),this._earth.czm.scene.primitives.add(this._primitive),this._primitive.show=this.enabled,this._primitive.aroundTime=this.aroundTime}else{this.enableCloudProperty(this.enabled);let e=new Cesium.RectangleGeometry({rectangle:Cesium.Rectangle.fromDegrees(-180,-90,180,90),height:5e3}),t=new Cesium.GeometryInstance({geometry:e}),i={type:"InterMaterial",uniforms:{repeat:new Cesium.Cartesian2(1,1),color:new Cesium.Color(1,1,1,1),time:1,image:Cesium.Material.DefaultImageId},source:"czm_material czm_getMaterial(czm_materialInput materialInput)\n                                {\n                                     czm_material material = czm_getDefaultMaterial(materialInput);\n                                     vec2 st = materialInput.st;\n                                     vec4 colorImage = texture2D(image,   vec2(fract(st.s + time),fract(st.t)));\n                                     material.alpha = colorImage.a * color.a  ;\n                                     material.diffuse =    color.rgb  ;\n                                     return material;\n                                 }"},r=new Cesium.Material({fabric:i});let n=R.Z.getScriptBaseUrl()+"resources/images/cloud.png";new Cesium.Resource({url:n}).fetchImage().then((e=>{r.uniforms.image=e;let i=new Cesium.EllipsoidSurfaceAppearance({material:r,translucent:!0});this._primitive=new Cesium.Primitive({geometryInstances:t,appearance:i,vertexCacheOptimize:!0,interleave:!1,compressVertices:!0,releaseGeometryInstances:!0,asynchronous:!0,allowPicking:!1,show:!0}),this._earth.czm.scene.primitives.add(this._primitive)}))}}else this._primitive&&(this._earth.czm.scene.primitives.remove(this._primitive),this._primitive=void 0)}))}enableCloudProperty(e){const t=R.Z.getScriptBaseUrl();let i=new Cesium.SingleTileImageryProvider({url:t+"resources/images/night_1-2k.jpg"});if(e){i.defaultAlpha=1,i.defaultDayAlpha=0,i.defaultNightAlpha=1;let e=this._earth.czm.viewer.imageryLayers.addImageryProvider(i);this._earth.czm.viewer.imageryLayers.lowerToBottom(e),this.cloudSpeedTimes=1;let t=925e4,r=45e5;this._earth.czm.viewer.scene.postRender.addEventListener((i=>{let n=this._earth.czm.viewer.scene.camera.positionCartographic.height,o=this.cloudOpacity;if(n<r)return o=0,void(this._primitive&&this._primitive.appearance.material.uniforms.color.alpha!=o&&(this._primitive.appearance.material.uniforms.color.alpha=o));if(n>t)o=this.cloudOpacity;else{o=(n-r)/(1*(t-r)/this.cloudOpacity)}if(this._primitive){let e=this._primitive.appearance.material.uniforms.time;e>1?e=0:e+=1e-5*this.cloudSpeedTimes,this._primitive.appearance.material.uniforms.time=e,this._primitive.appearance.material.uniforms.color.alpha=o}if(this._earth.czm.viewer.scene.globe.enableLighting){let t=this._earth.czm.viewer.scene.camera.positionCartographic.height,i=9e6,r=i/3;if(t<r)e.alpha=0;else if(t>i)e.alpha=1;else{let n=i-r,o=t-r;e.alpha=o/n}}else e.alpha=0}))}}destroy(){return this._disposer=this._disposer&&this._disposer(),super.destroy()}}xc.defaultOptions={enabled:!1,aroundTime:120};const Bc=xc;class Mc extends c.Z{constructor(e){super(e),this._earth=e;let t=this._earth.czm.scene;this.autoUpdateDisposer=(0,P.autorun)((()=>{var e=t.postProcessStages.ambientOcclusion;e.enabled=this.enabled,e.uniforms.ambientOcclusionOnly=this.ambientOcclusionOnly,e.uniforms.intensity=this.intensity,e.uniforms.bias=this.bias,e.uniforms.lengthCap=this.lengthCap,e.uniforms.stepSize=this.stepSize,e.uniforms.blurStepSize=this.blurStepSize}))}destroy(){return this.autoUpdateDisposer&&(this.autoUpdateDisposer(),this.autoUpdateDisposer=void 0),super.destroy()}}Mc.defaultOptions={enabled:!1,ambientOcclusionOnly:!1,intensity:3,bias:.1,lengthCap:.03,stepSize:1,blurStepSize:.86},c.Z.registerType(Mc,"AmbientOcclusionStage");const Ec=Mc;class Tc extends c.Z{constructor(e){super(e),this._earth=e;let t=this._earth.czm.scene;this.autoUpdateDisposer=(0,P.autorun)((()=>{var e=t.postProcessStages.bloom;e.enabled=this.enabled,e.uniforms.glowOnly=this.glowOnly,e.uniforms.contrast=this.contrast,e.uniforms.delta=this.delta,e.uniforms.brightness=this.brightness,e.uniforms.stepSize=this.stepSize,e.uniforms.sigma=this.sigma,e.uniforms.stepSize=this.stepSize}))}destroy(){return this.autoUpdateDisposer&&(this.autoUpdateDisposer(),this.autoUpdateDisposer=void 0),super.destroy()}}Tc.defaultOptions={enabled:!1,glowOnly:!1,contrast:128,brightness:-.3,delta:1,sigma:3.78,stepSize:5},c.Z.registerType(Tc,"BloomStage");const Oc=Tc;class Lc extends c.Z{constructor(e){super(e),this._earth=e;let t=this._earth.czm.scene;this.autoUpdateDisposer=(0,P.autorun)((()=>{var e=t.postProcessStages;this.enabled?(this._stage||(this._stage=Cesium.PostProcessStageLibrary.createBlackAndWhiteStage(),e.add(this._stage)),this._stage.enabled=!0,this._stage.uniforms.gradations=this.gradations):this._stage&&(e.remove(this._stage),this._stage=void 0)}))}destroy(){return this.autoUpdateDisposer&&(this.autoUpdateDisposer(),this.autoUpdateDisposer=void 0),super.destroy()}}Lc.defaultOptions={enabled:!1,gradations:5},c.Z.registerType(Lc,"BlackAndWhiteStage");const Dc=Lc;class Ic extends c.Z{constructor(e){super(e),this._earth=e;let t=this._earth.czm.scene;this.autoUpdateDisposer=(0,P.autorun)((()=>{var e=t.postProcessStages;this.enabled?(this._stage||(this._stage=Cesium.PostProcessStageLibrary.createBrightnessStage(),e.add(this._stage)),this._stage.enabled=!0,this._stage.uniforms.brightness=this.brightness):this._stage&&(e.remove(this._stage),this._stage=void 0)}))}destroy(){return this.autoUpdateDisposer&&(this.autoUpdateDisposer(),this.autoUpdateDisposer=void 0),super.destroy()}}Ic.defaultOptions={enabled:!1,brightness:.5},c.Z.registerType(Ic,"BrightnessStage");const Rc=Ic;class Hc extends c.Z{constructor(e){super(e),this._earth=e;let t=this._earth.czm.scene;this.autoUpdateDisposer=(0,P.autorun)((()=>{var e=t.postProcessStages;if(this.enabled){this._stage||(this._stage=Cesium.PostProcessStageLibrary.createDepthOfFieldStage(),e.add(this._stage)),this._stage.enabled=!0;var i=this._stage.uniforms;i.focalDistance=this.focalDistance,i.delta=this.delta,i.sigma=this.sigma,i.stepSize=this.stepSize}else this._stage&&(e.remove(this._stage),this._stage=void 0)}))}destroy(){return this.autoUpdateDisposer&&(this.autoUpdateDisposer(),this.autoUpdateDisposer=void 0),super.destroy()}}Hc.defaultOptions={enabled:!1,focalDistance:87,delta:1,sigma:3.78,stepSize:2.46},c.Z.registerType(Hc,"DepthOfFieldStage");const Fc=Hc;class Nc extends c.Z{constructor(e){super(e),this._earth=e;let t=this._earth.czm.scene;this.autoUpdateDisposer=(0,P.autorun)((()=>{var e=t.postProcessStages;if(this.enabled){this._stage||(this._stage=new Cesium.PostProcessStage({fragmentShader:"uniform sampler2D colorTexture; \nvarying vec2 v_textureCoordinates; \nconst int KERNEL_WIDTH=16; \nvoid main(void) \n{ \n    vec2 step = 1.0 / czm_viewport.zw; \n    vec2 integralPos = v_textureCoordinates - mod(v_textureCoordinates, 8.0 * step); \n    vec3 averageValue = vec3(0.0); \n    for (int i = 0; i < KERNEL_WIDTH; i++) \n    { \n        for (int j = 0; j < KERNEL_WIDTH; j++) \n        { \n            averageValue += texture2D(colorTexture, integralPos + step * vec2(i, j)).rgb; \n        } \n    } \n    averageValue /= float(KERNEL_WIDTH * KERNEL_WIDTH); \n    gl_FragColor = vec4(averageValue, 1.0); \n} \n"}),e.add(this._stage));this._stage.uniforms}else this._stage&&(e.remove(this._stage),this._stage=void 0)}))}destroy(){return this.autoUpdateDisposer&&(this.autoUpdateDisposer(),this.autoUpdateDisposer=void 0),super.destroy()}}Nc.defaultOptions={enabled:!1},c.Z.registerType(Nc,"MosaicStage");const Qc=Nc;class kc extends c.Z{constructor(e){super(e),this._earth=e;let t=this._earth.czm.scene;this.autoUpdateDisposer=(0,P.autorun)((()=>{var e=t.postProcessStages;this.enabled?(this._stage||(this._stage=Cesium.PostProcessStageLibrary.createNightVisionStage(),e.add(this._stage)),this._stage.enabled=!0):this._stage&&(e.remove(this._stage),this._stage=void 0)}))}destroy(){return this.autoUpdateDisposer&&(this.autoUpdateDisposer(),this.autoUpdateDisposer=void 0),super.destroy()}}kc.defaultOptions={enabled:!1},c.Z.registerType(kc,"NightVisionStage");const Uc=kc;class jc extends c.Z{constructor(e){super(e),this._earth=e;let t=this._earth.czm.scene;this.autoUpdateDisposer=(0,P.autorun)((()=>{var e=t.postProcessStages;if(this.enabled){this._stage||(this._stage=Cesium.PostProcessStageLibrary.createSilhouetteStage(),e.add(this._stage)),this._stage.enabled=!0;var i=this._stage.uniforms;i.color.red=this.color[0],i.color.green=this.color[1],i.color.blue=this.color[2],i.color.alpha=this.color[3],i.length=this.length}else this._stage&&(e.remove(this._stage),this._stage=void 0)}))}destroy(){return this.autoUpdateDisposer&&(this.autoUpdateDisposer(),this.autoUpdateDisposer=void 0),super.destroy()}}jc.defaultOptions={enabled:!1,color:[0,1,0,1],length:.5},c.Z.registerType(jc,"XbsSilhouetteStage");const Gc=jc;class zc extends c.Z{constructor(e){super(e),this._earth=e;let t=this._earth.czm.scene;this.autoUpdateDisposer=(0,P.autorun)((()=>{var e=t.postProcessStages;if(this.enabled){this._stage||(this._stage=Cesium.PostProcessStageLibrary.createLensFlareStage(),e.add(this._stage)),this._stage.enabled=!0;var i=this._stage.uniforms;i.intensity=this.intensity,i.distortion=this.distortion,i.ghostDispersal=this.dispersion,i.haloWidth=this.haloWidth,i.earthRadius=this.earthRadius}else this._stage&&(e.remove(this._stage),this._stage=void 0)}))}destroy(){return this.autoUpdateDisposer&&(this.autoUpdateDisposer(),this.autoUpdateDisposer=void 0),super.destroy()}}zc.defaultOptions={enabled:!1,intensity:2,distortion:10,dispersion:.4,haloWidth:.4,earthRadius:6378137},c.Z.registerType(zc,"LensFlareStage");const Yc=zc;class Zc extends c.Z{constructor(e){super(e),this._earth=e,this._scene=e.czm.scene,this._globe=this._scene.globe,this.ambientOcclusion=new Ec(e),this.bloom=new Oc(e),this.blackAndWhite=new Dc(e),this.brightness=new Rc(e),this.depthOfField=new Fc(e),this.lensFlare=new Yc(e),this.nightVision=new Uc(e),this.silhouette=new Gc(e),this.mosaic=new Qc(e),this.disposers.push((()=>{this.ambientOcclusion=this.ambientOcclusion&&this.ambientOcclusion.destroy(),this.bloom=this.bloom&&this.bloom.destroy(),this.blackAndWhite=this.blackAndWhite&&this.blackAndWhite.destroy(),this.brightness=this.brightness&&this.brightness.destroy(),this.depthOfField=this.depthOfField&&this.depthOfField.destroy(),this.lensFlare=this.lensFlare&&this.lensFlare.destroy(),this.nightVision=this.nightVision&&this.nightVision.destroy(),this.silhouette=this.silhouette&&this.silhouette.destroy(),this.mosaic=this.mosaic&&this.mosaic.destroy()})),this.disposers.push(h.Z.registerProperty(this,"ambientOcclusion")),this.disposers.push(h.Z.registerProperty(this,"bloom")),this.disposers.push(h.Z.registerProperty(this,"blackAndWhite")),this.disposers.push(h.Z.registerProperty(this,"brightness")),this.disposers.push(h.Z.registerProperty(this,"depthOfField")),this.disposers.push(h.Z.registerProperty(this,"lensFlare")),this.disposers.push(h.Z.registerProperty(this,"nightVision")),this.disposers.push(h.Z.registerProperty(this,"silhouette")),this.disposers.push(h.Z.registerProperty(this,"mosaic"))}destroy(){return super.destroy()}}Zc.defaultOptions={ambientOcclusion:null,bloom:null,blackAndWhite:null,brightness:null,depthOfField:null,lensFlare:null,mosaic:null,nightVision:null,silhouette:null},c.Z.registerType(Zc,"PostProcess");const Wc=Zc;class Xc extends h.Z{constructor(e){super(),this._earth=e;const t=this._earth.czm.scene;this._rain=void 0,this.disposers.push((()=>{this._rain&&(t.postProcessStages.remove(this._rain),this._rain=void 0)}));const i=()=>{this.enabled?this._rain||(this._rain=new Cesium.PostProcessStage({name:"czm_rain",fragmentShader:"\nuniform sampler2D colorTexture;//输入的场景渲染照片\nvarying vec2 v_textureCoordinates;\n\nfloat hash(float x){\n    return fract(sin(x*133.3)*13.13);\n}\n\nvoid main(void){\n\n    float time = czm_frameNumber / 60.0;\n    vec2 resolution = czm_viewport.zw;\n\n    vec2 uv=(gl_FragCoord.xy*2.-resolution.xy)/min(resolution.x,resolution.y);\n    vec3 c=vec3(.6,.7,.8);\n\n    float a=-.4;\n    float si=sin(a),co=cos(a);\n    uv*=mat2(co,-si,si,co);\n    uv*=length(uv+vec2(0,4.9))*.3+1.;\n\n    float v=1.-sin(hash(floor(uv.x*100.))*2.);\n    float b=clamp(abs(sin(20.*time*v+uv.y*(5./(2.+v))))-.95,0.,1.)*20.;\n    c*=v*b; //屏幕上雨的颜色\n\n    gl_FragColor = mix(texture2D(colorTexture, v_textureCoordinates), vec4(c,1), 0.5); //将雨和三维场景融合\n}\n"}),t.postProcessStages.add(this._rain)):this._rain&&(t.postProcessStages.remove(this._rain),this._rain=void 0)};i(),this.disposers.push((0,P.reaction)((()=>({enabled:this.enabled})),i))}}Xc.defaultOptions={enabled:!1};const Jc=Xc;class Kc extends h.Z{constructor(e){super(),this._earth=e,this._createSnow(),this._createSnowCover()}_createSnow(){const e=this._earth.czm.scene;this._snow=void 0,this.disposers.push((()=>{this._snow&&(e.postProcessStages.remove(this._snow),this._snow=void 0)}));const t=()=>{this.enabled?this._snow||(this._snow=new Cesium.PostProcessStage({name:"czm_snow",fragmentShader:"\n        uniform sampler2D colorTexture; //输入的场景渲染照片\n        varying vec2 v_textureCoordinates;\n        \n        float snow(vec2 uv,float scale)\n        {\n            float time = czm_frameNumber / 60.0;\n            float w=smoothstep(1.,0.,-uv.y*(scale/10.));if(w<.1)return 0.;\n            uv+=time/scale;uv.y+=time*2./scale;uv.x+=sin(uv.y+time*.5)/scale;\n            uv*=scale;vec2 s=floor(uv),f=fract(uv),p;float k=3.,d;\n            p=.5+.35*sin(11.*fract(sin((s+p+scale)*mat2(7,3,6,5))*5.))-f;d=length(p);k=min(d,k);\n            k=smoothstep(0.,k,sin(f.x+f.y)*0.01);\n            return k*w;\n        }\n        \n        void main(void){\n            vec2 resolution = czm_viewport.zw;\n            vec2 uv=(gl_FragCoord.xy*2.-resolution.xy)/min(resolution.x,resolution.y);\n            vec3 finalColor=vec3(0);\n            //float c=smoothstep(1.,0.3,clamp(uv.y*.3+.8,0.,.75));\n            float c = 0.0;\n            c+=snow(uv,30.)*.0;\n            c+=snow(uv,20.)*.0;\n            c+=snow(uv,15.)*.0;\n            c+=snow(uv,10.);\n            c+=snow(uv,8.);\n            c+=snow(uv,6.);\n            c+=snow(uv,5.);\n            finalColor=(vec3(c)); //屏幕上雪的颜色\n            gl_FragColor = mix(texture2D(colorTexture, v_textureCoordinates), vec4(finalColor,1), 0.5);  //将雪和三维场景融合\n        }\n        "}),e.postProcessStages.add(this._snow)):this._snow&&(e.postProcessStages.remove(this._snow),this._snow=void 0)};t(),this.disposers.push((0,P.reaction)((()=>({enabled:this.enabled})),t))}_createSnowCover(){const e=this._earth.czm.scene;this._snowCover=void 0,this.disposers.push((()=>{this._snowCover&&(e.postProcessStages.remove(this._snowCover),this._snowCover=void 0)}));const t=()=>{if(this.alpha<=0)this._snowCover&&(e.postProcessStages.remove(this._snowCover),this._snowCover=void 0);else{this._snowCover||(this._snowCover=new Cesium.PostProcessStage({name:"czm_snowCover",fragmentShader:"\n            #extension GL_OES_standard_derivatives : enable\n            uniform sampler2D colorTexture;\n            uniform sampler2D depthTexture;\n            uniform float alpha;\n            varying vec2 v_textureCoordinates;\n            vec4 toEye(in vec2 uv, in float depth) {\n                vec2 xy = vec2((uv.x * 2.0 - 1.0), (uv.y * 2.0 - 1.0));\n                vec4 posInCamera = czm_inverseProjection * vec4(xy, depth, 1.0);\n                posInCamera = posInCamera / posInCamera.w;\n                return posInCamera;\n            }\n            float getDepth(in vec4 depth) {\n                float z_window = czm_unpackDepth(depth);\n                z_window = czm_reverseLogDepth(z_window);\n                float n_range = czm_depthRange.near;\n                float f_range = czm_depthRange.far;\n                return (2.0 * z_window - n_range - f_range) / (f_range - n_range);\n            }\n            void main() {\n                vec4 color = texture2D(colorTexture, v_textureCoordinates);\n                vec4 currD = texture2D(depthTexture, v_textureCoordinates);\n                if(currD.r >= 1.0) {\n                    gl_FragColor = color;\n                    return;\n                }\n                float depth = getDepth(currD);\n                vec4 positionEC = toEye(v_textureCoordinates, depth);\n                vec3 dx = dFdx(positionEC.xyz);\n                vec3 dy = dFdy(positionEC.xyz);\n                vec3 nor = normalize(cross(dx, dy));\n                vec4 positionWC = normalize(czm_inverseView * positionEC);\n                vec3 normalWC = normalize(czm_inverseViewRotation * nor);\n                float dotNumWC = dot(positionWC.xyz, normalWC);\n                if(dotNumWC <= 0.3) {\n                    gl_FragColor = mix(color, vec4(1.0), alpha*0.3);\n                    return;\n                }\n                gl_FragColor = mix(color, vec4(1.0), dotNumWC*alpha);\n            }\n        ",uniforms:{alpha:.5}}),e.postProcessStages.add(this._snowCover));const t=Cesium.Math.clamp(this.alpha,0,1);this._snowCover.uniforms.alpha=t}};t(),this.disposers.push((0,P.reaction)((()=>({alpha:this.alpha})),t))}}Kc.defaultOptions={enabled:!1,alpha:0};const Vc=Kc;class qc extends h.Z{constructor(e){super(),this._earth=e;const t=this._earth.czm.scene;this._fog=void 0,this.disposers.push((()=>{this._fog&&(t.postProcessStages.remove(this._fog),this._fog=void 0)}));const i=()=>{if(this.enabled){this._fog||(this._fog=new Cesium.PostProcessStage({name:"czm_gvol_fog",fragmentShader:"\nuniform sampler2D colorTexture;\nuniform sampler2D depthTexture;\nuniform float strength;\nuniform vec4 fogcolor;\nvarying vec2 v_textureCoordinates;\nvoid main(void) {\n    vec4 origcolor = texture2D(colorTexture, v_textureCoordinates);\n    float depth = czm_readDepth(depthTexture, v_textureCoordinates);\n    vec4 depthcolor = texture2D(depthTexture, v_textureCoordinates);\n    float f = strength*(depthcolor.r-0.3)/0.2;\n    if(f<0.0) f = 0.0;\n    else if(f>1.0) f = 1.0;\n    gl_FragColor = mix(origcolor, fogcolor, f);\n}\n",uniforms:{strength:this.strength,fogcolor:new Cesium.Cartesian4(...this.color)}}),t.postProcessStages.add(this._fog));const e=Cesium.Math.clamp(this.strength,0,1);this._fog.uniforms.strength=e,this._fog.uniforms.fogcolor=new Cesium.Cartesian4(...this.color)}else this._fog&&(t.postProcessStages.remove(this._fog),this._fog=void 0)};i(),this.disposers.push((0,P.reaction)((()=>({enabled:this.enabled,strength:this.strength,color:[...this.color]})),i))}}qc.defaultOptions={enabled:!1,strength:.5,color:[1,1,1,1]};const $c=qc;class eu extends h.Z{constructor(e){super(),this._earth=e,this._scene=e.czm.scene,this._globe=this._scene.globe,this.atmosphere=new Rh(e),this.sun=new Yh(e),this.skyBox=new Sc(e),this.snow=new Gh(e),this.rain=new Uh(e),this.moon=new Qh(e),this.fog=new Fh(e),this.cloud=new Bc(e),this.rainPostProcess=new Jc(e),this.snowPostProcess=new Vc(e),this.fogPostProcess=new $c(e),this._disposers=[],this._disposers.push(h.Z.registerProperty(this,"atmosphere")),this._disposers.push(h.Z.registerProperty(this,"sun")),this._disposers.push(h.Z.registerProperty(this,"skyBox")),this._disposers.push(h.Z.registerProperty(this,"snow")),this._disposers.push(h.Z.registerProperty(this,"rain")),this._disposers.push(h.Z.registerProperty(this,"moon")),this._disposers.push(h.Z.registerProperty(this,"fog")),this._disposers.push(h.Z.registerProperty(this,"cloud")),this._disposers.push(h.Z.registerProperty(this,"rainPostProcess")),this._disposers.push(h.Z.registerProperty(this,"snowPostProcess")),this._disposers.push(h.Z.registerProperty(this,"fogPostProcess"))}get sunPosition(){var e=this._earth.czm.viewer,t=Cesium.Transforms.computeTemeToPseudoFixedMatrix(e.clock.currentTime),i=Cesium.Simon1994PlanetaryPositions.computeSunPositionInEarthInertialFrame(e.clock.currentTime);return Cesium.Matrix3.multiplyByVector(t,i,i),i}get moonPosition(){var e=this._earth.czm.viewer,t=Cesium.Transforms.computeTemeToPseudoFixedMatrix(e.clock.currentTime),i=Cesium.Simon1994PlanetaryPositions.computeMoonPositionInEarthInertialFrame(e.clock.currentTime);return Cesium.Matrix3.multiplyByVector(t,i,i),i}destroy(){return this._disposers.forEach((e=>e())),this._disposers.length=0,super.destroy()}}eu.defaultOptions={fog:{},sun:{},skyBox:{},moon:{},rain:{},snow:{},cloud:{},atmosphere:{},rainPostProcess:{},snowPostProcess:{},fogPostProcess:{}};const tu=eu;class iu extends h.Z{constructor(e){super(),this._earth=e;const t=e.czm.scene.light,i=new Cesium.DirectionalLight({direction:new Cesium.Cartesian3(1,0,0)}),r=()=>{e.czm.scene.light=this.enabled?i:t};r(),this.disposers.push((0,P.reaction)((()=>this.enabled),r)),this._scratchCartesian=new Cesium.Cartesian3;const n=()=>{const e=i.direction;Cesium.Cartesian3.fromRadians(...this.position,void 0,e),Cesium.Cartesian3.negate(e,e),Cesium.Cartesian3.normalize(e,e)};n(),this.disposers.push((0,P.reaction)((()=>[...this.position]),n));const o=e.czm.scene.camera,s=()=>{if(this.useCameraPos){const e=i.direction;Cesium.Cartesian3.equals(o.direction,e)||Cesium.Cartesian3.clone(o.direction,e)}};s(),this.disposers.push(e.czm.scene.preUpdate.addEventListener(s))}}iu.defaultOptions={enabled:!1,position:[116.39/180*Math.PI,39.9/180*Math.PI,1e7],useCameraPos:!1};const ru=iu;class nu extends c.Z{constructor(e){super(e),this.autoUpdateDisposer=(0,P.autorun)((()=>{var e=this._earth.czm.scene.shadowMap;e.enable=this.enabled,e.softShadows=this.softShadows,e.size=this.size,e.darkness=this.darkness,e.maximumDistance=this.maximumDistance,e.normalOffset=this.normalOffset,this._earth.czm.viewer.shadows=this.enabled,this._earth.czm.viewer.terrainShadows=this.enabled&&this.terrainShadow?Cesium.ShadowMode.ENABLED:Cesium.ShadowMode.DISABLED}))}destroy(){return this.autoUpdateDisposer&&(this.autoUpdateDisposer(),this.autoUpdateDisposer=void 0),super.destroy()}}nu.defaultOptions={enabled:!1,terrainShadow:!0,softShadows:!1,size:2048,darkness:.3,maximumDistance:5e3,normalOffset:!0},c.Z.registerType(nu,"Shadow");const ou=nu;class su extends c.Z{constructor(e){super(e),this._earth=e,this.shadow=new ou(e),this.disposers.push((()=>this.shadow=this.shadow&&this.shadow.destroy())),h.Z.registerProperty(this,"shadow"),this.forceSunPos=new ru(e),this.disposers.push((()=>this.forceSunPos=this.forceSunPos&&this.forceSunPos.destroy())),h.Z.registerProperty(this,"forceSunPos")}destroy(){return super.destroy()}}su.defaultOptions={shadow:null,forceSunPos:null},c.Z.registerType(su,"Effect");const au=su;class lu extends h.Z{constructor(e){super(e),(0,P.extendObservable)(this,{_drawingBufferWidth:0,_drawingBufferHeight:0,_resolutionScale:0,_widgetWidth:0,_widgetHeight:0,get drawingBufferWidth(){return _drawingBufferWidth},get drawingBufferHeight(){return _drawingBufferHeight},get resolutionScale(){return _resolutionScale},get widgetWidth(){return _widgetWidth},get widgetHeight(){return _widgetHeight}},{drawingBufferWidth:P.computed,drawingBufferHeight:P.computed,resolutionScale:P.computed,widgetWidth:P.computed,widgetHeight:P.computed}),this._disposer=e.czm.viewer.clock.onTick.addEventListener((()=>{this._drawingBufferWidth=e.czm.scene.context.drawingBufferWidth,this._drawingBufferHeight=e.czm.scene.context.drawingBufferHeight,this._resolutionScale=e.czm.viewer.resolutionScale,this._widgetWidth=e.czm.viewer.cesiumWidget._canvasWidth,this._widgetHeight=e.czm.viewer.cesiumWidget._canvasHeight}))}destory(){this._disposer=this._disposer&&this._disposer()}}const hu=lu;const cu=class{constructor(e){this._earth=e,this._screenSpaceEventHandler=new Cesium.ScreenSpaceEventHandler(this._earth.czm.scene.canvas),this._actionsMap={}}get(e,t=""){if(void 0===e||void 0===Cesium.ScreenSpaceEventType[e]||t&&void 0===Cesium.KeyboardEventModifier[t])throw new Error("鼠标事件出错！");const i=e+t;if(void 0===this._actionsMap[i]){let r;const n=new rxjs.Observable((e=>{r=e})).pipe(rxjs.operators.share()),o=e=>{r&&r.next(e)};this._screenSpaceEventHandler.setInputAction(o,Cesium.ScreenSpaceEventType[e],t?Cesium.KeyboardEventModifier[t]:void 0),this._actionsMap[i]=n}return this._actionsMap[i]}_pickPosition(e,t){return this._earth.pickPosition(e,t)}get mouseMove(){return this.mouseMove$=this.mouseMove$||this.get("MOUSE_MOVE").pipe(rxjs.operators.observeOn(rxjs.animationFrameScheduler),rxjs.operators.throttleTime(20),rxjs.operators.share()),this.mouseMove$}get ctrlMouseMove(){return this.ctrlMouseMove$=this.ctrlMouseMove$||this.get("MOUSE_MOVE","CTRL").pipe(rxjs.operators.observeOn(rxjs.animationFrameScheduler),rxjs.operators.throttleTime(20),rxjs.operators.share()),this.ctrlMouseMove$}get shiftMouseMove(){return this.shiftMouseMove$=this.shiftMouseMove$||this.get("MOUSE_MOVE","SHIFT").pipe(rxjs.operators.observeOn(rxjs.animationFrameScheduler),rxjs.operators.throttleTime(20),rxjs.operators.share()),this.shiftMouseMove$}get leftClick(){return this.leftClick$=this.leftClick$||this.get("LEFT_CLICK"),this.leftClick$}get ctrlLeftClick(){return this.ctrlLeftClick$=this.ctrlLeftClick$||this.get("LEFT_CLICK","CTRL"),this.ctrlLeftClick$}get shiftLeftClick(){return this.shiftLeftClick$=this.shiftLeftClick$||this.get("LEFT_CLICK","SHIFT"),this.shiftLeftClick$}get rightClick(){return this.rightClick$=this.rightClick$||this.get("RIGHT_CLICK"),this.rightClick$}get ctrlRightClick(){return this.ctrlRightClick$=this.ctrlRightClick$||this.get("RIGHT_CLICK","CTRL"),this.ctrlRightClick$}get shiftRightClick(){return this.shiftRightClick$=this.shiftRightClick$||this.get("RIGHT_CLICK","SHIFT"),this.shiftRightClick$}get mouseMovePickedPosition(){this.scratchMouseMovePickedPosition=this.scratchMouseMovePickedPosition||[0,0,0];const e=this.scratchMouseMovePickedPosition;return this.mouseMovePickedPosition$=this.mouseMovePickedPosition$||this.get("MOUSE_MOVE").pipe(rxjs.operators.observeOn(rxjs.animationFrameScheduler),rxjs.operators.throttleTime(100),rxjs.operators.map((t=>({position:this._pickPosition(t.endPosition,e),movement:t}))),rxjs.operators.share()),this.mouseMovePickedPosition$}get leftClickPickedPosition(){this.scratchleftClickPickedPosition=this.scratchleftClickPickedPosition||[0,0,0];const e=this.scratchleftClickPickedPosition;return this.leftClickPickedPosition$=this.leftClickPickedPosition$||this.get("LEFT_CLICK").pipe(rxjs.operators.map((t=>({position:this._pickPosition(t.position,e),movement:t}))),rxjs.operators.share()),this.leftClickPickedPosition$}destroy(){this._screenSpaceEventHandler=this._screenSpaceEventHandler&&this._screenSpaceEventHandler.destroy()}};var uu=i(9292),pu=i(5583);function du(){throw new Error("throwOnDestroyed")}var mu=i(5108),fu=function(){function e(){}return Object.defineProperty(e.prototype,"disposers",{get:function(){return this._disposers||(this._disposers=[]),this._disposers},enumerable:!1,configurable:!0}),e.prototype.dispose=function(e){this.disposers.push(e)},e.prototype.isDestroyed=function(){return!1},e.prototype.destroy=function(){if(this._disposers)try{for(var e=this._disposers,t=e.length-1;t>=0;--t)e[t]();e.length=0,this._disposers=void 0}catch(e){mu.error("destroy get error! ".concat(e))}return function(e){for(var t in e)"function"==typeof e[t]&&(e[t]=du);e.isDestroyed=!0}(this)},e}(),gu=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}();const Au=function(e){function t(t){var i=e.call(this)||this;i._earth=t,i._originDrawingBufferWidth=0,i._originDrawingBufferHeight=0,i._originResolutionScale=0,i._originWidgetWidth=0,i._originWidgetHeight=0;var r=void 0,n=new uu.y((function(e){r=e}));i._source=n.pipe((0,pu.B)());var o=i._earth.czm.scene,s=i._earth.czm.viewer;return i.dispose(o.preUpdate.addEventListener((function(){var e=i._originDrawingBufferWidth!==o.context.drawingBufferWidth,t=i._originDrawingBufferHeight!==o.context.drawingBufferHeight,n=i._originResolutionScale!==o.context.resolutionScale;i._originWidgetWidth,s.cesiumWidget._canvasWidth,i._originWidgetHeight,s.cesiumWidget._canvasHeight;(e||t||n)&&r&&r.next({drawingBufferWidth:i._originDrawingBufferWidth,drawingBufferHeight:i._originDrawingBufferHeight,resolutionScale:i._originResolutionScale,widgetWidth:i._originWidgetWidth,widgetHeight:i._originWidgetHeight})}))),i}return gu(t,e),Object.defineProperty(t.prototype,"source",{get:function(){return this._source},enumerable:!1,configurable:!0}),t}(fu);const yu=class{constructor(e){let t;this._earth=e,this._mouseEventSource=new cu(e),this._contextSizeChanged=new Au(e),this._disposers=this._disposers||[];const i=new uu.y((e=>{t=e})),r=e.czm.scene;this._disposers.push(r.camera.changed.addEventListener((()=>{t&&t.next()}))),this._cameraChanged=i.pipe((0,pu.B)())}get mouse(){return this._mouseEventSource}get contextSizeChanged(){return this._contextSizeChanged.source}get cameraChanged(){return this._cameraChanged}destory(){this._disposers.forEach((e=>e())),this._disposers.length=0}};let vu,Cu;const _u=function(e,t,i){vu=vu||new Cesium.Cartesian3,Cu=Cu||new Cesium.Cartographic;const r=Cesium.xbsjPickPosition(e,t,vu);if(!r)return;const n=Cesium.Cartographic.fromCartesian(r,void 0,Cu);return i||(i=[0,0,0]),i[0]=n.longitude,i[1]=n.latitude,i[2]=n.height,i};let bu;const wu=function(e,t,i){bu=bu||new Cesium.Cartesian3;const r=Cesium.Cartesian3.fromRadians(t[0],t[1],t[2],void 0,bu);return Cesium.xbsjGetScreenScale(e,r,i)};const Pu=function(e){(0,P.extendObservable)(e,{_fps:0,_elapsedTime:0,get fps(){return e._fps},get elapsedTime(){return e._elapsedTime}},{fps:P.computed,elapsedTime:P.computed});const t=Cesium.getTimestamp;e._lastFpsSampleTime=t(),e._lastMsSampleTime=t(),e._fpsFrameCount=0,e._msFrameCount=0;const i=e._earth.czm.scene;e.disposers.push(i.preUpdate.addEventListener((()=>{var i=t();e._fpsFrameCount++;var r=i-e._lastFpsSampleTime;r>1e3&&(e._fps=1e3*e._fpsFrameCount/r|0,e._lastFpsSampleTime=i,e._fpsFrameCount=0),e._msFrameCount++;var n=i-e._lastMsSampleTime;n>200&&(e._elapsedTime=n/e._msFrameCount,e._lastMsSampleTime=i,e._msFrameCount=0)})))};class Su extends h.Z{constructor(e){super(),this._earth=e,Pu(this)}}const xu=Su;const Bu=function(e,t,i="_"+t){Object.defineProperty(e,t,{get:()=>e[i]})};class Mu extends h.Z{constructor(e,t){var i;super(e,t),this._earth=e,this._clock=e.czm.viewer.clock,this.update=(i=this,e=>{!function(e,t){e.currentTime=t}(i,e.currentTime)}),this._clock.onTick.addEventListener(this.update,this),this._timezoom=(new Date).getTimezoneOffset()/60,this.currentTime=Cesium.JulianDate.fromDate(new Date,this.currentTime),this.startTime=Cesium.JulianDate.addHours(this.currentTime,-12,new Cesium.JulianDate),this.stopTime=Cesium.JulianDate.addHours(this.currentTime,12,new Cesium.JulianDate),this.disposers.push(Js.watch((()=>({start1:this.startTime.secondsOfDay,start2:this.startTime.julianDayNumber,stop1:this.stopTime.secondsOfDay,stop2:this.stopTime.julianDayNumber})),(()=>{this._clock.startTime=this.startTime,this._clock.stopTime=this.stopTime}))),this.disposers.push(Js.watch((()=>({current1:this.currentTime.secondsOfDay,current2:this.currentTime.julianDayNumber})),(()=>{this._clock.currentTime=this.currentTime,this._currentTimestamp=Cesium.JulianDate.toDate(this.currentTime).getTime()}))),this.disposers.push(Js.watch((()=>({shouldAnimate:this.shouldAnimate,multiplier:this.multiplier})),(()=>{this._clock.shouldAnimate=this.shouldAnimate,this._clock.multiplier=this.multiplier,this.shouldAnimate&&1==this.multiplier||(this.clockStep="SYSTEM_CLOCK_MULTIPLIER")}))),this.disposers.push(Js.watch((()=>({clockRange:this.clockRange,clockStep:this.clockStep})),(()=>{this._clock.clockRange=Cesium.ClockRange[this.clockRange],this._clock.clockStep=Cesium.ClockStep[this.clockStep]})))}zoomTo(e,t){this.startTime=e,this.stopTime=t}}Mu.defaultOptions={startTime:{dayNumber:0,secondsOfDay:0},stopTime:{dayNumber:0,secondsOfDay:0},currentTime:{dayNumber:0,secondsOfDay:0},showType:"local",shouldAnimate:!0,multiplier:1,clockRange:"UNBOUNDED",clockStep:"SYSTEM_CLOCK"};const Eu=Mu;let Tu=Cesium.Cartesian2,Ou=Cesium.Cartesian3,Lu=Cesium.Cartesian4,Du=Cesium.Cartographic,Iu=Cesium.defaultValue,Ru=Cesium.defined,Hu=Cesium.destroyObject,Fu=Cesium.DeveloperError,Nu=Cesium.Ellipsoid,Qu=Cesium.HeadingPitchRoll,ku=Cesium.IntersectionTests,Uu=Cesium.KeyboardEventModifier,ju=Cesium.Math,Gu=Cesium.Matrix3,zu=Cesium.Matrix4,Yu=Cesium.OrthographicFrustum,Zu=Cesium.Plane,Wu=Cesium.Quaternion,Xu=Cesium.Ray,Ju=Cesium.TerrainExaggeration,Ku=Cesium.Transforms,Vu=Cesium.CameraEventAggregator,qu=Cesium.CameraEventType,$u=Cesium.MapMode2D,ep=Cesium.SceneMode,tp=Cesium.SceneTransforms,ip=Cesium.TweenCollection;function rp(e){if(!Ru(e))throw new Fu("scene is required.");this.enableAutoPitch=!1,this.autoPitchStartHeight=1e5,this.autoPitchMinAngle=30,this.autoPitchMaxAngle=90,this.ignoreSkySpin=!1,this.autoZoomOutCorrectionAngle=!0,this.limitPitchAngle=0,this.enableInputs=!0,this.enableTranslate=!0,this.enableZoom=!0,this.enableRotate=!0,this.enableTilt=!0,this.enableLook=!0,this.inertiaSpin=.9,this.inertiaTranslate=.9,this.inertiaZoom=.8,this.maximumMovementRatio=.1,this.bounceAnimationTime=3,this.minimumZoomDistance=1,this.maximumZoomDistance=Number.POSITIVE_INFINITY,this.translateEventTypes=qu.LEFT_DRAG,this.zoomEventTypes=[qu.RIGHT_DRAG,qu.WHEEL,qu.PINCH],this.rotateEventTypes=qu.LEFT_DRAG,this.tiltEventTypes=[qu.MIDDLE_DRAG,qu.PINCH,{eventType:qu.LEFT_DRAG,modifier:Uu.CTRL},{eventType:qu.RIGHT_DRAG,modifier:Uu.CTRL}],this.lookEventTypes={eventType:qu.LEFT_DRAG,modifier:Uu.SHIFT},this.minimumPickingTerrainHeight=15e4,this._minimumPickingTerrainHeight=this.minimumPickingTerrainHeight,this.minimumCollisionTerrainHeight=15e3,this._minimumCollisionTerrainHeight=this.minimumCollisionTerrainHeight,this.minimumTrackBallHeight=75e5,this._minimumTrackBallHeight=this.minimumTrackBallHeight,this.enableCollisionDetection=!0,this._scene=e,this._globe=void 0,this._ellipsoid=void 0,this._aggregator=new Vu(e.canvas),this._lastInertiaSpinMovement=void 0,this._lastInertiaZoomMovement=void 0,this._lastInertiaTranslateMovement=void 0,this._lastInertiaTiltMovement=void 0,this._inertiaDisablers={_lastInertiaZoomMovement:["_lastInertiaSpinMovement","_lastInertiaTranslateMovement","_lastInertiaTiltMovement"],_lastInertiaTiltMovement:["_lastInertiaSpinMovement","_lastInertiaTranslateMovement"]},this._tweens=new ip,this._tween=void 0,this._horizontalRotationAxis=void 0,this._tiltCenterMousePosition=new Tu(-1,-1),this._tiltCenter=new Ou,this._rotateMousePosition=new Tu(-1,-1),this._rotateStartPosition=new Ou,this._strafeStartPosition=new Ou,this._strafeMousePosition=new Tu,this._strafeEndMousePosition=new Tu,this._zoomMouseStart=new Tu(-1,-1),this._zoomWorldPosition=new Ou,this._useZoomWorldPosition=!1,this._tiltCVOffMap=!1,this._looking=!1,this._rotating=!1,this._strafing=!1,this._zoomingOnVector=!1,this._zoomingUnderground=!1,this._rotatingZoom=!1,this._adjustedHeightForTerrain=!1,this._cameraUnderground=!1;const t=e.mapProjection;this._maxCoord=t.project(new Du(Math.PI,ju.PI_OVER_TWO)),this._zoomFactor=5,this._rotateFactor=void 0,this._rotateRateRangeAdjustment=void 0,this._maximumRotateRate=1.77,this._minimumRotateRate=2e-4,this._minimumZoomRate=20,this._maximumZoomRate=5906376272e3,this._minimumUndergroundPickDistance=2e3,this._maximumUndergroundPickDistance=1e4}const np=.4;function op(e,t,i,r,n,o,s){let a=o[s];Ru(a)||(a=o[s]={startPosition:new Tu,endPosition:new Tu,motion:new Tu,inertiaEnabled:!0});const l=e.getButtonPressTime(t,i),h=e.getButtonReleaseTime(t,i),c=l&&h&&(h.getTime()-l.getTime())/1e3,u=new Date,p=h&&(u.getTime()-h.getTime())/1e3;if(l&&h&&c<np){const s=function(e,t){if(e<0)return 0;const i=25*(1-t);return Math.exp(-i*e)}(p,r),l=e.getLastMovement(t,i);if(!Ru(l)||(d=l,Tu.equalsEpsilon(d.startPosition,d.endPosition,ju.EPSILON14))||!a.inertiaEnabled)return;if(a.motion.x=.5*(l.endPosition.x-l.startPosition.x),a.motion.y=.5*(l.endPosition.y-l.startPosition.y),a.startPosition=Tu.clone(l.startPosition,a.startPosition),a.endPosition=Tu.multiplyByScalar(a.motion,s,a.endPosition),a.endPosition=Tu.add(a.startPosition,a.endPosition,a.endPosition),isNaN(a.endPosition.x)||isNaN(a.endPosition.y)||Tu.distance(a.startPosition,a.endPosition)<.5)return;if(!e.isButtonDown(t,i)){n(o,e.getStartMousePosition(t,i),a)}}var d}function sp(e,t){if(Ru(t)){let i=e[t];Ru(i)&&(i.inertiaEnabled=!0);const r=e._inertiaDisablers[t];if(Ru(r)){const t=r.length;for(let n=0;n<t;++n)i=e[r[n]],Ru(i)&&(i.inertiaEnabled=!1)}}}const ap=[];function lp(e,t,i,r,n,o){if(!Ru(i))return;const s=e._aggregator;Array.isArray(i)||(ap[0]=i,i=ap);const a=i.length;for(let l=0;l<a;++l){const a=i[l],h=Ru(a.eventType)?a.eventType:a,c=a.modifier,u=s.isMoving(h,c)&&s.getMovement(h,c),p=s.getStartMousePosition(h,c);e.enableInputs&&t&&(u?(r(e,p,u),sp(e,o)):n<1&&op(s,h,c,n,r,e,o))}}const hp=new Xu,cp=new Ou,up=new Tu,pp=new Ou,dp=new Tu,mp=new Ou,fp=new Ou,gp=new Ou,Ap=new Ou,yp=new Ou,vp=new Ou,Cp=new Ou,_p=new Ou,bp=new Ou,wp=new Ou,Pp=new Ou,Sp=new Ou,xp=new Ou,Bp=new Ou,Mp=new Ou,Ep=new Ou,Tp=new Ou,Op=new Ou,Lp={orientation:new Qu};function Dp(e,t,i,r,n,o){let s=Cesium.Math.toDegrees(e);if(t<=r){let e=s+20*(i/(t-i));return e=Math.max(-o,e),e=Math.min(-n,e),Cesium.Math.toRadians(e)}return e}function Ip(e,t){const i=2*Math.PI;for(;e>=t+Math.PI;)e-=i;for(;e<=t-Math.PI;)e+=i;return e}function Rp(e,t,i,r,n,o){let s=1;Ru(o)&&(s=ju.clamp(Math.abs(o),.25,1));const a=i.endPosition.y-i.startPosition.y,l=a>0?e.minimumZoomDistance*s:0,h=e.maximumZoomDistance;let c=r*(n-l);c=ju.clamp(c,e._minimumZoomRate,e._maximumZoomRate);let u=a/e._scene.canvas.clientHeight;u=Math.min(u,e.maximumMovementRatio);let p=c*u;if(e.enableCollisionDetection||0===e.minimumZoomDistance||!Ru(e._globe)){if(p>0&&Math.abs(n-l)<1)return;if(p<0&&Math.abs(n-h)<1)return;n-p<l?p=n-l-1:n-p>h&&(p=n-h)}const d=e._scene,m=d.camera,f=d.mode;if(e.autoZoomOutCorrectionAngle){const r=1e6;if(m.positionCartographic.height>r&&p<0){var g=e;const r=g._ellipsoid,n=g._scene,o=n.camera,s=.25*g.minimumZoomDistance,a=r.cartesianToCartographic(o.positionWC,fm).height;if(a-s-1<ju.EPSILON3&&i.endPosition.y-i.startPosition.y<0)return;const l=n.canvas,h=rm;h.x=l.clientWidth/2,h.y=l.clientHeight/2;const c=o.getPickRay(t,nm);let u;const p=ku.rayEllipsoid(c,r);if(Ru(p))u=Xu.getPoint(c,p.start,om);else{if(!(a>g._minimumTrackBallHeight))return;{const e=ku.grazingAltitudeLocation(c,r);if(!Ru(e))return;const t=r.cartesianToCartographic(e,pm);t.height=0,u=r.cartographicToCartesian(t,om)}}const d=Ku.eastNorthUpToFixedFrame(u,r,am),m=g._globe,f=g._ellipsoid;g._globe=void 0,g._ellipsoid=Nu.UNIT_SPHERE,g._rotateFactor=1,g._rotateRateRangeAdjustment=1;const _=zu.clone(o.transform,hm);o._setTransform(d);const b=1e-4,w=Cesium.Math.toRadians(-90),P=1e-4;var A=o.heading,y=o.pitch,v=o.roll;A=Ip(A,b),y=Ip(y,w),v=Ip(v,P);const S=.05;A+=(b-A)*S;var C=(w-y)*S;y+=C,v+=(P-v)*S;const x=o.constrainedAxis;o.constrainedAxis=Ou.UNIT_Z,o.rotateUp(C),o.constrainedAxis=x,o._setTransform(_),g._globe=m,g._ellipsoid=f;const B=f.maximumRadius;g._rotateFactor=1/B,g._rotateRateRangeAdjustment=B,o.setView({orientation:{heading:A,pitch:y,roll:v}})}}const _=Lp.orientation;if(_.heading=m.heading,_.pitch=m.pitch,_.roll=m.roll,m.frustum instanceof Yu)return void(Math.abs(p)>0&&(m.zoomIn(p),m._adjustOrthographicFrustum()));const b=Tu.equals(t,e._zoomMouseStart);let w,P=e._zoomingOnVector,S=e._rotatingZoom;if(b||(e._zoomMouseStart=Tu.clone(t,e._zoomMouseStart),Ru(e._globe)&&(f===ep.SCENE2D?(w=m.getPickRay(t,hp).origin,w=Ou.fromElements(w.y,w.z,w.x)):w=Wp(e,t,cp)),Ru(w)?(e._useZoomWorldPosition=!0,e._zoomWorldPosition=Ou.clone(w,e._zoomWorldPosition)):e._useZoomWorldPosition=!1,P=e._zoomingOnVector=!1,S=e._rotatingZoom=!1,e._zoomingUnderground=e._cameraUnderground),!e._useZoomWorldPosition)return void m.zoomIn(p);let x=f===ep.COLUMBUS_VIEW;if(m.positionCartographic.height<2e6&&(S=!0),!b||S){if(f===ep.SCENE2D){const i=e._zoomWorldPosition,r=m.position;if(!Ou.equals(i,r)&&m.positionCartographic.height<2*e._maxCoord.x){const n=m.position.x,o=Ou.subtract(i,r,pp);Ou.normalize(o,o);const s=Ou.distance(i,r)*p/(.5*m.getMagnitude());m.move(o,.5*s),(m.position.x<0&&n>0||m.position.x>0&&n<0)&&(w=m.getPickRay(t,hp).origin,w=Ou.fromElements(w.y,w.z,w.x),e._zoomWorldPosition=Ou.clone(w,e._zoomWorldPosition))}}else if(f===ep.SCENE3D){const t=Ou.normalize(m.position,yp);if(e._cameraUnderground||e._zoomingUnderground||m.positionCartographic.height<3e3&&Math.abs(Ou.dot(m.direction,t))<.6)x=!0;else{const i=d.canvas,r=dp;r.x=i.clientWidth/2,r.y=i.clientHeight/2;const n=Wp(e,r,mp);if(Ru(n)){if(m.positionCartographic.height<1e6){const i=Cp;Ou.clone(m.position,i);const r=e._zoomWorldPosition;let n=vp;if(n=Ou.normalize(r,n),Ou.dot(n,t)<0)return;const o=Mp,s=wp;Ou.clone(m.direction,s),Ou.add(i,Ou.multiplyByScalar(s,1e3,Ep),o);const a=Pp,l=Sp;Ou.subtract(r,i,a),Ou.normalize(a,l);const h=Ou.dot(t,l);if(h>=0)return void(e._zoomMouseStart.x=-1);const c=Math.acos(-h),u=Ou.magnitude(i),d=Ou.magnitude(r),f=u-p,g=Ou.magnitude(a),A=Math.asin(ju.clamp(g/d*Math.sin(c),-1,1))-Math.asin(ju.clamp(f/d*Math.sin(c),-1,1))+c,y=_p;Ou.normalize(i,y);let v=bp;v=Ou.cross(l,y,v),v=Ou.normalize(v,v),Ou.normalize(Ou.cross(y,v,Ep),s),Ou.multiplyByScalar(Ou.normalize(o,Ep),Ou.magnitude(o)-p,o),Ou.normalize(i,i),Ou.multiplyByScalar(i,f,i);const C=xp;Ou.multiplyByScalar(Ou.add(Ou.multiplyByScalar(y,Math.cos(A)-1,Tp),Ou.multiplyByScalar(s,Math.sin(A),Op),Ep),f,C),Ou.add(i,C,i),Ou.normalize(o,y),Ou.normalize(Ou.cross(y,v,Ep),s);const _=Bp;return Ou.multiplyByScalar(Ou.add(Ou.multiplyByScalar(y,Math.cos(A)-1,Tp),Ou.multiplyByScalar(s,Math.sin(A),Op),Ep),Ou.magnitude(o),_),Ou.add(o,_,o),Ou.clone(i,m.position),Ou.normalize(Ou.subtract(o,i,Ep),m.direction),Ou.clone(m.direction,m.direction),Ou.cross(m.direction,m.up,m.right),Ou.cross(m.right,m.direction,m.up),e.enableAutoPitch&&(Lp.orientation.pitch=Dp(Lp.orientation.pitch,m.positionCartographic.height,p,e.autoPitchStartHeight,e.autoPitchMinAngle,e.autoPitchMaxAngle)),void m.setView(Lp)}{const t=Ou.normalize(n,fp),i=Ou.normalize(e._zoomWorldPosition,gp),r=Ou.dot(i,t);if(r>0&&r<1){const e=ju.acosClamped(r),n=Ou.cross(i,t,Ap),o=p/(Math.abs(e)>ju.toRadians(20)?.75*m.positionCartographic.height:m.positionCartographic.height-p);m.rotate(n,e*o)}}}else x=!0}}e._rotatingZoom=!x}if(!b&&x||P){let i;const r=tp.wgs84ToWindowCoordinates(d,e._zoomWorldPosition,up);i=f!==ep.COLUMBUS_VIEW&&Tu.equals(t,e._zoomMouseStart)&&Ru(r)?m.getPickRay(r,hp):m.getPickRay(t,hp);const n=i.direction;f!==ep.COLUMBUS_VIEW&&f!==ep.SCENE2D||Ou.fromElements(n.y,n.z,n.x,n),m.move(n,p),e._zoomingOnVector=!0}else m.zoomIn(p);e._cameraUnderground||(e.enableAutoPitch&&(Lp.orientation.pitch=Dp(Lp.orientation.pitch,m.positionCartographic.height,p,e.autoPitchStartHeight,e.autoPitchMinAngle,e.autoPitchMaxAngle)),m.setView(Lp))}const Hp=new Xu,Fp=new Xu,Np=new Ou;function Qp(e,t,i){const r=e._scene.camera;let n=r.getPickRay(i.startPosition,Hp).origin,o=r.getPickRay(i.endPosition,Fp).origin;n=Ou.fromElements(n.y,n.z,n.x,n),o=Ou.fromElements(o.y,o.z,o.x,o);const s=Ou.subtract(n,o,Np),a=Ou.magnitude(s);a>0&&(Ou.normalize(s,s),r.move(s,a))}function kp(e,t,i){Ru(i.distance)&&(i=i.distance);const r=e._scene.camera;Rp(e,t,i,e._zoomFactor,r.getMagnitude())}const Up=new Tu,jp=new Tu;function Gp(e,t,i){if(Ru(i.angleAndHeight))return void function(e,t,i){let r=e._rotateFactor*e._rotateRateRangeAdjustment;r>e._maximumRotateRate&&(r=e._maximumRotateRate);r<e._minimumRotateRate&&(r=e._minimumRotateRate);const n=e._scene,o=n.camera,s=n.canvas;let a=(i.endPosition.x-i.startPosition.x)/s.clientWidth;a=Math.min(a,e.maximumMovementRatio);const l=r*a*Math.PI*4;o.twistRight(l)}(e,0,i.angleAndHeight);const r=e._scene,n=r.camera,o=r.canvas,s=o.clientWidth,a=o.clientHeight;let l=Up;l.x=2/s*i.startPosition.x-1,l.y=2/a*(a-i.startPosition.y)-1,l=Tu.normalize(l,l);let h=jp;h.x=2/s*i.endPosition.x-1,h.y=2/a*(a-i.endPosition.y)-1,h=Tu.normalize(h,h);let c=ju.acosClamped(l.x);l.y<0&&(c=ju.TWO_PI-c);let u=ju.acosClamped(h.x);h.y<0&&(u=ju.TWO_PI-u);const p=u-c;n.twistRight(p)}const zp=new Xu,Yp=new Ou,Zp=new Ou;function Wp(e,t,i){const r=e._scene,n=e._globe,o=r.camera;if(!Ru(n))return;const s=!e._cameraUnderground;let a;r.pickPositionSupported&&(a=r.pickPositionWorldCoordinates(t,Yp));const l=o.getPickRay(t,zp),h=n.pickWorldCoordinates(l,r,s,Zp);return(Ru(a)?Ou.distance(a,o.positionWC):Number.POSITIVE_INFINITY)<(Ru(h)?Ou.distance(h,o.positionWC):Number.POSITIVE_INFINITY)?Ou.clone(a,i):Ou.clone(h,i)}const Xp=new Du;function Jp(e){const t=e._ellipsoid,i=e._scene,r=i.camera;let n=0;if(i.mode===ep.SCENE3D){const e=t.cartesianToCartographic(r.position,Xp);Ru(e)&&(n=e.height)}else n=r.position.z;const o=Iu(e._scene.globeHeight,0);return Math.abs(o-n)}const Kp=new Ou;function Vp(e,t){const i=t.origin,r=t.direction,n=Jp(e),o=Ou.normalize(i,Kp);let s=Math.abs(Ou.dot(o,r));return s=2*Math.max(s,.5),n*s}function qp(e,t,i,r){let n=Ou.distance(t.origin,i);const o=Jp(e);return n>ju.clamp(5*o,e._minimumUndergroundPickDistance,e._maximumUndergroundPickDistance)&&(n=Math.min(n,o/5),n=Math.max(n,100)),Xu.getPoint(t,n,r)}function $p(e,t,i,r){let n;return Ru(i)?(n=Ou.distance(t.origin,i),n>e._maximumUndergroundPickDistance&&(n=Jp(e))):n=Jp(e),Xu.getPoint(t,n,r)}const ed=new Tu;function td(e,t){const i=t.endPosition,r=Tu.subtract(t.endPosition,t.startPosition,ed),n=e._strafeEndMousePosition;Tu.add(n,r,n),t.endPosition=n,Hd(e,t,e._strafeStartPosition),t.endPosition=i}const id=new Xu,rd=new Xu,nd=new Ou,od=new Ou,sd=new Ou,ad=new Ou,ld=new Zu(Ou.UNIT_X,0),hd=new Tu,cd=new Tu;function ud(e,t,i){if(Ou.equals(t,e._translateMousePosition)||(e._looking=!1),Ou.equals(t,e._strafeMousePosition)||(e._strafing=!1),e._looking)return void bm(e,t,i);if(e._strafing)return void td(e,i);const r=e._scene.camera,n=e._cameraUnderground,o=Tu.clone(i.startPosition,hd),s=Tu.clone(i.endPosition,cd);let a=r.getPickRay(o,id);const l=Ou.clone(Ou.ZERO,ad),h=Ou.UNIT_X;let c;if(r.position.z<e._minimumPickingTerrainHeight&&(c=Wp(e,o,nd),Ru(c)&&(l.x=c.x)),n||l.x>r.position.z&&Ru(c)){let r=c;return n&&(r=$p(e,a,c,nd)),Tu.clone(t,e._strafeMousePosition),Tu.clone(t,e._strafeEndMousePosition),Ou.clone(r,e._strafeStartPosition),e._strafing=!0,void Hd(e,i,e._strafeStartPosition)}const u=Zu.fromPointNormal(l,h,ld);a=r.getPickRay(o,id);const p=ku.rayPlane(a,u,nd),d=r.getPickRay(s,rd),m=ku.rayPlane(d,u,od);if(!Ru(p)||!Ru(m))return e._looking=!0,bm(e,t,i),void Tu.clone(t,e._translateMousePosition);const f=Ou.subtract(p,m,sd),g=f.x;f.x=f.y,f.y=f.z,f.z=g;const A=Ou.magnitude(f);A>ju.EPSILON6&&(Ou.normalize(f,f),r.move(f,A))}const pd=new Tu,dd=new Xu,md=new Ou,fd=new Ou,gd=new zu,Ad=new zu,yd=new Ou,vd=new Zu(Ou.UNIT_X,0),Cd=new Ou,_d=new Du,bd=new zu,wd=new Wu,Pd=new Gu,Sd=new Ou;function xd(e,t,i){if(Ru(i.angleAndHeight)&&(i=i.angleAndHeight),Tu.equals(t,e._tiltCenterMousePosition)||(e._tiltCVOffMap=!1,e._looking=!1),e._looking)return void bm(e,t,i);const r=e._scene.camera;e._tiltCVOffMap||!e.onMap()||Math.abs(r.position.z)>e._minimumPickingTerrainHeight?(e._tiltCVOffMap=!0,function(e,t,i){const r=e._scene,n=r.camera,o=r.canvas,s=pd;s.x=o.clientWidth/2,s.y=o.clientHeight/2;const a=n.getPickRay(s,dd),l=Ou.UNIT_X,h=a.origin,c=a.direction;let u;const p=Ou.dot(l,c);Math.abs(p)>ju.EPSILON6&&(u=-Ou.dot(l,h)/p);if(!Ru(u)||u<=0)return e._looking=!0,bm(e,t,i),void Tu.clone(t,e._tiltCenterMousePosition);const d=Ou.multiplyByScalar(c,u,md);Ou.add(h,d,d);const m=r.mapProjection,f=m.ellipsoid;Ou.fromElements(d.y,d.z,d.x,d);const g=m.unproject(d,_d);f.cartographicToCartesian(g,d);const A=Ku.eastNorthUpToFixedFrame(d,f,gd),y=e._globe,v=e._ellipsoid;e._globe=void 0,e._ellipsoid=Nu.UNIT_SPHERE,e._rotateFactor=1,e._rotateRateRangeAdjustment=1;const C=zu.clone(n.transform,bd);n._setTransform(A),zd(e,t,i,Ou.UNIT_Z),n._setTransform(C),e._globe=y,e._ellipsoid=v;const _=v.maximumRadius;e._rotateFactor=1/_,e._rotateRateRangeAdjustment=_}(e,t,i)):function(e,t,i){const r=e._scene,n=r.camera,o=e._cameraUnderground;let s,a;const l=Ou.UNIT_X;if(Tu.equals(t,e._tiltCenterMousePosition))s=Ou.clone(e._tiltCenter,md);else{if(n.position.z<e._minimumPickingTerrainHeight&&(s=Wp(e,t,md)),!Ru(s)){a=n.getPickRay(t,dd);const r=a.origin,o=a.direction;let h;const c=Ou.dot(l,o);if(Math.abs(c)>ju.EPSILON6&&(h=-Ou.dot(l,r)/c),!Ru(h)||h<=0)return e._looking=!0,bm(e,t,i),void Tu.clone(t,e._tiltCenterMousePosition);s=Ou.multiplyByScalar(o,h,md),Ou.add(r,s,s)}o&&(Ru(a)||(a=n.getPickRay(t,dd)),qp(e,a,s,s)),Tu.clone(t,e._tiltCenterMousePosition),Ou.clone(s,e._tiltCenter)}const h=r.canvas,c=pd;c.x=h.clientWidth/2,c.y=e._tiltCenterMousePosition.y,a=n.getPickRay(c,dd);const u=Ou.clone(Ou.ZERO,yd);u.x=s.x;const p=Zu.fromPointNormal(u,l,vd),d=ku.rayPlane(a,p,fd),m=n._projection,f=m.ellipsoid;Ou.fromElements(s.y,s.z,s.x,s);let g=m.unproject(s,_d);f.cartographicToCartesian(g,s);const A=Ku.eastNorthUpToFixedFrame(s,f,gd);let y;Ru(d)?(Ou.fromElements(d.y,d.z,d.x,d),g=m.unproject(d,_d),f.cartographicToCartesian(g,d),y=Ku.eastNorthUpToFixedFrame(d,f,Ad)):y=A;const v=e._globe,C=e._ellipsoid;e._globe=void 0,e._ellipsoid=Nu.UNIT_SPHERE,e._rotateFactor=1,e._rotateRateRangeAdjustment=1;let _=Ou.UNIT_Z;const b=zu.clone(n.transform,bd);n._setTransform(A);const w=Ou.cross(Ou.UNIT_Z,Ou.normalize(n.position,Cd),Cd),P=Ou.dot(n.right,w);if(zd(e,t,i,_,!1,!0),n._setTransform(y),P<0){const r=i.startPosition.y-i.endPosition.y;(o&&r<0||!o&&r>0)&&(_=void 0);const s=n.constrainedAxis;n.constrainedAxis=void 0,zd(e,t,i,_,!0,!1),n.constrainedAxis=s}else zd(e,t,i,_,!0,!1);if(Ru(n.constrainedAxis)){const e=Ou.cross(n.direction,n.constrainedAxis,Sd);Ou.equalsEpsilon(e,Ou.ZERO,ju.EPSILON6)||(Ou.dot(e,n.right)<0&&Ou.negate(e,e),Ou.cross(e,n.direction,n.up),Ou.cross(n.direction,n.up,n.right),Ou.normalize(n.up,n.up),Ou.normalize(n.right,n.right))}n._setTransform(b),e._globe=v,e._ellipsoid=C;const S=C.maximumRadius;e._rotateFactor=1/S,e._rotateRateRangeAdjustment=S;const x=Ou.clone(n.positionWC,Cd);e.enableCollisionDetection&&Sm(e);if(!Ou.equals(n.positionWC,x)){n._setTransform(y),n.worldToCameraCoordinatesPoint(x,x);const e=Ou.magnitudeSquared(x);Ou.magnitudeSquared(n.position)>e&&(Ou.normalize(n.position,n.position),Ou.multiplyByScalar(n.position,Math.sqrt(e),n.position));const t=Ou.angleBetween(x,n.position),i=Ou.cross(x,n.position,x);Ou.normalize(i,i);const r=Wu.fromAxisAngle(i,t,wd),o=Gu.fromQuaternion(r,Pd);Gu.multiplyByVector(o,n.direction,n.direction),Gu.multiplyByVector(o,n.up,n.up),Ou.cross(n.direction,n.up,n.right),Ou.cross(n.right,n.direction,n.up),n._setTransform(b)}}(e,t,i)}const Bd=new Tu,Md=new Xu,Ed=new Ou;function Td(e,t,i){Ru(i.distance)&&(i=i.distance);const r=e._scene,n=r.camera,o=r.canvas,s=e._cameraUnderground;let a;s?a=t:(a=Bd,a.x=o.clientWidth/2,a.y=o.clientHeight/2);const l=n.getPickRay(a,Md),h=l.origin,c=l.direction,u=n.position.z;let p,d;if(u<e._minimumPickingTerrainHeight&&(p=Wp(e,a,Ed)),Ru(p)&&(d=Ou.distance(h,p)),s){const t=Vp(e,l);d=Ru(d)?Math.min(d,t):t}if(!Ru(d)){const e=Ou.UNIT_X;d=-Ou.dot(e,h)/Ou.dot(e,c)}Rp(e,t,i,e._zoomFactor,d)}const Od=new Xu,Ld=new Zu(Ou.UNIT_X,0),Dd=new Ou,Id=new Ou,Rd=new Ou;function Hd(e,t,i){const r=e._scene,n=r.camera,o=n.getPickRay(t.endPosition,Od);let s=Ou.clone(n.direction,Id);r.mode===ep.COLUMBUS_VIEW&&Ou.fromElements(s.z,s.x,s.y,s);const a=Zu.fromPointNormal(i,s,Ld),l=ku.rayPlane(o,a,Dd);Ru(l)&&(s=Ou.subtract(i,l,s),r.mode===ep.COLUMBUS_VIEW&&Ou.fromElements(s.y,s.z,s.x,s),Ou.add(n.position,s,n.position))}const Fd=new Ou,Nd=new Du,Qd=new Ou,kd=new Nu,Ud=new Ou,jd=new Ou;function Gd(e,t,i){const r=e._scene.camera,n=e._cameraUnderground;let o,s,a=e._ellipsoid;if(!zu.equals(r.transform,zu.IDENTITY))return void zd(e,t,i);const l=a.geodeticSurfaceNormal(r.position,Ud);if(Tu.equals(t,e._rotateMousePosition)){if(e._looking)bm(e,t,i,l);else if(e._rotating){if(e.ignoreSkySpin)return;zd(e,t,i)}else if(e._strafing)td(e,i);else{if(Ou.magnitude(r.position)<Ou.magnitude(e._rotateStartPosition))return;o=Ou.magnitude(e._rotateStartPosition),s=Qd,s.x=s.y=s.z=o,a=Nu.fromCartesian3(s,kd),$d(e,t,i,a)}return}e._looking=!1,e._rotating=!1,e._strafing=!1;const h=a.cartesianToCartographic(r.positionWC,Nd).height,c=e._globe;if(Ru(c)&&h<e._minimumPickingTerrainHeight){const h=Wp(e,i.startPosition,Rd);if(Ru(h)){let l=!1;const c=r.getPickRay(i.startPosition,zp);if(n)l=!0,$p(e,c,h,h);else{const e=a.geodeticSurfaceNormal(h,jd);l=!!(Math.abs(Ou.dot(c.direction,e))<.05)||Ou.magnitude(r.position)<Ou.magnitude(h)}l?(Tu.clone(t,e._strafeEndMousePosition),Ou.clone(h,e._strafeStartPosition),e._strafing=!0,Hd(e,i,e._strafeStartPosition)):(o=Ou.magnitude(h),s=Qd,s.x=s.y=s.z=o,a=Nu.fromCartesian3(s,kd),$d(e,t,i,a),Ou.clone(h,e._rotateStartPosition))}else{if(e.ignoreSkySpin)return;e._looking=!0,bm(e,t,i,l)}}else if(Ru(r.pickEllipsoid(i.startPosition,e._ellipsoid,Fd))){if(e.ignoreSkySpin&&!Ru(r.pickEllipsoid(t,e._ellipsoid,Fd)))return;$d(e,t,i,e._ellipsoid),Ou.clone(Fd,e._rotateStartPosition)}else if(h>e._minimumTrackBallHeight){if(e.ignoreSkySpin)return;e._rotating=!0,zd(e,t,i)}else{if(e.ignoreSkySpin)return;e._looking=!0,bm(e,t,i,l)}Tu.clone(t,e._rotateMousePosition)}function zd(e,t,i,r,n,o){n=Iu(n,!1),o=Iu(o,!1);const s=e._scene,a=s.camera,l=s.canvas,h=a.constrainedAxis;Ru(r)&&(a.constrainedAxis=r);const c=Ou.magnitude(a.position);let u=e._rotateFactor*(c-e._rotateRateRangeAdjustment);u>e._maximumRotateRate&&(u=e._maximumRotateRate),u<e._minimumRotateRate&&(u=e._minimumRotateRate);let p=(i.startPosition.x-i.endPosition.x)/l.clientWidth,d=(i.startPosition.y-i.endPosition.y)/l.clientHeight;p=Math.min(p,e.maximumMovementRatio),d=Math.min(d,e.maximumMovementRatio);const m=u*p*Math.PI*2,f=u*d*Math.PI;if(n||a.rotateRight(m),!o){const t=Cesium.Math.toRadians(-e.limitPitchAngle);var g=a.pitch;((g=Ip(g,t))<=t||f<0)&&a.rotateUp(f)}a.constrainedAxis=h}const Yd=Lu.clone(Lu.UNIT_W),Zd=Lu.clone(Lu.UNIT_W),Wd=new Ou,Xd=new Ou,Jd=new Ou,Kd=new Ou,Vd=new Tu,qd=new Tu;function $d(e,t,i,r){const n=e._scene.camera,o=Tu.clone(i.startPosition,Vd),s=Tu.clone(i.endPosition,qd);let a=n.pickEllipsoid(o,r,Yd),l=n.pickEllipsoid(s,r,Zd);if(!Ru(a)||!Ru(l))return e._rotating=!0,void zd(e,0,i);if(a=n.worldToCameraCoordinates(a,a),l=n.worldToCameraCoordinates(l,l),Ru(n.constrainedAxis)){const e=n.constrainedAxis,t=Ou.mostOrthogonalAxis(e,Wd);Ou.cross(t,e,t),Ou.normalize(t,t);const i=Ou.cross(e,t,Xd),r=Ou.magnitude(a),o=Ou.dot(e,a),s=Math.acos(o/r),h=Ou.multiplyByScalar(e,o,Jd);Ou.subtract(a,h,h),Ou.normalize(h,h);const c=Ou.magnitude(l),u=Ou.dot(e,l),p=Math.acos(u/c),d=Ou.multiplyByScalar(e,u,Kd);Ou.subtract(l,d,d),Ou.normalize(d,d);let m=Math.acos(Ou.dot(h,t));Ou.dot(h,i)<0&&(m=ju.TWO_PI-m);let f=Math.acos(Ou.dot(d,t));Ou.dot(d,i)<0&&(f=ju.TWO_PI-f);const g=m-f;let A;A=Ou.equalsEpsilon(e,n.position,ju.EPSILON2)?n.right:Ou.cross(e,n.position,Wd);const y=Ou.cross(e,A,Wd),v=Ou.dot(y,Ou.subtract(a,e,Xd)),C=Ou.dot(y,Ou.subtract(l,e,Xd));let _;_=v>0&&C>0?p-s:v>0&&C<=0?Ou.dot(n.position,e)>0?-s-p:s+p:s-p,n.rotateRight(g),n.rotateUp(_)}else{Ou.normalize(a,a),Ou.normalize(l,l);const e=Ou.dot(a,l),t=Ou.cross(a,l,Wd);if(e<1&&!Ou.equalsEpsilon(t,Ou.ZERO,ju.EPSILON14)){const i=Math.acos(e);n.rotate(t,i)}}}const em=new Ou,tm=new Du;function im(e,t,i){Ru(i.distance)&&(i=i.distance);const r=e._ellipsoid,n=e._scene,o=n.camera,s=n.canvas,a=e._cameraUnderground;let l;a?l=t:(l=Bd,l.x=s.clientWidth/2,l.y=s.clientHeight/2);const h=o.getPickRay(l,Md);let c;const u=r.cartesianToCartographic(o.position,tm).height;let p;if(u<e._minimumPickingTerrainHeight&&(c=Wp(e,l,Ed)),Ru(c)&&(p=Ou.distance(h.origin,c)),a){const t=Vp(e,h);p=Ru(p)?Math.min(p,t):t}Ru(p)||(p=u);const d=Ou.normalize(o.position,em);Rp(e,t,i,e._zoomFactor,p,Ou.dot(d,o.direction))}const rm=new Tu,nm=new Xu,om=new Ou,sm=new Ou,am=new zu,lm=new zu,hm=new zu,cm=new Wu,um=new Gu,pm=new Du,dm=new Ou;function mm(e,t,i){const r=e._scene.camera;if(!zu.equals(r.transform,zu.IDENTITY))return;if(Ru(i.angleAndHeight)&&(i=i.angleAndHeight),Tu.equals(t,e._tiltCenterMousePosition)||(e._tiltOnEllipsoid=!1,e._looking=!1),e._looking){const n=e._ellipsoid.geodeticSurfaceNormal(r.position,dm);return void bm(e,t,i,n)}const n=e._ellipsoid.cartesianToCartographic(r.position,pm);e._tiltOnEllipsoid||n.height>e._minimumCollisionTerrainHeight?(e._tiltOnEllipsoid=!0,function(e,t,i){const r=e._ellipsoid,n=e._scene,o=n.camera,s=.25*e.minimumZoomDistance,a=r.cartesianToCartographic(o.positionWC,fm).height;if(a-s-1<ju.EPSILON3&&i.endPosition.y-i.startPosition.y<0)return;const l=n.canvas,h=rm;h.x=l.clientWidth/2,h.y=l.clientHeight/2;const c=o.getPickRay(h,nm);let u;const p=ku.rayEllipsoid(c,r);if(Ru(p))u=Xu.getPoint(c,p.start,om);else{if(!(a>e._minimumTrackBallHeight)){e._looking=!0;const r=e._ellipsoid.geodeticSurfaceNormal(o.position,dm);return bm(e,t,i,r),void Tu.clone(t,e._tiltCenterMousePosition)}{const e=ku.grazingAltitudeLocation(c,r);if(!Ru(e))return;const t=r.cartesianToCartographic(e,pm);t.height=0,u=r.cartographicToCartesian(t,om)}}const d=Ku.eastNorthUpToFixedFrame(u,r,am),m=e._globe,f=e._ellipsoid;e._globe=void 0,e._ellipsoid=Nu.UNIT_SPHERE,e._rotateFactor=1,e._rotateRateRangeAdjustment=1;const g=zu.clone(o.transform,hm);o._setTransform(d),zd(e,0,i,Ou.UNIT_Z),o._setTransform(g),e._globe=m,e._ellipsoid=f;const A=f.maximumRadius;e._rotateFactor=1/A,e._rotateRateRangeAdjustment=A}(e,t,i)):function(e,t,i){const r=e._ellipsoid,n=e._scene,o=n.camera,s=e._cameraUnderground;let a,l,h;if(Tu.equals(t,e._tiltCenterMousePosition))a=Ou.clone(e._tiltCenter,om);else{if(a=Wp(e,t,om),!Ru(a)){if(l=o.getPickRay(t,nm),h=ku.rayEllipsoid(l,r),!Ru(h)){if(r.cartesianToCartographic(o.position,pm).height<=e._minimumTrackBallHeight){e._looking=!0;const r=e._ellipsoid.geodeticSurfaceNormal(o.position,dm);bm(e,t,i,r),Tu.clone(t,e._tiltCenterMousePosition)}return}a=Xu.getPoint(l,h.start,om)}s&&(Ru(l)||(l=o.getPickRay(t,nm)),qp(e,l,a,a)),Tu.clone(t,e._tiltCenterMousePosition),Ou.clone(a,e._tiltCenter)}const c=n.canvas,u=rm;u.x=c.clientWidth/2,u.y=e._tiltCenterMousePosition.y,l=o.getPickRay(u,nm);const p=Ou.magnitude(a),d=Ou.fromElements(p,p,p,Qd),m=Nu.fromCartesian3(d,kd);if(h=ku.rayEllipsoid(l,m),!Ru(h))return;const f=Ou.magnitude(l.origin)>p?h.start:h.stop,g=Xu.getPoint(l,f,sm),A=Ku.eastNorthUpToFixedFrame(a,r,am),y=Ku.eastNorthUpToFixedFrame(g,m,lm),v=e._globe,C=e._ellipsoid;e._globe=void 0,e._ellipsoid=Nu.UNIT_SPHERE,e._rotateFactor=1,e._rotateRateRangeAdjustment=1;let _=Ou.UNIT_Z;const b=zu.clone(o.transform,hm);o._setTransform(y);const w=Ou.cross(g,o.positionWC,Sd),P=Ou.dot(o.rightWC,w);if(P<0){const t=i.startPosition.y-i.endPosition.y;(s&&t<0||!s&&t>0)&&(_=void 0);const r=o.constrainedAxis;o.constrainedAxis=void 0,zd(e,0,i,_,!0,!1),o.constrainedAxis=r}else zd(e,0,i,_,!0,!1);if(o._setTransform(A),zd(e,0,i,_,!1,!0),Ru(o.constrainedAxis)){const e=Ou.cross(o.direction,o.constrainedAxis,Sd);Ou.equalsEpsilon(e,Ou.ZERO,ju.EPSILON6)||(Ou.dot(e,o.right)<0&&Ou.negate(e,e),Ou.cross(e,o.direction,o.up),Ou.cross(o.direction,o.up,o.right),Ou.normalize(o.up,o.up),Ou.normalize(o.right,o.right))}o._setTransform(b),e._globe=v,e._ellipsoid=C;const S=C.maximumRadius;e._rotateFactor=1/S,e._rotateRateRangeAdjustment=S;const x=Ou.clone(o.positionWC,Sd);e.enableCollisionDetection&&Sm(e);if(!Ou.equals(o.positionWC,x)){o._setTransform(y),o.worldToCameraCoordinatesPoint(x,x);const e=Ou.magnitudeSquared(x);Ou.magnitudeSquared(o.position)>e&&(Ou.normalize(o.position,o.position),Ou.multiplyByScalar(o.position,Math.sqrt(e),o.position));const t=Ou.angleBetween(x,o.position),i=Ou.cross(x,o.position,x);Ou.normalize(i,i);const r=Wu.fromAxisAngle(i,t,cm),n=Gu.fromQuaternion(r,um);Gu.multiplyByVector(n,o.direction,o.direction),Gu.multiplyByVector(n,o.up,o.up),Ou.cross(o.direction,o.up,o.right),Ou.cross(o.right,o.direction,o.up),o._setTransform(b)}}(e,t,i)}const fm=new Du;const gm=new Tu,Am=new Tu,ym=new Xu,vm=new Xu,Cm=new Ou,_m=new Ou;function bm(e,t,i,r){const n=e._scene.camera,o=gm;o.x=i.startPosition.x,o.y=0;const s=Am;s.x=i.endPosition.x,s.y=0;let a,l,h=n.getPickRay(o,ym),c=n.getPickRay(s,vm),u=0;n.frustum instanceof Yu?(a=h.origin,l=c.origin,Ou.add(n.direction,a,a),Ou.add(n.direction,l,l),Ou.subtract(a,n.position,a),Ou.subtract(l,n.position,l),Ou.normalize(a,a),Ou.normalize(l,l)):(a=h.direction,l=c.direction);let p=Ou.dot(a,l);p<1&&(u=Math.acos(p)),u=i.startPosition.x>i.endPosition.x?-u:u;const d=e._horizontalRotationAxis;if(Ru(r)?n.look(r,-u):Ru(d)?n.look(d,-u):n.lookLeft(u),o.x=0,o.y=i.startPosition.y,s.x=0,s.y=i.endPosition.y,h=n.getPickRay(o,ym),c=n.getPickRay(s,vm),u=0,n.frustum instanceof Yu?(a=h.origin,l=c.origin,Ou.add(n.direction,a,a),Ou.add(n.direction,l,l),Ou.subtract(a,n.position,a),Ou.subtract(l,n.position,l),Ou.normalize(a,a),Ou.normalize(l,l)):(a=h.direction,l=c.direction),p=Ou.dot(a,l),p<1&&(u=Math.acos(p)),u=i.startPosition.y>i.endPosition.y?-u:u,r=Iu(r,d),Ru(r)){const e=n.direction,t=Ou.negate(r,Cm),i=Ou.equalsEpsilon(e,r,ju.EPSILON2),o=Ou.equalsEpsilon(e,t,ju.EPSILON2);if(i||o)(i&&u<0||o&&u>0)&&n.look(n.right,-u);else{p=Ou.dot(e,r);let i=ju.acosClamped(p);u>0&&u>i&&(u=i-ju.EPSILON4),p=Ou.dot(e,t),i=ju.acosClamped(p),u<0&&-u>i&&(u=-i+ju.EPSILON4);const o=Ou.cross(r,e,_m);n.look(o,u)}}else n.lookUp(u)}const wm=new zu,Pm=new Du;function Sm(e){e._adjustedHeightForTerrain=!0;const t=e._scene,i=t.mode,r=t.globe;if(!Ru(r)||i===ep.SCENE2D||i===ep.MORPHING)return;const n=t.camera,o=r.ellipsoid,s=t.mapProjection;let a,l;zu.equals(n.transform,zu.IDENTITY)||(a=zu.clone(n.transform,wm),l=Ou.magnitude(n.position),n._setTransform(zu.IDENTITY));const h=Pm;i===ep.SCENE3D?o.cartesianToCartographic(n.position,h):s.unproject(n.position,h);let c=!1;if(h.height<e._minimumCollisionTerrainHeight){const t=e._scene.globeHeight;if(Ru(t)){const r=t+e.minimumZoomDistance;h.height<r&&(h.height=r,i===ep.SCENE3D?o.cartographicToCartesian(h,n.position):s.project(h,n.position),c=!0)}}Ru(a)&&(n._setTransform(a),c&&(Ou.normalize(n.position,n.position),Ou.negate(n.position,n.direction),Ou.multiplyByScalar(n.position,Math.max(l,e.minimumZoomDistance),n.position),Ou.normalize(n.direction,n.direction),Ou.cross(n.direction,n.up,n.right),Ou.cross(n.right,n.direction,n.up)))}rp.prototype.onMap=function(){const e=this._scene,t=e.mode,i=e.camera;return t!==ep.COLUMBUS_VIEW||Math.abs(i.position.x)-this._maxCoord.x<0&&Math.abs(i.position.y)-this._maxCoord.y<0};const xm=new Ou,Bm=new Ou;rp.prototype.update=function(){const e=this._scene,t=e.camera,i=e.globe,r=e.mode;zu.equals(t.transform,zu.IDENTITY)?(this._globe=i,this._ellipsoid=Ru(this._globe)?this._globe.ellipsoid:e.mapProjection.ellipsoid):(this._globe=void 0,this._ellipsoid=Nu.UNIT_SPHERE);const n=Ru(this._globe)?this._globe.terrainExaggeration:1,o=Ru(this._globe)?this._globe.terrainExaggerationRelativeHeight:0;this._minimumCollisionTerrainHeight=Ju.getHeight(this.minimumCollisionTerrainHeight,n,o),this._minimumPickingTerrainHeight=Ju.getHeight(this.minimumPickingTerrainHeight,n,o),this._minimumTrackBallHeight=Ju.getHeight(this.minimumTrackBallHeight,n,o),this._cameraUnderground=e.cameraUnderground&&Ru(this._globe);const s=this._ellipsoid.maximumRadius;this._rotateFactor=1/s,this._rotateRateRangeAdjustment=s,this._adjustedHeightForTerrain=!1;const a=Ou.clone(t.positionWC,xm),l=Ou.clone(t.directionWC,Bm);var h;if(r===ep.SCENE2D?function(e){const t=e._scene.mapMode2D===$u.ROTATE;zu.equals(zu.IDENTITY,e._scene.camera.transform)?(lp(e,e.enableTranslate,e.translateEventTypes,Qp,e.inertiaTranslate,"_lastInertiaTranslateMovement"),lp(e,e.enableZoom,e.zoomEventTypes,kp,e.inertiaZoom,"_lastInertiaZoomMovement"),t&&lp(e,e.enableRotate,e.tiltEventTypes,Gp,e.inertiaSpin,"_lastInertiaTiltMovement")):(lp(e,e.enableZoom,e.zoomEventTypes,kp,e.inertiaZoom,"_lastInertiaZoomMovement"),t&&lp(e,e.enableRotate,e.translateEventTypes,Gp,e.inertiaSpin,"_lastInertiaSpinMovement"))}(this):r===ep.COLUMBUS_VIEW?(this._horizontalRotationAxis=Ou.UNIT_Z,function(e){const t=e._scene.camera;if(zu.equals(zu.IDENTITY,t.transform)){const i=e._tweens;if(e._aggregator.anyButtonDown&&i.removeAll(),lp(e,e.enableTilt,e.tiltEventTypes,xd,e.inertiaSpin,"_lastInertiaTiltMovement"),lp(e,e.enableTranslate,e.translateEventTypes,ud,e.inertiaTranslate,"_lastInertiaTranslateMovement"),lp(e,e.enableZoom,e.zoomEventTypes,Td,e.inertiaZoom,"_lastInertiaZoomMovement"),lp(e,e.enableLook,e.lookEventTypes,bm),!e._aggregator.anyButtonDown&&!i.contains(e._tween)){const r=t.createCorrectPositionTween(e.bounceAnimationTime);Ru(r)&&(e._tween=i.add(r))}i.update()}else lp(e,e.enableRotate,e.rotateEventTypes,zd,e.inertiaSpin,"_lastInertiaSpinMovement"),lp(e,e.enableZoom,e.zoomEventTypes,im,e.inertiaZoom,"_lastInertiaZoomMovement")}(this)):r===ep.SCENE3D&&(this._horizontalRotationAxis=void 0,lp(h=this,h.enableRotate,h.rotateEventTypes,Gd,h.inertiaSpin,"_lastInertiaSpinMovement"),lp(h,h.enableZoom,h.zoomEventTypes,im,h.inertiaZoom,"_lastInertiaZoomMovement"),lp(h,h.enableTilt,h.tiltEventTypes,mm,h.inertiaSpin,"_lastInertiaTiltMovement"),lp(h,h.enableLook,h.lookEventTypes,bm)),this.enableCollisionDetection&&!this._adjustedHeightForTerrain){(!Ou.equals(a,t.positionWC)||!Ou.equals(l,t.directionWC))&&Sm(this)}this._aggregator.reset()},rp.prototype.isDestroyed=function(){return!1},rp.prototype.destroy=function(){return this._tweens.removeAll(),this._aggregator=this._aggregator&&this._aggregator.destroy(),Hu(this)};const Mm=rp;let Em=Cesium.Cartesian2,Tm=(Cesium.Cartesian3,Cesium.Cartesian4,Cesium.Cartographic,Cesium.defaultValue,Cesium.defined),Om=Cesium.destroyObject,Lm=Cesium.DeveloperError,Dm=(Cesium.Ellipsoid,Cesium.HeadingPitchRoll,Cesium.IntersectionTests,Cesium.KeyboardEventModifier),Im=(Cesium.Math,Cesium.Matrix3,Cesium.Matrix4,Cesium.OrthographicFrustum,Cesium.Plane,Cesium.Quaternion,Cesium.Ray,Cesium.TerrainExaggeration,Cesium.Transforms,Cesium.CameraEventType),Rm=(Cesium.MapMode2D,Cesium.SceneMode,Cesium.SceneTransforms,Cesium.TweenCollection,Cesium.ScreenSpaceEventHandler),Hm=Cesium.ScreenSpaceEventType;function Fm(e,t){var i=e;return Tm(t)&&(i+="+"+t),i}function Nm(e,t,i){var r=Fm(Im.PINCH,t),n=e._update,o=e._isDown,s=e._eventStartPosition,a=e._pressTime,l=e._releaseTime,h=e._lastMovement[r];Tm(h)||(h=e._lastMovement[r]={startPosition:new Em,endPosition:new Em,valid:!1}),n[r]=!0,o[r]=!1,s[r]=new Em;var c=e._movement[r];Tm(c)||(c=e._movement[r]={}),c.distance={startPosition:new Em,endPosition:new Em},c.angleAndHeight={startPosition:new Em,endPosition:new Em},c.prevAngle=0,e._eventHandler.setInputAction((function(t){e._buttonsDown++,o[r]=!0,a[r]=new Date,Em.lerp(t.position1,t.position2,.5,s[r])}),Hm.PINCH_START,t),e._eventHandler.setInputAction((function(){e._buttonsDown=Math.max(e._buttonsDown-1,0),o[r]=!1,l[r]=new Date}),Hm.PINCH_END,t),e._eventHandler.setInputAction((function(e){if(o[r]){n[r]?(l=e,u=c,Em.clone(l.distance.startPosition,u.distance.startPosition),Em.clone(l.distance.endPosition,u.distance.endPosition),Em.clone(l.angleAndHeight.startPosition,u.angleAndHeight.startPosition),Em.clone(l.angleAndHeight.endPosition,u.angleAndHeight.endPosition),n[r]=!1,c.prevAngle=c.angleAndHeight.startPosition.x):(Em.clone(e.distance.endPosition,c.distance.endPosition),Em.clone(e.angleAndHeight.endPosition,c.angleAndHeight.endPosition));for(var t=c.angleAndHeight.endPosition.x,s=c.prevAngle,a=2*Math.PI;t>=s+Math.PI;)t-=a;for(;t<s-Math.PI;)t+=a;c.angleAndHeight.endPosition.x=-t*i.clientWidth/12,c.angleAndHeight.startPosition.x=-s*i.clientWidth/12}var l,u;h.startPosition=c.distance.startPosition.clone(),h.endPosition=c.distance.endPosition.clone(),h.valid=!0}),Hm.PINCH_MOVE,t)}function Qm(e,t){var i=Fm(Im.WHEEL,t),r=e._pressTime,n=e._releaseTime,o=e._lastMovement[i];Tm(o)||(o=e._lastMovement[i]={startPosition:new Em,endPosition:new Em,valid:!1}),Tm(e._eventStartPosition[i])||(e._eventStartPosition[i]=new Em);var s=e._update;s[i]=!0;var a=e._movement[i];Tm(a)||(a=e._movement[i]={}),a.startPosition=new Em,a.endPosition=new Em,e._eventHandler.setInputAction((function(t){var l=Math.sign(t)*e._eventHandler._element.height*.02;s[i]?(Em.clone(Em.ZERO,a.startPosition),Em.clone(e._currentMousePosition,e._eventStartPosition[i]),a.endPosition.x=0,a.endPosition.y=l,s[i]=!1):a.endPosition.y=a.endPosition.y+l;var h=new Date,c=new Date;c.setTime(h.getTime()-10),r[i]=c,n[i]=h,o.endPosition=a.endPosition.clone(),o.valid=!0}),Hm.WHEEL,t)}function km(e,t,i){var r=Fm(i,t),n=e._isDown,o=e._eventStartPosition,s=e._pressTime,a=e._releaseTime;n[r]=!1,o[r]=new Em;var l,h,c=e._lastMovement[r];Tm(c)||(c=e._lastMovement[r]={startPosition:new Em,endPosition:new Em,valid:!1}),i===Im.LEFT_DRAG?(l=Hm.LEFT_DOWN,h=Hm.LEFT_UP):i===Im.RIGHT_DRAG?(l=Hm.RIGHT_DOWN,h=Hm.RIGHT_UP):i===Im.MIDDLE_DRAG&&(l=Hm.MIDDLE_DOWN,h=Hm.MIDDLE_UP),e._eventHandler.setInputAction((function(t){e._buttonsDown++,c.valid=!1,n[r]=!0,s[r]=new Date,Em.clone(t.position,o[r])}),l,t),e._eventHandler.setInputAction((function(){e._buttonsDown=Math.max(e._buttonsDown-1,0),n[r]=!1,a[r]=new Date}),h,t)}function Um(e,t){Em.clone(e.startPosition,t.startPosition),Em.clone(e.endPosition,t.endPosition)}function jm(e,t){var i=e._update,r=e._movement,n=e._lastMovement,o=e._isDown;for(var s in Im)if(Im.hasOwnProperty(s)){var a=Im[s];if(Tm(a)){var l=Fm(a,t);i[l]=!0,Tm(e._lastMovement[l])||(e._lastMovement[l]={startPosition:new Em,endPosition:new Em,valid:!1}),Tm(e._movement[l])||(e._movement[l]={startPosition:new Em,endPosition:new Em})}}e._eventHandler.setInputAction((function(s){for(var a in Im)if(Im.hasOwnProperty(a)){var l=Im[a];if(Tm(l)){var h=Fm(l,t);o[h]&&(i[h]?(Um(r[h],n[h]),n[h].valid=!0,Um(s,r[h]),i[h]=!1):Em.clone(s.endPosition,r[h].endPosition))}}Em.clone(s.endPosition,e._currentMousePosition)}),Hm.MOUSE_MOVE,t)}function Gm(e){if(!Tm(e))throw new Lm("canvas is required.");for(var t in this._eventHandler=new Rm(e),this._update={},this._movement={},this._lastMovement={},this._isDown={},this._eventStartPosition={},this._pressTime={},this._releaseTime={},this._buttonsDown=0,this._currentMousePosition=new Em,Qm(this,void 0),Nm(this,void 0,e),km(this,void 0,Im.LEFT_DRAG),km(this,void 0,Im.RIGHT_DRAG),km(this,void 0,Im.MIDDLE_DRAG),jm(this,void 0),Dm)if(Dm.hasOwnProperty(t)){var i=Dm[t];Tm(i)&&(Qm(this,i),Nm(this,i,e),km(this,i,Im.LEFT_DRAG),km(this,i,Im.RIGHT_DRAG),km(this,i,Im.MIDDLE_DRAG),jm(this,i))}}Object.defineProperties(Gm.prototype,{currentMousePosition:{get:function(){return this._currentMousePosition}},anyButtonDown:{get:function(){var e=!(this._update[Fm(Im.WHEEL)]&&this._update[Fm(Im.WHEEL,Dm.SHIFT)]&&this._update[Fm(Im.WHEEL,Dm.CTRL)]&&this._update[Fm(Im.WHEEL,Dm.ALT)]);return this._buttonsDown>0||e}}}),Gm.prototype.isMoving=function(e,t){if(!Tm(e))throw new Lm("type is required.");var i=Fm(e,t);return!this._update[i]},Gm.prototype.getMovement=function(e,t){if(!Tm(e))throw new Lm("type is required.");var i=Fm(e,t);return this._movement[i]},Gm.prototype.getLastMovement=function(e,t){if(!Tm(e))throw new Lm("type is required.");var i=Fm(e,t),r=this._lastMovement[i];if(r.valid)return r},Gm.prototype.isButtonDown=function(e,t){if(!Tm(e))throw new Lm("type is required.");var i=Fm(e,t);return this._isDown[i]},Gm.prototype.getStartMousePosition=function(e,t){if(!Tm(e))throw new Lm("type is required.");var i=Fm(e,t);return this._eventStartPosition[i]},Gm.prototype.getButtonPressTime=function(e,t){if(!Tm(e))throw new Lm("type is required.");var i=Fm(e,t);return this._pressTime[i]},Gm.prototype.getButtonReleaseTime=function(e,t){if(!Tm(e))throw new Lm("type is required.");var i=Fm(e,t);return this._releaseTime[i]},Gm.prototype.reset=function(){for(var e in this._update)this._update.hasOwnProperty(e)&&(this._update[e]=!0)},Gm.prototype.isDestroyed=function(){return!1},Gm.prototype.destroy=function(){return this._eventHandler=this._eventHandler&&this._eventHandler.destroy(),Om(this)};const zm=Gm;function Ym(e,t){t=t||{},this._tilingScheme=t.tilingScheme||new Cesium.GeographicTilingScheme,this._color=t.color||new Cesium.Color(1,1,1,.4),this._tileWidth=t.tileWidth||256,this._tileHeight=t.tileHeight||256,this._ready=!0,this._sexagesimal=t.sexagesimal||!1,this._numLines=t.numLines||50,this._scene=e,this._labels=new Cesium.LabelCollection,e.primitives.add(this._labels),this._polylines=new Cesium.PolylineCollection,e.primitives.add(this._polylines),this._ellipsoid=e.globe.ellipsoid;var i=document.createElement("canvas");i.width=256,i.height=256,this._canvas=i;var r=this;e.camera.moveEnd.addEventListener((function(){r._show&&(r._polylines.removeAll(),r._labels.removeAll(),r._currentExtent=null,r._drawGrid(r._getExtentView()))}))}var Zm=function(){try{return"x"in Object.defineProperty({},"x",{})}catch(e){return!1}}(),Wm=Object.defineProperties;function Xm(e){return e<.01?2:e<.1?1:0}Zm&&Wm||(Wm=function(e){return e}),Wm(Ym.prototype,{url:{get:function(){}},proxy:{get:function(){}},tileWidth:{get:function(){return this._tileWidth}},tileHeight:{get:function(){return this._tileHeight}},maximumLevel:{get:function(){return 18}},minimumLevel:{get:function(){return 0}},tilingScheme:{get:function(){return this._tilingScheme}},rectangle:{get:function(){return this._tilingScheme.rectangle}},tileDiscardPolicy:{get:function(){}},errorEvent:{get:function(){return this._errorEvent}},ready:{get:function(){return this._ready}},credit:{get:function(){return this._credit}},hasAlphaChannel:{get:function(){return!0}}}),Ym.prototype.makeLabel=function(e,t,i,r,n){this._labels.add({position:this._ellipsoid.cartographicToCartesian(new Cesium.Cartographic(e,t,10)),text:i,font:"16px Helvetica",style:Cesium.LabelStyle.FILL_AND_OUTLINE,fillColor:Cesium.Color.AZURE,outlineColor:Cesium.Color.BLACK,outlineWidth:2,pixelOffset:new Cesium.Cartesian2(5,r?18:-18),eyeOffset:Cesium.Cartesian3.ZERO,horizontalOrigin:Cesium.HorizontalOrigin.LEFT,verticalOrigin:r?Cesium.VerticalOrigin.BOTTOM:Cesium.VerticalOrigin.TOP,scale:1})},Ym.prototype._drawGrid=function(e){if(!this._currentExtent||!this._currentExtent.equals(e)){this._currentExtent=e,this._polylines.removeAll(),this._labels.removeAll();this._canvasSize;var t,i=0,r=0;for(t=0;t<Jm.length&&i<(e.north-e.south)/10;t++)i=Jm[t];for(t=0;t<Jm.length&&r<(e.east-e.west)/10;t++)r=Jm[t];var n=(e.west<0?Math.ceil(e.west/r):Math.floor(e.west/r))*r,o=(e.south<0?Math.ceil(e.south/i):Math.floor(e.south/i))*i,s=(e.east<0?Math.ceil(e.east/i):Math.floor(e.east/i))*i,a=(e.north<0?Math.ceil(e.north/r):Math.floor(e.north/r))*r;n=Math.max(n-2*r,-Math.PI),s=Math.min(s+2*r,Math.PI),o=Math.max(o-2*i,-Math.PI/2),a=Math.min(a+2*r,Math.PI/2);var l,h,c=this._ellipsoid,u=Cesium.Math.toRadians(1),p=o+Math.floor((a-o)/i/2)*i;for(h=n;h<s;h+=r){var d=[];for(l=o;l<a;l+=u)d.push(new Cesium.Cartographic(h,l));d.push(new Cesium.Cartographic(h,a)),this._polylines.add({positions:c.cartographicArrayToCartesianArray(d),width:1});var m=Cesium.Math.toDegrees(h);this.makeLabel(h,p,this._sexagesimal?this._decToSex(m):m.toFixed(Xm(r)),!1)}var f=n+Math.floor((s-n)/r/2)*r;for(l=o;l<a;l+=i){d=[];for(h=n;h<s;h+=u)d.push(new Cesium.Cartographic(h,l));d.push(new Cesium.Cartographic(s,l)),this._polylines.add({positions:c.cartographicArrayToCartesianArray(d),width:1});var g=Cesium.Math.toDegrees(l);this.makeLabel(f,l,this._sexagesimal?this._decToSex(g):g.toFixed(Xm(i)),!0)}}},Ym.prototype.requestImage=function(e,t,i){return this._show&&this._drawGrid(this._getExtentView()),Promise.resolve(this._canvas)},Ym.prototype.setVisible=function(e){this._show=e,e?(this._currentExtent=null,this._drawGrid(this._getExtentView())):(this._polylines.removeAll(),this._labels.removeAll())},Ym.prototype.isVisible=function(){return this._show},Ym.prototype._decToSex=function(e){var t=Math.floor(e),i=(60*(Math.abs(e)-t)).toFixed(2);return"60.00"==i&&(t+=1,i="0.00"),[t,":",i].join("")},Ym.prototype._getExtentView=function(){for(var e=this._scene.camera,t=this._scene.canvas,i=[e.pickEllipsoid(new Cesium.Cartesian2(0,0),this._ellipsoid),e.pickEllipsoid(new Cesium.Cartesian2(t.width,0),this._ellipsoid),e.pickEllipsoid(new Cesium.Cartesian2(0,t.height),this._ellipsoid),e.pickEllipsoid(new Cesium.Cartesian2(t.width,t.height),this._ellipsoid)],r=0;r<4;r++)if(void 0===i[r])return Cesium.Rectangle.MAX_VALUE;return Cesium.Rectangle.fromCartographicArray(this._ellipsoid.cartesianArrayToCartographicArray(i))};var Jm=[];"undefined"!=typeof Cesium&&(Jm=Cesium.Math?[Cesium.Math.toRadians(.05),Cesium.Math.toRadians(.1),Cesium.Math.toRadians(.2),Cesium.Math.toRadians(.5),Cesium.Math.toRadians(1),Cesium.Math.toRadians(2),Cesium.Math.toRadians(5),Cesium.Math.toRadians(10)]:[]);const Km=Ym;var Vm=function(){function e(e){this.layer=new Km(e.scene,{})}return e.prototype.show=function(){this.layer.setVisible(!0)},e.prototype.remove=function(){this.layer.setVisible(!1)},e}(),qm=i(6606),$m=function(e,t,i,r){return new(i||(i=Promise))((function(n,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?n(e.value):function(e){return e instanceof i?e:new i((function(t){t(e)}))}(e.value).then(s,a)}l((r=r.apply(e,t||[])).next())}))},ef=function(e,t){var i,r,n,o,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,r&&(n=2&o[0]?r.return:o[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,o[1])).done)return n;switch(r=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(n=s.trys,(n=n.length>0&&n[n.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){s.label=o[1];break}if(6===o[0]&&s.label<n[1]){s.label=n[1],n=o;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(o);break}n[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{i=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},tf=function(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],r=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},rf=function(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var r,n,o=i.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){n={error:e}}finally{try{r&&!r.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}return s},nf=function(e,t,i){if(i||2===arguments.length)for(var r,n=0,o=t.length;n<o;n++)!r&&n in t||(r||(r=Array.prototype.slice.call(t,0,n)),r[n]=t[n]);return e.concat(r||Array.prototype.slice.call(t))},of=function(){function e(){}return e.Render=function(e){return $m(this,void 0,void 0,(function(){var t,i,r,n,o,s,a,l,h,c,u,p,d,m,f,g;return ef(this,(function(A){switch(A.label){case 0:return this.baseWaterColor||(this.baseWaterColor=Cesium.Color.fromCssColorString("#02386C").withAlpha(.5)),t=R.Z.getScriptBaseUrl(),i=t+"resources/water/sea 50_1.json.json",[4,qm.h.getJSON(i).toPromise()];case 1:if(r=A.sent(),n=[],"FeatureCollection"==r.type){l=r;try{for(o=tf(l.features),s=o.next();!s.done;s=o.next())a=s.value,p=this.GetHierarchys(a.geometry),n.push.apply(n,nf([],rf(p),!1))}catch(e){d={error:e}}finally{try{s&&!s.done&&(m=o.return)&&m.call(o)}finally{if(d)throw d.error}}}else if("GeometryCollection"==r.type){l=r;try{for(h=tf(l.geometries),c=h.next();!c.done;c=h.next())u=c.value,p=this.GetHierarchys(u),n.push.apply(n,nf([],rf(p),!1))}catch(e){f={error:e}}finally{try{c&&!c.done&&(g=h.return)&&g.call(h)}finally{if(f)throw f.error}}}return[2,this.draw(e,n)]}}))}))},e.GetHierarchys=function(e){var t,i,r=[];if(!e||!e.type)return r;if("Polygon"==e.type){var n=this.GetHierarchy(e.coordinates);r.push(n)}else if("MultiPolygon"==e.type)try{for(var o=tf(e.coordinates),s=o.next();!s.done;s=o.next()){var a=s.value;n=this.GetHierarchy(a);r.push(n)}}catch(e){t={error:e}}finally{try{s&&!s.done&&(i=o.return)&&i.call(o)}finally{if(t)throw t.error}}return r},e.GetHierarchy=function(e){for(var t=[],i=1,r=e.length;i<r;i++)t.push(new Cesium.PolygonHierarchy(e[i].map((function(e){return Cesium.Cartesian3.fromDegrees(e[0],e[1])}))));var n=e[0].map((function(e){return Cesium.Cartesian3.fromDegrees(e[0],e[1])}));return new Cesium.PolygonHierarchy(n,t)},e.draw=function(e,t){var i,r,n,o,s=null,a=R.Z.getScriptBaseUrl(),l=new Cesium.Material({fabric:{type:"Water",uniforms:{normalMap:a+"resources/Textures/waterNormalsSmall.jpg",frequency:2e4,animationSpeed:.01,amplitude:this.amplitude,baseWaterColor:this.baseWaterColor,specularIntensity:this.specularIntensity}}}),h=[];try{for(var c=tf(t),u=c.next();!u.done;u=c.next()){var p=u.value,d=new Cesium.PolygonGeometry({polygonHierarchy:p,extrudedHeight:0,height:0,vertexFormat:Cesium.EllipsoidSurfaceAppearance.VERTEX_FORMAT}),m=new Cesium.GeometryInstance({geometry:d});h.push(m)}}catch(e){i={error:e}}finally{try{u&&!u.done&&(r=c.return)&&r.call(c)}finally{if(i)throw i.error}}if(h.length>0){var f=new Cesium.EllipsoidSurfaceAppearance({material:l,faceForward:!1,translucent:!1,aboveGround:!1}),g=new Cesium.Primitive({geometryInstances:h,appearance:f,depthFailAppearance:f,vertexCacheOptimize:!0,interleave:!0,compressVertices:!0,releaseGeometryInstances:!0,asynchronous:!0,allowPicking:!0,show:!0});s=e.primitives.add(g)}h=[];try{for(var A=tf(t),y=A.next();!y.done;y=A.next()){p=y.value;var v=new Cesium.PolygonOutlineGeometry({polygonHierarchy:p,vertexFormat:Cesium.EllipsoidSurfaceAppearance.VERTEX_FORMAT});m=new Cesium.GeometryInstance({geometry:v})}}catch(e){n={error:e}}finally{try{y&&!y.done&&(o=A.return)&&o.call(A)}finally{if(n)throw n.error}}if(h.length>0){(l=Cesium.Material.fromType("Color")).uniforms.color=Cesium.Color.fromAlpha(Cesium.Color.GREEN,1);var C=new Cesium.EllipsoidSurfaceAppearance({flat:!0,translucent:!0,faceForward:!1,aboveGround:!0,material:l});g=new Cesium.Primitive({geometryInstances:h,appearance:C,depthFailAppearance:C,vertexCacheOptimize:!0,interleave:!0,compressVertices:!0,releaseGeometryInstances:!0,asynchronous:!0,allowPicking:!1,shadows:Cesium.ShadowMode.DISABLED,show:!0}),e.primitives.add(g)}return s},e.specularIntensity=.71,e.amplitude=7,e}(),sf=i(5108);class af{_viewer;constructor(e){this._viewer=e}enable(e){sf.log("exaggeration enable"),e?this.invokeCameraChanged():this.clearTerrain(this._viewer.scene)}removeListener;invokeCameraChanged(){this._viewer.scene.cameraEventWaitTime=100,this.updateTerrain(this._viewer.scene,1),this.removeListener&&this.removeListener(),this.removeListener=this._viewer.camera.changed.addEventListener((e=>{var t=this.getLevel((()=>Math.ceil(this._viewer.camera.positionCartographic.height))());t&&t<=50&&this.updateTerrain(this._viewer.scene,t)}))}getLevel(e){return e>3e6?50:e>15e5?30:e>75e4?15:e>375e3?10:e>187500||e>93750?5:e>46875||e>23437.5?1:void 0}clearTerrain(e){e.globe.terrainExaggeration=1,e.globe.material=void 0,this.removeListener&&(this.removeListener(),sf.log("clear terrain",this.removeListener))}updateTerrain(e,t=50){e.globe.terrainExaggeration=t}updateTerrain1(e){e.globe.terrainExaggeration=1;var t=e.globe;t.terrainExaggerationRelativeHeight=1e3;var i=t.terrainExaggerationRelativeHeight,r=.5,n={entries:[{height:i+0,color:Cesium.Color.TRANSPARENT},{height:i+.01,color:Cesium.Color.DARKGREEN.withAlpha(r)},{height:i+100,color:Cesium.Color.GREEN.withAlpha(r)},{height:i+200,color:Cesium.Color.LIGHTGREEN.withAlpha(r)},{height:i+500,color:Cesium.Color.YELLOWGREEN.withAlpha(r)},{height:i+1e3,color:Cesium.Color.YELLOW.withAlpha(r)},{height:i+1500,color:Cesium.Color.ORANGE.withAlpha(r)},{height:i+2e3,color:Cesium.Color.ORANGERED.withAlpha(r)},{height:i+3e3,color:Cesium.Color.RED.withAlpha(r)},{height:i+4e3,color:Cesium.Color.ALICEBLUE.withAlpha(r)},{height:i+5e3,color:Cesium.Color.SNOW.withAlpha(r)},{height:i+6e3,color:Cesium.Color.WHITE.withAlpha(r)}],extendDownwards:!0,extendUpwards:!0};e.globe.material=Cesium.createElevationBandMaterial({scene:e,layers:[n]})}}var lf=i(5108);class hf extends h.Z{constructor(e,t={},i=null){super(),this._gvolEarthScriptUrl=R.Z.getScriptBaseUrl(),this._gvolEarthScriptUrl||(t.baseUrl?this._gvolEarthScriptUrl=t.baseUrl:this._gvolEarthScriptUrl="../../");const r={useDefaultImager:!0,showRenderLoopErrors:!1,navigationHelpButton:!1,baseLayerPicker:!1,fullscreenButton:!1,geocoder:!1,animation:!1,shouldAnimate:!0,timeline:!1,vrButton:!1,homeButton:!1,sceneModePicker:!1,infoBox:!1,selectionIndicator:!1,imageryProvider:!1,sceneMode:Cesium.SceneMode.SCENE3D,mapMode2D:Cesium.MapMode2D.INFINITE_SCROLL,contextOptions:{webgl:{preserveDrawingBuffer:!0,powerPreference:"high-performance"},requestWebgl2:!0,allowTextureFilterAnisotropic:!0},creditContainer:void 0,creditViewport:void 0,preloadAncestors:!0,preloadSiblings:!0,isZoomAnimation:!0,enableAutoPitch:!1,enableDoubleClickZoom:!0,limitPitchAngle:10};if(t)for(var n in r)Cesium.defined(t[n])||(t[n]=r[n]);else t=r;if(this._loadMode=window.LoadMode,null===i)if(this._loadMode&&1===this._loadMode){const r=function(e,t){var i,r,n,o=Cesium.xbsjCreateViewer(e,t);o.extend(Cesium.xbsjMeasurementMixin),o.extend(Cesium.xbsjFlattenningMixin),Cesium.xbsjViewshedMixin(o.scene),Cesium.xbsjCameraImmersionMixin(o.scene),Cesium.xbsjPbrMixin(o.scene),Cesium.xbsjBoxPickMixin(o.scene),o.extend(Cesium.xbsjImageryProviderMixin),Cesium.xbsjWaterMixin(o.scene),Cesium.xbsjSubsurfaceMixin(o.scene),Cesium.xbsjODLineMixin(o.scene),Cesium.xbsjClippingPlaneMixin(o.scene),Cesium.xbsjRestrictImageryMixin(o.scene),i=window,n=!1,r=i.navigator.userAgent||i.navigator.vendor||i.opera,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(r)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(r.substr(0,4)))&&(n=!0),n||Cesium.xbsjFixResolutionScale(o),o.screenSpaceEventHandler.removeInputAction(Cesium.ScreenSpaceEventType.LEFT_CLICK),o.screenSpaceEventHandler.removeInputAction(Cesium.ScreenSpaceEventType.LEFT_DOUBLE_CLICK),o.clock.currentTime=Cesium.JulianDate.fromDate(new Date("2019-09-07T07:12:24.934Z")),o.scene.postProcessStages.fxaa.enabled=!0;var s=new Cesium.XbsjBoxPickAction(o);return o.gvolBoxPickAction=s,o}(e,t);i=r}else{const r=function(e,t){const i={defaultViewRectangle:!0};i.defaultViewRectangle&&(Cesium.Camera.DEFAULT_VIEW_RECTANGLE=Cesium.Rectangle.fromDegrees(118,27,123,31),Cesium.Camera.DEFAULT_VIEW_FACTOR=3);const r=Object.assign(i,{baseLayerPicker:!1,geocoder:!1,animation:!1,baseLayerPicker:!1,fullscreenButton:!1,vrButton:!1,homeButton:!1,infoBox:!1,sceneModePicker:!1,selectionIndicator:!1,timeline:!1,navigationHelpButton:!1,navigationInstructionsInitiallyVisible:!1,shouldAnimate:!0,scene3DOnly:!0,showRenderLoopErrors:!1,contextOptions:{requestWebgl2:!0}},t);var n=new Cesium.Viewer(e,r);return n.scene.renderError.addEventListener((function(e,t){ph.error("Render Error: "+t)})),n.camera.percentageChanged=1e-5,n.shadowMap.size=2048,n.scene.moon&&(n.scene.moon.show=!1),n._cesiumWidget._creditContainer.style.display="none",n}(e,t);i=r}this._viewer=i,this._options=t,this.disposers.push((()=>this._viewer.destroy())),this._scene=i.scene,window.gvol_hpr_scene=this._scene,Cesium.xbsjFixController&&Cesium.xbsjFixController(this._scene),this._czm={get viewer(){return i},get scene(){return i.scene},get camera(){return i.camera}},Bu(this,"czm"),this._gvolObjectOpsEvent=new Cesium.Event,(0,P.extendObservable)(this,{_gvolObjectsMap:P.observable.map(),get flattenedPolygonCollection(){return this.getAllObjects("FlattenedPolygonCollection")},get tilesetCollection(){return this.getAllObjects("Tileset")},get clippingPlaneCollection(){return this.getAllObjects("ClippingPlane")},get pathCollection(){return this.getAllObjects("Path")}},{flattenedPolygonCollection:P.computed,tilesetCollection:P.computed,clippingPlaneCollection:P.computed,pathCollection:P.computed}),this.disposers.push((()=>{if(0!==this._gvolObjectsMap.size){const e=[...this._gvolObjectsMap.values()];lf.log(`共计有${e.length}个对象未被清理！分别是：`),e.forEach((e=>`guid: ${e.name} $name：${e.gvolGuid}`)),lf.log("这些对象将被自动清理掉！"),e.forEach((e=>e.destroy()))}else lf.log("所有对象都已清理！");0!==this._gvolObjectsMap.size&&lf.error("仍有对象未清理！")})),this._context=new hu(this),Bu(this,"context"),this._eventSource=new yu(this),Bu(this,"eventSource"),this.disposers.push((()=>{this._eventSource.destory(),this._context.destroy()})),this._terrainListener=new dh(this),this._imageryListener=new mh(this),this.disposers.push((()=>{this._terrainListener.destroy(),this._imageryListener.destroy()})),[{managerName:"sceneTree",managerConstructor:la.Tree},{managerName:"cameraViewManager",managerConstructor:fa.Manager}].forEach((({managerName:e,managerConstructor:t})=>{!function(e,t,i){i[e]=new t(i),i.disposers.push((()=>i[e]=i[e]&&i[e].destroy())),i.disposers.push(h.Z.registerProperty(i,e))}(e,t,this)})),this._loadMode&&1===this._loadMode&&(this._cameraFlight=new Pa(this),Bu(this,"cameraFlight"),this._camera=new Ga(this),Bu(this,"camera"),this._interaction=new Wl(this),Bu(this,"interaction"),this._analyzation=new sh(this),Bu(this,"analyzation"),this._misc=new uh(this),Bu(this,"misc"),this._terrainEffect=new Lh(this),Bu(this,"terrainEffect"),this._effect=new au(this),this.disposers.push((()=>this._effect=this._effect&&this._effect.destroy())),Bu(this,"effect"),this._postProcess=new Wc(this),this.disposers.push((()=>this._postProcess=this._postProcess&&this._postProcess.destroy())),Bu(this,"postProcess"),this.disposers.push((()=>{this._cameraFlight.destroy(),this._camera.destroy(),this._interaction.destroy(),this._analyzation.destroy(),this._misc.destroy(),this._terrainListener.destroy(),this._imageryListener.destroy(),this._terrainEffect.destroy()})),this._pinBuilder=new Cesium.XbsjPinBuilder,this._status=new xu(this),Bu(this,"status")),this._weather=new tu(this),Bu(this,"weather"),this._weather.skyBox.skyBoxOnGround=!1,this._clock=new Eu(this),this.disposers.push((()=>this._clock.destroy())),this.initContainer(t),lf.log("引擎加载完成...")}initContainer(e){Cesium.Camera.DEFAULT_VIEW_RECTANGLE=Cesium.Rectangle.fromDegrees(75,-30,140,90),this._viewer.scene.orderGroundPrimitives=new Cesium.OrderedGroundPrimitiveCollection,this._viewer.scene.primitives.add(this._viewer.scene.orderGroundPrimitives);let t=new Mm(this._viewer.scene);t.enableAutoPitch=e.enableAutoPitch,t.limitPitchAngle=e.limitPitchAngle,this._viewer.scene._screenSpaceCameraController=t,this._viewer.scene.screenSpaceCameraController.minimumZoomDistance=10,this._viewer.scene.screenSpaceCameraController.maximumZoomDistance=7e7,e.isZoomAnimation&&(this._viewer.scene.screenSpaceCameraController._aggregator=new zm(this.viewer.scene.canvas),/Android|webOS|iPhone|iPod|BlackBerry/i.test(navigator.userAgent)&&e.isZoomAnimation&&(this._viewer.scene.screenSpaceCameraController.inertiaZoom=.9)),e.enableDoubleClickZoom&&this.registerDoubleClickZoom(),this._viewer.scene.logarithmicDepthFarToNearRatio=1e5;var i=this._viewer.scene.camera;i.changed.addEventListener((function(){i._suspendTerrainAdjustment&&this._viewer.scene.mode===Cesium.SceneMode.SCENE3D&&(i._suspendTerrainAdjustment=!1,i._adjustHeightForTerrain())})),document.getElementsByClassName("cesium-viewer-bottom")[0].style.display="none",document.getElementsByClassName("cesium-credit-logoContainer")[0].style.display="none"}registerDoubleClickZoom(){const e=this.viewer;new Cesium.ScreenSpaceEventHandler(e.scene.canvas).setInputAction((e=>{const t=(new Date).getTime();t-this.lastTouchTimestamp<300?(this.zoomInMapByScreenPosition(e.position),this.lastTouchTimestamp=0):this.lastTouchTimestamp=t}),Cesium.ScreenSpaceEventType.LEFT_CLICK)}getPick(e){var t;if(this.viewer.scene.mode==Cesium.SceneMode.SCENE3D){var i=this.viewer.camera.getPickRay(e);t=this.viewer.scene.globe.pick(i,this.viewer.scene)}else t=this.viewer.scene.camera.pickEllipsoid(e);return t}zoomInMapByScreenPosition(e){var t=this.calculateZoomInBastView(e);this.viewer.camera.flyTo({destination:t.destination,orientation:t.orientation,duration:1})}calculateZoomInBastView(e){var t=Cesium.Math,i=this.viewer.camera.positionCartographic.height/1.4,r=this.viewer.camera,n=new Cesium.Cartesian3,o={orientation:new Cesium.HeadingPitchRoll};const s=o.orientation;s.heading=r.heading,s.pitch=r.pitch,s.roll=r.roll;var a=this.getPick(e);const l=Cesium.Cartesian3.normalize(r.position,new Cesium.Cartesian3),h=new Cesium.Cartesian3;Cesium.Cartesian3.clone(r.position,h);const c=a,u=new Cesium.Cartesian3,p=new Cesium.Cartesian3;Cesium.Cartesian3.clone(r.direction,p),Cesium.Cartesian3.add(h,Cesium.Cartesian3.multiplyByScalar(p,i,n),u);const d=new Cesium.Cartesian3,m=new Cesium.Cartesian3;Cesium.Cartesian3.subtract(c,h,d),Cesium.Cartesian3.normalize(d,m);const f=Cesium.Cartesian3.dot(l,m),g=Math.acos(-f),A=Cesium.Cartesian3.magnitude(h),y=Cesium.Cartesian3.magnitude(c),v=A-i,C=Cesium.Cartesian3.magnitude(d);if(C<1e3)return{destination:h,orientation:s};const _=Math.asin(t.clamp(C/y*Math.sin(g),-1,1))-Math.asin(t.clamp(v/y*Math.sin(g),-1,1))+g,b=new Cesium.Cartesian3;Cesium.Cartesian3.normalize(h,b);let w=new Cesium.Cartesian3;w=Cesium.Cartesian3.cross(m,b,w),w=Cesium.Cartesian3.normalize(w,w),Cesium.Cartesian3.normalize(Cesium.Cartesian3.cross(b,w,n),p),Cesium.Cartesian3.multiplyByScalar(Cesium.Cartesian3.normalize(u,n),Cesium.Cartesian3.magnitude(u)-i,u),Cesium.Cartesian3.normalize(h,h),Cesium.Cartesian3.multiplyByScalar(h,v,h);const P=new Cesium.Cartesian3;if(Cesium.Cartesian3.multiplyByScalar(Cesium.Cartesian3.add(Cesium.Cartesian3.multiplyByScalar(b,Math.cos(_)-1,new Cesium.Cartesian3),Cesium.Cartesian3.multiplyByScalar(p,Math.sin(_),new Cesium.Cartesian3),n),v,P),Cesium.Cartesian3.add(h,P,h),Cesium.defined(this.viewer.scene.screenSpaceCameraController)){let e=this.viewer.scene.screenSpaceCameraController;if(e.enableAutoPitch){let t=this.viewer.camera.positionCartographic.height;if(t<=e.autoPitchStartHeight){let i=t/e.autoPitchStartHeight,r=e.autoPitchMinAngle+(e.autoPitchMaxAngle-e.autoPitchMinAngle)*i;o.orientation.pitch=Cesium.Math.toRadians(-r)}}}return{destination:h,orientation:o.orientation}}gvolFromJSON(e){this.gvolFromJSON(e);try{this.camera.gvolFromJSON(e.camera)}catch(e){lf.log("camera fromJSON failed",e)}try{this.cameraFlight.gvolFromJSON(e.cameraFlight)}catch(e){lf.log("cameraFlight fromJSON failed",e)}try{this.weather.gvolFromJSON(e.weather)}catch(e){lf.log("weather fromJSON failed",e)}try{this.terrainEffect.gvolFromJSON(e.terrainEffect)}catch(e){lf.log("terrainEffect fromJSON failed",e)}try{this.postProcess.gvolFromJSON(e.postProcess)}catch(e){lf.log("postProcess fromJSON failed",e)}try{this.effect.gvolFromJSON(e.effect)}catch(e){lf.log("effect fromJSON failed",e)}try{this.interaction.gvolFromJSON(e.interaction)}catch(e){lf.log("interaction fromJSON failed",e)}}toJSON(){return{...super.toJSON(),cameraFlight:this.cameraFlight.toJSON(),weather:this.weather.toJSON(),terrainEffect:this.terrainEffect.toJSON(),postProcess:this.postProcess.toJSON(),effect:this.effect.toJSON(),camera:this.camera.toJSON(),interaction:this.interaction.toJSON()}}get gvolObjectOpsEvent(){return this._gvolObjectOpsEvent}registerObject(e,t,i){return fh(this,e,t,i)}registerObjectFromGuid(e,t,i){return Ah(this,e,t,i)}getObject(e){return this._gvolObjectsMap.get(e)}getAllObjects(e){const t=[];return this._gvolObjectsMap.forEach(((i,r)=>{e&&i.gvolType!==e||t.push(i)})),t}startRun(e={multiplier:1}){if(this.viewer.scene.postUpdate.addEventListener(this.rotateSetting(this.viewer)),this.viewer.clock){const t=Object.keys(e);for(let i of t)this.viewer.clock[i]=e[i]}}stopRun(){this.viewer.clock.multiplier=1,this.viewer.scene.postUpdate.removeEventListener(this.rotateSetting)}rotateSetting(e){if(!this._viewer||this._viewer.scene.mode!==Cesium.SceneMode.SCENE3D)return;const t=Cesium.Transforms.computeIcrfToFixedMatrix(this._viewer.clock.currentTime);if(Cesium.defined(t)){const e=this._viewer.camera,i=Cesium.Cartesian3.clone(e.position),r=Cesium.Matrix4.fromRotationTranslation(t);e.lookAtTransform(r,i)}}pickPosition(e,t){return _u(this._scene,e,t)}getSceneSize(e,t){return wu(this._scene,e,t)}get viewer(){return this._viewer}get camera(){return this._camera?this._camera:this.viewer.camera}get cameraFlight(){return this._cameraFlight||lf.warn("警告，当前加载模式下不会创建cameraFlight，如果需要请使用严格模式加载"),this._cameraFlight}get weather(){return this._weather}get terrainEffect(){return this._terrainEffect||lf.warn("警告，当前加载模式下不会创建terrainEffect，如果需要请使用严格模式加载"),this._terrainEffect}get postProcess(){return this._postProcess||lf.warn("警告，当前加载模式下不会创建postProcess，如果需要请使用严格模式加载"),this._postProcess}get effect(){return this._effect||lf.warn("警告，当前加载模式下不会创建effect，如果需要请使用严格模式加载"),this._effect}get interaction(){return this._interaction}get sunLight(){return this._sunLight}set sunLight(e){if(this._sunLight=e,this.fixLightFunc&&this.viewer.scene.preRender.removeEventListener(this.fixLightFunc),this.viewer.scene.globe.enableLighting)if(1==e){let e=new Cesium.SunLight,t=this.viewer.scene;t.light=e,t.globe.dynamicAtmosphereLighting=!0}else{let e=this.viewer.scene;var t=new Cesium.DirectionalLight({direction:e.camera.directionWC});e.light=t,e.globe.dynamicAtmosphereLighting=!1,this.fixLightFunc=(e,t)=>{e.light.direction=Cesium.Cartesian3.clone(e.camera.directionWC,e.light.direction)},e.preRender.addEventListener(this.fixLightFunc)}}get globeSunLight(){return this._globeSunLight}set globeSunLight(e){this._globeSunLight=e,this.SetglobeSunLight(e)}SetglobeSunLight(e){if(!e){let e=new Cesium.SunLight;this.viewer.scene.light=e,this.fixLightFunc&&this.viewer.scene.preRender.removeEventListener(this.fixLightFunc)}this.viewer.scene.globe.enableLighting!==e&&(this.viewer.scene.globe.enableLighting=e),e&&(this.sunLight=this.viewer.scene.globe.dynamicAtmosphereLighting)}get skyBox2(){return this.viewer.scene.skyBox}get graticule(){return this._graticule}set graticule(e){this._graticule=e,this.graticuleLayer||(this.graticuleLayer=new Vm(this.viewer),this.viewer.scene.imageryLayers.addImageryProvider(this.graticuleLayer.layer)),e?this.graticuleLayer.show():this.graticuleLayer.remove()}get water(){return this._water}set water(e){this._water=e,this.SetWater(e)}async SetWater(e){if(this.sea)this.sea.show=e;else if(e){var t=await of.Render(this.viewer.scene);t&&(this.sea=t)}}get baseWaterColor(){return this._baseWaterColor}set baseWaterColor(e){this._baseWaterColor=e,this.sea?this.sea.appearance.material.uniforms.baseWaterColor=Cesium.Color.fromCssColorString(e).withAlpha(.5):of.baseWaterColor=Cesium.Color.fromCssColorString(e).withAlpha(.5)}get specularIntensity(){return this._specularIntensity}set specularIntensity(e){this._specularIntensity=e,this.sea?this.sea.appearance.material.uniforms.specularIntensity=e:of.specularIntensity=e}get amplitude(){return this._amplitude}set amplitude(e){this._amplitude=e,this.sea?this.sea.appearance.material.uniforms.amplitude=e:of.amplitude=e}get exaggerValue(){return this._exaggerValue}set exaggerValue(e){this._exaggerValue=e,this._terrainSample||(this._terrainSample=new af(this._viewer)),-1==e?(this.viewer.scene.globe.terrainExaggeration=1,this._terrainSample.enable(!0)):(this._terrainSample.enable(!1),this.viewer.scene.globe.terrainExaggeration=e)}openTerrainTest(){this.viewer.scene.globe.depthTestAgainstTerrain=!0}closeTerrainTest(){this.viewer.scene.globe.depthTestAgainstTerrain=!1}}hf.defaultOptions={sceneTree:{},cameraViewManager:{}},hf.Interaction=Wl;const cf=hf;class uf extends hr{constructor(e,t){super(e,t),this._onlyMove=!1,this._fixedPositionsNum=void 0,Js.extend(this,{_polylineShow:!0}),this._polyline=new GVOL.Obj.Polyline(e),this.disposers.push((()=>{this._polyline=this._polyline&&this._polyline.destroy()})),this._polyline.show=this._polylineShow&&this.show,cf.Interaction.Picking.registerPickingParent(this._polyline,this);const i=()=>{this._polyline.show=this._polylineShow&&this.show,this._polyline.width=this.width,this._polyline.material.XbsjColorMaterial.color=this.color,this._polyline.ground=this.ground,this._polyline.depthTest=this.depthTest,this._polyline.minShowHeight=this.minShowHeight,this._polyline.maxShowHeight=this.maxShowHeight};i(),this.disposers.push(Js.watch((()=>({show:this.show,polylineShow:this._polylineShow,width:this.width,color:[...this.color],ground:this.ground,depthTest:this.depthTest,minShowHeight:this.minShowHeight,maxShowHeight:this.maxShowHeight})),(()=>i())))}get onlyMove(){return this._onlyMove}get fixedPositionsNum(){return this._fixedPositionsNum}flyTo(){this._polyline.flyTo()}}uf.defaultOptions={positions:[],show:!0,width:5,color:[0,1,0,1],depthTest:!1,minShowHeight:-Number.MAX_VALUE,maxShowHeight:Number.MAX_VALUE};const pf=uf;class df extends pf{constructor(e,t){super(e,t),this._onlyMove=!0,this._fixedPositionsNum=2,this._positions=new Array(6).fill(0).map((()=>[0,0,0])),this._leftArrowPosition1=[0,0,0],this._rightArrowPosition1=[0,0,0],this._leftArrowPosition2=[0,0,0],this._rightArrowPosition2=[0,0,0],this._leftArrowPosition3=[0,0,0],this._rightArrowPosition3=[0,0,0],this._leftArrowPosition4=[0,0,0],this._rightArrowPosition4=[0,0,0],this._leftArrowPosition5=[0,0,0],this._rightArrowPosition5=[0,0,0],this._leftArrowPosition6=[0,0,0],this._rightArrowPosition6=[0,0,0],this._leftArrowPosition7=[0,0,0],this._rightArrowPosition7=[0,0,0],this._polylinePositions=[],this._scratchHpr=[0,0,0],this._scratchPos=[0,0,0],this.disposers.push(Js.watch((()=>[...this.positions.map((e=>[...e]))]),(e=>{if(2===e.length){e[1][2]=e[0][2];const t=ei.Math.geoDistance(e[0],e[1]);e[0];if(t>0){const i=ei.hpr(e[0],e[1],this._scratchHpr);if(!i)return;for(let r=0;r<6;++r)ei.Math.geoMove(e[0],i[0]+Cesium.Math.PI_OVER_THREE*r,t,this._positions[r]);return this._polylinePositions.length=0,ei.Math.geoMove(this._positions[0],i[0]+7*Math.PI/6,.1*t,this._leftArrowPosition1),ei.Math.geoMove(this._positions[0],i[0]-7*Math.PI/6,.1*t,this._rightArrowPosition1),ei.Math.geoMove(this._positions[1],i[0]+3*Math.PI/2,.1*t,this._leftArrowPosition2),ei.Math.geoMove(this._positions[1],i[0]-Math.PI/6,.1*t,this._rightArrowPosition2),ei.Math.geoMove(this._positions[4],i[0]+Math.PI/2,.1*t,this._leftArrowPosition3),ei.Math.geoMove(this._positions[4],i[0]+Math.PI/6,.1*t,this._rightArrowPosition3),ei.Math.geoMove(this._positions[5],i[0]-5*Math.PI/6,.1*t,this._leftArrowPosition4),ei.Math.geoMove(this._positions[5],i[0]+5*Math.PI/6,.1*t,this._rightArrowPosition4),ei.Math.geoMove(this._positions[2],i[0]-Math.PI/6,.1*t,this._leftArrowPosition5),ei.Math.geoMove(this._positions[2],i[0]-Math.PI/2,.1*t,this._rightArrowPosition5),ei.Math.geoMove(this._positions[3],i[0]+Math.PI/2,.1*t,this._leftArrowPosition6),ei.Math.geoMove(this._positions[3],i[0]+Math.PI/6,.1*t,this._rightArrowPosition6),ei.Math.geoMove(this.positions[0],i[0]+7*Math.PI/6,.1*t,this._leftArrowPosition7),ei.Math.geoMove(this.positions[0],i[0]-(Math.PI+Math.PI/6),.1*t,this._rightArrowPosition7),this._polylinePositions.push([...e[0]]),this._polylinePositions.push([...this._positions[0]]),this._polylinePositions.push([...this._leftArrowPosition1]),this._polylinePositions.push([...this._positions[0]]),this._polylinePositions.push([...this._rightArrowPosition1]),this._polylinePositions.push([...this._positions[0]]),this._polylinePositions.push([...this._positions[1]]),this._polylinePositions.push([...this._leftArrowPosition2]),this._polylinePositions.push([...this._positions[1]]),this._polylinePositions.push([...this._rightArrowPosition2]),this._polylinePositions.push([...this._positions[1]]),this._polylinePositions.push([...this._positions[4]]),this._polylinePositions.push([...this._leftArrowPosition3]),this._polylinePositions.push([...this._positions[4]]),this._polylinePositions.push([...this._rightArrowPosition3]),this._polylinePositions.push([...this._positions[4]]),this._polylinePositions.push([...this._positions[5]]),this._polylinePositions.push([...this._leftArrowPosition4]),this._polylinePositions.push([...this._positions[5]]),this._polylinePositions.push([...this._rightArrowPosition4]),this._polylinePositions.push([...this._positions[5]]),this._polylinePositions.push([...this._positions[2]]),this._polylinePositions.push([...this._leftArrowPosition5]),this._polylinePositions.push([...this._positions[2]]),this._polylinePositions.push([...this._rightArrowPosition5]),this._polylinePositions.push([...this._positions[2]]),this._polylinePositions.push([...this._positions[3]]),this._polylinePositions.push([...this._leftArrowPosition6]),this._polylinePositions.push([...this._positions[3]]),this._polylinePositions.push([...this._rightArrowPosition6]),this._polylinePositions.push([...this._positions[3]]),this._polylinePositions.push([...e[0]]),this._polylinePositions.push([...this._leftArrowPosition7]),this._polylinePositions.push([...e[0]]),this._polylinePositions.push([...this._rightArrowPosition7]),this._polyline.positions=this._polylinePositions,void(this._polylineShow=!0)}}this._polylineShow=!1})))}}df.registerType(df,"GeoSectorSearch");const mf=df;class ff extends pf{constructor(e,t){super(e,t),this._leftArrowPosition=[0,0,0],this._rightArrowPosition=[0,0,0],this.disposers.push(Js.watch((()=>[...this.positions.map((e=>[...e]))]),(e=>{const t=e.length,i=ei.Math.distance(e);if(t<2)return void(this._polylineShow=!1);const r=ei.Math.hpr(e[t-1],e[t-2]);r&&(ei.Math.geoMove(e[t-1],r[0]+Math.PI/6,.1*i,this._leftArrowPosition),ei.Math.geoMove(e[t-1],r[0]-Math.PI/6,.1*i,this._rightArrowPosition),e.push([...this._leftArrowPosition]),e.push([...e[t-1]]),e.push([...this._rightArrowPosition]),e.push([...e[t-1]]),this._polyline.positions=e,this._polylineShow=!0)})))}}ff.registerType(ff,"GeoPolylineArrow");const gf=ff;class Af extends hr{constructor(e,t){super(e,t),this._onlyMove=!1,this._fixedPositionsNum=void 0,Js.extend(this,{_polygonShow:!0}),this._polygon=new GVOL.Obj.Polygon(e),this.disposers.push((()=>{this._polygon=this._polygon&&this._polygon.destroy()})),this._polygon.show=this._polygonShow&&this.show,cf.Interaction.Picking.registerPickingParent(this._polygon,this);const i=()=>{this._polygon.show=this._polygonShow&&this.show,this._polygon.width=this.width,this._polygon.color=this.color,this._polygon.ground=this.ground,this._polygon.outline.width=this.outlineWidth,this._polygon.outline.color=this.outlineColor,this._polygon.outline.show=this.outlineShow,this._polygon.depthTest=this.depthTest,this._polygon.extrudedHeight=this.extrudedHeight,this._polygon.minShowHeight=this.minShowHeight,this._polygon.maxShowHeight=this.maxShowHeight};i(),this.disposers.push(Js.watch((()=>({show:this._polygonShow&&this.show,width:this.width,color:[...this.color],ground:this.ground,outlineWidth:this.outlineWidth,outlineColor:this.outlineColor,outlineShow:this.outlineShow,depthTest:this.depthTest,extrudedHeight:this.extrudedHeight,minShowHeight:this.minShowHeight,maxShowHeight:this.maxShowHeight})),(()=>i())))}get onlyMove(){return this._onlyMove}get fixedPositionsNum(){return this._fixedPositionsNum}flyTo(){this._polygon.flyTo()}}Af.defaultOptions={positions:[],show:!0,color:[0,1,0,.1],outlineWidth:2,outlineColor:[0,1,0,1],outlineShow:!0,depthTest:!1,extrudedHeight:null,minShowHeight:-Number.MAX_VALUE,maxShowHeight:Number.MAX_VALUE};const yf=Af;class vf extends yf{constructor(e,t){super(e,t),this._onlyMove=!0,this._fixedPositionsNum=2,this._polygonPositions=[],this._hpr=[0,0,0],this.disposers.push(Js.watch((()=>[...this.positions.map((e=>[...e]))]),(e=>{if(e.length<2)return void(this._polygonShow=!1);this._polygonPositions.length=0,this._polygonPositions.push(e[0][0],e[1][1]),this._polygonPositions.push(e[0][0],e[0][1]),this._polygonPositions.push(e[1][0],.5*(e[0][1]+e[1][1]));const t=e[1][0]-e[0][0];this._polygonPositions.push(e[0][0]+.01*t,.5*(e[0][1]+e[1][1])),this._polygonPositions.push(e[0][0]+.01*t,e[1][1]),this._polygon.positions=this._polygonPositions,this._polygon.height=e[0][2],this._polygonShow=!0})))}}vf.registerType(vf,"GeoTriFlag");const Cf=vf;class _f extends pf{constructor(e,t){super(e,t),this._leftArrowPosition=[0,0,0],this._rightArrowPosition=[0,0,0],this._positions=[],this.disposers.push(Js.watch((()=>({positions:[...this.positions.map((e=>[...e]))],slices:this.slices})),(({positions:e,slices:t})=>{const i=e.length,r=ei.Math.distance(e);if(i<2)return void(this._polylineShow=!1);this._positions.length=0,ei.Math.interpolatePositions(e,t,!1,this._positions);const n=this._positions.length,o=ei.Math.hpr(this._positions[n-1],this._positions[n-2]);o?(ei.Math.geoMove(this._positions[n-1],o[0]+Math.PI/6,.05*r,this._leftArrowPosition),ei.Math.geoMove(this._positions[n-1],o[0]-Math.PI/6,.05*r,this._rightArrowPosition),this._positions.push([...this._leftArrowPosition]),this._positions.push([...this._positions[n-1]]),this._positions.push([...this._rightArrowPosition]),this._positions.push([...this._positions[n-1]]),this._polyline.positions=this._positions,this._polylineShow=!0):this._polylineShow=!1})))}}_f.defaultOptions={slices:100},_f.registerType(_f,"GeoCurveArrow");const bf=_f;class wf extends yf{constructor(e,t){super(e,t),this._onlyMove=!0,this._fixedPositionsNum=4,this._keyPositions=new Array(50).fill(0).map((e=>[0,0,0])),this._bottomCurcePositions=new Array(20).fill(0).map((e=>[0,0,0])),this._leftArrowLeftPositions=new Array(20).fill(0).map((e=>[0,0,0])),this._leftArrowRightPositions=new Array(20).fill(0).map((e=>[0,0,0])),this._rightArrowLeftPositions=new Array(20).fill(0).map((e=>[0,0,0])),this._rightArrowRightPositions=new Array(20).fill(0).map((e=>[0,0,0])),this._polygonPositions=[],this._hpr=[0,0,0],this.disposers.push(Js.watch((()=>[...this.positions.map((e=>[...e]))]),(e=>{const t=e.length;if(t<3||3===t&&ei.Math.hasSamePosition(e))return void(this._polygonShow=!1);this._keyPositions[0].splice(0,3,...e[0]),this._keyPositions[1].splice(0,3,...e[1]),this._keyPositions[2].splice(0,3,...e[2]),4===e.length?this._keyPositions[3].splice(0,3,...e[3]):(ei.Math.geoLerp(e[0],e[2],.5,this._keyPositions[3]),ei.Math.geoLerp(e[1],this._keyPositions[3],2,this._keyPositions[3]));const i=this._keyPositions[0],r=this._keyPositions[1],n=this._keyPositions[2],o=this._keyPositions[3],s=ei.Math.geoLerp(i,r,.5,this._keyPositions[4]),a=ei.Math.geoLerp(n,o,.5,this._keyPositions[5]),l=ei.Math.geoLerp(s,a,.1,this._keyPositions[6]);ei.Math.Bezier.bezier2(i,l,r,19,this._bottomCurcePositions);const h=ei.Math.geoDistance(i,r),c=r,u=n,p=ei.Math.geoLerp(s,a,.3,this._keyPositions[7]),d=ei.Math.hpr(c,u,this._hpr)[0],m=ei.Math.geoMove(u,Math.PI+d,.1*h,this._keyPositions[8]),f=ei.Math.geoMove(m,d-.5*Math.PI,.04*h,this._keyPositions[9]),g=ei.Math.geoMove(m,d+.5*Math.PI,.04*h,this._keyPositions[10]),A=ei.Math.geoLerp(f,g,-.5,this._keyPositions[11]),y=ei.Math.geoLerp(f,g,1.5,this._keyPositions[12]),v=ei.Math.geoLerp(f,p,.5,this._keyPositions[13]),C=ei.Math.geoLerp(g,c,.5,this._keyPositions[14]),_=(ei.Math.geoLerp(v,C,.3,this._keyPositions[15]),ei.Math.geoLerp(v,C,1.3,this._keyPositions[16]));ei.Math.Bezier.bezier2(c,_,g,19,this._rightArrowRightPositions);const b=ei.Math.geoLerp(s,a,.3,this._keyPositions[17]),w=o,P=i,S=ei.Math.hpr(P,w,this._hpr)[0],x=ei.Math.geoMove(w,Math.PI+S,.1*h,this._keyPositions[18]),B=ei.Math.geoMove(x,S-.5*Math.PI,.04*h,this._keyPositions[19]),M=ei.Math.geoMove(x,S+.5*Math.PI,.04*h,this._keyPositions[20]),E=ei.Math.geoLerp(B,M,-.5,this._keyPositions[21]),T=ei.Math.geoLerp(B,M,1.5,this._keyPositions[22]),O=ei.Math.geoLerp(B,P,.5,this._keyPositions[23]),L=ei.Math.geoLerp(M,b,.5,this._keyPositions[24]),D=ei.Math.geoLerp(O,L,-.3,this._keyPositions[25]);ei.Math.geoLerp(O,L,.7,this._keyPositions[26]);ei.Math.Bezier.bezier3(f,r,i,M,19,this._leftArrowRightPositions),ei.Math.Bezier.bezier2(B,D,P,19,this._leftArrowLeftPositions),this._polygonPositions.length=0,this._bottomCurcePositions.forEach((e=>{this._polygonPositions.push(e[0],e[1])})),this._rightArrowRightPositions.forEach((e=>this._polygonPositions.push(e[0],e[1]))),this._polygonPositions.push(y[0],y[1]),this._polygonPositions.push(u[0],u[1]),this._polygonPositions.push(A[0],A[1]),this._leftArrowRightPositions.forEach((e=>this._polygonPositions.push(e[0],e[1]))),this._polygonPositions.push(T[0],T[1]),this._polygonPositions.push(w[0],w[1]),this._polygonPositions.push(E[0],E[1]),this._leftArrowLeftPositions.forEach((e=>this._polygonPositions.push(e[0],e[1]))),this._polygon.positions=this._polygonPositions,this._polygon.height=e[0][2],this._polygonShow=!0})))}}wf.registerType(wf,"GeoDoubleArrow");const Pf=wf,Sf=new Array(360).fill(0).map((e=>[0,0,0])),xf=[];class Bf extends yf{constructor(e,t){super(e,t),this._onlyMove=!0,this._fixedPositionsNum=2,this._polygonPositions=new Array(4).fill(0).map((e=>[0,0,0])),this._pgPositions=[],this._nextPosition=[0,0,0],this.disposers.push(Js.watch((()=>({ps:[...this.positions.map((e=>[...e]))],rotation:this.rotation})),(()=>{const{positions:e,rotation:t}=this;if(e.length<2)return void(this._polygonShow=!1);const i=e,r=Math.min,n=Math.max,o=i[0][2];if(ei.Math.geoDistance(i[0],i[1])<=0)return;const s=[.5*(i[0][0]+i[1][0]),.5*(i[0][1]+i[1][1]),.5*(i[0][2]+i[1][2])],a=[r(i[0][0],i[1][0]),r(i[0][1],i[1][1]),o],l=[n(i[0][0],i[1][0]),r(i[0][1],i[1][1]),o],h=[n(i[0][0],i[1][0]),n(i[0][1],i[1][1]),o],c=[r(i[0][0],i[1][0]),n(i[0][1],i[1][1]),o];Sf.length=0,Sf.push(a,l,h,c);for(let e of Sf){const i=ei.Math.geoDistance(s,e),r=ei.Math.hpr(s,e);r&&ei.Math.geoMove(s,r[0]+=t,i,e)}xf.length=0,Sf.forEach((e=>{xf.push(e[0],e[1])})),this._polygon.positions=xf,this._polygon.height=o,this._polygonShow=!0})))}}Bf.defaultOptions={rotation:0},Bf.registerType(Bf,"GeoRectangle");const Mf=Bf,Ef=new Array(360).fill(0).map((e=>[0,0,0])),Tf=[];class Of extends yf{constructor(e,t){super(e,t),this._onlyMove=!0,this._fixedPositionsNum=2,this._polygonPositions=new Array(4).fill(0).map((e=>[0,0,0])),this._pgPositions=[],this._nextPosition=[0,0,0],this.disposers.push(Js.watch((()=>({positions:[...this.positions.map((e=>[...e]))],rotation:this.rotation,width:this.width,height:this.height})),(({positions:e,rotation:t,width:i,height:r})=>{if(e.length<=0)return void(this._polygonShow=!1);const n=e[0];Ef.length=0,ei.Math.geoMove(n,t,.5*i,this._nextPosition),ei.Math.geoMove(this._nextPosition,t-.5*Math.PI,.5*r,this._nextPosition),Ef.push([...this._nextPosition]),ei.Math.geoMove(n,t,.5*-i,this._nextPosition),ei.Math.geoMove(this._nextPosition,t-.5*Math.PI,.5*r,this._nextPosition),Ef.push([...this._nextPosition]),ei.Math.geoMove(n,t,.5*-i,this._nextPosition),ei.Math.geoMove(this._nextPosition,t+.5*Math.PI,.5*r,this._nextPosition),Ef.push([...this._nextPosition]),ei.Math.geoMove(n,t,.5*i,this._nextPosition),ei.Math.geoMove(this._nextPosition,t+.5*Math.PI,.5*r,this._nextPosition),Ef.push([...this._nextPosition]),Tf.length=0,Ef.forEach((e=>{Tf.push(e[0],e[1])})),this._polygon.positions=Tf,this._polygon.height=e[0][2],this._polygonShow=!0})))}}Of.defaultOptions={rotation:0,width:2e5,height:1e5},Of.registerType(Of,"GeoRectangle2");const Lf=Of,Df=new Array(360).fill(0).map((e=>[0,0,0])),If=[];class Rf extends yf{constructor(e,t){super(e,t),this._onlyMove=!0,this._fixedPositionsNum=2,this.disposers.push(Js.watch((()=>({positions:[...this.positions.map((e=>[...e]))],holeRadius:this.holeRadius})),(({positions:e,holeRadius:t})=>{if(e.length<2)return void(this._polygonShow=!1);const i=ei.Math.geoDistance(e[0],e[1]);if(!ei.Math.hpr(e[0],e[1]))return;for(let t=0;t<360;t++)ei.Math.geoMove(e[0],t*Math.PI/180,i,Df[t]);if(If.length=0,Df.forEach((e=>{If.push(e[0],e[1])})),this._polygon.positions=If,this.holeRadius>0&&this.holeRadius<i){for(let t=0;t<360;t++)ei.Math.geoMove(e[0],t*Math.PI/180,this.holeRadius,Df[t]);If.length=0,Df.forEach((e=>{If.push(e[0],e[1])})),this._polygon.holePositions=If}this._polygon.height=e[0][2],this._polygonShow=!0})))}}Rf.defaultOptions={holeRadius:0},Rf.registerType(Rf,"GeoCircle");const Hf=Rf,Ff=new Array(360).fill(0).map((e=>[0,0,0])),Nf=[];class Qf extends yf{constructor(e,t){super(e,t),this._onlyMove=!0,this._fixedPositionsNum=1,this.disposers.push(Js.watch((()=>({positions:[...this.positions.map((e=>[...e]))],radius:this.radius,holeRadius:this.holeRadius,slice:this.slice})),(({positions:e,radius:t,holeRadius:i,slice:r})=>{if(e.length<=0)return void(this._polygonShow=!1);const n=t;if(!(n<=0||r<=2)){for(let t=0;t<r;t++)ei.Math.geoMove(e[0],t*Math.PI/180,n,Ff[t]);if(Nf.length=0,Ff.forEach((e=>{Nf.push(e[0],e[1])})),this._polygon.positions=Nf,i>0&&i<n){for(let t=0;t<r;t++)ei.Math.geoMove(e[0],t*Math.PI/180,this.holeRadius,Ff[t]);Nf.length=0,Ff.forEach((e=>{Nf.push(e[0],e[1])})),this._polygon.holePositions=Nf}this._polygon.height=e[0][2],this._polygonShow=!0}})))}}Qf.defaultOptions={radius:2e5,holeRadius:0,slice:360},Qf.registerType(Qf,"GeoCircle2");const kf=Qf;class Uf extends yf{constructor(e,t){super(e,t),this._pgPositions=[],this.disposers.push(Js.watch((()=>[...this.positions.map((e=>[...e]))]),(e=>{e.length<=1||(this._pgPositions.length=0,e.forEach((e=>{this._pgPositions.push(e[0],e[1])})),this._polygon.positions=this._pgPositions,this._polygon.height=e[0][2])})))}}Uf.registerType(Uf,"GeoPolygon");const jf=Uf;class Gf extends u.Z{constructor(e,t){super(e,t),this.disposers.push(cf.Interaction.InteractionProperty.registerPositionEditing(this._earth,this,{positionEditingProperty:"editing"})),this.disposers.push(cf.Interaction.InteractionProperty.registerPositionPicking(this._earth,this,{positionPickingProperty:"creating"})),this._pin=new GVOL.Obj.Pin(e),this.disposers.push((()=>this._pin=this._pin&&this._pin.destroy())),this.disposers.push(Js.watch((()=>{this._pin.position=[...this.position],this._pin.viewDistance=this.viewDistance,this._pin.scale=this.scale,this._pin.near=this.near,this._pin.far=this.far,this._pin.disableDepthTestDistance=this.disableDepthTestDistance,this._pin.enabled=this.enabled,this._pin.cameraAttached=this.cameraAttached,this._pin.attachedPathGuid=this.attachedPathGuid}))),this.disposers.push(Js.bind(this,"cameraAttached",this,"_pin.cameraAttached")),this._div=document.createElement("div"),this._div.id=this._pin.guid,this._div.innerHTML=this.innerHTML,this._div.style.position="absolute",this._div.style.pointerEvents="none";let i=this._pin;this.disposers.push(Js.watch((()=>[...i.winPos]),(e=>{this._div.style.left=e[0]+"px",this._div.style.bottom=e[3]+"px"}))),e.czm.viewer.container.appendChild(this._div),this.disposers.push(Js.watch((()=>({cameraPosition:[...e.camera.position],near:this.near,far:this.far,position:[...this.position],enabled:this.enabled})),(e=>{let t=ei.Math.distance([e.position,e.cameraPosition]);e.enabled&&e.near<=t&&t<=e.far?this._div.style.display="block":this._div.style.display="none"}))),this._pin.show=!1,this.defaultImgUrl=function(){return"./assets/dialog.png"},this.innerHTML="<div\n        style=\"height:50px;width:100px;left:-76px;\n        bottom:0px;position: absolute;color: white;\n        background-size: 100% 100%;padding: 5px;\n        border-radius: 5px;cursor:pointer;\n        background-image:url('"+this.defaultImgUrl()+"');\">\n    标记文字\n    </div>",this.disposers.push(Js.watch((()=>{this._div.innerHTML=this.innerHTML})))}flyTo(){this._pin.flyTo()}destroy(){return this._div&&this._div.parentNode.removeChild(this._div),super.destroy()}}Gf.defaultOptions={position:[0,0,0],viewDistance:100,scale:1,near:0,cameraAttached:!1,attachedPathGuid:"",far:Number.MAX_VALUE,disableDepthTestDistance:Number.MAX_VALUE,show:!1,innerHTML:"",defaultImgUrl:Function},Gf.registerType(Gf,"GeoPin");const zf=Gf;class Yf extends yf{constructor(e,t){super(e,t),this._onlyMove=!0,this._fixedPositionsNum=2,this._polygonPositions=[],this._hpr=[0,0,0],this.disposers.push(Js.watch((()=>[...this.positions.map((e=>[...e]))]),(e=>{if(e.length<2)return void(this._polygonShow=!1);this._polygonPositions.length=0,this._polygonPositions.push(e[0][0],e[1][1]),this._polygonPositions.push(e[0][0],e[0][1]),this._polygonPositions.push(e[1][0],e[0][1]),this._polygonPositions.push(e[1][0],.5*(e[0][1]+e[1][1]));const t=e[1][0]-e[0][0];this._polygonPositions.push(e[0][0]+.01*t,.5*(e[0][1]+e[1][1])),this._polygonPositions.push(e[0][0]+.01*t,e[1][1]),this._polygon.positions=this._polygonPositions,this._polygon.height=e[0][2],this._polygonShow=!0})))}}Yf.registerType(Yf,"GeoRightAngleFlag");const Zf=Yf;class Wf extends yf{constructor(e,t){super(e,t),this._onlyMove=!0,this._fixedPositionsNum=2,this._polygonPositions=[],this._hpr=[0,0,0],this._keyPositions=new Array(50).fill(0).map((e=>[0,0,0])),this._bottomCurcePositions=new Array(20).fill(0).map((e=>[0,0,0])),this._sbottomCurcePositions=new Array(20).fill(0).map((e=>[0,0,0])),this._tbottomCurcePositions=new Array(20).fill(0).map((e=>[0,0,0])),this._fbottomCurcePositions=new Array(20).fill(0).map((e=>[0,0,0])),this.disposers.push(Js.watch((()=>[...this.positions.map((e=>[...e]))]),(e=>{if(e.length<2)return void(this._polygonShow=!1);this._keyPositions[0].splice(0,3,...e[0]),this._keyPositions[1].splice(0,3,...e[1]),this._polygonPositions.length=0,this._polygonPositions.push(e[0][0],e[1][1]),this._polygonPositions.push(e[0][0],e[0][1]);const t=e[1][0]-e[0][0],i=[e[0][0],e[0][1],0],r=[.5*(e[0][0]+e[1][0]),e[0][1],0],n=[.5*(e[0][0]+e[1][0])-2*t,e[0][1]-.8*t,0],o=[e[0][0],e[0][1]-t,0],s=ei.Math.geoLerp(i,r,.9,this._keyPositions[4]),a=ei.Math.geoLerp(n,o,.9,this._keyPositions[5]),l=ei.Math.geoLerp(s,a,.2,this._keyPositions[6]);ei.Math.Bezier.bezier2(i,l,r,19,this._bottomCurcePositions),this._bottomCurcePositions.forEach((e=>{this._polygonPositions.push(e[0],e[1])}));const h=[.5*(e[0][0]+e[1][0]),e[0][1],0],c=[e[1][0],e[0][1],0],u=[.5*(e[0][0]+e[1][0])+t,e[0][1]-.1*t+t,0],p=[e[0][0],e[0][1]-t,0],d=ei.Math.geoLerp(h,c,.1,this._keyPositions[7]),m=ei.Math.geoLerp(u,p,.1,this._keyPositions[8]),f=ei.Math.geoLerp(d,m,.2,this._keyPositions[9]);ei.Math.Bezier.bezier2(h,f,c,19,this._sbottomCurcePositions),this._sbottomCurcePositions.forEach((e=>{this._polygonPositions.push(e[0],e[1])})),this._polygonPositions.push(e[1][0],e[0][1]),this._polygonPositions.push(e[1][0],.5*(e[0][1]+e[1][1]));const g=[e[1][0],.5*(e[0][1]+e[1][1]),0],A=[.5*(e[0][0]+e[1][0]),.5*(e[0][1]+e[1][1]),0],y=[e[1][0]-t,.5*(e[0][1]+e[1][1])+.5*t,0],v=[e[1][0]-6*t,.5*(e[0][1]+e[1][1])+2*t,0],C=ei.Math.geoLerp(g,A,.1,this._keyPositions[7]),_=ei.Math.geoLerp(y,v,.1,this._keyPositions[8]),b=ei.Math.geoLerp(C,_,.2,this._keyPositions[9]);ei.Math.Bezier.bezier2(g,b,A,19,this._tbottomCurcePositions),this._tbottomCurcePositions.forEach((e=>{this._polygonPositions.push(e[0],e[1])}));const w=[.5*(e[0][0]+e[1][0]),.5*(e[0][1]+e[1][1]),0],P=[e[0][0]+.01*t,.5*(e[0][1]+e[1][1]),0],S=[.5*(e[0][0]+e[1][0])+5*t,.5*(e[0][1]+e[1][1])-1.1*t,0],x=[e[0][0]+1.01*t,.5*(e[0][1]+e[1][1])-t,0],B=ei.Math.geoLerp(w,P,.9,this._keyPositions[4]),M=ei.Math.geoLerp(S,x,.9,this._keyPositions[5]),E=ei.Math.geoLerp(B,M,.2,this._keyPositions[6]);ei.Math.Bezier.bezier2(w,E,P,19,this._fbottomCurcePositions),this._fbottomCurcePositions.forEach((e=>{this._polygonPositions.push(e[0],e[1])})),this._polygonPositions.push(e[0][0]+.01*t,e[1][1]),this._polygon.positions=this._polygonPositions,this._polygon.height=e[0][2],this._polygonShow=!0})))}}Wf.registerType(Wf,"GeoCurveFlag");const Xf=Wf;class Jf extends pf{constructor(e,t){super(e,t),this.disposers.push(Js.watch((()=>[...this.positions.map((e=>[...e]))]),(e=>{this._polyline.positions=e})))}}Jf.registerType(Jf,"GeoPolyline");const Kf=Jf;class Vf extends pf{constructor(e,t){super(e,t),this._onlyMove=!0,this._fixedPositionsNum=3,this._polylinePositions=new Array(360).fill(0).map((e=>[0,0,0])),this._pgPositions=[],this._nextPosition=[0,0,0],this.disposers.push(Js.watch((()=>[...this.positions.map((e=>[...e]))]),(e=>{if(e.length<3)return void(this._polylineShow=!1);const t=ei.Math.geoDistance(e[0],e[1]);this._polylinePositions.length=0,this._polylinePositions.push([...e[1]]);const i=ei.Math.hpr(e[0],e[1]),r=ei.Math.hpr(e[0],e[2]);var n=0;n=i[0]>=r[0]?(i[0]-r[0])*(180/Math.PI):(i[0]-r[0]+2*Math.PI)*(180/Math.PI);for(var o=0;o<n;o++)ei.Math.geoMove(e[0],i[0]-=Math.PI/180,t,this._nextPosition),this._polylinePositions.push([...this._nextPosition]);this._polyline.positions=this._polylinePositions,this._polylineShow=!0})))}}Vf.registerType(Vf,"GeoArc");const qf=Vf;class $f extends pf{constructor(e,t){super(e,t),this._onlyMove=!0,this._fixedPositionsNum=3,this._bezierPositions=new Array(20).fill(0).map((e=>[0,0,0])),this.disposers.push(Js.watch((()=>[...this.positions.map((e=>[...e]))]),(e=>{e.length<3||ei.Math.hasSamePosition(e)?this._polylineShow=!1:(ei.Math.Bezier.bezier2(e[0],e[1],e[2],19,this._bezierPositions),this._polyline.positions=this._bezierPositions,this._polylineShow=!0)})))}}$f.registerType($f,"GeoBezier2");const eg=$f;class tg extends pf{constructor(e,t){super(e,t),this._onlyMove=!0,this._fixedPositionsNum=4,this._bezierPositions=new Array(20).fill(0).map((e=>[0,0,0])),this.disposers.push(Js.watch((()=>[...this.positions.map((e=>[...e]))]),(e=>{e.length<4||ei.Math.hasSamePosition(e)?this._polylineShow=!1:(ei.Math.Bezier.bezier3(e[0],e[1],e[2],e[3],19,this._bezierPositions),this._polyline.positions=this._bezierPositions,this._polylineShow=!0)})))}}tg.registerType(tg,"GeoBezier3");const ig=tg;class rg extends yf{constructor(e,t){super(e,t),this._onlyMove=!0,this._fixedPositionsNum=3,this._polygonPositions=new Array(360).fill(0).map((e=>[0,0,0])),this._pgPositions=[],this._nextPosition=[0,0,0],this.disposers.push(Js.watch((()=>[...this.positions.map((e=>[...e]))]),(e=>{if(e.length<3)return void(this._polygonShow=!1);const t=ei.Math.geoDistance(e[0],e[1]);this._polygonPositions.length=0,this._polygonPositions.push([...e[0]]),this._polygonPositions.push([...e[1]]);const i=ei.Math.hpr(e[0],e[1]),r=ei.Math.hpr(e[0],e[2]);if(!i||!r)return;var n=0;n=i[0]>=r[0]?(i[0]-r[0])*(180/Math.PI):(i[0]-r[0]+2*Math.PI)*(180/Math.PI);for(var o=0;o<n;o++)ei.Math.geoMove(e[0],i[0]-=Math.PI/180,t,this._nextPosition),this._polygonPositions.push([...this._nextPosition]);this._pgPositions.length=0,this._polygonPositions.forEach((e=>{this._pgPositions.push(e[0],e[1])})),this._polygon.positions=this._pgPositions,this._polygon.height=e[0][2],this._polygonShow=!0})))}}rg.registerType(rg,"GeoSector");const ng=rg;class og extends yf{constructor(e,t){super(e,t),this._onlyMove=!0,this._fixedPositionsNum=1,this._polygonPositions=new Array(360).fill(0).map((e=>[0,0,0])),this._pgPositions=[],this._nextPosition=[0,0,0],this.disposers.push(Js.watch((()=>({positions:[...this.positions.map((e=>[...e]))],radius:this.radius,startAngle:this.startAngle,angle:this.angle})),(({positions:e,radius:t,startAngle:i,angle:r})=>{if(e.length<=0)return void(this._polygonShow=!1);if(r<=0||t<=0)return;this._polygonPositions.length=0,this._polygonPositions.push([...e[0]]);const n=Math.PI/180;for(let t=0;t<r;++t)ei.Math.geoMove(e[0]);const o=e[0];let s=i;const a=i+r;for(;s<a;)ei.Math.geoMove(o,s,t,this._nextPosition),this._polygonPositions.push([...this._nextPosition]),s+=n;ei.Math.geoMove(o,a,t,this._nextPosition),this._polygonPositions.push([...this._nextPosition]),this._pgPositions.length=0,this._polygonPositions.forEach((e=>{this._pgPositions.push(e[0],e[1])})),this._polygon.positions=this._pgPositions,this._polygon.height=e[0][2],this._polygonShow=!0})))}}og.defaultOptions={radius:2e5,startAngle:0,angle:60*Math.PI/180},og.registerType(og,"GeoSector2");const sg=og;class ag extends pf{constructor(e,t){super(e,t),this._leftArrowPosition=[0,0,0],this._rightArrowPosition=[0,0,0],this._leftArrowPosition2=[0,0,0],this._rightArrowPosition2=[0,0,0],this.disposers.push(Js.watch((()=>[...this.positions.map((e=>[...e]))]),(e=>{const t=e.length;ei.Math.distance(e);if(t<2||ei.Math.hasSamePosition(e))this._polylineShow=!1;else{if(t>2)for(var i=t-1;i>0;i--){i>1&&(i%2==0?e[i][0]=e[i-1][0]:e[i][1]=e[i-1][1]);const t=ei.Math.hpr(e[i],e[i-1]);if(!t)return;ei.Math.geoMove(e[i],t[0]+Math.PI/6,.1*ei.Math.distance(e[i-1],e[i]),this._leftArrowPosition),ei.Math.geoMove(e[i],t[0]-Math.PI/6,.1*ei.Math.distance(e[i-1],e[i]),this._rightArrowPosition),e.push([...e[i]]),e.push([...this._leftArrowPosition]),e.push([...e[i]]),e.push([...this._rightArrowPosition]),e.push([...e[i]])}this._polyline.positions=e,this._polylineShow=!0}})))}}ag.registerType(ag,"GeoParallelSearch");const lg=ag;class hg extends pf{constructor(e,t){super(e,t),this._positions=[],this.disposers.push(Js.watch((()=>({positions:[...this.positions.map((e=>[...e]))],slices:this.slices})),(({positions:e,slices:t})=>{e.length<2?this._polylineShow=!1:(this._positions.length=0,ei.Math.interpolatePositions(e,t,!1,this._positions),this._polyline.positions=this._positions,this._polylineShow=!0)})))}}hg.defaultOptions={slices:100},hg.registerType(hg,"GeoCurve");const cg={GeoSectorSearch:mf,GeoPolylineArrow:gf,GeoTriFlag:Cf,GeoCurveArrow:bf,GeoDoubleArrow:Pf,GeoRectangle:Mf,GeoRectangle2:Lf,GeoCircle:Hf,GeoCircle2:kf,GeoPolygon:jf,GeoPin:zf,GeoRightAngleFlag:Zf,GeoCurveFlag:Xf,GeoPolyline:Kf,GeoArc:qf,GeoBezier2:eg,GeoBezier3:ig,GeoSector:ng,GeoSector2:sg,GeoParallelSearch:lg,GeoCurve:hg};class ug extends hr{constructor(e,t){super(e,t),this._onlyMove=!1,this._fixedPositionsNum=void 0,Js.extend(this,{_polygonShow:!0}),this._polygon=new GVOL.Obj.Polygon(e),this.disposers.push((()=>{this._polygon=this._polygon&&this._polygon.destroy()})),this._polygon.show=this._polygonShow&&this.show,cf.Interaction.Picking.registerPickingParent(this._polygon,this);const i=()=>{this._polygon.show=this._polygonShow&&this.show,this._polygon.width=this.width,this._polygon.color=this.color,this._polygon.ground=this.ground,this._polygon.outline.width=this.outlineWidth,this._polygon.outline.color=this.outlineColor,this._polygon.outline.show=this.outlineShow,this._polygon.depthTest=this.depthTest};i(),this.disposers.push(Js.watch((()=>({show:this._polygonShow&&this.show,width:this.width,color:[...this.color],ground:this.ground,outlineWidth:this.outlineWidth,outlineColor:this.outlineColor,outlineShow:this.outlineShow,depthTest:this.depthTest})),(()=>i())))}get onlyMove(){return this._onlyMove}get fixedPositionsNum(){return this._fixedPositionsNum}flyTo(){this._polygon.flyTo()}}ug.defaultOptions={positions:[],show:!0,color:[0,1,0,.1],outlineWidth:2,outlineColor:[0,1,0,1],outlineShow:!0,depthTest:!1};const pg=ug;function dg(e,t,i,r,n,o,s){let a=e*t,l=.7*a,h=Cesium.Cartesian3.distance(n[0],n[1]),c=!1;h<l&&(l=h,a=l/.7,c=!0);let u=ei.Math.hpr(o[1],o[0],[0,0,0])[0],p=ei.Math.geoMove(o[1],u,l,[0,0,0]),d=ei.Math.geoMove(o[1],u,a,[0,0,0]),m=ei.Math.hpr(p,o[1],[0,0,0])[0],f=ei.Math.hpr(d,o[1],[0,0,0])[0];return s[0]=ei.Math.geoMove(p,m-Cesium.Math.PI_OVER_TWO,i,[0,0,0]),s[4]=ei.Math.geoMove(p,m+Cesium.Math.PI_OVER_TWO,i,[0,0,0]),s[1]=ei.Math.geoMove(d,f-Cesium.Math.PI_OVER_TWO,i*r,[0,0,0]),s[3]=ei.Math.geoMove(d,f+Cesium.Math.PI_OVER_TWO,i*r,[0,0,0]),s[2]=[...o[1]],c}var mg=i(5108);class fg extends pg{constructor(e,t){super(e,t),this._onlyMove=!0,this._polygonPositions=[],this.a={b:{c:5},bb:5},Js.extend(this,{a:this.a},{a:Js.reaction.observable.ref}),this.disposers.push(Js.watch((()=>this.a),(()=>{mg.log("this.a的数据改变了")}))),this.disposers.push(Js.watch((()=>({minWidthScale:this.minWidthScale,dynamicWidthScale:this.dynamicWidthScale,arrowMaxHeightScale:this.arrowMaxHeightScale,arrowWingWidthScale:this.arrowWingWidthScale})),(()=>{this.change(this.positions,this.minWidthScale,this.dynamicWidthScale,this.arrowMaxHeightScale,this.arrowWingWidthScale)}))),this.disposers.push(Js.watch((()=>[...this.positions.map((e=>[...e]))]),(()=>{this.change(this.positions,this.minWidthScale,this.dynamicWidthScale,this.arrowMaxHeightScale,this.arrowWingWidthScale)})))}change(e,t,i,r,n){let o=[...e];const s=o.length;if(s<2||yg(o[s-1],o[s-2]))return;let a=o.map((e=>Cesium.Cartesian3.fromRadians(...e,null,new Cesium.Cartesian3)));this._polygonPositions.length=0;let l,h,c,u,p,d,m,f=[0,0,0],g=new Array(s).fill(0).map(((e,t)=>(l=o[t-1],h=o[t+1],c=o[t],u=l?ei.Math.hpr(c,l,f)[0]:0,p=h?ei.Math.hpr(c,h,f)[0]:0,d=u&&p?2:1,m=(u+p)/d,m=u>p?m:m-Cesium.Math.PI,m<0?m+Cesium.Math.TWO_PI:m))),A=0,y=[];a.forEach(((e,t)=>{l=a[t-1]||e,h=e,A+=Cesium.Cartesian3.distance(l,h),y.push(A)})),y=y.map((e=>A-e));const v=(i/=2)*A,C=(t/=2)*A;let _=new Array(y.length).fill(0).map(((e,t)=>C+v*y[t]/A)),b=[],w=dg(A,r,C,n,a.slice(-2),o.slice(-2),b),P=[],S=[];o.forEach(((e,t)=>{0==t||t==s-1?(P.push(ei.Math.geoMove(e,g[t]+Cesium.Math.PI_OVER_TWO,_[t])),S.push(ei.Math.geoMove(e,g[t]-Cesium.Math.PI_OVER_TWO,_[t]))):(P.push(ei.Math.geoMove(e,g[t]-Cesium.Math.PI,_[t])),S.push(ei.Math.geoMove(e,g[t],_[t])))})),P.pop(),S.pop(),w&&(P.pop(),S.pop()),P.push(b[0]),S.push(b[b.length-1]);let x=ei.Math.interpolatePositions(P,20*s,!1,[]),B=ei.Math.interpolatePositions(S,20*s,!1,[]);x.forEach((e=>{this._polygonPositions.push(e[0],e[1])})),b.forEach((e=>{this._polygonPositions.push(e[0],e[1])}));for(let e=B.length-1;e>=0;e--)this._polygonPositions.push(B[e][0],B[e][1]);this._polygon.positions=this._polygonPositions,this._polygon.height=o[0][2],this._polygonShow=!0}}fg.registerType(fg,"GeoArrow"),fg.defaultOptions={minWidthScale:.06,dynamicWidthScale:.1,arrowMaxHeightScale:.15,arrowWingWidthScale:2};const gg=fg;let Ag;function yg(e,t){if(!e||!t)return!1;Ag=0;for(let i=0;i<e.length;i++)if(Ag=e[i]==t[i]?0:1,Ag>0)return!1;return!0}class vg extends pg{constructor(e,t){super(e,t),this._onlyMove=!0,this._polygonPositions=[],this._fixedPositionsNum=2,this.disposers.push(Js.watch((()=>({showType:this.showType})),(()=>this.changeShowType()))),this.disposers.push(Js.watch((()=>({minWidthScale:this.minWidthScale,dynamicWidthScale:this.dynamicWidthScale,arrowMaxHeightScale:this.arrowMaxHeightScale,arrowWingWidthScale:this.arrowWingWidthScale})),(()=>{this.change(this.positions,this.minWidthScale,this.dynamicWidthScale,this.arrowMaxHeightScale,this.arrowWingWidthScale)}))),this.disposers.push(Js.watch((()=>[...this.positions.map((e=>[...e]))]),(()=>{this.change(this.positions,this.minWidthScale,this.dynamicWidthScale,this.arrowMaxHeightScale,this.arrowWingWidthScale)})))}changeShowType(){let e=Cg[this.showType];Object.keys(e).forEach((t=>{this[t]=e[t]}))}change(){if(this.positions.length<2||function(e,t){if(!e||!t)return!1;bg=0;for(let i=0;i<e.length;i++)if(bg=e[i]==t[i]?0:1,bg>0)return!1;return!0}(this.positions[0],this.positions[1]))return;let e=this.positions.map((e=>Cesium.Cartesian3.fromRadians(...e,null,new Cesium.Cartesian3)));this._polygonPositions.length=0;let t=ei.Math.geoDistance(...this.positions),i=ei.Math.hpr(...this.positions)[0],r=ei.Math.geoMove(this.positions[0],i,t*(1-this.arrowMaxHeightScale)),n=(this.dynamicWidthScale+this.minWidthScale)/2,o=this.minWidthScale/2,s=[ei.Math.geoMove(this.positions[0],i+Cesium.Math.PI_OVER_TWO,t*n),ei.Math.geoMove(this.positions[0],i-Cesium.Math.PI_OVER_TWO,t*n)],a=ei.Math.hpr(r,this.positions[1])[0],l=[ei.Math.geoMove(r,a+Cesium.Math.PI_OVER_TWO,t*o),ei.Math.geoMove(r,a-Cesium.Math.PI_OVER_TWO,t*o)],h=[ei.Math.hpr(s[0],l[0])[0],ei.Math.hpr(s[1],l[1])[0]],c=[ei.Math.geoDistance(l[0],s[0]),ei.Math.geoDistance(l[1],s[1])],u=[[],[]];for(let e=0;e<20;e++)u[0].push(ei.Math.geoMove(s[0],h[0],e*c[0]/20)),u[1].push(ei.Math.geoMove(s[1],h[1],e*c[1]/20));if(this.tail){let e=ei.Math.geoMove(this.positions[0],i,this.tailHeightScale*t);this._polygonPositions.push(e[0],e[1])}u[0].forEach((e=>{this._polygonPositions.push(e[0],e[1])}));let p=[];dg(t,this.arrowMaxHeightScale,this.minWidthScale/2,this.arrowWingWidthScale,e,this.positions,p);for(let e=p.length-1;e>=0;e--)this._polygonPositions.push(p[e][0],p[e][1]);for(let e=u[1].length-1;e>=0;e--)this._polygonPositions.push(u[1][e][0],u[1][e][1]);this._polygon.positions=this._polygonPositions,this._polygon.height=this.positions[0][2],this._polygonShow=!0}}const Cg={forkedTail:{minWidthScale:.06,dynamicWidthScale:.1,arrowMaxHeightScale:.15,arrowWingWidthScale:2,tail:!0},cusp:{minWidthScale:.06,dynamicWidthScale:.1,arrowMaxHeightScale:.15,arrowWingWidthScale:2,tail:!1},parallel:{minWidthScale:.12,dynamicWidthScale:0,arrowMaxHeightScale:.08,arrowWingWidthScale:2,tail:!1}};vg.defaultOptions={showType:"forkedTail",positions:[],tailHeightScale:.15,...Cg.forkedTail},vg.registerType(vg,"GeoSimpleArrow");const _g=vg;let bg;let wg=new Cesium.Cartesian3;class Pg extends u.Z{constructor(e,t){super(e,t),this.disposers.push(cf.Interaction.InteractionProperty.registerPositionEditing(this._earth,this,{positionEditingProperty:"positionEditing"})),this.disposers.push(cf.Interaction.InteractionProperty.registerPositionPicking(this._earth,this,{positionPickingProperty:"creating"})),this.disposers.push(cf.Interaction.InteractionProperty.registerRotationEditing(this._earth,this,{rotationEditingProperty:"rotationEditing"})),this._viewer=e.czm.viewer;let i=new Cesium.Cartesian3;Cesium.Cartesian3.fromRadians(...this.position,null,i),this._modelMatrix=Cesium.Transforms.eastNorthUpToFixedFrame(i),this._updateCallback=()=>{},this._particleSystem=new Cesium.ParticleSystem({image:this.image,show:this.show&&this.enabled,startColor:new Cesium.Color(this.startColor[0],this.startColor[1],this.startColor[2],this.startColor[3]),endColor:new Cesium.Color(this.endColor[0],this.endColor[1],this.endColor[2],this.endColor[3]),startScale:this.startScale,endScale:this.endScale,minimumParticleLife:this.minimumParticleLife,maximumParticleLife:this.maximumParticleLife,minimumSpeed:this.minimumSpeed,maximumSpeed:this.maximumSpeed,imageSize:new Cesium.Cartesian2(this.particleSize,this.particleSize),emissionRate:this.emissionRate,lifetime:16,modelMatrix:this._modelMatrix,emitterModelMatrix:Cesium.Matrix4.IDENTITY,emitter:new Cesium.CircleEmitter(2),updateCallback:this._updateCallback}),this._viewer.scene.primitives.add(this._particleSystem),this.disposers.push((()=>{this._particleSystem&&(this._viewer.scene.primitives.remove(this._particleSystem),this._particleSystem=void 0)})),this.disposers.push(Js.watch((()=>({startColor:[...this.startColor],endColor:[...this.endColor],image:this.image,emissionRate:this.emissionRate,maximumSpeed:this.maximumSpeed,minimumSpeed:this.minimumSpeed,minimumImageSize:this.minimumImageSize,maximumImageSize:this.maximumImageSize,minimumParticleLife:this.minimumParticleLife,maximumParticleLife:this.maximumParticleLife,show:this.show&&this.enabled})),(()=>this.update()))),this.disposers.push(Js.watch((()=>({image:this.image})),(()=>this.updateParticleSystem()))),this.disposers.push(Js.watch((()=>({particleSize:this.particleSize})),(()=>this.updateParticleSize()))),this.disposers.push(Js.watch((()=>[...this.position,...this.rotation]),(()=>this.updateMatrix()))),this.disposers.push(Js.watch((()=>({gravity:this.gravity})),(()=>{this._particleSystem.updateCallback=this.updateGravity(this.gravity)}))),this.disposers.push(Js.watch((()=>({emitterRadius:this.emitterRadius,emitterAngle:this.emitterAngle,emitterType:this.emitterType})),(()=>this.updateEmitter())))}toBeFountain(){let e=Sg.fountain;this.changeShowType(e)}toBeSmoke(){let e=Sg.smoke;this.changeShowType(e)}changeShowType(e){Object.keys(e).forEach((t=>{this[t]=e[t]}))}updateMatrix(){let e=new Cesium.Cartesian3,t=new Cesium.Matrix4;if(Cesium.Cartesian3.fromRadians(...this.position,null,e),!e.x&&!e.y&&!e.z)return;this._modelMatrix=Cesium.Transforms.eastNorthUpToFixedFrame(e);let i=new Cesium.HeadingPitchRoll(...this.rotation),r=Cesium.Quaternion.fromHeadingPitchRoll(i,new Cesium.Quaternion);t=Cesium.Matrix4.fromTranslationQuaternionRotationScale(Cesium.Cartesian3.ZERO,r,new Cesium.Cartesian3(1,1,1),t),Cesium.Matrix4.multiply(this._modelMatrix,t,this._modelMatrix),this._particleSystem.modelMatrix=this._modelMatrix}updateParticleSize(){this._particleSystem.imageSize?(this._particleSystem.imageSize.x=this.particleSize,this._particleSystem.imageSize.y=this.particleSize,this._particleSystem.maximumImageSize.x=this.particleSize,this._particleSystem.maximumImageSize.y=this.particleSize,this._particleSystem.minimumImageSize.x=this.particleSize,this._particleSystem.minimumImageSize.y=this.particleSize):this._particleSystem.imageSize=new Cesium.Cartesian2(this.particleSize,this.particleSize)}updateParticleSystem(){this._particleSystem&&(this._viewer.scene.primitives.remove(this._particleSystem),this._particleSystem=void 0),this._particleSystem=new Cesium.ParticleSystem({image:this.image,show:this.show&&this.enabled,startColor:{red:this.startColor[0],green:this.startColor[1],blue:this.startColor[2],alpha:this.startColor[3]},endColor:{red:this.endColor[0],green:this.endColor[1],blue:this.endColor[2],alpha:this.endColor[3]},startScale:this.startScale,endScale:this.endScale,minimumParticleLife:this.minimumParticleLife,maximumParticleLife:this.maximumParticleLife,minimumSpeed:this.minimumSpeed,maximumSpeed:this.maximumSpeed,imageSize:new Cesium.Cartesian2(this.particleSize,this.particleSize),emissionRate:this.emissionRate,lifetime:16,modelMatrix:this._modelMatrix,emitterModelMatrix:Cesium.Matrix4.IDENTITY,emitter:this._emitter,updateCallback:this._updateCallback}),this._viewer.scene.primitives.add(this._particleSystem)}update(){this._particleSystem.startColor={red:this.startColor[0],green:this.startColor[1],blue:this.startColor[2],alpha:this.startColor[3]},this._particleSystem.endColor={red:this.endColor[0],green:this.endColor[1],blue:this.endColor[2],alpha:this.endColor[3]},this._particleSystem.startScale=this.startScale,this._particleSystem.endScale=this.endScale,this._particleSystem.emissionRate=this.emissionRate,this._particleSystem.minimumSpeed=this.minimumSpeed,this._particleSystem.maximumSpeed=this.maximumSpeed,this._particleSystem.minimumParticleLife=this.minimumParticleLife,this._particleSystem.maximumParticleLife=this.maximumParticleLife,this._particleSystem.show=this.show&&this.enabled}updateGravity(e){return this._updateCallback=(t,i)=>{Cesium.Cartesian3.normalize(t.position,wg),Cesium.Cartesian3.multiplyByScalar(wg,e*i,wg),t.velocity=Cesium.Cartesian3.add(t.velocity,wg,t.velocity)}}updateEmitter(){let e;if(e="BoxEmitter"!=this.emitterType?"ConeEmitter"==this.emitterType?this.emitterAngle:this.emitterRadius:new Cesium.Cartesian3(...new Array(3).fill(this.emitterRadius)),!this._particleSystem)return this._emitter=new Cesium[this.emitterType](e),this._emitter;this._particleSystem.emitter=new Cesium[this.emitterType](e),this._emitter=this._particleSystem.emitter}flyTo(){if(this._particleSystem){let e=Math.abs(this._particleSystem.minimumSpeed)>Math.abs(this._particleSystem.maximumSpeed)?Math.abs(this._particleSystem.minimumSpeed):Math.abs(this._particleSystem.maximumSpeed),t=Math.abs(this._particleSystem.minimumParticleLife)>Math.abs(this._particleSystem.maximumParticleLife)?Math.abs(this._particleSystem.minimumParticleLife):Math.abs(this._particleSystem.maximumParticleLife),i=new Cesium.Cartesian3;Cesium.Matrix4.getColumn(this._particleSystem.modelMatrix,3,i);let r=e*t,n=new Cesium.BoundingSphere(i,r);this._viewer.camera.flyToBoundingSphere(n,{duration:2})}}}const Sg={fountain:{gravity:10,minimumSpeed:10,maximumSpeed:15,gravity:-10,emitterRadius:.1,emissionRate:20,startColor:[1,1,1,1],endColor:[1,1,1,0],emitterType:"CircleEmitter",rotation:[0,Cesium.Math.PI_OVER_TWO,0]},smoke:{startColor:[.12549,.69804,.66667,.7],endColor:[1,1,1,0],rotation:[0,0,0],emissionRate:5,gravity:0,minimumParticleLife:2,maximumParticleLife:2,minimumSpeed:1,maximumSpeed:4,emitterRadius:2,emitterType:"CircleEmitter"}};Pg.defaultOptions={show:!0,enabled:!0,position:[1.6988083400554626,.6666896940162155,30],startScale:1,endScale:5,particleSize:25,image:"../../XbsjEarth-Plugins/plottingSymbol2/assets/SampleData/smoke.png",emitterAngle:1,...Sg.smoke},Pg.registerType(Pg,"ParticleSystem");const xg=Pg;let Bg;const Mg=function(){if(!Bg){Bg=document.createElement("canvas"),Bg.width=20,Bg.height=20;var e=Bg.getContext("2d");e.beginPath(),e.arc(8,8,8,0,Cesium.Math.TWO_PI,!0),e.closePath(),e.fillStyle="rgb(255, 255, 255)",e.fill()}return Bg};new Cesium.Cartesian3;class Eg extends u.Z{constructor(e,t){super(e,t),this.disposers.push(cf.Interaction.InteractionProperty.registerPositionEditing(this._earth,this,{positionEditingProperty:"editing"})),this.disposers.push(cf.Interaction.InteractionProperty.registerPositionPicking(this._earth,this,{positionPickingProperty:"creating"})),this._viewer=e.czm.viewer,this._modelMatrix=this._modelMatrix||Cesium.Matrix4.IDENTITY,this._position=new Cesium.Cartesian3,this._particleSystem=new Cesium.ParticleSystem({image:Mg(),show:this.show&&this.enabled,startColor:{red:this.startColor[0],green:this.startColor[1],blue:this.startColor[2],alpha:this.startColor[3]},endColor:{red:this.endColor[0],green:this.endColor[1],blue:this.endColor[2],alpha:0},particleLife:this.particleLife,speed:this.radius/this.particleLife||0,imageSize:new Cesium.Cartesian2(7,7),bursts:[new Cesium.ParticleBurst({time:0,minimum:400,maximum:400})],emissionRate:0,lifetime:this.particleLife+this.burstInterval||2,modelMatrix:this._modelMatrix,emitter:new Cesium.SphereEmitter(.1)}),this._viewer.scene.primitives.add(this._particleSystem),this.disposers.push((()=>{this._particleSystem&&(this._viewer.scene.primitives.remove(this._particleSystem),this._particleSystem=void 0)})),this.disposers.push(Js.watch((()=>({startColor:[...this.startColor],endColor:[...this.endColor],show:this.show&&this.enabled})),(()=>this.updateColor()))),this.disposers.push(Js.watch((()=>({radius:this.radius,particleLife:this.particleLife,burstInterval:this.burstInterval})),(()=>this.updateInitialVelocity()))),this.disposers.push(Js.watch((()=>({position:[...this.position]})),(()=>this.updateModelMatrix())))}updateColor(){this._particleSystem.startColor={red:this.startColor[0],green:this.startColor[1],blue:this.startColor[2],alpha:this.startColor[3]},this._particleSystem.endColor={red:this.endColor[0],green:this.endColor[1],blue:this.endColor[2],alpha:this.endColor[3]},this._particleSystem.show=this.show&&this.enabled}updateModelMatrix(){Cesium.Cartesian3.fromRadians(...this.position,null,this._position),(this._position.x||this._position.y||this._position.z)&&(this._modelMatrix=Cesium.Transforms.eastNorthUpToFixedFrame(this._position),this._particleSystem.modelMatrix=this._modelMatrix)}updateInitialVelocity(){this._initialVelocity=this.radius/this.particleLife,this._particleSystem.lifetime=this.particleLife+this.burstInterval,this._particleSystem.minimumParticleLife=this.particleLife,this._particleSystem.maximumParticleLife=this.particleLife,this._particleSystem.minimumSpeed=this._initialVelocity,this._particleSystem.maximumSpeed=this._initialVelocity}flyTo(){this.boundingSphere=new Cesium.BoundingSphere(this._position,this.radius),this._viewer.camera.flyToBoundingSphere(this.boundingSphere,{duration:2})}}Eg.defaultOptions={show:!0,radius:200,particleLife:.8,burstInterval:1,startColor:[.75,0,.8,1],endColor:[.75,0,.8,0],position:[1.7,.6666896940162155,100]},Eg.registerType(Eg,"ParticleSystemFireWork");const Tg=Eg;class Og extends u.Z{constructor(e,t){super(e,t),this.disposers.push(cf.Interaction.InteractionProperty.registerPositionEditing(this._earth,this,{positionEditingProperty:"positionEditing"})),this.disposers.push(cf.Interaction.InteractionProperty.registerPositionPicking(this._earth,this,{positionPickingProperty:"creating"})),this.disposers.push(cf.Interaction.InteractionProperty.registerRotationEditing(this._earth,this,{rotationEditingProperty:"rotationEditing"})),this._viewer=e.czm.viewer,this._particleSystemList=[],this._modelMatrix=Cesium.Matrix4.clone(Cesium.Matrix4.IDENTITY,new Cesium.Matrix4),this._inverseModelMatrix=Cesium.Matrix4.clone(Cesium.Matrix4.IDENTITY,new Cesium.Matrix4),this._position=new Cesium.Cartesian3,this._colors=[],this.disposers.push((()=>{this._particleSystemList=this._particleSystemList.map((e=>{if(e)return this._viewer.scene.primitives.remove(e),e=void 0})),this._particleSystemList.length=0})),this.disposers.push(Js.watch((()=>[...this.position,...this.rotation]),(()=>this.updateMatrix()))),this.disposers.push(Js.watch((()=>({show:this.show&&this.enabled,color:[...this.colors]})),(()=>this.updateColors()))),this.disposers.push(Js.watch((()=>({emissionRate:this.emissionRate,particleSize:this.particleSize})),(()=>this.updateCommon()))),this.disposers.push(Js.watch((()=>({radius:this.radius,rotate:this.rotate,height:this.height,particleLife:this.particleLife})),(()=>this.update()))),this.disposers.push(Js.watch((()=>this.particleNumber),(()=>{this.update(),this.updateParticleSystemList()}))),this.updateParticleSystemList()}updateCommon(){this._particleSystemList.forEach((e=>{e.emissionRate=this.emissionRate,e.minimumImageSize.x=this.particleSize,e.minimumImageSize.y=this.particleSize,e.maximumImageSize.x=this.particleSize,e.maximumImageSize.y=this.particleSize}))}updateColors(){this._colors.length=0;for(let e=0;e<this.colors.length;e+=4)this._colors.push(new Cesium.Color(this.colors[e],this.colors[e+1],this.colors[e+2],this.colors[e+3]));let e=this._colors.length,t=0;this._particleSystemList.forEach(((i,r)=>{t=r%e,i.startColor=this._colors[t],i.endColor=this._colors[t].withAlpha(0),i.show=this.show&&this.enabled}))}update(){this._radiuStep=this.radius/this.particleLife,this._rotateSpeed=this.rotate/this.particleLife,this._speed=this.height/this.particleLife,this.changeUpdateCallBack()}updateMatrix(){let e=new Cesium.Matrix4;if(Cesium.Cartesian3.fromRadians(...this.position,null,this._position),!this._position.x&&!this._position.y&&!this._position.z)return;this._modelMatrix=Cesium.Transforms.eastNorthUpToFixedFrame(this._position);let t=new Cesium.HeadingPitchRoll(...this.rotation),i=Cesium.Quaternion.fromHeadingPitchRoll(t,new Cesium.Quaternion);e=Cesium.Matrix4.fromTranslationQuaternionRotationScale(Cesium.Cartesian3.ZERO,i,new Cesium.Cartesian3(1,1,1),e),Cesium.Matrix4.multiply(this._modelMatrix,e,this._modelMatrix),this._inverseModelMatrix=Cesium.Matrix4.inverse(this._modelMatrix,this._inverseModelMatrix),this._particleSystemList.forEach(((e,t)=>{e.modelMatrix=this._modelMatrix})),this.changeUpdateCallBack()}changeUpdateCallBack(){this._particleSystemList.forEach(((e,t)=>{e.updateCallback=this.updateCallback(this._radiuStep,this._rotateSpeed,Cesium.Math.TWO_PI*t/this.particleNumber,this._speed,this._inverseModelMatrix,this._modelMatrix)}))}updateCallback(e,t,i,r,n,o){let s=new Cesium.Cartesian3;return(a,l)=>{l=Cesium.Math.clamp(l,0,.05),s=Cesium.Matrix4.multiplyByPoint(n,a.position,s),i+=l*t,i%=Cesium.Math.TWO_PI,s.x+=Math.cos(i)*e*l,s.y+=Math.sin(i)*e*l,s.z-=r*l,a.position=Cesium.Matrix4.multiplyByPoint(o,s,a.position)}}updateParticleSystemList(){let e;this._particleSystemList=this._particleSystemList.map((e=>{if(e)return this._viewer.scene.primitives.remove(e),e=void 0})),this._particleSystemList.length=0;for(let t=0;t<this.particleNumber;++t){e=t%this._colors.length;let i=this.updateCallback(this._radiuStep,this._rotateSpeed,Cesium.Math.TWO_PI*t/this.particleNumber,this._speed,this._inverseModelMatrix,this._modelMatrix);this._particleSystemList.push(new Cesium.ParticleSystem({image:Mg(),show:this.show&&this.enabled,startColor:this._colors[e],endColor:this._colors[e].withAlpha(0),particleLife:this.particleLife,speed:5e-6,imageSize:new Cesium.Cartesian2(this.particleSize,this.particleSize),emissionRate:this.emissionRate,modelMatrix:this._modelMatrix,lifetime:.1,emitter:new Cesium.CircleEmitter(.01),updateCallback:i}))}this._particleSystemList.forEach((e=>{this._viewer.scene.primitives.add(e)}))}flyTo(){this.boundingSphere=new Cesium.BoundingSphere(this._position,Math.sqrt(2*Math.pow(this.radius,2),Math.pow(this.height,2))),this._viewer.camera.flyToBoundingSphere(this.boundingSphere,{duration:2})}toBeCometTail(){this.colors=[...Lg.comet.colors],this.rotate=Lg.comet.rotate}toBeRocketThruster(){this.colors=[...Lg.rocket.colors],this.rotate=Lg.rocket.rotate}}Og.defaultOptions={show:!0,particleSize:15,emissionRate:30,particleNumber:100,position:[1.67,.6,50],rotation:[0,0,0],colors:[.6,.6,.6,1,.6,.6,.9,.9,.5,.5,.7,.5],radius:30,rotate:.01,height:50,particleLife:3.5};const Lg={rocket:{colors:[1,.5,.05,1,.9,.6,.01,1,.8,.05,.09,1,1,.05,.09,1],rotate:1},comet:{colors:[.6,.6,.6,1,.6,.6,.9,.9,.5,.5,.7,.5],rotate:.01}};Og.registerType(Og,"ParticleSystemTails");const Dg=Og;let Ig=function(e,t,i,r,n=20){let o,s,a,l,h,c,u,p=[];p.push(e);for(let d=1;d<n;d++)o=d/n,s=o*o,a=s*o,l=1-o,h=l*l,c=h*l,u=new Cesium.Cartesian3,u.x=e.x*c+3*t.x*h*o+3*i.x*l*s+r.x*a,u.y=e.y*c+3*t.y*h*o+3*i.y*l*s+r.y*a,u.z=e.z*c+3*t.z*h*o+3*i.z*l*s+r.z*a,p.push(u);return p.push(r),p},Rg=function(e,t,i,r){let n=Cesium.Cartesian3.distance(t,e);vector=Cesium.Cartesian3.subtract(t,e,new Cesium.Cartesian3),Cesium.Cartesian3.normalize(vector,vector);let o=Cesium.Cartesian3.multiplyByScalar(vector,n/3,new Cesium.Cartesian3),s=Cesium.Cartesian3.multiplyByScalar(vector,2*n/3,new Cesium.Cartesian3);Cesium.Cartesian3.add(e,o,o),Cesium.Cartesian3.add(e,s,s),i.push(o,s),r.push(vector)};var Hg=i(5108);class Fg extends pg{constructor(e,t){super(e,t),this._pgPositions=[],this.disposers.push(Js.watch((()=>[...this.positions.map((e=>[...e]))]),(()=>{Hg.log(this.positions);let e=this.positions.filter((e=>{let t=!0;if(t)return e}));const t=e.length;if(t<=2)return;if(function(e,t){if(!e||!t)return!1;Ng=0;for(let i=0;i<e.length;i++)if(Ng=e[i]==t[i]?0:1,Ng>0)return!1;return!0}(e[t-1],e[t-2]))return;this._pgPositions.length=0;let i=[];e.forEach((e=>{i.push(e)}));let r=function(e,t=!1,i=20,r){if(e.length<3)return;let n,o,s,a=e.map((e=>Cesium.Cartesian3.fromRadians(...e,void 0,new Cesium.Cartesian3)));r||(r=[]),n=a[0];let l,h,c,u=[],p=new Cesium.Cartesian3,d=new Cesium.Cartesian3,m=[];if(1==t)n=a[a.length-1],u=a.map(((e,t)=>{o=e,s=a[t+1]||a[0],h=Cesium.Cartesian3.distance(n,o),c=Cesium.Cartesian3.distance(o,s),p=Cesium.Cartesian3.subtract(o,n,p),d=Cesium.Cartesian3.subtract(s,o,d),Cesium.Cartesian3.normalize(p,p),Cesium.Cartesian3.normalize(d,d),Cesium.Cartesian3.multiplyByScalar(p,h,p),Cesium.Cartesian3.multiplyByScalar(d,c,d),l=Cesium.Cartesian3.add(p,d,new Cesium.Cartesian3),Cesium.Cartesian3.normalize(l,l),n=o;let i=Cesium.Cartesian3.multiplyByScalar(l,.3*-h,new Cesium.Cartesian3),r=Cesium.Cartesian3.multiplyByScalar(l,.3*c,new Cesium.Cartesian3);return Cesium.Cartesian3.add(o,i,i),Cesium.Cartesian3.add(o,r,r),m.push(i,r),l})),m.push(m.shift());else{Rg(a[0],a[1],m,u);for(let e=1;e<a.length-1;e++){n=a[e-1],o=a[e],s=a[e+1],h=Cesium.Cartesian3.distance(n,o),c=Cesium.Cartesian3.distance(o,s),p=Cesium.Cartesian3.subtract(o,n,p),d=Cesium.Cartesian3.subtract(s,o,d),Cesium.Cartesian3.normalize(p,p),Cesium.Cartesian3.normalize(d,d),Cesium.Cartesian3.multiplyByScalar(p,h,p),Cesium.Cartesian3.multiplyByScalar(d,c,d),l=Cesium.Cartesian3.add(p,d,new Cesium.Cartesian3),Cesium.Cartesian3.normalize(l,l),n=o;let t=Cesium.Cartesian3.multiplyByScalar(l,.3*-h,new Cesium.Cartesian3),i=Cesium.Cartesian3.multiplyByScalar(l,.3*c,new Cesium.Cartesian3);Cesium.Cartesian3.add(o,t,t),Cesium.Cartesian3.add(o,i,i),m.push(t,i),u.push(l)}Rg(a[a.length-2],a[a.length-1],m,u)}for(let e=0;e<a.length;e++){let t=a[e]||a[a.length-1],n=a[e+1]||a[0],o=m[2*e]||m[m.length-2],s=m[2*e+1]||m[m.length-1];r.push(...Ig(t,o,s,n,i))}return r.map((e=>{let t=Cesium.Cartographic.fromCartesian(e);return[t.longitude,t.latitude,t.height]}))}(e,!0,20);r.forEach((e=>{this._pgPositions.push(e[0],e[1])})),this._polygon.positions=this._pgPositions,this._polygon.height=e[0][2]})))}}Fg.registerType(Fg,"GeoSmoothPolygon");let Ng;const Qg={GeoArrow:gg,GeoSimpleArrow:_g,ParticleSystem:xg,ParticleSystemFireWork:Tg,ParticleSystemTails:Dg,GeoSmoothPolygon:Fg};var kg,Ug=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),jg=function(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],r=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Gg=function(e){function t(t){var i=e.call(this)||this;return i._type="GraphicGroup",i._visible=!0,i._itemList=[],i._id=qh.createGuid(),t&&i.parseJson(t),i}return Ug(t,e),Object.defineProperty(t,"type",{get:function(){return"GraphicGroup"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this._name},set:function(e){this._name=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this._id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"father",{get:function(){return this._father},enumerable:!1,configurable:!0}),t.prototype.updateVisible=function(){this._father?this._renderVisible=this._father.renderVisible&&this._visible:this._renderVisible=this._visible},Object.defineProperty(t.prototype,"visible",{get:function(){return this._visible},set:function(e){this._visible=e,this.updateVisible(),this.children.forEach((function(t){t.visible=e,t.updateVisible()}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"renderVisible",{get:function(){return this._renderVisible},enumerable:!1,configurable:!0}),t.prototype.init=function(e){var i=this;e instanceof t?(this._root=e._root,this._father=e):this._root=e,this.updateVisible(),this.children.forEach((function(e){e.init(i)}))},t.prototype.destroy=function(){this._itemList.forEach((function(e){e.destroy()})),this._father=void 0,this._root=void 0},t.prototype.clear=function(){var e=this,t=[];this.children.forEach((function(e){t.push(e.id)})),t.forEach((function(t){e.removeById(t)}))},Object.defineProperty(t.prototype,"children",{get:function(){return this._itemList},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"extendInfo",{get:function(){return this._extendInfo},set:function(e){this._extendInfo=e},enumerable:!1,configurable:!0}),t.prototype.add=function(e){return this._itemList.push(e),this._root&&(this.getRoot().fire("add",e),e.init(this)),e},t.prototype.addByJson=function(e){var t=new(window.GVOL.GET_CONSTRUCTOR("GraphicItem",e.type))(e);return this.add(t),t},t.prototype.removeById=function(e){var t=this.getById(e);t&&this.remove(t)},t.prototype.remove=function(e){if(e){e.destroy();var t=this._itemList.indexOf(e);this._itemList.splice(t,1),this.getRoot().fire("remove",e);return"q",e}},t.prototype.getById=function(e){var i,r;try{for(var n=jg(this._itemList),o=n.next();!o.done;o=n.next()){var s=o.value;if(s.id===e)return s;if(s instanceof t){var a=s.getById(e);if(a)return a}}}catch(e){i={error:e}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(i)throw i.error}}},t.prototype.getByName=function(e){var i,r,n=[];try{for(var o=jg(this._itemList),s=o.next();!s.done;s=o.next()){var a=s.value;if(a.name===e)n.push(a);else if(a instanceof t){var l=a.getByName(e);n=n.concat(l)}}}catch(e){i={error:e}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return n},t.prototype.toJson=function(){var e,t,i={type:this._type,id:this._id,name:this._name,extendInfo:this._extendInfo,children:[]},r=[];try{for(var n=jg(this._itemList),o=n.next();!o.done;o=n.next()){var s=o.value;r.push(s.toJson())}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}return i.children=r,i},t.prototype.parseJson=function(e){var t,i;this._name=e.name,this._extendInfo=e.extendInfo,this._visible=void 0===e.visible;try{for(var r=jg(e.children),n=r.next();!n.done;n=r.next()){var o=n.value,s=new(window.GVOL.GET_CONSTRUCTOR("GraphicItem",o.type))(o);this.add(s)}}catch(e){t={error:e}}finally{try{n&&!n.done&&(i=r.return)&&i.call(r)}finally{if(t)throw t.error}}},t.prototype.getRoot=function(){if(this._root)return this._root()},t}(p),zg=function(){function e(){this._showBackground=!1,this._color="#FFFFFF",this._selectedColor="#FFFF00",this._pointSize=2,this._pointLineWidth=0,this._pointLineColor="#FFFFFF",this._pointDisplayCondition=new Cesium.DistanceDisplayCondition(4e5),this._fontSize=16,this._fontColor="#FFFFFF",this._font="微软雅黑",this._fontbgColor="#000000",this._showFontbgColor=!1,this._labelDisplayCondition=new Cesium.DistanceDisplayCondition(0,6e3),this._labelLineColor="#FFFFFF",this._iconUrl="../data/plane.png",this._iconSize=32,this._iconDisplayCondition=new Cesium.DistanceDisplayCondition(600,9e6),this._modelUrl="",this._modelDisplayCondition=new Cesium.DistanceDisplayCondition(0,1e3),this._modelMaximumScale=200,this._modelMinimumPixelSize=100,this._trackLineWidth=2,this._trackLineColor="#FF0000",this._labeloffsetx=50,this._labeloffsety=-60,this._showBackground=!1}return e.DefaultStyle=function(){return new e},Object.defineProperty(e.prototype,"color",{get:function(){return this._color},set:function(e){this._color=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"showBackground",{get:function(){return this._showBackground},set:function(e){this._showBackground=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"selectedColor",{get:function(){return this._selectedColor},set:function(e){this._selectedColor=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pointSize",{get:function(){return this._pointSize},set:function(e){this._pointSize=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pointLineWidth",{get:function(){return this._pointLineWidth},set:function(e){this._pointLineWidth=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pointLineColor",{get:function(){return this._pointLineColor},set:function(e){this._pointLineColor=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pointDisplayCondition",{get:function(){return this._pointDisplayCondition},set:function(e){this._pointDisplayCondition=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fontSize",{get:function(){return this._fontSize},set:function(e){this._fontSize=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fontColor",{get:function(){return this._fontColor},set:function(e){this._fontColor=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"font",{get:function(){return this._font},set:function(e){this._font=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fontbgColor",{get:function(){return this._fontbgColor},set:function(e){this._fontbgColor=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"showFontbgColor",{get:function(){return this._showFontbgColor},set:function(e){this._showFontbgColor=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"labelDisplayCondition",{get:function(){return this._labelDisplayCondition},set:function(e){this._labelDisplayCondition=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"labelLineColor",{get:function(){return this._labelLineColor},set:function(e){this._labelLineColor=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"iconUrl",{get:function(){return this._iconUrl},set:function(e){this._iconUrl=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"iconSize",{get:function(){return this._iconSize},set:function(e){this._iconSize=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"iconDisplayCondition",{get:function(){return this._iconDisplayCondition},set:function(e){this._iconDisplayCondition=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"modelUrl",{get:function(){return this._modelUrl},set:function(e){this._modelUrl=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"modelDisplayCondition",{get:function(){return this._modelDisplayCondition},set:function(e){this._modelDisplayCondition=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"modelMaximumScale",{get:function(){return this._modelMaximumScale},set:function(e){this._modelMaximumScale=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"modelMinimumPixelSize",{get:function(){return this._modelMinimumPixelSize},set:function(e){this._modelMinimumPixelSize=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"trackLineWidth",{get:function(){return this._trackLineWidth},set:function(e){this._trackLineWidth=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"trackLineColor",{get:function(){return this._trackLineColor},set:function(e){this._trackLineColor=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"labeloffsetx",{get:function(){return this._labeloffsetx},set:function(e){this._labeloffsetx=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"labeloffsety",{get:function(){return this._labeloffsety},set:function(e){this._labeloffsety=e},enumerable:!1,configurable:!0}),e.toJson=function(e){var t={};return t.color=e.color,t.pointSize=e.pointSize,t.pointLineWidth=e.pointLineWidth,t.fontSize=e.fontSize,t.pointLineColor=e.pointLineColor,t.fontColor=e.fontColor,t.font=e.font,t.fontbgColor=e.fontbgColor,t.labelLineColor=e.labelLineColor,t.iconUrl=e.iconUrl,t.iconSize=e.iconSize,t.modelUrl=e.modelUrl,t.modelMaximumScale=e.modelMaximumScale,t.modelMinimumPixelSize=e.modelMinimumPixelSize,t.trackLineWidth=e.trackLineWidth,t.trackLineColor=e.trackLineColor,t.labeloffsetx=e.labeloffsetx,t.labeloffsety=e.labeloffsety,t.pointDisplayCondition=[e.pointDisplayCondition.near,e.pointDisplayCondition.far],t.iconDisplayCondition=[e.iconDisplayCondition.near,e.iconDisplayCondition.far],t.labelDisplayCondition=[e.labelDisplayCondition.near,e.labelDisplayCondition.far],t.modelDisplayCondition=[e.modelDisplayCondition.near,e.modelDisplayCondition.far],t},e.fromJson=function(t){var i=new e;return i.color=Cesium.defaultValue(t.color,i.color),i.pointSize=Cesium.defaultValue(t.pointSize,i.pointSize),i.pointLineWidth=Cesium.defaultValue(t.pointLineWidth,i.pointLineWidth),i.fontSize=Cesium.defaultValue(t.fontSize,i.fontSize),i.pointLineColor=Cesium.defaultValue(t.pointLineColor,i.pointLineColor),i.fontColor=Cesium.defaultValue(t.fontColor,i.fontColor),i.font=Cesium.defaultValue(t.font,i.font),i.fontbgColor=Cesium.defaultValue(t.fontbgColor,i.fontbgColor),i.labelLineColor=Cesium.defaultValue(t.labelLineColor,i.labelLineColor),i.iconUrl=Cesium.defaultValue(t.iconUrl,i.iconUrl),i.iconSize=Cesium.defaultValue(t.iconSize,i.iconSize),i.modelUrl=Cesium.defaultValue(t.modelUrl,i.modelUrl),i.modelMaximumScale=Cesium.defaultValue(t.modelMaximumScale,i.modelMaximumScale),i.modelMinimumPixelSize=Cesium.defaultValue(t.modelMinimumPixelSize,i.modelMinimumPixelSize),i.trackLineWidth=Cesium.defaultValue(t.trackLineWidth,i.trackLineWidth),i.trackLineColor=Cesium.defaultValue(t.trackLineColor,i.trackLineColor),i.labeloffsetx=Cesium.defaultValue(t.labeloffsetx,i.labeloffsetx),i.labeloffsety=Cesium.defaultValue(t.labeloffsety,i.labeloffsety),t.pointDisplayCondition&&(i.pointDisplayCondition=new Cesium.DistanceDisplayCondition(t.pointDisplayCondition[0],t.pointDisplayCondition[1])),t.iconDisplayCondition&&(i.iconDisplayCondition=new Cesium.DistanceDisplayCondition(t.iconDisplayCondition[0],t.iconDisplayCondition[1])),t.labelDisplayCondition&&(i.labelDisplayCondition=new Cesium.DistanceDisplayCondition(t.labelDisplayCondition[0],t.labelDisplayCondition[1])),t.modelDisplayCondition&&(i.modelDisplayCondition=new Cesium.DistanceDisplayCondition(t.modelDisplayCondition[0],t.modelDisplayCondition[1])),i},e}(),Yg=function(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],r=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Zg=function(){function e(e,t){this._init=!1,this._trackLine=null,this._trackPoints=[],this._showTrack=!1,this._trackLineColor=Cesium.Color.RED,this._trackLineWidth=2,this._trackPointColor=Cesium.Color.WHITE,this._trackPointSize=8,this._trackPositionCount=6,this._trackPositions=[],this._trackInit=!1,this._trackLineType="line",this._mtype=Wg.backward,this._backLineMode=Xg.ramp,this._modeChange=!1,this._target=e,this._mtype=t}return Object.defineProperty(e.prototype,"trackInit",{get:function(){return this._trackInit},set:function(e){this._trackInit=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"trackLine",{set:function(e){this._trackLine=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mtype",{get:function(){return this._mtype},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"trackPositions",{get:function(){return this._trackPositions},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"show",{get:function(){return this._showTrack},set:function(e){var t,i;if(this._showTrack=e,"line"==this.trackLineType)this._trackLine&&(this._trackLine.show=e);else try{for(var r=Yg(this._trackPoints),n=r.next();!n.done;n=r.next()){n.value.show=e}}catch(e){t={error:e}}finally{try{n&&!n.done&&(i=r.return)&&i.call(r)}finally{if(t)throw t.error}}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"trackLineColor",{get:function(){return this._trackLineColor},set:function(e){this._trackLineColor=e,this._trackLine&&(this._trackLine.material=Cesium.Material.fromType("Color",{color:e}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"trackPositionCount",{get:function(){return this._trackPositionCount},set:function(e){this._trackPositionCount=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"trackLineWidth",{get:function(){return this._trackLineWidth},set:function(e){this._trackLineWidth=e,this._trackLine&&(this._trackLine.width=e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"trackPointColor",{get:function(){return this._trackPointColor},set:function(e){var t,i;if(this._trackPointColor=e,this._trackPoints.length>0)try{for(var r=Yg(this._trackPoints),n=r.next();!n.done;n=r.next()){n.value.color=e}}catch(e){t={error:e}}finally{try{n&&!n.done&&(i=r.return)&&i.call(r)}finally{if(t)throw t.error}}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"trackPointSize",{get:function(){return this._trackPointSize},set:function(e){var t,i;if(this._trackPointSize=e,this._trackPoints.length>0)try{for(var r=Yg(this._trackPoints),n=r.next();!n.done;n=r.next()){n.value.pixelSize=e}}catch(e){t={error:e}}finally{try{n&&!n.done&&(i=r.return)&&i.call(r)}finally{if(t)throw t.error}}},enumerable:!1,configurable:!0}),e.prototype.updateTrackPoint=function(){var e,t,i,r,n=this.getTagPositions(),o=this._target._parentLayer.trackPointcollection;try{for(var s=Yg(this._trackPoints),a=s.next();!a.done;a=s.next()){var l=a.value;o.remove(l)}}catch(t){e={error:t}}finally{try{a&&!a.done&&(t=s.return)&&t.call(s)}finally{if(e)throw e.error}}this._mtype==Wg.backward&&n.length>this.trackPositionCount&&(n=n.splice(n.length-this.trackPositionCount)),this._trackPoints=[];try{for(var h=Yg(n),c=h.next();!c.done;c=h.next()){l=c.value;var u=o.add({position:l,pixelSize:this._trackPointSize,color:this._trackPointColor});this._trackPoints.push(u)}}catch(e){i={error:e}}finally{try{c&&!c.done&&(r=h.return)&&r.call(h)}finally{if(i)throw i.error}}},e.prototype.getTrackPoint=function(e){if(e<this.trackPositionCount&&e<this._trackPositions.length)return this._trackPositions[e]},Object.defineProperty(e.prototype,"trackLineType",{get:function(){return this._trackLineType},set:function(e){var t,i,r,n;if(this._trackLineType!=e)if("line"==this._trackLineType){this._trackLine&&(this._trackLine.show=!1),this.updateTrackPoint();try{for(var o=Yg(this._trackPoints),s=o.next();!s.done;s=o.next()){s.value.show=!0}}catch(e){t={error:e}}finally{try{s&&!s.done&&(i=o.return)&&i.call(o)}finally{if(t)throw t.error}}}else{this._trackInit||this._target._parentLayer.addTrack(this),this._trackLine.positions=this._trackPositions,this._trackLine.show=!0;try{for(var a=Yg(this._trackPoints),l=a.next();!l.done;l=a.next()){l.value.show=!1}}catch(e){r={error:e}}finally{try{l&&!l.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}}this._trackLineType=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"foreLineMode",{get:function(){return this._backLineMode},set:function(e){this._modeChange=!0,this._backLineMode=e},enumerable:!1,configurable:!0}),e.prototype.updatePosition=function(e){this._trackPositions.push(e),this._mtype==Wg.backward&&this._trackPositions.length>this._trackPositionCount&&this._trackPositions.shift(),this._target._smoothTrack||this._showTrack&&"line"==this.trackLineType&&(this._trackInit||this._target._parentLayer.addTrack(this),this._trackLine.positions=this._trackPositions),this._showTrack&&"line"!=this.trackLineType&&this.updateTrackPoint()},e.prototype.getTagPositions=function(){var e=this._target._timePosition,t=[];this._mtype==Wg.backward?t=e.getHistoryPoints().map((function(e){return e.position})):t=e.getPreservePoints().map((function(e){return e.position}));return t},e.prototype.render=function(e){if(this._showTrack&&"line"==this.trackLineType){this._trackInit||this._target._parentLayer.addTrack(this);var t=this.getTagPositions();1!=this._trackPositions.length&&(this._mtype==Wg.backward?(t.length>this.trackPositionCount&&(t=t.splice(t.length-this.trackPositionCount)),t.push(e),this._trackLine.positions=t):(t.unshift(e),this._trackLine.positions=t)),this._trackLine&&this._modeChange&&this._mtype==Wg.backward&&(this.foreLineMode==Xg.ramp?this._trackLine.material=new Cesium.Material({fabric:{uniforms:{image:qh.formatUrlByBaseJs("resources/images/specialLine/Trail.png"),lineColor:this._trackLineColor},source:"\n                                             czm_material czm_getMaterial(czm_materialInput materialInput) \n                                                {\n                                                    czm_material material = czm_getDefaultMaterial(materialInput); \n                                                    vec2 st = materialInput.st; \n                                                    material.alpha = texture2D(image, st).a;\n                                                    material.diffuse = lineColor.rgb;\n                                                    return material;\n                                                }"}}):this._trackLine.material=Cesium.Material.fromType("Color",{color:this._trackLineColor}),this._modeChange=!1)}},e}(),Wg=function(){function e(){}return e.backward="backward",e.foreward="foreward",e}(),Xg=function(){function e(){}return e.ramp="ramp",e.full="full",e}(),Jg=function(){function e(e){this._init=!1,this.emitterModelMatrix=new Cesium.Matrix4,this.translation=new Cesium.Cartesian3,this.rotation=new Cesium.Quaternion,this.hpr=new Cesium.HeadingPitchRoll,this.trs=new Cesium.TranslationRotationScale,this._show=!1,this._target=e}return e.prototype.applyGravity=function(e,t){var i=e.position;Cesium.Cartesian3.normalize(i,new Cesium.Cartesian3),Cesium.Cartesian3.multiplyByScalar(new Cesium.Cartesian3,0*t,new Cesium.Cartesian3),e.velocity=Cesium.Cartesian3.add(e.velocity,new Cesium.Cartesian3,e.velocity)},e.prototype.init=function(){this._earth=this._target._parentLayer.viewer,this._earth.clock.shouldAnimate=!0,this.particleSystem=this._earth.scene.primitives.add(new Cesium.ParticleSystem({image:qh.formatUrlByBaseJs("resources/images/smoke.png"),startColor:Cesium.Color.RED.withAlpha(.7),endColor:Cesium.Color.WHITE.withAlpha(0),startScale:1,endScale:5,minimumParticleLife:1.2,maximumParticleLife:1.2,minimumSpeed:1,maximumSpeed:4,imageSize:new Cesium.Cartesian2(25,25),emissionRate:5,bursts:[new Cesium.ParticleBurst({time:5,minimum:10,maximum:100}),new Cesium.ParticleBurst({time:10,minimum:50,maximum:100}),new Cesium.ParticleBurst({time:15,minimum:200,maximum:300})],lifetime:16,emitter:new Cesium.CircleEmitter(2),emitterModelMatrix:this.computeEmitterModelMatrix(),updateCallback:this.applyGravity})),this._init=!0},Object.defineProperty(e.prototype,"show",{get:function(){return!!this._init&&this.particleSystem.show},set:function(e){this._show=e,this._show&&!this._init?this.init():this.particleSystem.show=e},enumerable:!1,configurable:!0}),e.prototype.updateFlame=function(){if(this._init&&this._show){var e=this._target._model;if(e&&e.show){var t=this._earth.camera.position,i=e.model.distanceDisplayCondition.getValue(),r=Cesium.Cartographic.fromCartesian(t).height;r<i.far&&r>i.near?(this.particleSystem.show=!0,this.particleSystem.modelMatrix=e.computeModelMatrix(Cesium.JulianDate.now(),new Cesium.Matrix4),this.particleSystem.emitterModelMatrix=this.computeEmitterModelMatrix()):this.particleSystem.show=!1}}},e.prototype.computeEmitterModelMatrix=function(){return this.hpr=Cesium.HeadingPitchRoll.fromDegrees(0,0,0,this.hpr),this.trs.translation=Cesium.Cartesian3.fromElements(-4,0,1.4,this.translation),this.trs.rotation=Cesium.Quaternion.fromHeadingPitchRoll(this.hpr,this.rotation),Cesium.Matrix4.fromTranslationRotationScale(this.trs,this.emitterModelMatrix)},e.prototype.dispose=function(){Cesium.defined(this._earth)&&this._earth.scene.primitives.remove(this.particleSystem)},e}();!function(e){e[e.Retain=0]="Retain",e[e.Add=1]="Add",e[e.Update=2]="Update",e[e.Remove=3]="Remove",e[e.None=4]="None"}(kg||(kg={}));var Kg=i(5108),Vg=function(){function e(){this._init=!1,this._positionIndex=0,this._sampleCount=1e3,this._sampleIndex=0,this._speed=1,this._cacheSize=20,this._positionScratch=new Cesium.Cartesian3,this._positionList=[]}return Object.defineProperty(e.prototype,"count",{get:function(){return this._positionList.length},enumerable:!1,configurable:!0}),e.prototype.addSample=function(e){try{if(this._positionList.length>this._cacheSize&&this._positionList.shift(),e.index=this._positionList.length,this._positionList.push(e),this._positionList.length>1){var t=this._positionList[this._positionList.length-2];t.timeSpan=e.time-t.time,t.xSpan=e.position.x-t.position.x,t.ySpan=e.position.y-t.position.y,t.zSpan=e.position.z-t.position.z}}catch(e){Kg.log(e)}},e.prototype.getMoveAmount=function(e,t){var i=(t.x-e.x)/this._speed*this._sampleCount,r=(t.y-e.y)/this._speed*this._sampleCount,n=(t.z-e.z)/this._speed*this._sampleCount;return new Cesium.Cartesian3(i,r,n)},e.prototype.getNearestIndex=function(e){for(var t=-1,i=0;i<this._positionList.length;i++){var r=this._positionList[i];if(r.time>e){t=i;break}r.isHistory=!0}return t},e.prototype.getHistoryPoints=function(){return this._positionList.filter((function(e){return e.isHistory}))},e.prototype.getPreservePoints=function(){return this._positionList.filter((function(e){return!e.isHistory}))},e.prototype.getPosition=function(e){if(1==this._positionList.length)return this._positionList[0].position;var t,i=this.getNearestIndex(e);if(-1==i)return this._positionList[this._positionList.length-1].position;var r=(e-(t=0==i?this._positionList[i]:this._positionList[i-1]).time)/t.timeSpan,n=new Cesium.Cartesian3(t.xSpan*r,t.ySpan*r,t.zSpan*r);return Cesium.Cartesian3.add(t.position,n,this._positionScratch)},Object.defineProperty(e.prototype,"speed",{get:function(){return this._speed},set:function(e){this._speed=e},enumerable:!1,configurable:!0}),e}(),qg=function(){this.isHistory=!1};class $g extends c.Z{_model;_label;_point;_billbord;_canvasLine;_lineBillboard;_data;_position;_geoPoint;_flag=kg.None;_pedding=!0;_style=zg.DefaultStyle();_timePosition=new Vg;_angle=0;_parentLayer=null;_init=!1;_type=null;_smoothTrack=!1;_inview=!1;_timeArray=[];_bUseIconColor=!0;_time;_speed;_show=!0;_isSelected=!1;_showLabel=!1;_labelInit=!1;_linkLine=null;_showLink=!0;_showModel=!1;_modelInit=!1;_backwardPath=null;_forewardPath=null;_flame=null;_userHPR;_color;_modelColor;_textColor;_outlineColor;_outlineWidth;_itemtype="target";_depthTest=!1;_partners=new Map;constructor(e,t,i,r,n=!1,o=!1){super(null,e),this._label&&(this._label.text=this.name),this._smoothTrack=n,this._position=Cesium.Cartesian3.fromDegrees(t,i,r),this._geoPoint=new A(t,i,r),this._textColor="white",this._outlineColor=Cesium.Color.WHITE,this._modelColor=""}getType(){return"target"}get forewardPath(){return Cesium.defined(this._forewardPath)||(this._forewardPath=new Zg(this,Wg.foreward),this._forewardPath.trackLineColor=Cesium.Color.WHITE,this._forewardPath.trackPointColor=Cesium.Color.WHITE),this._forewardPath}get backwardPath(){return Cesium.defined(this._backwardPath)||(this._backwardPath=new Zg(this,Wg.backward),this._backwardPath.trackLineColor=Cesium.Color.RED,this._backwardPath.trackPointColor=Cesium.Color.RED),this._backwardPath}get flame(){return this._flame||(this._flame=new Jg(this)),this._flame}get showLabel(){return this._showLabel}set showLabel(e){this._showLabel=e,this._labelInit&&(this._label.show=this._showLabel)}get showModel(){return this._showModel}set showModel(e){this._showModel=e,this._modelInit&&(this._model.show=this._showModel)}get styleCode(){return this._type}set styleCode(e){this._type=e}get flag(){return this._flag}set flag(e){this._flag=e}getPosition(){return this._timePosition.getPosition((new Date).getTime())}get useIconColor(){return this._bUseIconColor}set useIconColor(e){this._bUseIconColor=e}get show(){return this._show}set show(e){this._show=e,this._point&&(this._point.show=e),this._billbord&&(this._billbord.show=e),this._label&&(this._label.show=e),this._model&&(this._model.show=e),this._linkLine&&(this._linkLine.show=this._showLink&&this._show);for(let t of this._partners)t[1].visible=e}get smoothTrack(){return this._smoothTrack}set smoothTrack(e){this._smoothTrack=e}get style(){return this._style}set style(e){this._style=e,this._parentLayer&&this._parentLayer.setTargetStyle(this)}updatePosition(e,t,i,r=5){let n=Cesium.Cartesian3.fromDegrees(Number(e),Number(t),Number(i));if(this._geoPoint=new A(e,t,i),!this._smoothTrack){this._position=n,this.flag=kg.Update,this._label&&(this._label.position=this._position),this._linkLine&&(this._linkLine.position=this._position),this._point.position=this._position,this._billbord.position=this._position,this._billbord.orientation=this.angle,this._model&&(this._model.position=this._position);for(let r of this._partners)r[1].position=new A(e,t,i)}this.backwardPath.show&&this.backwardPath.updatePosition(n),this.forewardPath.show&&this.forewardPath.updatePosition(n);let o=Cesium.JulianDate.now(),s=Cesium.JulianDate.addSeconds(o,r,new Cesium.JulianDate);var a=new qg;a.position=n,a.time=Cesium.JulianDate.toDate(s).getTime(),this._timePosition.addSample(a),this.flag=kg.Update,this._flame&&this._flame.updateFlame()}getColor(){return this._parentLayer.highlightSelection&&this.isSelected?this._parentLayer.selectionColor:this._style.color}get model(){return this._model.model}get id(){return this.guid}get color(){return this._color?this._color:this._style.color}set color(e){let t=Cesium.Color.fromCssColorString(e);this._point&&(this._point.color=t),this._billbord&&this._bUseIconColor&&(this._billbord.color=t),this._color=e}get textColor(){return this._textColor}set textColor(e){let t=Cesium.Color.fromCssColorString(e);this._label&&(this._label.fillColor=t),this._textColor=e}get outlineColor(){return this._outlineColor}set outlineColor(e){this._label&&(this._label.outlineColor=e,this._label.style=Cesium.LabelStyle.FILL_AND_OUTLINE),this._outlineColor=e}get outlineWidth(){return this._outlineWidth}set outlineWidth(e){this._label&&(this._label.outlineWidth=e),this._outlineWidth=e}get depthTest(){return this._depthTest}set depthTest(e){this._depthTest=e,this._point&&(this._point.disableDepthTestDistance=this._depthTest?Number.POSITIVE_INFINITY:0),this._label&&(this._label.disableDepthTestDistance=this._depthTest?Number.POSITIVE_INFINITY:0),this._billbord&&(this._billbord.disableDepthTestDistance=this._depthTest?Number.POSITIVE_INFINITY:0)}get modelColor(){return this._modelColor}set modelColor(e){let t=Cesium.Color.fromCssColorString(e);this._model&&this._model.model&&(this._model.model.color=t),this._modelColor=e}get iconSize(){return this._style.iconSize}set iconSize(e){this._style.iconSize=e,this._billbord&&(this._billbord.width=e,this._billbord.height=e)}get fontbgColor(){return this._style.fontbgColor}set fontbgColor(e){this._style.fontbgColor=e,this._label&&this._labelInit&&(this._label.backgroundColor=Cesium.Color.fromCssColorString(e))}get showFontbgColor(){return this._style.showFontbgColor}set showFontbgColor(e){this._style.showFontbgColor=e,this._label&&this._labelInit&&(this._label.showBackground=e)}get isSelected(){return this._isSelected}set isSelected(e){this._isSelected=e,this.color=this.getColor()}get showLink(){return this._showLink}set showLink(e){this._showLink=e,this._linkLine&&(this._linkLine.show=this._showLink&&this._show)}get angle(){return this._angle}set angle(e){if(Pt.isNumber(e)&&(this._angle=e,this._billbord&&(this._billbord.rotation=-1*Cesium.Math.toRadians(this._angle)),this._modelInit&&!this._userHPR)){let t=Cesium.Math.toRadians(e-90),i=new Cesium.HeadingPitchRoll(t,0,0),r=Cesium.Transforms.headingPitchRollQuaternion(this._model.position._value,i);this._model.orientation=r}}get modelHPR(){return this._userHPR}set modelHPR(e){if(this._userHPR=e,this._modelInit){let t=Cesium.Transforms.headingPitchRollQuaternion(this._model.position._value,e);this._model.orientation=t}}get time(){return this._time}set time(e){this._time=e}get speed(){return this._speed}set speed(e){this._speed=e}addPartner(e){let t=this._parentLayer.graphicGroup.add(e);return this._partners.set(t.id,t),t}removePartner(e){return this._partners.delete(e.id),this._parentLayer.graphGroup.remove(e)}clearPartner(){for(let e of this._partners)this._partners.delete(e[0]),this._parentLayer.graphGroup.remove(e[1])}get partnerList(){return this._partners}}var eA=function(){function e(){}return e.getPositions=function(e){if(e){var t=[];return e.forEach((function(e){t.push(A.toCartesian3(e))})),t}},e.getRadii=function(e){if(e&&e instanceof Array&&!(e.length<3))return new Cesium.Cartesian3(e[0],e[1],e[2])},e.getRectangleDegress=function(e){if(e&&!(e.length<3))return Cesium.Rectangle.fromDegrees(e[0],e[1],e[2],e[3])},e.getImage=function(e,t){if(void 0===t&&(t=!1),e)return new Cesium.ImageMaterialProperty({image:e,transparent:t,color:Cesium.Color.WHITE,repeat:new Cesium.Cartesian2(1,1)})},e.getClassificationType=function(e){var t=void 0;switch(e){case"both":t=Cesium.ClassificationType.BOTH;break;case"cesium_3D_tile":t=Cesium.ClassificationType.CESIUM_3D_TILE;break;case"terrain":t=Cesium.ClassificationType.TERRAIN}return t},e.getShadows=function(e){var t=void 0;switch(e){case"cast_only":t=Cesium.ShadowMode.CAST_ONLY;break;case"disabled":t=Cesium.ShadowMode.DISABLED;break;case"enabled":t=Cesium.ShadowMode.ENABLED;break;case"receive_only":t=Cesium.ShadowMode.RECEIVE_ONLY}return t},e.getGranularity=function(e){var t=Cesium.Math.DEGREES_PER_RADIAN;switch(e){case"degrees_per_radian":t=Cesium.Math.RADIANS_PER_DEGREE;break;case"epsilon1":t=Cesium.Math.EPSILON1;break;case"epsilon2":t=Cesium.Math.EPSILON2;break;case"epsilon3":t=Cesium.Math.EPSILON3;break;case"epsilon34":t=Cesium.Math.EPSILON4}return t},e.getColor=function(e){if(e)return Cesium.Color.fromCssColorString(e)},e.getDynamicColor=function(e){var t=this;return new Cesium.CallbackProperty((function(i,r){return t.getColor(e)}),!1)},e.getDynamicValue=function(e){return new Cesium.CallbackProperty((function(t,i){return e}),!1)},e.getPosition=function(e){if(e)return A.toCartesian3(e)},e.getNearFarScalar=function(e){if(e)return new Cesium.NearFarScalar(e[0],e[1],e[2],e[3])},e.getDynamicNearFarScalar=function(e){var t=this;return new Cesium.CallbackProperty((function(i,r){return t.getNearFarScalar(e)}),!1)},e.getDistanceDisplayCondition=function(e){if(e)return new Cesium.DistanceDisplayCondition(e[0],e[1])},e.getDynamicDistanceDisplayCondition=function(e){var t=this;return new Cesium.CallbackProperty((function(i,r){return t.getDistanceDisplayCondition(e)}),!1)},e.getCartesian2=function(e){if(e&&e instanceof Array&&!(e.length<2))return new Cesium.Cartesian2(e[0],e[1])},e.getVerticalOrigin=function(e){var t=void 0;switch(e){case"baseline":t=Cesium.VerticalOrigin.BASELINE;break;case"bottom":t=Cesium.VerticalOrigin.BOTTOM;break;case"center":t=Cesium.VerticalOrigin.CENTER;break;case"top":t=Cesium.VerticalOrigin.TOP}return t},e.getHorizontalOrigin=function(e){var t=void 0;switch(e){case"left":t=Cesium.HorizontalOrigin.LEFT;break;case"center":t=Cesium.HorizontalOrigin.CENTER;break;case"right":t=Cesium.HorizontalOrigin.RIGHT}return t},e.getHeightReference=function(e){var t=void 0;switch(e){case"clamp_to_ground":t=Cesium.HeightReference.CLAMP_TO_GROUND;break;case"none":t=Cesium.HeightReference.NONE;break;case"relative_to_ground":t=Cesium.HeightReference.RELATIVE_TO_GROUND}return t},e.getStyle=function(e){switch(e){case"fill":return Cesium.LabelStyle.FILL;case"outline":case"fill_and_outline":return Cesium.LabelStyle.FILL_AND_OUTLINE}},e.getPositionDegrees=function(e){if(e&&e instanceof Array&&!(e.length<2))return Cesium.Cartesian3.fromDegrees(e[0],e[1],e[2])},e.getCartesian3=function(e){if(e&&e instanceof Array&&!(e.length<3))return new Cesium.Cartesian3(e[0],e[1],e[2])},e.getOrientation=function(e,t){return Cesium.Transforms.headingPitchRollQuaternion(e,t)},e.getHpr=function(e,t,i){return new Cesium.HeadingPitchRoll(e,t,i)},e.getHeading=function(e){if(e)return Cesium.Math.toRadians(e)},e}();class tA extends c.Z{_renderVisible;_father;_getRenderObj;_type;_opt;_event;_isEditing=!1;constructor(e){super(null),this._event=new p,(0,P.extendObservable)(this,{name:""})}update(){this._getRenderObj&&this.getRenderObject().update()}onUpdateAttribute(e){this._event.on("updateAttribute",e)}offUpdateAttribute(e){this._event.off("updateAttribute",e)}updateAttribute(e){this._getRenderObj&&(this.getRenderObject().updateAttribute(e),this._event.fire("updateAttribute",{obj:this,key:e}))}getRenderObject(){if(this._getRenderObj)return this._getRenderObj()}updateVisible(){this._father?this._renderVisible=this._father.renderVisible&&this._opt.visible:this._renderVisible=this._opt.visible,this.updateAttribute("visible")}get id(){return this.guid}set extendInfo(e){this._opt.extendInfo=e}get extendInfo(){return this._opt.extendInfo}set visible(e){this._opt.visible=e,this.updateVisible()}get visible(){return this._opt.visible}get renderVisible(){return this._renderVisible}get father(){return this._father}getType(){return tA.type}static get type(){return"GraphicItem"}get clampToGround(){return!1}set isEditing(e){this._isEditing!==e&&(this._isEditing=e,this.updateAttribute("isEditing"))}get isEditing(){return this._isEditing}toJson(){const e={type:this._type,name:this.name,extendInfo:this.extendInfo};for(const t in this._opt)void 0!==this._opt[t]&&"constructor"!==t&&("positions"!==t?this._opt[t]instanceof Object&&this._opt[t].toJson?e[t]=this._opt[t].toJson():e[t]=this._opt[t]:e[t]=A.packArray(this._opt.positions));return e}parseJson(e){for(let t in e)"positions"===t&&e[t]&&!e[t].lenght&&e[t][0]instanceof Array&&(e[t]=A.unpackArray(e[t])),"position"===t&&e[t]&&e[t]instanceof Array&&(e[t]=A.unpack(e[t])),"lineStyle"!==t||!e[t]||e[t]instanceof rA||(e[t]=nA.createStyle(e[t])),this._opt[t]=qh.defaultValue(e[t],this._opt[t])}init(e){this._father=e,this.updateVisible()}destroy(){this.getRenderObject()&&this.getRenderObject().clear(),this._getRenderObj=void 0}getCenterPosition(){if(void 0!==this.position)return this.position;if(this.coordinates){let e=this.coordinates,t=this.height;return t||(t=0),new A((e[0]+e[2])/2,(e[1]+e[3])/2,t)}if(this.positions){const e=this.positions,t=[];e.forEach((e=>{t.push(A.toCartesian3(e))}));let i=Cesium.BoundingSphere.fromPoints(t).center;return A.fromCartesian3(i)}}movePosition(e=0,t=0,i=0){if(void 0!==this.position&&(this.position.lon+=e,this.position.lat+=t,this.position.alt+=i,this.position=this.position),void 0!==this.coordinates&&(this.coordinates[0]+=e,this.coordinates[1]+=t,this.coordinates[2]+=e,this.coordinates[3]+=t,this.coordinates=this.coordinates),this.positions){const r=this.positions;r.forEach((r=>{r.lon+=e,r.lat+=t,r.alt+=i})),this.positions=r}}}class iA{name;visible=!0;extendInfo;isEditing=!1}class rA{_material;toJson(){}getMaterial(){return this._material}}class nA{static createStyle(e){if(void 0!==e)switch(e.type){case pA.Arrow:return new sA(e);case pA.Color:return new oA(e);case pA.Dash:return new lA(e);case pA.Dynamic:return new cA(e);case pA.Glow:return new hA(e);case pA.Outline:return new aA(e)}}}class oA extends rA{_color="#ff0000";constructor(e){super(),e||(e={}),this._color=qh.defaultValue(e.color,this._color),this._material=new Cesium.ColorMaterialProperty(new Cesium.CallbackProperty((()=>eA.getColor(this.color)),!0))}set color(e){this._color=e}get color(){return this._color}getMaterial(){return this._material}toJson(){return{type:pA.Color,color:this.color}}}class sA extends rA{_color="#ff0000";constructor(e){super(),e||(e={}),this._color=qh.defaultValue(e.color,this._color),this._material=new Cesium.PolylineArrowMaterialProperty(new Cesium.CallbackProperty((()=>eA.getColor(this.color)),!1))}set color(e){this._color=e}get color(){return this._color}toJson(){return{type:pA.Arrow,color:this.color}}}class aA extends rA{_color="#ff0000";_outlineWidth=3;_outlineColor="#00ff00";constructor(e){super(),e||(e={}),this._color=qh.defaultValue(e.color,this._color),this._outlineColor=qh.defaultValue(e.outlineColor,this._outlineColor),this._outlineWidth=qh.defaultValue(e.outlineWidth,this._outlineWidth),this._material=new Cesium.PolylineOutlineMaterialProperty({color:new Cesium.CallbackProperty((()=>eA.getColor(this.color)),!1),outlineColor:new Cesium.CallbackProperty((()=>eA.getColor(this.outlineColor)),!1),outlineWidth:new Cesium.CallbackProperty((()=>this.outlineWidth),!1)})}set color(e){this._color=e}get color(){return this._color}set outlineWidth(e){this._outlineWidth=e}get outlineWidth(){return this._outlineWidth}set outlineColor(e){this._outlineColor=e}get outlineColor(){return this._outlineColor}toJson(){return{type:pA.Outline,color:this.color,outlineColor:this.outlineColor,outlineWidth:this.outlineWidth}}}class lA extends rA{_color="#ffff00";_gapColor="rgba(0,0,0,0)";_dashLength=16;_dashPattern=255;constructor(e){super(),e||(e={}),this._color=qh.defaultValue(e.color,this._color),this._gapColor=qh.defaultValue(e.gapColor,this._gapColor),this._dashLength=qh.defaultValue(e.dashLength,this._dashLength),this._dashPattern=qh.defaultValue(e.dashPattern,this._dashPattern),this._material=new Cesium.PolylineDashMaterialProperty({dashLength:new Cesium.CallbackProperty((()=>this.dashLength),!1),color:new Cesium.CallbackProperty((()=>eA.getColor(this._color)),!1),gapColor:new Cesium.CallbackProperty((()=>eA.getColor(this._gapColor)),!1),dashPattern:new Cesium.CallbackProperty((()=>this.dashPattern),!1)})}set color(e){this._color=e}get color(){return this._color}set gapColor(e){this._gapColor=e}get gapColor(){return this._gapColor}set dashLength(e){this._dashLength=e}get dashLength(){return this._dashLength}set dashPattern(e){this._dashPattern=e}get dashPattern(){return this._dashPattern}toJson(){return{type:pA.Dash,color:this.color,gapColor:this.gapColor,dashPattern:this.dashPattern,dashLength:this.dashLength}}}class hA extends rA{_color="#ffffff";_glowPower=.25;_taperPower=1;constructor(e){super(),e||(e={}),this._color=qh.defaultValue(e.color,this._color),this._glowPower=qh.defaultValue(e.glowPower,this._glowPower),this._taperPower=qh.defaultValue(e.taperPower,this._taperPower),this._material=new Cesium.PolylineGlowMaterialProperty({glowPower:new Cesium.CallbackProperty((()=>this.glowPower),!1),color:new Cesium.CallbackProperty((()=>eA.getColor(this._color)),!1),taperPower:new Cesium.CallbackProperty((()=>this.taperPower),!1)})}set color(e){this._color=e}get color(){return this._color}set glowPower(e){this._glowPower=e}get glowPower(){return this._glowPower}set taperPower(e){this._taperPower=e}get taperPower(){return this._taperPower}toJson(){return{type:pA.Glow,color:this.color,taperPower:this.taperPower,glowPower:this.glowPower}}}class cA extends rA{_icon=uA.Attack;_color="#ff0000";_duration=1e4;_update;constructor(e){super(),e||(e={}),this._color=qh.defaultValue(e.color,this._color),this._icon=qh.defaultValue(e.icon,this._icon),this._duration=qh.defaultValue(e.duration,this._duration),this._updateMaterial()}_updateMaterial(){switch(this.icon){case uA.Arrow:this._material=new Cesium.PolylineArrowLinkMaterialProperty({color:eA.getColor(this.color),duration:this.duration});break;case uA.Attack:case uA.Pulse:this._material=new Cesium.PolylinePulseLinkMaterialProperty({color:eA.getColor(this.color),duration:this.duration});break;case uA.Trail:this._material=new Cesium.PolylineTrailLinkMaterialProperty({color:eA.getColor(this.color),duration:this.duration});break;case uA.Attack:this._material=new Cesium.PolylineAttackLinkMaterialProperty({color:eA.getColor(this.color),duration:this.duration})}}setUpdate(e){this._update=e}set icon(e){this._icon=e,this._updateMaterial(),this._update&&this._update("lineStyle")}get icon(){return this._icon}set color(e){this._color=e,this._material.color=eA.getColor(this.color)}get color(){return this._color}set duration(e){this._duration=e,this._material.duration=this.duration}get duration(){return this._duration}toJson(){return{type:this.icon,color:this.color,duration:this.duration}}}class uA{Arrow="arrow";Pulse="pulse";Trail="trail";Attack="attack"}class pA{Color="Color";Arrow="PolylineArrow";Dash="PolylineDash";Glow="PolylineGlow";Outline="PolylineOutline";Dynamic="Dynamic"}var dA,mA=function(){function e(e,t){switch(this._dataItem=e,this.renderType){case dA.Entity:this._renderRoot=t.getRenderRoot().entityRoot;break;case dA.Primitive:this._renderRoot=t.getRenderRoot().primitiveRoot;break;case dA.PostProcess:this._renderRoot=t.getRenderRoot().postProcessStages;break;case dA.Billboard:this._renderRoot=t.getRenderRoot().billboardCollection;break;case dA.Lable:this._renderRoot=t.getRenderRoot().labelCollection;break;case dA.DrawCombination:this._renderRoot=t.getRenderRoot()}this._viewer=t._viewer,this.init(),this.renderObj&&(this.renderType===dA.DrawCombination||(this.renderObj.dataId=e.id))}return Object.defineProperty(e.prototype,"renderType",{get:function(){},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"renderObj",{get:function(){return this._renderObj},enumerable:!1,configurable:!0}),e.prototype.init=function(){},e.prototype.clear=function(){if(this._renderObj)switch(this.renderType){case dA.Entity:case dA.Primitive:case dA.PostProcess:case dA.Billboard:case dA.Lable:this._renderRoot.remove(this._renderObj);case dA.DrawCombination:}this._renderObj=void 0,this._dataItem=void 0,this._viewer=void 0,this._renderRoot=void 0},e.prototype.update=function(){},e.prototype.updateAttribute=function(e){},e}();!function(e){e.Entity="entity",e.Primitive="Primitive",e.PostProcess="PostProcess",e.Lable="Lable",e.Billboard="Billboard",e.DrawCombination="DrawCombination"}(dA||(dA={}));var fA=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),gA=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return fA(t,e),Object.defineProperty(t.prototype,"renderType",{get:function(){return dA.Entity},enumerable:!1,configurable:!0}),t.prototype.init=function(){this.getRenderPositions(),this.updateAttributeForEditing(),this._renderObj=this._renderRoot.add(this._originProps),this._updateAllProp()},t.prototype.update=function(){this._renderObj&&this._renderRoot.remove(this._renderObj),this.init()},t.prototype._dealResProps=function(e){var t=this;this._resProps||(this._resProps={show:!1,polygon:{}});var i=this._dataItem;switch(e){case"show":this._resProps[e]=i.renderVisible;break;case"hierarchy":this._resProps.polygon[e]=i.dirty?this.getRenderPositions():this._positions;break;case"fill":this._resProps.polygon[e]=i.fill;break;case"material":i.material?this._resProps.polygon[e]=i.material:this._resProps.polygon[e]=eA.getColor(i.color);break;case"outline":this._resProps.polygon[e]=i.outline;break;case"outlineColor":this._resProps.polygon[e]=eA.getColor(i.outlineColor);break;case"outlineWidth":this._resProps.polygon[e]=i.outlineWidth;break;case"height":i.clampToGround||(this._resProps.polygon[e]=i.height);break;case"extrudedHeight":i.clampToGround||(this._resProps.polygon[e]=i.extrudedHeight);break;case"perPositionHeight":i.clampToGround||(this._resProps.polygon[e]=i.perPositionHeight);break;case"closeTop":i.clampToGround||(this._resProps.polygon[e]=i.closeTop);break;case"closeBottom":i.clampToGround||(this._resProps.polygon[e]=i.closeBottom);break;default:return}this._renderObj?i.isEditing&&-1!=["fill","outline","outlineColor","outlineWidth"].indexOf(e)?this._renderObj.polygon[e]=new Cesium.CallbackProperty((function(){return t._resProps.polygon[e]}),!1):this._renderObj.polygon[e]=this._resProps.polygon[e]:i.isEditing&&-1!=["fill","outline","outlineColor","outlineWidth"].indexOf(e)&&(this._resProps.polygon[e]=new Cesium.CallbackProperty((function(){return t._resProps.polygon[e]}),!1))},t.prototype.updateAttributeForEditing=function(){this._updateAllProp(),this._renderObj||(this._originProps=this._resProps)},t.prototype._updateAllProp=function(){for(var e=["show","hierarchy","fill","material","outline","outlineColor","outlineWidth","height","extrudedHeight","perPositionHeight","closeTop","closeTop"],t=0;t<e.length;t++)this._dealResProps(e[t])},t.prototype.updateAttribute=function(e){var t=this._dataItem;switch(e){case"visible":this._renderObj.show=this._dataItem.renderVisible;break;case"positions":this._positions=this.getRenderPositions(),this._renderObj.polygon.hierarchy=t.dirty?this.getRenderPositions():this._positions;break;case"height":this._renderObj.polygon.height=t.height;break;case"extrudedHeight":this._renderObj.polygon.extrudedHeight=t.extrudedHeight;break;case"fill":this._renderObj.polygon.fill=t.fill;break;case"color":this._renderObj.polygon.material=eA.getColor(t.color);break;case"material":this._renderObj.polygon.material=t.material;break;case"outline":this._renderObj.polygon.outline=t.outline;break;case"outlineColor":this._renderObj.polygon.outlineColor=eA.getColor(t.outlineColor);break;case"outlineWidth":this._renderObj.polygon.outlineWidth=t.outlineWidth;break;case"perPositionHeight":this._renderObj.polygon.perPositionHeight=t.perPositionHeight;break;case"closeTop":this._renderObj.polygon.closeTop=t.closeTop;break;case"closeBottom":this._renderObj.polygon.closeBottom=t.closeBottom;break;case"clampToGround":this.update();case"isEditing":this.updateAttributeForEditing();break;default:this._updateAllProp()}},t.prototype.getRenderPositions=function(){var e=this._dataItem;return this._positions=eA.getPositions(e.positions),this._positions},t}(mA);class AA extends tA{_opt;_type="PolygonGraphic";constructor(e){super(e),this._opt=new yA,this.parseJson(e),this.fromJsonFilterKeys.push("perPositionHeight")}getType(){return AA.type}static get type(){return"PolygonGraphic"}init(e){if(super.init(e),this.father){let e=new gA(this,this.father.getRoot());this._getRenderObj=()=>e}}set positions(e){this._opt.positions=e,this.updateAttribute("positions")}get positions(){return this._opt.positions}set height(e){this._opt.height!==e&&(this._opt.height=e,this.updateAttribute("height"))}get height(){return this._opt.height}set extrudedHeight(e){this._opt.extrudedHeight!==e&&(this._opt.extrudedHeight=e,this.updateAttribute("extrudedHeight"))}get extrudedHeight(){return this._opt.extrudedHeight}set fill(e){this._opt.fill!==e&&(this._opt.fill=e,this.updateAttribute("fill"))}get fill(){return this._opt.fill}set color(e){this._opt.color!==e&&(this._opt.color=e,this.updateAttribute("color"))}get color(){return this._opt.color}set outline(e){this._opt.outline!==e&&(this._opt.outline=e,this.updateAttribute("outline"))}get outline(){return this._opt.outline}set outlineColor(e){this._opt.outlineColor!==e&&(this._opt.outlineColor=e,this.updateAttribute("outlineColor"))}get outlineColor(){return this._opt.outlineColor}set outlineWidth(e){this._opt.outlineWidth!==e&&(this._opt.outlineWidth=e,this.updateAttribute("outlineWidth"))}get outlineWidth(){return this._opt.outlineWidth}get perPositionHeight(){return this._opt.perPositionHeight}set closeTop(e){this._opt.closeTop!==e&&(this._opt.closeTop=e,this.updateAttribute("closeTop"))}get closeTop(){return this._opt.closeTop}set closeBottom(e){this._opt.closeBottom!==e&&(this._opt.closeBottom=e,this.updateAttribute("closeBottom"))}get closeBottom(){return this._opt.closeBottom}set clampToGround(e){this._opt.clampToGround=e,this.updateAttribute("clampToGround")}get clampToGround(){return this._opt.clampToGround}set dirty(e){this._opt.dirty=e}get dirty(){return this._opt.dirty}set material(e){this._opt.material=e,this.updateAttribute("material")}get material(){return this._opt.material}set stRotation(e){this._opt.stRotation=e,this.updateAttribute("stRotation")}get stRotation(){return this._opt.stRotation}}class yA extends iA{clampToGround=!1;positions;height;extrudedHeight;fill=!0;color="#ffff00";outline=!1;outlineColor="#ff0000";outlineWidth=1;perPositionHeight=!1;closeTop=!0;closeBottom=!0;dirty=!1;material;stRotation}c.Z.registerType(AA,"PolygonGraphic","GraphicItem");var vA=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),CA=function(e){function t(t,i){return e.call(this,t,i)||this}return vA(t,e),Object.defineProperty(t.prototype,"renderType",{get:function(){return dA.Primitive},enumerable:!1,configurable:!0}),t.prototype.init=function(){this.createMaterial(),this.createPrimitive(),this.renderObj&&(this.renderObj.dataId=this._dataItem.id)},t.prototype.update=function(){this._renderObj&&(this._renderRoot.remove(this._renderObj),this._renderObj=void 0),this.init(),this.updateAttribute("color"),this.updateAttribute("visible")},t.prototype.updateAttribute=function(e){var t=this._dataItem;switch(e){case"color":this._appearance.material.uniforms.color=eA.getColor(t[e]);break;case"visible":this._renderObj.show=t[e];break;case"radius":case"startAngle":case"endAngle":case"position":case"clampToGround":case"step":this.update()}},t.prototype.createMaterial=function(){var e=this._dataItem;this._appearance?this._appearance.material.uniforms.color=eA.getColor(e.color):this._appearance=new Cesium.MaterialAppearance({material:new Cesium.Material({fabric:{type:"Color",uniforms:{color:eA.getColor(e.color)}}}),faceForward:!0})},t.prototype.createPrimitive=function(){var e=this._dataItem,t=[],i=0==e.radius?1:e.radius;t=Math.abs(e.endAngle-e.startAngle)<360?Bt.getSectorPositions(e.position,i,e.startAngle,e.endAngle,e.step):Bt.getCirclePositions(e.position,i);var r=[];t.forEach((function(e){r.push(A.toCartesian3(e))}));var n=new Cesium.GeometryInstance({geometry:new Cesium.PolygonGeometry({polygonHierarchy:new Cesium.PolygonHierarchy(r),height:e.position.alt})});e.clampToGround?this._renderObj=this._renderRoot.add(new Cesium.GroundPrimitive({geometryInstances:n,appearance:this._appearance,asynchronous:!1})):this._renderObj=this._renderRoot.add(new Cesium.Primitive({geometryInstances:n,appearance:this._appearance,asynchronous:!1}))},t}(mA);class _A extends tA{_opt;_type="CircularGraphic";constructor(e){super(e),this._opt=new bA,this.parseJson(e)}getType(){return _A.type}static get type(){return"CircularGraphic"}init(e){if(super.init(e),this.father){let e=new CA(this,this.father.getRoot());this._getRenderObj=()=>e}}set position(e){this._opt.position=e,this.updateAttribute("position")}get position(){return this._opt.position}set radius(e){this._opt.radius=e,this.updateAttribute("radius")}get radius(){return this._opt.radius}set startAngle(e){this._opt.startAngle=e,this.updateAttribute("startAngle")}get startAngle(){return this._opt.startAngle}set endAngle(e){this._opt.endAngle=e,this.updateAttribute("endAngle")}get endAngle(){return this._opt.endAngle}set color(e){this._opt.color=e,this.updateAttribute("color")}get color(){return this._opt.color}set clampToGround(e){this._opt.clampToGround=e,this.updateAttribute("clampToGround")}get clampToGround(){return this._opt.clampToGround}set step(e){this._opt.step=e,this.updateAttribute("step")}get step(){return this._opt.step}}class bA extends iA{position;clampToGround=!0;radius=1;startAngle=0;endAngle=360;color="rgba(255, 255, 0, 0.5)";step=64}c.Z.registerType(_A,"CircularGraphic");var wA=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),PA=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return wA(t,e),Object.defineProperty(t.prototype,"renderType",{get:function(){return dA.Entity},enumerable:!1,configurable:!0}),t.prototype.init=function(){var e=this._dataItem;this.updateAttributeForEditing(),this._renderObj=this._renderRoot.add(this._originProps),this._renderObj.dataId=e.id,this._renderObj.dataName=e.name},t.prototype.update=function(){this._renderObj.show=this._dataItem.renderVisible},t.prototype._dealResProps=function(e){var t=this;this._resProps||(this._resProps={show:!1,position:{},label:{}});var i=this._dataItem;switch(e){case"show":this._resProps[e]=i.visible;break;case"position":this._resProps[e]=eA.getPositionDegrees([i.position.lon,i.position.lat,i.position.alt]);break;case"scale":this._resProps.label[e]=i.scale;break;case"text":this._resProps.label[e]=i.text;break;case"heightReference":this._resProps.label[e]=eA.getHeightReference(i.heightReference);break;case"fillColor":this._resProps.label[e]=eA.getColor(i.fillColor);break;case"outlineColor":this._resProps.label[e]=eA.getColor(i.outlineColor);break;case"backgroundColor":this._resProps.label[e]=eA.getColor(i.backgroundColor);break;case"horizontalOrigin":this._resProps.label[e]=eA.getHorizontalOrigin(i.horizontalOrigin);break;case"verticalOrigin":this._resProps.label[e]=eA.getVerticalOrigin(i.verticalOrigin);break;case"pixelOffset":this._resProps.label[e]=eA.getCartesian2(i.pixelOffset);break;case"eyeOffset":this._resProps.label[e]=eA.getCartesian3(i.eyeOffset);break;case"outlineWidth":this._resProps.label[e]=i.outlineWidth;break;case"font":this._resProps.label[e]=i.font;break;case"style":this._resProps.label[e]=eA.getStyle(i.style);break;case"showBackground":this._resProps.label[e]=i.showBackground;break;case"scaleByDistance":this._resProps.label[e]=eA.getNearFarScalar(i.scaleByDistance);break;case"pixelOffsetScaleByDistance":this._resProps.label[e]=eA.getNearFarScalar(i.pixelOffsetScaleByDistance);break;case"translucencyByDistance":this._resProps.label[e]=eA.getNearFarScalar(i.translucencyByDistance);break;case"disableDepthTestDistance":this._resProps.label[e]=i.isDepthTest?void 0:Number.POSITIVE_INFINITY;break;case"distanceDisplayCondition":this._resProps.label[e]=eA.getDistanceDisplayCondition(i.distanceDisplayCondition);break;default:return}this._renderObj&&(i.isEditing?"show"===e||"position"===e?this._renderObj[e]=new Cesium.CallbackProperty((function(){return t._resProps[e]}),!1):this._renderObj.label[e]=new Cesium.CallbackProperty((function(){return t._resProps.label[e]}),!1):"show"===e||"position"===e?this._renderObj[e]=this._resProps[e]:this._renderObj.label[e]=this._resProps.label[e])},t.prototype.updateAttributeForEditing=function(){this._updateAllProp(),this._renderObj||(this._originProps=this._resProps)},t.prototype._updateAllProp=function(){for(var e=["show","position","scale","text","heightReference","fillColor","outlineColor","backgroundColor","horizontalOrigin","verticalOrigin","pixelOffset","eyeOffset","outlineWidth","font","style","showBackground","scaleByDistance","pixelOffsetScaleByDistance","translucencyByDistance","disableDepthTestDistance","distanceDisplayCondition"],t=0;t<e.length;t++)this._dealResProps(e[t])},t.prototype.updateAttribute=function(e){if(this._renderObj&&this._dataItem)switch(e){case"visible":this.update();break;case"isEditing":this.updateAttributeForEditing();break;default:this._updateAllProp()}},t}(mA);class SA extends tA{_opt;_type="LabelGraphic";constructor(e){super(e),this._opt=new xA,this.parseJson(e)}init(e){if(super.init(e),this.father){let e=new PA(this,this.father.getRoot());this._getRenderObj=()=>e}}getRenderObject(){return this._getRenderObj()}getType(){return SA.type}static get type(){return"LabelGraphic"}set position(e){this._opt.position=e,this.updateAttribute("position")}get position(){return this._opt.position}set text(e){this._opt.text=e,this.updateAttribute("text")}get text(){return this._opt.text}set scale(e){this._opt.scale!==e&&(this._opt.scale=e,this.updateAttribute("scale"))}get scale(){return this._opt.scale}set horizontalOrigin(e){this._opt.horizontalOrigin!==e&&(this._opt.horizontalOrigin=e,this.updateAttribute("horizontalOrigin"))}get horizontalOrigin(){return this._opt.horizontalOrigin}set verticalOrigin(e){this._opt.verticalOrigin!==e&&(this._opt.verticalOrigin=e,this.updateAttribute("verticalOrigin"))}get verticalOrigin(){return this._opt.verticalOrigin}set eyeOffset(e){this._opt.eyeOffset=e,this.updateAttribute("eyeOffset")}get eyeOffset(){return this._opt.eyeOffset}set pixelOffset(e){this._opt.pixelOffset=e,this.updateAttribute("pixelOffset")}get pixelOffset(){return this._opt.pixelOffset}set outlineWidth(e){this._opt.outlineWidth!==e&&(this._opt.outlineWidth=e,this.updateAttribute("outlineWidth"))}get outlineWidth(){return this._opt.outlineWidth}set font(e){this._opt.font!==e&&(this._opt.font=e,this.updateAttribute("font"))}get font(){return this._opt.font}set style(e){this._opt.style!==e&&(this._opt.style=e,this.updateAttribute("style"))}get style(){return this._opt.style}set fillColor(e){this._opt.fillColor!==e&&(this._opt.fillColor=e,this.updateAttribute("fillColor"))}get fillColor(){return this._opt.fillColor}set outlineColor(e){this._opt.outlineColor!==e&&(this._opt.outlineColor=e,this.updateAttribute("outlineColor"))}get outlineColor(){return this._opt.outlineColor}set backgroundColor(e){this._opt.backgroundColor!==e&&(this._opt.backgroundColor=e,this.updateAttribute("backgroundColor"))}get backgroundColor(){return this._opt.backgroundColor}set scaleByDistance(e){this._opt.scaleByDistance=e,this.updateAttribute("scaleByDistance")}get scaleByDistance(){return this._opt.scaleByDistance}set pixelOffsetScaleByDistance(e){this._opt.pixelOffsetScaleByDistance=e,this.updateAttribute("pixelOffsetScaleByDistance")}get pixelOffsetScaleByDistance(){return this._opt.pixelOffsetScaleByDistance}set showBackground(e){this._opt.showBackground=e,this.updateAttribute("showBackground")}get showBackground(){return this._opt.showBackground}set heightReference(e){this._opt.heightReference!==e&&(this._opt.heightReference=e,this.updateAttribute("heightReference"))}get heightReference(){return this._opt.heightReference}set translucencyByDistance(e){this._opt.translucencyByDistance=e,this.updateAttribute("translucencyByDistance")}get translucencyByDistance(){return this._opt.translucencyByDistance}set isDepthTest(e){this._opt.isDepthTest=e,this.updateAttribute("isDepthTest")}get isDepthTest(){return this._opt.isDepthTest}set distanceDisplayCondition(e){this._opt.distanceDisplayCondition=e,this.updateAttribute("distanceDisplayCondition")}get distanceDisplayCondition(){return this._opt.distanceDisplayCondition}}class xA extends iA{position;text;scale=1;horizontalOrigin;verticalOrigin;eyeOffset;pixelOffset;outlineWidth=1;font="30px sans-serif";style;fillColor;outlineColor;backgroundColor;scaleByDistance;pixelOffsetScaleByDistance;showBackground;heightReference;translucencyByDistance;isDepthTest=!0;distanceDisplayCondition}c.Z.registerType(SA,"LabelGraphic");var BA=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),MA=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return BA(t,e),t.prototype.init=function(){var e=this._dataItem;this._container=this._viewer.container,this._initDom(this._container),e.panelDrag&&this._bindEvent(),this._preRender(this._viewer),this._renderObj=this},t.prototype.clear=function(){this._container&&this._parentNode&&(this._removeElement(this._parentNode),this._removeEvent(),this._bubbleEvent&&this._viewer.scene.preRender.removeEventListener(this._bubbleEvent))},t.prototype.updateAttribute=function(e){var t=this._dataItem;if(t)switch(e){case"panelDrag":t.panelDrag?this._bindEvent():this._removeEvent();break;case"panelOffset":this._anchorOffset&&this._updatePanelPosition(this._anchorOffset.x+t.panelOffset.x,this._anchorOffset.y+t.panelOffset.y)}},t.prototype.update=function(){},t.prototype.pointIsVisible=function(e,t){if(t.scene.mode==Cesium.SceneMode.SCENE3D){var i=t.scene.camera.positionWC,r=t.scene.mapProjection.ellipsoid;if(new Cesium.EllipsoidalOccluder(r,i).isPointVisible(A.toCartesian3(e))){var n=t.scene,o=n.canvas,s=Cesium.SceneTransforms.wgs84ToWindowCoordinates(n,A.toCartesian3(e));return void 0!==s&&(s.x>0&&s.x<(void 0!==o.width?o.width:o.clientWidth)&&s.y>0&&s.y<(void 0!==o.height?o.height:o.clientHeight))}return!1}var a=t.scene.camera.frustum.computeCullingVolume(t.scene.camera.positionWC,t.scene.camera.directionWC,t.scene.camera.upWC),l=new Cesium.BoundingSphere(A.toCartesian3(e),1),h=Cesium.BoundingSphere.projectTo2D(l),c=a.computeVisibility(h);return c===Cesium.Intersect.INSIDE||c===Cesium.Intersect.INTERSECTING},t.prototype._preRender=function(e){var t,i,r=this,n=this._dataItem;e.scene.preRender.addEventListener(this._bubbleEvent=function(){if(n.renderVisible){if(n.bindObject instanceof EA){var o=n.bindObject.getRenderObject();if(!o._renderVisible)return void(r._renderVisible&&r._showDiv(!1));t=o._diagonalPanelOffset.x,i=o._diagonalPanelOffset.y}else{var s=void 0;if(n.bindObject instanceof A?s=n.bindObject:n.bindObject instanceof tA&&(s=n.bindObject.getCenterPosition()),!s)return;if(!r.pointIsVisible(s,e))return void(r._renderVisible&&r._showDiv(!1));var a=A.toScreen(s,e);if(!a)return;t=Math.round(a.x),i=Math.round(a.y)}r._anchorOffset={x:t,y:i},r._updateDiv(t,i)}else r._renderVisible&&r._showDiv(!1)})},t.prototype._updateDiv=function(e,t){var i=this._dataItem;if(this._renderVisible||(this._parentNode.style.cssText="visibility:hidden"),i.bubbleType===OA.FollowBubble){if(!this._renderVisible){var r=e+i.panelOffset.x,n=t+i.panelOffset.y;this._panelOffset&&(r=this._panelOffset.x,n=this._panelOffset.y),this._updatePanelPosition(r,n)}}else i.bubbleType===OA.FixedBubble&&(this._isMouseDown||this._updatePanelPosition(e+i.panelOffset.x,t+i.panelOffset.y));var o=this._updateLinePosition({x:e,y:t},this._panelNode);this._getDiagonalPanelOffset(o),this._renderVisible||(this._parentNode.style.cssText="display:none",this._showDiv(!0))},t.prototype._getDiagonalPanelOffset=function(e){if(this._panelOffset){var t,i;switch(e){case 1:t=this._panelOffset.x+this._panelNode.offsetWidth,i=this._panelOffset.y;break;case 2:t=this._panelOffset.x,i=this._panelOffset.y;break;case 3:t=this._panelOffset.x,i=this._panelOffset.y+this._panelNode.offsetHeight;break;case 4:t=this._panelOffset.x+this._panelNode.offsetWidth,i=this._panelOffset.y+this._panelNode.offsetHeight}this._diagonalPanelOffset={x:t,y:i}}},t.prototype._updateLinePosition=function(e,t){if(0!==t._offsetLeft||0!==t._offsetTop){var i,r={x:e.x,y:e.y};this._panelNode.offsetParent!==this._container&&(r.y=r.y+this._container.offsetTop,r.x=r.x+this._container.offsetLeft);var n=t.offsetWidth,o=t.offsetHeight,s=t.offsetLeft+n/2,a=t.offsetTop+o/2,l={x:0,y:0},h=s-r.x,c=a-r.y;h>=0&&c>0?(l.x=t.offsetLeft,l.y=t.offsetTop,i=4):h>=0&&c<=0?(l.x=t.offsetLeft,l.y=t.offsetTop+o,i=1):h<0&&c<=0?(l.x=t.offsetLeft+n,l.y=t.offsetTop+o,i=2):h<0&&c>0&&(l.x=t.offsetLeft+n,l.y=t.offsetTop,i=3),h=l.x-r.x,c=l.y-r.y;var u=Math.sqrt(h*h+c*c),p=u/2,d=Math.acos(h/u)*(c<0?-1:1),m=d/Math.PI*180,f=p*Math.sin(d),g=p*Math.cos(d)-p;return this._lineNode.style.width="".concat(u,"px"),this._lineNode.style.left="".concat(r.x-2,"px"),this._lineNode.style.top="".concat(r.y-2,"px"),this._lineNode.style.transform="translate(".concat(g,"px,").concat(f,"px) rotate(").concat(m,"deg)"),i}},t.prototype._updatePanelPosition=function(e,t){var i,r,n=this._container.clientWidth,o=this._container.clientHeight,s=this._panelNode.offsetWidth,a=this._panelNode.offsetHeight;i=e<0||s>=n?0:e+s>=n?n-s:e,r=t<0||a>=o?0:t+a>=o?o-a:t,this._panelOffset={x:i,y:r};var l=r,h=i;this._panelNode.offsetParent!==this._container&&(l=r+this._container.offsetTop,h=i+this._container.offsetLeft),this._panelNode.style.left="".concat(h,"px"),this._panelNode.style.top="".concat(l,"px")},t.prototype._showDiv=function(e){this._parentNode.style.display=e?"block":"none",this._renderVisible=e},t.prototype._initDom=function(e){var t="geoBubbleRoot";this._parentNode=this._createDom("geoBubble"),this._panelNode=this._createDom("geoBubblePanel","".concat("position:absolute;cursor:pointer;user-select:none;","top:0px;left:0px;")),this._lineNode=this._createDom("geoBubbleLine","".concat("position:absolute;border:1px dotted #fff;","top:0px;left:0px;")),this._parentNode.appendChild(this._panelNode),this._parentNode.appendChild(this._lineNode),this._showDiv(!1),this._getDom(".".concat(t))?this._rootNode=this._getDom(".".concat(t)):(this._rootNode=this._createDom(t),e.appendChild(this._rootNode)),this._rootNode.appendChild(this._parentNode)},t.prototype._createDom=function(e,t){var i=document.createElement("div");return i.setAttribute("class",e),i.style.cssText=t,i},t.prototype._getDivOffsetOfBody=function(e){},t.prototype._getDom=function(e){return document.querySelector(e)},t.prototype._mouseDown=function(e){if(this._dataItem.renderVisible)if(this._isMouseDown)this._isMouseDown=!1;else if(1===e.which){e.stopPropagation();var t=this._panelNode.getBoundingClientRect();this._isMouseDown=!0,this._downX=e.clientX-t.left,this._downY=e.clientY-t.top}},t.prototype._mouseMove=function(e){var t=this._dataItem;if(t.renderVisible&&!0===this._isMouseDown){e.stopPropagation();var i=this._container.getBoundingClientRect(),r=e.clientX-this._downX-i.left,n=e.clientY-this._downY-i.top;this._updatePanelPosition(r,n),t.panelOffset={x:this._panelOffset.x-this._anchorOffset.x,y:this._panelOffset.y-this._anchorOffset.y}}},t.prototype._mouseUp=function(e){this._isMouseDown=!1,this._dataItem.renderVisible},t.prototype._touchStart=function(e){if(this._dataItem.renderVisible)if(this._isMouseDown)this._isMouseDown=!1;else{e.stopPropagation();var t=this._panelNode.getBoundingClientRect();this._isMouseDown=!0,this._downX=e.touches.clientX-t.left,this._downY=e.touches.clientY-t.top}},t.prototype._touchMove=function(e){var t=this._dataItem;if(t.renderVisible&&(e.stopPropagation(),!0===this._isMouseDown)){var i=this._container.getBoundingClientRect(),r=e.touches.clientX-this._downX-i.left,n=e.touches.clientY-this._downY-i.top;this._updatePanelPosition(r,n),t.panelOffset={x:this._panelOffset.x-this._anchorOffset.x,y:this._panelOffset.y-this._anchorOffset.y}}},t.prototype._touchEnd=function(e){this._dataItem.renderVisible&&(e.stopPropagation(),this._isMouseDown=!1)},t.prototype._removeElement=function(e){var t=e.parentNode;t&&t.removeChild(e)},t.prototype._bindEvent=function(){var e=this;this._panelNode.addEventListener("mousedown",this._fnDown=function(t){return e._mouseDown(t)}),this._container.addEventListener("mouseup",this._fnUp=function(t){return e._mouseUp(t)}),this._container.addEventListener("mousemove",this._fnMove=function(t){return e._mouseMove(t)}),this._panelNode.addEventListener("touchstart",this._fnStart=function(t){return e._touchStart(t)}),this._container.addEventListener("touchend",this._fnEnd=function(t){return e._touchEnd(t)}),this._container.addEventListener("touchmove",this._fnTMove=function(t){return e._touchMove(t)})},t.prototype._removeEvent=function(){this._container&&(this._container.removeEventListener("mouseup",this._fnUp),this._panelNode.removeEventListener("mousedown",this._fnDown),this._container.removeEventListener("mousemove",this._fnMove),this._container.removeEventListener("touchend",this._fnEnd),this._panelNode.removeEventListener("touchstart",this._fnStart),this._container.removeEventListener("touchmove",this._fnTMove))},t}(mA);class EA extends tA{_opt;_type="BubbleGraphic";constructor(e){super(e),this._opt=new TA,this.parseJson(e)}getType(){return EA.type}static get type(){return"BubbleGraphic"}get bubbleType(){return this._opt.bubbleType}set bubbleType(e){this._opt.bubbleType=e}get panelOffset(){return this._opt.panelOffset}set panelOffset(e){this._opt.panelOffset=e,this.updateAttribute("panelOffset")}get bindObject(){return this._opt.bindObject}set bindObject(e){this._opt.bindObject=e,this.updateAttribute("bindObject")}get panelDom(){return this.getRenderObject()._panelNode}get lineDom(){return this.getRenderObject()._lineNode}get panelDrag(){return this._opt.panelDrag}set panelDrag(e){this._opt.panelDrag=e,this.updateAttribute("panelDrag")}init(e){if(super.init(e),this.father){let e=new MA(this,this.father.getRoot());this._getRenderObj=()=>e}}getRenderObject(){return this._getRenderObj()}}class TA extends iA{panelOffset={x:200,y:100};panelDrag=!0;bindObject;bubbleType=OA.FixedBubble;visible=!0}class OA{FixedBubble="fixedBubble";FollowBubble="followBubble"}c.Z.registerType(EA,"BubbleGraphic");var LA=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),DA=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return LA(t,e),Object.defineProperty(t.prototype,"renderType",{get:function(){return dA.Entity},enumerable:!1,configurable:!0}),t.prototype.init=function(){var e=this,t=this._dataItem;this.getRenderPositions(),t.lineStyle instanceof cA&&t.lineStyle.setUpdate((function(t){e.updateAttribute(t)})),this.updateAttributeForEditing(),this._renderObj=this._renderRoot.add(this._originProps),this._renderObj.dataId=t.id,this._renderObj.dataName=t.name},t.prototype.update=function(){var e=this,t=this._dataItem;this._renderObj.show=t.renderVisible,this.getRenderPositions(),t.lineStyle instanceof cA&&t.lineStyle.setUpdate((function(t){e.updateAttribute(t)})),this._renderObj.polyline.material=t.lineStyle.getMaterial()},t.prototype.getRenderPositions=function(){var e,t;if(void 0!==(t="ParabolaLineGraphic"==this._dataItem.getType()?(e=this._dataItem).interpolation?e.getInterpolationCallback(e.positions):e.positions:(e=this._dataItem).getInterpolationCallback(e.positions)))return 0===t.length?(this._positions=[],this._positions):(t[0]instanceof A?this._positions=eA.getPositions(t):this._positions=t,this._positions)},t.prototype._dealResProps=function(e){var t=this;this._resProps||(this._resProps={});var i=this._dataItem;switch(e){case"positions":this._resProps[e]=this.getRenderPositions();break;case"width":this._resProps[e]=i.width;break;case"material":this._resProps[e]=i.lineStyle.getMaterial();break;case"clampToGround":this._resProps[e]=i.clampToGround;break;case"arcType":this._resProps[e]=i.arcType;break;default:return}this._renderObj&&(i.isEditing&&"material"!=e?this._renderObj.polyline[e]=new Cesium.CallbackProperty((function(){return t._resProps[e]}),!1):this._renderObj.polyline[e]=this._resProps[e])},t.prototype.updateAttributeForEditing=function(){var e=this._dataItem;this._updateAllProp(),this._renderObj||(this._originProps={show:e.renderVisible,polyline:this._resProps})},t.prototype._updateAllProp=function(){for(var e=["positions","width","material","clampToGround","arcType"],t=0;t<e.length;t++)this._dealResProps(e[t])},t.prototype.updateAttribute=function(e){var t=this,i=this._dataItem;switch(e){case"visible":this._renderObj.show=this._dataItem.renderVisible;break;case"lineStyle":i.lineStyle instanceof cA&&i.lineStyle.setUpdate((function(e){t.updateAttribute(e)})),this._renderObj.polyline.material=i.lineStyle.getMaterial();break;case"isEditing":this.updateAttributeForEditing();break;default:this._updateAllProp()}},t}(mA),IA=i(5108);class RA extends tA{_opt;_type="PolylineGraphic";_interpolationCallback;constructor(e){super(e),this._opt=new HA,this.parseJson(e)}getType(){return RA.type}static get type(){return"PolylineGraphic"}init(e){if(super.init(e),this.father){let e=new DA(this,this.father.getRoot());this._getRenderObj=()=>e}}set positions(e){this._opt.positions=e,this.updateAttribute("positions")}get positions(){return this._opt.positions}set arcType(e){this._opt.arcType!==e&&(this._opt.arcType=e,this.updateAttribute("arcType"))}get arcType(){return this._opt.arcType}set clampToGround(e){this._opt.clampToGround!==e&&(!0!==e||this.arcType!==FA.None?(this._opt.clampToGround=e,this.updateAttribute("clampToGround")):IA.warn(`id为${this.id}的PolylineGraphic对象贴地属性设置无效，当ArcType属性的参数为非ArcTypeEnum.None时才可设置`))}get clampToGround(){return this.arcType!==FA.None&&this._opt.clampToGround}set width(e){this._opt.width!==e&&(this._opt.width=e,this.updateAttribute("width"))}get width(){return this._opt.width}set dirty(e){this._opt.dirty=e}get dirty(){return this._opt.dirty}set lineStyle(e){this._opt.lineStyle=e,this.updateAttribute("lineStyle")}get lineStyle(){return this._opt.lineStyle}setInterpolationCallback(e){this._interpolationCallback=e}getInterpolationCallback(){return this._interpolationCallback?this._interpolationCallback(value):value}}class HA extends iA{lineStyle=new oA("#ffff00");positions;arcType=FA.Geodesic;clampToGround=!1;width;dirty=!1}class FA{Geodesic=Cesium.ArcType.GEODESIC;None=Cesium.ArcType.NONE;Rhumb=Cesium.ArcType.RHUMB}c.Z.registerType(RA,"PolylineGraphic");const NA={Tileset:w.Z,Terrain:I,Imagery:se,Model:li,CameraVideo:Ci,Viewshed:wi,Polygon:Pi.Z,Polyline:Si.Z,Path:Hi,Pin:Wi,ODLines:Ji,Scanline:or,FlattenedPolygonCollection:sr.Z,ClippingPlane:ar.Z,Points:Ti.Z,Coordinates:fr,Circle:Ar,Cylinder:vr,PlotBase:hr,GroundImage:br,Water:Sr,CustomPrimitive:bn,CustomGroundRectangle:Sn,HeatMap:Dn,Forest:mo,DynamicPois:Fo,Road:ko,Wall:Wo,ClassificationPolygon:$o,Surface:ds,CutSurface:gs,GeoJSON:ws,KML:xs,Czml:Es,Proxy:Ls,NativeRender:Ns,Plots:cg,Radar:Qg,GraphicGroup:Gg,DynamicItem:$g,ColorStyle:oA,ArrowStyle:sA,OutlineStyle:aA,DashStyle:lA,GlowStyle:hA,DynamicStyle:cA,DynamicIconEnum:uA,CircularGraphic:_A,LabelGraphic:SA,BubbleGraphic:EA,PolylineGraphic:RA,PolygonGraphic:AA};var QA=i(5108);let kA,UA,jA,GA,zA;function YA(){return kA||"undefined"!=typeof rxjs?Promise.resolve():(kA=R.Z.loadJS(R.Z.gvolEarthDir+"resources/thirdParty/rxjs/6.5.2/rxjs.umd.min.js").then((()=>{kA=void 0})),kA)}function ZA(){return UA||"undefined"!=typeof Cesium?Promise.resolve():(UA=R.Z.loadCesium(R.Z.nativeCesiumDir).then((()=>UA=void 0)),UA)}function WA(){return zA||Cesium.viewerCesiumNavigationMixin?Promise.resolve():(zA=R.Z.loadJS(R.Z.gvolEarthDir+"resources/thirdParty/navigator/standalone/viewerCesiumNavigationMixin.js").then((()=>zA=void 0)),zA)}function XA(e){return window.LoadMode=e,1===e?Promise.all([YA(),jA||"undefined"!=typeof THREE?Promise.resolve():(jA=R.Z.loadThreeJS(R.Z.gvolEarthDir+"resources/thirdParty/threejs142/three.min.js").then((()=>UA=void 0)),jA),ZA(),(GA||void 0!==Cesium.xbsj?Promise.resolve():(GA=R.Z.loadJS(R.Z.cesiumDir+"GvolCesium.js").then((()=>GA=void 0)),GA)).then(WA)]).then((()=>XA.isReady=!0)):Promise.all([YA(),ZA()]).then((()=>XA.isReady=!0))}"undefined"!=typeof Cesium||(QA.log("Cesium 需要先加载Cesium库"),XA.isCesiumReady=!1);const JA=XA;const KA=class{constructor(){this._freeObjectsMap=new Map,this._currentUsedListStack=[]}begin(){this._currentUsedList=[],this._currentUsedListStack.push(this._currentUsedList)}get(e){let t,i=this._freeObjectsMap.get(e);return i||(i=[],this._freeObjectsMap.set(e,i)),t=i.length>0?i.pop():new e,this._currentUsedList.push(t),t}end(){this._currentUsedList.forEach((e=>{const t=e.constructor;this._freeObjectsMap.get(t).push(e)})),this._currentUsedListStack.pop()}};var VA=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),qA=function(e){function t(t){var i=e.call(this)||this;return i._viewer=t,i}return VA(t,e),t.prototype.add=function(t){return e.prototype.add.call(this,t),t.initItem(this._viewer),this.fire("add",t),t},t.prototype.remove=function(t){var i;i=Pt.isString(t)?t:t.id;var r=e.prototype.remove.call(this,i);if(void 0!==r)return r.destroyItem(),this.fire("remove",r),r},t.prototype.parseJson=function(e){},t}(f),$A=function(){function e(){}return e.PlottingCommon=function(){},Object.defineProperty(e,"cursorPos",{get:function(){return e._cursorPos},set:function(t){e._cursorPos=t,e.currentGraph&&(e.currentGraph._singleControlPosition[e.index]=t)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"currentGraph",{get:function(){return this._currentGraph},set:function(e){this._currentGraph=e},enumerable:!1,configurable:!0}),e.calculateMouseEvent=function(t){t.startPosition?(t.endPosition.x=t.endPosition.x/e.scalePercent,t.endPosition.y=t.endPosition.y/e.scalePercent,t.startPosition.x=t.startPosition.x/e.scalePercent,t.startPosition.y=t.startPosition.y/e.scalePercent):t.position&&(t.position.x=t.position.x/e.scalePercent,t.position.y=t.position.y/e.scalePercent)},e.index=0,e.heightReferenceOption=[{label:"贴地",value:1},{label:"绝对高度",value:0},{label:"相对高度",value:2}],e.scalePercent=1,e}(),ey=function(){function e(){}return e.register=function(e){this._caches.set(e.id,e)},e.getGraph=function(e){return this._caches.get(e)},e._caches=new Map,e}(),ty=function(){function e(){}return e.Remove=function(e,t){var i=e.indexOf(t);i>-1&&e.splice(i,1)},e.moveItem=function(e,t,i){return e[t]=e.splice(i,1,e[t])[0],e},e.Cartesian3ArrayEqual=function(e,t){if(!e||!t)return!1;if(e.length!=t.length)return!1;for(var i=0;i<e.length;i++){if(!e[i]||!t[i])return!1;if(!e[i].equals(t[i]))return!1}return!0},e}(),iy=function(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],r=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},ry=function(){function e(e){this.entities=[],this.entityCollection=e}return e.prototype.add=function(e){var t=this.entityCollection.add(e);return this.entities.push(t),t.owner=this,t},e.prototype.remove=function(e){this.entityCollection.remove(e),ty.Remove(this.entities,e)},e.prototype.removeAll=function(){var e,t;try{for(var i=iy(this.entities),r=i.next();!r.done;r=i.next()){var n=r.value;this.entityCollection.remove(n)}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}this.entities=[]},Object.defineProperty(e.prototype,"show",{get:function(){return this._show},set:function(e){var t,i;this._show=e;try{for(var r=iy(this.entities),n=r.next();!n.done;n=r.next()){n.value.show=e}}catch(e){t={error:e}}finally{try{n&&!n.done&&(i=r.return)&&i.call(r)}finally{if(t)throw t.error}}},enumerable:!1,configurable:!0}),e}(),ny=function(){function e(e){this._map=e}return e.prototype.init=function(e){},e.prototype.clear=function(){},e.prototype.updateAttribute=function(e){},e}();const oy=ny;var sy=function(){function e(e){this._value=void 0,this._hasClone=!1,this._hasEquals=!1,this._definitionChanged=new Cesium.Event,this._constant=!1,this.setValue(e)}return Object.defineProperty(e.prototype,"isConstant",{get:function(){return this._constant},set:function(e){this._constant!==e&&(this._constant=e,this._definitionChanged.raiseEvent(this))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"definitionChanged",{get:function(){return this._definitionChanged},enumerable:!1,configurable:!0}),e.prototype.getValue=function(e,t){return this._hasClone?this._value.clone(t):this._value},e.prototype.setValue=function(e){var t=this._value;if(t!==e){var i=Cesium.defined(e),r=i&&"function"==typeof e.clone,n=i&&"function"==typeof e.equals;this._hasClone=r,this._hasEquals=n,(!n||!e.equals(t))&&(this._value=r?e.clone():e,this._definitionChanged.raiseEvent(this))}},e.prototype.equals=function(t){return this===t||t instanceof e&&(!this._hasEquals&&this._value===t._value||this._hasEquals&&this._value.equals(t._value))},e}();const ay=sy;var ly=i(5108),hy=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),cy=function(e){function t(t,i){return e.call(this)||this}return hy(t,e),t.prototype.getRadians=function(e){if(e&&"number"==typeof e)return Cesium.Math.toRadians(e)},t.prototype.getCartesian2=function(e){if(ly.log(!(e instanceof Array)),e&&e instanceof Array&&!(e.length<2))return new Cesium.Cartesian2(e[0],e[1])},t.prototype.getCartesian3=function(e){if(e&&e instanceof Array&&!(e.length<3))return new Cesium.Cartesian3(e[0],e[1],e[2])},t.prototype.getRadii=function(e){if(e&&e instanceof Array&&!(e.length<3))return new Cesium.Cartesian3(e[0],e[1],e[2])},t.prototype.getHeading=function(e){if(e)return Cesium.Math.toRadians(e)},t.prototype.getHpr=function(e,t,i){return new Cesium.HeadingPitchRoll(e,t,i)},t.prototype.getOrientation=function(e,t){return Cesium.Transforms.headingPitchRollQuaternion(e,t)},t.prototype.getPositionDegrees=function(e){if(e&&e instanceof Array&&!(e.length<2))return Cesium.Cartesian3.fromDegrees(e[0],e[1],e[2])},t.prototype.getRectangleDegress=function(e){if(e&&!(e.length<3))return Cesium.Rectangle.fromDegrees(e[0],e[1],e[2],e[3])},t.prototype.getColor=function(e){if(e)return Cesium.Color.fromCssColorString(e)},t.prototype.getImage=function(e){if(e)return new Cesium.ImageMaterialProperty({image:e,transparent:!1,color:Cesium.Color.WHITE,repeat:new Cesium.Cartesian2(1,1)})},t.prototype.getShadows=function(e){var t=void 0;switch(e){case"cast_only":t=Cesium.ShadowMode.CAST_ONLY;break;case"disabled":t=Cesium.ShadowMode.DISABLED;break;case"enabled":t=Cesium.ShadowMode.ENABLED;break;case"receive_only":t=Cesium.ShadowMode.RECEIVE_ONLY}return t},t.prototype.getPositions=function(e){if(e&&e instanceof Array&&!(e.length<2)){var t=[];switch(e[0].length){case 2:return e.map((function(e,i){2==e.length?(t.push(e[0]),t.push(e[1])):ly.log("第".concat(i,"条数据中存在错误数据"))})),new ay(Cesium.Cartesian3.fromDegreesArray(t));case 3:return e.map((function(e,i){3==e.length?(t.push(e[0]),t.push(e[1]),t.push(e[2])):ly.log("第".concat(i,"条数据中存在错误数据"))})),new ay(Cesium.Cartesian3.fromDegreesArrayHeights(t));default:ly.log("第1条数据中存在错误数据")}}},t.prototype.getHorizontalOrigin=function(e){var t=void 0;switch(e){case"left":t=Cesium.HorizontalOrigin.LEFT;break;case"center":t=Cesium.HorizontalOrigin.CENTER;break;case"right":t=Cesium.HorizontalOrigin.RIGHT}return t},t.prototype.getVerticalOrigin=function(e){var t=void 0;switch(e){case"baseline":t=Cesium.VerticalOrigin.BASELINE;break;case"bottom":t=Cesium.VerticalOrigin.BOTTOM;break;case"center":t=Cesium.VerticalOrigin.CENTER;break;case"top":t=Cesium.VerticalOrigin.TOP}return t},t.prototype.getHeightReference=function(e){var t=void 0;switch(e){case"clamp_to_ground":t=Cesium.HeightReference.CLAMP_TO_GROUND;break;case"none":t=Cesium.HeightReference.NONE;break;case"relative_to_ground":t=Cesium.HeightReference.RELATIVE_TO_GROUND}return t},t.prototype.getNearFarScalar=function(e){if(e)return new Cesium.NearFarScalar(e[0],e[1],e[2],e[3])},t.prototype.getDistanceDisplayCondition=function(e){if(e)return new Cesium.DistanceDisplayCondition(e[0],e[1])},t.prototype.getClassificationType=function(e){var t=void 0;switch(e){case"both":t=Cesium.ClassificationType.BOTH;break;case"cesium_3D_tile":t=Cesium.ClassificationType.CESIUM_3D_TILE;break;case"terrain":t=Cesium.ClassificationType.TERRAIN}return t},t.prototype.getGranularity=function(e){var t=Cesium.Math.DEGREES_PER_RADIAN;switch(e){case"degrees_per_radian":t=Cesium.Math.RADIANS_PER_DEGREE;break;case"epsilon1":t=Cesium.Math.EPSILON1;break;case"epsilon2":t=Cesium.Math.EPSILON2;break;case"epsilon3":t=Cesium.Math.EPSILON3;break;case"epsilon34":t=Cesium.Math.EPSILON4}return t},t}(oy);const uy=cy;const py=function(){function e(){}return e.getInstance=function(){return this.instance||(this.instance=new e),this.instance},Object.defineProperty(e.prototype,"gxCluster",{get:function(){return this._gxCluster},set:function(e){this._gxCluster=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"gxClusterOption",{get:function(){return this._gxClusterOption},set:function(e){this._gxClusterOption=e},enumerable:!1,configurable:!0}),e.prototype.createCtrlPointCanvas=function(){if(this.pointCanvas)return this.pointCanvas;var e=document.createElement("canvas");e.width=18,e.height=18;var t=e.getContext("2d");return t.lineWidth=2,t.strokeStyle="#F3B713",t.fillStyle="#ffffff",t.beginPath(),t.arc(9,9,6,0,2*Math.PI,!1),t.stroke(),t.closePath(),t.fill(),this.pointCanvas=e,e},e.prototype.createMidPointCanvas=function(){if(this.middlePointCanvas)return this.middlePointCanvas;var e=document.createElement("canvas");e.width=15,e.height=15;var t=e.getContext("2d");return t.lineWidth=2,t.strokeStyle="#F3B713",t.fillStyle="#ffffffa0",t.beginPath(),t.arc(7.5,7.5,5,0,2*Math.PI,!1),t.stroke(),t.closePath(),t.fill(),this.middlePointCanvas=e,e},e}();var dy=function(e){return function(t,i){e.key=i,e.type,e.type||(e.type="text"),"number"!==e.type||e.valueConvert||(e.valueConvert=parseInt),e.initState||(e.initState="hidden"),e.order||(e.order=Number.MAX_VALUE),void 0===e.showGroup&&(e.showGroup=!0),void 0===e.showHelp&&(e.showHelp=!0),"color"!=e.type||e.colorType||(e.colorType="hex"),"colorWithAlpha"!=e.type||e.colorType||(e.colorType="rgb");var r=t.__meta__;if(r){if(t.__proto__.__meta__===r){var n=Object.create(Object.getPrototypeOf(r));Object.getOwnPropertyNames(r).forEach((function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(r,e))})),r=n,t.__meta__=r}}else r={},t.__meta__=r;r[i]&&delete r[i],Object.defineProperty(r,i,{enumerable:!0,configurable:!0,get:function(){return e},set:function(t){return e=t}})}},my=i(2096),fy=i(9727),gy=i(4074),Ay=function(e,t,i,r){this.x=e,this.y=t,this.z=i,this.time=r},yy=function(){function e(){}return e.toggleTime=function(e){var t=new Date(e),i=t.getMonth()>9?t.getMonth()+1:"0"+(t.getMonth()+1),r=t.getDay()>9?t.getDay()+1:"0"+(t.getDay()+1),n=t.getHours()>9?t.getHours():"0"+t.getHours(),o=t.getMinutes()>9?t.getMinutes():"0"+t.getMinutes(),s=t.getSeconds()>9?t.getSeconds():"0"+t.getSeconds();return t.getFullYear()+"/"+i+"/"+r+"/"+n+":"+o+":"+s},e.formatSeconds=function(e,t){void 0===t&&(t=!0);var i=Math.floor(e/3600)<10?"0"+Math.floor(e/3600):Math.floor(e/3600),r=Math.floor(e/60%60)<10?"0"+Math.floor(e/60%60):Math.floor(e/60%60),n=Math.floor(e%60)<10?"0"+Math.floor(e%60):Math.floor(e%60);return t?i+":"+r+":"+n+"."+(e-Math.floor(e)>0?(e-Math.floor(e)).toString().slice(2,4):"00"):i+":"+r+":"+n},e.toggleTimeIso=function(e){var t=new Date(e),i=t.getMonth()>9?t.getMonth()+1:"0"+(t.getMonth()+1),r=t.getDay()>9?t.getDay()+1:"0"+(t.getDay()+1);return t.getFullYear()+"-"+i+"-"+r},e.addDate=function(e,t){null!=t&&""!=t||(t=1),e.setDate(e.getDate()+t);var i=e.getMonth()+1,r=e.getDate();return e.getFullYear()+"-"+this.getFormatDate(i)+"-"+this.getFormatDate(r)},e.getFormatDate=function(e){if(null==e||""==e)return"";var t=e+"";return t.length<2&&(t="0"+t),t},e.getStrNow=function(){var e=new Date;return e.getFullYear()+"-"+(e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1)+"-"+(e.getDate()<10?"0"+e.getDate():e.getDate())+" "+(e.getHours()<10?"0"+e.getHours():e.getHours())+":"+(e.getMinutes()<10?"0"+e.getMinutes():e.getMinutes())+":"+(e.getSeconds()<10?"0"+e.getSeconds():e.getSeconds())},e.getTimeStamp=function(){var e=new Date;return""+e.getFullYear()+(e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1)+(e.getDate()<10?"0"+e.getDate():e.getDate())+"."+(e.getHours()<10?"0"+e.getHours():e.getHours())+":"+(e.getMinutes()<10?"0"+e.getMinutes():e.getMinutes())+":"+(e.getSeconds()<10?"0"+e.getSeconds():e.getSeconds())},e.getStr=function(e){return e.getFullYear()+"-"+(e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1)+"-"+(e.getDate()<10?"0"+e.getDate():e.getDate())+" "+(e.getHours()<10?"0"+e.getHours():e.getHours())+":"+(e.getMinutes()<10?"0"+e.getMinutes():e.getMinutes())+":"+(e.getSeconds()<10?"0"+e.getSeconds():e.getSeconds())},e.getTodayZeroDate=function(){return new Date(new Date((new Date).toLocaleDateString()).getTime())},e.getTodayMaxDate=function(){return new Date(new Date((new Date).toLocaleDateString()).getTime()+864e5-1)},e.getTodayStartStr=function(){var e=this.getTodayMaxDate();return e.setDate(e.getDate()-1),this.getStr(e)},e.getTodayEndStr=function(){var e=this.getTodayMaxDate();return e.setDate(e.getDate()),this.getStr(e)},e.getTomorrowStartStr=function(){var e=this.getTodayZeroDate();return e.setDate(e.getDate()-1),this.getStr(e)},e.getTomorrowEndStr=function(){var e=this.getTodayMaxDate();return e.setDate(e.getDate()),this.getStr(e)},e.getWeekStartStr=function(){var e=this.getTodayZeroDate();return e.setDate(e.getDate()-7),this.getStr(e)},e.getWeekEndStr=function(){var e=this.getTodayMaxDate();return e.setDate(e.getDate()),this.getStr(e)},e.getMonthStartStr=function(){var e=this.getTodayZeroDate();return e.setMonth(e.getMonth()-1),this.getStr(e)},e.getMonthEndStr=function(){var e=this.getTodayMaxDate();return e.setMonth(e.getMonth()),this.getStr(e)},e.getYearStartStr=function(){var e=this.getTodayZeroDate();return e.setFullYear(e.getFullYear()-1),this.getStr(e)},e.getYearEndStr=function(){var e=this.getTodayMaxDate();return e.setFullYear(e.getFullYear()),this.getStr(e)},e.getDate15=function(){return new Date(new Date(new Date).getTime()-9e5)},e.getDate60=function(){return new Date(new Date(new Date).getTime()-36e5)},e.getDate120=function(){return new Date(new Date(new Date).getTime()-72e5)},e.addSecond=function(e,t){return new Date(e.getTime()+1e3*t)},e.addMinutes=function(e,t){return new Date(e.getTime()+60*t*1e3)},e}(),vy=(i(5108),Math.PI),Cy=2*vy,_y=vy/180,by=180/vy,wy=398600.5,Py=6378.137,Sy=60/Math.sqrt(Py*Py*Py/wy),xy=1/Sy,By=.00108262998905,My=-253215306e-14,Ey=-161098761e-14,Ty=My/By,Oy=2/3;Object.freeze({pi:vy,twoPi:Cy,deg2rad:_y,rad2deg:by,minutesPerDay:1440,mu:wy,earthRadius:Py,xke:Sy,tumin:xy,j2:By,j3:My,j4:Ey,j3oj2:Ty,x2o3:Oy});function Ly(e,t){for(var i=[31,e%4==0?29:28,31,30,31,30,31,31,30,31,30,31],r=Math.floor(t),n=1,o=0;r>o+i[n-1]&&n<12;)o+=i[n-1],n+=1;var s=n,a=r-o,l=24*(t-r),h=Math.floor(l);l=60*(l-h);var c=Math.floor(l);return{mon:s,day:a,hr:h,minute:c,sec:60*(l-c)}}function Dy(e,t,i,r,n,o){var s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0;return 367*e-Math.floor(7*(e+Math.floor((t+9)/12))*.25)+Math.floor(275*t/9)+i+1721013.5+((s/6e4+o/60+n)/60+r)/24}function Iy(e,t,i,r,n,o,s){if(e instanceof Date){var a=e;return Dy(a.getUTCFullYear(),a.getUTCMonth()+1,a.getUTCDate(),a.getUTCHours(),a.getUTCMinutes(),a.getUTCSeconds(),a.getUTCMilliseconds())}return Dy(e,t,i,r,n,o,s)}function Ry(e,t){var i=e.e3,r=e.ee2,n=e.peo,o=e.pgho,s=e.pho,a=e.pinco,l=e.plo,h=e.se2,c=e.se3,u=e.sgh2,p=e.sgh3,d=e.sgh4,m=e.sh2,f=e.sh3,g=e.si2,A=e.si3,y=e.sl2,v=e.sl3,C=e.sl4,_=e.t,b=e.xgh2,w=e.xgh3,P=e.xgh4,S=e.xh2,x=e.xh3,B=e.xi2,M=e.xi3,E=e.xl2,T=e.xl3,O=e.xl4,L=e.zmol,D=e.zmos,I=t.init,R=t.opsmode,H=t.ep,F=t.inclp,N=t.nodep,Q=t.argpp,k=t.mp,U=void 0,j=void 0,G=void 0,z=void 0,Y=void 0,Z=void 0,W=void 0,X=void 0,J=void 0,K=void 0,V=void 0,q=void 0,$=void 0,ee=void 0,te=void 0,ie=void 0,re=void 0,ne=void 0;ne=D+119459e-10*_,"y"===I&&(ne=D),re=ne+.0335*Math.sin(ne);var oe=h*(W=.5*(ee=Math.sin(re))*ee-.25)+c*(X=-.5*ee*Math.cos(re)),se=g*W+A*X,ae=y*W+v*X+C*ee,le=u*W+p*X+d*ee,he=m*W+f*X;return ne=L+.00015835218*_,"y"===I&&(ne=L),re=ne+.1098*Math.sin(ne),J=oe+(r*(W=.5*(ee=Math.sin(re))*ee-.25)+i*(X=-.5*ee*Math.cos(re))),q=se+(B*W+M*X),$=ae+(E*W+T*X+O*ee),K=le+(b*W+w*X+P*ee),V=he+(S*W+x*X),"n"===I&&($-=l,K-=o,V-=s,F+=q-=a,H+=J-=n,z=Math.sin(F),G=Math.cos(F),F>=.2?(Q+=K-=G*(V/=z),N+=V,k+=$):(U=z*(Z=Math.sin(N)),j=z*(Y=Math.cos(N)),U+=V*Y+q*G*Z,j+=-V*Z+q*G*Y,(N%=Cy)<0&&"a"===R&&(N+=Cy),te=k+Q+G*N,te+=$+K-q*N*z,ie=N,(N=Math.atan2(U,j))<0&&"a"===R&&(N+=Cy),Math.abs(ie-N)>vy&&(N<ie?N+=Cy:N-=Cy),Q=te-(k+=$)-G*N)),{ep:H,inclp:F,nodep:N,argpp:Q,mp:k}}function Hy(e){var t=(e-2451545)/36525,i=-62e-7*t*t*t+.093104*t*t+3164400184.812866*t+67310.54841;return(i=i*_y/240%Cy)<0&&(i+=Cy),i}function Fy(){return(arguments.length<=0?void 0:arguments[0])instanceof Date||arguments.length>1?Hy(Iy.apply(void 0,arguments)):Hy.apply(void 0,arguments)}var Ny=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e};function Qy(e,t){var i=Ny({},e),r=void 0,n=void 0,o=void 0,s=void 0,a=void 0,l=void 0,h=void 0,c=void 0,u=void 0,p=void 0,d=void 0,m=void 0,f=void 0,g=void 0,A=void 0,y=void 0,v=void 0,C=void 0,_=void 0,b=void 0,w=void 0,P=void 0,S=void 0,x=void 0,B=void 0,M=void 0,E=Py*Sy/60;i.t=t,i.error=0;var T=i.mo+i.mdot*i.t,O=i.argpo+i.argpdot*i.t,L=i.nodeo+i.nodedot*i.t;c=O,b=T;var D=i.t*i.t;if(P=L+i.nodecf*D,y=1-i.cc1*i.t,v=i.bstar*i.cc4*i.t,C=i.t2cof*D,1!==i.isimp){l=i.omgcof*i.t;var I=1+i.eta*Math.cos(T);b=T+(A=l+i.xmcof*(I*I*I-i.delmo)),c=O-A,m=(d=D*i.t)*i.t,y=y-i.d2*D-i.d3*d-i.d4*m,v+=i.bstar*i.cc5*(Math.sin(b)-i.sinmao),C=C+i.t3cof*d+m*(i.t4cof+i.t*i.t5cof)}w=i.no;var R=i.ecco;if(_=i.inclo,"d"===i.method){f=i.t;var H=function(e){var t=e.irez,i=e.d2201,r=e.d2211,n=e.d3210,o=e.d3222,s=e.d4410,a=e.d4422,l=e.d5220,h=e.d5232,c=e.d5421,u=e.d5433,p=e.dedt,d=e.del1,m=e.del2,f=e.del3,g=e.didt,A=e.dmdt,y=e.dnodt,v=e.domdt,C=e.argpo,_=e.argpdot,b=e.t,w=e.tc,P=e.gsto,S=e.xfact,x=e.xlamo,B=e.no,M=e.atime,E=e.em,T=e.argpm,O=e.inclm,L=e.xli,D=e.mm,I=e.xni,R=e.nodem,H=e.nm,F=.13130908,N=2.8843198,Q=.37448087,k=5.7686396,U=.95240898,j=1.8014998,G=1.050833,z=4.4108898,Y=259200,Z=void 0,W=void 0,X=void 0,J=void 0,K=void 0,V=void 0,q=void 0,$=void 0,ee=0,te=0,ie=(P+.0043752690880113*w)%Cy;if(E+=p*b,O+=g*b,T+=v*b,R+=y*b,D+=A*b,0!==t){(0===M||b*M<=0||Math.abs(b)<Math.abs(M))&&(M=0,I=B,L=x),Z=b>0?720:-720;for(var re=381;381===re;)2!==t?(q=d*Math.sin(L-F)+m*Math.sin(2*(L-N))+f*Math.sin(3*(L-Q)),K=I+S,V=d*Math.cos(L-F)+2*m*Math.cos(2*(L-N))+3*f*Math.cos(3*(L-Q)),V*=K):(X=($=C+_*M)+$,W=L+L,q=i*Math.sin(X+L-k)+r*Math.sin(L-k)+n*Math.sin($+L-U)+o*Math.sin(-$+L-U)+s*Math.sin(X+W-j)+a*Math.sin(W-j)+l*Math.sin($+L-G)+h*Math.sin(-$+L-G)+c*Math.sin($+W-z)+u*Math.sin(-$+W-z),K=I+S,V=i*Math.cos(X+L-k)+r*Math.cos(L-k)+n*Math.cos($+L-U)+o*Math.cos(-$+L-U)+l*Math.cos($+L-G)+h*Math.cos(-$+L-G)+2*s*Math.cos(X+W-j)+a*Math.cos(W-j)+c*Math.cos($+W-z)+u*Math.cos(-$+W-z),V*=K),Math.abs(b-M)>=720?re=381:(te=b-M,re=0),381===re&&(L+=K*Z+q*Y,I+=q*Z+V*Y,M+=Z);H=I+q*te+V*te*te*.5,J=L+K*te+q*te*te*.5,1!==t?(D=J-2*R+2*ie,ee=H-B):(D=J-R-T+ie,ee=H-B),H=B+ee}return{atime:M,em:E,argpm:T,inclm:O,xli:L,mm:D,xni:I,nodem:R,dndt:ee,nm:H}}({irez:i.irez,d2201:i.d2201,d2211:i.d2211,d3210:i.d3210,d3222:i.d3222,d4410:i.d4410,d4422:i.d4422,d5220:i.d5220,d5232:i.d5232,d5421:i.d5421,d5433:i.d5433,dedt:i.dedt,del1:i.del1,del2:i.del2,del3:i.del3,didt:i.didt,dmdt:i.dmdt,dnodt:i.dnodt,domdt:i.domdt,argpo:i.argpo,argpdot:i.argpdot,t:i.t,tc:f,gsto:i.gsto,xfact:i.xfact,xlamo:i.xlamo,no:i.no,atime:i.atime,em:R,argpm:c,inclm:_,xli:i.xli,mm:b,xni:i.xni,nodem:P,nm:w});R=H.em,c=H.argpm,_=H.inclm,b=H.mm,P=H.nodem,w=H.nm}if(w<=0)return i.error=2,[!1,!1];var F=Math.pow(Sy/w,Oy)*y*y;if(w=Sy/Math.pow(F,1.5),(R-=v)>=1||R<-.001)return i.error=1,[!1,!1];R<1e-6&&(R=1e-6),x=(b+=i.no*C)+c+P;var N=R;if(S=_,u=c%=Cy,M=P%=Cy,B=b=((x%=Cy)-c-P)%Cy,s=Math.sin(_),o=Math.cos(_),"d"===i.method){var Q=Ry(i,{inclo:i.inclo,init:"n",ep:N,inclp:S,nodep:M,argpp:u,mp:B,opsmode:i.operationmod});if(N=Q.ep,M=Q.nodep,u=Q.argpp,B=Q.mp,(S=Q.inclp)<0&&(S=-S,M+=vy,u-=vy),N<0||N>1)return i.error=3,[!1,!1]}"d"===i.method&&(s=Math.sin(S),o=Math.cos(S),i.aycof=-.5*Ty*s,Math.abs(o+1)>15e-13?i.xlcof=-.25*Ty*s*(3+5*o)/(1+o):i.xlcof=-.25*Ty*s*(3+5*o)/15e-13);var k=N*Math.cos(u);A=1/(F*(1-N*N));var U=N*Math.sin(u)+A*i.aycof,j=(B+u+M+A*i.xlcof*k-M)%Cy;h=j,g=9999.9;for(var G=1;Math.abs(g)>=1e-12&&G<=10;)n=Math.sin(h),g=(j-U*(r=Math.cos(h))+k*n-h)/(g=1-r*k-n*U),Math.abs(g)>=.95&&(g=g>0?.95:-.95),h+=g,G+=1;var z=k*r+U*n,Y=k*n-U*r,Z=k*k+U*U,W=F*(1-Z);if(W<0)return i.error=4,[!1,!1];var X=F*(1-z),J=Math.sqrt(F)*Y/X,K=Math.sqrt(W)/X,V=Math.sqrt(1-Z),q=F/X*(n-U-k*(A=Y/(1+V))),$=F/X*(r-k+U*A);p=Math.atan2(q,$);var ee=($+$)*q,te=1-2*q*q,ie=.5*By*(A=1/W),re=ie*A;"d"===i.method&&(a=o*o,i.con41=3*a-1,i.x1mth2=1-a,i.x7thm1=7*a-1);var ne=X*(1-1.5*re*V*i.con41)+.5*ie*i.x1mth2*te;p-=.25*re*i.x7thm1*ee;var oe=M+1.5*re*o*ee,se=S+1.5*re*o*s*te,ae=J-w*ie*i.x1mth2*ee/Sy,le=K+w*ie*(i.x1mth2*te+1.5*i.con41)/Sy,he=Math.sin(p),ce=Math.cos(p),ue=Math.sin(oe),pe=Math.cos(oe),de=Math.sin(se),me=Math.cos(se),fe=-ue*me,ge=pe*me,Ae=fe*he+pe*ce,ye=ge*he+ue*ce,ve=de*he,Ce={x:ne*Ae*Py,y:ne*ye*Py,z:ne*ve*Py},_e={x:(ae*Ae+le*(fe*ce-pe*he))*E,y:(ae*ye+le*(ge*ce-ue*he))*E,z:(ae*ve+le*(de*ce))*E};return ne<1?(i.error=6,{position:!1,velocity:!1,satrec:i}):{position:Ce,velocity:_e,satrec:i}}function ky(e,t){var i=Ny({},e),r=t.opsmode,n=t.satn,o=t.epoch,s=t.xbstar,a=t.xecco,l=t.xargpo,h=t.xinclo,c=t.xmo,u=t.xno,p=t.xnodeo,d=void 0,m=void 0,f=void 0,g=void 0,A=void 0,y=void 0,v=void 0,C=void 0,_=void 0,b=void 0,w=void 0,P=void 0,S=void 0,x=void 0,B=void 0,M=void 0,E=void 0,T=void 0,O=void 0,L=void 0,D=void 0,I=void 0,R=void 0,H=void 0,F=void 0,N=void 0,Q=void 0,k=void 0,U=void 0,j=void 0,G=void 0,z=void 0,Y=void 0,Z=void 0,W=void 0,X=void 0,J=void 0,K=void 0,V=void 0,q=void 0,$=void 0,ee=void 0,te=void 0,ie=void 0,re=void 0,ne=void 0,oe=void 0,se=void 0,ae=void 0,le=void 0,he=void 0,ce=void 0,ue=void 0,pe=void 0,de=void 0,me=void 0;i.isimp=0,i.method="n",i.aycof=0,i.con41=0,i.cc1=0,i.cc4=0,i.cc5=0,i.d2=0,i.d3=0,i.d4=0,i.delmo=0,i.eta=0,i.argpdot=0,i.omgcof=0,i.sinmao=0,i.t=0,i.t2cof=0,i.t3cof=0,i.t4cof=0,i.t5cof=0,i.x1mth2=0,i.x7thm1=0,i.mdot=0,i.nodedot=0,i.xlcof=0,i.xmcof=0,i.nodecf=0,i.irez=0,i.d2201=0,i.d2211=0,i.d3210=0,i.d3222=0,i.d4410=0,i.d4422=0,i.d5220=0,i.d5232=0,i.d5421=0,i.d5433=0,i.dedt=0,i.del1=0,i.del2=0,i.del3=0,i.didt=0,i.dmdt=0,i.dnodt=0,i.domdt=0,i.e3=0,i.ee2=0,i.peo=0,i.pgho=0,i.pho=0,i.pinco=0,i.plo=0,i.se2=0,i.se3=0,i.sgh2=0,i.sgh3=0,i.sgh4=0,i.sh2=0,i.sh3=0,i.si2=0,i.si3=0,i.sl2=0,i.sl3=0,i.sl4=0,i.gsto=0,i.xfact=0,i.xgh2=0,i.xgh3=0,i.xgh4=0,i.xh2=0,i.xh3=0,i.xi2=0,i.xi3=0,i.xl2=0,i.xl3=0,i.xl4=0,i.xlamo=0,i.zmol=0,i.zmos=0,i.atime=0,i.xli=0,i.xni=0,i.bstar=s,i.ecco=a,i.argpo=l,i.inclo=h,i.mo=c,i.no=u,i.nodeo=p,i.operationmode=r;var fe=78/Py+1,ge=42/Py,Ae=ge*ge*ge*ge;i.init="y",i.t=0;var ye=function(e){var t=e.ecco,i=e.epoch,r=e.inclo,n=e.opsmode,o=e.no,s=t*t,a=1-s,l=Math.sqrt(a),h=Math.cos(r),c=h*h,u=Math.pow(Sy/o,Oy),p=.75*By*(3*c-1)/(l*a),d=p/(u*u),m=u*(1-d*d-d*(1/3+134*d*d/81));o/=1+(d=p/(m*m));var f=Math.pow(Sy/o,Oy),g=Math.sin(r),A=f*a,y=1-5*c,v=-y-c-c,C=1/f,_=A*A,b=f*(1-t),w=void 0;if("a"===n){var P=i-7305,S=Math.floor(P+1e-8),x=.017202791694070362;(w=(1.7321343856509375+x*S+(x+Cy)*(P-S)+P*P*5075514194322695e-30)%Cy)<0&&(w+=Cy)}else w=Fy(i+2433281.5);return{no:o,method:"n",ainv:C,ao:f,con41:v,con42:y,cosio:h,cosio2:c,eccsq:s,omeosq:a,posq:_,rp:b,rteosq:l,sinio:g,gsto:w}}({satn:n,ecco:i.ecco,epoch:o,inclo:i.inclo,no:i.no,method:i.method,opsmode:i.operationmode}),ve=ye.ao,Ce=ye.con42,_e=ye.cosio,be=ye.cosio2,we=ye.eccsq,Pe=ye.omeosq,Se=ye.posq,xe=ye.rp,Be=ye.rteosq,Me=ye.sinio;if(i.no=ye.no,i.con41=ye.con41,i.gsto=ye.gsto,i.error=0,Pe>=0||i.no>=0){if(i.isimp=0,(xe<220/Py)+1&&(i.isimp=1),Q=fe,D=Ae,(T=(xe-1)*Py)<156){Q=T-78,T<98&&(Q=20);var Ee=(120-Q)/Py;D=Ee*Ee*Ee*Ee,Q=Q/Py+1}O=1/Se,ne=1/(ve-Q),i.eta=ve*i.ecco*ne,P=i.eta*i.eta,w=i.ecco*i.eta,L=Math.abs(1-P),g=(v=(y=D*Math.pow(ne,4))/Math.pow(L,3.5))*i.no*(ve*(1+1.5*P+w*(4+P))+.375*By*ne/L*i.con41*(8+3*P*(8+P))),i.cc1=i.bstar*g,A=0,i.ecco>1e-4&&(A=-2*y*ne*Ty*i.no*Me/i.ecco),i.x1mth2=1-be,i.cc4=2*i.no*v*ve*Pe*(i.eta*(2+.5*P)+i.ecco*(.5+2*P)-By*ne/(ve*L)*(-3*i.con41*(1-2*w+P*(1.5-.5*w))+.75*i.x1mth2*(2*P-w*(1+P))*Math.cos(2*i.argpo))),i.cc5=2*v*ve*Pe*(1+2.75*(P+w)+w*P),C=be*be,ie=.5*(te=1.5*By*O*i.no)*By*O,re=-.46875*Ey*O*O*i.no,i.mdot=i.no+.5*te*Be*i.con41+.0625*ie*Be*(13-78*be+137*C),i.argpdot=-.5*te*Ce+.0625*ie*(7-114*be+395*C)+re*(3-36*be+49*C),se=-te*_e,i.nodedot=se+(.5*ie*(4-19*be)+2*re*(3-7*be))*_e,oe=i.argpdot+i.nodedot,i.omgcof=i.bstar*A*Math.cos(i.argpo),i.xmcof=0,i.ecco>1e-4&&(i.xmcof=-Oy*y*i.bstar/w),i.nodecf=3.5*Pe*se*i.cc1,i.t2cof=1.5*i.cc1,Math.abs(_e+1)>15e-13?i.xlcof=-.25*Ty*Me*(3+5*_e)/(1+_e):i.xlcof=-.25*Ty*Me*(3+5*_e)/15e-13,i.aycof=-.5*Ty*Me;var Te=1+i.eta*Math.cos(i.mo);if(i.delmo=Te*Te*Te,i.sinmao=Math.sin(i.mo),i.x7thm1=7*be-1,2*vy/i.no>=225){i.method="d",i.isimp=1,$=0,B=i.inclo;var Oe=function(e){var t=e.epoch,i=e.ep,r=e.argpp,n=e.tc,o=e.inclp,s=e.nodep,a=void 0,l=void 0,h=void 0,c=void 0,u=void 0,p=void 0,d=void 0,m=void 0,f=void 0,g=void 0,A=void 0,y=void 0,v=void 0,C=void 0,_=void 0,b=void 0,w=void 0,P=void 0,S=void 0,x=void 0,B=void 0,M=void 0,E=void 0,T=void 0,O=void 0,L=void 0,D=void 0,I=void 0,R=void 0,H=void 0,F=void 0,N=void 0,Q=void 0,k=void 0,U=void 0,j=void 0,G=void 0,z=void 0,Y=void 0,Z=void 0,W=void 0,X=void 0,J=void 0,K=void 0,V=void 0,q=void 0,$=void 0,ee=void 0,te=void 0,ie=void 0,re=void 0,ne=void 0,oe=void 0,se=void 0,ae=void 0,le=void 0,he=void 0,ce=void 0,ue=void 0,pe=void 0,de=void 0,me=void 0,fe=void 0,ge=.01675,Ae=.0549,ye=e.np,ve=i,Ce=Math.sin(s),_e=Math.cos(s),be=Math.sin(r),we=Math.cos(r),Pe=Math.sin(o),Se=Math.cos(o),xe=ve*ve,Be=1-xe,Me=Math.sqrt(Be),Ee=t+18261.5+n/1440,Te=(4.523602-.00092422029*Ee)%Cy,Oe=Math.sin(Te),Le=Math.cos(Te),De=.91375164-.03568096*Le,Ie=Math.sqrt(1-De*De),Re=.089683511*Oe/Ie,He=Math.sqrt(1-Re*Re),Fe=5.8351514+.001944368*Ee,Ne=.39785416*Oe/Ie,Qe=He*Le+.91744867*Re*Oe;Ne=Math.atan2(Ne,Qe),Ne+=Fe-Te;var ke=Math.cos(Ne),Ue=Math.sin(Ne);x=.1945905,B=-.98088458,T=.91744867,O=.39785416,M=_e,E=Ce,A=29864797e-13;for(var je=1/ye,Ge=0;Ge<2;)ae=-6*(a=x*M+B*T*E)*(u=-Pe*(d=-x*E+B*T*M)+Se*(m=B*O))+xe*(-24*(y=a*we+(l=Se*d+Pe*m)*be)*(P=u*we)-6*(C=-a*be+l*we)*(b=u*be)),le=-6*(a*(p=-Pe*(f=B*E+x*T*M)+Se*(g=x*O))+(h=-B*M+x*T*E)*u)+xe*(-24*((v=h*we+(c=Se*f+Pe*g)*be)*P+y*(S=p*we))+-6*(C*(w=p*be)+(_=-h*be+c*we)*b)),he=-6*h*p+xe*(-24*v*S-6*_*w),ce=6*l*u+xe*(24*y*b-6*C*P),ue=6*(c*u+l*p)+xe*(24*(v*b+y*w)-6*(_*P+C*S)),pe=6*c*p+xe*(24*v*w-6*_*S),ne=(ne=3*(a*a+l*l)+(de=12*y*y-3*C*C)*xe)+ne+Be*de,oe=(oe=6*(a*h+l*c)+(me=24*y*v-6*C*_)*xe)+oe+Be*me,se=(se=3*(h*h+c*c)+(fe=12*v*v-3*_*_)*xe)+se+Be*fe,q=-.5*($=A*je)/Me,V=-15*ve*(ee=$*Me),te=y*C+v*_,ie=v*C+y*_,re=v*_-y*C,1===(Ge+=1)&&(L=V,D=q,I=$,R=ee,H=te,F=ie,N=re,Q=ne,k=oe,U=se,j=ae,G=le,z=he,Y=ce,Z=ue,W=pe,X=de,J=me,K=fe,x=ke,B=Ue,T=De,O=Ie,M=He*_e+Re*Ce,E=Ce*He-_e*Re,A=4.7968065e-7);return{snodm:Ce,cnodm:_e,sinim:Pe,cosim:Se,sinomm:be,cosomm:we,day:Ee,e3:2*V*re,ee2:2*V*ie,em:ve,emsq:xe,gam:Fe,peo:0,pgho:0,pho:0,pinco:0,plo:0,rtemsq:Me,se2:2*L*F,se3:2*L*N,sgh2:2*R*J,sgh3:2*R*(K-X),sgh4:-18*R*ge,sh2:-2*D*Z,sh3:-2*D*(W-Y),si2:2*D*G,si3:2*D*(z-j),sl2:-2*I*k,sl3:-2*I*(U-Q),sl4:-2*I*(-21-9*xe)*ge,s1:V,s2:q,s3:$,s4:ee,s5:te,s6:ie,s7:re,ss1:L,ss2:D,ss3:I,ss4:R,ss5:H,ss6:F,ss7:N,sz1:Q,sz2:k,sz3:U,sz11:j,sz12:G,sz13:z,sz21:Y,sz22:Z,sz23:W,sz31:X,sz32:J,sz33:K,xgh2:2*ee*me,xgh3:2*ee*(fe-de),xgh4:-18*ee*Ae,xh2:-2*q*ue,xh3:-2*q*(pe-ce),xi2:2*q*le,xi3:2*q*(he-ae),xl2:-2*$*oe,xl3:-2*$*(se-ne),xl4:-2*$*(-21-9*xe)*Ae,nm:ye,z1:ne,z2:oe,z3:se,z11:ae,z12:le,z13:he,z21:ce,z22:ue,z23:pe,z31:de,z32:me,z33:fe,zmol:(.2299715*Ee-Fe+4.7199672)%Cy,zmos:(6.2565837+.017201977*Ee)%Cy}}({epoch:o,ep:i.ecco,argpp:i.argpo,tc:$,inclp:i.inclo,nodep:i.nodeo,np:i.no,e3:i.e3,ee2:i.ee2,peo:i.peo,pgho:i.pgho,pho:i.pho,pinco:i.pinco,plo:i.plo,se2:i.se2,se3:i.se3,sgh2:i.sgh2,sgh3:i.sgh3,sgh4:i.sgh4,sh2:i.sh2,sh3:i.sh3,si2:i.si2,si3:i.si3,sl2:i.sl2,sl3:i.sl3,sl4:i.sl4,xgh2:i.xgh2,xgh3:i.xgh3,xgh4:i.xgh4,xh2:i.xh2,xh3:i.xh3,xi2:i.xi2,xi3:i.xi3,xl2:i.xl2,xl3:i.xl3,xl4:i.xl4,zmol:i.zmol,zmos:i.zmos});i.e3=Oe.e3,i.ee2=Oe.ee2,i.peo=Oe.peo,i.pgho=Oe.pgho,i.pho=Oe.pho,i.pinco=Oe.pinco,i.plo=Oe.plo,i.se2=Oe.se2,i.se3=Oe.se3,i.sgh2=Oe.sgh2,i.sgh3=Oe.sgh3,i.sgh4=Oe.sgh4,i.sh2=Oe.sh2,i.sh3=Oe.sh3,i.si2=Oe.si2,i.si3=Oe.si3,i.sl2=Oe.sl2,i.sl3=Oe.sl3,i.sl4=Oe.sl4,m=Oe.sinim,d=Oe.cosim,_=Oe.em,b=Oe.emsq,I=Oe.s1,R=Oe.s2,H=Oe.s3,F=Oe.s4,N=Oe.s5,k=Oe.ss1,U=Oe.ss2,j=Oe.ss3,G=Oe.ss4,z=Oe.ss5,Y=Oe.sz1,Z=Oe.sz3,W=Oe.sz11,X=Oe.sz13,J=Oe.sz21,K=Oe.sz23,V=Oe.sz31,q=Oe.sz33,i.xgh2=Oe.xgh2,i.xgh3=Oe.xgh3,i.xgh4=Oe.xgh4,i.xh2=Oe.xh2,i.xh3=Oe.xh3,i.xi2=Oe.xi2,i.xi3=Oe.xi3,i.xl2=Oe.xl2,i.xl3=Oe.xl3,i.xl4=Oe.xl4,i.zmol=Oe.zmol,i.zmos=Oe.zmos,E=Oe.nm,ae=Oe.z1,le=Oe.z3,he=Oe.z11,ce=Oe.z13,ue=Oe.z21,pe=Oe.z23,de=Oe.z31,me=Oe.z33;var Le=Ry(i,{inclo:B,init:i.init,ep:i.ecco,inclp:i.inclo,nodep:i.nodeo,argpp:i.argpo,mp:i.mo,opsmode:i.operationmode});i.ecco=Le.ep,i.inclo=Le.inclp,i.nodeo=Le.nodep,i.argpo=Le.argpp,i.mo=Le.mp,S=0,x=0,M=0;var De=function(e){var t=e.cosim,i=e.argpo,r=e.s1,n=e.s2,o=e.s3,s=e.s4,a=e.s5,l=e.sinim,h=e.ss1,c=e.ss2,u=e.ss3,p=e.ss4,d=e.ss5,m=e.sz1,f=e.sz3,g=e.sz11,A=e.sz13,y=e.sz21,v=e.sz23,C=e.sz31,_=e.sz33,b=e.t,w=e.tc,P=e.gsto,S=e.mo,x=e.mdot,B=e.no,M=e.nodeo,E=e.nodedot,T=e.xpidot,O=e.z1,L=e.z3,D=e.z11,I=e.z13,R=e.z21,H=e.z23,F=e.z31,N=e.z33,Q=e.ecco,k=e.eccsq,U=e.emsq,j=e.em,G=e.argpm,z=e.inclm,Y=e.mm,Z=e.nm,W=e.nodem,X=e.irez,J=e.atime,K=e.d2201,V=e.d2211,q=e.d3210,$=e.d3222,ee=e.d4410,te=e.d4422,ie=e.d5220,re=e.d5232,ne=e.d5421,oe=e.d5433,se=e.dedt,ae=e.didt,le=e.dmdt,he=e.dnodt,ce=e.domdt,ue=e.del1,pe=e.del2,de=e.del3,me=e.xfact,fe=e.xlamo,ge=e.xli,Ae=e.xni,ye=void 0,ve=void 0,Ce=void 0,_e=void 0,be=void 0,we=void 0,Pe=void 0,Se=void 0,xe=void 0,Be=void 0,Me=void 0,Ee=void 0,Te=void 0,Oe=void 0,Le=void 0,De=void 0,Ie=void 0,Re=.0043752690880113,He=.00015835218,Fe=119459e-10;X=0,Z<.0052359877&&Z>.0034906585&&(X=1),Z>=.00826&&Z<=.00924&&j>=.5&&(X=2);var Ne=-Fe*c*(y+v);(z<.052359877||z>vy-.052359877)&&(Ne=0),0!==l&&(Ne/=l);var Qe=-He*n*(R+H);(z<.052359877||z>vy-.052359877)&&(Qe=0),ce=p*Fe*(C+_-6)-t*Ne+s*He*(F+N-6),he=Ne,0!==l&&(ce-=t/l*Qe,he+=Qe/l);var ke=(P+w*Re)%Cy;if(j+=(se=h*Fe*d+r*He*a)*b,z+=(ae=c*Fe*(g+A)+n*He*(D+I))*b,G+=ce*b,W+=he*b,Y+=(le=-Fe*u*(m+f-14-6*U)-He*o*(O+L-14-6*U))*b,0!==X){if(Le=Math.pow(Z/Sy,Oy),2===X){var Ue=j,je=U;Ie=(j=Q)*(U=k),j<=.65?(Ce=3.616-13.247*j+16.29*U,_e=117.39*j-19.302-228.419*U+156.591*Ie,be=109.7927*j-18.9068-214.6334*U+146.5816*Ie,we=242.694*j-41.122-471.094*U+313.953*Ie,Pe=841.88*j-146.407-1629.014*U+1083.435*Ie,Se=3017.977*j-532.114-5740.032*U+3708.276*Ie):(Ce=331.819*j-72.099-508.738*U+266.724*Ie,_e=1582.851*j-346.844-2415.925*U+1246.113*Ie,be=1554.908*j-342.585-2366.899*U+1215.972*Ie,we=4758.686*j-1052.797-7193.992*U+3651.957*Ie,Pe=16178.11*j-3581.69-24462.77*U+12422.52*Ie,Se=j>.715?29936.92*j-5149.66-54087.36*U+31324.56*Ie:1464.74-4664.75*j+3763.64*U),j<.7?(Me=4988.61*j-919.2277-9064.77*U+5542.21*Ie,xe=4568.6173*j-822.71072-8491.4146*U+5337.524*Ie,Be=4690.25*j-853.666-8624.77*U+5341.4*Ie):(Me=161616.52*j-37995.78-229838.2*U+109377.94*Ie,xe=218913.95*j-51752.104-309468.16*U+146349.42*Ie,Be=170470.89*j-40023.88-242699.48*U+115605.82*Ie),K=(Te=17891679e-13*(Oe=Z*Z*3*(Le*Le)))*(ye=.75*(1+2*t+(De=t*t)))*(-.306-.44*(j-.64)),V=Te*(1.5*(Ee=l*l))*Ce,q=(Te=3.7393792e-7*(Oe*=Le))*(1.875*l*(1-2*t-3*De))*_e,$=Te*(-1.875*l*(1+2*t-3*De))*be,ee=(Te=2*(Oe*=Le)*7.3636953e-9)*(35*Ee*ye)*we,te=Te*(39.375*Ee*Ee)*Pe,ie=(Te=1.1428639e-7*(Oe*=Le))*(9.84375*l*(Ee*(1-2*t-5*De)+.33333333*(4*t-2+6*De)))*Se,re=Te*(l*(4.92187512*Ee*(-2-4*t+10*De)+6.56250012*(1+2*t-3*De)))*Be,ne=(Te=2*Oe*2.1765803e-9)*(29.53125*l*(2-8*t+De*(8*t-12+10*De)))*xe,oe=Te*(29.53125*l*(-2-8*t+De*(12+8*t-10*De)))*Me,fe=(S+M+M-(ke+ke))%Cy,me=x+le+2*(E+he-Re)-B,j=Ue,U=je}1===X&&(ve=1+t,pe=2*(ue=3*Z*Z*Le*Le)*(ye=.75*(1+t)*(1+t))*(1+U*(.8125*U-2.5))*17891679e-13,de=3*ue*(ve*=1.875*ve*ve)*(1+U*(6.60937*U-6))*2.2123015e-7*Le,ue=ue*(.9375*l*l*(1+3*t)-.75*(1+t))*(_e=1+2*U)*21460748e-13*Le,fe=(S+M+i-ke)%Cy,me=x+T+le+ce+he-(B+Re)),ge=fe,Ae=B,J=0,Z=B+0}return{em:j,argpm:G,inclm:z,mm:Y,nm:Z,nodem:W,irez:X,atime:J,d2201:K,d2211:V,d3210:q,d3222:$,d4410:ee,d4422:te,d5220:ie,d5232:re,d5421:ne,d5433:oe,dedt:se,didt:ae,dmdt:le,dndt:0,dnodt:he,domdt:ce,del1:ue,del2:pe,del3:de,xfact:me,xlamo:fe,xli:ge,xni:Ae}}({cosim:d,emsq:b,argpo:i.argpo,s1:I,s2:R,s3:H,s4:F,s5:N,sinim:m,ss1:k,ss2:U,ss3:j,ss4:G,ss5:z,sz1:Y,sz3:Z,sz11:W,sz13:X,sz21:J,sz23:K,sz31:V,sz33:q,t:i.t,tc:$,gsto:i.gsto,mo:i.mo,mdot:i.mdot,no:i.no,nodeo:i.nodeo,nodedot:i.nodedot,xpidot:oe,z1:ae,z3:le,z11:he,z13:ce,z21:ue,z23:pe,z31:de,z33:me,ecco:i.ecco,eccsq:we,em:_,argpm:S,inclm:B,mm:M,nm:E,nodem:x,irez:i.irez,atime:i.atime,d2201:i.d2201,d2211:i.d2211,d3210:i.d3210,d3222:i.d3222,d4410:i.d4410,d4422:i.d4422,d5220:i.d5220,d5232:i.d5232,d5421:i.d5421,d5433:i.d5433,dedt:i.dedt,didt:i.didt,dmdt:i.dmdt,dnodt:i.dnodt,domdt:i.domdt,del1:i.del1,del2:i.del2,del3:i.del3,xfact:i.xfact,xlamo:i.xlamo,xli:i.xli,xni:i.xni});i.irez=De.irez,i.atime=De.atime,i.d2201=De.d2201,i.d2211=De.d2211,i.d3210=De.d3210,i.d3222=De.d3222,i.d4410=De.d4410,i.d4422=De.d4422,i.d5220=De.d5220,i.d5232=De.d5232,i.d5421=De.d5421,i.d5433=De.d5433,i.dedt=De.dedt,i.didt=De.didt,i.dmdt=De.dmdt,i.dnodt=De.dnodt,i.domdt=De.domdt,i.del1=De.del1,i.del2=De.del2,i.del3=De.del3,i.xfact=De.xfact,i.xlamo=De.xlamo,i.xli=De.xli,i.xni=De.xni}1!==i.isimp&&(f=i.cc1*i.cc1,i.d2=4*ve*ne*f,ee=i.d2*ne*i.cc1/3,i.d3=(17*ve+Q)*ee,i.d4=.5*ee*ve*ne*(221*ve+31*Q)*i.cc1,i.t3cof=i.d2+2*f,i.t4cof=.25*(3*i.d3+i.cc1*(12*i.d2+10*f)),i.t5cof=.2*(3*i.d4+12*i.cc1*i.d3+6*i.d2*i.d2+15*f*(2*i.d2+f)))}var Ie=Qy(i,0).satrec;return Ie.init="n",Ie}function Uy(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];var r=t[0],n=Array.prototype.slice.call(t,1);return Qy(r,1440*(Iy.apply(void 0,function(e){if(Array.isArray(e)){for(var t=0,i=Array(e.length);t<e.length;t++)i[t]=e[t];return i}return Array.from(e)}(n))-r.jdsatepoch))}var jy=function(e,t,i,r){return new(i||(i=Promise))((function(n,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?n(e.value):function(e){return e instanceof i?e:new i((function(t){t(e)}))}(e.value).then(s,a)}l((r=r.apply(e,t||[])).next())}))},Gy=function(e,t){var i,r,n,o,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,r&&(n=2&o[0]?r.return:o[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,o[1])).done)return n;switch(r=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(n=s.trys,(n=n.length>0&&n[n.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){s.label=o[1];break}if(6===o[0]&&s.label<n[1]){s.label=n[1],n=o;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(o);break}n[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{i=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};const zy=function(){function e(){}return e.calculateAngle=function(e,t,i,r){var n=0,o=i-e,s=r-t;return i==e?(n=Math.PI/2,r==t?n=0:r<t&&(n=3*Math.PI/2)):i>e&&r>t?n=Math.atan(o/s):i>e&&r<t?n=Math.PI/2+Math.atan(-s/o):i<e&&r<t?n=Math.PI+Math.atan(o/s):i<e&&r>t&&(n=3*Math.PI/2+Math.atan(s/-o)),180*n/Math.PI},e.calculateOrbitLocalc=function(e,t,i,r,n){return void 0===n&&(n=80),jy(this,void 0,void 0,(function(){var o,s,a,l,h,c,u;return Gy(this,(function(p){for(o=.5*r,s=r/n,a=[],l=function(e,t){var i=1440/(2*vy),r=0,n={error:0};n.satnum=e.substring(2,7),n.epochyr=parseInt(e.substring(18,20),10),n.epochdays=parseFloat(e.substring(20,32)),n.ndot=parseFloat(e.substring(33,43)),n.nddot=parseFloat("."+parseInt(e.substring(44,50),10)+"E"+e.substring(50,52)),n.bstar=parseFloat(e.substring(53,54)+"."+parseInt(e.substring(54,59),10)+"E"+e.substring(59,61)),n.inclo=parseFloat(t.substring(8,16)),n.nodeo=parseFloat(t.substring(17,25)),n.ecco=parseFloat("."+t.substring(26,33)),n.argpo=parseFloat(t.substring(34,42)),n.mo=parseFloat(t.substring(43,51)),n.no=parseFloat(t.substring(52,63)),n.no/=i,n.a=Math.pow(n.no*xy,-2/3),n.ndot/=1440*i,n.nddot/=1440*i*1440,n.inclo*=_y,n.nodeo*=_y,n.argpo*=_y,n.mo*=_y,n.alta=n.a*(1+n.ecco)-1,n.altp=n.a*(1-n.ecco)-1;var o=Ly(r=n.epochyr<57?n.epochyr+2e3:n.epochyr+1900,n.epochdays),s=o.mon,a=o.day,l=o.hr,h=o.minute,c=o.sec;return n.jdsatepoch=Iy(r,s,a,l,h,c),ky(n,{opsmode:"i",satn:n.satnum,epoch:n.jdsatepoch-2433281.5,xbstar:n.bstar,xecco:n.ecco,xargpo:n.argpo,xinclo:n.inclo,xmo:n.mo,xno:n.no,xnodeo:n.nodeo})}(t,i),h=-o;h<o;h+=s)c=yy.addMinutes(e,h),u=Uy(l,c).position,a.push(new Ay(1e3*u.x,1e3*u.y,1e3*u.z,c));return a.push(a[0]),[2,a]}))}))},e.calculatePeriod=function(e,t){return 1440/Number.parseFloat(t.split(" ").filter((function(e){return""!=e.trim()}))[7])},e.getLongitudeByCartesian3=function(e,t){var i=t.scene.globe.ellipsoid.cartesianToCartographic(e);return Cesium.Math.toDegrees(i.longitude)},e.getLatitudeByCartesian3=function(e,t){var i=t.scene.globe.ellipsoid.cartesianToCartographic(e);return Cesium.Math.toDegrees(i.latitude)},e.getHeightByCartesian3=function(e,t){return e?t.scene.globe.ellipsoid.cartesianToCartographic(e).height:0},e.getHeightdefineByXYZ=function(e,t,i){var r=i.scene.globe.ellipsoid.cartesianToCartographic(e);return Cesium.Cartesian3.fromDegrees(Cesium.Math.toDegrees(r.longitude),Cesium.Math.toDegrees(r.latitude),t)},e.screen2Cartesian=function(e,t){if(!t)throw"null viewer";return t.scene.mode==Cesium.SceneMode.SCENE3D?t.scene.globe.pick(t.camera.getPickRay(e),t.scene):t.camera.pickEllipsoid(e,t.scene.globe.ellipsoid)},e.screen2lonlat=function(t,i){if(!i)throw"null viewer";var r=e.screen2Cartesian(t,i);return r?e.cartesian2lonlat(r):[0,0]},e.lonlat2Cartesian=function(e,t){return void 0===t&&(t=0),Cesium.Cartesian3.fromDegrees(e[0],e[1],t,Cesium.Ellipsoid.WGS84)},e.lonlathei2Cartesian=function(e){return Cesium.Cartesian3.fromDegrees(e.lon,e.lat,e.alt,Cesium.Ellipsoid.WGS84)},e.cartesian2lonlat=function(e){if(!e)return[Number.MIN_VALUE,Number.MIN_VALUE,Number.MIN_VALUE];var t=Cesium.Ellipsoid.WGS84.cartesianToCartographic(e);return[Cesium.Math.toDegrees(t.longitude),Cesium.Math.toDegrees(t.latitude),t.height]},e.screen2CartesianWidthHeight=function(t,i,r){void 0===i&&(i=0);var n=e.screen2lonlat(t,r);return e.lonlat2Cartesian(n,i)},e.dateToString=function(e){return Cesium.JulianDate.toIso8601(new Cesium.JulianDate(e))},e.julianDate=function(e){return e||(e=new Date),Cesium.JulianDate.fromDate(e)},e.distance=function(t,i){var r=xt.xmu(e.cartesian2lonlat(t)),n=xt.xmu(e.cartesian2lonlat(i));return 1e3*xt.TE$(r,n,{units:"kilometers"})},e.cartesian2turfPoint=function(t){var i=e.cartesian2lonlat(t);return xt.xmu(i)},e.turfGeometry2Cartesians=function(t,i){return void 0===i&&(i=0),t.geometry.coordinates[0].map((function(t){return e.lonlat2Cartesian(t,i)}))},e.deleteEnts=function(t,i){t.forEach((function(t){t._children.length>0&&e.deleteEnts(t._children,i),i.entities.remove(t)}))},e.turfIntersect=function(e,t){return xt.wfr(e,t)},e.turfUnion=function(e,t){return xt.G0j(e,t)},e.turfArea=function(e){return xt.SOn(e)},e}();var Yy=function(){function e(){}return e.newGuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}))},e.newShortGuid=function(){return"xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}))},e}(),Zy=function(){function e(e,t,i,r){if(this.iFromZero=!1,this.viewer=e,this.vertexShader=this.getVS(),this.fragmentShader=this.getFS(),r&&(this.iFromZero=r),t&&t.length>=2){var n=[],o=[],s=[];if(i&&i.length===4*t.length){for(var a=0;a<t.length;a++)n.push(t[a].x),n.push(t[a].y),n.push(t[a].z);o=i}else for(a=0;a<t.length;a++)n.push(t[a].x),n.push(t[a].y),n.push(t[a].z),o.push(0),o.push(0),o.push(1),o.push(1);if(this.iFromZero)for(a=0;a<t.length;a++)s.push(a);else for(a=1;a<t.length;a++)s.push(a-1),s.push(a);this.positionArr=new Float64Array(n),this.colorArr=new Float32Array(o),this.indiceArr=new Uint32Array(s)}else{var l=Cesium.Cartesian3.fromDegrees(0,0,-10),h=Cesium.Cartesian3.fromDegrees(0,.001,-10);this.positionArr=new Float64Array([l.x,l.y,l.z,h.x,h.y,h.z]),this.colorArr=new Float32Array([0,0,1,1,0,0,1,1]),this.indiceArr=new Uint32Array([0,1])}this.geometry=this.CreateGeometry(this.positionArr,this.colorArr,this.indiceArr),this.appearance=this.CreateAppearence(this.fragmentShader,this.vertexShader)}return e.prototype.CreateGeometry=function(e,t,i){return new Cesium.Geometry({attributes:{position:new Cesium.GeometryAttribute({componentDatatype:Cesium.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:e})},indices:i,primitiveType:Cesium.PrimitiveType.LINES,boundingSphere:Cesium.BoundingSphere.fromVertices(e)})},e.prototype.updateAlpha=function(e,t){for(var i=0;i<this.colorArr.length;i+=4)this.colorArr[i+3]=t;var r=this.colorArr;this.geometry.attributes.color=new Cesium.GeometryAttribute({componentDatatype:Cesium.ComponentDatatype.FLOAT,componentsPerAttribute:4,values:r})},e.prototype.CreateAppearence=function(e,t){return new Cesium.Appearance({renderState:{blending:Cesium.BlendingState.PRE_MULTIPLIED_ALPHA_BLEND,depthTest:{enabled:!0},depthMask:!0,lineWidth:1},fragmentShaderSource:e,vertexShaderSource:t})},e.prototype.getVS=function(){return"attribute vec3 position3DHigh;        attribute vec3 position3DLow;        attribute vec4 color;        varying vec4 v_color;        attribute float batchId;        void main()        {            vec4 p = czm_computePosition();            v_color =color;            p = czm_modelViewProjectionRelativeToEye * p;            gl_Position = p;        }        "},e.prototype.getFS=function(){return"varying vec4 v_color;        void main()        {            gl_FragColor =v_color;        }        "},e}(),Wy=function(){function e(e,t,i){if(this.viewer=e,this.vertexShader=this.getVS(),this.fragmentShader=this.getFS(),t&&t.length>=2){var r=[],n=[],o=[];if(i&&i.length===4*t.length){for(var s=0;s<t.length;s++)r.push(t[s].x),r.push(t[s].y),r.push(t[s].z);n=i}else for(s=0;s<t.length;s++)r.push(t[s].x),r.push(t[s].y),r.push(t[s].z),n.push(0),n.push(0),n.push(1),n.push(1);for(s=0;s<t.length;s+=3)o.push(s),o.push(s+1),o.push(s+2);this.positionArr=new Float64Array(r),this.colorArr=new Float32Array(n),this.indiceArr=new Uint16Array(o)}else{var a=Cesium.Cartesian3.fromDegrees(0,0,-10),l=Cesium.Cartesian3.fromDegrees(0,.001,-10),h=Cesium.Cartesian3.fromDegrees(.001,.001,-10);this.positionArr=new Float64Array([a.x,a.y,a.z,l.x,l.y,l.z,h.x,h.y,h.z]),this.colorArr=new Float32Array([0,0,1,.5,0,0,1,.5,0,0,1,.5]),this.indiceArr=new Uint16Array([0,1,2])}this.geometry=this.CreateGeometry(this.positionArr,this.colorArr,this.indiceArr),this.appearance=this.CreateAppearence(this.fragmentShader,this.vertexShader)}return e.prototype.CreateGeometry=function(e,t,i){return new Cesium.Geometry({attributes:{position:new Cesium.GeometryAttribute({componentDatatype:Cesium.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:e}),color:new Cesium.GeometryAttribute({componentDatatype:Cesium.ComponentDatatype.FLOAT,componentsPerAttribute:4,values:t})},indices:i,primitiveType:Cesium.PrimitiveType.TRIANGLES,boundingSphere:Cesium.BoundingSphere.fromVertices(e)})},e.prototype.CreateAppearence=function(e,t){return Cesium.Material.fromType("Color").uniforms.color=new Cesium.Color(1,1,0,0),new Cesium.Appearance({renderState:{blending:Cesium.BlendingState.PRE_MULTIPLIED_ALPHA_BLEND,depthTest:{enabled:!0,func:Cesium.DepthFunction.NOT_EQUAL},polygonOffset:{enabled:!0,factor:1,units:1}},fragmentShaderSource:e,vertexShaderSource:t})},e.prototype.getVS=function(){return"attribute vec3 position3DHigh;        attribute vec3 position3DLow;        attribute vec4 color;        varying vec4 v_color;        attribute float batchId;        void main()        {            vec4 p = czm_computePosition();            v_color =color;            p = czm_modelViewProjectionRelativeToEye * p;            gl_Position = p;        }        "},e.prototype.getFS=function(){return"varying vec4 v_color;        void main()        {            gl_FragColor =v_color;        }        "},e}(),Xy=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},Jy=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Ky=function(){function e(e){this.sourceGraphIdList=[],this.anchorConnectLineShow=!1,this.anchorMousePosition={x:0,y:0},this.viewer=e}return e.showAnchoredMessage=function(t,i){if(e.nzMessageSer.success("锚定成功"),t&&i){var r=e.getNZTreeNodeByGraphId(t.id),n=e.getNZTreeNodeByGraphId(i.id);r.anchorCls=["anchor-source-cls-".concat(i.id)],e.anchorClsTreeNodeMap[r.key]=["anchor-source-cls-".concat(i.id)],n.anchorCls=["anchor-target-cls-".concat(i.id)],e.anchorClsTreeNodeMap[n.key]=["anchor-target-cls-".concat(i.id)],n.remove(),r.remove();var o=0;r.parentNode.children.forEach((function(e,t){var r;(null===(r=e.anchorCls)||void 0===r?void 0:r.includes("anchor-source-cls-".concat(i.id)))&&(o=t+1)})),n.parentNode.addChildren([r],o),n.parentNode.addChildren([n],o+1)}},e.showCancelAnchoredMessage=function(t){e.nzMessageSer.success("锚定取消");var i=e.getNZTreeNodeByGraphId(t.id);delete i.anchorCls;var r=0;i.parentNode.children.forEach((function(e,i){var n,o;(null===(n=e.anchorCls)||void 0===n?void 0:n.includes("anchor-source-cls-".concat(null===(o=t.anchorHelper)||void 0===o?void 0:o.targetGraphId)))&&(r=i+1)})),0===r&&i.parentNode.children.forEach((function(e,i){var r,n;(null===(r=e.anchorCls)||void 0===r?void 0:r.includes("anchor-target-cls-".concat(null===(n=t.anchorHelper)||void 0===n?void 0:n.targetGraphId)))&&delete e.anchorCls}));var n=0;if(i.parentNode.children.forEach((function(e,i){var r,o;(null===(r=e.anchorCls)||void 0===r?void 0:r.includes("anchor-target-cls-".concat(null===(o=t.anchorHelper)||void 0===o?void 0:o.targetGraphId)))&&(n=i)})),0!==n){var o=i.parentNode;i.remove(),o.addChildren([i],n)}},e.showNoSelected=function(){e.nzMessageSer.warning("未选中锚定对象")},e.getNZTreeNodeByGraphId=function(t,i){void 0===i&&(i=e.layService.nodes);for(var r=0;r<i.length;r++)for(var n=0;n<i[r].children.length;n++){if(i[r].children[n].key===t)return i[r].children[n];if(i[r].children[n].children&&i[r].children[n].children.length)return this.getNZTreeNodeByGraphId(t,[i[r].children[n]])}},e.showAnchorLines=function(e){var t=this,i=this.cesService.getEntityByGraphID(e);i&&(i.graph.anchorHelper&&i.graph.anchorHelper.targetGraphId?i.graph.anchorHelper.showConnectLineBySourceGraph(i.graph):i.graph.anchorHelper&&i.graph.anchorHelper.sourceGraphIdList&&i.graph.anchorHelper.sourceGraphIdList.forEach((function(e){var i=t.cesService.getEntityByGraphID(e);i&&i.graph.anchorHelper&&i.graph.anchorHelper.targetGraphId&&i.graph.anchorHelper.showConnectLineBySourceGraph(i.graph)})))},e.showNotAllowAnchorMessage=function(){e.nzMessageSer.warning("已被其他元素锚定，不可再锚定")},e.showAgainAnchorMessage=function(){e.nzMessageSer.warning("该元素已锚定其他元素")},e.generateTreeNodeLine=function(t){if(Object.keys(e.anchorClsTreeNodeMap).length)for(var i=0;i<t.length;i++)for(var r=0;r<t[i].children.length;r++)this.generateTreeNodeLine([t[i].children[r]]),e.anchorClsTreeNodeMap[t[i].children[r].key]&&(t[i].children[r].anchorCls=e.anchorClsTreeNodeMap[t[i].children[r].key])},e.prototype.hideAnchorConnectLine=function(){this.anchorConnectLine&&this.anchorConnectLine.remove&&this.anchorConnectLine.remove(),this.anchorConnectLineShow=!1,this.removeConnectLineListen(),this.removeListenerInRender()},e.hideAllAnchorLines=function(){var e=this;this.anchoredGraphList.forEach((function(t){var i=e.cesService.getEntityByGraphID(t);i&&i.graph&&i.graph.anchorHelper&&i.graph.anchorHelper.hideAnchorConnectLine()}))},e.addAnchoredGraph=function(e){this.anchoredGraphList.includes(e)||this.anchoredGraphList.push(e)},e.prototype.addAnchorConnectLine=function(e){var t=document.querySelector("#anchorConnectLineWrapper");if(t){e instanceof Cesium.Entity||(e=e.ent);var i=document.createElement("div");i.style.position="absolute",i.style.height="0px",i.style.transformOrigin="left",i.className="anchor-connect-line",this.anchorConnectLine=i,t.appendChild(this.anchorConnectLine),this.anchorConnectLineShow=!0,this.addConnectLineListen()}},e.prototype.addConnectLineListen=function(){var t=this,i=e.cesService.getEntityByGraphID(this.sourceGraphId);i&&(this.connectLineRender&&(this.connectLineRender(),this.connectLineRender=null),this.connectLineRender=this.viewer.scene.postRender.addEventListener((function(r){if(t.anchorMousePosition&&t.anchorMousePosition.x&&t.anchorMousePosition.y&&t.anchorConnectLine){if(!(i=e.cesService.getEntityByGraphID(t.sourceGraphId)))return;var n=e._getGraphPositionCartesian(i),o=Cesium.SceneTransforms.wgs84ToWindowCoordinates(t.viewer.scene,n);if(!o)return;var s=o.x,a=o.y,l=void 0,h=void 0;if(t.targetGraphId){var c=e.cesService.getEntityByGraphID(t.targetGraphId);if(!c)return;var u=e._getGraphPositionCartesian(c),p=Cesium.SceneTransforms.wgs84ToWindowCoordinates(t.viewer.scene,u);if(!p)return;l=p.x,h=p.y}else l=t.anchorMousePosition.x,h=t.anchorMousePosition.y;var d=l-s,m=h-a,f=Math.sqrt(Math.pow(l-s,2)+Math.pow(h-a,2)),g=Math.asin(m/f);d<0&&(g=Math.PI-g),t.anchorConnectLine.style.left="".concat(s,"px"),t.anchorConnectLine.style.top="".concat(a,"px"),t.anchorConnectLine.style.width="".concat(f-5,"px"),t.anchorConnectLine.style.transform="rotate(".concat(g,"rad)")}})),this.mouseMoveListener=new Cesium.ScreenSpaceEventHandler(this.viewer.scene.canvas),this.mouseMoveListener.setInputAction((function(e){t.anchorMousePosition.x=e.endPosition.x,t.anchorMousePosition.y=e.endPosition.y}),Cesium.ScreenSpaceEventType.MOUSE_MOVE))},e.prototype.addAnchorListenerInRender=function(){var t=this;if(this.targetGraphId){var i=e.cesService.getEntityByGraphID(this.sourceGraphId),r=e.cesService.getEntityByGraphID(this.targetGraphId);r&&(this.entityPositionMove&&(this.entityPositionMove(),this.entityPositionMove=null),this.entityPositionMove=this.viewer.scene.postRender.addEventListener((function(n){var o=!1;if(e.curEditGraphList&&e.curEditGraphList.length>0)for(var s=0;s<e.curEditGraphList.length;s++)if(e.curEditGraphList[s].id===t.targetGraphId){o=!0;break}if(i=e.cesService.getEntityByGraphID(t.sourceGraphId),r=e.cesService.getEntityByGraphID(t.targetGraphId),i&&r){var a=e._getGraphPositionCartesian(i),l=new Cesium.EllipsoidalOccluder(Cesium.Ellipsoid.WGS84,t.viewer.camera.position);if(!l.isPointVisible(a)&&t.anchorConnectLine instanceof HTMLElement)t.anchorConnectLine.style.display="none";else{var h=e._getGraphPositionCartesian(r),c=l.isPointVisible(h);c&&t.anchorConnectLine instanceof HTMLElement?t.anchorConnectLine.style.display="block":!c&&t.anchorConnectLine instanceof HTMLElement&&(t.anchorConnectLine.style.display="none")}if(o||e.cesService.isAnimationPlayOrPause||e.cesService.isFullScreenPlay||e.cesService.isTimelineAtDragging){if(t.deltaLng&&t.deltaLat){var u=e._getGraphPositionCartesian(r);if(!(E=Cesium.Cartographic.fromCartesian(u)))return;var p=Cesium.Math.toDegrees(E.longitude),d=Cesium.Math.toDegrees(E.latitude),m=E.height,f=r.graph,g=[p,d,m],A=Cesium.Cartesian3.fromDegrees(p-t.deltaLng,d-t.deltaLat,m-t.deltaAlt),y=r.graph;if(y){var v=new Cesium.HeadingPitchRoll(Cesium.Math.toRadians(y.heading),Cesium.Math.toRadians(y.pitch),Cesium.Math.toRadians(-y.roll)),C=Cesium.Transforms.headingPitchRollQuaternion(A,v);i.orientation=C;var _=e._getGraphPositionCartesian(i),b=Cesium.Cartographic.fromCartesian(_);if(!b)return;Cesium.Math.toDegrees(b.longitude),Cesium.Math.toDegrees(b.latitude);var w=[g[0]-t.deltaLng,g[1]-t.deltaLat,g[2]-t.deltaAlt],P=Cesium.Cartesian3.fromDegrees(w[0],w[1],w[2]),S=zy.lonlat2Cartesian(g,g[2]),x=(null==f?void 0:f.heading)-t.prevHeading,B=t.RotateMatrix(S,x),M=Cesium.Matrix3.multiplyByVector(B,P,new Cesium.Cartesian3);i.position=M,i.graph.ctrlPosition&&1===i.graph.ctrlPosition.length&&(i.graph.setCtrlPositionCartesian3(0,M),i.graph.setPrimitivePosition&&i.graph.setPrimitivePosition(M))}}}else{if(!r||!i)return;var E;u=e._getGraphPositionCartesian(r);if(!(E=Cesium.Cartographic.fromCartesian(u)))return;var T=Cesium.Math.toDegrees(E.longitude),O=Cesium.Math.toDegrees(E.latitude),L=E.height,D=e._getGraphPositionCartesian(i),I=Cesium.Cartographic.fromCartesian(D);if(!I)return;var R=Cesium.Math.toDegrees(I.longitude),H=Cesium.Math.toDegrees(I.latitude),F=I.height;t.deltaLng=T-R,t.deltaLat=O-H,t.deltaAlt=L-F}}})))}},e.prototype.removeListenerInRender=function(){this.connectLineRender&&(this.connectLineRender(),this.connectLineRender=null)},e.prototype.RotateMatrix=function(e,t){var i=Cesium.Math.toRadians(t),r=Math.sin(i),n=Math.cos(i),o=Math.sqrt(e.x*e.x+e.y*e.y+e.z*e.z),s=e.x/o,a=e.y/o,l=e.z/o,h=[n+(1-n)*s*s,-r*l+(1-n)*s*a,r*a+(1-n)*s*l,r*l+(1-n)*s*a,n+(1-n)*a*a,-r*s+(1-n)*a*l,-r*a+(1-n)*s*l,r*s+(1-n)*a*l,n+(1-n)*l*l];return Cesium.Matrix3.fromArray(h)},e.prototype.destroyAnchor=function(){var t=this;if(this.targetGraphId){var i=ey.getGraph(this.targetGraphId);if(i&&i.anchorHelper&&i.anchorHelper.sourceGraphIdList){var r=i.anchorHelper.sourceGraphIdList.findIndex((function(e){return e===t.sourceGraphId}));if(i.anchorHelper.sourceGraphIdList.splice(r,1),delete e.anchorClsTreeNodeMap[this.sourceGraphId],0===i.anchorHelper.sourceGraphIdList.length){e.getNZTreeNodeByGraphId(i.id).anchorCls=[],delete e.anchorClsTreeNodeMap[this.targetGraphId]}else{var n=e.getNZTreeNodeByGraphId(this.sourceGraphId);if(n){var o=n.parentNode;n.remove(),o.addChildren([n])}}}}this.sourceGraphId="",this.targetGraphId="",this.anchorConnectLine&&this.anchorConnectLine.remove&&(this.anchorConnectLine.remove(),this.anchorConnectLine=null),this.connectLineRender&&(this.connectLineRender(),this.connectLineRender=null),this.anchorMousePosition={x:0,y:0},this.mouseMoveListener&&(this.mouseMoveListener.destroy(),this.mouseMoveListener=null),this.entityPositionMove&&(this.entityPositionMove(),this.entityPositionMove=null),this.deltaLng="",this.deltaLat="",this.deltaAlt="",this.prevHeading="",this.deltaHeading="",this.sourceGraphIdList=[]},e.prototype.removeConnectLineListen=function(){this.mouseMoveListener&&(this.mouseMoveListener.destroy(),this.mouseMoveListener=null)},e.addIdInSourceGraphIdList=function(t,i){var r=this.cesService.getEntityByGraphID(i);r&&(r.graph.anchorHelper||(r.graph.anchorHelper=new e(this.cesService.viewer)),r.graph.anchorHelper.sourceGraphIdList.includes(t)||r.graph.anchorHelper.sourceGraphIdList.push(t))},e.prototype.showConnectLineBySourceGraph=function(e){e&&e.anchorHelper&&!e.anchorHelper.anchorConnectLineShow&&(e.anchorHelper.addAnchorConnectLine(e),e.anchorHelper.anchorConnectLineShow=!0)},e.prototype.removeAnchoredGraphEvents=function(){this.anchorConnectLine&&this.anchorConnectLine instanceof HTMLElement&&(this.anchorConnectLine.remove(),this.anchorConnectLine=null),this.connectLineRender&&(this.connectLineRender(),this.connectLineRender=null),this.mouseMoveListener&&(this.mouseMoveListener.destroy(),this.mouseMoveListener=null),this.entityPositionMove&&(this.entityPositionMove(),this.entityPositionMove=null)},e._getGraphPositionCartesian=function(e){return e.position&&e.position.getValue?e.position.getValue():e.graph.last_pos?e.graph.last_pos:e.position},e.anchorClsTreeNodeMap={},e.anchoredGraphList=[],Xy([(0,fy.o)(),Jy("design:type",Object)],e.prototype,"viewer",void 0),Xy([(0,fy.o)(),Jy("design:type",Object)],e.prototype,"connectLineRender",void 0),Xy([(0,fy.o)(),Jy("design:type",Object)],e.prototype,"mouseMoveListener",void 0),Xy([(0,fy.o)(),Jy("design:type",Object)],e.prototype,"entityPositionMove",void 0),Xy([(0,fy.o)(),Jy("design:type",Object)],e,"cesService",void 0),Xy([(0,fy.o)(),Jy("design:type",Object)],e,"curEditGraphList",void 0),Xy([(0,fy.o)(),Jy("design:type",Object)],e,"nzMessageSer",void 0),Xy([(0,fy.o)(),Jy("design:type",Object)],e,"layService",void 0),Xy([(0,fy.o)(),Jy("design:type",Object)],e,"anchorClsTreeNodeMap",void 0),e}();const Vy=Ky;var qy=i(5108),$y=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},ev=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},tv=function(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],r=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};"undefined"==typeof Cesium&&(i.g.Cesium={},i.g.Cesium.Viewer={});var iv=function(){function e(e,t,i){var r=this;this.isChanged=!1,this.reloadOperator=!1,this.rotatable=!0,this.scalable=!0,this.ctrlsCollection=null,this.middleCtrlsCollection=null,this.maxPointNum=1/0,this.minPointNum=1,this.support2D=!0,this.properties=[],this.enabled=!0,this._singleControlPosition=[],this.tmpHeading=0,this.positionChanged=new th.x,this.isPositionConstant=!0,this.animationInitPropArray=[],this.hideValues=[],this.baseUrl=qh.formatUrlByBaseJs("./resources/image/"),this._level=0,this.description="",this._ctrlPosition=[],this._pointIndex=0,this.gridGroup=3,this.middleClosed=!1,this.rotateByHeadingProperty=[],this.rotateByPitchProperty=[],this.rotateByRollProperty=[],this.scaleZProperty=[],this.scaleXProperty=[],this.scaleYProperty=[],this.scaleProperty=[],this.movePositionProperty=["_singleControlPosition"],this.moveHeightProperty=["_singleControlPosition"],this.isAddControlPointEntity=!0,this._fromJsonFilterKeys=["ignoreDefualt","material"],this.sg=py.getInstance(),this.allowCrossGround=!1,this.gridColor="rgba(163,199,241,0.39)",this.gridOutlineColor="#4A90E2",this.gridIsAgg=!0,e&&(this._earth=e,this.entities=e.viewer.entities,this.viewer=e.viewer,this.initRootEntity(t),this.level=0,this.isReadOnly=!1,this.show=!0,this.propertyChanged=new Cesium.Event),this.positionChanged.subscribe((function(e){r.resetControlPosition(e)})),(0,P.extendObservable)(this,{isSelected:!1,enabled:!1,name:""})}return e.prototype.resetControlPosition=function(e){this.isPositionConstant=!1;for(var t=0;t<this._singleControlPosition.length;t++){if(this.ctrlsCollection&&(this.ctrlsCollection.get(t)?this.ctrlsCollection.get(t).position=this._singleControlPosition[t]:(this.addCtl(this._singleControlPosition[t]),this.addMitCtrl(t))),this.middleCtrlsCollection&&t>0){var i=this.lerp(t,t-1);this.middleCtrlsCollection.get(t-1).position=i}this.middleClosed&&(this.middleCtrlsCollection.get(this.middleCtrlsCollection.length-1).position=this.lerp(this._singleControlPosition.length-1,0))}},e.prototype.onPropertyChanged=function(e){this.propertyChanged&&this.propertyChanged.raiseEvent(e)},e.prototype.initDefaultProps=function(e){for(var t in e)this[t]=e[t]},Object.defineProperty(e.prototype,"name",{get:function(){return this._name},set:function(e){this._name=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"level",{get:function(){return this._level},set:function(e){var t,i;this._level=e;var r=this.getUpdateLevelPrimtive();if(r instanceof Array)try{for(var n=tv(r),o=n.next();!o.done;o=n.next()){var s=o.value;s&&this.viewer.scene.orderGroundPrimitives.set(s,this.level)}}catch(e){t={error:e}}finally{try{o&&!o.done&&(i=n.return)&&i.call(n)}finally{if(t)throw t.error}}else r&&this.viewer.scene.orderGroundPrimitives.set(r,this.level)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"show",{get:function(){return this._show},set:function(e){this._show=e,this.ent&&(this.ent.show=e),this.primitive&&(this.primitive.show=e&&this.gridSwitch),this.onPropertyChanged("show")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"distanceDisplay",{get:function(){return this._distanceDisplay},set:function(e){this._distanceDisplay=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"distanceHeight",{get:function(){return this._distanceHeight},set:function(e){this._distanceHeight=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ctrlPosition",{get:function(){return this._ctrlPosition},set:function(e){this._ctrlPosition=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pointIndex",{get:function(){return this._pointIndex},set:function(e){"string"==typeof e&&(e=Number.parseInt(e)),this._pointIndex=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"longitude",{get:function(){return this._ctrlPosition[this.pointIndex]?this._ctrlPosition[this.pointIndex].lon.toFixed(8):"0"},set:function(e){this._ctrlPosition[this.pointIndex].lon=Number(e),this.setCtrlPosition(this._pointIndex,this._ctrlPosition[this._pointIndex])},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"latitude",{get:function(){return this._ctrlPosition[this.pointIndex]?this._ctrlPosition[this.pointIndex].lat.toFixed(8):"0"},set:function(e){this._ctrlPosition[this.pointIndex].lat=Number(e),this.setCtrlPosition(this._pointIndex,this._ctrlPosition[this._pointIndex])},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"elevation",{get:function(){if(!this._ctrlPosition[this.pointIndex])return"0";var e=this._ctrlPosition[this.pointIndex].alt;return"string"==typeof e&&(e=Number.parseFloat(e)),e.toFixed(8)},set:function(e){this._ctrlPosition[this.pointIndex].alt=Number(e),this.setCtrlPosition(this._pointIndex,this._ctrlPosition[this._pointIndex])},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"gridSwitch",{get:function(){return this._gridSwitch},set:function(e){this._gridSwitch=e,e?this.gridUpdate():this.destroyPrimitive()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"gridLevel",{get:function(){return this._gridLevel},set:function(e){this._gridLevel=e,this.gridUpdate()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"gridIsAgg",{get:function(){return this._gridIsAgg},set:function(e){this._gridIsAgg=e,this.primitive&&this.gridUpdate()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"gridColor",{get:function(){return this._gridColor},set:function(e){this._gridColor=e,this.primitive&&this.gridUpdateColor()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"gridOutlineColor",{get:function(){return this._gridOutlineColor},set:function(e){this._gridOutlineColor=e,this.primitive&&this.gridUpdateColor()},enumerable:!1,configurable:!0}),e.prototype.gridUpdate=function(){},e.prototype.gridUpdateColor=function(){var e=this.primitive.get(0).getGeometryInstanceAttributes("0");e&&(e.color=Cesium.ColorGeometryInstanceAttribute.toValue(Cesium.Color.fromCssColorString(this.gridOutlineColor)));var t=this.primitive.get(1).getGeometryInstanceAttributes("1");t&&(t.color=Cesium.ColorGeometryInstanceAttribute.toValue(Cesium.Color.fromCssColorString(this.gridColor)))},e.prototype.getUpdateLevelPrimtive=function(){},e.prototype.formatBBox=function(e){var t,i,r,n;if(e.length>0){var o=[],s=[];try{for(var a=tv(e),l=a.next();!l.done;l=a.next()){var h=l.value,c=h.bbox.substring(1,h.bbox.length-1).split(","),u=[];try{for(var p=(r=void 0,tv(c)),d=p.next();!d.done;d=p.next()){var m=d.value.split(" ");u.push(m[0]),u.push(m[1])}}catch(e){r={error:e}}finally{try{d&&!d.done&&(n=p.return)&&n.call(p)}finally{if(r)throw r.error}}o.push(Cesium.Cartesian3.fromDegrees(u[0],u[1])),o.push(Cesium.Cartesian3.fromDegrees(u[2],u[1])),o.push(Cesium.Cartesian3.fromDegrees(u[2],u[1])),o.push(Cesium.Cartesian3.fromDegrees(u[2],u[3])),o.push(Cesium.Cartesian3.fromDegrees(u[2],u[3])),o.push(Cesium.Cartesian3.fromDegrees(u[0],u[3])),o.push(Cesium.Cartesian3.fromDegrees(u[0],u[3])),o.push(Cesium.Cartesian3.fromDegrees(u[0],u[1])),s.push(Cesium.Cartesian3.fromDegrees(u[0],u[1])),s.push(Cesium.Cartesian3.fromDegrees(u[2],u[1])),s.push(Cesium.Cartesian3.fromDegrees(u[2],u[3])),s.push(Cesium.Cartesian3.fromDegrees(u[0],u[1])),s.push(Cesium.Cartesian3.fromDegrees(u[2],u[3])),s.push(Cesium.Cartesian3.fromDegrees(u[0],u[3]))}}catch(e){t={error:e}}finally{try{l&&!l.done&&(i=a.return)&&i.call(a)}finally{if(t)throw t.error}}return{polyline:o,polygon:s}}},e.prototype.drawGrid=function(e){var t=Cesium.Color.fromCssColorString(this.gridOutlineColor),i=Cesium.Color.fromCssColorString(this.gridColor),r=[],n=[];function o(e,t){e.push(t.red),e.push(t.green),e.push(t.blue),e.push(t.alpha)}for(var s=0;s<e.polyline.length;s++)o(r,t);for(s=0;s<e.polygon.length;s++)o(n,i);this.primitive?this.primitive.removeAll():(this.primitive=new Cesium.PrimitiveCollection({destroyPrimitives:!1}),this.viewer.scene.primitives.add(this.primitive));var a=new Zy(this.viewer,e.polyline,r,!0),l=new Cesium.Primitive({geometryInstances:new Cesium.GeometryInstance({geometry:a.geometry,attributes:{color:Cesium.ColorGeometryInstanceAttribute.fromColor(Cesium.Color.fromCssColorString(this.gridOutlineColor))},id:"0"}),appearance:a.appearance,asynchronous:!1});this.primitive.add(l);var h=new Wy(this.viewer,e.polygon,n),c=new Cesium.Primitive({geometryInstances:[new Cesium.GeometryInstance({geometry:h.geometry,id:"1",attributes:{color:Cesium.ColorGeometryInstanceAttribute.fromColor(Cesium.Color.fromCssColorString(this.gridColor))}})],appearance:h.appearance,asynchronous:!1});this.primitive.add(c)},e.prototype.destroyPrimitive=function(){this.primitive.removeAll(),this.primitive=void 0},Object.defineProperty(e.prototype,"allowCrossGround",{get:function(){return this._allowCrossGround},set:function(e){this._allowCrossGround=e},enumerable:!1,configurable:!0}),e.prototype.initCtls=function(e){var t=this;void 0===e&&(e=!0),this._singleControlPosition=[],this.ctls&&(this.ctrlPosition=this.ctls),this.ctrlPosition&&((!1===e||this.ctrlPosition.length>500)&&(this.isAddControlPointEntity=!1),this.ctrlPosition.forEach((function(e){return t.addCtlPoint(e)}))),!this.primitive&&this.gridSwitch&&this.gridUpdate()},e.prototype.initRootEntity=function(e){this.graph={},this.graph.ctlEntity={},this.graph.ctl={_children:[]},this.graph.shape={}},e.prototype.initShape=function(){throw"should overide by sub class."},e.prototype.getCtlPositions=function(){Cesium.JulianDate.fromDate(new Date);return this._singleControlPosition.map((function(e){return e}))},e.prototype.setCtrlPosition=function(e,t){var i=zy.lonlathei2Cartesian(t);this._singleControlPosition[e]=i,this.positionChanged.next(!0)},e.prototype.setCtrlPositionCartesian3=function(e,t){this._singleControlPosition[e]=t,this.positionChanged.next(!0)},e.prototype.insertPositionCartesian3=function(e,t){if(e?this._singleControlPosition.splice(e,0,t):this._singleControlPosition.push(t),this.isAddControlPointEntity){this.addCtl(t,e);this.addMitCtrl(e)}this.positionChanged.next(!0)},e.prototype.addMitCtrl=function(e){var t=this;if(this._singleControlPosition.length!=this.maxPointNum&&(this.middleCtrlsCollection||(this.middleCtrlsCollection=this.viewer.scene.primitives.add(new Cesium.BillboardCollection),this.middleCtrlsCollection._scene=this.viewer.scene),e>=0)){var i=void 0;i=0==e?this.lerp(0,this._singleControlPosition.length-1):this.lerp(e,e-1);var r=this.middleCtrlsCollection.add({width:15,height:15,position:i,image:this.sg.createMidPointCanvas()});r.heightReference=this.heightReference,r.graphType="ctl",r.pickup=function(){if(!t.isReadOnly){for(var e,i=-1,n=0;n<t.middleCtrlsCollection.length;n++)if(t.middleCtrlsCollection.get(n)==r){i=n;break}e=i+1==t._singleControlPosition.length?t.lerp(0,i):t.lerp(i+1,i),t.insertPositionCartesian3(i+1,e),$A.currentGraph=t,$A.index=i+1}},r.finish=function(){$A.currentGraph=void 0}}},e.prototype.resetHeightReference=function(){if(this.ctrlsCollection)for(var e=this.ctrlsCollection.length,t=0;t<e;t++){this.ctrlsCollection.get(t).heightReference=this.heightReference}if(this.middleCtrlsCollection){var i=this.middleCtrlsCollection.length;for(t=0;t<i;t++){this.middleCtrlsCollection.get(t).heightReference=this.heightReference}}},e.prototype.lerp=function(e,t){return Cesium.Cartesian3.lerp(this._singleControlPosition[e],this._singleControlPosition[t],.5,new Cesium.Cartesian3)},e.prototype.addCtl=function(t,i,r){var n=this;void 0===i&&(i=void 0),void 0===r&&(r=!0),this.ctrlsCollection||(this.ctrlsCollection=this.viewer.scene.primitives.add(new Cesium.BillboardCollection),this.ctrlsCollection._scene=this.viewer.scene),null!=i&&null!=i||(i=this._singleControlPosition.length-1);var o=this.ctrlsCollection.add({id:this.graph.id+"_ctlpoint_"+e.seq++,position:t,image:this.sg.createCtrlPointCanvas(),eyeOffset:new Cesium.Cartesian3(0,0,-10)});return i?this.graph.ctl._children.splice(i,0,o):this.graph.ctl._children.push(o),o.heightReference=this.heightReference,o.graphType="ctl",o.index=i,o.finish=function(){$A.currentGraph=void 0},o.pickup=function(){if(!n.isReadOnly){var e=n._singleControlPosition.findIndex((function(e){return e.equals(o.position)}));$A.index=e,$A.currentGraph=n,n.pointIndex=e}},r&&this.handleNewCtl(o),o},e.prototype.handleNewCtl=function(e){},e.prototype.addCtlPoint=function(e,t){void 0===t&&(t=void 0);var i=zy.lonlathei2Cartesian(e);if(t||(t=this._singleControlPosition.length),this._singleControlPosition.splice(t,0,i),this.isAddControlPointEntity){this.addCtl(i,t);this.addMitCtrl(t)}},e.prototype.fillShape=function(t){var i=this;return void 0!==this.id&&""!==this.id||(t.id||(t.id=Yy.newGuid()),this.id=t.id),t.id&&(this.gvolGuid=t.id),ey.register(this),t.graphType="shp",t.seq=e.seq,t.highLighted=!1,t.highLight=function(){return t.highLighted=!0},t.downLight=function(){return t.highLighted=!1},t.finish=function(){return i.finish()},t.toEdit=function(){return i.toEdit()},t.addCtlPoint=function(e){return i.addCtlPoint(e)},t.ishaveMaxCtls=function(){return i.ishaveMaxCtls()},t.isCtlNumValid=function(){return i.isCtlNumValid()},t.deleteLastPoint=function(){return i.deleteLastPoint()},t.delete=function(){return i.delete()},t.graph=this,t.level=new Cesium.CallbackProperty((function(e,t){return i.level}),!0),t},e.prototype.ishaveMaxCtls=function(){return this.graph.ctl._children.length>=this.maxPointNum},e.prototype.setInternalControlPosition=function(e,t){var i=e.map((function(e){return zy.cartesian2lonlat(e)})),r=!1;if(i.length>this._ctrlPosition.length){for(var n=0;n<i.length-this._ctrlPosition.length;n++)this._ctrlPosition.push(new A);r=!0}if(i.length<this._ctrlPosition.length){var o=this._ctrlPosition.length-i.length;for(n=0;n<o;n++)this._ctrlPosition.splice(this._ctrlPosition.length-1,1);r=!0}for(n=0;n<this._ctrlPosition.length;n++)this._ctrlPosition[n].lon!=i[n][0]&&(this._ctrlPosition[n].lon=i[n][0],r=!0),this._ctrlPosition[n].lat!=i[n][1]&&(this._ctrlPosition[n].lat=i[n][1],r=!0),this._ctrlPosition[n].alt!=i[n][2]&&(this._ctrlPosition[n].alt=i[n][2],r=!0);r&&this.onControlPositionChanged&&this.onControlPositionChanged(this.ctrlPosition)},e.prototype.isCtlNumValid=function(){var e=this.graph.ctl._children.length;return(this.maxPointNum===1/0||e<=this.maxPointNum)&&e>=this.minPointNum},e.prototype.toEdit=function(){if(this._singleControlPosition.length>0&&this._singleControlPosition.length<200){for(var e=0;e<this._singleControlPosition.length;e++){this.addCtl(this._singleControlPosition[e],e);e>0&&this.addMitCtrl(e)}this.middleClosed&&this.addMitCtrl(0)}},e.prototype.finish=function(){this.graph.ctl._children=[],this.viewer.scene.primitives.remove(this.ctrlsCollection),this.ctrlsCollection=null,this.viewer.scene.primitives.remove(this.middleCtrlsCollection),this.middleCtrlsCollection=null},e.prototype.delete=function(){var e=this;this.sg.gxCluster&&this.clusterPoint&&this.sg.gxCluster.removePoint(this.clusterPoint),this.ent instanceof ry&&this.ent.removeAll(),this.ent instanceof uy&&this.ent.clear(),(this.ent instanceof Cesium.PrimitiveCollection||this.ent instanceof Cesium.ParticleSystem)&&(this.ent.destroy(),this.primitive&&this.primitive.destroy(),null!=this.ent._zIndex?this.viewer.scene.orderGroundPrimitives.remove(this.ent,!1):this.viewer.scene.primitives.remove(this.ent)),this.ent instanceof Cesium.Primitive&&(this.ent.destroy(),this.primitive&&this.primitive.destroy(),this.viewer.scene.primitives.remove(this.ent)),this.ent instanceof Cesium.GroundPrimitive&&(this.ent.destroy(),this.primitive&&this.primitive.destroy(),this.viewer.scene.primitives.remove(this.ent)),this.ent instanceof Cesium.GroundPolylinePrimitive&&(this.ent.destroy(),this.primitive&&this.primitive.destroy(),this.viewer.scene.primitives.remove(this.ent)),this.ctrlsCollection&&(this.viewer.scene.primitives.remove(this.ctrlsCollection),this.ctrlsCollection=null),this.middleCtrlsCollection&&(this.viewer.scene.primitives.remove(this.middleCtrlsCollection),this.middleCtrlsCollection=null),Array.isArray(this.entArr)&&(qy.log("删除geojson面，包括面和边框线>>>",this.entArr),this.entArr.forEach((function(t){t instanceof Cesium.GroundPrimitive&&(t.destroy(),e.viewer.scene.primitives.remove(t)),t instanceof Cesium.GroundPolylinePrimitive&&(t.destroy(),e.viewer.scene.primitives.remove(t))}))),this.deleteEnts([this.graph]),this.ent=null},e.prototype.deleteEnts=function(e){var t=this;this.ent instanceof Cesium.EntityCollection&&this.viewer.dataSources.remove(this.ent.owner,!0),this.ent instanceof Cesium.Entity&&this.viewer.entities.remove(this.ent),e.forEach((function(e){e._children&&e._children.length>0&&t.deleteEnts(e._children),t.entities.remove(e)}))},e.prototype.deleteLastPoint=function(){var e=this.graph.ctl._children.pop();this.entities.remove(e)},e.prototype.deleteCtlPoint=function(e){this.ctrlsCollection.remove(this.ctrlsCollection.get(0)),this.middleCtrlsCollection&&this.middleCtrlsCollection.remove(this.middleCtrlsCollection.get(0)),this._singleControlPosition.splice(e,1),this.positionChanged.next(!0)},e.prototype.movePosition=function(e,t){var i,r,n=this.viewer;if(n){var o=n.camera.pickEllipsoid(t,n.scene.globe.ellipsoid);if(o){var s=n.camera.pickEllipsoid(e,n.scene.globe.ellipsoid);if(Cesium.defined(s)){var a=this.viewer.scene.globe.ellipsoid,l=a.cartesianToCartographic(o),h=Cesium.Math.toDegrees(l.latitude),c=Cesium.Math.toDegrees(l.longitude),u=a.cartesianToCartographic(s),p=h-Cesium.Math.toDegrees(u.latitude),d=c-Cesium.Math.toDegrees(u.longitude),m=[];try{for(var f=tv(this._singleControlPosition),g=f.next();!g.done;g=f.next()){var A=g.value,y=a.cartesianToCartographic(A),v=Cesium.Math.toDegrees(y.latitude),C=Cesium.Math.toDegrees(y.longitude),_=y.height,b=v+p,w=C+d,P=Cesium.Cartographic.fromDegrees(w,b,_),S=a.cartographicToCartesian(P);m.push(S)}}catch(e){i={error:e}}finally{try{g&&!g.done&&(r=f.return)&&r.call(f)}finally{if(i)throw i.error}}this._singleControlPosition=m,this.onPropertyChanged()}}}},e.prototype.moveHeight=function(e,t){var i,r,n=this.getCenter(),o=zy.getHeightByCartesian3(n,this.viewer),s=this.ChangeLengthByMouse(o,t.y-e.y,1),a=[];try{for(var l=tv(this._singleControlPosition),h=l.next();!h.done;h=l.next()){var c=h.value,u=zy.getHeightByCartesian3(c,this.viewer)-o+s;this.allowCrossGround||u<0&&(u=0),a.push(zy.getHeightdefineByXYZ(c,u,this.viewer))}}catch(e){i={error:e}}finally{try{h&&!h.done&&(r=l.return)&&r.call(l)}finally{if(i)throw i.error}}this._singleControlPosition=a,this.onPropertyChanged()},e.prototype.toDegrees=function(e){var t=Cesium.Cartographic.fromCartesian(e);if(t)return[t.longitude/Math.PI*180,t.latitude/Math.PI*180]},e.prototype.calculateCursor=function(){$A.currentGraph==this&&($A.cursorPos=this._singleControlPosition[$A.index])},e.prototype.ChangeMoveByMouse=function(e,t){},e.prototype.ScreenPixel=function(){return this.viewer.camera.positionCartographic.height/1047.776588},e.prototype.ChangeLengthByMouse=function(e,t,i){return void 0===i&&(i=3),e-=t*(this.ScreenPixel()*i)},e.prototype.changeScaleByMouse=function(e,t,i){var r=t.x-i.x;if(0!=r){var n=1;e=(n=r>0?e/(1+r/64):e*(1+-r/64))<=0?1e-12:n}return e},e.prototype.getCenter=function(){return 0==this._singleControlPosition.length?this._singleControlPosition[0]:Cesium.BoundingSphere.fromPoints(this._singleControlPosition).center},e.prototype.getBoundingRectangle=function(){return Cesium.Rectangle.fromCartesianArray(this._singleControlPosition)},e.prototype.toJson=function(){return my.ZP.serialize(this)},Object.defineProperty(e.prototype,"earth",{get:function(){return this._earth},enumerable:!1,configurable:!0}),e.prototype.getPerspective=function(){var e=this.viewer.scene.globe.ellipsoid.cartesianToCartographic(this.viewer.camera.position);this.camera={longitude:0,latitude:0,height:0,heading:0,pitch:0,roll:0};var t=this.camera;t.longitude=Cesium.Math.toDegrees(e.longitude),t.latitude=Cesium.Math.toDegrees(e.latitude),t.height=e.height,t.heading=Cesium.Math.toDegrees(this.viewer.camera.heading),t.pitch=Cesium.Math.toDegrees(this.viewer.camera.pitch),t.roll=Cesium.Math.toDegrees(this.viewer.camera.roll),qy.log("graphCamera",t)},e.prototype.toGeoJsonGeometry=function(){return{type:"Point",coordinates:[this.ctrlPosition[0].lon,this.ctrlPosition[0].lat,this.ctrlPosition[0].alt]}},e.prototype.gvolFromJSON=function(e){e=Object.assign({},{},e),h.Z.jsonToPlainObject(e,this,this._fromJsonFilterKeys)},e.prototype.destroy=function(){return Cesium.destroyObject(this)},e.seq=(new Date).getTime(),$y([(0,fy.o)(),ev("design:type",Object)],e.prototype,"_earth",void 0),$y([(0,fy.o)(),ev("design:type",Cesium.Viewer)],e.prototype,"viewer",void 0),$y([(0,fy.o)(),ev("design:type",Boolean)],e.prototype,"isChanged",void 0),$y([(0,fy.o)(),ev("design:type",Boolean)],e.prototype,"reloadOperator",void 0),$y([(0,fy.o)(),ev("design:type",Boolean)],e.prototype,"rotatable",void 0),$y([(0,fy.o)(),ev("design:type",Boolean)],e.prototype,"scalable",void 0),$y([(0,fy.o)(),ev("design:type",Object)],e.prototype,"entities",void 0),$y([(0,fy.o)(),ev("design:type",Cesium.BillboardCollection)],e.prototype,"ctrlsCollection",void 0),$y([(0,fy.o)(),ev("design:type",Cesium.BillboardCollection)],e.prototype,"middleCtrlsCollection",void 0),$y([(0,fy.o)(),ev("design:type",Object)],e.prototype,"ent",void 0),$y([(0,fy.o)(),ev("design:type",Object)],e.prototype,"entArr",void 0),$y([(0,fy.o)(),ev("design:type",Cesium.Event)],e.prototype,"propertyChanged",void 0),$y([(0,fy.o)(),ev("design:type",Object)],e.prototype,"maxPointNum",void 0),$y([(0,fy.o)(),ev("design:type",Object)],e.prototype,"minPointNum",void 0),$y([(0,fy.o)(),ev("design:type",Object)],e.prototype,"support2D",void 0),$y([(0,fy.o)(),ev("design:type",Object)],e.prototype,"graph",void 0),$y([(0,fy.o)(),ev("design:type",Object)],e.prototype,"highLighted",void 0),$y([(0,fy.o)(),ev("design:type",Object)],e.prototype,"properties",void 0),$y([(0,fy.o)(),ev("design:type",Boolean)],e.prototype,"_isReadOnly",void 0),$y([(0,fy.o)(),ev("design:type",Array)],e.prototype,"_singleControlPosition",void 0),$y([(0,fy.o)(),ev("design:type",Object)],e.prototype,"clusterPoint",void 0),$y([(0,fy.o)(),ev("design:type",Object)],e.prototype,"tmpHeading",void 0),$y([(0,fy.o)(),ev("design:type",py)],e.prototype,"sg",void 0),$y([(0,fy.o)(),ev("design:type",th.x)],e.prototype,"positionChanged",void 0),$y([(0,fy.o)(),ev("design:type",Object)],e.prototype,"isPositionConstant",void 0),$y([(0,fy.o)(),ev("design:type",Array)],e.prototype,"animationInitPropArray",void 0),$y([(0,fy.o)(),ev("design:type",Array)],e.prototype,"hideValues",void 0),$y([(0,fy.o)(),ev("design:type",Object)],e.prototype,"baseUrl",void 0),$y([(0,fy.o)(),ev("design:type",Function),ev("design:paramtypes",[String]),ev("design:returntype",void 0)],e.prototype,"onPropertyChanged",null),$y([(0,fy.o)(),ev("design:type",Function),ev("design:paramtypes",[Object]),ev("design:returntype",void 0)],e.prototype,"initDefaultProps",null),$y([dy({name:"编号",group:"通用",type:"text",order:2,maxLength:8,noEmpty:!0,hidden:!0}),ev("design:type",String)],e.prototype,"id",void 0),$y([dy({name:"名称",group:"标题",order:1,subGroup:"名称可见锁定",subOrder:1,showGroup:!1,hiddenGroupName:!0,type:"title-name",noEmpty:!0}),ev("design:type",String),ev("design:paramtypes",[String])],e.prototype,"name",null),$y([dy({name:"层(贴地)",group:"通用",type:"number",order:2,min:0,hidden:!1}),ev("design:type",Number),ev("design:paramtypes",[Number])],e.prototype,"level",null),$y([dy({name:"描述",group:"通用",type:"string",order:2,subOrder:2,noEmpty:!1,hidden:!0}),ev("design:type",String)],e.prototype,"description",void 0),$y([dy({name:"类型",group:"通用",type:"plotType",order:2,subOrder:2,noEmpty:!1,hidden:!0}),ev("design:type",String)],e.prototype,"type",void 0),$y([dy({name:"只读",group:"标题",order:1,subGroup:"名称可见锁定",subOrder:2,showGroup:!1,hiddenGroupName:!0,type:"title-read"}),ev("design:type",Boolean)],e.prototype,"isReadOnly",void 0),$y([dy({name:"视角获取",group:"通用",type:"button",order:2}),ev("design:type",Boolean)],e.prototype,"_show",void 0),$y([dy({name:"可见",group:"标题",order:1,subGroup:"名称可见锁定",subOrder:3,showGroup:!1,hiddenGroupName:!0,type:"title-show"}),ev("design:type",Boolean),ev("design:paramtypes",[Boolean])],e.prototype,"show",null),$y([dy({name:"可视高度",group:"通用",subGroup:"可视高度",subOrder:1,type:"checkboxSub",order:2,hiddenGroupName:!1}),ev("design:type",Boolean),ev("design:paramtypes",[Boolean])],e.prototype,"distanceDisplay",null),$y([dy({name:"可视高度距离",group:"通用",subGroup:"可视高度",subOrder:2,type:"number3",order:2,hiddenGroupName:!1,min:0,max:2e7}),ev("design:type",Number),ev("design:paramtypes",[Number])],e.prototype,"distanceHeight",null),$y([(0,fy.o)(),(0,gy.C)(),ev("design:type",Object),ev("design:paramtypes",[Object])],e.prototype,"ctrlPosition",null),$y([(0,fy.o)(),ev("design:type",Object)],e.prototype,"_pointIndex",void 0),$y([(0,fy.o)(),dy({name:"坐标",group:"通用",showGroup:!1,subOrder:24,type:"option2",order:2,multiDisplay:!1}),ev("design:type",Object),ev("design:paramtypes",[Object])],e.prototype,"pointIndex",null),$y([(0,fy.o)(),dy({name:"经度",group:"通用",showGroup:!1,type:"numberNew",order:2,subOrder:25,max:180,min:-180,multiDisplay:!1}),ev("design:type",Object),ev("design:paramtypes",[Object])],e.prototype,"longitude",null),$y([(0,fy.o)(),dy({name:"纬度",group:"通用",showGroup:!1,type:"numberNew",order:2,subOrder:26,max:90,min:-90,multiDisplay:!1}),ev("design:type",Object),ev("design:paramtypes",[Object])],e.prototype,"latitude",null),$y([(0,fy.o)(),dy({name:"高度",group:"通用",showGroup:!1,type:"altHeight",order:2,subOrder:27,multiDisplay:!1,max:9999999999,min:-999999}),ev("design:type",Object),ev("design:paramtypes",[Object])],e.prototype,"elevation",null),$y([dy({name:"网格开关",group:"北斗网格",subGroup:"网格",order:10,subOrder:30,type:"checkboxSub",hidden:!0}),ev("design:type",Boolean),ev("design:paramtypes",[Boolean])],e.prototype,"gridSwitch",null),$y([dy({name:"网格层级",group:"北斗网格",subGroup:"网格",order:10,subOrder:31,type:"gridLevel",min:6,max:22,hidden:!0}),ev("design:type",Number),ev("design:paramtypes",[Number])],e.prototype,"gridLevel",null),$y([dy({name:"网格聚合",group:"北斗网格",subGroup:"网格聚合",order:10,subOrder:32,type:"checkboxSub",hidden:!0}),ev("design:type",Boolean),ev("design:paramtypes",[Boolean])],e.prototype,"gridIsAgg",null),$y([dy({name:"网格填充颜色",group:"北斗网格",subGroup:"网格填充",order:10,subOrder:33,type:"colorWithAlpha",hidden:!0}),ev("design:type",String),ev("design:paramtypes",[String])],e.prototype,"gridColor",null),$y([dy({name:"网格边框颜色",group:"北斗网格",subGroup:"网格边框",order:10,subOrder:34,type:"colorWithAlpha",hidden:!0}),ev("design:type",String),ev("design:paramtypes",[String])],e.prototype,"gridOutlineColor",null),$y([dy({name:"网格更新",group:"北斗网格",subGroup:"网格更新",order:10,subOrder:35,type:"gridButton",hiddenGroupName:!0,hidden:!0}),(0,fy.o)(),ev("design:type",Function),ev("design:paramtypes",[]),ev("design:returntype",void 0)],e.prototype,"gridUpdate",null),$y([(0,fy.o)(),ev("design:type",Function),ev("design:paramtypes",[]),ev("design:returntype",void 0)],e.prototype,"gridUpdateColor",null),$y([(0,fy.o)(),ev("design:type",Vy)],e.prototype,"anchorHelper",void 0),$y([(0,fy.o)(),ev("design:type",Function),ev("design:paramtypes",[Object]),ev("design:returntype",void 0)],e.prototype,"formatBBox",null),$y([(0,fy.o)(),ev("design:type",Function),ev("design:paramtypes",[]),ev("design:returntype",void 0)],e.prototype,"destroyPrimitive",null),$y([(0,fy.o)(),ev("design:type",Object)],e.prototype,"primitive",void 0),$y([dy({name:"穿地",group:"外观",type:"checkbox",order:8,multiDisplay:!1}),ev("design:type",Boolean),ev("design:paramtypes",[Boolean])],e.prototype,"allowCrossGround",null),$y([(0,fy.o)(),ev("design:type",Function),ev("design:paramtypes",[Object]),ev("design:returntype",void 0)],e.prototype,"initCtls",null),$y([(0,fy.o)(),ev("design:type",Function),ev("design:paramtypes",[Object]),ev("design:returntype",void 0)],e.prototype,"initRootEntity",null),$y([(0,fy.o)(),ev("design:type",Function),ev("design:paramtypes",[]),ev("design:returntype",void 0)],e.prototype,"initShape",null),$y([(0,fy.o)(),ev("design:type",Function),ev("design:paramtypes",[]),ev("design:returntype",void 0)],e.prototype,"getCtlPositions",null),$y([(0,fy.o)(),ev("design:type",Function),ev("design:paramtypes",[Number,Object]),ev("design:returntype",void 0)],e.prototype,"setCtrlPosition",null),$y([(0,fy.o)(),ev("design:type",Function),ev("design:paramtypes",[Number,Object]),ev("design:returntype",void 0)],e.prototype,"setCtrlPositionCartesian3",null),$y([(0,fy.o)(),ev("design:type",Function),ev("design:paramtypes",[Number,Object]),ev("design:returntype",void 0)],e.prototype,"insertPositionCartesian3",null),$y([(0,fy.o)(),ev("design:type",Object)],e.prototype,"ctls",void 0),$y([(0,fy.o)(),ev("design:type",Function),ev("design:paramtypes",[Object,Object,Object]),ev("design:returntype",void 0)],e.prototype,"addCtl",null),$y([(0,fy.o)(),ev("design:type",Function),ev("design:paramtypes",[Object]),ev("design:returntype",void 0)],e.prototype,"handleNewCtl",null),$y([(0,fy.o)(),ev("design:type",Function),ev("design:paramtypes",[Object]),ev("design:returntype",void 0)],e.prototype,"fillShape",null),$y([(0,fy.o)(),ev("design:type",Function),ev("design:paramtypes",[]),ev("design:returntype",void 0)],e.prototype,"ishaveMaxCtls",null),$y([(0,fy.o)(),ev("design:type",Function),ev("design:paramtypes",[Object,Object]),ev("design:returntype",void 0)],e.prototype,"setInternalControlPosition",null),$y([(0,fy.o)(),ev("design:type",Function)],e.prototype,"onControlPositionChanged",void 0),$y([(0,fy.o)(),ev("design:type",Function),ev("design:paramtypes",[]),ev("design:returntype",void 0)],e.prototype,"toEdit",null),$y([(0,fy.o)(),ev("design:type",Function),ev("design:paramtypes",[]),ev("design:returntype",void 0)],e.prototype,"finish",null),$y([(0,fy.o)(),ev("design:type",Function),ev("design:paramtypes",[]),ev("design:returntype",void 0)],e.prototype,"delete",null),$y([(0,fy.o)(),ev("design:type",Function),ev("design:paramtypes",[Object]),ev("design:returntype",void 0)],e.prototype,"deleteEnts",null),$y([(0,fy.o)(),ev("design:type",Function),ev("design:paramtypes",[]),ev("design:returntype",void 0)],e.prototype,"deleteLastPoint",null),$y([(0,fy.o)(),ev("design:type",Function),ev("design:paramtypes",[Object]),ev("design:returntype",void 0)],e.prototype,"deleteCtlPoint",null),$y([(0,fy.o)(),ev("design:type",Boolean)],e.prototype,"middleClosed",void 0),$y([(0,fy.o)(),ev("design:type",Array)],e.prototype,"rotateByHeadingProperty",void 0),$y([(0,fy.o)(),ev("design:type",Array)],e.prototype,"rotateByPitchProperty",void 0),$y([(0,fy.o)(),ev("design:type",Array)],e.prototype,"rotateByRollProperty",void 0),$y([(0,fy.o)(),ev("design:type",Array)],e.prototype,"scaleZProperty",void 0),$y([(0,fy.o)(),ev("design:type",Array)],e.prototype,"scaleXProperty",void 0),$y([(0,fy.o)(),ev("design:type",Array)],e.prototype,"scaleYProperty",void 0),$y([(0,fy.o)(),ev("design:type",Array)],e.prototype,"scaleProperty",void 0),$y([(0,fy.o)(),ev("design:type",Array)],e.prototype,"movePositionProperty",void 0),$y([(0,fy.o)(),ev("design:type",Function),ev("design:paramtypes",[Cesium.Cartesian2,Cesium.Cartesian2]),ev("design:returntype",void 0)],e.prototype,"movePosition",null),$y([(0,fy.o)(),ev("design:type",Array)],e.prototype,"moveHeightProperty",void 0),$y([(0,fy.o)(),ev("design:type",Function),ev("design:paramtypes",[Cesium.Cartesian2,Cesium.Cartesian2]),ev("design:returntype",void 0)],e.prototype,"moveHeight",null),$y([(0,fy.o)(),ev("design:type",Function),ev("design:paramtypes",[]),ev("design:returntype",void 0)],e.prototype,"calculateCursor",null),$y([(0,fy.o)(),ev("design:type",Function),ev("design:paramtypes",[Cesium.Cartesian2,Cesium.Cartesian2]),ev("design:returntype",void 0)],e.prototype,"ChangeMoveByMouse",null),$y([(0,fy.o)(),ev("design:type",Function),ev("design:paramtypes",[]),ev("design:returntype",void 0)],e.prototype,"ScreenPixel",null),$y([(0,fy.o)(),ev("design:type",Function),ev("design:paramtypes",[Object,Object,Object]),ev("design:returntype",void 0)],e.prototype,"ChangeLengthByMouse",null),$y([(0,fy.o)(),ev("design:type",Function),ev("design:paramtypes",[Number,Cesium.Cartesian2,Cesium.Cartesian2]),ev("design:returntype",void 0)],e.prototype,"changeScaleByMouse",null),$y([(0,fy.o)(),ev("design:type",Function),ev("design:paramtypes",[]),ev("design:returntype",Cesium.Cartesian3)],e.prototype,"getCenter",null),$y([(0,fy.o)(),ev("design:type",Function),ev("design:paramtypes",[]),ev("design:returntype",Cesium.Rectangle)],e.prototype,"getBoundingRectangle",null),$y([(0,fy.o)(),ev("design:type",Object)],e.prototype,"__meta__",void 0),$y([(0,fy.o)(),ev("design:type",Function),ev("design:paramtypes",[]),ev("design:returntype",void 0)],e.prototype,"toJson",null),$y([(0,fy.o)(),ev("design:type",Object)],e.prototype,"isAddControlPointEntity",void 0),$y([(0,fy.o)(),ev("design:type",Object),ev("design:paramtypes",[])],e.prototype,"earth",null),$y([(0,fy.o)(),ev("design:type",Object)],e,"seq",void 0),e}();const rv=iv;var nv=i(5108),ov=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),sv=function(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var r,n,o=i.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){n={error:e}}finally{try{r&&!r.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}return s},av=function(e,t,i){if(i||2===arguments.length)for(var r,n=0,o=t.length;n<o;n++)!r&&n in t||(r||(r=Array.prototype.slice.call(t,0,n)),r[n]=t[n]);return e.concat(r||Array.prototype.slice.call(t))},lv=function(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],r=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},hv=function(e){function t(t){var i=e.call(this)||this;i._items=[],i._engine=t,i._viewer=t.viewer,i._dataRoot=new Gg,i._dataRoot.name="root",i._dataRoot.init((function(){return i})),i._ignoreRoot=new Gg,i._ignoreRoot.init((function(){return i}));var r=new Cesium.CustomDataSource("myEntities"),n=r.entities;i._viewer.dataSources.add(r);var o=new Cesium.PrimitiveCollection;i._viewer.scene.primitives.add(o);var s=new Cesium.BillboardCollection;i._viewer.scene.primitives.add(s);var a=new Cesium.LabelCollection;i._viewer.scene.primitives.add(a);var l=i._viewer.postProcessStages;return i._renderRoot={entityRoot:n,primitiveRoot:o,billboardCollection:s,postProcessStages:l,labelCollection:a},i}return ov(t,e),t.prototype.getRenderRoot=function(){return this._renderRoot},t.prototype.getRoot=function(){return this._dataRoot},t.prototype.getIgnoreRoot=function(){return this._ignoreRoot},t.prototype.add=function(e){if(e instanceof Gg||e instanceof c.Z)return this._dataRoot.add(e);this.add0(e)},t.prototype.add0=function(e){var t,i=this;if(this._engine.sceneTree.root.children||(this._engine.sceneTree.root={children:[]}),Array.isArray(e))t=[],e.forEach((function(e){var r=i._engine.sceneTree.root.children.push(e);t.push(i._engine.sceneTree.root.children[r-1])}));else{var r=this._engine.sceneTree.root.children.push(e);t=this._engine.sceneTree.root.children[r-1]}return t},t.prototype.addByJson=function(e){return this._dataRoot.addByJson(e)},t.prototype.toJson=function(){return this._dataRoot.toJson()},t.prototype.fromJson=function(e){return this._dataRoot.parseJson(e)},Object.defineProperty(t.prototype,"items",{get:function(){return this._items=av([],sv(this._dataRoot.children),!1),this._items.push.apply(this._items,this._engine.serviceManager.plotService.gm.graphicList),this._items},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Leafs",{get:function(){return this._engine.sceneTree.getLeafs()},enumerable:!1,configurable:!0}),t.prototype.getLeaf=function(e){var t=this._engine.sceneTree.getLeafs().find((function(t){return t.gvolObject.gvolGuid&&t.gvolObject.gvolGuid===e}));return t||nv.warn("未找到关联的leaf节点"),t},t.prototype.removeAll=function(){var e=this,t=this.items;t&&t.forEach((function(t){var i=e._engine.sceneTree.getLeafs().find((function(e){return e.gvolObject.gvolGuid&&e.gvolObject.gvolGuid===t.gvolGuid}));i&&e.remove(i)}))},t.prototype.remove=function(e){if(e instanceof ia)e&&e.gvolObject?(e.gvolObject instanceof rv?this._engine.serviceManager.plotService.gm.delete(e.gvolObject):e.gvolObject instanceof c.Z&&this._dataRoot.remove(e.gvolObject),this._engine.sceneTree.removeSceneObject(e),this.fire("remove",e.gvolObject)):nv.warn("未找到对象的实例。");else{var t=this._engine.sceneTree.getLeafs().find((function(t){return t.gvolObject.gvolGuid&&t.gvolObject.gvolGuid===e.graph.gvolGuid}));t?this.remove(t):nv.warn("未找到关联的leaf节点")}},t.prototype.getPlotJson=function(e){var t,i=this;if(Array.isArray(e)){var r=[];return e.forEach((function(e){t=e instanceof ia?i._engine.serviceManager.plotService.gm.classToPlain(e.gvolObject):i._engine.serviceManager.plotService.gm.classToPlain(e),r.push(t)})),r}return t=e instanceof ia?this._engine.serviceManager.plotService.gm.classToPlain(e.gvolObject):this._engine.serviceManager.plotService.gm.classToPlain(e)},t.prototype.addGeojson=function(e,t,i){return void 0===i&&(i=!1),this._engine.serviceManager.actionService.createDrawGeojson(e,t,i)},t.prototype.getById=function(e){return this._dataRoot.getById(e)},t.prototype.getIgnoreById=function(e){return this._ignoreRoot.getById(e)},t.prototype.getNodeByName=function(e){return this._dataRoot.getByName(e)},t.prototype._pickObjGetId=function(e){if(e.id&&e.id.dataId)return e.id.dataId;if(e.primitive){if(e.primitive.dataId)return e.primitive.dataId;if(Cesium.defined(e.primitive)&&Cesium.defined(e.primitive._external)&&Cesium.defined(e.primitive._external._composites)){var t=e.primitive._external._composites;if(t)for(var i in t)return t[i].collection.dataId}}},t.prototype.pickRect=function(e,t,i,r){var n,o,s=this,a=(e+e+i)/2,l=(t+t+r)/2,h=this._viewer.scene.drillPick(new Cesium.Cartesian2(a,l),null,i,r),c=new Set;try{for(var u=lv(h),p=u.next();!p.done;p=u.next()){var d=p.value,m=this._pickObjGetId(d);c.add(m)}}catch(e){n={error:e}}finally{try{p&&!p.done&&(o=u.return)&&o.call(u)}finally{if(n)throw n.error}}var f=Array.from(c),g=[];return f.forEach((function(e){g.push(s.getById(e))})),g},t.prototype.pickByCoordinate2=function(e,t){return this._pickByCoordinate2(e,t)},t.prototype.pickByCoordinate=function(e,t){return this._pickByCoordinate(e,t)},t.prototype.pickIgnoreByCoordinate=function(e,t){return this._pickByCoordinate(e,t,"Ignore")},t.prototype._pickByCoordinate2=function(e,t,i){var r,n,o=this;if(void 0!==e&&void 0!==t){var s=[],a=new Cesium.Cartesian2(e,t),l=this._viewer.scene.drillPick(a);if(void 0===l||0===l.length)return s;var h=new Set;try{for(var c=lv(l),u=c.next();!u.done;u=c.next()){var p=u.value,d=this._pickObjGetId(p);h.add(d)}}catch(e){r={error:e}}finally{try{u&&!u.done&&(n=c.return)&&n.call(c)}finally{if(r)throw r.error}}return Array.from(h).forEach((function(e){"Ignore"===i?s.push(o.getIgnoreById(e)):s.push(o.getById(e))})),s}nv.warn("pickByCoordinate2无效的坐标参数x,y")},t.prototype._pickByCoordinate=function(e,t,i){if(void 0!==e&&void 0!==t){null;var r=new Cesium.Cartesian2(e,t),n=this._viewer.scene.pick(r);if(void 0!==n){var o=this._pickObjGetId(n);return"Ignore"===i?this.getIgnoreById(o):this.getById(o)}}else nv.warn("pickByCoordinate无效的坐标参数x,y")},t.prototype.getItemsInPolygon=function(e){var t=[];return this._dataRoot.children.map((function(i){i.position&&Bt.pointInPolygon(i.position,e)&&t.push(i)})),t},Object.defineProperty(t.prototype,"editor",{get:function(){return this._engine.serviceManager.plotService.gm?this._engine.serviceManager.plotService.gm.editor:void 0},enumerable:!1,configurable:!0}),t}(p),cv=i(5108),uv=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),pv=function(e){function t(t){var i=e.call(this)||this;return i._serviceManager=t.serviceManager,i}return uv(t,e),t.prototype.add=function(e){var t,i=this;if(e)if(Array.isArray(e))t=[],e.forEach((function(e){if(e.gvolType){var r=i._serviceManager.actionService.createDraw(e);if(r){var n=new ia(r);i._serviceManager.engine.sceneTree.addSceneObject(n),i.fire("add",n),t.push(n)}}else cv.warn("plot.gvolType 标绘类型不存在。")}));else{if(!e.gvolType)return cv.warn("plot.gvolType 标绘类型不存在。"),t;var r=this._serviceManager.actionService.createDraw(e);if(r){var n=new ia(r);this._serviceManager.engine.sceneTree.addSceneObject(n),this.fire("add",n),t=n}}return t},t.prototype.getPlotJson=function(e){var t,i=this;if(Array.isArray(e)){var r=[];return e.forEach((function(e){e instanceof ia?t=i._serviceManager.plotService.gm.classToPlain(e.gvolObject):e instanceof rv&&(t=i._serviceManager.plotService.gm.classToPlain(e)),r.push(t)})),r}return e instanceof ia?t=this._serviceManager.plotService.gm.classToPlain(e.gvolObject):e instanceof rv&&(t=this._serviceManager.plotService.gm.classToPlain(e)),t},t.prototype.addGeojson=function(e,t,i){return void 0===i&&(i=!1),this._serviceManager.actionService.createDrawGeojson(e,t,i)},Object.defineProperty(t.prototype,"items",{get:function(){return this._serviceManager.plotService.gm.graphList},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Leafs",{get:function(){return this._serviceManager.engine.sceneTree.getLeafs()},enumerable:!1,configurable:!0}),t.prototype.getLeaf=function(e){var t=this._serviceManager.engine.sceneTree.getLeafs().find((function(t){return t.gvolObject.gvolGuid&&t.gvolObject.gvolGuid===e}));return t||cv.warn("未找到关联的leaf节点"),t},t.prototype.remove=function(e){if(e instanceof ia)e&&e.gvolObject?(this._serviceManager.plotService.gm.delete(e.gvolObject),this._serviceManager.engine.sceneTree.removeSceneObject(e),this.fire("remove",e.gvolObject)):cv.warn("未找到对象的实例。");else{var t=this._serviceManager.engine.sceneTree.getLeafs().find((function(t){return t.gvolObject.gvolGuid&&t.gvolObject.gvolGuid===e.graph.gvolGuid}));t?this.remove(t):cv.warn("未找到关联的leaf节点")}},t.prototype.removeAll=function(){var e=this,t=this._serviceManager.plotService.gm.graphicList;t&&t.forEach((function(t){var i=e._serviceManager.engine.sceneTree.getLeafs().find((function(e){return e.gvolObject.gvolGuid&&e.gvolObject.gvolGuid===t.gvolGuid}));i&&e.remove(i)})),this._serviceManager.plotService.gm.deleteAll()},t}(p),dv=function(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],r=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},mv=function(){function e(e,t){this._entities=null,this._trackLineColor=Cesium.Color.RED,this._trackLineWidth=1.5,this._trackPointColor=Cesium.Color.LIME,this._trackPointSize=6,this._smoothTrack=!1,this._pathList=new Map,this._computeAngle=!0,this._viewer=e,this._entities=t,e.clock.canAnimate=!0,e.clock.shouldAnimate=!0}return e.prototype.addHistoryTrack=function(e,t){var i,r,n=this,o=this,s=this._timePosition2sample(t),a=e.style,l=[],h=this._viewer.scene,c=Cesium.JulianDate.fromDate(new Date(t[0][3])),u=Cesium.JulianDate.fromDate(new Date(t[t.length-1][3])),p=new Cesium.TimeInterval;p.start=c,p.stop=u;var d=new Cesium.TimeIntervalCollection([p]),m=new Cesium.VelocityOrientationProperty(s[1]);var f=this._entities.add({position:s[1],availability:d,orientation:this._computeAngle?m:void 0,path:{resolution:1,width:new Cesium.CallbackProperty((function(){return n._trackLineWidth}),!1),material:new Cesium.ColorMaterialProperty(new Cesium.CallbackProperty((function(){return n._trackLineColor}),!1))},billboard:{id:e.id,pixelOffset:new Cesium.Cartesian2(0,0),eyeOffset:new Cesium.Cartesian3(0,0,0),horizontalOrigin:Cesium.HorizontalOrigin.CENTER,verticalOrigin:Cesium.VerticalOrigin.CENTER,alignedAxis:Cesium.Cartesian3.UNIT_Z,rotation:new Cesium.CallbackProperty((function(e){if(o._computeAngle){var t=new Cesium.JulianDate,i=s[1].getValue(e),r=s[1].getValue(Cesium.JulianDate.addSeconds(e,1,t)),n=Cesium.SceneTransforms.wgs84ToWindowCoordinates(h,i),a=Cesium.SceneTransforms.wgs84ToWindowCoordinates(h,r);return Cesium.defined(n)&&Cesium.defined(a)?-1*function(e,t){var i,r,n;i=r=n=0,i=t.x-e.x,r=t.y-e.y,0!=i?n=180*Math.atan(Math.abs(r/i))/Cesium.Math.PI:r>0?n=90:r<0&&(n=270);0==r&&i<0?n=180:r>0&&i<0?n=180-n:r<0&&i<0?n=180+n:r<0&&i>0&&(n=360-n);return n=n*Cesium.Math.PI/180}(n,a)-Cesium.Math.PI_OVER_TWO:Cesium.Math.PI_OVER_TWO}return 0}),!1),color:Cesium.Color.fromCssColorString(a.color),image:a.iconUrl,width:a.iconSize,height:a.iconSize,distanceDisplayCondition:a.iconDisplayCondition},point:{id:e.id,pixelSize:a.pointSize,color:Cesium.Color.fromCssColorString(a.color),distanceDisplayCondition:a.pointDisplayCondition,outlineColor:Cesium.Color.fromCssColorString(a.pointLineColor),outlineWidth:a.pointLineWidth},label:{text:e.name,horizontalOrigin:Cesium.HorizontalOrigin.LEFT,show:!0,id:e.id,font:"".concat(e._style.fontSize,"px ").concat(e._style.font),fillColor:Cesium.Color.fromCssColorString(e.textColor),outlineColor:e.outlineColor,outlineWidth:e.outlineWidth,showBackground:e.showFontbgColor,backgroundColor:Cesium.Color.fromCssColorString(e.fontbgColor),backgroundPadding:new Cesium.Cartesian2(10,6),pixelOffset:new Cesium.Cartesian2(e._style.labeloffsetx,e._style.labeloffsety),distanceDisplayCondition:e._style.labelDisplayCondition,disableDepthTestDistance:Number.POSITIVE_INFINITY},model:{uri:a.modelUrl,distanceDisplayCondition:a.modelDisplayCondition,minimumPixelSize:128,color:Cesium.Color.fromCssColorString(a.color),scale:1}});l.push(f);try{for(var g=dv(s[0]),A=g.next();!A.done;A=g.next()){var y=A.value,v=this._entities.add({position:y,point:{color:new Cesium.CallbackProperty((function(){return n._trackPointColor}),!1),pixelSize:new Cesium.CallbackProperty((function(){return n._trackPointSize}),!1)}});v.isPoint=!0,l.push(v)}}catch(e){i={error:e}}finally{try{A&&!A.done&&(r=g.return)&&r.call(g)}finally{if(i)throw i.error}}this._pathList.set(e.id,l)},e.prototype._timePosition2sample=function(e){var t=[],i=[];e.map((function(e){t.push(e[0],e[1],e[2]),i.push(Cesium.JulianDate.fromDate(new Date(e[3])))})),t=Cesium.Cartesian3.fromDegreesArrayHeights(t);var r=new Cesium.SampledPositionProperty;return r.forwardExtrapolationType=Cesium.ExtrapolationType.HOLD,r.backwardExtrapolationType=Cesium.ExtrapolationType.HOLD,this._smoothTrack&&r.setInterpolationOptions({interpolationDegree:2,interpolationAlgorithm:Cesium.HermitePolynomialApproximation}),r.addSamples(i,t),[t,r]},Object.defineProperty(e.prototype,"smoothTrack",{get:function(){return this._smoothTrack},set:function(e){var t,i,r=this;this._smoothTrack=e;var n=this._pathList.keys();try{for(var o=dv(n),s=o.next();!s.done;s=o.next()){var a=s.value;this._pathList.get(a).map((function(e){e.isPoint||(r._smoothTrack?e.position.setInterpolationOptions({interpolationDegree:2,interpolationAlgorithm:Cesium.HermitePolynomialApproximation}):e.position.setInterpolationOptions({interpolationDegree:1,interpolationAlgorithm:Cesium.LinearApproximation}))}))}}catch(e){t={error:e}}finally{try{s&&!s.done&&(i=o.return)&&i.call(o)}finally{if(t)throw t.error}}},enumerable:!1,configurable:!0}),e.prototype.removeByID=function(e){var t,i,r=this._pathList.get(e);if(r)try{for(var n=dv(r),o=n.next();!o.done;o=n.next()){var s=o.value;this._entities.remove(s)}}catch(e){t={error:e}}finally{try{o&&!o.done&&(i=n.return)&&i.call(n)}finally{if(t)throw t.error}}},e.prototype.setTimeSection=function(e,t){var i=Cesium.JulianDate.fromDate(new Date(e)),r=Cesium.JulianDate.fromDate(new Date(t));return this._viewer.clock.startTime=i.clone(),this._viewer.clock.stopTime=r.clone(),this._viewer.clock.currentTime=i.clone(),!0},Object.defineProperty(e.prototype,"speed",{get:function(){return this._viewer.clock.multiplier},set:function(e){this._viewer.clock.multiplier=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"computeAngle",{get:function(){return this._computeAngle},set:function(e){this._computeAngle=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"animate",{get:function(){return this._viewer.clock.shouldAnimate},set:function(e){this._viewer.clock.shouldAnimate=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lineColor",{get:function(){return this._trackLineColor},set:function(e){this._trackLineColor=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lineWidth",{get:function(){return this._trackLineWidth},set:function(e){this._trackLineWidth=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pointColor",{get:function(){return this._trackPointColor},set:function(e){this._trackPointColor=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pointSize",{get:function(){return this._trackPointSize},set:function(e){this._trackPointSize=e},enumerable:!1,configurable:!0}),e}(),fv=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),gv=function(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],r=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Av=function(e){function t(t){var i=e.call(this)||this;i.renderOption={frameCount:1e3,currentIndex:0,pendding:!1},i._show=!0,i._smoothTrack=!0,i._gid=Cesium.createGuid(),i._ennableDrag=!1,i.showModel=!1,i.layerConfig=new Map,i._linkLineWidth=2,i._linkLineColor="white",i._highlightSelection=!0,i._selectionColor="yellow",i._brefresh=!1,i._canvasCache=new Map,i._graphGroup=null,i.historyTrack=null,i.engine=t,i.viewer=t.viewer,i.viewer.clock.shouldAnimate=!0,i.rootcollection=new Cesium.PrimitiveCollection({show:!0}),i.rootPointcollection=new Cesium.PrimitiveCollection({show:!0}),i.pointcollection=new Cesium.PointPrimitiveCollection,i.labelcollection=new Cesium.LabelCollection,i.billbordcollection=new Cesium.BillboardCollection;var r=new Cesium.CustomDataSource("targetModel");return i.viewer.dataSources.add(r),i.modelcollection=r.entities,i.trackLinecollection=new Cesium.PolylineCollection,i.trackPointcollection=new Cesium.PointPrimitiveCollection,i.linkLines=new Cesium.BillboardCollection,i.targetCollection=new Map,i.rootcollection.add(i.trackLinecollection),i.rootcollection.add(i.trackPointcollection),i.rootcollection.add(i.labelcollection),i.rootcollection.add(i.billbordcollection),i.rootcollection.add(i.linkLines),i.rootcollection.show=i._show,i.viewer.scene.primitives.add(i.rootcollection),i.rootPointcollection.add(i.pointcollection),i.rootPointcollection.show=i._show,i.viewer.scene.primitives.add(i.rootPointcollection),i.defaultStyle=zg.DefaultStyle(),i.layerConfig.set("default",i.defaultStyle),i.targetdataSource=new Cesium.CustomDataSource,i.viewer.dataSources.add(i.targetdataSource),i.displayCondition={pointDisplayCondition:new Cesium.DistanceDisplayCondition(4e5),iconDisplayCondition:new Cesium.DistanceDisplayCondition(600,9e5),labelDisplayCondition:new Cesium.DistanceDisplayCondition(0,600),modelDisplayCondition:new Cesium.DistanceDisplayCondition(0,1e3)},setInterval((function(){i._renderTarget()}),100),i.initMouseEvt(),i}return fv(t,e),t.prototype._renderTarget=function(){var e,t,i,r;if(!this.renderOption.pendding&&0!=this.targetCollection.size){var n=[],o=[],s=Cesium.Cartographic.fromCartesian(this.viewer.camera.position).height,a=this.displayCondition.labelDisplayCondition,l=this.displayCondition.iconDisplayCondition,h=this.displayCondition.modelDisplayCondition;if(s<l.far?this.rootPointcollection.show=!1:this.rootPointcollection.show=!0,s<h.far||s<a.far){if(this._smoothTrack){var c=s<0?this._getUnderGoundExtent():this._getCurrentExtent();try{for(var u=gv(this.targetCollection),p=u.next();!p.done;p=u.next()){var d=(_=p.value)[1],m=(Cesium.JulianDate.now(),d._timePosition.getPosition((new Date).getTime()));m&&(this._pointInView(m,c)?(a.near<=s&&s<=a.far&&!d._labelInit&&(d._label=this.labelcollection.add(this._getLable(d)),d._label.position=m,d._linkLine=this.linkLines.add(this._getLinkLine(d)),d._linkLine.position=m,d._labelInit=!0,d.outlineColor=d.outlineColor,d.textColor=d.textColor,d._label.showBackground=d.showFontbgColor,d._label.backgroundColor=Cesium.Color.fromCssColorString(d.fontbgColor),this._ennableDrag&&this.updateLineCanvas(d)),h.near<=s&&s<=h.far&&!d._modelInit&&(d._model=this.modelcollection.add(d._model),d._model.position=m,d._modelInit=!0,d.modelColor=d.modelColor),d._linkLine&&this._brefresh&&this.updateLineCanvas(d),d._inview=!0,o.push(d)):(d._point.position=m,d._billbord.position=m,d._linkLine&&(d._linkLine.position=m),d._label&&(d._label.position=m),d._model&&(d._model.position=m)))}}catch(t){e={error:t}}finally{try{p&&!p.done&&(t=u.return)&&t.call(u)}finally{if(e)throw e.error}}}}else try{for(var f=gv(this.targetCollection),g=f.next();!g.done;g=f.next()){var A=(_=g.value)[1];n.push(A)}}catch(e){i={error:e}}finally{try{g&&!g.done&&(r=f.return)&&r.call(f)}finally{if(i)throw i.error}}this._brefresh=!1;for(var y=o.length>0?o:n,v=y.length,C=0;C<v;C++){var _;(_=y[C])._init&&!_.smoothTrack||(_.flag==kg.Add||_.flag==kg.Update?this._addORUpdateTarget(_):_.flag==kg.Remove&&this.remove(_.id))}}},t.prototype._getUnderGoundExtent=function(){var e,t,i,r,n={};e=t=999,i=r=-999;var o=this.viewer.scene.globe._surface.tileProvider._tilesToRenderByTextureCount;if(Cesium.defined(o)){for(var s=o.length,a=0;a<s;++a){var l=o[a];if(Cesium.defined(l))for(var h=l.length,c=0;c<h;++c){var u=l[c].rectangle;e=Math.min(e,u.west),t=Math.min(t,u.south),i=Math.max(i,u.east),r=Math.max(r,u.north)}}return n.xmin=Cesium.Math.toDegrees(e),n.xmax=Cesium.Math.toDegrees(i),n.ymin=Cesium.Math.toDegrees(t),n.ymax=Cesium.Math.toDegrees(r),n}},t.prototype._getCurrentExtent=function(){var e={},t=[],i=this.viewer.camera.computeViewRectangle();return i||(i={west:-3.141592653589793,south:-1.5707963267948966,east:3.141592653589793,north:1.5707963267948966}),Cesium.Rectangle.pack(i,t),e.xmin=Cesium.Math.toDegrees(t[0]),e.xmax=Cesium.Math.toDegrees(t[2]),e.ymin=Cesium.Math.toDegrees(t[1]),e.ymax=Cesium.Math.toDegrees(t[3]),e},t.prototype._addORUpdateTarget=function(e){var t,i;if(e._init){if(e.smoothTrack){var r=e._timePosition.getPosition((new Date).getTime());if(e._point.position=r,e._billbord.position=r,e._linkLine&&(e._linkLine.position=r),e._labelInit&&(e._label.position=r),e._model&&(e._model.position=r),e.backwardPath.show&&e.backwardPath.render(r),e.forewardPath.show&&e.forewardPath.render(r),e.flame&&e.flame.show&&e.flame.updateFlame(),e.partnerList.size>0){var n=Cesium.Cartographic.fromCartesian(r),o=new A(Cesium.Math.toDegrees(n.longitude),Cesium.Math.toDegrees(n.latitude),n.height);try{for(var s=gv(e.partnerList),a=s.next();!a.done;a=s.next()){var l=a.value;l[1].position=o,l[1].update()}}catch(e){t={error:e}}finally{try{a&&!a.done&&(i=s.return)&&i.call(s)}finally{if(t)throw t.error}}}}}else this._addTarget(e)},t.prototype._addTarget=function(e){e._point=this.pointcollection.add(e._point),e._billbord=this.billbordcollection.add(e._billbord),this.setTargetStyle(e),e._parentLayer=this,e.flag=kg.Add,e._init=!0},t.prototype.addTrack=function(e){if(!e.trackInit){var t=void 0;t=e.mtype==Wg.backward?new Cesium.Material({fabric:{uniforms:{image:qh.formatUrlByBaseJs("resources/images/specialLine/Trail.png"),lineColor:e.trackLineColor},source:"\n                            czm_material czm_getMaterial(czm_materialInput materialInput) \n                                {\n                                    czm_material material = czm_getDefaultMaterial(materialInput); \n                                    vec2 st = materialInput.st; \n                                    material.alpha = texture2D(image, st).a;\n                                    material.diffuse = lineColor.rgb;\n                                    return material;\n                                }"}}):Cesium.Material.fromType("Color",{color:e.trackLineColor}),e.trackLine=this.trackLinecollection.add({width:e.trackLineWidth,material:t}),e.trackInit=!0}},t.prototype.setTargetStyle=function(e){var t=e,i=e.style;this.getStyleByCode(e);var r=e.getColor(),n=e._point;n&&(n.pixelSize=i.pointSize,n.color=Cesium.Color.fromCssColorString(r),n.distanceDisplayCondition=this.displayCondition.pointDisplayCondition,n.outlineColor=Cesium.Color.fromCssColorString(i.pointLineColor),n.outlineWidth=i.pointLineWidth,n.translucencyByDistance=new Cesium.NearFarScalar(this.displayCondition.labelDisplayCondition.far,.7,this.displayCondition.pointDisplayCondition.far,1));var o=t._label;o&&(o.font="normal "+i.fontSize+"px   "+i.font,o.distanceDisplayCondition=this.displayCondition.labelDisplayCondition,o.pixelOffset=new Cesium.Cartesian2(i.labeloffsetx,i.labeloffsety),o.showBackground=i.showBackground,o.backgroundColor=Cesium.Color.fromCssColorString(i.fontbgColor));var s=t._billbord;if(s&&(t.useIconColor&&(s.color=Cesium.Color.fromCssColorString(r)),s.image=i.iconUrl,s.width=i.iconSize,s.height=i.iconSize,s.distanceDisplayCondition=this.displayCondition.iconDisplayCondition),t._model){var a=t._model.model;a&&(a.uri=i.modelUrl,a.minimumPixelSize=i.modelMinimumPixelSize,a.distanceDisplayCondition=this.displayCondition.modelDisplayCondition,a.minimumPixelSize=i.modelMinimumPixelSize,a.maximumScale=i.modelMaximumScale)}},t.prototype.updateLinkStyle=function(){var e,t;try{for(var i=gv(this.targetCollection),r=i.next();!r.done;r=i.next()){var n=r.value[1];n._linkLine&&this.updateLineCanvas(n,!0)}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}},t.prototype.updateLineCanvas=function(e,t){void 0===t&&(t=!1);var i=document.createElement("canvas"),r=e.style.labeloffsetx,n=e.style.labeloffsety;i.width=Math.abs(r),i.height=Math.abs(n);var o=i.getContext("2d");o.beginPath(),o.lineWidth=this._linkLineWidth,o.strokeStyle=this._linkLineColor,o.moveTo(r<0?-r:0,n<0?-n:0),o.lineTo(r<0?0:r,n<0?0:n),o.stroke();e.id;e._linkLine.pixelOffset=new Cesium.Cartesian2(.5*r,.5*n),e._linkLine.image=i,this._canvasCache.set(e.id,i),e._linkLine.show=e._showLink&&e._show},t.prototype.initMouseEvt=function(){var e,t=this,i=new Cesium.ScreenSpaceEventHandler(this.viewer.scene.canvas),r=this.viewer.scene;i.setInputAction((function(i){if(t._ennableDrag){var n=i,o=r.pick(n.position);o&&o.primitive&&o.id&&(e=t.targetCollection.get(o.primitive.id))&&(r.screenSpaceCameraController.enableRotate=!1,r.screenSpaceCameraController.enableTranslate=!1)}}),Cesium.ScreenSpaceEventType.LEFT_DOWN),i.setInputAction((function(i){var r=i;if(t._ennableDrag&&e&&e._label){var n=r.endPosition.x-r.startPosition.x,o=r.endPosition.y-r.startPosition.y;e.style.labeloffsetx+=n,e.style.labeloffsety+=o,e._label.pixelOffset=new Cesium.Cartesian2(e.style.labeloffsetx,e.style.labeloffsety),e._linkLine&&(t.loadLinklines(),t.updateLineCanvas(e))}}),Cesium.ScreenSpaceEventType.MOUSE_MOVE),i.setInputAction((function(i){t._ennableDrag&&(e=void 0,r.screenSpaceCameraController.enableRotate=!0,r.screenSpaceCameraController.enableTranslate=!0)}),Cesium.ScreenSpaceEventType.LEFT_UP)},t.prototype.loadLinklines=function(){var e,t,i=new Cesium.BillboardCollection;try{for(var r=gv(this.targetCollection),n=r.next();!n.done;n=r.next()){var o=n.value;if(o[1]._linkLine){var s=i.add(this._getLinkLine(o[1]));s.pixelOffset=o[1]._linkLine.pixelOffset,s.position=o[1]._linkLine.position,s.image=this._canvasCache.get(o[1].id),o[1]._linkLine=s,o[1]._linkLine.show=o[1]._showLink&&o[1]._show}}}catch(t){e={error:t}}finally{try{n&&!n.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}this.rootcollection.remove(this.linkLines),this.rootcollection.add(i),this.linkLines=i},t.prototype._getPoint=function(e){this.getStyleByCode(e);var t=e.style,i=t.color;return{id:e.id,show:e.show,pixelSize:t.pointSize,color:Cesium.Color.fromCssColorString(i),distanceDisplayCondition:this.displayCondition.pointDisplayCondition,outlineColor:Cesium.Color.fromCssColorString(t.pointLineColor),outlineWidth:t.pointLineWidth,disableDepthTestDistance:e.depthTest?Number.POSITIVE_INFINITY:0}},t.prototype._getLable=function(e){return this.getStyleByCode(e),{text:e.name,show:e.show,horizontalOrigin:Cesium.HorizontalOrigin.LEFT,id:e.id,font:"".concat(e._style.fontSize,"px ").concat(e._style.font),fillColor:Cesium.Color.fromCssColorString(e._style.fontColor),outlineWidth:1,showBackground:e._style.showBackground,backgroundColor:Cesium.Color.fromCssColorString(e._style.fontbgColor),backgroundPadding:new Cesium.Cartesian2(10,6),distanceDisplayCondition:this.displayCondition.labelDisplayCondition,pixelOffset:new Cesium.Cartesian2(e._style.labeloffsetx,e._style.labeloffsety),style:Cesium.LabelStyle.FILL_AND_OUTLINE,disableDepthTestDistance:e.depthTest?Number.POSITIVE_INFINITY:0}},t.prototype._getBillboard=function(e){this.getStyleByCode(e);var t=e.style,i=t.color;return e._bUseIconColor?{id:e.id,show:e.show,pixelOffset:new Cesium.Cartesian2(0,0),eyeOffset:new Cesium.Cartesian3(0,0,0),horizontalOrigin:Cesium.HorizontalOrigin.CENTER,verticalOrigin:Cesium.VerticalOrigin.CENTER,alignedAxis:Cesium.Cartesian3.UNIT_Z,rotation:-1*Cesium.Math.toRadians(e.angle),color:Cesium.Color.fromCssColorString(i),image:t.iconUrl,width:t.iconSize,height:t.iconSize,distanceDisplayCondition:this.displayCondition.iconDisplayCondition}:{id:e.id,show:e.show,pixelOffset:new Cesium.Cartesian2(0,0),eyeOffset:new Cesium.Cartesian3(0,0,0),horizontalOrigin:Cesium.HorizontalOrigin.CENTER,verticalOrigin:Cesium.VerticalOrigin.CENTER,alignedAxis:Cesium.Cartesian3.UNIT_Z,rotation:-1*Cesium.Math.toRadians(e.angle),image:t.iconUrl,width:t.iconSize,height:t.iconSize,distanceDisplayCondition:this.displayCondition.iconDisplayCondition,disableDepthTestDistance:e.depthTest?Number.POSITIVE_INFINITY:0}},t.prototype._getModel=function(e){var t,i=e.style,r=e.modelColor?e.modelColor:i.color;if(e.modelHPR)t=Cesium.Transforms.headingPitchRollQuaternion(e._position,e.modelHPR);else{var n=Cesium.Math.toRadians(e.angle-90),o=new Cesium.HeadingPitchRoll(n,0,0);t=Cesium.Transforms.headingPitchRollQuaternion(e._position,o)}return{id:e.id,orientation:t,show:e.show,model:{color:Cesium.Color.fromCssColorString(r)}}},t.prototype._getLinkLine=function(e){return{id:e.id,show:e.show,pixelOffset:new Cesium.Cartesian2(0,0),eyeOffset:new Cesium.Cartesian3(0,0,0),horizontalOrigin:Cesium.HorizontalOrigin.CENTER,verticalOrigin:Cesium.VerticalOrigin.CENTER,alignedAxis:Cesium.Cartesian3.ZERO,distanceDisplayCondition:this.displayCondition.labelDisplayCondition}},t.prototype._pointInView=function(e,t){var i=Cesium.Cartographic.fromCartesian(e),r=[i.longitude/Math.PI*180,i.latitude/Math.PI*180];return t.xmin<=r[0]&&r[0]<=t.xmax&&t.ymin<=r[1]&&r[1]<=t.ymax},t.prototype.getStyleByCode=function(e){var t=e.style;if(e.styleCode){var i=this.layerConfig.get(e.styleCode);if(i)for(var r in i)t[r]=i[r]}},t.prototype.saveStyleConfig=function(){var e,t,i={};i.showModel=this.showModel,i.styles=[],i.distanceDisplayCondition={};try{for(var r=gv(this.layerConfig),n=r.next();!n.done;n=r.next()){var o=n.value;i.styles.push({code:o[0],style:zg.toJson(o[1])})}}catch(t){e={error:t}}finally{try{n&&!n.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}return i.distanceDisplayCondition={point:[this.displayCondition.pointDisplayCondition.near,this.displayCondition.pointDisplayCondition.far],icon:[this.displayCondition.iconDisplayCondition.near,this.displayCondition.iconDisplayCondition.far],label:[this.displayCondition.labelDisplayCondition.near,this.displayCondition.labelDisplayCondition.far],model:[this.displayCondition.modelDisplayCondition.near,this.displayCondition.modelDisplayCondition.far]},i},t.prototype.loadStyleConfig=function(e){var t,i;this.showModel=e.showModel;try{for(var r=gv(e.styles),n=r.next();!n.done;n=r.next()){var o=n.value;this.layerConfig.set(o.code,o.style)}}catch(e){t={error:e}}finally{try{n&&!n.done&&(i=r.return)&&i.call(r)}finally{if(t)throw t.error}}var s=e.distanceDisplayCondition;s&&(this.displayCondition={pointDisplayCondition:new Cesium.DistanceDisplayCondition(s.point[0],s.point[1]),iconDisplayCondition:new Cesium.DistanceDisplayCondition(s.icon[0],s.icon[1]),labelDisplayCondition:new Cesium.DistanceDisplayCondition(s.label[0],s.label[1]),modelDisplayCondition:new Cesium.DistanceDisplayCondition(s.model[0],s.model[1])})},Object.defineProperty(t.prototype,"graphGroup",{get:function(){return this._graphGroup||(this._graphGroup=new Gg,this.engine.graphicLayer.add(this._graphGroup)),this._graphGroup},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"highlightSelection",{get:function(){return this._highlightSelection},set:function(e){this._highlightSelection=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"selectionColor",{get:function(){return this._selectionColor},set:function(e){this._selectionColor=e},enumerable:!1,configurable:!0}),t.prototype.getSelection=function(){var e,t,i=[];try{for(var r=gv(this.targetCollection),n=r.next();!n.done;n=r.next()){var o=n.value;o[1].isSelected&&i.push(o[1])}}catch(t){e={error:t}}finally{try{n&&!n.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}return i},t.prototype.clearSelection=function(){var e,t;try{for(var i=gv(this.targetCollection),r=i.next();!r.done;r=i.next()){r.value[1].isSelected=!1}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}},t.prototype.reverseSelection=function(){var e,t;try{for(var i=gv(this.targetCollection),r=i.next();!r.done;r=i.next()){var n=r.value;n[1].isSelected=!n[1].isSelected}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}},t.prototype.selectAll=function(){var e,t;try{for(var i=gv(this.targetCollection),r=i.next();!r.done;r=i.next()){r.value[1].isSelected=!0}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}},Object.defineProperty(t.prototype,"smoothTrack",{get:function(){return this._smoothTrack},set:function(e){this._smoothTrack=e},enumerable:!1,configurable:!0}),t.prototype.getItemList=function(){var e,t,i=[];try{for(var r=gv(this.targetCollection),n=r.next();!n.done;n=r.next()){var o=n.value;i.push(o[1])}}catch(t){e={error:t}}finally{try{n&&!n.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}return i},Object.defineProperty(t.prototype,"id",{get:function(){return this._gid},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return"目标图层"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ennableDrag",{get:function(){return this._ennableDrag},set:function(e){this._ennableDrag=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"linkLineWidth",{get:function(){return this._linkLineWidth},set:function(e){this._linkLineWidth=Number(e),this.updateLinkStyle()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"linkLineColor",{get:function(){return this._linkLineColor},set:function(e){this._linkLineColor=e,this.updateLinkStyle()},enumerable:!1,configurable:!0}),t.prototype.isExist=function(e){return!!this.getItemById(e)},Object.defineProperty(t.prototype,"show",{get:function(){return this.rootcollection.show},set:function(e){this.rootcollection.show=e,this.rootPointcollection.show=e,this.modelcollection.show=e,this._graphGroup&&(this._graphGroup.visible=e)},enumerable:!1,configurable:!0}),t.prototype.add=function(e){e.color=e.color,e.style.color=e.color,e._point=this._getPoint(e),e._billbord=this._getBillboard(e);var t=e._position;e._point.position=t,e._billbord.position=t,this.showModel&&(e._model=this._getModel(e),e.smoothTrack,e._model.position=t),e.flag=kg.Add;var i=new qg;return i.position=e._position,i.time=(new Date).getTime(),e._timePosition.addSample(i),this.targetCollection.set(e.id,e),e._parentLayer=this,e},t.prototype.getItemById=function(e){return this.targetCollection.get(e)},t.prototype.remove=function(e){var t,i,r;r=Pt.isString(e)?e:e.id;var n=this.getItemById(r);if(n){if(this.targetCollection.delete(n.id),this.labelcollection.remove(n._label),this.pointcollection.remove(n._point),this.billbordcollection.remove(n._billbord),this.modelcollection.remove(n._model),this.billbordcollection.remove(n._lineBillboard),this.trackLinecollection.remove(n._forewardPath),this.trackLinecollection.remove(n._backwardPath),Cesium.defined(n._trackPoint))try{for(var o=gv(n._trackPoint),s=o.next();!s.done;s=o.next()){var a=s.value;this.trackPointcollection.remove(a)}}catch(e){t={error:e}}finally{try{s&&!s.done&&(i=o.return)&&i.call(o)}finally{if(t)throw t.error}}n.clearPartner(),n.flame.dispose()}return n},t.prototype.removeAll=function(){return this.targetCollection.clear(),this.labelcollection.removeAll(),this.pointcollection.removeAll(),this.billbordcollection.removeAll(),this.modelcollection.removeAll(),this.billbordcollection.removeAll(),this.trackLinecollection.removeAll(),this.trackPointcollection.removeAll(),this.linkLines.removeAll(),this.graphGroup.clear(),this.closeHistroyTrack(),!0},t.prototype.pick=function(e,t,i){void 0===i&&(i=!1),i&&this.clearSelection();var r=this.viewer.scene.pick(new Cesium.Cartesian2(e,t));if(r&&r.primitive&&r.id){var n=r.mesh?r.primitive.id.id:r.primitive.id,o=this.targetCollection.get(n);if(o)return o.isSelected=!0,o}},t.prototype.pickRect=function(e,t,i,r){var n,o,s=(e+e+i)/2,a=(t+t+r)/2,l=this.viewer.scene.drillPick(new Cesium.Cartesian2(s,a),null,i,r),h=[];try{for(var c=gv(l),u=c.next();!u.done;u=c.next()){var p=u.value;if(p.primitive){var d=p.mesh?p.primitive.id.id:p.primitive.id,m=this.targetCollection.get(d);m&&(m.isSelected=!0,h.includes(m)||h.push(m))}}}catch(e){n={error:e}}finally{try{u&&!u.done&&(o=c.return)&&o.call(c)}finally{if(n)throw n.error}}return h},t.prototype.openHistoryTrack=function(e,t){if(!this.historycollection){var i=new Cesium.CustomDataSource("historyTrack");this.viewer.dataSources.add(i),this.historycollection=i.entities}this.historyTrack||(this.historyTrack=new mv(this.viewer,this.historycollection),this.historyTrack.smoothTrack=!0,this.historyTrack.setTimeSection(e,t))},t.prototype.addHistoryTrack=function(e,t){this.historycollection&&this.historyTrack&&(this.getStyleByCode(e),this.historyTrack.addHistoryTrack(e,t))},t.prototype.play=function(){this.historyTrack&&(this.historyTrack.animate=!0)},t.prototype.pause=function(){this.historyTrack&&(this.historyTrack.animate=!1)},t.prototype.speedUp=function(){this.historyTrack&&(this.historyTrack.speed+=.5)},t.prototype.slowDown=function(){this.historyTrack&&(this.historyTrack.speed-=.5)},t.prototype.closeHistroyTrack=function(){this.historycollection&&this.historycollection.removeAll(),this.historyTrack&&this.historyTrack._pathList.clear()},Object.defineProperty(t.prototype,"historyItems",{get:function(){return this.historyTrack._pathList},enumerable:!1,configurable:!0}),t.prototype.getHistoryItem=function(e){var t;return this.historyTrack._pathList&&(t=this.historyTrack._pathList.get(e)),t},t.prototype.refresh=function(){return this.linkLines&&(this.linkLines.refresh(),this._brefresh=!0),!0},t.prototype.destroy=function(){this.removeAll(),this.viewer.scene.primitives.remove(this.rootcollection),this.rootcollection.destroy(),this.viewer.scene.primitives.remove(this.rootPointcollection),this.rootPointcollection.destroy()},t}(f),yv=function(){function e(e){this._engine=e,this._viewer=e.viewer,this.init()}return e.prototype.init=function(){this._tileLayer=new qA(this._viewer),this._graphicLayer=new hv(this._engine),this._plotLayer=new pv(this._engine),this._dynamicLayer=new Av(this._engine)},e.prototype.toJson=function(){return{graphicLayer:this._graphicLayer.toJson()}},e.prototype.parseJson=function(e){this._graphicLayer.fromJson(e.graphicLayer)},Object.defineProperty(e.prototype,"tileLayer",{get:function(){return this._tileLayer},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"graphicLayer",{get:function(){return this._graphicLayer},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"plotLayer",{get:function(){return this._plotLayer},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"dynamicLayer",{get:function(){return this._dynamicLayer},enumerable:!1,configurable:!0}),e}(),vv=function(){function e(e){this._tileDiscardPolicy=void 0,this._credit=void 0,this._readyPromise=void 0,this._errorEvent=new Cesium.Event,this._tileWidth=256,this._tileHeight=256,this._maximumLevel=18,this._minimumLevel=1,this._tilingScheme=new Cesium.WebMercatorTilingScheme({rectangleSouthwestInMeters:new Cesium.Cartesian2(-33554054,-33746824),rectangleNortheastInMeters:new Cesium.Cartesian2(33554054,33746824)}),this._rectangle=this._tilingScheme.rectangle;var t=Cesium.Resource.createIfNeeded(e.url);this._resource=t}return Object.defineProperty(e.prototype,"url",{get:function(){return this._resource.url},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"proxy",{get:function(){return this._resource.proxy},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tileWidth",{get:function(){if(!this.ready)throw new Cesium.DeveloperError("tileWidth must not be called before the imagery provider is ready.");return this._tileWidth},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tileHeight",{get:function(){if(!this.ready)throw new Cesium.DeveloperError("tileHeight must not be called before the imagery provider is ready.");return this._tileHeight},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"maximumLevel",{get:function(){if(!this.ready)throw new Cesium.DeveloperError("maximumLevel must not be called before the imagery provider is ready.");return this._maximumLevel},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"minimumLevel",{get:function(){if(!this.ready)throw new Cesium.DeveloperError("minimumLevel must not be called before the imagery provider is ready.");return this._minimumLevel},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tilingScheme",{get:function(){if(!this.ready)throw new Cesium.DeveloperError("tilingScheme must not be called before the imagery provider is ready.");return this._tilingScheme},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tileDiscardPolicy",{get:function(){if(!this.ready)throw new Cesium.DeveloperError("tileDiscardPolicy must not be called before the imagery provider is ready.");return this._tileDiscardPolicy},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rectangle",{get:function(){if(!this.ready)throw new Cesium.DeveloperError("rectangle must not be called before the imagery provider is ready.");return this._rectangle},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"errorEvent",{get:function(){return this._errorEvent},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ready",{get:function(){return this._resource},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"readyPromise",{get:function(){return this._readyPromise},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"credit",{get:function(){if(!this.ready)throw new Cesium.DeveloperError("credit must not be called before the imagery provider is ready.");return this._credit},enumerable:!1,configurable:!0}),e.prototype.requestImage=function(e,t,i,r){var n=this._tilingScheme.getNumberOfXTilesAtLevel(i),o=this._tilingScheme.getNumberOfYTilesAtLevel(i),s=this.url.replace("{x}",e-n/2).replace("{y}",o/2-t-1).replace("{z}",i).replace("{s}",Math.floor(10*Math.random()));return Cesium.ImageryProvider.loadImage(this,s)},e}();let Cv=Cesium.defaultValue,_v=Cesium.defined,bv=Cesium.DeveloperError,wv=Cesium.LabelCollection,Pv=Cesium.Cartesian3,Sv=Cesium.LabelStyle,xv=Cesium.EllipsoidalOccluder;class Bv{constructor(e){e=Cv(e,Cv.EMPTY_OBJECT),this._key=e.key;const t=this._key;if(!_v(t))throw new bv("the key of VectorTile is required.");const i=t.indexOf("-"),r=t.lastIndexOf("-");this._level=parseInt(t.substr(0,i)),this._x=parseInt(t.substr(i+1,r-i-1)),this._y=parseInt(t.substr(r+1)),this._scene=e.scene,this._prepare=Cv(e.state,!1),this._visible=Cv(e.visible,!1),this._eligibleForUnloading=Cv(e.eligibleForUnloading,!1),this._replacementPrevious=Cv(e.replacementPrevious,void 0),this._replacementNext=Cv(e.replacementNext,void 0),this._labelCollection=void 0,this._labels=[]}get key(){return this._key}get level(){return this._level}get x(){return this._x}get y(){return this._y}get scene(){return this._scene}get prepare(){return this._prepare}set prepare(e){this._prepare=e}get visible(){return this._visible}set visible(e){this._visible!==e&&(this._visible=e)}get eligibleForUnloading(){return this._eligibleForUnloading}set eligibleForUnloading(e){this._eligibleForUnloading!==e&&(this._eligibleForUnloading=e)}get replacementPrevious(){return this._replacementPrevious}set replacementPrevious(e){this._replacementPrevious=e}get replacementNext(){return this._replacementNext}set replacementNext(e){this._replacementNext=e}get labelCollection(){return this._labelCollection}calculateVisible(e,t){let i=t.isPointVisible(e.position);const r=e.computeScreenSpacePosition(this._scene);return _v(r)&&(r.x<0||r.x>this._scene.canvas.width||r.y<0||r.y>this._scene.canvas.height)&&(i=!1),i}createLabelCollection(){if(0===this._labels.length||!_v(this._scene))return _v(this._labelCollection)&&(this._labelCollection.destroy(),this._labelCollection=void 0),this._labelCollection;this._labelCollection=this._scene.primitives.add(new wv({scene:this._scene}));const e=this._scene.mapProjection.ellipsoid,t=this._scene.camera.positionWC,i=new xv(e,t);for(let e=0;e<this._labels.length;e++){const t=this._labels[e],r=new Pv.fromDegrees(t.lon,t.lat),n=this.createLabel(r,t.text,t.options);n.show=this.calculateVisible(n,i)}return this._labelCollection}updateVisible(){let e=!1;if(_v(this._labelCollection)){const t=this._scene.mapProjection.ellipsoid,i=this._scene.camera.positionWC,r=new xv(t,i);for(let t=0;t<this._labelCollection.length;t++){const i=this._labelCollection.get(t);let n=this.calculateVisible(i,r);i.show!=n&&(i.show=n,e=!0)}}return e}freeResources(){this._labels=[]}createLabel(e,t,i){if(!_v(this._labelCollection))return;let r={};return r.position=e,r.text=t,r.font=Cv(i.font,"12pt monospace"),r.fillColor=Cesium.Color.fromCssColorString(i.fillColor),r.outlineColor=Cesium.Color.fromCssColorString(i.outlineColor),r.outlineWidth=Cv(i.outlineWidth,1),r.style=Cv(i.style,Sv.FILL_AND_OUTLINE),this._labelCollection.add(r)}add(e,t,i,r){this._labels.push({lon:e,lat:t,text:i,options:r})}}class Mv extends c.Z{_name;_changed;_error;_isLoading;_loading;_entityCluster;_entityCollection;_url;_scene;_viewer;_tileReplacementQueue;_tileCacheSize;_renderTiles;_clusterDirty;_table;_styleTable;_id;constructor(e){if(super(),this._id=qh.createGuid(),this._changed=new Cesium.Event,this._error=new Cesium.Event,this._isLoading=!1,this._loading=new Cesium.Event,this._entityCollection=new Cesium.EntityCollection(this),this._entityCluster=new Cesium.EntityCluster,this._url=e.url,!Cesium.defined(this._url))throw new Cesium.DeveloperError("url is required.");this._tileReplacementQueue=new Cesium.TileReplacementQueue,this._tileCacheSize=1e3,this._renderTiles=new Cesium.AssociativeArray,this._clusterDirty=0,this._table=this.createLevelMap(e.table),this._styleTable=this.createDefaultStyles(e.styles),Cesium.DataSource.setLoading(this,!1)}getType(){return Mv.type}static get type(){return"PlaceNameTile"}initItem(e){this._scene=e.scene,this._viewer=e,this._viewer.dataSources.add(this)}destroyItem(){this._viewer.dataSources.remove(this,!0),this.destroy()}createLevelMap(e){let t=e;Cesium.defined(t)&&t instanceof Map||(t=new Map,t.set(1,[0,1,2]),t.set(3,[3,4,5]),t.set(5,[6,7,8]),t.set(7,[8,9,10]),t.set(9,[11,12]),t.set(11,[13,14]),t.set(13,[15,16]),t.set(15,[17,18]));const i=new Map,r=new Map;return t.forEach(((e,t,i)=>{if("number"==typeof t&&e instanceof Array)for(let i=0;i<e.length;i++){let n;r.has(e[i])?n=r.get(e[i]):(n=new Set,r.set(e[i],n)),n.add(t)}})),r.forEach(((e,t,r)=>{i.set(t,[...e])})),i}createDefaultStyles(e){let t=e;return Cesium.defined(t)&&t instanceof Map||(t=new Map),t.has(1)||t.set(1,new Ev("15pt monospace","rgba(255,255, 255, 1)","rgba(255,255, 255, 1)",1)),t.has(3)||t.set(3,new Ev("15pt monospace","rgba(255,255, 255, 1)","rgba(255,255, 255, 1)",1)),t.has(5)||t.set(5,new Ev("15pt monospace","rgba(255,255, 255, 1)","rgba(255,255, 255, 1)",1)),t.has(7)||t.set(7,new Ev("15pt monospace","rgba(255,255, 255, 1)","rgba(255,255, 255, 1)",1)),t.has(9)||t.set(9,new Ev("15pt monospace","rgba(255,255, 255, 1)","rgba(255,255, 255, 1)",1)),t.has(11)||t.set(11,new Ev("15pt monospace","rgba(255,255, 255, 1)","rgba(255,255, 255, 1)",1)),t.has(13)||t.set(13,new Ev("15pt monospace","rgba(255, 255, 255, 1)","rgba(255, 255,255, 1)",1)),t.has(15)||t.set(15,new Ev("15pt monospace","rgba(255.0, 255.0, 255.0, 1.0)","rgba(255, 255, 255, 1.0)",1)),t}get clock(){}get entities(){return this._entityCollection}get isLoading(){return this._isLoading}get changedEvent(){return this._changed}get errorEvent(){return this._error}get loadingEvent(){return this._loading}get show(){return this._entityCollection.show}set show(e){this._entityCollection.show=e}get clustering(){return this._entityCluster}set clustering(e){if(!Cesium.defined(e))throw new Cesium.DeveloperError("value must be defined.");this._entityCluster=e}createTileKey(e,t,i){return{level:e,x:t,y:i,key:e+"-"+t+"-"+i}}getSubTileKeys(e,t,i){let r=t-e.level,n=1;for(;r>0;)n*=2,r--;const o=e.x*n,s=(e.x+1)*n-1,a=e.y*n,l=(e.y+1)*n-1;for(let e=a;e<=l;e++)for(let r=o;r<=s;r++)i.push({level:t,x:r,y:e});return i}getTiles(e,t,i){let r,n,o=t,s=1;for(;o>0;)s*=2,o--;if(t===e.level)r=e.x,n=s-e.y-1,i.push(this.createTileKey(t,r,n));else if(e.level>t){for(o=e.level-t,r=e.x,n=e.y;o>0;)r=parseInt((r/2).toString()),n=parseInt((n/2).toString()),o--;n=s-n-1,i.push(this.createTileKey(t,r,n))}else if(e.level<t){o=t-e.level;let a=[];a=this.getSubTileKeys(e,t,a);for(let e=0;e<a.length;e++)t=a[e].level,r=a[e].x,n=s-a[e].y-1,i.push(this.createTileKey(t,r,n))}}calculateTiles(e){const t=new Cesium.AssociativeArray;if(e instanceof Array&&e.length>0){const i=[];for(let t=0;t<e.length;t++){let r=e[t];if(this._table.has(r.level)){const e=this._table.get(r.level);for(let t=0;t<e.length;t++)this.getTiles(r,e[t],i)}}if(i.length>0)for(let e=0;e<i.length;e++){let r=i[e];t.set(r.key,r)}}return t}getGeoCode(e,t,i){const r=e.toString(),n=t.toString(),o=i.toString();let s=r;r.length<2&&(s="0"+r);let a=7-o.length;for(;a>0;)s+="0",a--;for(s+=o,a=7-n.length;a>0;)s+="0",a--;return s+=n,s}processTile(e,t){const i=t.key;let r=this._tileReplacementQueue.head;for(;Cesium.defined(r)&&r.key!==i;)r=r.replacementNext;if(Cesium.defined(r))r.prepare&&(this._renderTiles.contains(r.key)||(r.createLabelCollection(),this._renderTiles.set(r.key,r),this._clusterDirty=2),r.visible=!0,r.updateVisible()&&0===this._clusterDirty&&(this._clusterDirty=1)),this._tileReplacementQueue.markTileRendered(r);else{const t=new Bv({key:i,scene:e});this._tileReplacementQueue.markTileRendered(t);const r=this.getGeoCode(t.level,t.x,t.y),n=this._styleTable.has(t.level)?this._styleTable.get(t.level):{},o=this._url+r;window.fetch(o).then((e=>e.json())).then((function(e){for(let i=0;i<e.length;i++){let r=e[i],o=r.WZ;o=o.substring(o.indexOf("(")+1,o.indexOf(")"));const s=o.split(" ");if(2===s.length){const e=parseFloat(s[0]),i=parseFloat(s[1]);t.add(e,i,r.DMMC,n)}}t.prepare=!0,t.eligibleForUnloading=!0}))}}update(e){if(!Cesium.defined(this._scene))return;this._tileReplacementQueue.markStartOfRenderFrame();let t=this._renderTiles.values;for(let e=0;e<t.length;e++)t[e].visible=!1;const i=new Array;let r=this._scene.globe._surface;r.forEachRenderedTile((e=>{i.push(this.createTileKey(e.level,e.x,e.y))})),r=null;const n=this.calculateTiles(i).values.slice(0);for(let e=0;e<n.length;e++)this.processTile(this._scene,n[e]);t=this._renderTiles.values;for(let e=t.length-1;e>=0;e--){let i=t[e];i.visible||(i.eligibleForUnloading=!0,Cesium.defined(i.labelCollection)&&this._scene.primitives.remove(i.labelCollection),this._renderTiles.remove(i.key),0===this._clusterDirty&&(this._clusterDirty=1))}return this._tileReplacementQueue.trimTiles(this._tileCacheSize),this._clusterDirty>0&&this._clusterDirty--,!0}getX(e){return e.coord.x}getY(e){return e.coord.y}cluster(){const e=this._renderTiles.values;let t=[];for(let i=0;i<e.length;i++){const r=e[i].labelCollection;if(Cesium.defined(r))for(let e=0;e<r.length;e++){const i=r.get(e);if(i.clusterShow=!0,!i.show)continue;const n=i.computeScreenSpacePosition(this._scene);if(!Cesium.defined(n))continue;let o=new Cesium.BoundingRectangle;o=Cesium.Label.getScreenSpaceBoundingBox(i,n,o),t.push({index:e,collection:r,clustered:!1,coord:n,bbox:o})}}const i=Cesium.kdbush(t,this.getX,this.getY,64,Int32Array),r=[];for(let e=0;e<t.length;e++){const n=t[e];if(n.clustered)continue;const o=n.bbox;let s=!1;for(let e=0;e<r.length;e++)if(Cesium.BoundingRectangle.intersect(o,r[e])===Cesium.Intersect.INTERSECTING){n.collection.get(n.index).clusterShow=!1,n.clustered=!0,s=!0;break}if(s)continue;r.push(o);const a=i.range(o.x,o.y,o.x+o.width,o.y+o.height);if(!(a.length<2))for(let i=0;i<a.length;i++){if(a[i]===e)continue;const r=t[a[i]];if(!r.clustered){r.collection.get(r.index).clusterShow=!1,r.clustered=!0}}}}destroy(){let e=this._renderTiles.values;for(let t=0;t<e.length;t++)this._scene.primitives.remove(e[t].labelCollection);e=void 0,this._renderTiles.removeAll(),this._tileReplacementQueue.markStartOfRenderFrame(),this._tileReplacementQueue.trimTiles(0),this._scene=void 0}}class Ev{font;fillColor;outlineColor;outlineWidth;constructor(e="15pt monospace",t="rgba(0.0, 0.0, 0.0, 1.0)",i="rgba(255,255, 255, 1.0)",r=1){this.font=e,this.fillColor=t,this.outlineColor=i,this.outlineWidth=r}}class Tv extends c.Z{_isPick;constructor(e){if(super(),e=Cesium.defaultValue(e,Cesium.defaultValue.EMPTY_OBJECT),this._options=e,this._provider=new Cesium.Cesium3DTileset(e),!Cesium.defined(this._provider))throw new Cesium.DeveloperError("provider is required.")}initItem(e){if(this._scene=e.scene,this._viewer=e,this._options.shaderType){let e=this.buildCustomShader(this._options.shaderType);e&&(this._provider.customShader=e)}this._viewer.scene.primitives.add(this._provider)}get id(){return this.guid}destroyItem(){this._viewer.scene.primitives.remove(this._provider),this.destroy()}destroy(){this._scene;this._scene=void 0,Cesium.defined(this._provider)&&(this._provider=void 0)}buildCustomShader(e){let t;return t=this.customShaderOne(),t}customShaderOne(){var e=performance.now(),t=Cesium.TextureUniform,i=Cesium.TextureMinificationFilter,r=new Cesium.CustomShader({uniforms:{u_time:{value:e,type:Cesium.UniformType.FLOAT},u_mixColor:{value:new Cesium.Cartesian3(1,1,1),type:Cesium.VaryingType.VEC3},u_alpha:{value:1,type:Cesium.UniformType.FLOAT},u_customTexture0:{value:new t({url:qh.formatUrlByBaseJs("resources/Textures/grey.png")}),type:Cesium.UniformType.SAMPLER_2D,repeat:!0,minificationFilter:i.LINEAR,magnificationFilter:i.LINEAR},u_customTexture1:{value:new t({url:qh.formatUrlByBaseJs("resources/Textures/mesh.png")}),type:Cesium.UniformType.SAMPLER_2D,repeat:!0,minificationFilter:i.LINEAR,magnificationFilter:i.LINEAR},u_uvScale1:{value:new Cesium.Cartesian3(1,1),type:Cesium.VaryingType.VEC2},u_uvOffset1:{value:new Cesium.Cartesian3(0,0),type:Cesium.VaryingType.VEC2}},varyings:{v_outPos:Cesium.VaryingType.VEC3,v_outTexCoord_0:Cesium.VaryingType.VEC2},mode:Cesium.CustomShaderMode.REPLACE_MATERIAL,lightingModel:Cesium.LightingModel.UNLIT,isTranslucent:!1,vertexShaderText:"\n            void vertexMain(VertexInput vsInput, inout czm_modelVertexOutput vsOutput) {\n                v_outPos = vsOutput.positionMC;\n                v_outTexCoord_0 = vsInput.attributes.texCoord_0;\n            }\n            ",fragmentShaderText:"\n            void fragmentMain(FragmentInput fsInput, inout czm_modelMaterial material) {\n                vec2 uv0 = 1.0 - v_outTexCoord_0;\n                vec2 uv1 = uv0;\n\n                uv1 *= u_uvScale1;\n                uv1 += u_uvOffset1;\n\n                vec4 color0 = texture2D(u_customTexture0, uv0);\n                vec4 color1 = texture2D(u_customTexture1, uv1);\n                vec4 color_final = mix(color0, color1, color1.a);\n                material.diffuse = color_final.xyz * u_mixColor;\n\n                material.alpha = u_alpha;\n            } \n            "});return this._viewer.scene.preUpdate.addEventListener((function(){r.setUniform("u_time",performance.now()-e)})),r}updateShaderColor(e,t,i){this._provider.customShader&&this._provider.customShader.setUniform("u_mixColor",new Cesium.Cartesian3(e,t,i))}}var Ov=i(4298),Lv=i.n(Ov),Dv=i(2443),Iv=i.n(Dv),Rv=i(8122),Hv=i.n(Rv),Fv=i(4549),Nv=i.n(Fv),Qv=Cesium.BoundingSphere,kv=Cesium.Cartesian3,Uv=Cesium.Color,jv=Cesium.combine,Gv=Cesium.ComponentDatatype,zv=Cesium.defaultValue,Yv=Cesium.defined,Zv=(Object.defineProperties,Cesium.destroyObject),Wv=Cesium.DeveloperError,Xv=Cesium.Matrix4,Jv=Cesium.PrimitiveType,Kv=Cesium.Buffer,Vv=Cesium.BufferUsage,qv=Cesium.DrawCommand,$v=Cesium.Pass,eC=Cesium.RenderState,tC=Cesium.ShaderProgram,iC=Cesium.ShaderSource,rC=Cesium.VertexArray,nC=Cesium.BlendingState,oC=Cesium.CullFace,sC=Cesium.Material,aC=Cesium.SceneMode,lC=Cesium.VertexFormat,hC=Cesium.Math,cC=Cesium.Matrix3,uC=(Xv=Cesium.Matrix4,Cesium.JulianDate),pC=(Cesium.BoxGeometry,Cesium.EllipsoidGeometry,Math.sin),dC=Math.cos,mC=Math.tan,fC=Math.atan,gC=(Math.asin,{position:0,normal:1});function AC(e){var t=this;e=zv(e,zv.EMPTY_OBJECT),this.show=zv(e.show,!0),this.slice=zv(e.slice,32),this.modelMatrix=Xv.clone(e.modelMatrix,new Xv),this._modelMatrix=new Xv,this._computedModelMatrix=new Xv,this._computedScanPlaneModelMatrix=new Xv,this.radius=zv(e.radius,Number.POSITIVE_INFINITY),this._radius=void 0,this.xHalfAngle=zv(e.xHalfAngle,0),this._xHalfAngle=void 0,this.yHalfAngle=zv(e.yHalfAngle,0),this._yHalfAngle=void 0,this.lineColor=zv(e.lineColor,Uv.WHITE),this.showSectorLines=zv(e.showSectorLines,!0),this.showSectorSegmentLines=zv(e.showSectorSegmentLines,!0),this.showLateralSurfaces=zv(e.showLateralSurfaces,!0),this.material=Yv(e.material)?e.material:sC.fromType(sC.ColorType),this._material=void 0,this._translucent=void 0,this.lateralSurfaceMaterial=Yv(e.lateralSurfaceMaterial)?e.lateralSurfaceMaterial:sC.fromType(sC.ColorType),this._lateralSurfaceMaterial=void 0,this._lateralSurfaceTranslucent=void 0,this.showDomeSurfaces=zv(e.showDomeSurfaces,!0),this.domeSurfaceMaterial=Yv(e.domeSurfaceMaterial)?e.domeSurfaceMaterial:sC.fromType(sC.ColorType),this._domeSurfaceMaterial=void 0,this.showDomeLines=zv(e.showDomeLines,!0),this.showIntersection=zv(e.showIntersection,!0),this.intersectionColor=zv(e.intersectionColor,Uv.WHITE),this.intersectionWidth=zv(e.intersectionWidth,5),this.showThroughEllipsoid=zv(e.showThroughEllipsoid,!1),this._showThroughEllipsoid=void 0,this.showScanPlane=zv(e.showScanPlane,!0),this.scanPlaneColor=zv(e.scanPlaneColor,Uv.WHITE),this.scanPlaneMode=zv(e.scanPlaneMode,"horizontal"),this.scanPlaneRate=zv(e.scanPlaneRate,10),this._scanePlaneXHalfAngle=0,this._scanePlaneYHalfAngle=0,this._time=uC.now(),this._boundingSphere=new Qv,this._boundingSphereWC=new Qv,this._sectorFrontCommand=new qv({owner:this,primitiveType:Jv.TRIANGLES,boundingVolume:this._boundingSphereWC}),this._sectorBackCommand=new qv({owner:this,primitiveType:Jv.TRIANGLES,boundingVolume:this._boundingSphereWC}),this._sectorVA=void 0,this._sectorLineCommand=new qv({owner:this,primitiveType:Jv.LINES,boundingVolume:this._boundingSphereWC}),this._sectorLineVA=void 0,this._sectorSegmentLineCommand=new qv({owner:this,primitiveType:Jv.LINES,boundingVolume:this._boundingSphereWC}),this._sectorSegmentLineVA=void 0,this._domeFrontCommand=new qv({owner:this,primitiveType:Jv.TRIANGLES,boundingVolume:this._boundingSphereWC}),this._domeBackCommand=new qv({owner:this,primitiveType:Jv.TRIANGLES,boundingVolume:this._boundingSphereWC}),this._domeVA=void 0,this._domeLineCommand=new qv({owner:this,primitiveType:Jv.LINES,boundingVolume:this._boundingSphereWC}),this._domeLineVA=void 0,this._scanPlaneFrontCommand=new qv({owner:this,primitiveType:Jv.TRIANGLES,boundingVolume:this._boundingSphereWC}),this._scanPlaneBackCommand=new qv({owner:this,primitiveType:Jv.TRIANGLES,boundingVolume:this._boundingSphereWC}),this._scanRadialCommand=void 0,this._colorCommands=[],this._frontFaceRS=void 0,this._backFaceRS=void 0,this._sp=void 0,this._uniforms={u_type:function(){return 0},u_xHalfAngle:function(){return t.xHalfAngle},u_yHalfAngle:function(){return t.yHalfAngle},u_radius:function(){return t.radius},u_showThroughEllipsoid:function(){return t.showThroughEllipsoid},u_showIntersection:function(){return t.showIntersection},u_intersectionColor:function(){return t.intersectionColor},u_intersectionWidth:function(){return t.intersectionWidth},u_normalDirection:function(){return 1},u_lineColor:function(){return t.lineColor}},this._scanUniforms={u_xHalfAngle:function(){return t._scanePlaneXHalfAngle},u_yHalfAngle:function(){return t._scanePlaneYHalfAngle},u_radius:function(){return t.radius},u_color:function(){return t.scanPlaneColor},u_showThroughEllipsoid:function(){return t.showThroughEllipsoid},u_showIntersection:function(){return t.showIntersection},u_intersectionColor:function(){return t.intersectionColor},u_intersectionWidth:function(){return t.intersectionWidth},u_normalDirection:function(){return 1},u_lineColor:function(){return t.lineColor}}}AC.prototype.update=function(e){var t=e.mode;if(this.show&&t===aC.SCENE3D){var i=!1,r=!1,n=!1,o=this.xHalfAngle,s=this.yHalfAngle;if(o<0||s<0)throw new Wv("halfAngle must be greater than or equal to zero.");if(0!=o&&0!=s){this._xHalfAngle===o&&this._yHalfAngle===s||(this._xHalfAngle=o,this._yHalfAngle=s,i=!0);var a=this.radius;if(a<0)throw new Wv("this.radius must be greater than or equal to zero.");var l=!1;this._radius!==a&&(l=!0,this._radius=a,this._boundingSphere=new Qv(kv.ZERO,this.radius)),(!Xv.equals(this.modelMatrix,this._modelMatrix)||l)&&(Xv.clone(this.modelMatrix,this._modelMatrix),Xv.multiplyByUniformScale(this.modelMatrix,this.radius,this._computedModelMatrix),Qv.transform(this._boundingSphere,this.modelMatrix,this._boundingSphereWC));var h=this.showThroughEllipsoid;this._showThroughEllipsoid!==this.showThroughEllipsoid&&(this._showThroughEllipsoid=h,r=!0);var c=this.material=this.lateralSurfaceMaterial;this._material!==c&&(this._material=c,r=!0,n=!0);var u=c.isTranslucent();if(this._translucent!==u&&(this._translucent=u,r=!0),this.showScanPlane){var p=e.time,d=uC.secondsDifference(p,this._time);d<0&&(this._time=uC.clone(p,this._time));var m,f=Math.max(d%this.scanPlaneRate/this.scanPlaneRate,0);if("horizontal"==this.scanPlaneMode){var g=dC(m=2*s*f-s),A=mC(o),y=fC(g*A);this._scanePlaneXHalfAngle=y,this._scanePlaneYHalfAngle=m,Cesium.Matrix3.fromRotationX(this._scanePlaneYHalfAngle,yC)}else{m=2*o*f-o;var v=mC(s),C=dC(m),_=fC(C*v);this._scanePlaneXHalfAngle=m,this._scanePlaneYHalfAngle=_,Cesium.Matrix3.fromRotationY(this._scanePlaneXHalfAngle,yC)}Cesium.Matrix4.multiplyByMatrix3(this.modelMatrix,yC,this._computedScanPlaneModelMatrix),Xv.multiplyByUniformScale(this._computedScanPlaneModelMatrix,this.radius,this._computedScanPlaneModelMatrix)}i&&function(e,t){var i=t.context,r=CC(e,e.xHalfAngle,e.yHalfAngle),n=function(e,t){var i=e.xHalfAngle,r=e.yHalfAngle,n=t.zoy,o=t.zox,s=[],a=cC.fromRotationY(i,yC);s.push(n.map((function(e){return cC.multiplyByVector(a,e,new Cesium.Cartesian3)})));a=cC.fromRotationX(-r,yC);s.push(o.map((function(e){return cC.multiplyByVector(a,e,new Cesium.Cartesian3)})).reverse());a=cC.fromRotationY(-i,yC);s.push(n.map((function(e){return cC.multiplyByVector(a,e,new Cesium.Cartesian3)})).reverse());a=cC.fromRotationX(r,yC);return s.push(o.map((function(e){return cC.multiplyByVector(a,e,new Cesium.Cartesian3)}))),s}(e,r);e.showLateralSurfaces&&(e._sectorVA=function(e,t){for(var i=Array.prototype.concat.apply([],t).length-t.length,r=new Float32Array(18*i),n=0,o=0,s=t.length;o<s;o++){var a=t[o],l=kv.normalize(kv.cross(a[0],a[a.length-1],vC),vC),h=0;for(i=a.length-1;h<i;h++)r[n++]=0,r[n++]=0,r[n++]=0,r[n++]=-l.x,r[n++]=-l.y,r[n++]=-l.z,r[n++]=a[h].x,r[n++]=a[h].y,r[n++]=a[h].z,r[n++]=-l.x,r[n++]=-l.y,r[n++]=-l.z,r[n++]=a[h+1].x,r[n++]=a[h+1].y,r[n++]=a[h+1].z,r[n++]=-l.x,r[n++]=-l.y,r[n++]=-l.z}var c=Kv.createVertexBuffer({context:e,typedArray:r,usage:Vv.STATIC_DRAW}),u=6*Float32Array.BYTES_PER_ELEMENT,p=[{index:gC.position,vertexBuffer:c,componentsPerAttribute:3,componentDatatype:Gv.FLOAT,offsetInBytes:0,strideInBytes:u},{index:gC.normal,vertexBuffer:c,componentsPerAttribute:3,componentDatatype:Gv.FLOAT,offsetInBytes:3*Float32Array.BYTES_PER_ELEMENT,strideInBytes:u}];return new rC({context:e,attributes:p})}(i,n));e.showSectorLines&&(e._sectorLineVA=function(e,t){for(var i=t.length,r=new Float32Array(9*i),n=0,o=0,s=t.length;o<s;o++){var a=t[o];r[n++]=0,r[n++]=0,r[n++]=0,r[n++]=a[0].x,r[n++]=a[0].y,r[n++]=a[0].z}var l=Kv.createVertexBuffer({context:e,typedArray:r,usage:Vv.STATIC_DRAW}),h=3*Float32Array.BYTES_PER_ELEMENT,c=[{index:gC.position,vertexBuffer:l,componentsPerAttribute:3,componentDatatype:Gv.FLOAT,offsetInBytes:0,strideInBytes:h}];return new rC({context:e,attributes:c})}(i,n));e.showSectorSegmentLines&&(e._sectorSegmentLineVA=function(e,t){for(var i=Array.prototype.concat.apply([],t).length-t.length,r=new Float32Array(9*i),n=0,o=0,s=t.length;o<s;o++){var a=t[o],l=0;for(i=a.length-1;l<i;l++)r[n++]=a[l].x,r[n++]=a[l].y,r[n++]=a[l].z,r[n++]=a[l+1].x,r[n++]=a[l+1].y,r[n++]=a[l+1].z}var h=Kv.createVertexBuffer({context:e,typedArray:r,usage:Vv.STATIC_DRAW}),c=3*Float32Array.BYTES_PER_ELEMENT,u=[{index:gC.position,vertexBuffer:h,componentsPerAttribute:3,componentDatatype:Gv.FLOAT,offsetInBytes:0,strideInBytes:c}];return new rC({context:e,attributes:u})}(i,n));e.showDomeSurfaces&&(e._domeVA=function(e){var t=Cesium.EllipsoidGeometry.createGeometry(new Cesium.EllipsoidGeometry({vertexFormat:lC.POSITION_ONLY,stackPartitions:32,slicePartitions:32})),i=rC.fromGeometry({context:e,geometry:t,attributeLocations:gC,bufferUsage:Vv.STATIC_DRAW,interleave:!1});return i}(i));e.showDomeLines&&(e._domeLineVA=function(e){var t=Cesium.EllipsoidOutlineGeometry.createGeometry(new Cesium.EllipsoidOutlineGeometry({vertexFormat:lC.POSITION_ONLY,stackPartitions:32,slicePartitions:32})),i=rC.fromGeometry({context:e,geometry:t,attributeLocations:gC,bufferUsage:Vv.STATIC_DRAW,interleave:!1});return i}(i));if(e.showScanPlane)if("horizontal"==e.scanPlaneMode){var o=CC(e,hC.PI_OVER_TWO,0);e._scanPlaneVA=_C(i,o.zox)}else{o=CC(e,0,hC.PI_OVER_TWO);e._scanPlaneVA=_C(i,o.zoy)}}(this,e),r&&function(e,t,i){i?(e._frontFaceRS=eC.fromCache({depthTest:{enabled:!t},depthMask:!1,blending:nC.ALPHA_BLEND,cull:{enabled:!0,face:oC.BACK}}),e._backFaceRS=eC.fromCache({depthTest:{enabled:!t},depthMask:!1,blending:nC.ALPHA_BLEND,cull:{enabled:!0,face:oC.FRONT}}),e._pickRS=eC.fromCache({depthTest:{enabled:!t},depthMask:!1,blending:nC.ALPHA_BLEND})):(e._frontFaceRS=eC.fromCache({depthTest:{enabled:!t},depthMask:!0}),e._pickRS=eC.fromCache({depthTest:{enabled:!0},depthMask:!0}))}(this,h,u),n&&function(e,t,i){(function(e,t,i){var r=t.context,n=Lv(),o=new iC({sources:[Hv(),i.shaderSource,Iv()]});e._sp=tC.replaceCache({context:r,shaderProgram:e._sp,vertexShaderSource:n,fragmentShaderSource:o,attributeLocations:gC});var s=new iC({sources:[Hv(),i.shaderSource,Iv()],pickColorQualifier:"uniform"});e._pickSP=tC.replaceCache({context:r,shaderProgram:e._pickSP,vertexShaderSource:n,fragmentShaderSource:s,attributeLocations:gC})})(e,t,i),e.showScanPlane&&function(e,t,i){var r=t.context,n=Lv(),o=new iC({sources:[Hv(),i.shaderSource,Nv()]});e._scanePlaneSP=tC.replaceCache({context:r,shaderProgram:e._scanePlaneSP,vertexShaderSource:n,fragmentShaderSource:o,attributeLocations:gC})}(e,t,i)}(this,e,c),(r||n)&&function(e,t){e._colorCommands.length=0;var i=t?$v.TRANSLUCENT:$v.OPAQUE;e.showLateralSurfaces&&bC(e,e._sectorFrontCommand,e._sectorBackCommand,e._frontFaceRS,e._backFaceRS,e._sp,e._sectorVA,e._uniforms,e._computedModelMatrix,t,i);e.showSectorLines&&bC(e,e._sectorLineCommand,void 0,e._frontFaceRS,e._backFaceRS,e._sp,e._sectorLineVA,e._uniforms,e._computedModelMatrix,t,i,!0);e.showSectorSegmentLines&&bC(e,e._sectorSegmentLineCommand,void 0,e._frontFaceRS,e._backFaceRS,e._sp,e._sectorSegmentLineVA,e._uniforms,e._computedModelMatrix,t,i,!0);e.showDomeSurfaces&&bC(e,e._domeFrontCommand,e._domeBackCommand,e._frontFaceRS,e._backFaceRS,e._sp,e._domeVA,e._uniforms,e._computedModelMatrix,t,i);e.showDomeLines&&bC(e,e._domeLineCommand,void 0,e._frontFaceRS,e._backFaceRS,e._sp,e._domeLineVA,e._uniforms,e._computedModelMatrix,t,i,!0);e.showScanPlane&&bC(e,e._scanPlaneFrontCommand,e._scanPlaneBackCommand,e._frontFaceRS,e._backFaceRS,e._scanePlaneSP,e._scanPlaneVA,e._scanUniforms,e._computedScanPlaneModelMatrix,t,i)}(this,u);var b=e.commandList,w=e.passes,P=this._colorCommands;if(w.render)for(var S=0,x=P.length;S<x;S++){var B=P[S];b.push(B)}}}},AC.prototype.destroy=function(){return Zv(this)},AC.prototype.isDestroyed=function(){return!1};var yC=new cC,vC=new kv;function CC(e,t,i){for(var r=e.slice,n=dC(i),o=mC(i),s=dC(t),a=mC(t),l=fC(s*o),h=fC(n*a),c=[],u=0;u<r;u++){var p=2*l*u/(r-1)-l;c.push(new kv(0,pC(p),dC(p)))}var d=[];for(u=0;u<r;u++){p=2*h*u/(r-1)-h;d.push(new kv(pC(p),0,dC(p)))}return{zoy:c,zox:d}}function _C(e,t){for(var i=t.length-1,r=new Float32Array(9*i),n=0,o=0;o<i;o++)r[n++]=0,r[n++]=0,r[n++]=0,r[n++]=t[o].x,r[n++]=t[o].y,r[n++]=t[o].z,r[n++]=t[o+1].x,r[n++]=t[o+1].y,r[n++]=t[o+1].z;var s=Kv.createVertexBuffer({context:e,typedArray:r,usage:Vv.STATIC_DRAW}),a=3*Float32Array.BYTES_PER_ELEMENT,l=[{index:gC.position,vertexBuffer:s,componentsPerAttribute:3,componentDatatype:Gv.FLOAT,offsetInBytes:0,strideInBytes:a}];return new rC({context:e,attributes:l})}function bC(e,t,i,r,n,o,s,a,l,h,c,u){h&&i&&(i.vertexArray=s,i.renderState=n,i.shaderProgram=o,i.uniformMap=jv(a,e._material._uniforms),i.uniformMap.u_normalDirection=function(){return-1},i.pass=c,i.modelMatrix=l,e._colorCommands.push(i)),t.vertexArray=s,t.renderState=r,t.shaderProgram=o,t.uniformMap=jv(a,e._material._uniforms),u&&(t.uniformMap.u_type=function(){return 1}),t.pass=c,t.modelMatrix=l,e._colorCommands.push(t)}var wC=i(4292),PC=Cesium.defined;function SC(e,t,i){var r=t[e.id];if(PC(r)){var n=r.primitive;i.remove(n),n.isDestroyed()||n.destroy(),delete t[e.id]}}var xC=Cesium.AssociativeArray,BC=Cesium.Cartesian3,MC=Cesium.Color,EC=Cesium.defined,TC=Cesium.destroyObject,OC=Cesium.DeveloperError,LC=Cesium.Matrix3,DC=Cesium.Matrix4,IC=Cesium.Quaternion,RC=Cesium.MaterialProperty,HC=Cesium.Property,FC=new LC,NC=(new DC,new BC),QC=new BC,kC=new IC,UC=new BC,jC=new IC,GC=function(e,t){if(!EC(e))throw new OC("scene is required.");if(!EC(t))throw new OC("entityCollection is required.");t.collectionChanged.addEventListener(GC.prototype._onCollectionChanged,this),this._scene=e,this._primitives=e.primitives,this._entityCollection=t,this._hash={},this._entitiesToVisualize=new xC,this._onCollectionChanged(t,t.values,[],[])};GC.prototype.update=function(e){if(!EC(e))throw new OC("time is required.");for(var t=this._entitiesToVisualize.values,i=this._hash,r=this._primitives,n=0,o=t.length;n<o;n++){var s,a,l,h,c=t[n],u=c._rectangularSensor,p=i[c.id],d=c.isShowing&&c.isAvailable(e)&&HC.getValueOrDefault(u._show,e,!0);if(d&&(s=HC.getValueOrUndefined(c._position,e,NC),C=HC.getValueOrUndefined(c._orientation,e,kC),a=HC.getValueOrUndefined(u._radius,e),l=HC.getValueOrUndefined(u._xHalfAngle,e),h=HC.getValueOrUndefined(u._yHalfAngle,e),d=EC(s)&&EC(l)&&EC(h)),d){var m=EC(p)?p.primitive:void 0;EC(m)||((m=new AC).id=c,r.add(m),p={primitive:m,position:void 0,orientation:void 0},i[c.id]=p);var f=HC.getValueOrUndefined(u._gaze,e);if(EC(f)){var g=HC.getValueOrUndefined(f._position,e,QC);if(!EC(s)||!EC(g))continue;var A=BC.subtract(s,g,UC),y=BC.angleBetween(Cesium.Cartesian3.UNIT_Z,A),v=BC.cross(Cesium.Cartesian3.UNIT_Z,A,UC),C=IC.fromAxisAngle(v,y-Math.PI,jC);a=BC.distance(s,g),m.modelMatrix=DC.fromRotationTranslation(LC.fromQuaternion(C,FC),s,m.modelMatrix)}else BC.equals(s,p.position)&&IC.equals(C,p.orientation)||(EC(C)?(m.modelMatrix=DC.fromRotationTranslation(LC.fromQuaternion(C,FC),s,m.modelMatrix),p.position=BC.clone(s,p.position),p.orientation=IC.clone(C,p.orientation)):(m.modelMatrix=Cesium.Transforms.eastNorthUpToFixedFrame(s),p.position=BC.clone(s,p.position)));m.show=!0,m.gaze=f,m.radius=a,m.xHalfAngle=l,m.yHalfAngle=h,m.lineColor=HC.getValueOrDefault(u._lineColor,e,MC.WHITE),m.showSectorLines=HC.getValueOrDefault(u._showSectorLines,e,!0),m.showSectorSegmentLines=HC.getValueOrDefault(u._showSectorSegmentLines,e,!0),m.showLateralSurfaces=HC.getValueOrDefault(u._showLateralSurfaces,e,!0),m.showDomeSurfaces=HC.getValueOrDefault(u._showDomeSurfaces,e,!0),m.showDomeLines=HC.getValueOrDefault(u._showDomeLines,e,!0),m.showIntersection=HC.getValueOrDefault(u._showIntersection,e,!0),m.intersectionColor=HC.getValueOrDefault(u._intersectionColor,e,MC.WHITE),m.intersectionWidth=HC.getValueOrDefault(u._intersectionWidth,e,1),m.showThroughEllipsoid=HC.getValueOrDefault(u._showThroughEllipsoid,e,!1),m.scanPlaneMode=HC.getValueOrDefault(u._scanPlaneMode,e),m.scanPlaneColor=HC.getValueOrDefault(u._scanPlaneColor,e,MC.WHITE),m.showScanPlane=HC.getValueOrDefault(u._showScanPlane,e,!0),m.scanPlaneRate=HC.getValueOrDefault(u._scanPlaneRate,e,1),m.lateralSurfaceMaterial=RC.getValue(e,u._lateralSurfaceMaterial,m.lateralSurfaceMaterial)}else EC(p)&&(p.primitive.show=!1)}return!0},GC.prototype.isDestroyed=function(){return!1},GC.prototype.destroy=function(){for(var e=this._entitiesToVisualize.values,t=this._hash,i=this._primitives,r=e.length-1;r>-1;r--)SC(e[r],t,i);return TC(this)},GC.prototype._onCollectionChanged=function(e,t,i,r){var n,o,s=this._entitiesToVisualize,a=this._hash,l=this._primitives;for(n=t.length-1;n>-1;n--)o=t[n],EC(o._rectangularSensor)&&EC(o._position)&&s.set(o.id,o);for(n=r.length-1;n>-1;n--)o=r[n],EC(o._rectangularSensor)&&EC(o._position)?s.set(o.id,o):(SC(o,a,l),s.remove(o.id));for(n=i.length-1;n>-1;n--)SC(o=i[n],a,l),s.remove(o.id)};var zC=i(5108),YC=Cesium.BoundingSphere,ZC=Cesium.Cartesian3,WC=Cesium.Check,XC=Cesium.ComponentDatatype,JC=Cesium.defaultValue,KC=(Cesium.defined,Cesium.Geometry),VC=Cesium.GeometryAttribute,qC=Cesium.GeometryAttributes,$C=Cesium.PrimitiveType,e_=Cesium.VertexFormat,t_=Cesium.Math,i_=Cesium.GeometryPipeline,r_=Cesium.IndexDatatype,n_=(Cesium.Ellipsoid,Math.cos),o_=Math.sin;function s_(e){var t=(e=JC(e,JC.EMPTY_OBJECT)).angle,i=e.radius,r=Math.round(JC(e.stackPartitions,12)),n=Math.round(JC(e.slicePartitions,64));WC.typeOf.number("angle",t),WC.typeOf.number("radius",i);var o=JC(e.vertexFormat,e_.DEFAULT);this._angle=t,this._radius=i,this._stackPartitions=r,this._slicePartitions=n,this._vertexFormat=o}s_.fromDimensions=function(e){var t=(e=JC(e,JC.EMPTY_OBJECT)).angle,i=e.radius,r=e.stackPartitions,n=e.slicePartitions;return WC.typeOf.number("angle",t),WC.typeOf.number("radius",i),WC.typeOf.number.greaterThanOrEquals("angle",t,0),WC.typeOf.number.greaterThanOrEquals("height",height,0),new s_({angle:t,radius:i,stackPartitions:r,slicePartitions:n,vertexFormat:e.vertexFormat})},s_.createGeometry=function(e){zC.time("createGeometry");var t,i=e._angle,r=e._radius,n=e._stackPartitions+1,o=e._slicePartitions+1,s=e._vertexFormat,a=new qC,l=3*(o-1)+6*(o-1)*(n-2)+1*(o-1)*3,h=n*o,c=r_.createTypedArray(h,l),u=new Float64Array(3*h+3*(o-1)*3);if(s.position){for(var p=0,d=new Array(o),m=new Array(o),f=0;f<o;f++){var g=t_.TWO_PI*f/(o-1);d[f]=n_(g),m[f]=o_(g),u[p++]=0,u[p++]=0,u[p++]=-r}for(f=1;f<n;f++)for(var A=i*f/(n-1),y=o_(A),v=r*y,C=r*y,_=r*n_(A),b=0;b<o;b++)u[p++]=d[b]*v,u[p++]=m[b]*C,u[p++]=-_;t=p;for(f=0;f<o-1;f++)u[p++]=0,u[p++]=0,u[p++]=0,u[p++]=u[t-3*(o-f-1)],u[p++]=u[t-3*(o-f-1)+1],u[p++]=u[t-3*(o-f-1)+2],u[p++]=u[t-3*(o-f)],u[p++]=u[t-3*(o-f)+1],u[p++]=u[t-3*(o-f)+2];a.position=new VC({componentDatatype:XC.DOUBLE,componentsPerAttribute:3,values:u})}var w,P,S=0;for(b=0;b<o-1;b++)c[S++]=o+b,c[S++]=o+b+1,c[S++]=b+1;for(f=1;f<n-1;f++)for(w=f*o,P=(f+1)*o,b=0;b<o-1;b++)c[S++]=P+b,c[S++]=P+b+1,c[S++]=w+b+1,c[S++]=P+b,c[S++]=w+b+1,c[S++]=w+b;f=0;for(var x=3*(o-1);f<x;f++)c[S++]=f+t/3;var B=new KC({attributes:a,indices:c,primitiveType:$C.TRIANGLES,boundingSphere:new YC(ZC.ZERO,r)});return B=i_.computeNormal(B),zC.timeEnd("createGeometry"),B};var a_=Cesium.BoundingSphere,l_=Cesium.Cartesian3,h_=Cesium.ComponentDatatype,c_=Cesium.defaultValue,u_=(Cesium.defined,Cesium.DeveloperError),p_=(Cesium.Ellipsoid,Cesium.Geometry),d_=Cesium.GeometryAttribute,m_=Cesium.GeometryAttributes,f_=Cesium.IndexDatatype,g_=Cesium.Math,A_=Cesium.PrimitiveType,y_=(new l_(1,1,1),Math.cos),v_=Math.sin;function C_(e){var t=(e=c_(e,c_.EMPTY_OBJECT)).angle,i=e.radius,r=Math.round(c_(e.stackPartitions,10)),n=Math.round(c_(e.slicePartitions,8)),o=Math.round(c_(e.subdivisions,128));if(r<1)throw new u_("options.stackPartitions cannot be less than 1");if(n<0)throw new u_("options.slicePartitions cannot be less than 0");if(o<0)throw new u_("options.subdivisions must be greater than or equal to zero.");this._angle=t,this._radius=i,this._stackPartitions=r,this._slicePartitions=n,this._subdivisions=o}C_.createGeometry=function(e){var t=e._angle,i=e._radius;if(!(i<=0||t<=0)){var r,n,o,s,a,l,h=e._stackPartitions,c=e._slicePartitions,u=e._subdivisions,p=u*(h+c-1),d=p-c+2,m=new Float64Array(3*d),f=f_.createTypedArray(d,2*p),g=0,A=new Array(u),y=new Array(u);for(r=0;r<u;r++)o=g_.TWO_PI*r/u,A[r]=y_(o),y[r]=v_(o);for(r=1;r<h;r++)for(a=y_(s=t*r/(h-1)),l=v_(s),n=0;n<u;n++)m[g++]=i*A[n]*l,m[g++]=i*y[n]*l,m[g++]=-i*a;for(A.length=c,y.length=c,r=0;r<c;r++)o=g_.TWO_PI*r/c,A[r]=y_(o),y[r]=v_(o);for(m[g++]=0,m[g++]=0,m[g++]=-i,r=1;r<u;r++)for(a=y_(s=t*r/u),l=v_(s),n=0;n<c;n++)m[g++]=i*A[n]*l,m[g++]=i*y[n]*l,m[g++]=-i*a;for(g=0,r=0;r<h-1;++r){var v=r*u;for(n=0;n<u-1;++n)f[g++]=v+n,f[g++]=v+n+1;f[g++]=v+u-1,f[g++]=v}var C=u*(h-1);for(n=1;n<c+1;++n)f[g++]=C,f[g++]=C+n;for(r=0;r<u-2;++r){var _=r*c+1+C,b=(r+1)*c+1+C;for(n=0;n<c-1;++n)f[g++]=b+n,f[g++]=_+n;f[g++]=b+c-1,f[g++]=_+c-1}var w=new m_({position:new d_({componentDatatype:h_.DOUBLE,componentsPerAttribute:3,values:m})});return new p_({attributes:w,indices:f,primitiveType:A_.LINES,boundingSphere:new a_(l_.ZERO,i)})}};var __=Cesium.defaultValue,b_=Cesium.defined,w_=Object.defineProperties,P_=Cesium.DeveloperError,S_=Cesium.Event,x_=Cesium.createMaterialPropertyDescriptor,B_=Cesium.createPropertyDescriptor;function M_(e){this._angle=void 0,this._angleSubscription=void 0,this._radius=void 0,this._radiusSubscription=void 0,this._stack=void 0,this._stackSubscription=void 0,this._slice=void 0,this._sliceSubscription=void 0,this._color=void 0,this._colorSubscription=void 0,this._show=void 0,this._showSubscription=void 0,this._fill=void 0,this._fillSubscription=void 0,this._color=void 0,this._colorSubscription=void 0,this._material=void 0,this._materialSubscription=void 0,this._outline=void 0,this._outlineSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this._shadows=void 0,this._shadowsSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this._definitionChanged=new S_,this._gaze=void 0,this._gazeSubscription=void 0,this.merge(__(e,__.EMPTY_OBJECT))}w_(M_.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:B_("show"),material:x_("material"),fill:B_("fill"),shadows:B_("shadows"),distanceDisplayCondition:B_("distanceDisplayCondition")}),M_.prototype.clone=function(e){return b_(e)?(e.angle=this.angle,e.radius=this.radius,e.stack=this.stack,e.slice=this.slice,e.show=this.show,e.material=this.material,e.color=this.color,e.fill=this.fill,e.outline=this.outline,e.outlineColor=this.outlineColor,e.outlineWidth=this.outlineWidth,e.shadows=this.shadows,e.distanceDisplayCondition=this.distanceDisplayCondition,e.gaze=this.gaze,e):new M_(this)},M_.prototype.merge=function(e){if(!b_(e))throw new P_("source is required.");this.angle=__(this.angle,e.angle),this.radius=__(this.radius,e.radius),this.stack=__(this.stack,e.stack),this.slice=__(this.slice,e.slice),this.show=__(this.show,e.show),this.color=__(this.color,e.color),this.material=__(this.material,e.material),this.fill=__(this.fill,e.fill),this.outline=__(this.outline,e.outline),this.outlineColor=__(this.outlineColor,e.outlineColor),this.outlineWidth=__(this.outlineWidth,e.outlineWidth),this.shadows=__(this.shadows,e.shadows),this.distanceDisplayCondition=__(this.distanceDisplayCondition,e.distanceDisplayCondition),this.gaze=__(this.gaze,e.gaze)};var E_,T_=Cesium.Entity,O_=Cesium.Event,L_=Cesium.ConstantPositionProperty,D_=Cesium.createPropertyDescriptor,I_=Cesium.DistanceDisplayCondition;Cesium.DistanceDisplayConditionGeometryInstanceAttribute;function R_(e){return new L_(e)}function H_(e){e=e||{},this._position=void 0,this._orientation=void 0,this._show=void 0;var t=e.conicArcSensor;t instanceof M_||(t=new M_(t)),this._conicArcSensor=t,this._distanceDisplayCondition=new I_,this._geometry=void 0,this._outlineGeometry=void 0,this._definitionChanged=new O_,this.merge(e)}Object.defineProperties(H_.prototype,{position:(E_="position",D_(E_,void 0,R_)),orientation:D_("orientation"),show:D_("show")}),H_.prototype.merge=function(e){this.position=e.position,this.orientation=e.orientation,this.show=e.show},H_.prototype.gazeAt=function(e){e instanceof T_&&(this._conicArcSensor.gaze=e)};Cesium.defaultValue;var F_=Cesium.defined,N_=(Cesium.Viewer,Cesium.Transforms),Q_=Cesium.DeveloperError,k_=(Cesium.ColorGeometryInstanceAttribute,Cesium.Color),U_=Cesium.Primitive,j_=Cesium.PerInstanceColorAppearance,G_=Cesium.Cartesian3,z_=(Cesium.VertexFormat,Cesium.Quaternion),Y_=Cesium.Matrix3,Z_=Cesium.Matrix4,W_=Cesium.Property;Cesium.Event,Cesium.DistanceDisplayCondition,Cesium.DistanceDisplayConditionGeometryInstanceAttribute;function X_(e){var t=this;if(!F_(e))throw new Q_("viewer is required.");this._viewer=e;var i=e.scene;this._scene=i;var r=e.clock;this._clock=r,this._primitives=i.primitives,this._primitive=void 0,this._outlinePrimitive=void 0,this._conicArcSensorCollection=[],r.onTick.addEventListener((function(){t.update()}))}var J_=new Y_,K_=new Z_,V_=new G_,q_=new G_,$_=new G_,eb=new z_;X_.prototype.add=function(e){return e instanceof H_||(e=new H_(e)),this._conicArcSensorCollection.push(e),e},X_.prototype.remove=function(e){var t=this._conicArcSensorCollection.indexOf(e);-1!==t&&this._conicArcSensorCollection.splice(t,1)},X_.prototype.removeAll=function(){this._conicArcSensorCollection.length=0},X_.prototype.update=function(){var e=this._clock.currentTime,t=this._conicArcSensorCollection,i=this._primitives,r=this._primitive,n=this._outlinePrimitive,o=[],s=[];F_(r)&&i.removeAndDestroy(r),F_(n)&&i.removeAndDestroy(n);for(var a=0,l=t.length;a<l;a++){var h=t[a],c=h._conicArcSensor;if(W_.getValueOrDefault(c.show,e,!0)){var u=c.angle,p=c.radius,d=c.stack,m=c.slice;if(F_(u))if(W_.getValueOrDefault(h.show,e,!0)){var f=W_.getValueOrUndefined(h.position,e,V_);if(F_(f)){var g,A=c.gaze;if(F_(A)){var y=W_.getValueOrUndefined(A.position,e,q_);if(!F_(f)||!F_(y))continue;var v=G_.subtract(f,y,$_),C=G_.angleBetween(Cesium.Cartesian3.UNIT_Z,v),_=G_.cross(Cesium.Cartesian3.UNIT_Z,v,$_),b=z_.fromAxisAngle(_,C,eb),w=G_.distance(f,y);p=1,g=Z_.fromRotationTranslation(Cesium.Matrix3.multiplyByScalar(Y_.fromQuaternion(b,J_),w,J_),f,K_)}else{b=W_.getValueOrUndefined(h.orientation,e,eb);g=F_(b)?Z_.fromRotationTranslation(Y_.fromQuaternion(b,J_),f,K_):N_.eastNorthUpToFixedFrame(f,void 0,K_)}if(F_(g)){var P,S=h._geometry;if(!F_(S))P=new s_({vertexFormat:Cesium.VertexFormat.POSITION_AND_NORMAL,angle:u,radius:p,stackPartitions:d,slicePartitions:m}),h._geometry=s_.createGeometry(P),S=h._geometry;var x=c.color,B=c.outline,M=c.outlineWidth;F_(M)||(M=1);var E=c.outlineColor;F_(E)||(E=k_.WHITE);var T=new Cesium.GeometryInstance({geometry:S,modelMatrix:g,attributes:{color:Cesium.ColorGeometryInstanceAttribute.fromColor(x)}});if(o.push(T),B){var O,L=h._outlineGeometry;if(!F_(L))O=new C_({vertexFormat:Cesium.VertexFormat.POSITION_ONLY,angle:u,radius:p}),h._outlineGeometry=C_.createGeometry(O),L=h._outlineGeometry;T=new Cesium.GeometryInstance({geometry:L,modelMatrix:g,attributes:{color:Cesium.ColorGeometryInstanceAttribute.fromColor(E)}});s.push(T)}}}}}}o.length>0&&(this._primitive=this._primitives.add(new U_({asynchronous:!1,geometryInstances:o,appearance:new j_({flat:!1,translucent:!0,closed:!0})}))),s.length>0&&(this._outlinePrimitive=this._primitives.add(new U_({asynchronous:!1,geometryInstances:s,appearance:new j_({flat:!0,translucent:!0,renderState:{lineWidth:this._scene.clampLineWidth(M)}})})))},Cesium.RectangularSensorPrimitive=AC,Cesium.RectangularSensorGraphics=wC.RectangularSensorGraphics,Cesium.RectangularSensorVisualizer=GC,Cesium.ConicArcSensorGeometry=s_,Cesium.ConicArcSensorOutlineGeometry=C_,Cesium.ConicArcSensorGraphics=M_,Cesium.ConicArcSensorCollection=X_;var tb=Cesium.DataSourceDisplay,ib=tb.defaultVisualizersCallback;tb.defaultVisualizersCallback=function(e,t,i){var r=i.entities;return ib(e,t,i).concat([new GC(e,r)])};let rb=Cesium.Color,nb=Cesium.defaultValue,ob=Cesium.defined,sb=Object.defineProperties,ab=Cesium.Event,lb=Cesium.createPropertyDescriptor,hb=Cesium.Property,cb=Cesium.Material,ub=rb.WHITE;function pb(e){e=nb(e,nb.EMPTY_OBJECT),this._definitionChanged=new ab,this._color=void 0,this._colorSubscription=void 0,this.color=e.color,this.duration=e.duration||1e3,this._time=void 0}sb(pb.prototype,{isConstant:{get:function(){return!1}},definitionChanged:{get:function(){return this._definitionChanged}},color:lb("color")}),pb.prototype.getType=function(e){return cb.PolylineAttackLinkType},pb.prototype.getValue=function(e,t){return ob(t)||(t={}),t.color=hb.getValueOrClonedDefault(this._color,e,ub,t.color),t.image=cb.PolylineAttackLinkImage,void 0===this._time&&(this._time=e.secondsOfDay),t.time=1e3*(e.secondsOfDay-this._time)/this.duration,t},pb.prototype.equals=function(e){return this===e||e instanceof pb&&hb.equals(this._color,e._color)};let db=Cesium.Color,mb=Cesium.defaultValue,fb=Cesium.defined,gb=Object.defineProperties,Ab=Cesium.Event,yb=Cesium.createPropertyDescriptor,vb=Cesium.Property,Cb=Cesium.Material,_b=db.WHITE;function bb(e){e=mb(e,mb.EMPTY_OBJECT),this._definitionChanged=new Ab,this._color=void 0,this._colorSubscription=void 0,this.color=e.color,this.duration=e.duration||1e3,this._time=void 0}gb(bb.prototype,{isConstant:{get:function(){return!1}},definitionChanged:{get:function(){return this._definitionChanged}},color:yb("color")}),bb.prototype.getType=function(e){return Cb.PolylineArrowLinkType},bb.prototype.getValue=function(e,t){return fb(t)||(t={}),t.color=vb.getValueOrClonedDefault(this._color,e,_b,t.color),t.image=Cb.PolylineArrowLinkImage,void 0===this._time&&(this._time=e.secondsOfDay),t.time=1e3*(e.secondsOfDay-this._time)/this.duration,t},bb.prototype.equals=function(e){return this===e||e instanceof bb&&vb.equals(this._color,e._color)};let wb=Cesium.Color,Pb=Cesium.defaultValue,Sb=Cesium.defined,xb=Object.defineProperties,Bb=Cesium.Event,Mb=Cesium.createPropertyDescriptor,Eb=Cesium.Property,Tb=Cesium.Material,Ob=wb.WHITE;function Lb(e){e=Pb(e,Pb.EMPTY_OBJECT),this._definitionChanged=new Bb,this._color=void 0,this._colorSubscription=void 0,this.color=e.color}xb(Lb.prototype,{isConstant:{get:function(){return!1}},definitionChanged:{get:function(){return this._definitionChanged}},color:Mb("color")}),Lb.prototype.getType=function(e){return Tb.PolylineGlowLinkType},Lb.prototype.getValue=function(e,t){return Sb(t)||(t={}),t.color=Eb.getValueOrClonedDefault(this._color,e,Ob,t.color),t},Lb.prototype.equals=function(e){return this===e||e instanceof Lb&&Eb.equals(this._color,e._color)};let Db=Cesium.Color,Ib=Cesium.defaultValue,Rb=Cesium.defined,Hb=Object.defineProperties,Fb=Cesium.Event,Nb=Cesium.createPropertyDescriptor,Qb=Cesium.Property,kb=Cesium.Material,Ub=Db.WHITE;function jb(e){e=Ib(e,Ib.EMPTY_OBJECT),this._definitionChanged=new Fb,this._color=void 0,this._colorSubscription=void 0,this.color=e.color,this.duration=e.duration||1e3,this._time=void 0}Hb(jb.prototype,{isConstant:{get:function(){return!1}},definitionChanged:{get:function(){return this._definitionChanged}},color:Nb("color")}),jb.prototype.getType=function(e){return kb.PolylinePulseLinkType},jb.prototype.getValue=function(e,t){return Rb(t)||(t={}),t.color=Qb.getValueOrClonedDefault(this._color,e,Ub,t.color),t.image=kb.PolylinePulseLinkImage,void 0===this._time&&(this._time=e.secondsOfDay),t.time=1e3*(e.secondsOfDay-this._time)/this.duration,t},jb.prototype.equals=function(e){return this===e||e instanceof jb&&Qb.equals(this._color,e._color)};let Gb=Cesium.Color,zb=Cesium.defaultValue,Yb=Cesium.defined,Zb=Object.defineProperties,Wb=Cesium.Event,Xb=Cesium.createPropertyDescriptor,Jb=Cesium.Property,Kb=Cesium.Material,Vb=Gb.WHITE;function qb(e){e=zb(e,zb.EMPTY_OBJECT),this._definitionChanged=new Wb,this._color=void 0,this._colorSubscription=void 0,this.color=e.color,this.duration=e.duration||1e3,this._time=void 0}Zb(qb.prototype,{isConstant:{get:function(){return!1}},definitionChanged:{get:function(){return this._definitionChanged}},color:Xb("color")}),qb.prototype.getType=function(e){return Kb.PolylineTrailLinkType},qb.prototype.getValue=function(e,t){return Yb(t)||(t={}),t.color=Jb.getValueOrClonedDefault(this._color,e,Vb,t.color),t.image=Kb.PolylineTrailLinkImage,void 0===this._time&&(this._time=e.secondsOfDay),t.time=1e3*(e.secondsOfDay-this._time)/this.duration,t},qb.prototype.equals=function(e){return this===e||e instanceof qb&&Jb.equals(this._color,e._color)};var $b=Cesium.Color,ew=Cesium.defaultValue,tw=Cesium.defined,iw=Object.defineProperties,rw=Cesium.Event,nw=Cesium.createPropertyDescriptor,ow=Cesium.Property,sw=Cesium.Material,aw=$b.WHITE;function lw(e){e=ew(e,ew.EMPTY_OBJECT),this._definitionChanged=new rw,this._color=void 0,this._colorSubscription=void 0,this.color=e.color,this._time=void 0}iw(lw.prototype,{isConstant:{get:function(){return!1}},definitionChanged:{get:function(){return this._definitionChanged}},color:nw("color")}),lw.prototype.getType=function(e){return sw.EllipsoidFadeType},lw.prototype.getValue=function(e,t){return tw(t)||(t={}),t.color=ow.getValueOrClonedDefault(this._color,e,aw,t.color),void 0===this._time&&(this._time=e.secondsOfDay),t.time=e.secondsOfDay-this._time,t},lw.prototype.equals=function(e){return this===e||e instanceof lw&&ow.equals(this._color,e._color)};var hw=i(9272),cw=i.n(hw),uw=(i(1756),i(7413)),pw=i.n(uw),dw=(i(989),i(1932)),mw=i.n(dw),fw=Cesium.Color,gw=(Cesium.ShaderSource,Cesium.Material);gw.PolylineAttackLinkType="PolylineAttackLink",gw.PolylineAttackLinkImage=qh.formatUrlByBaseJs("resources/images/specialLine/DotTransparent.png"),gw._materialCache.addMaterial(gw.PolylineAttackLinkType,{fabric:{type:gw.PolylineAttackLinkType,uniforms:{color:new fw(1,0,0,1),image:gw.PolylineAttackLinkImage,time:0},source:cw()},translucent:function(){return!0}}),gw.PolylineArrowLinkType="PolylineArrowLink",gw.PolylineArrowLinkImage=qh.formatUrlByBaseJs("resources/images/specialLine/ArrowOpacity.png"),gw._materialCache.addMaterial(gw.PolylineArrowLinkType,{fabric:{type:gw.PolylineArrowLinkType,uniforms:{color:new fw(1,0,0,1),image:gw.PolylineArrowLinkImage,time:0},source:cw()},translucent:function(){return!0}}),gw.PolylinePulseLinkType="PolylinePulseLink",gw.PolylinePulseLinkImage=qh.formatUrlByBaseJs("resources/images/specialLine/LinkPulse.png"),gw._materialCache.addMaterial(gw.PolylinePulseLinkType,{fabric:{type:gw.PolylinePulseLinkType,uniforms:{color:new fw(1,0,0,1),image:gw.PolylinePulseLinkImage,time:0},source:cw()},translucent:function(){return!0}}),gw.PolylineGlowLinkType="PolylineGlowLinkType",gw._materialCache.addMaterial(gw.PolylineGlowLinkType,{fabric:{type:gw.PolylineGlowLinkType,uniforms:{glowPower:.1,color:new fw(1,0,0,1)},source:pw()},translucent:function(){return!0}}),gw.PolylineTrailLinkType="PolylineTrailLinkType",gw.PolylineTrailLinkImage=qh.formatUrlByBaseJs("resources/images/specialLine/Trail.png"),gw._materialCache.addMaterial(gw.PolylineTrailLinkType,{fabric:{type:gw.PolylineTrailLinkType,uniforms:{color:new fw(1,0,0,1),image:gw.PolylineTrailLinkImage,time:0},source:cw()},translucent:function(){return!0}}),gw.EllipsoidFadeType="EllipsoidFade",gw._materialCache.addMaterial(gw.EllipsoidFadeType,{fabric:{type:gw.EllipsoidFadeType,uniforms:{color:new fw(1,0,0,1),time:1},source:mw()},translucent:function(){return!0}}),Cesium.PolylineAttackLinkMaterialProperty=pb,Cesium.PolylineArrowLinkMaterialProperty=bb,Cesium.PolylineGlowLinkMaterialProperty=Lb,Cesium.PolylinePulseLinkMaterialProperty=jb,Cesium.PolylineTrailLinkMaterialProperty=qb,Cesium.ElliposidFadeMaterialProperty=lw;Cesium.getLinkedPointList=function(e,t,i,r){var n=[],o=Cesium.Cartographic.fromCartesian(e),s=Cesium.Cartographic.fromCartesian(t),a=180*o.longitude/Math.PI,l=180*o.latitude/Math.PI,h=180*s.longitude/Math.PI,c=180*s.latitude/Math.PI,u=Math.sqrt((a-h)*(a-h)+(l-c)*(l-c))*i,p=Cesium.Cartesian3.clone(e),d=Cesium.Cartesian3.clone(t),m=Cesium.Cartesian3.distance(p,Cesium.Cartesian3.ZERO),f=Cesium.Cartesian3.distance(d,Cesium.Cartesian3.ZERO);if(Cesium.Cartesian3.normalize(p,p),Cesium.Cartesian3.normalize(d,d),0==Cesium.Cartesian3.distance(p,d))return n;var g=Cesium.Cartesian3.angleBetween(p,d);n.push(e);for(var A=1;A<r-1;A++){var y=1*A/(r-1),v=1-y,C=Math.sin(v*g)/Math.sin(g),_=Math.sin(y*g)/Math.sin(g),b=Cesium.Cartesian3.multiplyByScalar(p,C,new Cesium.Cartesian3),w=Cesium.Cartesian3.multiplyByScalar(d,_,new Cesium.Cartesian3),P=Cesium.Cartesian3.add(b,w,new Cesium.Cartesian3),S=y*Math.PI,x=m*v+f*y+Math.sin(S)*u;P=Cesium.Cartesian3.multiplyByScalar(P,x,P),n.push(P)}return n.push(t),n};var Aw={BaiduImageryProvider:vv,PlaceNameTile:Mv,PlaceNameTileOpt:class{url;table;styles;constructor(e,t,i){this.url=e,this.table=t,this.styles=i}},PlaceFontStyle:Ev,VectorModelTileOpt:class{url;layer;minLevel;maxLevel;isPick;pickedColor;baseScreenSpaceError=1024;maximumScreenSpaceError=64;skipScreenSpaceErrorFactor=16;skipLevels=1;immediatelyLoadDesiredLevelOfDetail=!1;loadSiblings=!0;cullWithChildrenBounds=!0;cullRequestsWhileMoving=!0;cullRequestsWhileMovingMultiplier=10;preloadWhenHidden=!0;preferLeaves=!0;maximumMemoryUsage=512;progressiveResolutionHeightFraction=.5;dynamicScreenSpaceErrorDensity=1;dynamicScreenSpaceErrorFactor=1;dynamicScreenSpaceError=!0;customShader;constructor(e){this.url=e.url,this.layer=e.layer,this.minLevel=e.minLevel,this.maxLevel=e.maxLevel,this.isPick=e.isPick,this.pickedColor=e.pickedColor,this.baseScreenSpaceError=e.baseScreenSpaceError,this.maximumScreenSpaceError=e.maximumScreenSpaceError,this.skipScreenSpaceErrorFactor=e.skipScreenSpaceErrorFactor,this.skipLevels=e.skipLevels,this.immediatelyLoadDesiredLevelOfDetail=e.immediatelyLoadDesiredLevelOfDetail,this.loadSiblings=e.loadSiblings,this.cullWithChildrenBounds=e.cullWithChildrenBounds,this.cullRequestsWhileMoving=e.cullRequestsWhileMoving,this.cullRequestsWhileMovingMultiplier=e.cullRequestsWhileMovingMultiplier,this.preloadWhenHidden=e.preloadWhenHidden,this.preferLeaves=e.preferLeaves,this.maximumMemoryUsage=e.maximumMemoryUsage,this.progressiveResolutionHeightFraction=e.progressiveResolutionHeightFraction,this.dynamicScreenSpaceErrorDensity=e.dynamicScreenSpaceErrorDensity,this.dynamicScreenSpaceErrorFactor=e.dynamicScreenSpaceErrorFactor,this.dynamicScreenSpaceError=e.dynamicScreenSpaceError,this.customShader=e.customShader,this.shaderType=e.shaderType}},VectorModelTile:Tv,LayerManager:yv};const yw=Aw;let vw;const Cw=function(e){if(vw)return vw;const t=e.baiduMapLayer.prototype.__proto__.constructor,i=e.DataSet;return vw=class extends t{constructor(e,i,r,n){super(e,i,r),t&&(this.map=e,this.scene=e.scene,this.dataSet=i,r=r||{},this.init(r),this.argCheck(r),this.initDevicePixelRatio(),this.canvasLayer=n,this.stopAniamation=!1,this.animation=r.animation,this.clickEvent=this.clickEvent.bind(this),this.mousemoveEvent=this.mousemoveEvent.bind(this),this.bindEvent())}initDevicePixelRatio(){this.devicePixelRatio=window.devicePixelRatio||1}clickEvent(e){var t=e.point;super.clickEvent(t,e)}mousemoveEvent(e){var t=e.point;super.mousemoveEvent(t,e)}addAnimatorEvent(){}animatorMovestartEvent(){var e=this.options.animation;this.isEnabledTime()&&this.animator&&(this.steps.step=e.stepsRange.start)}animatorMoveendEvent(){this.isEnabledTime()&&this.animator}bindEvent(){this.map,this.options.methods&&(this.options.methods.click,this.options.methods.mousemove)}unbindEvent(){var e=this.map;this.options.methods&&(this.options.methods.click&&e.off("click",this.clickEvent),this.options.methods.mousemove&&e.off("mousemove",this.mousemoveEvent))}getContext(){return this.canvasLayer.canvas.getContext(this.context)}init(e){this.options=e,this.initDataRange(e),this.context=this.options.context||"2d",this.options.zIndex&&this.canvasLayer&&this.canvasLayer.setZIndex(this.options.zIndex),this.initAnimator()}_canvasUpdate(e){this.map;var t=this.scene;if(this.canvasLayer&&!this.stopAniamation){var r=this.options.animation,n=this.getContext();if(this.isEnabledTime()){if(void 0===e)return void this.clear(n);"2d"===this.context&&(n.save(),n.globalCompositeOperation="destination-out",n.fillStyle="rgba(0, 0, 0, .1)",n.fillRect(0,0,n.canvas.width,n.canvas.height),n.restore())}else this.clear(n);if("2d"===this.context)for(var o in this.options)n[o]=this.options[o];else n.clear(n.COLOR_BUFFER_BIT);var s={transferCoordinate:function(e){var i=Cesium.Cartesian3.fromDegrees(e[0],e[1]),r=Cesium.SceneTransforms.wgs84ToWindowCoordinates(t,i);return null==r?[-1,-1]:[r.x,r.y]}};void 0!==e&&(s.filter=function(t){var i=r.trails||10;return!!(e&&t.time>e-i&&t.time<e)});var a=this.dataSet.get(s);this.processData(a),"m"==this.options.unit&&this.options.size,this.options._size=this.options.size;var l=Cesium.SceneTransforms.wgs84ToWindowCoordinates(t,Cesium.Cartesian3.fromDegrees(0,0));this.drawContext(n,new i(a),this.options,l),this.options.updateCallback&&this.options.updateCallback(e)}}updateData(e,t){var i=e;i&&i.get&&(i=i.get()),null!=i&&this.dataSet.set(i),super.update({options:t})}addData(e,t){var i=e;e&&e.get&&(i=e.get()),this.dataSet.add(i),this.update({options:t})}getData(){return this.dataSet}removeData(e){if(this.dataSet){var t=this.dataSet.get({filter:function(t){return null==e||"function"!=typeof e||!e(t)}});this.dataSet.set(t),this.update({options:null})}}clearData(){this.dataSet&&this.dataSet.clear(),this.update({options:null})}draw(){this.canvasLayer.draw()}clear(e){e&&e.clearRect&&e.clearRect(0,0,e.canvas.width,e.canvas.height)}},vw};let _w;const bw=function(){if(!_w&&"undefined"!=typeof mapv){var e=0;const t=Cw(mapv);class i extends h.Z{constructor(e,i,r,n){if(super(),this.map=e,this.scene=e.scene,this.mapvBaseLayer=new t(e,i,r,this),this.disposers.push((()=>{this.removeAllData(),this.mapvBaseLayer.clear(this.mapvBaseLayer.getContext()),this.mapvBaseLayer=void 0})),this.mapVOptions=r,this.devicePixelRatio=window.devicePixelRatio||1,this.canvas=this._createCanvas(),this.disposers.push((()=>{this.canvas.parentElement.removeChild(this.canvas)})),n)this.container=n;else{const t=e.container.querySelector(".cesium-viewer-cesiumWidgetContainer");this.container=t||e.container}this.container.appendChild(this.canvas);var o=new Cesium.ScreenSpaceEventHandler(this.scene.canvas);this.scene.camera.changed.addEventListener(this._reset,this),this.disposers.push((()=>{o.destroy()})),this._reset()}addData(e,t){null!=this.mapvBaseLayer&&this.mapvBaseLayer.addData(e,t)}updateData(e,t){null!=this.mapvBaseLayer&&this.mapvBaseLayer.updateData(e,t)}getData(){return this.mapvBaseLayer&&(this.dataSet=this.mapvBaseLayer.getData()),this.dataSet}removeData(e){null!=this.mapvBaseLayer&&this.mapvBaseLayer&&this.mapvBaseLayer.removeData(e)}removeAllData(){null!=this.mapvBaseLayer&&this.mapvBaseLayer.clearData()}_createCanvas(){var t=document.createElement("canvas");t.id=this.mapVOptions.layerid||"mapv"+e++,t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.style.pointerEvents="none",t.style.zIndex=this.mapVOptions.zIndex||0,t.width=parseInt(this.map.canvas.width),t.height=parseInt(this.map.canvas.height),t.style.width=this.map.canvas.style.width,t.style.height=this.map.canvas.style.height;var i=this.devicePixelRatio;return"2d"==this.mapVOptions.context&&t.getContext(this.mapVOptions.context).scale(i,i),t}_reset(){this.resizeCanvas(),null!=this.mapvBaseLayer&&this.mapvBaseLayer._canvasUpdate()}show(){this._visiable()}hide(){this._unvisiable()}update(e){null!=e&&this.updateData(e.data,e.options)}resizeCanvas(){if(null!=this.canvas&&null!=this.canvas){var e=this.canvas;e.style.position="absolute",e.style.top="0px",e.style.left="0px",e.width=parseInt(this.map.canvas.width),e.height=parseInt(this.map.canvas.height),e.style.width=this.map.canvas.style.width,e.style.height=this.map.canvas.style.height}}}_w=function(e,t,r,n){return new i(e,t,r,n)}}return _w},ww={get mapVLayer(){return bw()}};var Pw=function(){function e(){this.init(),this.clusterSub=new th.x}return e.prototype.init=function(){for(var e=new Cesium.PinBuilder,t=e.fromText("50+",Cesium.Color.BLUE,48).toDataURL(),i=e.fromText("40+",Cesium.Color.BLUE,48).toDataURL(),r=e.fromText("30+",Cesium.Color.BLUE,48).toDataURL(),n=e.fromText("20+",Cesium.Color.BLUE,48).toDataURL(),o=e.fromText("10+",Cesium.Color.BLUE,48).toDataURL(),s=new Array(8),a=0;a<s.length;++a)s[a]=e.fromText(""+(a+2),Cesium.Color.VIOLET,48).toDataURL();var l=this;this.clusterConfig={name:"dd",pixelRange:10,minimumClusterSize:5,enable:!0,customStyleEnable:!0,setImage1:function(e,a){l.clusterSub.next(e),a.billboard.show=!0,a.billboard.id=a.label.id,a.billboard.verticalOrigin=Cesium.VerticalOrigin.BOTTOM;var h=e.length;a.billboard.image=h>=50?t:h>=40?i:h>=30?r:h>=20?n:h>=10?o:s[h-2]},imagePath:"/resources/images/close-common.png"}},e}(),Sw=function(){function e(){this.config={}}return e.prototype.getDeServiceIp=function(){return e.deServiceIp="http://127.0.0.1",e.deServiceIp},e.prototype.getGeopptServiceIp=function(){return e.geopptServiceIp="http://127.0.0.1",e.geopptServiceIp},e.prototype.getUploadFileIp=function(){return e.uploadFileIp="https://test.geoppt.com/pptsvc_dev",e.uploadFileIp},e.prototype.getICenterServerIp=function(){return e.iCenterIp="http://icenter.geovis.online",e.iCenterIp},e.prototype.getGeopptWebUrlIp=function(){return e.geopptWebUrl="https://dev.geoppt.com",e.geopptWebUrl},e.prototype.getGeopptServiceUrlIp=function(){return e.geopptServiceUrl="https://dev.geoppt.com:8001",e.geopptServiceUrl},e.prototype.getTerrainUrlIp=function(){return e.terrainUrl="https://tiles.geovis.online/base/v1/terrain?token=da030867e0c0d54e068e7ed7e21a1b3e8562f0b595394c6cbd928085a4e9ccce",e.terrainUrl},e.prototype.getGlobalTerrainUrlIp=function(){return e.globalTerrainUrl="https://tiles.geovis.online/base/v1/terrain?token=da030867e0c0d54e068e7ed7e21a1b3e8562f0b595394c6cbd928085a4e9ccce",e.globalTerrainUrl},e.prototype.getPageUrlIp=function(){return e.pageUrl="https://dev.geoppt.com:8001/scene/getScenesById?id=0ca38671-630d-4ae9-b4ee-3a39f390d9b1&isFromPublish=false",e.pageUrl},e.deServiceIp=null,e.saveIp=null,e.geopptServiceIp=null,e.uploadFileIp=null,e.iCenterIp=null,e.geopptWebUrl=null,e.geopptServiceUrl=null,e.terrainUrl=null,e.globalTerrainUrl=null,e.pageUrl=null,e.aliyunIp="https://gvpub.oss-cn-beijing.aliyuncs.com",e}(),xw=i(5877),Bw=i(9298),Mw=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},Ew=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Tw=function(){function e(){this.id=(0,xw.v4)(),this.thumb=null,this.isPublic=!0,this.layerSource="",this.isTop=!1,this.isAni=!1,this._show=!0,this._alpha=1,this._saturation=1,this._contrast=1,this._brightness=1,this._hue=0,this._gamma=1,this._format=void 0,this._currentLevel=0,this._level=0}return Object.defineProperty(e.prototype,"cesiumLayer",{get:function(){return this._cesiumLayer},set:function(e){this._cesiumLayer=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"show",{get:function(){return this._show},set:function(e){this._show=e,this.cesiumLayer&&(this.cesiumLayer.show=e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"alpha",{get:function(){return this._alpha},set:function(e){this._alpha=e,this.cesiumLayer&&(this.cesiumLayer.alpha=e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"saturation",{get:function(){return this._saturation},set:function(e){this._saturation=e,this.cesiumLayer&&(this.cesiumLayer.saturation=e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"contrast",{get:function(){return this._contrast},set:function(e){this._contrast=e,this.cesiumLayer&&(this.cesiumLayer.contrast=e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"brightness",{get:function(){return this._brightness},set:function(e){this._brightness=e,this.cesiumLayer&&(this.cesiumLayer.brightness=e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hue",{get:function(){return this._hue},set:function(e){this._hue=e,this.cesiumLayer&&(this.cesiumLayer.hue=e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"gamma",{get:function(){return this._gamma},set:function(e){this._gamma=e,this.cesiumLayer&&(this.cesiumLayer.gamma=e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"initAttr",{get:function(){return this._initAttr},set:function(e){this._initAttr=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"format",{get:function(){return this._format},set:function(e){this._format=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentLevel",{get:function(){return this.cesiumLayer&&(this._currentLevel=this.cesiumLayer._layerIndex),this._currentLevel},set:function(e){this._currentLevel=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"level",{get:function(){return this._level},set:function(e){this._level=e},enumerable:!1,configurable:!0}),Mw([(0,Bw.h)(),Ew("design:type",Object)],e.prototype,"_cesiumLayer",void 0),Mw([(0,Bw.h)(),Ew("design:type",Object),Ew("design:paramtypes",[Object])],e.prototype,"cesiumLayer",null),Mw([dy({name:"透明度",group:"数据模式",type:"gpLayerSlider",order:2,min:0,max:1}),Ew("design:type",Number),Ew("design:paramtypes",[Number])],e.prototype,"alpha",null),Mw([dy({name:"饱和度",group:"数据模式",type:"gpLayerSlider",order:2,min:0,max:3}),Ew("design:type",Number),Ew("design:paramtypes",[Number])],e.prototype,"saturation",null),Mw([dy({name:"对比度",group:"数据模式",type:"gpLayerSlider",order:2,min:0,max:3}),Ew("design:type",Number),Ew("design:paramtypes",[Number])],e.prototype,"contrast",null),Mw([dy({name:"亮度",group:"数据模式",type:"gpLayerSlider",order:2,min:0,max:3}),Ew("design:type",Number),Ew("design:paramtypes",[Number])],e.prototype,"brightness",null),Mw([dy({name:"色调",group:"数据模式",type:"gpLayerSlider",order:2,min:-3,max:3}),Ew("design:type",Number),Ew("design:paramtypes",[Number])],e.prototype,"hue",null),Mw([dy({name:"伽马",group:"数据模式",type:"gpLayerSlider",order:2,min:0,max:3}),Ew("design:type",Number),Ew("design:paramtypes",[Number])],e.prototype,"gamma",null),Mw([dy({name:"恢复默认",group:"数据模式",type:"defaultAttr",hiddenGroupName:!0}),Ew("design:type",Object),Ew("design:paramtypes",[Object])],e.prototype,"initAttr",null),Mw([dy({name:"图层格式",group:"数据模式",order:8,type:"formatConversion",options:[{label:"png",value:"png"},{label:"webp",value:"webp"},{label:"jpg",value:"jpg"}]}),Ew("design:type",Object),Ew("design:paramtypes",[Object])],e.prototype,"format",null),Mw([dy({name:"当前层级",group:"层级显示",type:"levelText",order:2,min:0,max:1}),Ew("design:type",Number),Ew("design:paramtypes",[Number])],e.prototype,"currentLevel",null),Mw([dy({name:"层级调整",group:"层级显示",type:"levelButton",order:2,min:0,max:1}),Ew("design:type",Number),Ew("design:paramtypes",[Number])],e.prototype,"level",null),e}(),Ow=function(){function e(){}return e.register=function(e){this._cachesTif.set(e.id,e)},e.getGp=function(e){return this._cachesTif.get(e)},e._cachesTif=new Map,e}(),Lw=i(5108),Dw=function(){return Dw=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},Dw.apply(this,arguments)},Iw=function(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var r,n,o=i.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){n={error:e}}finally{try{r&&!r.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}return s},Rw=function(e,t,i){if(i||2===arguments.length)for(var r,n=0,o=t.length;n<o;n++)!r&&n in t||(r||(r=Array.prototype.slice.call(t,0,n)),r[n]=t[n]);return e.concat(r||Array.prototype.slice.call(t))},Hw=function(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],r=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Fw=function(){function e(e){this.attrList=["show","alpha","saturation","contrast","brightness","hue"],this.isRefresh$=new th.x,this.gpList=[],this.serviceManager=e,this.viewer=e.viewer}return e.prototype.setCurrentBigfile=function(e,t){void 0===t&&(t=!1),this.currentFile=e,t&&this.isRefresh$.next(e)},e.prototype.cleanAll=function(){var e=this;this.gpList.forEach((function(t){var i=t.cesiumLayer;e.viewer.imageryLayers.remove(i)})),this.gpList.splice(0,this.gpList.length)},e.prototype.createGpObject=function(e){var t=new Tw;return t.id=e.id,t.name=e.name,t.type=e.type,t.thumb=e.path,t._src=e.original_url,t.cesiumLayer=e.layer,t.isAni=!0,t.serviceInfo=e.serviceInfo?e.serviceInfo:e.service_info,this.attrList.concat("currentLevel").forEach((function(i){void 0!==e["_".concat(i)]?t[i]=e["_".concat(i)]:"show"===i?t.show=!0:"hue"===i?t.hue=0:t[i]=1})),Ow.register(t),t},e.prototype.createGpObjectNoLayer=function(e){var t=new Tw;return t.id=e.id,t.name=e.name,t.type=e.type,t.thumb=e.thumb,t._src=e._src,t.isAni=!0,t.serviceInfo=e.serviceInfo?e.serviceInfo:e.service_info,this.attrList.concat("currentLevel").forEach((function(i){void 0!==e["_".concat(i)]?t[i]=e["_".concat(i)]:"show"===i?t.show=!0:"hue"===i?t.hue=0:t[i]=1})),Ow.register(t),t},e.prototype.changeLayerAttr=function(e){this.attrList.forEach((function(t){void 0!==e["_".concat(t)]&&(e.cesiumLayer[t]=e["_".concat(t)])}))},e.prototype.changeLevel=function(e){void 0===e&&(e="up")},e.prototype.getLayer=function(e,t,i){var r,n,o=this.viewer;if("mbtiles"===t)n=new Cesium.UrlTemplateImageryProvider({url:e.url,maximumLevel:Number(null==e?void 0:e.maxZoom),minimumLevel:Number(null==e?void 0:e.minZoom),tilingScheme:new Cesium.GeographicTilingScheme});else if("shp"===t)n=new Cesium.UrlTemplateImageryProvider({url:e.url});else if("tif"===t)if((null===(r=null==i?void 0:i.metaInfo)||void 0===r?void 0:r.bounds)&&parseFloat(null==i?void 0:i.maxZoom)>=0&&parseFloat(null==i?void 0:i.minZoom)>=0){var s=i.metaInfo.bounds.split(",");n=new Cesium.UrlTemplateImageryProvider({url:e.url,rectangle:Cesium.Rectangle.fromDegrees(Number(s[0]),Number(s[1]),Number(s[2]),Number(s[3])),maximumLevel:i.maxZoom,minimumLevel:i.minZoom})}else n=new Cesium.UrlTemplateImageryProvider({url:e.url});return o.imageryLayers.addImageryProvider(n)},e.prototype.draw=function(e,t){var i;void 0===t&&(t=!0),Lw.log("画大文件plot>>>",e);var r,n=this.viewer;if(!e.service_info&&e.serviceInfo&&(e.service_info=e.serviceInfo),r=e.service_info&&"mbtiles"===e.service_info.type?this.getLayer({url:e.service_info.serviceUrl,maxZoom:e.service_info.metaInfo.maxZoom,minZoom:e.service_info.minZoom},"mbtiles"):e.service_info&&"shp"===e.service_info.type?this.getLayer({url:e.service_info.serviceUrl},"shp"):this.getLayer({url:e.service_info.serviceUrl,maxZoom:e.service_info.maxZoom,minZoom:e.service_info.minZoom},"tif"),n.camera.setView({destination:(i=Cesium.Rectangle).fromDegrees.apply(i,Rw([],Iw(e.service_info.metaInfo.bounds.split(",")),!1))}),!(this.gpList.length>0&&this.gpList.find((function(t){return t.id===e.id})))){var o=this.createGpObject(Dw(Dw({},e),{layer:r}));return this.gpList.push(o),t&&this.isRefresh$.next(o),this.currentFile=o,o}},e.prototype.initListData=function(e){var t=this.createGpObjectNoLayer(Dw({},e));this.gpList.length>0&&this.gpList.find((function(t){return t.id===e.id}))||this.gpList.push(t)},e.prototype.getListDataToSave=function(){return Lw.log("ttt",this.gpList),this.gpList&&this.gpList.length>0?my.ZP.serialize(this.gpList):null},e.prototype.setListByData=function(e){var t,i,r,n=this;if(e&&e.length>0){try{for(var o=Hw(e),s=o.next();!s.done;s=o.next()){var a=s.value;this.initListData(a)}}catch(e){t={error:e}}finally{try{s&&!s.done&&(i=o.return)&&i.call(o)}finally{if(t)throw t.error}}this.gpList.sort((function(e,t){return e.currentLevel-t.currentLevel})),Lw.log("gplist>>>",this.gpList),this.gpList.forEach((function(e){var t;t="mbtiles"===e.serviceInfo.type?n.getLayer({url:e.serviceInfo.serviceUrl,maxZoom:e.serviceInfo.metaInfo.maxZoom},"mbtiles"):"shp"===e.serviceInfo.type?n.getLayer({url:e.serviceInfo.serviceUrl},"shp"):n.getLayer({url:e.serviceInfo.serviceUrl},"tif",e.serviceInfo),e.cesiumLayer=t}));var l=this.gpList[0];Lw.log("layer count>>>",this.viewer.imageryLayers.length),this.viewer.camera.setView({destination:(r=Cesium.Rectangle).fromDegrees.apply(r,Rw([],Iw(l.serviceInfo.metaInfo.bounds.split(",")),!1))})}},e.prototype.del=function(e){var t=this.viewer,i=this.gpList.findIndex((function(t){return t.id===e.id}));i>=-1&&this.gpList.splice(i,1),t.imageryLayers.remove(e.cesiumLayer)},e}(),Nw=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Qw=function(e,t,i,r,n,o){void 0===o&&(o=""),this.error=!1,this.parentList=[],this.geojsonDataSource=e,this.title=i,this.type=t,this.group=r,this.subGroup=n,this.min=o},kw=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Nw(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this._value},set:function(e){var t=this;this._value=e,this.geojsonDataSource.entities.values.forEach((function(e){return e.polygon[t.propKey]=t.getPropValue(t._value)}))},enumerable:!1,configurable:!0}),t.prototype.getPropValue=function(e){return e},t}(Qw),Uw=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Nw(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this._value},set:function(e){this._value=e,this.geojsonDataSource.show=e},enumerable:!1,configurable:!0}),t}(Qw),jw=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Nw(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this._value},set:function(e){var t=this;this._value=e;var i=this.parentList.find((function(e){return"虚线"===e.title}));if(i&&!0===i.value){var r=this.parentList.find((function(e){return"虚线长度"===e.title}));this.geojsonDataSource.entities.values.forEach((function(e){return e.polyline.material=new Cesium.PolylineDashMaterialProperty({color:Cesium.Color.fromCssColorString(t._value),dashLength:r?r.value:8})}))}else this.geojsonDataSource.entities.values.forEach((function(e){return e.polyline.material=Cesium.Color.fromCssColorString(t._value)}))},enumerable:!1,configurable:!0}),t}(Qw),Gw=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Nw(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this._value},set:function(e){this._value=e;var t=this.parentList.find((function(e){return"颜色"===e.title}));if(t&&this._value){var i=this.parentList.find((function(e){return"虚线长度"===e.title}));this.geojsonDataSource.entities.values.forEach((function(e){return e.polyline.material=new Cesium.PolylineDashMaterialProperty({color:Cesium.Color.fromCssColorString(t.value),dashLength:i?i.value:8})}))}else this.geojsonDataSource.entities.values.forEach((function(e){return e.polyline.material=Cesium.Color.fromCssColorString(t.value)}))},enumerable:!1,configurable:!0}),t}(Qw),zw=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Nw(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this._value},set:function(e){var t=this;if(this.parentList.find((function(e){return"虚线"===e.title})).value){var i=this.parentList.find((function(e){return"颜色"===e.title}));this.geojsonDataSource.entities.values.forEach((function(e){return e.polyline.material=new Cesium.PolylineDashMaterialProperty({color:Cesium.Color.fromCssColorString(i.value),dashLength:t._value})}))}},enumerable:!1,configurable:!0}),t}(Qw),Yw=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Nw(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this._value},set:function(e){var t=this;this._value=e,this.geojsonDataSource.entities.values.forEach((function(e){return e.polyline.clampToGround=t._value}))},enumerable:!1,configurable:!0}),t}(Qw),Zw=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Nw(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this._value},set:function(e){var t=this;this._value=e,this.geojsonDataSource.entities.values.forEach((function(e){return e.polyline.width=Number.parseInt(t._value)}))},enumerable:!1,configurable:!0}),t}(Qw),Ww=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Nw(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this._value},set:function(e){var t=this;this._value=e,this.geojsonDataSource.entities.values.forEach((function(e){return e.point.color=Cesium.Color.fromCssColorString(t._value)}))},enumerable:!1,configurable:!0}),t}(Qw),Xw=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Nw(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this._value},set:function(e){var t=this;this._value=e,this.geojsonDataSource.entities.values.forEach((function(e){return e.point.outlineColor=Cesium.Color.fromCssColorString(t._value)}))},enumerable:!1,configurable:!0}),t}(Qw),Jw=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Nw(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this._value},set:function(e){var t=this;this._value=e,this.geojsonDataSource.entities.values.forEach((function(e){return e.point.outlineWidth=Number.parseInt(t._value)}))},enumerable:!1,configurable:!0}),t}(Qw),Kw=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Nw(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this._value},set:function(e){var t=this;this._value=e,this.geojsonDataSource.entities.values.forEach((function(e){return e.polygon.outlineColor=Cesium.Color.fromCssColorString(t._value)}))},enumerable:!1,configurable:!0}),t}(Qw),Vw=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}Nw(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this._value},set:function(e){var t=this;this._value=e,this.geojsonDataSource.entities.values.forEach((function(e){return e.polygon.outlineWidth=Number.parseInt(t._value)}))},enumerable:!1,configurable:!0})}(Qw),function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.propKey="heightReference",t}return Nw(t,e),t}(kw)),qw=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.propKey="fill",t}return Nw(t,e),t}(kw),$w=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.propKey="material",t}return Nw(t,e),t.prototype.getPropValue=function(e){return Cesium.Color.fromCssColorString(e)},t}(kw),eP=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Nw(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this._value},set:function(e){var t=this;this._value=e,this.geojsonDataSource.entities.values.forEach((function(e){return e.billboard.color=Cesium.Color.fromCssColorString(t._value)}))},enumerable:!1,configurable:!0}),t}(Qw),tP=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Nw(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this._value},set:function(e){var t=this;this._value=e,this.geojsonDataSource.entities.values.forEach((function(e){return e.billboard.height=Number.parseInt(t._value)}))},enumerable:!1,configurable:!0}),t}(Qw),iP=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Nw(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this._value},set:function(e){var t=this;this._value=e,this.geojsonDataSource.entities.values.forEach((function(e){return e.billboard.width=Number.parseInt(t._value)}))},enumerable:!1,configurable:!0}),t}(Qw),rP=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Nw(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this._value},set:function(e){var t=this;this._value=e,this.geojsonDataSource.entities.values.forEach((function(e){return e.billboard.scale=Number.parseInt(t._value)}))},enumerable:!1,configurable:!0}),t}(Qw),nP=function(){function e(e){this.groupName=e,this.items=[],this.subGroups=[],this.state=!0}return e.prototype.toggle=function(){this.state=!this.state},e}(),oP=function(e){this.subgroupName=e,this.items=[]},sP=function(e,t){this.key=e,this.value=t},aP=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},lP=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},hP=function(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],r=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},cP=function(){function e(e,t,i,r){this.name="",this.groups=[],this._show=!0,this.styleArrayToSave=[],this.styleList=[],this.id=i||Yy.newGuid(),this.fileContent=e,this.name=t,this.icon=r}return Object.defineProperty(e.prototype,"show",{get:function(){return this._show},set:function(e){this._show=e,this.cesiumDataSource.show=this._show},enumerable:!1,configurable:!0}),e.prototype.getStyleArrayToSave=function(){var e,t;this.styleArrayToSave=[];try{for(var i=hP(this.styleList),r=i.next();!r.done;r=i.next()){var n=r.value;this.styleArrayToSave.push(new sP(n.title,n.value))}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}},e.prototype.initStyleList=function(){var e,t,i=this,r=this.cesiumDataSource;if("polyline"===this.entityType)if(this.styleList=[new Uw(r,"boolean","显示","外观","显示"),new jw(r,"color","颜色","外观","颜色"),new Zw(r,"number","宽度","外观","宽度","1"),new Gw(r,"boolean","虚线","外观","虚线","1"),new zw(r,"number","虚线长度","外观","虚线","1"),new Yw(r,"boolean","贴地","外观","贴地")],this.styleList.forEach((function(e){return e.parentList=i.styleList})),this.styleArrayToSave&&this.styleArrayToSave.length>0){var n=function(e){var t=o.styleList.find((function(t){return t.title===e.key}));t&&(t.value=e.value)},o=this;try{for(var s=hP(this.styleArrayToSave),a=s.next();!a.done;a=s.next()){n(a.value)}}catch(t){e={error:t}}finally{try{a&&!a.done&&(t=s.return)&&t.call(s)}finally{if(e)throw e.error}}}else this.styleList.forEach((function(e){switch(e.title){case"颜色":e.value="#ffeb3b";break;case"宽度":e.value="1";break;case"虚线":case"贴地":e.value=!1;break;case"虚线长度":e.value=8;break;case"显示":e.value=!0}}));else if("point"===this.entityType)this.styleList=[new Ww(r,"color","颜色","外观","颜色"),new Jw(r,"borderwidth","边框宽度","外观","边框宽度","1"),new Xw(r,"color","边框颜色","外观","边框颜色")],this.styleList.forEach((function(e){return e.parentList=i.styleList})),this.styleList.forEach((function(e){switch(e.title){case"颜色":case"边框颜色":e.value="#ffeb3b";break;case"边框宽度":e.value="0"}}));else if("polygon"===this.entityType){var l=new Vw(r,"option","高程选项","位置","贴地");l.options=$A.heightReferenceOption,this.styleList=[new Uw(r,"boolean","显示","外观","显示"),new Kw(r,"color","边框颜色","外观","颜色"),l,new qw(r,"boolean","填充","填充","填充"),new $w(r,"color","填充色","填充","填充")],this.styleList.forEach((function(e){return e.parentList=i.styleList})),this.styleList.forEach((function(e){switch(e.title){case"边框颜色":case"填充色":e.value="#ffeb3b";break;case"边框宽度":e.value="1";break;case"显示":e.value=!0}}))}else"billboard"===this.entityType&&(this.styleList=[new eP(r,"color","颜色","外观","颜色"),new tP(r,"number","高度","大小",""),new iP(r,"number","宽度","大小",""),new rP(r,"number","缩放","大小","")],this.styleList.forEach((function(e){return e.parentList=i.styleList})),this.styleList.forEach((function(e){switch(e.title){case"颜色":e.value="yellow";break;case"高度":case"宽度":e.value="30";break;case"缩放":e.value="1"}})))},aP([(0,Bw.h)(),lP("design:type",Array)],e.prototype,"groups",void 0),aP([(0,Bw.h)(),lP("design:type",Object)],e.prototype,"cesiumDataSource",void 0),aP([(0,Bw.h)(),lP("design:type",Array)],e.prototype,"styleList",void 0),e}(),uP=i(9755),pP=i(5108),dP=function(e,t,i,r){return new(i||(i=Promise))((function(n,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?n(e.value):function(e){return e instanceof i?e:new i((function(t){t(e)}))}(e.value).then(s,a)}l((r=r.apply(e,t||[])).next())}))},mP=function(e,t){var i,r,n,o,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,r&&(n=2&o[0]?r.return:o[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,o[1])).done)return n;switch(r=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(n=s.trys,(n=n.length>0&&n[n.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){s.label=o[1];break}if(6===o[0]&&s.label<n[1]){s.label=n[1],n=o;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(o);break}n[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{i=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},fP=function(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],r=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},gP=function(){function e(e){this.entityTypeEnum=["polygon","polyline","billboard"],this.geojsonList=[],this.isEditing=!1,this.onGeojsonCreated=new th.x,this._viewer=e}return Object.defineProperty(e.prototype,"viewer",{get:function(){return this._viewer},enumerable:!1,configurable:!0}),e.prototype.addPlot=function(e,t){return dP(this,void 0,void 0,(function(){var i,r,n,o,s,a,l,h,c,u,p,d=this;return mP(this,(function(m){switch(m.label){case 0:if("geojson"!=e.icon)return[3,2];r=void 0;try{r=JSON.parse(e.fileContent)}catch(e){return alert("json 文件格式不正确"),pP.error(e),this.onGeojsonCreated.next(1),[2]}return[4,Cesium.GeoJsonDataSource.load(r,{clampToGround:!0})];case 1:return i=m.sent(),setTimeout((function(){d.onGeojsonCreated.next(e)}),100),[3,4];case 2:return"kml"!=e.icon?[3,4]:(n=uP.parseXML(e.fileContent),[4,Cesium.KmlDataSource.load(n,{camera:this.viewer.scene.camera,canvas:this.viewer.scene.canvas})]);case 3:i=m.sent(),m.label=4;case 4:return o=this.initDataSource(e,i),[4,this.viewer.dataSources.add(o)];case 5:s=m.sent(),e.cesiumDataSource=s,e.initStyleList(),e.styleArrayToSave.forEach((function(t){var i=e.styleList.find((function(e){return e.title===t.key}));i&&(i.value=t.value)})),a=function(t){if(t.group){var i=e.groups.find((function(e){return e.groupName===t.group}));if(i||(i=new nP(t.group),e.groups.push(i)),t.subGroup){var r=i.subGroups.find((function(e){return e.subgroupName===t.subGroup}));r||(r=new oP(t.subGroup),i.subGroups.push(r)),r.items.push(t)}else i.items.push(t)}};try{for(l=fP(e.styleList),h=l.next();!h.done;h=l.next())c=h.value,a(c)}catch(e){u={error:e}}finally{try{h&&!h.done&&(p=l.return)&&p.call(l)}finally{if(u)throw u.error}}return pP.log("gjplot",e),this.geojsonList.push(e),t&&this.setCurrentGjPlot(e),this.isEditing=!0,[2]}}))}))},e.prototype.initDataSource=function(e,t){var i,r,n,o,s=new Cesium.CustomDataSource(e.id);if(e.id||(e.id=Yy.newGuid()),!e.entityType){var a=t.entities.values[0];try{for(var l=fP(this.entityTypeEnum),h=l.next();!h.done;h=l.next()){var c=h.value;if(a[c]){e.entityType=c;break}}}catch(e){i={error:e}}finally{try{h&&!h.done&&(r=l.return)&&r.call(l)}finally{if(i)throw i.error}}}try{for(var u=fP(t.entities.values),p=u.next();!p.done;p=u.next()){var d=p.value;if(d[e.entityType]){var m={};switch(e.entityType){case"polygon":m={polygon:{hierarchy:d.polygon.hierarchy}};break;case"polyline":m={polyline:{positions:d.polyline.positions}};break;case"billboard":m={billboard:d.billboard,position:d.position}}s.entities.add(m),s.addedGJPlot=e}}}catch(e){n={error:e}}finally{try{p&&!p.done&&(o=u.return)&&o.call(u)}finally{if(n)throw n.error}}return s},e.prototype.clearGjPlot=function(){var e=this;this.geojsonList.forEach((function(t){return e.viewer.dataSources.remove(t.cesiumDataSource)})),this.geojsonList=[]},e.prototype.deleteGjPlot=function(e){this.viewer.dataSources.remove(e.cesiumDataSource),ty.Remove(this.geojsonList,e)},e.prototype.deleteGjList=function(e){var t,i,r=this;this.currentGeojson&&(e.find((function(e){return e.id===r.currentGeojson.id}))&&(this.currentGeojson=null));var n=function(e){var t=o.geojsonList.find((function(t){return t.id===e.id}));t&&o.deleteGjPlot(t)},o=this;try{for(var s=fP(e),a=s.next();!a.done;a=s.next()){n(a.value)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(i=s.return)&&i.call(s)}finally{if(t)throw t.error}}},e.prototype.setCurrentGjPlot=function(e,t){void 0===t&&(t=!1),this.currentGeojson=e},e.prototype.getListDataToSave=function(){return this.geojsonList.forEach((function(e){return e.getStyleArrayToSave()})),this.geojsonList&&this.geojsonList.length>0?my.ZP.serialize(this.geojsonList):null},e.prototype.setListByData=function(e,t){var i,r;try{for(var n=fP(e),o=n.next();!o.done;o=n.next()){var s=o.value,a=new cP(s.fileContent,s.name,s.id,s.icon);a.styleArrayToSave=s.styleArrayToSave,a.entityType=s.entityType,this.addPlot(a,t)}}catch(e){i={error:e}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(i)throw i.error}}},e.prototype.openGeojson=function(e,t){var i=this,r=e.target.files;if(!(r.length<=0)){var n=r[0].name,o=n.slice(0,n.lastIndexOf("."));pP.log("fileNameWithoutExt",o);var s=new FileReader;s.readAsText(r[0],"utf-8"),s.onload=function(r){return dP(i,void 0,void 0,(function(){var i,n;return mP(this,(function(s){switch(s.label){case 0:return i=r.target.result,n=new cP(i,o,"",t),[4,this.addPlot(n,!0)];case 1:return s.sent(),this.currentGeojson=n,e.target.value="",[2]}}))}))}}},e}(),AP=i(9669),yP=i.n(AP),vP=i(5108),CP=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),_P=function(e,t,i,r){return new(i||(i=Promise))((function(n,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?n(e.value):function(e){return e instanceof i?e:new i((function(t){t(e)}))}(e.value).then(s,a)}l((r=r.apply(e,t||[])).next())}))},bP=function(e,t){var i,r,n,o,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,r&&(n=2&o[0]?r.return:o[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,o[1])).done)return n;switch(r=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(n=s.trys,(n=n.length>0&&n[n.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){s.label=o[1];break}if(6===o[0]&&s.label<n[1]){s.label=n[1],n=o;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(o);break}n[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{i=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},wP=function(e){function t(t){var i=e.call(this,t)||this;return i.instance=yP().create(t),i.initInterceptors(),i}return CP(t,e),t.prototype.getData=function(e){return _P(this,void 0,void 0,(function(){var t=this;return bP(this,(function(i){return[2,new Promise((function(i,r){return _P(t,void 0,void 0,(function(){var t,n;return bP(this,(function(o){switch(o.label){case 0:t=null,o.label=1;case 1:return o.trys.push([1,6,,7]),"string"!=typeof e?[3,3]:[4,this.instance.get(e)];case 2:return t=o.sent(),[3,5];case 3:return[4,this.instance.request(e)];case 4:t=o.sent(),o.label=5;case 5:return i(t.data),[3,7];case 6:return n=o.sent(),r(n),[3,7];case 7:return[2]}}))}))}))]}))}))},t.prototype.initInterceptors=function(){this.interceptorsRequest(),this.interceptorsResponse()},t.prototype.interceptorsRequest=function(){this.instance.interceptors.request.use((function(e){return e}),(function(e){return vP.error(e),Promise.resolve(e)}))},t.prototype.interceptorsResponse=function(){this.instance.interceptors.response.use((function(e){return e}),(function(e){return vP.error(e),Promise.resolve(e)}))},t.prototype.realtimeForecast=function(e,t,i){return _P(this,void 0,void 0,(function(){return bP(this,(function(r){switch(r.label){case 0:return[4,this.getData("https://api.caiyunapp.com/v2.6/".concat(e,"/").concat(t,",").concat(i,"/realtime.json"))];case 1:return[2,r.sent()]}}))}))},t.prototype.getMinutesLevelForecast=function(e,t,i){return void 0===e&&(e="ArpG3nT5302xJSFI"),_P(this,void 0,void 0,(function(){return bP(this,(function(r){switch(r.label){case 0:return[4,this.getData("https://api.caiyunapp.com/v2.6/".concat(e,"/").concat(t,",").concat(i,"/minutely"))];case 1:return[2,r.sent()]}}))}))},t.prototype.getHourLevelForecast=function(e,t,i){return void 0===e&&(e="ArpG3nT5302xJSFI"),_P(this,void 0,void 0,(function(){return bP(this,(function(r){switch(r.label){case 0:return[4,this.getData("https://api.caiyunapp.com/v2.6/".concat(e,"/").concat(t,",").concat(i,"/hourly?hourlysteps=1"))];case 1:return[2,r.sent()]}}))}))},t.prototype.getDayLevelForecast=function(e,t,i){return void 0===e&&(e="ArpG3nT5302xJSFI"),_P(this,void 0,void 0,(function(){return bP(this,(function(r){switch(r.label){case 0:return[4,this.getData("https://api.caiyunapp.com/v2.6/".concat(e,"/").concat(t,",").concat(i,"/daily?dailysteps=1"))];case 1:return[2,r.sent()]}}))}))},t.prototype.warningData=function(e,t,i){return void 0===e&&(e="ArpG3nT5302xJSFI"),_P(this,void 0,void 0,(function(){return bP(this,(function(r){switch(r.label){case 0:return[4,this.getData("https://api.caiyunapp.com/v2.6/".concat(e,"/").concat(t,",").concat(i,"/realtime?alert=true"))];case 1:return[2,r.sent()]}}))}))},t}(AP.Axios),PP=new wP({baseURL:window.location.origin}),SP=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},xP=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},BP=function(){function e(){this.id=(0,xw.v4)(),this.audioObj=new Audio,this.radioList=[{name:"单次",value:!1},{name:"循环",value:!0}]}return Object.defineProperty(e.prototype,"src",{get:function(){return this._src},set:function(e){this._src=e,this.audioObj.src=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"volume",{get:function(){return this._volume},set:function(e){this._volume=e,this.audioObj.volume=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"muted",{get:function(){return this._muted},set:function(e){this._muted=e,this.audioObj.muted=e},enumerable:!1,configurable:!0}),SP([(0,Bw.h)(),xP("design:type",Object)],e.prototype,"audioObj",void 0),SP([(0,Bw.h)(),xP("design:type",Object)],e.prototype,"radioList",void 0),SP([(0,Bw.h)(),dy({name:"类型",group:"音频设置",type:"plotType",order:2}),xP("design:type",String)],e.prototype,"type",void 0),SP([dy({name:"音量",group:"音频设置",type:"slider",order:2,min:0,max:1}),xP("design:type",Number),xP("design:paramtypes",[Number])],e.prototype,"volume",null),e}(),MP=function(){function e(){}return e.formatURL=function(e){if(e){var t=e.split("/"),i=window.location.href,r=[];if(!i)return e;(r=i.split("/")).pop();for(var n="",o=0;o<t.length;o+=1)0===o&&"."===t[o]&&(o+=1),".."===t[o]?r.pop():r.push(t[o]);for(o=0;o<r.length;o+=1){var s=o===r.length-1?"":"/";n+=r[o]+s}return n}},e}(),EP=function(){function e(){}return e.deepClone=function(e){var t=Array.isArray(e)?[]:{};for(var i in e)"object"==typeof e[i]?t[i]=this.deepClone(e[i]):t[i]=e[i];return t},e.colorRgbHex=function(e,t,i){return"#"+((1<<24)+(Number(e)<<16)+(Number(t)<<8)+Number(i)).toString(16).slice(1)},e}(),TP=function(){function e(){}return e.deepClone=function(t){var i,r,n,o=e.type(t);if("array"===o)i=[];else{if("object"!==o)return t;i={}}if("array"===o){for(r=0,n=t.length;r<n;r++)i.push(e.deepClone(t[r]));return i}if("object"===o){for(r in t)i[r]=e.deepClone(t[r]);return i}},e.type=function(e){return{"[object Boolean]":"boolean","[object Number]":"number","[object String]":"string","[object Function]":"function","[object Array]":"array","[object Date]":"date","[object RegExp]":"regExp","[object Undefined]":"undefined","[object Null]":"null","[object Object]":"object"}[Object.prototype.toString.call(e)]},e}(),OP=function(){function e(){}return e.createEntityName=function(e,t){if(!t||0===t.length)return e;for(var i=0,r=function(){var r=0===i||1===i?e:"".concat(e,"(").concat(i,")");if(null==t.find((function(e){return e===r})))return{value:r};i++};;){var n=r();if("object"==typeof n)return n.value}},e}(),LP=function(){function e(){}return e.isNullOrEmpty=function(e){return null==e||null==e||""==(e+="").trim()},e.isNullOrUndefined=function(e){return null==e||null==e},e.getStrNow=function(){var e=new Date;return e.getFullYear()+"-"+(e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1)+"-"+(e.getDate()<10?"0"+e.getDate():e.getDate())+" "+(e.getHours()<10?"0"+e.getHours():e.getHours())+":"+(e.getMinutes()<10?"0"+e.getMinutes():e.getMinutes())+":"+(e.getSeconds()<10?"0"+e.getSeconds():e.getSeconds())},e.isHasImg=function(e){var t=new Image;return t.src=e,t.width>0&&t.height>0},e.trimStr=function(e){return e.replace(/(^\s*)|(\s*$)/g,"")},e}();var DP=function(){function e(){}return e.register=function(e){this._cachesMusic.set(e.id,e)},e.getMusic=function(e){return this._cachesMusic.get(e)},e._cachesMusic=new Map,e}();const IP=function(){function e(){}return e.currentEditGraphList=[],e.currentBoxList=[],e.boxList=[],e.currentMusicList=[],e.currentTifList=[],e}();var RP=i(5108),HP=function(){function e(e){this.isRefresh$=new th.x,this.chooseMusic$=new th.x,this.musicList=[],this.currentMusicList=[],this.musicDataSub$=new th.x,this.message=e}return e.prototype.addMusic=function(e){RP.log("addMusic>>>",e);var t=this.createObj(e);return this.musicList.push(t),this.musicList=this.removeRepeat(this.musicList),this.isRefresh$.next(t),this.currentMusic=t,DP.register(t),this.message.success("音效设置成功"),t},e.prototype.setCurrentMusic=function(e,t){if(void 0===t&&(t=!1),RP.log("当前音乐",e),this.currentMusic=e,this.chooseMusic$.next(e),t){for(var i=!1,r=0;r<IP.currentMusicList.length;r++)if(IP.currentMusicList[r].id===e.id){i=!0;break}i||IP.currentMusicList.push(e)}else IP.currentMusicList=[],IP.currentMusicList.push(e);this.currentMusicList=IP.currentMusicList,this.musicDataSub$.next(IP.currentMusicList)},e.prototype.del=function(e){var t=this.musicList.findIndex((function(t){return t.id===e.id}));t>-1&&this.musicList.splice(t,1),RP.log("删除音频",this.musicList,e)},e.prototype.clear=function(){this.musicList.length=0},e.prototype.saveData=function(){return this.musicList=this.removeRepeat(this.musicList),RP.log("save data",this.musicList),this.musicList&&this.musicList.length>0?my.ZP.serialize(this.musicList):null},e.prototype.recoverData=function(e){var t=this;RP.log("recoverdata",e),this.musicList.length=0,Array.isArray(e)&&e.length>0&&((e=this.removeRepeat(e)).forEach((function(e){var i=t.makeMusic(e);t.musicList.push(i),DP.register(i)})),this.currentMusic=this.musicList[0])},e.prototype.removeRepeat=function(e){var t={};return e=e.reduce((function(e,i){return!t[i.id]&&(t[i.id]=e.push(i)),e}),[])},e.prototype.makeMusic=function(e){var t=new BP;return t.id=e.id,t.name=e.name,t.type="音频",t.iconName=e.iconName,t.src=e._src,t.muted=e._muted,t.volume=e._volume,t},e.prototype.createObj=function(e){RP.log("createObj",e);var t=new BP;t.type="音频",t.src=e.path,t.muted=!1,t.volume=.3;var i=e.name.lastIndexOf(".");return t.name=-1!==i?e.name.slice(0,e.name.lastIndexOf(".")):e.name,t.name=OP.createEntityName(t.name,this.musicList.map((function(e){return e.name}))),t},e.prototype.clearMultiSelectMusics=function(){this.currentMusicList=[],IP.currentMusicList=[],this.musicDataSub$.next(IP.currentMusicList)},e}(),FP=i(3935),NP=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),QP=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},kP=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},UP=function(e){function t(t,i,r){var n=e.call(this,t,i,r)||this;if(r&&r.properties)for(var o in r.properties)n[o]=r.properties[o];return n}return NP(t,e),Object.defineProperty(t.prototype,"positionProperty",{get:function(){return this._positionProperty},set:function(e){this._positionProperty instanceof Cesium.Cartesian3||this._positionProperty instanceof Array||this.viewer.scene.postRender.removeEventListener(this._positionProperty),this._positionProperty=e,this._positionProperty instanceof Cesium.Cartesian3||this._positionProperty instanceof Array?this.setPrimitivePosition(this.positionProperty):this.viewer.scene.postRender.addEventListener(this._positionProperty)},enumerable:!1,configurable:!0}),t.prototype.delete=function(){this.positionProperty=null,e.prototype.delete.call(this)},QP([(0,fy.o)(),kP("design:type",Object)],t.prototype,"_positionProperty",void 0),QP([(0,fy.o)(),kP("design:type",Object),kP("design:paramtypes",[Object])],t.prototype,"positionProperty",null),t}(rv),jP=i(5108),GP=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),zP=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},YP=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},ZP=function(e){function t(t,i,r){var n=e.call(this,t,i,{})||this;return n.hideValues=["pointIndex","longitude","latitude","elevation"],n}return GP(t,e),Object.defineProperty(t.prototype,"color",{get:function(){return this._color},set:function(e){this._color=e,this.p&&this.setColor(this.p.appearance.material)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"alpha",{get:function(){return this._alpha},set:function(e){this._alpha=e,this.p&&this.setColor(this.p.appearance.material),this.pLine&&this.setOutlineColor(this.pLine.appearance.material)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"show",{get:function(){return this._show},set:function(e){var t=this;this._show=e,this.p&&(this.p.show=this._show),Array.isArray(this.entArr)&&this.entArr.forEach((function(e){e.show=t._show}))},enumerable:!1,configurable:!0}),t.prototype.setColor=function(e){e.uniforms.color=Cesium.Color.fromCssColorString(this.color).withAlpha(this.alpha)},t.prototype.setOutlineColor=function(e){e.uniforms.color=Cesium.Color.fromCssColorString(this.color).withAlpha(this.alpha)},t.prototype.toEdit=function(){var e=this;jP.log("toEdit","toEdit");var t=(0,FP.H)(0,300).subscribe((function(i){i>4&&t.unsubscribe(),e.flashPrimitive()}))},t.prototype.finish=function(){},t.prototype.getBoundingRectangle=function(){return Cesium.Rectangle.fromCartesianArray(this.ctrlPosition.map((function(e){return Cesium.Cartesian3.fromDegrees(e.lon,e.lat)})))},t.prototype.getUpdateLevelPrimtive=function(){return this.primtiveCollection},zP([(0,fy.o)(),YP("design:type",Cesium.PrimitiveCollection)],t.prototype,"primtiveCollection",void 0),zP([(0,fy.o)(),YP("design:type",Object)],t.prototype,"pLine",void 0),zP([(0,fy.o)(),YP("design:type",Object)],t.prototype,"p",void 0),zP([(0,gy.C)(),dy({name:"颜色",group:"外观",subGroup:"填充",type:"color",order:8,subOrder:2,noEmpty:!1}),YP("design:type",String),YP("design:paramtypes",[String])],t.prototype,"color",null),zP([(0,gy.C)(),dy({name:"不透明度",group:"通用",subGroup:"不透明度",type:"slider",order:2,subOrder:5,min:0,max:1}),YP("design:type",Number),YP("design:paramtypes",[Number])],t.prototype,"alpha",null),zP([(0,gy.C)(),dy({name:"可见",group:"通用",subOrder:7,type:"boolean",order:2}),YP("design:type",Boolean),YP("design:paramtypes",[Boolean])],t.prototype,"show",null),zP([(0,fy.o)(),YP("design:type",Function),YP("design:paramtypes",[]),YP("design:returntype",Cesium.Rectangle)],t.prototype,"getBoundingRectangle",null),t}(UP),WP=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),XP=function(){return XP=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},XP.apply(this,arguments)},JP=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},KP=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},VP=function(e){function t(t,i,r){var n=e.call(this,t,i,XP({},r))||this;if(n.maxPointNum=2,n.minPointNum=2,n.type="矩形",n.color="#00FF00",n.rotation=0,n.clampToGround=!0,n.distanceDisplay=!1,n.distanceHeight=55e5,n.alpha=.8,n.moveHeight=null,n.hideValues=["heightReference","clampToGround","allowCrossGround","gridSwitch","gridLevel","gridIsAgg","gridColor","gridOutlineColor","gridUpdate"],r&&r.properties)for(var o in r.properties)n[o]=r.properties[o];return n}return WP(t,e),t.prototype.setPrimitivePosition=function(e){e[0]||(e=e.slice(1)),this.setInternalControlPosition(e),this.createEnt(e)},Object.defineProperty(t.prototype,"color",{get:function(){return this._color},set:function(e){this._color=e,this.ent&&this.setColor(this.ent.appearance.material)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"alpha",{get:function(){return this._alpha},set:function(e){this._alpha=e,this.ent&&this.setColor(this.ent.appearance.material)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"clampToGround",{get:function(){return this._clampToGround},set:function(e){this._clampToGround=e,this.setPrimitivePosition(this._singleControlPosition)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"distanceDisplay",{get:function(){return this._distanceDisplay},set:function(e){this._distanceDisplay=e,this.ent&&(this.last_pos=null,this.createEnt(this._singleControlPosition))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"distanceHeight",{get:function(){return this._distanceHeight},set:function(e){this._distanceHeight=e,this.ent&&(this.last_pos=null,this.createEnt(this._singleControlPosition))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"image",{get:function(){return this._image},set:function(e){this._image=e,this.createImageMaterial()},enumerable:!1,configurable:!0}),t.prototype.createImageMaterial=function(){var e=new Cesium.Material({fabric:{type:"Image",uniforms:{image:this.image}}});return this.ent.appearance.material=e,this.material},t.prototype.distanceCondition=function(){return this.distanceDisplay?new Cesium.DistanceDisplayConditionGeometryInstanceAttribute(0,this.distanceHeight):void 0},t.prototype.initProps=function(e,t){void 0===t&&(t=!0)},t.prototype.setColor=function(e){e.uniforms.color=Cesium.Color.fromCssColorString(this.color).withAlpha(1==this.alpha?.99999:this.alpha)},t.prototype.createMaterial=function(){var e;return this.image?e=new Cesium.Material({fabric:{type:"Image",uniforms:{image:this.image}}}):(e=Cesium.Material.fromType("Color"),this.setColor(e)),e},t.prototype.createEnt=function(e){if(!ty.Cartesian3ArrayEqual(this.last_pos,e)&&e&&!(e.length<=1)){this.last_pos=TP.deepClone(e),this.ent&&this.viewer.scene.primitives.remove(this.ent);var t=this.calcuteShape(e);if(t){var i=new Cesium.RectangleGeometry({rectangle:t}),r=new Cesium.GeometryInstance({geometry:i,id:this.id,attributes:{distanceDisplayCondition:this.distanceCondition()}}),n=this.createMaterial();this.clampToGround?(this.ent=new Cesium.GroundPrimitive({geometryInstances:r,appearance:new Cesium.PolylineMaterialAppearance({material:n,translucent:!0}),vertexCacheOptimize:!0,interleave:!1,compressVertices:!0,releaseGeometryInstances:!0,asynchronous:!1,allowPicking:!0,show:!0}),this.viewer.scene.primitives.add(this.ent)):(this.ent=new Cesium.Primitive({geometryInstances:r,appearance:new Cesium.PolylineMaterialAppearance({material:n,translucent:!0}),vertexCacheOptimize:!0,interleave:!1,compressVertices:!0,releaseGeometryInstances:!0,asynchronous:!1,allowPicking:!0,show:!0}),this.viewer.scene.primitives.add(this.ent)),this.fillShape(this.ent)}}},t.prototype.initShape=function(){var e=this;this.positionProperty=function(){var t=e._singleControlPosition.concat($A.cursorPos);t&&t[0]&&e.setPrimitivePosition(t)},this.ent={},this.createEnt([]),this.fillShape(this.ent)},t.prototype.calcuteShape=function(e){if(2==e.length){var t=e,i=zy.cartesian2lonlat(t[0]),r=zy.cartesian2lonlat(t[1]),n=r[1],o=r[0],s=i[1],a=i[0],l=[];return a>=0&&o>=0||a<0&&o<0?l=a>=o?s>=n?[o,n,a,s]:[o,s,a,n]:s>=n?[a,n,o,s]:[a,s,o,n]:a>=0&&o<0?l=s>=n?[a,n,o,s]:[a,s,o,n]:a<0&&o>=0&&(l=s>=n?[o,n,a,s]:[o,s,a,n]),this.setInternalControlPosition(e,Cesium.JulianDate.now()),Cesium.Rectangle.fromDegrees(l[0],l[1],l[2],l[3])}},t.prototype.toEdit=function(){var t=this;e.prototype.toEdit.call(this),this.positionProperty=function(){var e=t._singleControlPosition;t.setPrimitivePosition(e)}},t.prototype.finish=function(){if(this.ent){e.prototype.finish.call(this);var t=this._singleControlPosition;this.positionProperty=t}},t.prototype.toGeoJsonGeometry=function(){var e={type:"Polygon",coordinates:[]};return e.coordinates.push([this.ctrlPosition[0].lon,this.ctrlPosition[0].lat,this.ctrlPosition[0].alt]),e.coordinates.push([this.ctrlPosition[1].lon,this.ctrlPosition[0].lat,this.ctrlPosition[0].alt]),e.coordinates.push([this.ctrlPosition[1].lon,this.ctrlPosition[1].lat,this.ctrlPosition[0].alt]),e.coordinates.push([this.ctrlPosition[0].lon,this.ctrlPosition[1].lat,this.ctrlPosition[0].alt]),e},JP([dy({name:"旋转",group:"外观",order:8,type:"numberNew",hidden:!0}),KP("design:type",Number)],t.prototype,"rotation",void 0),JP([(0,gy.C)(),dy({name:"颜色",group:"外观",subGroup:"填充",type:"color",order:8,subOrder:2,noEmpty:!1}),KP("design:type",String),KP("design:paramtypes",[String])],t.prototype,"color",null),JP([(0,gy.C)(),dy({name:"不透明度",group:"通用",subGroup:"不透明度",type:"slider",order:2,subOrder:3,min:0,max:1}),KP("design:type",Number),KP("design:paramtypes",[Number])],t.prototype,"alpha",null),JP([(0,fy.o)(),KP("design:type",Boolean)],t.prototype,"_clampToGround",void 0),JP([dy({name:"贴地",group:"外观",type:"boolean",order:8,min:1,max:256}),KP("design:type",Boolean),KP("design:paramtypes",[Boolean])],t.prototype,"clampToGround",null),JP([dy({name:"可视高度",group:"通用",subGroup:"可视高度",subOrder:1,type:"checkboxSub",order:2,hiddenGroupName:!1}),KP("design:type",Boolean),KP("design:paramtypes",[Boolean])],t.prototype,"distanceDisplay",null),JP([dy({name:"可视高度距离",group:"通用",subGroup:"可视高度",subOrder:2,type:"number3",order:2,hiddenGroupName:!1,min:0,max:2e7}),KP("design:type",Number),KP("design:paramtypes",[Number])],t.prototype,"distanceHeight",null),JP([dy({name:"图片",group:"外观",type:"address",order:8,min:0,max:1}),KP("design:type",String),KP("design:paramtypes",[String])],t.prototype,"image",null),JP([(0,fy.o)(),KP("design:type",Object)],t.prototype,"material",void 0),JP([(0,fy.o)(),KP("design:type",Object)],t.prototype,"last_pos",void 0),t}(UP);const qP=VP;c.Z.registerType(VP,"EditorRectangle","Graph");var $P=function(){function e(){}return e.getProp=function(e){var t=this.getPropList();if(!t)return{};var i=t.find((function(t){return t.graphType===e}));return i?i.propObj:{}},e.saveProp=function(t,i,r){var n=this.getPropList();n||(n=[]);var o=n.find((function(e){return e.graphType===t}));o||((o=new eS).graphType=t,n.push(o)),o.propObj[i]=r,localStorage.setItem(e.key,JSON.stringify(n))},e.getPropList=function(){var t=localStorage.getItem(e.key);return t&&0!=t.length?JSON.parse(t):null},e.key="deGraphProp",e}(),eS=function(){this.graphType="",this.propObj={}},tS=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),iS=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},rS=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},nS=function(e){function t(t,i,r){var n=e.call(this,t,i)||this;return n.type="点",n.heightReference=Cesium.HeightReference.RELATIVE_TO_GROUND,n}return tS(t,e),Object.defineProperty(t.prototype,"heightReference",{get:function(){return this.viewer.scene.mode==Cesium.SceneMode.SCENE3D?this._heightReference:Cesium.HeightReference.NONE},set:function(e){"string"==typeof e&&(e=Number.parseInt(e)),$P.saveProp(this.type,"heightReference",e),this._heightReference=e,this.resetHeightReference()},enumerable:!1,configurable:!0}),iS([dy({name:"高程选项",group:"通用",showGroup:!1,type:"option",order:2,options:$A.heightReferenceOption}),rS("design:type",Number),rS("design:paramtypes",[Number])],t.prototype,"heightReference",null),t}(UP),oS=i(5108),sS=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),aS=function(){return aS=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},aS.apply(this,arguments)},lS=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},hS=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},cS=function(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],r=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},uS=function(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var r,n,o=i.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){n={error:e}}finally{try{r&&!r.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}return s},pS=function(e,t,i){if(i||2===arguments.length)for(var r,n=0,o=t.length;n<o;n++)!r&&n in t||(r||(r=Array.prototype.slice.call(t,0,n)),r[n]=t[n]);return e.concat(r||Array.prototype.slice.call(t))},dS=function(e){function t(t,i,r){var n=e.call(this,t,i,aS({},r))||this;if(n.minPointNum=3,n.moveHeightProperty=["facadeHeight"],n._polygonImage="",n.uniformListenr=function(){n.internalMaterial&&(n.internalMaterial.uniforms.time=n.internalMaterial.uniforms.time>=1?.4:n.internalMaterial.uniforms.time+.005)},n.type="多边形",n.colorShow=!0,n.color="#00FF00",n.rotation=0,n.material="",n.alpha=.8,n.effect="",n.moveHeight=null,n.hideValues=["heightReference","allowCrossGround"],n.heightReference=Cesium.HeightReference.CLAMP_TO_GROUND,n.middleClosed=!0,n.outline=!0,n.outlineColor="#097EFF",n.outlineAlpha=1,n.outlineWidth=2,n.showFacade=!1,n.facadeHeight=2e3,n.distanceDisplay=!1,n.percentAngle=360,n.distanceHeight=55e5,n.fillAngle=0,Object.defineProperty(n,"moveHeight",{configurable:!0,enumerable:!0,get:function(){return n.showFacade?n.internalmoveHeight:void 0}}),r&&r.properties)for(var o in r.properties)n[o]=r.properties[o];return n}return sS(t,e),t.prototype.setPrimitivePosition=function(e){var t,i;e[0]||(e=e.slice(1));var r=[],n=function(e){0==r.filter((function(t){return Cesium.Cartesian3.equals(t,e)})).length&&r.push(e)};try{for(var o=cS(e),s=o.next();!s.done;s=o.next()){n(s.value)}}catch(e){t={error:e}}finally{try{s&&!s.done&&(i=o.return)&&i.call(o)}finally{if(t)throw t.error}}e=r,this.setInternalControlPosition(e),this.createEnt(e)},Object.defineProperty(t.prototype,"colorShow",{get:function(){return this._colorShow},set:function(e){this._colorShow=e,this.fillent&&this.setColor(this.fillent.appearance.material)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){return this._color},set:function(e){this._color=e,this.fillent&&this.setColor(this.fillent.appearance.material)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"show",{get:function(){return this._show},set:function(e){this._show=e,this.fillent&&(this.fillent.show=e,this.outlinePrimtive&&(this.outlinePrimtive.show=e))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"outline",{get:function(){return this._outline},set:function(e){this._outline=e,this.fillent&&(this.last_pos=null,this.createEnt(this._singleControlPosition))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"outlineColor",{get:function(){return this._outlineColor},set:function(e){this._outlineColor=e,this.outlinePrimtive&&this.setOutlineColor(this.outlinePrimtive.appearance.material)},enumerable:!1,configurable:!0}),t.prototype.internalmoveHeight=function(e,t){var i=this.facadeHeight,r=this.ChangeLengthByMouse(i,t.y-e.y,1);r<0&&(r=0),this.facadeHeight=r},Object.defineProperty(t.prototype,"outlineAlpha",{get:function(){return this._outlineAlpha},set:function(e){this._outlineAlpha=e,this.outlinePrimtive&&this.setOutlineColor(this.outlinePrimtive.appearance.material)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"outlineWidth",{get:function(){return this._outlineWidth},set:function(e){this._outlineWidth=e,this.fillent&&(this.last_pos=null,this.createEnt(this._singleControlPosition))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"distanceDisplay",{get:function(){return this._distanceDisplay},set:function(e){this._distanceDisplay=e,this.fillent&&(this.last_pos=null,this.createEnt(this._singleControlPosition))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"distanceHeight",{get:function(){return this._distanceHeight},set:function(e){this._distanceHeight=e,this.fillent&&(this.last_pos=null,this.createEnt(this._singleControlPosition))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"alpha",{get:function(){return this._alpha},set:function(e){this._alpha=e,this.fillent&&(this.setColor(this.fillent.appearance.material),this.outlinePrimtive&&this.setOutlineColor(this.outlinePrimtive.appearance.material))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"showFacade",{get:function(){return this._showFacade},set:function(e){this._showFacade=e,this.fillent&&(this.reloadOperator=!0,this.last_pos=null,this.createEnt(this._singleControlPosition))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"facadeHeight",{get:function(){return this._facadeHeight},set:function(e){this._facadeHeight=e,this.fillent&&(this.last_pos=null,this.createEnt(this._singleControlPosition))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._height},set:function(e){this._height=e,oS.log("this",this)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"interplate",{get:function(){return this._interplate},set:function(e){this._interplate=e,this.fillent&&(this.last_pos=null,this.createEnt(this._singleControlPosition)),this.positionChanged.next(!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"material",{get:function(){return this._material},set:function(e){this._material=e,this.fillent&&(this.internalMaterial=void 0,this.fillent.appearance.material=this._material)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"polygonImage",{get:function(){return this._polygonImage},set:function(e){this._polygonImage=e,this.fillent&&(this.internalMaterial=void 0,this.createMaterial(),this.fillent.appearance.material=this.internalMaterial)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"effect",{get:function(){return this._effect},set:function(e){this._effect=e,this.fillent&&(this.internalMaterial=void 0,this.createMaterial(),this.fillent.appearance.material=this.internalMaterial,"direct"==e?this.fillent.appearance.material.uniforms.directtype=1:"gradual"==e&&(this.fillent.appearance.material.uniforms.directtype=0)),"polygonImage"!==this._effect&&(this.polygonImage="",this.image="")},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"image",{get:function(){return this._image},set:function(e){if(this._image=e,this.image&&this._image.length>0){var t=decodeURI(e);this._image=t.substring(t.lastIndexOf("/")+1,t.lastIndexOf("."))}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"percentAngle",{get:function(){return this._percentAngle},set:function(e){this._percentAngle=e,this.fillent&&(this.fillent.appearance.material.uniforms.percentAngle=e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fillAngle",{get:function(){return this._fillAngle},set:function(e){this._fillAngle=e,this.fillent&&(this.fillent.appearance.material.uniforms.fillAngle=e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"showRange",{set:function(e){this.fillent&&(this.fillent.appearance.material.uniforms.xmin=e[0],this.fillent.appearance.material.uniforms.ymin=e[1],this.fillent.appearance.material.uniforms.xmax=e[2],this.fillent.appearance.material.uniforms.ymax=e[3])},enumerable:!1,configurable:!0}),t.prototype.initProps=function(e){},t.prototype.initShape=function(){var e=this;this.positionProperty=function(){var t=e._singleControlPosition.concat($A.cursorPos);t&&e.setPrimitivePosition(t)},this.createEnt([]),this.primtiveCollection=new Cesium.PrimitiveCollection,this.ent=this.primtiveCollection,this.fillShape(this.ent),this.last_pos=void 0,this.viewer.scene.orderGroundPrimitives.add(this.primtiveCollection,this.level)},t.prototype.startClock=function(){this.viewer.clock.onTick.addEventListener(this.uniformListenr)},t.prototype.stopClock=function(){this.viewer.clock.onTick.removeEventListener(this.uniformListenr)},t.prototype.createMaterial=function(){if(!this.internalMaterial){if(this.stopClock(),""==this.effect){var e={type:"InterMaterial",uniforms:{repeat:new Cesium.Cartesian2(1,1),color:new Cesium.Color(1,1,1,1),percentAngle:360,xmin:0,ymin:0,xmax:1,ymax:1,time:1},source:"\n        czm_material czm_getMaterial(czm_materialInput materialInput)\n        {\n            czm_material material = czm_getDefaultMaterial(materialInput);\n            //float dis = distance(materialInput.st, vec2(0.5, 0.5));\n            material.diffuse =color.rgb; \n            material.alpha=color.a;\n            float a = atan( materialInput.st.y-0.5, materialInput.st.x-0.5 );\n            float ang = degrees(a)+180.0+90.0;\n            if(ang<0.0){\n              ang=ang+360.0;\n            }\n            if(ang> 360.0){\n              ang = ang-360.0;\n            }\n            float angle=percentAngle;\n            if(angle>360.0){\n              angle=angle-360.0;\n            }\n            if(ang < 360.0 - angle){\n              material.alpha=0.0;\n            }\n            // float xmin=showRange[0];\n            // float ymin=showRange[1];\n            // float xmax=showRange[2];\n            // float ymax=showRange[3];\n            if(materialInput.st.x < xmin || materialInput.st.x > xmax || materialInput.st.y < ymin || materialInput.st.y > ymax){\n              material.alpha=0.0;\n            }\n            //material.alpha=1.0-mix(0.0,2.0,dis);\n            //material.alpha= material.alpha*time;\n            // if(material.alpha<0.1){\n            //   material.alpha=0.0;\n            // }\n            return material;\n        }"};this.internalMaterial=new Cesium.Material({fabric:e})}else{if("polygonImage"===this.effect)return void(this.internalMaterial=new Cesium.Material({fabric:{type:"Image",uniforms:{image:this.polygonImage,repeat:new Cesium.Cartesian2(1,1),color:new Cesium.Color(1,1,1,this.alpha),percentAngle:360,xmin:0,ymin:0,xmax:1,ymax:1},source:"\n        czm_material czm_getMaterial(czm_materialInput materialInput)\n        {\n            czm_material material = czm_getDefaultMaterial(materialInput);\n            //float dis = distance(materialInput.st, vec2(0.5, 0.5));\n            material.diffuse =texture2D(image, fract(repeat * materialInput.st)).rgb * color.rgb; \n            material.alpha=color.a;\n            float a = atan( materialInput.st.y-0.5, materialInput.st.x-0.5 );\n            float ang = degrees(a)+180.0+90.0;\n            if(ang<0.0){\n              ang=ang+360.0;\n            }\n            if(ang> 360.0){\n              ang = ang-360.0;\n            }\n            float angle=percentAngle;\n            if(angle>360.0){\n              angle=angle-360.0;\n            }\n            if(ang < 360.0 - angle){\n              material.alpha=0.0;\n            } \n            if(materialInput.st.x < xmin || materialInput.st.x > xmax || materialInput.st.y < ymin || materialInput.st.y > ymax){\n              material.alpha=0.0;\n            } \n            return material;\n        }"}}));e={type:"InterMaterial",uniforms:{repeat:new Cesium.Cartesian2(1,1),color:new Cesium.Color(1,1,1,1),time:1,percentAngle:360,fillAngle:0,directtype:0},source:"\n        czm_material czm_getMaterial(czm_materialInput materialInput)\n        {\n            float f=fillAngle;\n            czm_material material = czm_getDefaultMaterial(materialInput);\n            if(directtype==0.0){\n              float dis = distance(materialInput.st, vec2(0.5, 0.5));\n              material.diffuse =color.rgb; \n              material.alpha=1.0-mix(0.0,2.0,dis);\n              // material.alpha=materialInput.st.y;\n            }else{\n              material.diffuse = color.rgb; \n              // float x=materialInput.st.y;\n              // float y=materialInput.st.x;\n              // if(f > 90.0 && f <= 180.0){\n              //   f = 180.0 - f;\n              //   x =1.0 -x;\n              // }\n              // else if(f > 270.0 && f <= 360.0){\n              //   f = 360.0 - f;\n              //   x = 1.0  -x;\n              // }\n              // if(f == 90.0){\n              //   material.alpha = y;\n              // }else if(f == 270.0){\n              //   material.alpha = 1.0 - y;\n              // }\n              // else{\n              //   float ra = radians(f);\n              //   //按角度渐变\n              //   //求点materialInput.st到直线y=tan(fillAngle)*x ==> -tan(fillAngle)*x + y = 0的垂足\n              //   //公式： x = ( B*B*x0 - A*B*y0 - A*C ) / ( A*A + B*B )， y = ( -A*B*x0 + A*A*y0 - B*C ) / ( A*A + B*B ) 此处A=-tan(fillAngle)，B=1, C=0\n              //   float A = - tan(ra);\n              //   float footX = ( x - A*y ) / ( A*A + 1.0 );\n              //   float footY = ( -A*x + A*A*y ) / ( A*A + 1.0 );\n              //   //求直线y=tan(fillAngle)*x在区域0<=x<=1,0<=y<=1内的线段总长度，\n              //   float totalDistance = 1.0;\n                \n              //   //求原点到垂足点的距离\n              //   float footDistance = sqrt(pow(footX, 2.0) + pow(footY, 2.0));\n              //   //得到透明度的比例\n              //   material.alpha = footDistance / totalDistance;\n              //   if(fillAngle > 180.0){\n              //     material.alpha = 1.0 - footDistance / totalDistance;\n              //   }\n              // }\n\n              //新算法\n              float x=materialInput.st.x;\n              float y=materialInput.st.y;\n              \n              vec2 gradientStartPos = vec2(0.0, 0.0);\n              vec2 gradientEndPos = vec2(1.0, 1.0);\n              if(fillAngle>=0.0 && fillAngle < 45.0){\n                float ra = radians(fillAngle);\n                float tempX = tan(ra);\n                gradientStartPos = vec2(tempX, 1.0);\n                gradientEndPos = vec2(0.0, 0.0);\n              }else if(fillAngle>=45.0 && fillAngle < 90.0){\n                float ra = radians(90.0 - fillAngle);\n                float tempY = tan(ra);\n                gradientStartPos = vec2(1.0, tempY);\n                gradientEndPos = vec2(0.0, 0.0);\n              }else if(fillAngle>=90.0 && fillAngle < 135.0){\n                float ra = radians(fillAngle - 90.0);\n                float tempY = tan(ra);\n                gradientStartPos = vec2(1.0, 0.0);\n                gradientEndPos = vec2(0.0, tempY);\n              }else if(fillAngle>=135.0 && fillAngle < 180.0){\n                float ra = radians(fillAngle - 135.0);\n                float tempX = tan(ra);\n                gradientStartPos = vec2(1.0, 0.0);\n                gradientEndPos = vec2(tempX, 1.0);\n              }else if(fillAngle>=180.0 && fillAngle < 225.0){\n                float ra = radians(fillAngle - 180.0);\n                float tempX = tan(ra);\n                gradientStartPos = vec2(0.0, 0.0);\n                gradientEndPos = vec2(tempX, 1.0);\n              }else if(fillAngle>=225.0 && fillAngle < 270.0){\n                float ra = radians(270.0 - fillAngle);\n                float tempY = tan(ra);\n                gradientStartPos = vec2(0.0, 0.0);\n                gradientEndPos = vec2(1.0, tempY);\n              }else if(fillAngle>=270.0 && fillAngle < 315.0){\n                float ra = radians(315.0 - fillAngle);\n                float tempY = tan(ra);\n                gradientStartPos = vec2(0.0, 1.0);\n                gradientEndPos = vec2(1.0, tempY);\n              }else{\n                float ra = radians(360.0 - fillAngle);\n                float tempX = tan(ra);\n                gradientStartPos = vec2(0.0, 1.0);\n                gradientEndPos = vec2(tempX, 0.0);\n              }\n              float alpha = atan( -gradientEndPos.y + gradientStartPos.y, gradientEndPos.x - gradientStartPos.x );\n              float gradientStartPosRotatedX = gradientStartPos.x*cos(alpha) - gradientStartPos.y*sin(alpha);\n              float gradientEndPosRotatedX = gradientEndPos.x*cos(alpha) - gradientEndPos.y*sin(alpha);\n              float d = gradientEndPosRotatedX - gradientStartPosRotatedX;\n              float xLocRotated = x*cos( alpha ) - y*sin( alpha );\n              float alp=mix(1.0, 0.0, smoothstep( gradientStartPosRotatedX + 0.0*d, gradientStartPosRotatedX + 1.0*d, xLocRotated ) );\n              material.alpha=alp;\n            }\n            material.alpha= material.alpha*time*color.a;\n            if(material.alpha<0.0){\n              material.alpha=0.0;\n            }\n            float a = atan( materialInput.st.y-0.5, materialInput.st.x-0.5 );\n            float ang = degrees(a)+180.0+90.0;\n            if(ang<0.0){\n              ang=ang+360.0;\n            }\n            if(ang> 360.0){\n              ang = ang-360.0;\n            }\n            float angle=percentAngle;\n            if(angle>360.0){\n              angle=angle-360.0;\n            }\n            if(ang < 360.0 - angle){\n              material.alpha=0.0;\n            }\n            // if(material.alpha<0.1){\n            //   material.alpha=0.0;\n            // }\n            return material;\n        }"};this.internalMaterial=new Cesium.Material({fabric:e}),"wave"==this.effect&&this.startClock()}this.setColor(this.internalMaterial)}},t.prototype.setColor=function(e){switch(this.colorShow?"polygonImage"===this.effect?e.uniforms.color=Cesium.Color.fromCssColorString("#ffffff").withAlpha(this.alpha):e.uniforms.color=Cesium.Color.fromCssColorString(this.color).withAlpha(this.alpha):"polygonImage"===this.effect?e.uniforms.color=Cesium.Color.fromCssColorString("#ffffff").withAlpha(this.alpha):e.uniforms.color=Cesium.Color.fromCssColorString(this.color).withAlpha(0),this.effect){case"direct":e.uniforms.directtype=1;break;case"gradual":e.uniforms.directtype=0}e.uniforms.percentAngle=this.percentAngle,e.uniforms.fillAngle=this.fillAngle},t.prototype.setOutlineColor=function(e){e.uniforms.color=Cesium.Color.fromCssColorString(this.outlineColor).withAlpha(this.alpha)},t.prototype.createEnt=function(e){var t=this.showFacade?this.facadeHeight:0;if((!ty.Cartesian3ArrayEqual(this.last_pos,e)||this.lastheight!=t)&&e&&!(e.length<=1)){this.last_pos=pS([],uS(e),!1),this.lastheight=t,this.fillent&&this.primtiveCollection.remove(this.fillent);var i=this.calcuteShape(e,null);if(i&&!(i.length<=1)){var r=new Cesium.PolygonHierarchy(i),n=new Cesium.PolygonGeometry({polygonHierarchy:r,extrudedHeight:0,height:this.showFacade?this.facadeHeight:0,vertexFormat:Cesium.EllipsoidSurfaceAppearance.VERTEX_FORMAT}),o=new Cesium.GeometryInstance({geometry:n,id:this.id,attributes:{distanceDisplayCondition:this.distanceCondition()}});this.createMaterial();var s={geometryInstances:o,appearance:new Cesium.EllipsoidSurfaceAppearance({material:this.material?this.material:this.internalMaterial,flat:!0,translucent:!0,aboveGround:!0}),vertexCacheOptimize:!0,interleave:!1,compressVertices:!0,releaseGeometryInstances:!0,asynchronous:!1,allowPicking:!0,show:this.show};this.fillent=this.showFacade?new Cesium.Primitive(s):new Cesium.GroundPrimitive(s),this.primtiveCollection.add(this.fillent,this.level),this.fillShape(this.fillent),this.createOutline(i,t)}}},t.prototype.distanceCondition=function(){return this.distanceDisplay?new Cesium.DistanceDisplayConditionGeometryInstanceAttribute(0,this.distanceHeight):void 0},t.prototype.getUpdateLevelPrimtive=function(){return this.primtiveCollection},t.prototype.createOutline=function(e,t){var i=this;if(this.outlinePrimtive&&this.primtiveCollection.remove(this.outlinePrimtive),this.outline){if(e.push(e[0]),e.length>=2){var r=this.getLineRay(e[0],e[1]);Object.is(r.x,NaN)||Object.is(r.y,NaN)||Object.is(r.z,NaN)||e.push(r)}var n=e.map((function(e){return zy.getHeightdefineByXYZ(e,t,i.viewer)})),o=this.showFacade?new Cesium.PolylineGeometry({positions:n,width:this.outlineWidth}):new Cesium.GroundPolylineGeometry({positions:n,width:this.outlineWidth}),s=new Cesium.GeometryInstance({geometry:o,id:this.id,attributes:{distanceDisplayCondition:this.distanceCondition()}}),a=Cesium.Material.fromType("Color");this.setOutlineColor(a);var l={geometryInstances:[s],appearance:new Cesium.PolylineMaterialAppearance({material:a,translucent:!0}),vertexCacheOptimize:!0,interleave:!1,compressVertices:!0,releaseGeometryInstances:!0,asynchronous:!1,allowPicking:!1,show:this.show};this.outlinePrimtive=this.showFacade?new Cesium.Primitive(l):new Cesium.GroundPolylinePrimitive(l),this.primtiveCollection.add(this.outlinePrimtive,this.level)}},t.prototype.calcuteShape=function(e,t){if((e=e.filter((function(e){return null!=e}))).length<this.minPointNum)return[];var i=e;if(this.setInternalControlPosition(i,t),this.interplate){i=[];var r=[0],n=[],o=0;e=pS([],uS(e),!1);for(var s=0;s<e.length-1;s++){var a=Cesium.Cartesian3.distance(e[s],e[s+1]);n.push(a),o+=a}for(var l=0;l<n.length;l++)r.push(n[l]/o+r[l]);this.interopLine=Cesium.HermiteSpline.createNaturalCubic({times:r,points:e});for(var h=10*e.length,c=0;c<=h;c++){var u=this.interopLine.evaluate(c/h);i.push(u)}}return i},t.prototype.lerp=function(t,i){if(this.interplate){if(this.interopLine){try{var r=(this.interopLine.times[t]+this.interopLine.times[i])/2;return this.interopLine.evaluate(r)}catch(e){oS.log(e)}return e.prototype.lerp.call(this,t,i)}return e.prototype.lerp.call(this,t,i)}return e.prototype.lerp.call(this,t,i)},t.prototype.toEdit=function(){var t=this;e.prototype.toEdit.call(this),this.positionProperty=function(){var e=t._singleControlPosition;t.setPrimitivePosition(e)}},t.prototype.finish=function(){if(this.ent){e.prototype.finish.call(this);var t=this._singleControlPosition;this.positionProperty=t}},t.prototype.toGeoJsonGeometry=function(){var e,t,i={type:"Polygon",coordinates:[[]]};try{for(var r=cS(this.ctrlPosition),n=r.next();!n.done;n=r.next()){var o=n.value;i.coordinates[0].push([o.lon,o.lat,o.alt])}}catch(t){e={error:t}}finally{try{n&&!n.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}return i},t.prototype.delete=function(){this.viewer.scene.primitives.remove(this.outlinePrimtive),e.prototype.delete.call(this),this.stopClock()},t.prototype.gridUpdate=function(){var e,t,i=this;if(this._singleControlPosition&&this._singleControlPosition.length>0){var r="POLYGON((",n=this.calcuteShape(this._singleControlPosition,Cesium.JulianDate.now());try{for(var o=cS(n),s=o.next();!s.done;s=o.next()){var a=s.value;r=r+zy.getLongitudeByCartesian3(a,this.viewer)+" "+zy.getLatitudeByCartesian3(a,this.viewer)+", "}}catch(t){e={error:t}}finally{try{s&&!s.done&&(t=o.return)&&t.call(o)}finally{if(e)throw e.error}}r=r+zy.getLongitudeByCartesian3(n[0],this.viewer)+" "+zy.getLatitudeByCartesian3(n[0],this.viewer)+"))";var l="".concat(window.config.geopptService,"/grid/getPlotGrid"),h=this.gridLevel;h||(h=0);var c=new Request(l,{method:"post",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify({position:r,level:h,isAgg:this.gridIsAgg})});return new Promise((function(e,t){fetch(c).then((function(e){return e.json()})).then((function(e){var t=JSON.parse(e[0].st_withbox);i._gridLevel=t.detailLevel;var r=i.formatBBox(t.cells);i.drawGrid(r)})).catch((function(e){t(!1)}))}))}},t.prototype.getLineRay=function(e,t){var i=Cesium.Cartesian3.subtract(t,e,new Cesium.Cartesian3),r=Cesium.Cartesian3.normalize(i,new Cesium.Cartesian3),n=new Cesium.Ray(e,r);return Cesium.Ray.getPoint(n,1)},lS([dy({name:"旋转",group:"外观",order:8,type:"numberNew",hidden:!0}),hS("design:type",Number)],t.prototype,"rotation",void 0),lS([dy({name:"是否填充",group:"外观",subGroup:"填充",type:"checkboxSub",order:8,subOrder:1}),hS("design:type",Boolean),hS("design:paramtypes",[Boolean])],t.prototype,"colorShow",null),lS([dy({name:"颜色",group:"外观",subGroup:"填充",type:"color",order:8,subOrder:2,noEmpty:!1}),hS("design:type",String),hS("design:paramtypes",[String])],t.prototype,"color",null),lS([dy({name:"边框",group:"外观",order:8,subGroup:"边框",subOrder:4,type:"checkboxSub"}),hS("design:type",Boolean),hS("design:paramtypes",[Boolean])],t.prototype,"outline",null),lS([dy({name:"边框颜色",group:"外观",order:8,subGroup:"边框",subOrder:5,type:"color"}),hS("design:type",String),hS("design:paramtypes",[String])],t.prototype,"outlineColor",null),lS([(0,fy.o)(),hS("design:type",Array)],t.prototype,"moveHeightProperty",void 0),lS([(0,fy.o)(),hS("design:type",Function),hS("design:paramtypes",[Cesium.Cartesian2,Cesium.Cartesian2]),hS("design:returntype",void 0)],t.prototype,"internalmoveHeight",null),lS([dy({name:"边框宽度",group:"外观",subGroup:"边框宽度",subOrder:6,order:8,type:"numberNew",min:0,max:100}),hS("design:type",Number),hS("design:paramtypes",[Number])],t.prototype,"outlineWidth",null),lS([dy({name:"可视高度",group:"通用",subGroup:"可视高度",subOrder:1,type:"checkboxSub",order:2,hiddenGroupName:!1}),hS("design:type",Boolean),hS("design:paramtypes",[Boolean])],t.prototype,"distanceDisplay",null),lS([dy({name:"可视高度距离",group:"通用",subGroup:"可视高度",subOrder:2,type:"number3",order:2,hiddenGroupName:!1,min:0,max:2e7}),hS("design:type",Number),hS("design:paramtypes",[Number])],t.prototype,"distanceHeight",null),lS([dy({name:"不透明度",group:"通用",type:"slider",order:2,subGroup:"不透明度",subOrder:3,min:0,max:1}),hS("design:type",Number),hS("design:paramtypes",[Object])],t.prototype,"alpha",null),lS([dy({name:"显示立面",group:"外观",order:8,subGroup:"立面",type:"checkboxSub"}),hS("design:type",Boolean),hS("design:paramtypes",[Boolean])],t.prototype,"showFacade",null),lS([dy({name:"立面高度",group:"外观",order:8,subGroup:"立面",type:"number4",min:1,max:5e6}),hS("design:type",Number),hS("design:paramtypes",[Number])],t.prototype,"facadeHeight",null),lS([dy({name:"整体高度",group:"位置",order:2,subGroup:"高度",type:"number"}),hS("design:type",Number),hS("design:paramtypes",[Number])],t.prototype,"height",null),lS([dy({name:"平滑",group:"外观",type:"checkbox",order:8,min:1,max:256}),hS("design:type",Boolean),hS("design:paramtypes",[Boolean])],t.prototype,"interplate",null),lS([(0,fy.o)(),dy({name:"纹理",group:"外观",order:8,type:"string",hidden:!0}),hS("design:type",Object)],t.prototype,"_material",void 0),lS([dy({name:"纹理",group:"外观",order:8,type:"option",subGroup:"纹理",subOrder:7,options:[{label:"波纹",value:"wave"},{label:"辐射渐变",value:"gradual"},{label:"线性渐变",value:"direct"},{label:"图片",value:"polygonImage"},{label:"无",value:""}]}),hS("design:type",String),hS("design:paramtypes",[String])],t.prototype,"effect",null),lS([dy({name:"图片",group:"外观",type:"effectImage",order:9,subGroup:"图片",subOrder:8,interfaceHidden:!0}),hS("design:type",String),hS("design:paramtypes",[String])],t.prototype,"image",null),lS([dy({name:"显示角度",group:"外观",type:"angle",order:8,min:0,max:360,hiddenGroupName:!1}),hS("design:type",Number),hS("design:paramtypes",[Number])],t.prototype,"percentAngle",null),lS([dy({name:"渐变角度",group:"外观",type:"angleGradient",order:8,min:0,max:360,hiddenGroupName:!1}),hS("design:type",Number),hS("design:paramtypes",[Number])],t.prototype,"fillAngle",null),lS([(0,fy.o)(),hS("design:type",Array),hS("design:paramtypes",[Array])],t.prototype,"showRange",null),lS([(0,fy.o)(),hS("design:type",Object)],t.prototype,"uniformListenr",void 0),lS([(0,fy.o)(),hS("design:type",Cesium.Material)],t.prototype,"internalMaterial",void 0),lS([(0,fy.o)(),hS("design:type",Object)],t.prototype,"last_pos",void 0),lS([(0,fy.o)(),hS("design:type",Object)],t.prototype,"lastheight",void 0),lS([(0,fy.o)(),hS("design:type",Object)],t.prototype,"fillent",void 0),lS([(0,fy.o)(),hS("design:type",Cesium.PrimitiveCollection)],t.prototype,"primtiveCollection",void 0),lS([(0,fy.o)(),hS("design:type",Object)],t.prototype,"outlinePrimtive",void 0),lS([(0,fy.o)(),hS("design:type",Cesium.LinearSpline)],t.prototype,"interopLine",void 0),lS([(0,fy.o)(),hS("design:type",Function),hS("design:paramtypes",[Array,Object]),hS("design:returntype",void 0)],t.prototype,"calcuteShape",null),t}(nS);const mS=dS;c.Z.registerType(dS,"EditorPolygon","Graph");var fS=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),gS=function(){return gS=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},gS.apply(this,arguments)},AS=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},yS=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},vS=function(e){function t(t,i,r){var n=e.call(this,t,i,gS({},r))||this;return n.maxPointNum=2,n.minPointNum=2,n.imageRatio=0,n.type="矩形",n.hideValues=["interplate","heightReference","allowCrossGround"],n.middleClosed=!1,n}return fS(t,e),Object.defineProperty(t.prototype,"lockImageRatio",{get:function(){return this._lockImageRatio},set:function(e){this._lockImageRatio=e;var t=this.ctrlPosition.map((function(e){return zy.lonlathei2Cartesian(e)}));this.createEnt(t)},enumerable:!1,configurable:!0}),t.prototype.calcuteShape=function(e){if(2==e.length){var t=void 0,i=void 0;e[0]instanceof Cesium.Cartesian3&&e[1]instanceof Cesium.Cartesian3?(t=zy.cartesian2lonlat(e[0]),i=zy.cartesian2lonlat(e[1])):e[0]instanceof A&&e[1]instanceof A&&(t=[e[0].lon,e[0].lat,e[0].alt],i=[e[1].lon,e[1].lat,e[1].alt]);var r=i[1],n=i[0],o=t[1],s=t[0];if(this.lockImageRatio){var a=(n-s)*this.imageRatio;r=r>o?o+a:o-a}var l=[];return s>=0&&n>=0||s<0&&n<0?l=s>=n?o>=r?[n,r,s,o]:[n,o,s,r]:o>=r?[s,r,n,o]:[s,o,n,r]:s>=0&&n<0?l=o>=r?[s,r,n,o]:[s,o,n,r]:s<0&&n>=0&&(l=o>=r?[n,r,s,o]:[n,o,s,r]),this.setInternalControlPosition(e,Cesium.JulianDate.now()),Cesium.Cartesian3.fromDegreesArray([l[0],l[1],l[2],l[1],l[2],l[3],l[0],l[3]])}return[]},AS([dy({name:"锁定比例",group:"外观",type:"checkbox",order:10,subGroup:"锁定比例",subOrder:8,interfaceHidden:!0}),yS("design:type",Boolean),yS("design:paramtypes",[Boolean])],t.prototype,"lockImageRatio",null),t}(mS);const CS=vS;c.Z.registerType(vS,"EditorRectangleExpand","Graph");var _S=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),bS=function(){return bS=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},bS.apply(this,arguments)},wS=function(e){function t(t,i,r){var n=e.call(this,t,i,bS({},r))||this;if(n.maxPointNum=2,n.minPointNum=2,n.radius=0,n.type="圆",n.hideValues=["interplate","heightReference","allowCrossGround"],n.middleClosed=!1,r&&r.properties)for(var o in r.properties)n[o]=r.properties[o];return n}return _S(t,e),t.prototype.finish=function(){if(0==this.radius)e.prototype.finish.call(this);else if(this._singleControlPosition&&this._singleControlPosition.length>0){var t=this._singleControlPosition.map((function(e){return zy.cartesian2turfPoint(e)})),i=xt.Xwo(t[0],this.radius,{units:"meters"}),r=zy.turfGeometry2Cartesians(i);this._singleControlPosition.push(r[0]),e.prototype.finish.call(this)}},t.prototype.calcuteShape=function(e,t){if(e.length<this.minPointNum)return[];var i=e.map((function(e){return zy.cartesian2turfPoint(e)})),r=xt.TE$(i[0],i[1],{units:"meters"});r|=1;var n=xt.Xwo(i[0],r,{units:"meters"});this.turfGeo=n;var o=zy.turfGeometry2Cartesians(n);return this.setInternalControlPosition(e,t),o},t}(mS);const PS=wS;c.Z.registerType(wS,"EditorCircle","Graph");var SS=function(){function e(){}return e.getAngle=function(e,t){var i=e.x,r=e.y,n=t.x,o=t.y;return(Math.atan2(o-r,i-n)/Math.PI*180+360)%360},e}(),xS=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),BS=function(){return BS=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},BS.apply(this,arguments)},MS=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},ES=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},TS=function(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var r,n,o=i.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){n={error:e}}finally{try{r&&!r.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}return s},OS=function(e,t,i){if(i||2===arguments.length)for(var r,n=0,o=t.length;n<o;n++)!r&&n in t||(r||(r=Array.prototype.slice.call(t,0,n)),r[n]=t[n]);return e.concat(r||Array.prototype.slice.call(t))};const LS=function(e){function t(t,i,r){var n=e.call(this,t,i,BS({},r))||this;n.numScale=1,n.maxPointNum=1,n.minPointNum=1,n.scaleVz=1,n.rotateByHeadingProperty=["heading"],n.rotateByPitchProperty=["pitch"],n.rotateByRollProperty=["roll"],n.color="#00FF00",n.alpha=.8,n.heading=0,n.pitch=0,n.roll=0,n.fill=!0,n.outline=!0,n.outlineColor="#000";var o=Math.ceil(t.viewer.camera.positionCartographic.height);return n.numScale=Math.ceil(8e-4*o),n.distanceDisplay=!1,n.distanceHeight=1e7,n.hideValues=["gridSwitch","gridLevel","gridIsAgg","gridColor","gridOutlineColor","gridUpdate"],n._heightReference=Cesium.HeightReference.NONE,n}return xS(t,e),Object.defineProperty(t.prototype,"heightReference",{get:function(){return this.viewer.scene.mode==Cesium.SceneMode.SCENE3D?this._heightReference:Cesium.HeightReference.NONE},enumerable:!1,configurable:!0}),t.prototype.initProps=function(e){},t.prototype.resetOrientation=function(e){this.headingPR.heading=Cesium.Math.toRadians(this.heading),this.headingPR.pitch=Cesium.Math.toRadians(this.pitch),this.headingPR.roll=Cesium.Math.toRadians(this.roll);var t=e||this.ent.position.getValue(Cesium.JulianDate.now());this.orientation=Cesium.Transforms.headingPitchRollQuaternion(t,this.headingPR)},t.prototype.initShapeCube=function(e,t){var i=this;this.headingPR=new Cesium.HeadingPitchRoll,this.ent=this.entities.add(new Cesium.Entity),this.ent[e]={},this.ent.show=this.show,this.fillShape(this.ent),Object.assign.apply(Object,OS([this.ent[e],{heightReference:this._heightReference,fill:new Cesium.CallbackProperty((function(e,t){return i.fill}),!0),material:new Cesium.ColorMaterialProperty(new Cesium.CallbackProperty((function(){var e=Cesium.Color.fromCssColorString(i.color).withAlpha(i.alpha);return i.ent.highLighted?e.brighten(.6,new Cesium.Color):e}),!0)),outline:new Cesium.CallbackProperty((function(e,t){return i.outline}),!1),outlineColor:new Cesium.CallbackProperty((function(){var e=Cesium.Color.fromCssColorString(i.outlineColor).withAlpha(i.alpha);return i.ent.highLighted?e.brighten(.6,new Cesium.Color):e}),!1),distanceDisplayCondition:new Cesium.CallbackProperty((function(e,t){return i.distanceDisplay?new Cesium.DistanceDisplayCondition(0,i.distanceHeight):new Cesium.DistanceDisplayCondition(0,Number.MAX_VALUE)}),!0)}],TS(t),!1)),this.ent.position=new Cesium.CallbackProperty((function(e,t){return i.calcuteShape(i._singleControlPosition.concat($A.cursorPos),e)}),!1),this.ent.orientation=new Cesium.CallbackProperty((function(){return i.orientation}),!0)},t.prototype.rotateHeadingByAngle=function(e,t){var i=e-t+1*this.heading;i=this.handle360(i),this.heading=i},t.prototype.rotatePitchByAngle=function(e,t){var i=t-e+1*this.pitch;i=this.handle360(i),this.pitch=i},t.prototype.rotateRollByAngle=function(e,t){var i=t-e+1*this.roll;i=this.handle360(i),this.roll=i},t.prototype.scaleZ=function(e,t){},t.prototype.scaleX=function(e,t){},t.prototype.scaleY=function(e,t){},t.prototype.handle360=function(e){return e>360&&(e-=360),e<-360&&(e+=360),e},t.prototype.calcMouseDelta=function(e,t){return(t.x-e.x)*this.numScale*.1},t.prototype.calcuteShape=function(e,t){return e.length<this.minPointNum?[]:null==e[0]?Cesium.Cartesian3.fromDegrees(123,23):(this.setInternalControlPosition(e,t),e[0])},t.prototype.toEdit=function(){var t=this;e.prototype.toEdit.call(this),this.ent.position=new Cesium.CallbackProperty((function(e,i){var r=t.calcuteShape(t._singleControlPosition,e);return t.resetOrientation(r),r}),!1)},t.prototype.finish=function(){var t=this;this.ent&&(e.prototype.finish.call(this),this.ent.position=new Cesium.CallbackProperty((function(e,i){var r=t.calcuteShape(t._singleControlPosition,e);return t.resetOrientation(r),r}),!1))},t.prototype.delete=function(){e.prototype.delete.call(this),VS.getInstance().remove()},MS([dy({name:"不透明度",group:"通用",order:2,subGroup:"不透明度",subOrder:3,type:"slider",max:1,min:0}),ES("design:type",Number)],t.prototype,"alpha",void 0),MS([dy({name:"填充",group:"外观",order:8,subGroup:"填充",subOrder:1,type:"checkboxSub"}),ES("design:type",Boolean)],t.prototype,"fill",void 0),MS([dy({name:"颜色",group:"外观",order:8,subGroup:"填充",subOrder:2,type:"color"}),ES("design:type",String)],t.prototype,"color",void 0),MS([dy({name:"边框",group:"外观",order:8,subGroup:"边框",subOrder:3,type:"checkboxSub"}),ES("design:type",Boolean)],t.prototype,"outline",void 0),MS([dy({name:"边框颜色",group:"外观",subGroup:"边框",subOrder:4,order:8,type:"color"}),ES("design:type",String)],t.prototype,"outlineColor",void 0),MS([dy({name:"朝向",group:"外观",order:8,subGroup:"朝向",subOrder:9,type:"numberNew",min:-360,max:360}),ES("design:type",Number)],t.prototype,"heading",void 0),MS([dy({name:"俯仰",group:"外观",order:8,subGroup:"俯仰",subOrder:10,type:"numberNew",min:-360,max:360}),ES("design:type",Number)],t.prototype,"pitch",void 0),MS([dy({name:"倾斜",group:"外观",order:8,subGroup:"倾斜",subOrder:11,type:"numberNew",min:-360,max:360}),ES("design:type",Number)],t.prototype,"roll",void 0),t}(rv);var DS=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),IS=function(){return IS=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},IS.apply(this,arguments)},RS=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},HS=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},FS=function(e){function t(t,i,r){var n=e.call(this,t,i,IS({},r))||this;if(n.scaleZProperty=["z"],n.scaleXProperty=["x"],n.scaleYProperty=["y"],n.scaleProperty=["x","y","z"],n.type="立方体",n.x=100*n.numScale,n.y=100*n.numScale,n.z=100*n.numScale,r&&r.properties)for(var o in r.properties)n[o]=r.properties[o];return n}return DS(t,e),t.prototype.initProps=function(e){},t.prototype.scaleZ=function(e,t){this.z+=(e.y-t.y)*this.numScale},t.prototype.scaleX=function(e,t){this.x+=10*this.calcMouseDelta(e,t)},t.prototype.scaleY=function(e,t){this.y+=10*this.calcMouseDelta(e,t)},t.prototype.scale=function(e,t){if(this.scalable){var i=10*this.calcMouseDelta(e,t);this.x=this.x+=i,this.y=this.y+=i,this.z=this.z+=i}},t.prototype.initShape=function(){var t=this;e.prototype.initShapeCube.call(this,"box",[{dimensions:new Cesium.CallbackProperty((function(e,i){return new Cesium.Cartesian3(t.x,t.y,t.z)}),!1)}])},RS([dy({name:"长",group:"外观",order:8,subGroup:"长",subOrder:5,type:"numberNew",min:0,max:9999999999}),HS("design:type",Number)],t.prototype,"x",void 0),RS([dy({name:"宽",group:"外观",order:8,subGroup:"宽",subOrder:6,type:"numberNew",min:0,max:9999999999}),HS("design:type",Number)],t.prototype,"y",void 0),RS([dy({name:"高",group:"外观",order:8,subGroup:"高",subOrder:7,type:"numberNew",min:0,max:9999999999}),HS("design:type",Number)],t.prototype,"z",void 0),t}(LS);const NS=FS;c.Z.registerType(FS,"EditorCubeBox","Graph");var QS=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),kS=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},US=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};"undefined"==typeof Cesium&&(i.g.Cesium={},i.g.Cesium.Viewer={},i.g.Cesium.HeightReference={});var jS=function(e){function t(t,i,r){var n=e.call(this,t,i)||this;return n.type="点",n.heightReference=Cesium.HeightReference.RELATIVE_TO_GROUND,n}return QS(t,e),Object.defineProperty(t.prototype,"heightReference",{get:function(){return this.viewer.scene.mode==Cesium.SceneMode.SCENE3D?this._heightReference:Cesium.HeightReference.NONE},set:function(e){"string"==typeof e&&(e=Number.parseInt(e)),$P.saveProp(this.type,"heightReference",e),this._heightReference=e,this.resetHeightReference()},enumerable:!1,configurable:!0}),kS([dy({name:"高程选项",group:"通用",showGroup:!1,type:"option",order:2,options:$A.heightReferenceOption}),US("design:type",Number),US("design:paramtypes",[Number])],t.prototype,"heightReference",null),t}(rv),GS=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),zS=function(){return zS=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},zS.apply(this,arguments)},YS=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},ZS=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},WS=function(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],r=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},XS=function(e){function t(t,i,r){var n=e.call(this,t,i,zS({},r))||this;n.maxPointNum=1,n.minPointNum=1,n.numScale=1,n.scaleProperty=["scalev"],n.scaleXProperty=["scalev"],n.scaleYProperty=["scalev"],n.scaleZProperty=["scalev"],n.rotateByHeadingProperty=["heading"],n.rotateByPitchProperty=["pitch"],n.rotateByRollProperty=["roll"],n.type="3D模型",n.color="#ffffff",n.alpha=1,n.scalev=30,n.uri="../../lib/resources/model/shop.glb",n.heading=0,n.pitch=0,n.roll=0,n.miniPixelSize=50,n.distanceDisplay=!1,n.distanceHeight=55e5;var o=Math.ceil(t.viewer.camera.positionCartographic.height);if(n.numScale=Math.ceil(.008*o),n.scalev=n.numScale,r&&r.properties)for(var s in r.properties)n[s]=r.properties[s];return n}return GS(t,e),Object.defineProperty(t.prototype,"distanceDisplay",{get:function(){return this._distanceDisplay},set:function(e){this._distanceDisplay=e,this.ent},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"distanceHeight",{get:function(){return this._distanceHeight},set:function(e){this._distanceHeight=e,this.ent},enumerable:!1,configurable:!0}),t.prototype.initProps=function(e){},t.prototype.resetOrientation=function(e){this.headingPR.heading=Cesium.Math.toRadians(this.heading),this.headingPR.pitch=Cesium.Math.toRadians(this.pitch),this.headingPR.roll=Cesium.Math.toRadians(this.roll);var t=e||this.ent.position.getValue(Cesium.JulianDate.now());this.orientation=Cesium.Transforms.headingPitchRollQuaternion(t,this.headingPR)},t.prototype.initShape=function(){var e=this;this.headingPR=new Cesium.HeadingPitchRoll,this.ent=this.entities.add(new Cesium.Entity({model:{}})),this.ent.show=this.show,this.fillShape(this.ent),Object.assign(this.ent.model,{runAnimations:!1,heightReference:new Cesium.CallbackProperty((function(t,i){return e.heightReference}),!0),uri:new Cesium.CallbackProperty((function(t,i){return e.uri}),!0),scale:new Cesium.CallbackProperty((function(t,i){return e.scalev}),!0),minimumPixelSize:new Cesium.CallbackProperty((function(t,i){return e.miniPixelSize}),!1),color:new Cesium.CallbackProperty((function(t,i){var r=Cesium.Color.fromCssColorString(e.color).withAlpha(e.alpha);return e.ent.highLighted?r.brighten(.6,new Cesium.Color):r}),!0),distanceDisplayCondition:new Cesium.CallbackProperty((function(t,i){if(e.distanceDisplay)return new Cesium.DistanceDisplayCondition(0,e.distanceHeight)}),!0)}),this.ent.position=new Cesium.CallbackProperty((function(t,i){return e.calcuteShape(e._singleControlPosition.concat($A.cursorPos),t)}),!1),this.ent.orientation=new Cesium.CallbackProperty((function(){return e.orientation}),!0)},t.prototype.scale=function(e,t){this.scalable&&(this.scalev=this.changeScaleByMouse(this.scalev,e,t),this.onPropertyChanged())},t.prototype.rotateByHeading=function(e,t){if(this.rotatable){var i=this.heading+(t.x-e.x);i=this.handle360(i),this.heading=i,this.onPropertyChanged()}},t.prototype.rotateByPitch=function(e,t){var i=this.pitch+(t.x-e.x);i=this.handle360(i),this.pitch=i,this.onPropertyChanged()},t.prototype.rotateByRoll=function(e,t){var i=this.roll+(t.x-e.x);i=this.handle360(i),this.roll=i,this.onPropertyChanged()},t.prototype.handle360=function(e){return e>360&&(e-=360),e<-360&&(e+=360),e},t.prototype.calcuteShape=function(e,t){return e.length<this.minPointNum?[]:null==e[0]?Cesium.Cartesian3.fromDegrees(123,23):(this.setInternalControlPosition(e,t),e[0])},t.prototype.toEdit=function(){var t=this;e.prototype.toEdit.call(this),this.ent.position=new Cesium.CallbackProperty((function(e,i){var r=t.calcuteShape(t._singleControlPosition,e);return t.resetOrientation(r),r}),!1),this.getModelPrimitive()},t.prototype.finish=function(){var t=this;this.ent&&(e.prototype.finish.call(this),this.ent.position=new Cesium.CallbackProperty((function(e,i){var r=t.calcuteShape(t._singleControlPosition,e);return t.resetOrientation(r),r}),!1),this.getModelPrimitive())},t.prototype.getModelPrimitive=function(){var e,t;if(!this.modelPrimitive){var i=this.viewer.scene.primitives._primitives;try{for(var r=WS(i),n=r.next();!n.done;n=r.next()){var o=n.value;if(o instanceof Cesium.Model&&o.id.id===this.gvolGuid){this.modelPrimitive=o;break}}}catch(t){e={error:t}}finally{try{n&&!n.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}}},t.prototype.rotateHeadingByAngle=function(e,t){var i=e-t+1*this.heading;i=this.handle360(i),this.heading=i},t.prototype.rotatePitchByAngle=function(e,t){var i=t-e+1*this.pitch;i=this.handle360(i),this.pitch=i},t.prototype.rotateRollByAngle=function(e,t){var i=t-e+1*this.roll;i=this.handle360(i),this.roll=i},t.prototype.getRadius=function(){return this.modelPrimitive?this.modelPrimitive.boundingSphere.radius:0},t.prototype.scaleX=function(e,t){this.scale(e,t)},t.prototype.scaleY=function(e,t){this.scale(e,t)},t.prototype.scaleZ=function(e,t){this.scale(e,t)},t.prototype.delete=function(){e.prototype.delete.call(this),VS.getInstance().remove()},YS([(0,fy.o)(),ZS("design:type",Object)],t.prototype,"numScale",void 0),YS([(0,fy.o)(),ZS("design:type",Object)],t.prototype,"modelPrimitive",void 0),YS([dy({name:"颜色",group:"外观",type:"color",order:8}),ZS("design:type",String)],t.prototype,"color",void 0),YS([dy({name:"不透明度",group:"通用",order:2,subGroup:"不透明度",subOrder:5,type:"slider",max:1,min:0}),ZS("design:type",Number)],t.prototype,"alpha",void 0),YS([dy({name:"缩放",group:"外观",order:8,subOrder:10,type:"numberZoom"}),ZS("design:type",Number)],t.prototype,"scalev",void 0),YS([dy({name:"模型",group:"外观",order:8,type:"address"}),ZS("design:type",String)],t.prototype,"uri",void 0),YS([dy({name:"朝向",group:"外观",order:8,subOrder:1,type:"numberNew",min:-360,max:360}),ZS("design:type",Number)],t.prototype,"heading",void 0),YS([dy({name:"俯仰",group:"外观",order:8,subOrder:2,type:"numberNew",min:-360,max:360}),ZS("design:type",Number)],t.prototype,"pitch",void 0),YS([dy({name:"倾斜",group:"外观",order:8,subOrder:3,type:"numberNew",min:-360,max:360}),ZS("design:type",Number)],t.prototype,"roll",void 0),YS([dy({name:"最小像素",group:"外观",order:8,type:"number",min:0}),ZS("design:type",Number)],t.prototype,"miniPixelSize",void 0),YS([(0,fy.o)(),ZS("design:type",Object)],t.prototype,"followTargetId",void 0),YS([(0,fy.o)(),ZS("design:type",Object)],t.prototype,"deltaLng",void 0),YS([(0,fy.o)(),ZS("design:type",Object)],t.prototype,"deltaLat",void 0),YS([(0,fy.o)(),ZS("design:type",Object)],t.prototype,"deltaAlt",void 0),YS([(0,fy.o)(),ZS("design:type",Object)],t.prototype,"deltaHeading",void 0),YS([(0,fy.o)(),ZS("design:type",Object)],t.prototype,"prevHeading",void 0),YS([(0,fy.o)(),ZS("design:type",Object)],t.prototype,"entityPositionMove",void 0),YS([dy({name:"可视高度",group:"通用",subGroup:"可视高度",subOrder:1,type:"checkboxSub",order:2,hiddenGroupName:!1}),ZS("design:type",Boolean),ZS("design:paramtypes",[Boolean])],t.prototype,"distanceDisplay",null),YS([dy({name:"可视高度距离",group:"通用",subGroup:"可视高度",subOrder:2,type:"number3",order:2,hiddenGroupName:!1,min:0,max:2e7}),ZS("design:type",Number),ZS("design:paramtypes",[Number])],t.prototype,"distanceHeight",null),t}(jS);const JS=XS;c.Z.registerType(XS,"EditorModel","Graph");var KS=i(5108),VS=function(){function e(){this.numScale=0,this.isShow=!1,this.blueLength=0}return e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.init=function(e){if(!this.viewer){this.viewer=e;var t=Math.ceil(e.camera.positionCartographic.height);this.numScale=Math.ceil(2e-7*t)}this.operatorList=[{name:"blueCircle",ToolTip:"水平旋转",Operator:this.rotateHeading,property:function(e){return["heading"]}},{name:"redCircle",ToolTip:"竖直旋转",Operator:this.rotateRoll,property:function(e){return["roll"]}},{name:"yellowCircle",ToolTip:"俯仰旋转",Operator:this.rotatePitch,property:function(e){return["pitch"]}},{name:"redLine",ToolTip:"X轴缩放",Operator:this.scaleX,property:function(e){return e.scaleXProperty}},{name:"yellowLine",ToolTip:"y轴缩放",Operator:this.scaleY,property:function(e){return e.scaleYProperty}},{name:"blueLine",ToolTip:"z轴缩放",Operator:this.scaleZ,property:function(e){return e.scaleZProperty}}]},e.prototype.show=function(e,t){var i=1e3;if(e instanceof NS)i=e.x;else{if(!(e instanceof JS))return;i=e.getRadius()}this.isShow||this.addOperator(t,i),this.isShow=!0},e.prototype.remove=function(){this.blueCircle&&(this.isShow=!1,this.viewer.entities.remove(this.blueCircle),this.viewer.entities.remove(this.redCircle),this.viewer.entities.remove(this.yellowCircle),this.viewer.entities.remove(this.blueAxis),this.viewer.entities.remove(this.redAxis),this.viewer.entities.remove(this.yellowAxis))},e.prototype.reset=function(){this.isShow&&(this.blueCircle.ellipsoid.material=new Cesium.ColorMaterialProperty(Cesium.Color.BLUE.withAlpha(.3)),this.yellowCircle.ellipsoid.material=new Cesium.ColorMaterialProperty(Cesium.Color.YELLOW.withAlpha(.3)),this.redCircle.ellipsoid.material=new Cesium.ColorMaterialProperty(Cesium.Color.RED.withAlpha(.3)),this.blueAxis.polyline.material=new Cesium.PolylineArrowMaterialProperty(Cesium.Color.BLUE),this.redAxis.polyline.material=new Cesium.PolylineArrowMaterialProperty(Cesium.Color.RED),this.yellowAxis.polyline.material=new Cesium.PolylineArrowMaterialProperty(Cesium.Color.YELLOW))},e.prototype.controlAxis=function(e,t){var i=Math.ceil(this.viewer.camera.positionCartographic.height);switch(this.numScale=.001*i,KS.log("numScale",this.numScale),this.currentGraph=t,this.currentAxis=e,e){case"blueCircle":this.blueCircle.ellipsoid.material=new Cesium.ColorMaterialProperty(Cesium.Color.BLUE),this.yellowCircle.ellipsoid.material=new Cesium.ColorMaterialProperty(Cesium.Color.TRANSPARENT),this.redCircle.ellipsoid.material=new Cesium.ColorMaterialProperty(Cesium.Color.TRANSPARENT),this.redAxis.polyline.material=new Cesium.ColorMaterialProperty(Cesium.Color.TRANSPARENT),this.yellowAxis.polyline.material=new Cesium.ColorMaterialProperty(Cesium.Color.TRANSPARENT);break;case"blueLine":this.blueCircle.ellipsoid.material=new Cesium.ColorMaterialProperty(Cesium.Color.TRANSPARENT),this.yellowCircle.ellipsoid.material=new Cesium.ColorMaterialProperty(Cesium.Color.TRANSPARENT),this.redCircle.ellipsoid.material=new Cesium.ColorMaterialProperty(Cesium.Color.TRANSPARENT),this.redAxis.polyline.material=new Cesium.ColorMaterialProperty(Cesium.Color.TRANSPARENT),this.yellowAxis.polyline.material=new Cesium.ColorMaterialProperty(Cesium.Color.TRANSPARENT);break;case"redCircle":this.redCircle.ellipsoid.material=new Cesium.ColorMaterialProperty(Cesium.Color.RED),this.blueCircle.ellipsoid.material=new Cesium.ColorMaterialProperty(Cesium.Color.TRANSPARENT),this.yellowCircle.ellipsoid.material=new Cesium.ColorMaterialProperty(Cesium.Color.TRANSPARENT),this.blueAxis.polyline.material=new Cesium.ColorMaterialProperty(Cesium.Color.TRANSPARENT),this.yellowAxis.polyline.material=new Cesium.ColorMaterialProperty(Cesium.Color.TRANSPARENT);break;case"redLine":this.redCircle.ellipsoid.material=new Cesium.ColorMaterialProperty(Cesium.Color.TRANSPARENT),this.blueCircle.ellipsoid.material=new Cesium.ColorMaterialProperty(Cesium.Color.TRANSPARENT),this.yellowCircle.ellipsoid.material=new Cesium.ColorMaterialProperty(Cesium.Color.TRANSPARENT),this.blueAxis.polyline.material=new Cesium.ColorMaterialProperty(Cesium.Color.TRANSPARENT),this.yellowAxis.polyline.material=new Cesium.ColorMaterialProperty(Cesium.Color.TRANSPARENT);break;case"yellowCircle":this.yellowCircle.ellipsoid.material=new Cesium.ColorMaterialProperty(Cesium.Color.YELLOW),this.blueCircle.ellipsoid.material=new Cesium.ColorMaterialProperty(Cesium.Color.TRANSPARENT),this.redCircle.ellipsoid.material=new Cesium.ColorMaterialProperty(Cesium.Color.TRANSPARENT),this.redAxis.polyline.material=new Cesium.ColorMaterialProperty(Cesium.Color.TRANSPARENT),this.blueAxis.polyline.material=new Cesium.ColorMaterialProperty(Cesium.Color.TRANSPARENT);break;case"yellowLine":this.yellowCircle.ellipsoid.material=new Cesium.ColorMaterialProperty(Cesium.Color.TRANSPARENT),this.blueCircle.ellipsoid.material=new Cesium.ColorMaterialProperty(Cesium.Color.TRANSPARENT),this.redCircle.ellipsoid.material=new Cesium.ColorMaterialProperty(Cesium.Color.TRANSPARENT),this.redAxis.polyline.material=new Cesium.ColorMaterialProperty(Cesium.Color.TRANSPARENT),this.blueAxis.polyline.material=new Cesium.ColorMaterialProperty(Cesium.Color.TRANSPARENT)}},e.prototype.mouseMove=function(e){var t=this,i=this.operatorList.find((function(e){return e.name===t.currentAxis}));i&&i.Operator.call(this,e)},e.prototype.rotateHeading=function(e){var t=this.getStartEndAngleByMoveEvent(e);this.currentGraph.rotateHeadingByAngle(t.startAngle,t.endAngle)},e.prototype.rotateRoll=function(e){var t=this.getStartEndAngleByMoveEvent(e);this.currentGraph.rotateRollByAngle(t.startAngle,t.endAngle)},e.prototype.rotatePitch=function(e){var t=this.getStartEndAngleByMoveEvent(e);this.currentGraph.rotatePitchByAngle(t.startAngle,t.endAngle)},e.prototype.scaleX=function(e){this.currentGraph.scaleX(e.startPosition,e.endPosition)},e.prototype.scaleY=function(e){this.currentGraph.scaleY(e.endPosition,e.startPosition)},e.prototype.scaleZ=function(e){this.currentGraph.scaleZ(e.endPosition,e.startPosition)},e.prototype.getStartEndAngleByMoveEvent=function(e){var t=Cesium.SceneTransforms.wgs84ToWindowCoordinates(this.viewer.scene,this.currentGraph.getCenter());return{startAngle:SS.getAngle(e.startPosition,t),endAngle:SS.getAngle(e.endPosition,t)}},e.prototype.addOperator=function(e,t){var i=new Cesium.Cartesian3(t,t,t),r=.9*t,n=new Cesium.Cartesian3(r,r,r),o={name:"blueCircle",position:e,ellipsoid:{radii:i,innerRadii:n,minimumCone:Cesium.Math.toRadians(88),maximumCone:Cesium.Math.toRadians(92),material:Cesium.Color.BLUE.withAlpha(.3)}};this.blueCircle=this.addControlEntity(o);var s=new Cesium.HeadingPitchRoll(0,Cesium.Math.toRadians(90),0),a={name:"redCircle",position:e,ellipsoid:{radii:i,innerRadii:n,minimumCone:Cesium.Math.toRadians(88),maximumCone:Cesium.Math.toRadians(92),material:Cesium.Color.RED.withAlpha(.3)},orientation:Cesium.Transforms.headingPitchRollQuaternion(e,s)};this.redCircle=this.addControlEntity(a);var l=new Cesium.HeadingPitchRoll(0,0,Cesium.Math.toRadians(90)),h={name:"yellowCircle",position:e,ellipsoid:{radii:i,innerRadii:n,minimumCone:Cesium.Math.toRadians(88),maximumCone:Cesium.Math.toRadians(92),material:Cesium.Color.YELLOW.withAlpha(.3)},orientation:Cesium.Transforms.headingPitchRollQuaternion(e,l)};this.yellowCircle=this.addControlEntity(h);var c=2*t;this.blueLength=.8*c,this.originPosition=e;var u=this.getPosByLengthZ(c),p=this.getPosByLengthX(c),d=this.getPosByLengthY(c),m={name:"blueLine",polyline:{positions:[this.originPosition,u],width:10,material:new Cesium.PolylineArrowMaterialProperty(Cesium.Color.BLUE)}};this.blueAxis=this.addControlEntity(m);var f={name:"yellowLine",polyline:{positions:[this.originPosition,p],width:10,material:new Cesium.PolylineArrowMaterialProperty(Cesium.Color.YELLOW)}};this.yellowAxis=this.addControlEntity(f);var g={name:"redLine",polyline:{positions:[this.originPosition,d],width:10,material:new Cesium.PolylineArrowMaterialProperty(Cesium.Color.RED)}};this.redAxis=this.addControlEntity(g)},e.prototype.getPosByLengthY=function(e){var t=new Cesium.Matrix4,i=Cesium.Transforms.eastNorthUpToFixedFrame(this.originPosition);Cesium.Matrix4.setTranslation(Cesium.Matrix4.IDENTITY,new Cesium.Cartesian3(e,0,0),t);var r=Cesium.Matrix4.multiply(i,t,i);return Cesium.Matrix4.getTranslation(r,Cesium.Cartesian3.clone(this.originPosition))},e.prototype.getPosByLengthX=function(e){var t=new Cesium.Matrix4,i=Cesium.Transforms.eastNorthUpToFixedFrame(this.originPosition);Cesium.Matrix4.setTranslation(Cesium.Matrix4.IDENTITY,new Cesium.Cartesian3(0,-e,0),t);var r=Cesium.Matrix4.multiply(i,t,i);return Cesium.Matrix4.getTranslation(r,Cesium.Cartesian3.clone(this.originPosition))},e.prototype.getPosByLengthZ=function(e){var t=new Cesium.Matrix4,i=Cesium.Transforms.eastNorthUpToFixedFrame(this.originPosition);Cesium.Matrix4.setTranslation(Cesium.Matrix4.IDENTITY,new Cesium.Cartesian3(0,0,e),t);var r=Cesium.Matrix4.multiply(i,t,i);return Cesium.Matrix4.getTranslation(r,Cesium.Cartesian3.clone(this.originPosition))},e.prototype.addControlEntity=function(e){return e.isAxisController=!0,this.viewer.entities.add(e)},e}(),qS=i(5108),$S=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),ex=function(){return ex=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},ex.apply(this,arguments)},tx=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},ix=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},rx=function(e){function t(t,i,r){var n=e.call(this,t,i,ex({},r))||this;if(n.maxPointNum=1,n.minPointNum=1,n.firstEditText=!0,n._width=8e3,n._height=8e3,n.firstEditScale=!0,n.scaleProperty=["scalev"],n.rotateByHeadingProperty=["rotation"],n.type="图标",n.image=qh.formatUrlByBaseJs("/resources/image/gpoint.svg"),n.alpha=1,n.textColor="#ffffff",n.textSize=16,n.textFont="黑体",n.textColor="#ffffff",n.textOffsetX=0,n.textOffsetY=0,n.fontWeight="normal",n.showMode=0,n.isScaleDefulat=!1,n.scalev=1,n.rotation=0,n.imageOffsetX=0,n.imageOffsetY=0,n.scaleMaxSize=4,n.scaleMinSize=1,n.distanceDisplay=!1,n.distanceHeight=55e5,n.heightReference=Cesium.HeightReference.NONE,n.hideValues=["gridSwitch","gridLevel","gridIsAgg","gridColor","gridOutlineColor","gridUpdate"],r&&r.properties)for(var o in r.properties)n[o]=r.properties[o];return n}return $S(t,e),t.prototype.setPrimitivePosition=function(e){var t,i;if(e instanceof Array||(e=[e]),e[0]||(e=e.slice(1)),!(e.length<1))if(this.setInternalControlPosition(e),0==this.showMode)this.label.position=e[0],this.billboard.position=e[0];else{var r=e[0],n=Cesium.Math.toRadians(this.rotation),o=new Cesium.HeadingPitchRoll(n,0,0),s=Cesium.Transforms.headingPitchRollToFixedFrame(r,o,Cesium.Ellipsoid.WGS84,Cesium.Transforms.eastNorthUpToFixedFrame,new Cesium.Matrix4);if(2==this.showMode){var a=Cesium.Matrix4.fromRotationTranslation(Cesium.Matrix3.fromRotationX(Cesium.Math.toRadians(90)));Cesium.Matrix4.multiply(s,a,s)}var l=0,h=8e3;if(0===this._width||8e3===this._width&&8e3===this._height){if(this.material&&this.material._textures&&this.material._textures.image1&&(l=this.material._textures.image1.width),l){var c=1;l*=c=l>(h=null===(i=null===(t=this.material)||void 0===t?void 0:t._textures)||void 0===i?void 0:i.image1.height)?8e3/l:8e3/h,h*=c}else l=8e3;this._width=l,this._height=h}else l=this._width,h=this._height;var u=new Cesium.Cartesian3(l*this.scalev,h*this.scalev,1),p=Cesium.Matrix4.fromScale(u);Cesium.Matrix4.multiply(s,p,s),this.ent.modelMatrix=s}},t.prototype.initProps=function(e){},Object.defineProperty(t.prototype,"heightReference",{get:function(){return this._heightReference},set:function(e){"string"==typeof e&&(e=Number.parseInt(e)),this._heightReference=e,0==this.showMode&&this.ent&&(this.label.heightReference=this.heightReference,this.label._labelCollection._billboardCollection._scene||(this.label._labelCollection._billboardCollection._scene=this.viewer.scene),this.billboard.heightReference=this.heightReference),this.resetHeightReference()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"showMode",{get:function(){return this._showMode},set:function(e){this._showMode=e,this.ent&&this.createEnt(this._singleControlPosition[0])},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rotation",{get:function(){return this._rotation},set:function(e){var t=this;this._rotation=e,new Promise((function(e,i){t.ent?e(t.ent):i()})).then((function(e){t.Rotation()}),(function(e){t.ent&&t.Rotation()}))},enumerable:!1,configurable:!0}),t.prototype.Rotation=function(){0==this.showMode?this.billboard.rotation=3.14*(360-this.rotation)/180:this.setPrimitivePosition(this._singleControlPosition)},Object.defineProperty(t.prototype,"isScaleDefulat",{get:function(){return this._isScaleDefulat},set:function(e){this._isScaleDefulat=e,this.scalev=this._isScaleDefulat?this.scalev:1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"scalev",{get:function(){return this._scalev},set:function(e){$P.saveProp(this.type,"scalev",e),this._scalev=e,this.ent&&(this.firstEditScale=!1,0==this.showMode?this.billboard.scale=e:this.setPrimitivePosition(this._singleControlPosition))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"imageOffsetX",{get:function(){return this._imageOffsetX},set:function(e){this._imageOffsetX=e,this.ent&&0==this.showMode&&(this.billboard.pixelOffset=new Cesium.Cartesian2(this.imageOffsetX,this.imageOffsetY))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"imageOffsetY",{get:function(){return this._imageOffsetY},set:function(e){this._imageOffsetY=e,this.ent&&0==this.showMode&&(this.billboard.pixelOffset=new Cesium.Cartesian2(this.imageOffsetX,this.imageOffsetY))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"scaleByDistance",{get:function(){return this._scaleByDistance},set:function(e){$P.saveProp(this.type,"scaleByDistance",e),this._scaleByDistance=e,this.ent&&0==this.showMode&&this.setScaleByDistance()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"scaleMaxSize",{get:function(){return this._scaleMaxSize},set:function(e){$P.saveProp(this.type,"scaleMaxSize",e),this._scaleMaxSize=e,this.ent&&0==this.showMode&&this.setScaleByDistance()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"scaleMinSize",{get:function(){return this._scaleMinSize},set:function(e){$P.saveProp(this.type,"scaleMinSize",e),this._scaleMinSize=e,this.ent&&0==this.showMode&&this.setScaleByDistance()},enumerable:!1,configurable:!0}),t.prototype.setScaleByDistance=function(){this.label.pixelOffsetScaleByDistance=this.scaleByDistance?new Cesium.NearFarScalar(150,this.scaleMaxSize,15e6,this.scaleMinSize):void 0,this.label.scaleByDistance=this.scaleByDistance?new Cesium.NearFarScalar(150,this.scaleMaxSize,15e6,this.scaleMinSize):void 0,this.billboard.pixelOffsetScaleByDistance=this.scaleByDistance?new Cesium.NearFarScalar(150,this.scaleMaxSize,15e6,this.scaleMinSize):void 0,this.billboard.scaleByDistance=this.scaleByDistance?new Cesium.NearFarScalar(150,this.scaleMaxSize,15e6,this.scaleMinSize):void 0},Object.defineProperty(t.prototype,"image",{get:function(){return this._image},set:function(e){this._image=e,this.billboard&&(this.billboard.image=e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"alpha",{get:function(){return this._alpha},set:function(e){this._alpha=e,this.ent&&(0==this.showMode?(this.label.fillColor=Cesium.Color.fromCssColorString(this.textColor).withAlpha(this.alpha),this.billboard.color=Cesium.Color.WHITE.withAlpha(this.alpha)):this.setColor(this.ent.appearance.material))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"text",{get:function(){return this._text},set:function(e){this._text=e,this.ent&&(0==this.showMode?this.label.text=e:this.editCanvas())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"textFont",{get:function(){return this._textFont},set:function(e){this._textFont=e,this.ent&&(0===this.showMode?this.label.font=this._fontWeight+" "+this.textSize+"px "+this.textFont:this.editCanvas())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"textSize",{get:function(){return this._textSize},set:function(e){this._textSize=Number(e),this.ent&&(0===this.showMode?(this.label.font=this._fontWeight+" "+e+"px "+this.textFont,this.label.pixelOffset&&(this.label.pixelOffset=new Cesium.Cartesian2(this.textOffsetX,this.textOffsetY+Number(e)+5))):this.editCanvas())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontWeight",{get:function(){return this._fontWeight},set:function(e){this._fontWeight=e,this.ent&&(0===this.showMode?this.label.font=this._fontWeight+" "+this.textSize+"px "+this.textFont:this.editCanvas())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"textOffsetX",{get:function(){return this._textOffsetX},set:function(e){this._textOffsetX=e,this.ent&&0==this.showMode&&(this.label.font=this.fontWeight+" "+this.textSize+"px "+this.textFont,this.label.pixelOffset=new Cesium.Cartesian2(this.textOffsetX,this.textOffsetY+Number(this.textSize)+5))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"textOffsetY",{get:function(){return this._textOffsetY},set:function(e){this._textOffsetY=e,this.ent&&0==this.showMode&&(this.label.font=this.fontWeight+" "+this.textSize+"px "+this.textFont,this.label.pixelOffset=new Cesium.Cartesian2(this.textOffsetX,this.textOffsetY+Number(this.textSize)+5))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"textColor",{get:function(){return this._textColor},set:function(e){this._textColor=e,this.ent&&(0==this.showMode?this.label.fillColor=Cesium.Color.fromCssColorString(e).withAlpha(this.alpha):this.setColor(this.ent.appearance.material))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"distanceDisplay",{get:function(){return this._distanceDisplay},set:function(e){this._distanceDisplay=e,this.ent&&this.createEnt(this._singleControlPosition[0])},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"distanceHeight",{get:function(){return this._distanceHeight},set:function(e){this._distanceHeight=e,this.ent&&this.createEnt(this._singleControlPosition[0])},enumerable:!1,configurable:!0}),t.prototype.distanceCondition=function(){return this.distanceDisplay?new Cesium.DistanceDisplayConditionGeometryInstanceAttribute(0,this.distanceHeight):void 0},t.prototype.scale=function(e,t){this.scalable&&(this.scalev=this.changeScaleByMouse(this.scalev,e,t),this.onPropertyChanged())},t.prototype.rotateByHeading=function(e,t){if(this.rotatable){var i=this.rotation+(t.x-e.x);this.rotation=i%360,this.onPropertyChanged()}},t.prototype.createHiDPICanvas=function(e,t,i){var r,n,o=(n=document.createElement("canvas").getContext("2d")||{},(window.devicePixelRatio||1)/(n.webkitBackingStorePixelRatio||n.mozBackingStorePixelRatio||n.msBackingStorePixelRatio||n.oBackingStorePixelRatio||n.backingStorePixelRatio||1));i||(i=o);var s=document.createElement("canvas");return s.width=e*i,s.height=t*i,null===(r=s.getContext("2d"))||void 0===r||r.setTransform(i,0,0,i,0,0),s},t.prototype.drawText=function(){var e=this.createHiDPICanvas(200,200,3),t=e.getContext("2d");if(t.fillStyle="white",t.font=this.fontWeight+this.textSize+"px "+this.textFont,t.textBaseline="hanging",this.text&&this.text.length>0)for(var i=this.text,r=0,n=e.width/3,o=15,s=0,a=0;a<i.length;a++)(r+=t.measureText(i[a]).width)>n&&(t.fillText(i.substring(s,a),0,o),o+=Number(this.textSize),r=0,s=a),a==i.length-1&&t.fillText(i.substring(s,a+1),0,o);return e},t.prototype.createMaterial=function(){var e={type:"OurMappedPlastic",uniforms:{image1:Cesium.Material.DefaultImageId,image2:Cesium.Material.DefaultImageId,repeat:new Cesium.Cartesian2(1,1),color:new Cesium.Color(1,1,1,1)},source:"\n      czm_material czm_getMaterial(czm_materialInput materialInput) \n         {\n             czm_material material = czm_getDefaultMaterial(materialInput); \n             vec2 st = materialInput.st; \n             vec4 colorImage1=texture2D(image1,st);\n             vec4 colorImage2=texture2D(image2,st);\n             if(colorImage2.a>0.0){\n              material.diffuse = colorImage2.rgb;\n              material.diffuse= material.diffuse*color.rgb;\n             }\n             else{\n              material.diffuse = colorImage1.rgb;\n             }\n             if(colorImage1.a>colorImage2.a){\n              material.alpha=colorImage1.a;\n             }\n             else{\n              material.alpha=colorImage2.a;\n             }\n             material.alpha=material.alpha*color.a;\n              return material;\n         }"};return this.material||(this.material=new Cesium.Material({fabric:e}),this.material.uniforms.image1=this.image,this.material.uniforms.image2=this.drawText()),this.setColor(this.material),this.material},t.prototype.setColor=function(e){e.uniforms.color=Cesium.Color.fromCssColorString(this.textColor).withAlpha(1==this.alpha?.99999:this.alpha)},t.prototype.createEnt=function(e){var t=this;if(this.billboardCollection||(this.billboardCollection=new Cesium.BillboardCollection,this.billboardCollection._scene=this.viewer.scene,this.viewer.scene.primitives.add(this.billboardCollection)),this.labelCollection||(this.labelCollection=new Cesium.LabelCollection,this.labelCollection._scene=this.viewer.scene,this.viewer.scene.primitives.add(this.labelCollection)),this.billboard&&(this.labelCollection.remove(this.label),this.billboardCollection.remove(this.billboard)),this.ent instanceof Cesium.Primitive&&this.viewer.scene.primitives.remove(this.ent),0==this.showMode)this.label=this.labelCollection.add({text:this.text,show:this.show,scale:this.scalev,font:this.fontWeight+" "+this.textSize+"px "+this.textFont,fillColor:Cesium.Color.fromCssColorString(this.textColor).withAlpha(this.alpha),pixelOffset:new Cesium.Cartesian2(this.textOffsetX,this.textOffsetY+this.textSize+5),scaleByDistance:this.scaleByDistance?new Cesium.NearFarScalar(150,this.scaleMaxSize,15e6,this.scaleMinSize):void 0,pixelOffsetScaleByDistance:this.scaleByDistance?new Cesium.NearFarScalar(150,this.scaleMaxSize,15e6,this.scaleMinSize):void 0,distanceDisplayCondition:this.distanceDisplay?new Cesium.DistanceDisplayCondition(0,this.distanceHeight):void 0}),this.billboard=this.billboardCollection.add({show:this.show,verticalOrigin:Cesium.VerticalOrigin.BOTTOM,scale:this.scalev,image:this.image,color:Cesium.Color.WHITE.withAlpha(this.alpha),pixelOffset:new Cesium.Cartesian2(this.imageOffsetX,this.imageOffsetY),scaleByDistance:this.scaleByDistance?new Cesium.NearFarScalar(150,this.scaleMaxSize,15e6,this.scaleMinSize):void 0,pixelOffsetScaleByDistance:this.scaleByDistance?new Cesium.NearFarScalar(150,this.scaleMaxSize,15e6,this.scaleMinSize):void 0,distanceDisplayCondition:this.distanceDisplay?new Cesium.DistanceDisplayCondition(0,this.distanceHeight):void 0}),this.label.heightReference=this.heightReference,this.billboard.heightReference=this.heightReference,setTimeout((function(){t.firstEditScale&&!t.isScaleDefulat&&t.billboard._imageWidth&&t.billboard._imageWidth>500&&(t.billboard.scale=500/t.billboard._imageWidth,qS.log(t.billboard.scale))}),2e3),this.ent=this.billboard;else{var i=this.createMaterial();this.setColor(i);var r={geometryInstances:new Cesium.GeometryInstance({geometry:Cesium.PlaneGeometry.createGeometry(new Cesium.PlaneGeometry({vertexFormat:Cesium.EllipsoidSurfaceAppearance.VERTEX_FORMAT})),attributes:{distanceDisplayCondition:this.distanceCondition()}}),appearance:new Cesium.EllipsoidSurfaceAppearance({material:i,flat:!0,aboveGround:!0}),asynchronous:!0,releaseGeometryInstances:!0},n=new Cesium.Primitive(r);this.ent=n,this.viewer.scene.primitives.add(n);var o=this._singleControlPosition;this.setPrimitivePosition(o)}this.fillShape(this.ent)},t.prototype.editCanvas=function(){this.ent.appearance.material.uniforms.image2=this.drawText()},t.prototype.initShape=function(){var e=this;this.createEnt(Cesium.Cartesian3.ZERO),this.positionProperty=function(){var t=e._singleControlPosition.concat($A.cursorPos);t&&e.setPrimitivePosition(t)}},t.prototype.delete=function(){e.prototype.delete.call(this),this.billboard&&(this.billboardCollection.remove(this.billboard),this.labelCollection.remove(this.label))},t.prototype.toEdit=function(){var t=this;e.prototype.toEdit.call(this),this.positionProperty=function(){var e=t._singleControlPosition;t.setPrimitivePosition(e)}},t.prototype.finish=function(){if(this.ent){e.prototype.finish.call(this),this.material&&this.material._textures&&this.material._textures.image1;var t=this._singleControlPosition;this.positionProperty=t}},Object.defineProperty(t.prototype,"show",{get:function(){return this._show},set:function(e){this._show=e,this.label&&(this.label.show=e)},enumerable:!1,configurable:!0}),tx([(0,fy.o)(),ix("design:type",Cesium.BillboardCollection)],t.prototype,"billboardCollection",void 0),tx([(0,fy.o)(),ix("design:type",Cesium.LabelCollection)],t.prototype,"labelCollection",void 0),tx([dy({name:"显示模式",group:"外观",order:8,subOrder:4,type:"option",options:[{label:"图标",value:0},{label:"平面",value:1},{label:"立面",value:2}]}),ix("design:type",Number),ix("design:paramtypes",[Object])],t.prototype,"showMode",null),tx([dy({name:"旋转",group:"外观",type:"whirl",order:8,min:-360,max:360,hiddenGroupName:!1}),ix("design:type",Number),ix("design:paramtypes",[Number])],t.prototype,"rotation",null),tx([dy({name:"是否开启缩放",group:"外观",type:"boolean",order:8}),ix("design:type",Boolean),ix("design:paramtypes",[Boolean])],t.prototype,"isScaleDefulat",null),tx([dy({name:"缩放",group:"外观",type:"zoom",order:8,min:.001,hiddenGroupName:!1}),ix("design:type",Number),ix("design:paramtypes",[Number])],t.prototype,"scalev",null),tx([dy({name:"转换为矩形",group:"转换",order:1,subGroup:"转换为矩形",subOrder:1,showGroup:!1,hiddenGroupName:!0,type:"title-changeToRect"}),ix("design:type",Boolean)],t.prototype,"changeToRect",void 0),tx([dy({name:"X",group:"外观",subGroup:"图片偏移",order:8,subOrder:1,type:"pyblock",min:-1e3,max:1e3}),ix("design:type",Number),ix("design:paramtypes",[Number])],t.prototype,"imageOffsetX",null),tx([dy({name:"Y",group:"外观",subGroup:"图片偏移",order:8,subOrder:2,type:"pyblock",min:-1e3,max:1e3}),ix("design:type",Number),ix("design:paramtypes",[Number])],t.prototype,"imageOffsetY",null),tx([dy({name:"自动缩放",group:"外观",type:"boolean",order:8,subGroup:"自动缩放",subOrder:3}),ix("design:type",Boolean),ix("design:paramtypes",[Boolean])],t.prototype,"scaleByDistance",null),tx([dy({name:"放大倍数",group:"外观",order:8,type:"number",min:2,max:10,subGroup:"放大倍数",subOrder:4}),ix("design:type",Number),ix("design:paramtypes",[Number])],t.prototype,"scaleMaxSize",null),tx([dy({name:"缩小倍数",group:"外观",order:8,type:"number",min:0,max:1,subGroup:"缩小倍数",subOrder:5}),ix("design:type",Number),ix("design:paramtypes",[Number])],t.prototype,"scaleMinSize",null),tx([dy({name:"图片",group:"外观",type:"address",order:8,min:0,max:1}),ix("design:type",String),ix("design:paramtypes",[String])],t.prototype,"image",null),tx([dy({name:"不透明度",group:"通用",type:"slider",order:2,subGroup:"不透明度",subOrder:5,min:0,max:1}),ix("design:type",Number),ix("design:paramtypes",[Number])],t.prototype,"alpha",null),tx([dy({name:"文字",group:"文本",order:6,type:"textArea",hiddenGroupName:!0}),ix("design:type",String),ix("design:paramtypes",[String])],t.prototype,"text",null),tx([dy({name:"字体",group:"文本",order:6,type:"font",hiddenGroupName:!0}),ix("design:type",String),ix("design:paramtypes",[String])],t.prototype,"textFont",null),tx([dy({name:"文字大小",group:"文本",subGroup:"大小粗细",order:6,subOrder:1,type:"size",hiddenGroupName:!0}),ix("design:type",Number),ix("design:paramtypes",[Number])],t.prototype,"textSize",null),tx([dy({name:"字体粗细",group:"文本",subGroup:"大小粗细",order:6,subOrder:2,type:"option",hiddenGroupName:!0,options:[{label:"正常",value:"normal"},{label:"加粗",value:"bold"}]}),ix("design:type",String),ix("design:paramtypes",[String])],t.prototype,"fontWeight",null),tx([dy({name:"X",group:"文本",subGroup:"文字偏移",order:6,subOrder:3,type:"pyblock"}),ix("design:type",Number),ix("design:paramtypes",[Number])],t.prototype,"textOffsetX",null),tx([dy({name:"Y",group:"文本",subGroup:"文字偏移",order:6,subOrder:4,type:"pyblock"}),ix("design:type",Number),ix("design:paramtypes",[Number])],t.prototype,"textOffsetY",null),tx([dy({name:"文字颜色",group:"文本",order:6,type:"color",subGroup:"文字颜色",subOrder:5}),ix("design:type",String),ix("design:paramtypes",[String])],t.prototype,"textColor",null),tx([dy({name:"可视高度",group:"通用",subGroup:"可视高度",subOrder:1,type:"checkboxSub",order:2,hiddenGroupName:!1}),ix("design:type",Boolean),ix("design:paramtypes",[Boolean])],t.prototype,"distanceDisplay",null),tx([dy({name:"可视高度距离",group:"通用",subGroup:"可视高度",subOrder:2,type:"number3",order:2,hiddenGroupName:!1,min:0,max:2e7}),ix("design:type",Number),ix("design:paramtypes",[Number])],t.prototype,"distanceHeight",null),tx([(0,fy.o)(),ix("design:type",Function),ix("design:paramtypes",[Object,Object,Object]),ix("design:returntype",void 0)],t.prototype,"createHiDPICanvas",null),tx([(0,fy.o)(),ix("design:type",Function),ix("design:paramtypes",[]),ix("design:returntype",void 0)],t.prototype,"drawText",null),tx([(0,fy.o)(),ix("design:type",Object)],t.prototype,"material",void 0),tx([(0,fy.o)(),ix("design:type",Cesium.Label)],t.prototype,"label",void 0),tx([(0,fy.o)(),ix("design:type",Cesium.Billboard)],t.prototype,"billboard",void 0),tx([(0,fy.o)(),ix("design:type",Function),ix("design:paramtypes",[Cesium.Cartesian3]),ix("design:returntype",void 0)],t.prototype,"createEnt",null),tx([(0,fy.o)(),ix("design:type",Function),ix("design:paramtypes",[]),ix("design:returntype",void 0)],t.prototype,"editCanvas",null),t}(nS);const nx=rx;c.Z.registerType(rx,"EditorPinImage","Graph");var ox=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),sx=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},ax=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},lx=function(e){function t(t,i,r){var n=e.call(this,t,i,{})||this;if(n.maxPointNum=1,n.minPointNum=1,n.type="粒子",n.alpha=1,n.emissionRate=4,n.particleSize=55,n.minimumParticleLife=1,n.maximumParticleLife=6,n.minimumSpeed=1,n.maximumSpeed=4,n.startScale=0,n.endScale=10,n.particleImage=n.baseUrl+"smoke.png",n.gravity=0,n.startColor="rgba(32,178,170,0.7)",n.endColor="rgba(255,255,255,0)",n.distanceDisplay=!1,n.distanceHeight=55e5,n.hideValues=["gridSwitch","gridLevel","gridIsAgg","gridColor","gridOutlineColor","gridUpdate","allowCrossGround"],r&&r.properties)for(var o in r.properties)n[o]=r.properties[o];return n}return ox(t,e),t.prototype.setPrimitivePosition=function(e){if(!this.last_pos||!this.last_pos.equals(e)){this.last_pos=e.clone();var t=Cesium.Transforms.northUpEastToFixedFrame(e);this.partical.modelMatrix=t,this.setInternalControlPosition([e])}},Object.defineProperty(t.prototype,"particleSize",{get:function(){return this._particleSize},set:function(e){this._particleSize=e,this.ent&&(this.ent.minimumImageSize=new Cesium.Cartesian2(e,e),this.ent.maximumImageSize=new Cesium.Cartesian2(e,e))},enumerable:!1,configurable:!0}),t.prototype.initProps=function(e){this.scale=null},t.prototype.initShape=function(){var e=this,t=new Cesium.HeadingPitchRoll;var i={image:this.baseUrl+this.particleImage,startColor:Cesium.Color.fromCssColorString(this.startColor),endColor:Cesium.Color.fromCssColorString(this.endColor),startScale:this.startScale,endScale:this.endScale,minimumParticleLife:this.minimumParticleLife,maximumParticleLife:this.maximumParticleLife,minimumSpeed:this.minimumSpeed,maximumSpeed:this.maximumSpeed,imageSize:new Cesium.Cartesian2(this.particleSize,this.particleSize),emissionRate:this.emissionRate,emitter:new Cesium.CircleEmitter(5),emitterModelMatrix:function(){var e=new Cesium.Cartesian3;t=Cesium.HeadingPitchRoll.fromDegrees(0,0,0,new Cesium.HeadingPitchRoll);var i=new Cesium.Quaternion,r=new Cesium.TranslationRotationScale;return r.translation=Cesium.Cartesian3.fromElements(0,0,0,e),r.rotation=Cesium.Quaternion.fromHeadingPitchRoll(t,i),Cesium.Matrix4.fromTranslationRotationScale(r,new Cesium.Matrix4)}(),updateCallback:function(e,t){return s(e,t)}},r=this.viewer.scene.primitives.add(new Cesium.ParticleSystem(i)),n=r.update,o=this;r.update=function(e){(e.time=Cesium.JulianDate.now(),n.call(r,e),o.distanceDisplay)?o.viewer.scene.camera.positionCartographic.height>o.distanceHeight?o.ent.show=!1:o.ent.show=o.show:o.ent.show=o.show},this.ent=r,this.ent.show=this.show,this.fillShape(this.ent),setTimeout((function(){e.fillShape(e.ent._billboardCollection)}),10),this.partical=r;var s=function(t,i){var r=t.position,n=new Cesium.Cartesian3;Cesium.Cartesian3.normalize(r,n),Cesium.Cartesian3.multiplyByScalar(n,e.gravity,n),t.velocity=Cesium.Cartesian3.add(t.velocity,n,t.velocity),t.startColor.alpha=e.ent.startColor.alpha*e.alpha,t.endColor.alpha=e.ent.endColor.alpha*e.alpha};this.positionProperty=function(){var t=e.calcuteShape(e._singleControlPosition.concat($A.cursorPos),Cesium.JulianDate.now());t&&e.setPrimitivePosition(t)}},t.prototype.calcuteShape=function(e,t){if(e.length<this.minPointNum)return[];var i=e[0];return this.setInternalControlPosition(e,t),i},t.prototype.toEdit=function(){var t=this;e.prototype.toEdit.call(this),this.positionProperty=function(){var e=t.calcuteShape(t._singleControlPosition,Cesium.JulianDate.now());t.setPrimitivePosition(e)}},t.prototype.finish=function(){if(this.ent){e.prototype.finish.call(this);var t=this.calcuteShape(this._singleControlPosition,Cesium.JulianDate.now());this.positionProperty=t}},sx([(0,fy.o)(),ax("design:type",Object)],t.prototype,"partical",void 0),sx([(0,fy.o)(),ax("design:type",Cesium.Cartesian3)],t.prototype,"last_pos",void 0),sx([(0,fy.o)(),ax("design:type",Object)],t.prototype,"maxPointNum",void 0),sx([(0,fy.o)(),ax("design:type",Object)],t.prototype,"minPointNum",void 0),sx([dy({name:"不透明度",group:"通用",subGroup:"不透明度",order:2,subOrder:5,type:"slider"}),ax("design:type",Number)],t.prototype,"alpha",void 0),sx([dy({name:"数量(次/秒)",group:"粒子",type:"number",order:8,max:100,min:0}),ax("design:type",Number)],t.prototype,"emissionRate",void 0),sx([dy({name:"尺寸",group:"粒子",type:"number",order:8,max:50,min:2}),ax("design:type",Number),ax("design:paramtypes",[Number])],t.prototype,"particleSize",null),sx([dy({name:"最小寿命",group:"粒子",subGroup:"寿命(秒)",subOrder:1,type:"number2",order:8,max:30,min:.1}),ax("design:type",Number)],t.prototype,"minimumParticleLife",void 0),sx([dy({name:"最大寿命",group:"粒子",subGroup:"寿命(秒)",subOrder:2,type:"number2",order:8,max:30,min:.1}),ax("design:type",Number)],t.prototype,"maximumParticleLife",void 0),sx([dy({name:"最小速度",group:"粒子",subGroup:"速度",subOrder:3,type:"number2",order:8,max:30,min:1}),ax("design:type",Number)],t.prototype,"minimumSpeed",void 0),sx([dy({name:"最大速度",group:"粒子",subGroup:"速度",subOrder:4,type:"number2",order:8,max:30,min:1}),ax("design:type",Number)],t.prototype,"maximumSpeed",void 0),sx([dy({name:"图片",group:"粒子",type:"string",order:8,hidden:!0}),ax("design:type",String)],t.prototype,"particleImage",void 0),sx([dy({name:"重力因子",group:"粒子",type:"number",order:8,min:-20,max:20}),ax("design:type",Number)],t.prototype,"gravity",void 0),sx([dy({name:"起始缩放比",group:"粒子",subGroup:"缩放比",subOrder:5,type:"number2",order:8,min:0,max:10}),ax("design:type",Number)],t.prototype,"startScale",void 0),sx([dy({name:"终止缩放比",group:"粒子",subGroup:"缩放比",subOrder:6,type:"number2",order:8,min:0,max:10}),ax("design:type",Number)],t.prototype,"endScale",void 0),sx([dy({name:"起始颜色",group:"粒子",type:"colorWithAlpha",order:8,hidden:!0}),ax("design:type",String)],t.prototype,"startColor",void 0),sx([dy({name:"终止颜色",group:"粒子",type:"colorWithAlpha",order:8,hidden:!0}),ax("design:type",String)],t.prototype,"endColor",void 0),t}(UP);const hx=lx;c.Z.registerType(lx,"EditorParticle","Graph");var cx=i(5108),ux=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),px=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},dx=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},mx=function(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],r=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},fx={};"undefined"==typeof window||(fx=i(3503));const gx=function(e){function t(t,i,r,n,o){void 0===n&&(n=!1);var s=e.call(this)||this;return s.isVectorInfo=!0,s.MODE_VIEW="view",s.MODE_CREATE="create",s.MODE_SELECT="select",s.MODE_EDIT="edit",s.MODE_CTLEDIT="ctlEdit",s.ACT_START="start",s.ACT_CREATE="create",s.ACT_SELECT="select",s.ACT_FINISH="finish",s.ACT_PICKUP="pickup",s.ACT_CANCEL="cancel",s.pickIndex=-1,s.onCreateFinished=new th.x,s.mode=s.MODE_VIEW,s.currentCreateEnt=void 0,s._currentEditCollection=[],s.stopContextMenu$=new th.x,s.operatorMoveDiffX=0,s.operatorMoveDiffY=0,s.operatorMoving=!1,s.operatorMoved=!1,s.CURSOR_auto="auto",s.CURSOR_crosshair="crosshair",s.CURSOR_pointer="pointer",s.operatorContainer=void 0,s.dragToHTMLBoxesSub$=new th.x,s.lockToHTMLBoxesSub$=new th.x,s.hideHTMLBoxesOperatorSub$=new th.x,s.showHTMLBoxesOperatorSub$=new th.x,s.isCtrlPressed=!1,s.isCrossSelectedNodes2Or3Sub$=new th.x,s.pickString="请选择元素",s.pickCompleted$=new th.x,s.midCtlHasPicked=!1,s._engine=t,s.editCollection={},s.editCollection.divContainerDom=null,s.editCollection.moveDivDom=null,s.editCollection.editButtonDomCollection=null,s.editCollection.editButtonInfoCollection=null,s.editCollection.coverDivDom=null,s.editCollection.exportDivDom=null,s.editCollection.deleteDivDom=null,s.editCollection.anchorDivDom=null,"undefined"==typeof window||(o&&(s.layerId=o),s.sg=py.getInstance(),s.viewer=t.viewer,VS.getInstance().init(s.viewer),s.editAfterCreate=i,s.operatorEnable=n,r?s.viewMode():s.selectMode(),s.createQuickOperator(),s.createPointOperator()),s}return ux(t,e),Object.defineProperty(t.prototype,"currentEditGraph",{get:function(){return this.currentEditCollection.length>0?this.currentEditCollection[0].graph:null},set:function(e){this.currentEditGraph!==e&&(this.nextMode(this.ACT_FINISH),e&&this.editMode(e.ent))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentEditGraphList",{get:function(){var e=this.currentEditCollection.map((function(e){return e.graph}));return Vy.curEditGraphList=e,e},set:function(e){this.currentEditGraph=e[0];for(var t=1;t<e.length;t++)e[t].toEdit();this.currentEditCollection=e.map((function(e){return e.ent})),IP.currentEditGraphList=this.currentEditCollection.map((function(e){return e.graph}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentEditCollection",{get:function(){return this._currentEditCollection},set:function(e){this._currentEditCollection=e,IP.currentEditGraphList=e.map((function(e){return e.graph}))},enumerable:!1,configurable:!0}),t.prototype.deleteAllGraph=function(){throw new Error("Method not implemented.")},t.prototype.getHandler=function(){return this.handler&&!this.handler.isDestroyed()||(window.viewerHtmlElement=this.viewer.scene.canvas,this.handler=new Cesium.ScreenSpaceEventHandler(window.viewerHtmlElement)),this.handler},t.prototype.destroyHandler=function(){this.handler&&(this.handler.destroy(),this.handler=void 0)},t.prototype.start=function(){this.mode=this.MODE_VIEW,this.nextMode(this.ACT_START)},t.prototype.create=function(e){return this.nextMode(this.ACT_CREATE,e),e},t.prototype.draw=function(e){return this.nextMode(this.ACT_FINISH,e),e.finish(),e},t.prototype.cancelCreate=function(){this.nextMode(this.ACT_CANCEL,this.currentCreateEnt),this.setCursor(this.CURSOR_auto)},t.prototype.nextMode=function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];switch(this.mode){case this.MODE_VIEW:switch(e){case this.ACT_START:this.selectMode();break;case this.ACT_CREATE:this.createMode(t[0]);case this.ACT_FINISH:}break;case this.MODE_SELECT:switch(this.finishCurrentSelect(),e){case this.ACT_CREATE:this.createMode(t[0]);break;case this.ACT_SELECT:this.editMode(t[0]);break;case this.ACT_FINISH:this.viewMode()}break;case this.MODE_CREATE:var r=this.finishCurrentCreate();switch(e){case this.ACT_FINISH:this.editAfterCreate?r?this.editMode(t[0]):(this.selectMode(),this.callChangeEvent()):this.selectMode(),this.fire("plot_finish",this.currentEditGraph);break;case this.ACT_CREATE:this.createMode(t[0]);break;case this.ACT_CANCEL:this.selectMode()}break;case this.MODE_EDIT:switch(e){case this.ACT_FINISH:this.finishCurrentEdit(),this.selectMode();break;case this.ACT_CREATE:this.finishCurrentEdit(),this.createMode(t[0]);break;case this.ACT_PICKUP:this.ctlEditMode(t[0],t[1])}break;case this.MODE_CTLEDIT:switch(this.finishCurrentCtledit(),e){case this.ACT_FINISH:this.editMode(t[0]);break;case this.ACT_CREATE:this.createMode(t[0])}}},Object.defineProperty(t.prototype,"isReadOnly",{get:function(){return this._isReadOnly},set:function(e){this._isReadOnly=e,e&&this.finishCurrentEdit()},enumerable:!1,configurable:!0}),t.prototype.viewMode=function(){this.callChangeEvent()},t.prototype.createMode=function(e){var t=this;this.mode=this.MODE_CREATE,"initCreateCursor"!=e&&(this.currentCreateEnt=e,fx.setContext(this.mode),this.setCursor(this.CURSOR_crosshair),this.initCreateCursor(e)),this.getHandler().setInputAction((function(e){$A.calculateMouseEvent(e),$A.cursorScreenPos=zy.screen2lonlat(e.endPosition,t.viewer),$A.cursorPos=zy.lonlat2Cartesian($A.cursorScreenPos),t.currentCreateEnt&&t.currentCreateEnt.graph.positionChanged.next(!0)}),Cesium.ScreenSpaceEventType.MOUSE_MOVE),"initCreateCursor"!=e&&(this.getHandler().setInputAction((function(i){t.isVectorInfo=!1,$A.calculateMouseEvent(i);var r=zy.screen2lonlat(i.position,t.viewer);e.graph.heightReference!==Cesium.HeightReference.RELATIVE_TO_GROUND&&e.graph.heightReference!==Cesium.HeightReference.CLAMP_TO_GROUND||(r[2]=0),t.currentCreateEnt.addCtlPoint({lon:r[0],lat:r[1],alt:r[2]}),t.currentCreateEnt.ishaveMaxCtls()&&t.nextMode(t.ACT_FINISH,t.currentCreateEnt)}),Cesium.ScreenSpaceEventType.LEFT_CLICK),this.getHandler().setInputAction((function(e){t.mode==t.MODE_CREATE&&t.currentCreateEnt.deleteLastPoint()}),Cesium.ScreenSpaceEventType.MIDDLE_CLICK),this.getHandler().setInputAction((function(e){t.nextMode(t.ACT_FINISH,t.currentCreateEnt),t.stopContextMenu$.next(1)}),Cesium.ScreenSpaceEventType.RIGHT_CLICK),this.getHandler().setInputAction((function(e){}),Cesium.ScreenSpaceEventType.LEFT_DOWN))},t.prototype.select=function(e){this.nextMode(this.ACT_SELECT,e.ent)},t.prototype.finishCurrentCreate=function(){if(this.viewer.entities.remove($A.cursor),this.currentCreateEnt)return this.currentCreateEnt.isCtlNumValid()?(this.currentCreateEnt.finish(),this.currentCreateEnt.graphList.push(this.currentCreateEnt),this.onEditGraphList&&this.onEditGraphList(this.currentCreateEnt.graphList),this.onCreateFinished.next(this.currentCreateEnt.graph),this.currentCreateEnt=void 0,!0):(this.onCreateFinished.next(1),this.currentCreateEnt.delete(),this.currentCreateEnt=void 0,!1)},t.prototype.initCreateCursor=function(e){var t=this;$A.cursor||this.createMode("initCreateCursor"),$A.cursor=this.viewer.entities.add({id:"cursor",position:new Cesium.CallbackProperty((function(e,t){return null===$A.cursorPos?null:Cesium.Cartesian3.clone($A.cursorPos)}),!0),billboard:{image:this.sg.createCtrlPointCanvas(),heightReference:Cesium.HeightReference.RELATIVE_TO_GROUND},label:{text:new Cesium.CallbackProperty((function(e,i){var r="";if(t.startPickTarget)r=t.pickString;else{var n=t.currentCreateEnt.graph.getCtlPositions().length;r=t.currentCreateEnt.graph instanceof qP||t.currentCreateEnt.graph instanceof CS?$A.cursorScreenPos?n>0?"单击确定右下顶点":"单击确定左上顶点":"":t.currentCreateEnt.graph instanceof PS?$A.cursorScreenPos?n>0?"单击确定半径长度":"单击确定圆心":"":$A.cursorScreenPos?0===n?"左键单击开始绘制":n>=t.currentCreateEnt.graph.minPointNum?"右键结束绘制":"左键继续绘制,右键取消绘制":""}return r}),!0),font:"12px 微软雅黑",backgroundColor:Cesium.Color.BLACK.withAlpha(.9),heightReference:Cesium.HeightReference.RELATIVE_TO_GROUND,showBackground:!0,horizontalOrigin:Cesium.HorizontalOrigin.LEFT,verticalOrigin:Cesium.VerticalOrigin.TOP,pixelOffset:new Cesium.Cartesian2(15,0)}})},t.prototype.initKeyboardCreate=function(){fx.withContext(this.MODE_CREATE,(function(){}))},t.prototype.selectByPosition=function(e){var t=this.viewer.scene.drillPick(e,5);t.forEach((function(e){e.id&&"string"!=typeof e.id||(e.id=e.primitive),e.id.level||(e.id.owner?e.id=e.id.owner:e.collection&&(e.id=e.collection))}));var i=t.filter((function(e){return null!=e.id&&e.id.level}));if(this.hoveredEnt=void 0,this.pickIndex>=i.length&&(this.pickIndex=0),i.length>0&&-1==this.pickIndex&&(this.pickIndex=0),Cesium.defined(i)&&i.length>0)if(void 0===this.hoveredEnt&&i.length>0){var r=i.reduce((function(e,t){if(e&&e.id&&(e.id.level||(e.id=e.id.owner),t&&t.id))return!t.id.level&&e.id.level?e:t.id.level&&!e.id.level||t.id.level.getValue()>e.id.level.getValue()?t:e}),i[this.pickIndex]);this.hoveredEnt=r}else if(void 0!==this.hoveredEnt&&i.length>0){r=i.reduce((function(e,t){return t.id.level||(t.id=t.id.owner),e.id.level||(e.id=e.id.owner),t.id.level.getValue()>e.id.level.getValue()?t:e}),i[this.pickIndex]);this.hoveredEnt===r||(this.hoveredEnt=r)}else void 0!==this.hoveredEnt&&0===i.length&&(this.hoveredEnt.id.downLight(),this.setCursor(this.CURSOR_auto),this.hoveredEnt=void 0);if(this.hoveredEnt)return this.hoveredEnt.id},Object.defineProperty(t.prototype,"startPickTarget",{get:function(){return this._startPickTarget},set:function(e){this._startPickTarget=e,e?this.initCreateCursor(void 0):this.viewer.entities.remove($A.cursor)},enumerable:!1,configurable:!0}),t.prototype.checkPickTypes=function(e){var t,i;try{for(var r=mx(this.pickTypes),n=r.next();!n.done;n=r.next()){if(e instanceof n.value)return!0}}catch(e){t={error:e}}finally{try{n&&!n.done&&(i=r.return)&&i.call(r)}finally{if(t)throw t.error}}return!1},t.prototype.checkPick=function(e,t){if(this.startPickTarget){if(e&&this.checkPickTypes(e.graph))this.startPickTarget=!1,this.pickCompleted$.next(e.graph);else{this.startPickTarget=!1;var i=this.viewer.camera.getPickRay(t),r=this.viewer.scene.globe.pick(i,this.viewer.scene);this.pickCompleted$.next(r)}return!0}return!1},t.prototype.selectMode=function(){var e=this;this.mode=this.MODE_SELECT,this.hoveredEnt=void 0,this.propEditor&&this.propEditor.show(!1),fx.setContext(this.mode),this.setCursor(this.CURSOR_auto),this.getHandler().setInputAction((function(t){if(!e.isReadOnly){$A.calculateMouseEvent(t);var i=e.selectByPosition(t.position);e.checkPick(i,t.position)||(i?(e.isVectorInfo=!1,e.nextMode(e.ACT_SELECT,i)):(e.isVectorInfo=!0,e.nextMode(e.ACT_FINISH),cx.log("重置plotService.isCrossSelectedNodes2Or3"),e.isCrossSelectedNodes2Or3Sub$.next("")))}}),Cesium.ScreenSpaceEventType.LEFT_CLICK),this.getHandler().setInputAction((function(t){if(!e.isReadOnly){$A.calculateMouseEvent(t);var i=e.selectByPosition(t.position);e.checkPick(i,t.position)||(i?(e.isVectorInfo=!1,e.nextMode(e.ACT_SELECT,i)):(e.isVectorInfo=!0,e.nextMode(e.ACT_FINISH)))}}),Cesium.ScreenSpaceEventType.LEFT_CLICK),this.getHandler().setInputAction((function(t){if(!e.isReadOnly){$A.calculateMouseEvent(t);var i=e.selectByPosition(t.position);e.checkPick(i,t.position)||(i?(e.isVectorInfo=!1,e.nextMode(e.ACT_SELECT,i)):(e.isVectorInfo=!0,e.nextMode(e.ACT_FINISH)))}}),Cesium.ScreenSpaceEventType.LEFT_CLICK,Cesium.KeyboardEventModifier.CTRL),this.getHandler().setInputAction((function(t){e.removeAnchorConnectLineByRightClick(),e.nextMode(e.ACT_FINISH)}),Cesium.ScreenSpaceEventType.RIGHT_CLICK)},t.prototype.finishCurrentSelect=function(){this.hoveredEnt&&(this.hoveredEnt.id.downLight(),this.hoveredEnt=void 0)},t.prototype.callChangeEvent=function(){this.onEditChanged&&this.onEditChanged(this.currentEditGraph),this.onEditCollectionChanged&&this.onEditCollectionChanged(this.currentEditGraphList)},t.prototype.editMode=function(e){var i=this;e?("Image"!==e.graph.gvolType&&"PinImage"!==e.graph.gvolType||this.operatorContainer.querySelectorAll("div").forEach((function(e,t){"缩放"===e.title&&(i.operatorContainer.querySelectorAll("div")[t].style.display="block")})),this.currentEditCollection=[],this.currentEditCollection.push(e),IP.currentEditGraphList=this.currentEditCollection.map((function(e){return e.graph})),this.mode=this.MODE_EDIT,this.callChangeEvent(),this.setCursor(this.CURSOR_crosshair),e.toEdit(),this.getHandler().setInputAction((function(e){$A.cursorScreenPos=zy.screen2lonlat(e.endPosition,i.viewer),$A.cursorPos=zy.lonlat2Cartesian($A.cursorScreenPos),i.axisStartPos&&VS.getInstance().mouseMove(e)}),Cesium.ScreenSpaceEventType.MOUSE_MOVE),this.getHandler().setInputAction((function(e){var r,n,o;if(i.axisStartPos=null,VS.getInstance().reset(),i.currentEditGraph){var s=VS.getInstance().operatorList.find((function(e){return e.name===VS.getInstance().currentAxis}));if(!s)return;var a=s.property(i.currentEditGraph);if(!a||0===a.length)return;var l=((r={})[i.currentEditGraph.id]=((n={})[a]=null===(o=i.currentEditGraph)||void 0===o?void 0:o[a],n),r);t.operatorComplete.next({target:i.currentEditGraph,begin:i.beginValue,end:l})}i.viewer.scene.screenSpaceCameraController.enableRotate=!0}),Cesium.ScreenSpaceEventType.LEFT_UP),this.getHandler().setInputAction((function(t){var r,n;$A.calculateMouseEvent(t);var o=i.viewer.scene.drillPick(t.position,2);if(null!=o&&o.length>0){var s=o[0].id;if(s&&s.isAxisController){i.axisStartPos=t.position,VS.getInstance().controlAxis(s.name,e.graph);var a=VS.getInstance().operatorList.find((function(e){return e.name===s.name}));if(!a)return;var l=a.property(i.currentEditGraph);if(!l||0===l.length)return;return i.beginValue=((r={})[i.currentEditGraph.id]=((n={})[l]=i.currentEditGraph[l],n),r),void(i.viewer.scene.screenSpaceCameraController.enableRotate=!1)}}if(Cesium.defined(o)&&o.length>0){var h=o.filter((function(e){return e.primitive&&"ctl"===e.primitive.graphType}));if(h.length>0){if(i.getParentPlot(h[0].primitive)){if(i.currentEditGraphList.length>1)return;var c={Image:"gp-shuipingyidong",ToolTip:"控制点移动",Operator:i.movePosition,property:function(e){return e.movePositionProperty},CanOperator:function(e){return e.movePosition}};i.operatorBegin(c)}i.nextMode(i.ACT_PICKUP,h[0].primitive,t.position)}else i.nextMode(i.ACT_FINISH),$A.currentGraph=null}else i.nextMode(i.ACT_FINISH),$A.currentGraph=null}),Cesium.ScreenSpaceEventType.LEFT_DOWN),this.getHandler().setInputAction((function(e){i.isVectorInfo=!1,$A.calculateMouseEvent(e);var t=i.selectByPosition(e.position);if(t){if(IP.currentBoxList.length>0)return;var r=i.currentEditCollection.indexOf(t);if(r>-1){if(i.currentEditCollection.splice(r,1),IP.currentEditGraphList=i.currentEditCollection.map((function(e){return e.graph})),t.graph.ctrlsCollection&&t.graph.ctrlsCollection.length>0)for(var n=0;n<t.graph.ctrlsCollection.length;n++)t.graph.ctrlsCollection.get(n).color=Cesium.Color.WHITE;t.finish(),i.callChangeEvent()}else i.addCtrlEntity(t)}}),Cesium.ScreenSpaceEventType.LEFT_CLICK,Cesium.KeyboardEventModifier.CTRL),this.getHandler().setInputAction((function(e){i.removeAnchorConnectLineByRightClick(),i.nextMode(i.ACT_FINISH)}),Cesium.ScreenSpaceEventType.RIGHT_CLICK),this.getHandler().setInputAction((function(e){if(i.startPickTarget){var t=i.selectByPosition(e.position);i.checkPick(t,e.position)}else{$A.calculateMouseEvent(e);var r=i.viewer.scene.drillPick(e.position,2);if(Cesium.defined(r)&&r.length>0){var n=r.filter((function(e){return e.primitive&&"ctl"===e.primitive.graphType}));n.length>0&&1!==i.currentEditCollection[0].graph.maxPointNum&&(i.ctlPickUP=n[0],"none"===i.pointOperatorContainer.style.display?i.showPointOperator():i.closePointOperator()),(n=r.filter((function(e){return e.primitive&&"ctlmid"===e.primitive.graphType}))).length>0&&n[0].primitive.pickup()}else i.nextMode(i.ACT_FINISH)}}),Cesium.ScreenSpaceEventType.LEFT_CLICK),this.showOperator(e.graph),this.show3DOperator(e.graph)):this.mode=this.MODE_EDIT},t.prototype.addCtrlEntity=function(e){this.mode!=this.MODE_EDIT&&(this.mode=this.MODE_EDIT),e&&(e.toEdit(),this.currentEditCollection.push(e)),IP.currentEditGraphList=this.currentEditCollection.map((function(e){return e.graph})),this.callChangeEvent(),this.showOperator(this.currentEditGraphList)},t.prototype.show3DOperator=function(e){try{var t=this.getCartesianWithTerrainHeight(e);VS.getInstance().show(e,t)}catch(e){cx.log(e)}},t.prototype.getParentPlot=function(e){var t=this;return this.currentEditGraphList.find((function(i){return i.ctrlsCollection&&i.ctrlsCollection.contains(e)?i:i.middleCtrlsCollection&&i.middleCtrlsCollection.contains(e)?(t.midCtlHasPicked=!0,i):void 0}))},t.prototype.showPointOperator=function(){this.pointOperatorContainer.style.display="flex";var e=this.currentEditCollection[0].graph;e.pointIndex=$A.index,this.pointOperatorContainer.childNodes[0].style.display=e.moveHeight?"":"none",this.pointOperatorContainer.childNodes[1].style.display=e.ctrlPosition.length<=e.minPointNum?"none":""},t.prototype.closePointOperator=function(){this.pointOperatorContainer.style.display="none",this.operatorMoved=!1},t.prototype.createPointOperator=function(){var e,t,i=this,r=document.createElement("div");r.id="pointoperator",r.style.color="#ffffff",r.style.position="absolute",r.style.display="flex",r.style.background="linear-gradient(to right, #151515 10px, #353536DD 10px)",r.style.zIndex="10",r.style.height="34px",r.style.borderRadius="6px",r.style.alignContent="center",r.ondragstart=function(){return!1};var n=[{Image:'<path d="M432.11788967 674.41123867h147.428235v44.666077H432.11788967z" p-id="12494" fill="#ffffff"></path><path d="M432.11788967 313.46104767h147.428235v44.666077H432.11788967z" p-id="12495" fill="#ffffff"></path><path d="M432.11788967 493.93614267h147.428235v44.666078H432.11788967z" p-id="12496" fill="#ffffff"></path><path d="M432.11788967 403.69859467h208.592593v44.666078H432.11788967z" p-id="12497" fill="#ffffff"></path><path d="M432.11788967 584.17369067h208.592593v44.666077H432.11788967z" p-id="12498" fill="#ffffff"></path><path d="M512.99970567 267.88957667H339.51625867L426.28313167 148.42793967 513.05000467 28.96630367l86.766873 119.461636 86.766873 119.461637z" p-id="12499" fill="#ffffff"></path><path d="M512.99970567 763.74339367h173.483446l-86.766873 119.461636-86.766873 119.461637-86.766873-119.461637-86.766873-119.461636z" p-id="12500" fill="#ffffff"></path>',ToolTip:"垂直移动",Operator:this.movePointHeight,property:function(e){return e.moveHeightProperty},CanOperator:function(e){return e.moveHeight}},{Image:'<path d="M805.645277 195.651255H134.016073a35.171491 35.171491 0 0 1-37.333934-37.333934 35.10789 35.10789 0 0 1 37.333934-37.333934h186.542467V83.649453c0-20.606805 16.727129-37.333934 37.333934-37.333934h223.876402a38.16075 38.16075 0 0 1 37.333934 37.333934v37.333934h186.542467a34.917086 34.917086 0 0 1 37.333934 37.333934 35.044289 35.044289 0 0 1-37.333934 37.333934zM134.016073 270.255522h671.629204a35.10789 35.10789 0 0 1 37.333934 37.333934 34.980688 34.980688 0 0 1-10.239801 27.094133 34.980688 34.980688 0 0 1-27.094133 10.239801h-37.270332v525.982341c0 41.21361-33.454258 74.667868-74.667868 74.667868h-447.752803a74.667868 74.667868 0 0 1-74.667868-74.667868v-525.982341H134.016073a35.171491 35.171491 0 0 1-37.333934-37.333934 35.10789 35.10789 0 0 1 37.333934-37.333934z m410.418869 487.948793a38.860364 38.860364 0 0 0 74.667868 0V456.161977a38.796763 38.796763 0 0 0-74.667868 0v302.042338z m-223.876402 0a38.796763 38.796763 0 0 0 74.604267 0V456.161977a38.66956 38.66956 0 0 0-74.604267 0v302.042338z" p-id="24333" fill="#ffffff"></path>',ToolTip:"删除控制点",Operator:this.delteCtrlPoint,property:function(e){return e.movePositionProperty},CanOperator:function(e){return!0}}],o=function(e){var t,o=document.createElement("div");o.style.color="#ffffff",o.style.padding="0",o.style.fontSize="20px",o.style.margin="7px",o.style.opacity="0.8",o.innerHTML='<svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="12193" width="20" height="20">'.concat(e.Image,"</svg>"),e.ToolTip&&(o.title=e.ToolTip),r.appendChild(o),e.htmlElement=o;var a=0,l=0;e!==n[1]?(o.onmousedown=function(n){i.ctlPickUP&&i.ctlPickUP.primitive.pickup();var s=o.getBoundingClientRect();r.style.display="none",t=Cesium.Cartesian2.ZERO,a=n.clientX-s.left,l=n.clientY-s.top,i.operatorBegin(e)},s.getOwnerElement().addEventListener("mouseup",(function(){t&&(r.style.display="flex")})),s.getOwnerElement().addEventListener("mousemove",(function(r){if(t){var n=new Cesium.Cartesian2(r.offsetX-a,r.offsetY-l);t===Cesium.Cartesian2.ZERO&&(t=n),e.Operator.call(i,t,n),t=n}})),s.getOwnerElement().addEventListener("mouseleave",(function(r){t&&(i.operatorEnd(e),$A.currentGraph=null),t=null})),s.getOwnerElement().addEventListener("mouseup",(function(r){t&&(i.operatorEnd(e),$A.currentGraph=null),t=null}))):o.onclick=function(){e.Operator.call(i)},s.getOwnerElement().appendChild(r),s.pointOperatorContainer=r,s.pointOperatorContainer.style.display="none";var h=new Cesium.Cartesian2;s.viewer.scene.preRender.addEventListener((function(){if(IP.currentEditGraphList.length||i.closeOperator(),IP.currentBoxList.length||i.hideHTMLBoxesOperatorSub$.next(null),$A.currentGraph){var e=$A.currentGraph._singleControlPosition[$A.index];if(e){var t=e,r=i.getCartesianWithTerrainHeight($A.currentGraph,t),n=i.viewer.scene.cartesianToCanvasCoordinates(r,h);n&&i.pointOperatorContainer&&(i.pointOperatorContainer.style.top=n.y-50+"px",i.pointOperatorContainer.style.left=n.x-32+"px")}}}))},s=this;try{for(var a=mx(n),l=a.next();!l.done;l=a.next()){o(l.value)}}catch(t){e={error:t}}finally{try{l&&!l.done&&(t=a.return)&&t.call(a)}finally{if(e)throw e.error}}},t.prototype.getCartesianWithTerrainHeight=function(e,t){void 0===t&&(t=Cesium.Cartesian3.ZERO);var i=Cesium.Cartographic.ZERO;t===Cesium.Cartesian3.ZERO?e.getCenter()&&(i=Cesium.Cartographic.fromCartesian(e.getCenter())):i=Cesium.Cartographic.fromCartesian(t);var r=this.viewer.scene.globe.getHeight(i),n=Cesium.Math.toDegrees(i.longitude),o=Cesium.Math.toDegrees(i.latitude),s=Cesium.Cartesian3.ZERO;if(e instanceof jS||e instanceof nS||e instanceof LS)switch(e.heightReference){case Cesium.HeightReference.NONE:s=e.getCenter();break;case Cesium.HeightReference.CLAMP_TO_GROUND:s=Cesium.Cartesian3.fromDegrees(n,o,r);break;case Cesium.HeightReference.RELATIVE_TO_GROUND:default:s=Cesium.Cartesian3.fromDegrees(n,o,r+Number.parseInt(e.elevation))}else s=Cesium.Cartesian3.fromDegrees(n,o,r);return s},t.prototype.movePoint=function(e,t){var i=this.viewer.camera.pickEllipsoid(t,this.viewer.scene.globe.ellipsoid);this.currentEditCollection[0];$A.currentGraph.setCtrlPositionCartesian3($A.index,i)},t.prototype.delteCtrlPoint=function(){var e={Image:"gp-shanchu3",ToolTip:"删除控制点",Operator:this.delteCtrlPoint,property:function(e){return e.movePositionProperty},CanOperator:function(e){return!0}};this.operatorBegin(e),this.currentEditGraph.deleteCtlPoint($A.index),this.operatorEnd(e),$A.currentGraph=null,this.closePointOperator()},t.prototype.movePointHeight=function(e,t){var i,r=null===(i=$A.currentGraph)||void 0===i?void 0:i._singleControlPosition[$A.index],n=zy.getHeightByCartesian3(r,this.viewer),o=this.ChangeLengthByMouse(n,t.y-e.y,1),s=zy.getHeightByCartesian3(r,this.viewer)-n+o;if(r){var a=zy.getHeightdefineByXYZ(r,s,this.viewer);$A.currentGraph.setCtrlPositionCartesian3($A.index,a)}},t.prototype.ScreenPixel=function(){return this.viewer.camera.positionCartographic.height/1047.776588},t.prototype.ChangeLengthByMouse=function(e,t,i){return void 0===i&&(i=3),e-=t*(this.ScreenPixel()*i)},t.prototype.insertPoint=function(){},t.prototype.deletePoint=function(){},t.prototype.finishCurrentEdit=function(){var e,t;try{for(var i=mx(this.currentEditCollection),r=i.next();!r.done;r=i.next()){r.value.graph.finish()}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}this.currentEditCollection=[],this.callChangeEvent(),this.closeOperator(),VS.getInstance().remove(),this.closePointOperator()},t.prototype.deleteSelectGraph=function(){var e,t,i=function(e){var t=e;t.delete&&t.delete();var i=r._engine.serviceManager.plotService.gm.graphList.find((function(e){return e.graph.id==t.id}));ty.Remove(r._engine.serviceManager.plotService.gm.graphList,i)},r=this;try{for(var n=mx(this.currentEditCollection),o=n.next();!o.done;o=n.next()){i(o.value)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this.currentEditCollection=[],this.nextMode(this.ACT_FINISH),this.callChangeEvent()},t.prototype.ctlEditMode=function(e,t){var i=this;this.viewer.scene.screenSpaceCameraController.enableRotate=!1,this.viewer.scene.screenSpaceCameraController.enableTranslate=!1,this.mode=this.MODE_CTLEDIT,this.pickedctl=e,fx.setContext(this.mode),this.setCursor(this.CURSOR_crosshair);var r,n,o=zy.cartesian2lonlat(this.pickedctl.position)[2];this.pickedctl.pickup();var s=!1;this.getHandler().setInputAction((function(e){if(i.pickedctl){$A.calculateMouseEvent(e);var t=zy.screen2lonlat(e.endPosition,i.viewer);r&&n?($A.cursorPos=zy.lonlathei2Cartesian({lon:t[0],lat:t[1],alt:o}),i.currentEditCollection[0].graph.positionChanged.next(),s=!0):(r=t[0],n=t[1])}}),Cesium.ScreenSpaceEventType.MOUSE_MOVE),this.getHandler().setInputAction((function(e){if(i.pickedctl&&(i.pickedctl.finish(),i.nextMode(i.ACT_FINISH),s||i.midCtlHasPicked)){var t={Image:"gp-shuipingyidong",ToolTip:"控制点移动",Operator:i.movePosition,property:function(e){return e.movePositionProperty},CanOperator:function(e){return e.movePosition}};i.operatorEnd(t),s=!1}i.midCtlHasPicked=!1,i.currentEditCollection[0]&&i.currentEditCollection[0].graph&&i.currentEditCollection[0].graph.positionChanged.next(),i.pickedctl=null,$A.currentGraph=null}),Cesium.ScreenSpaceEventType.LEFT_UP),this.getHandler().setInputAction((function(e){i.pickedctl&&(i.pickedctl.finish(),i.nextMode(i.ACT_FINISH))}),Cesium.ScreenSpaceEventType.RIGHT_CLICK)},t.prototype.finishCurrentCtledit=function(){this.pickedctl&&(this.pickedctl.finish(),this.pickedctl=void 0),this.viewer.scene.screenSpaceCameraController.enableRotate=!0,this.viewer.scene.screenSpaceCameraController.enableTranslate=!0},t.prototype.setCursor=function(e){(window.viewerHtmlElement?window.viewerHtmlElement:this.viewer.scene.canvas).style.cursor=e},t.prototype.getOwnerElement=function(){return(window.viewerHtmlElement?window.viewerHtmlElement:this.viewer.scene.canvas).parentElement},t.prototype.createQuickOperator=function(e,t,i,r,n){var o=this;if(void 0===e&&(e=null),void 0===t&&(t=null),void 0===i&&(i=null),void 0===r&&(r=null),void 0===n&&(n=!0),this.operatorEnable){var s,a,l=[{Image:'<path d="M972.8 512l-184.32-153.6v119.3984h-242.2784V235.52H665.6L512 51.2 358.4 235.52h119.3984v242.2784H235.52V358.4L51.2 512l184.32 153.6v-119.3984h242.2784V788.48H358.4l153.6 184.32 153.6-184.32h-119.3984v-242.2784H788.48V665.6z" p-id="12194" fill="#ffffff"></path>',ToolTip:"水平移动",Operator:this.movePosition,property:function(e){return e.movePositionProperty},CanOperator:function(e){return e.movePosition}},{Image:'<path d="M432.11788967 674.41123867h147.428235v44.666077H432.11788967z" p-id="12494" fill="#ffffff"></path><path d="M432.11788967 313.46104767h147.428235v44.666077H432.11788967z" p-id="12495" fill="#ffffff"></path><path d="M432.11788967 493.93614267h147.428235v44.666078H432.11788967z" p-id="12496" fill="#ffffff"></path><path d="M432.11788967 403.69859467h208.592593v44.666078H432.11788967z" p-id="12497" fill="#ffffff"></path><path d="M432.11788967 584.17369067h208.592593v44.666077H432.11788967z" p-id="12498" fill="#ffffff"></path><path d="M512.99970567 267.88957667H339.51625867L426.28313167 148.42793967 513.05000467 28.96630367l86.766873 119.461636 86.766873 119.461637z" p-id="12499" fill="#ffffff"></path><path d="M512.99970567 763.74339367h173.483446l-86.766873 119.461636-86.766873 119.461637-86.766873-119.461637-86.766873-119.461636z" p-id="12500" fill="#ffffff"></path>',ToolTip:"垂直移动",Operator:this.moveHeight,property:function(e){return e.moveHeightProperty},CanOperator:function(e){return e.moveHeight}},{Image:'<path d="M102.4 487.38986667h446.5152v446.5152H102.4z" p-id="12650" fill="#ffffff"></path><path d="M651.0592 443.25546667l207.7184-207.7184 84.4288 84.4288L964.9664 81.06666667l-238.8992 21.76 84.4288 84.4288-207.7184 207.7184" p-id="12651" fill="#ffffff"></path><path d="M102.4 308.54826667h68.4032v68.4032H102.4z" p-id="12652" fill="#ffffff"></path><path d="M102.4 114.70506667h68.4032v68.4032H102.4z" p-id="12653" fill="#ffffff"></path><path d="M296.2432 183.05706667V114.65386667h68.4032v68.4032z" p-id="12654" fill="#ffffff"></path><path d="M490.0352 183.05706667V114.65386667h68.4032v68.4032z" p-id="12655" fill="#ffffff"></path><path d="M659.5584 933.90506667v-68.4032h68.4032v68.4032z" p-id="12656" fill="#ffffff"></path><path d="M853.4016 933.90506667v-68.4032h68.4032v68.4032z" p-id="12657" fill="#ffffff"></path><path d="M853.4016 671.70986667h68.4032v68.4032h-68.4032z" p-id="12658" fill="#ffffff"></path><path d="M853.4016 477.86666667h68.4032v68.4032h-68.4032z" p-id="12659" fill="#ffffff"></path>',ToolTip:"整体缩放",Operator:this.scale,property:function(e){return e.scaleProperty},CanOperator:function(e){return e.scale}},{Image:'<path d="M922.7776 603.8016L859.1872 921.6l-93.5424-93.5936a405.4528 405.4528 0 0 1-255.4368 89.9584 408.2688 408.2688 0 0 1-400.7936-334.1312l79.6672-20.1216a326.1952 326.1952 0 0 0 321.1264 272.2816 323.3792 323.3792 0 0 0 196.864-66.56l-102.144-102.4z" p-id="12809" fill="#ffffff"></path><path d="M420.2496 356.4544L102.4 419.9936l63.5904-317.7472 93.5424 93.5424a405.5552 405.5552 0 0 1 255.4368-89.9584 408.1152 408.1152 0 0 1 401.8688 341.2992l-80.9472 11.5712a326.1952 326.1952 0 0 0-320.9216-270.8992 323.4304 323.4304 0 0 0-196.9152 66.56z" p-id="12810" fill="#ffffff"></path>',ToolTip:"旋转",Operator:this.rotateByHeading,property:function(e){return e.rotateByHeadingProperty},CanOperator:function(e){return e.rotateByHeading}}];e?e.map((function(e,t){l.forEach((function(t){e.ToolTip===t.ToolTip&&(e.Operator=t.Operator,e.property=t.property,e.CanOperator=t.CanOperator)}))})):e=l,this.editCollection.divContainerDom&&((s=this.editCollection.divContainerDom).parentElement.removeChild(s),this.editCollection.divContainerDom=null),i?s=i:((s=document.createElement("div")).id="operator",s.style.color="#ffffff",s.style.position="absolute",s.style.display="flex",s.style.background="linear-gradient(to right, #151515 10px, #353536DD 10px)",s.style.zIndex="10",s.style.height="34px",s.style.borderRadius="6px",s.style.alignContent="center",s.ondragstart=function(){return!1}),n&&(this.editCollection.moveDivDom&&((a=this.editCollection.moveDivDom).parentElement.removeChild(a),this.editCollection.moveDivDom=null),r?a=r:((a=document.createElement("div")).id="move",a.innerText="........",a.style.color="#ffffff",a.style.width="10px",a.style.height="100%",a.style.textAlign="center",a.style.cursor="move",a.style.overflowWrap="anywhere",a.style.overflow="hidden",a.style.lineHeight="4px",a.style.fontSize="12px",a.style.padding="6px 1px 1px",a.style.transform="scale(0.8)"),a.onmousedown=function(e){o.operatorMoving=!0,o.operatorMoveDiffX=e.clientX-e.target.parentElement.offsetLeft,o.operatorMoveDiffY=e.clientY-e.target.parentElement.offsetTop},s.appendChild(a));var h=document.createElement("div");h.style.position="absolute",h.style.right="30px",h.style.left="10px",h.style.height="100%",h.style.background="#80808087",h.style.zIndex="100",s.appendChild(h);var c=[];this.editCollection.editButtonDomCollection&&(this.editCollection.editButtonDomCollection=null);for(var u=function(i){var r;t?c[i]=t:(c[i]=document.createElement("div"),c[i].id="btnItem",c[i].style.color="#ffffff",c[i].style.padding="0",c[i].style.fontSize="20px",c[i].style.margin="7px",c[i].style.opacity="0.8",c[i].innerHTML='<svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="12193" width="20" height="20">'.concat(e[i].Image,"</svg>")),e[i].ToolTip&&(c[i].title=e[i].ToolTip);var n=0,a=0;c[i].onmousedown=function(t){var l=c[i].getBoundingClientRect();s.style.display="none",r=Cesium.Cartesian2.ZERO,n=t.clientX-l.left,a=t.clientY-l.top,o.operatorBegin(e[i]),VS.getInstance().remove(),IP.currentBoxList.length&&o.dragToHTMLBoxesSub$.next(t)},s.appendChild(c[i]),e[i].htmlElement=c[i],p.getOwnerElement().addEventListener("mouseup",(function(){r&&(s.style.display="flex"),o.operatorMoving=!1})),p.getOwnerElement().addEventListener("mousemove",(function(t){if(r){var l=new Cesium.Cartesian2(t.offsetX-n,t.offsetY-a);r===Cesium.Cartesian2.ZERO&&(r=l),e[i].Operator.call(o,r,l),r=l}if(o.operatorMoving){o.operatorMoved=!0;var h=t.pageY-o.operatorMoveDiffY,c=t.pageX-o.operatorMoveDiffX;s.style.top=h+"px",s.style.left=c+"px"}})),p.getOwnerElement().addEventListener("mouseleave",(function(t){r&&o.operatorEnd(e[i]),r=null})),p.getOwnerElement().addEventListener("mouseup",(function(t){r&&(o.operatorEnd(e[i],!0),o.show3DOperator(o.currentEditGraph)),r=null}))},p=this,d=0;d<e.length;d++)u(d);var m,f,g=document.createElement("div");g.style.color="#ffffff",g.style.padding="0",g.style.fontSize="20px",g.style.margin="7px",g.style.opacity="0.8",g.style.display="none",g.innerHTML='<svg t="1663742033085" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="32876" width="20" height="20"><path d="M939 895.7L686.3 643H928c17.7 0 32-14.3 32-32s-14.3-32-32-32H577v349c0 17.7 14.3 32 32 32s32-14.3 32-32V688.3L893.7 941c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3zM383 96v243.7L129.3 86C116.8 73.5 96.5 73.5 84 86s-12.5 32.8 0 45.3L336.7 384H96c-17.7 0-32 14.3-32 32s14.3 32 32 32h351V96c0-17.7-14.3-32-32-32s-32 14.3-32 32zM938 89c-12.5-12.5-32.8-12.5-45.3 0L641 340.7V96c0-17.7-14.3-32-32-32s-32 14.3-32 32v352h351c17.7 0 32-14.3 32-32s-14.3-32-32-32H688.3L938 134.3c12.5-12.5 12.5-32.8 0-45.3zM64 611c0 17.7 14.3 32 32 32h242.7L83 898.7c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L383 689.3V928c0 17.7 14.3 32 32 32s32-14.3 32-32V579H96c-17.7 0-32 14.3-32 32z" p-id="32877" fill="#ffffff"></path></svg>',g.title="缩放",g.addEventListener("click",(function(){if(o.currentEditCollection[0].graph&&o.currentEditCollection[0].graph.ent){var e=o.currentEditCollection[0].graph.scalev;.2!==e&&localStorage.setItem("scalev",e);var t=Number(localStorage.getItem("scalev"));o.currentEditCollection[0].graph.scalev=e===t?.2:t}o.fire("plot_scalev",o.currentEditCollection[0].graph),o._engine.callChangeEvent("缩放",o.currentEditCollection[0].graph)})),s.appendChild(g),this.editCollection.exportDivDom?((m=this.editCollection.exportDivDom).parentElement.removeChild(m),this.editCollection.exportDivDom=null):((m=document.createElement("div")).id="btnItem",m.style.color="#ffffff",m.style.padding="0",m.style.fontSize="20px",m.style.margin="7px",m.style.opacity="0.8",m.innerHTML='<svg t="1661937719349" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="24807" width="20" height="20"><path d="M944.938667 296.064l-5.162667-5.162667a92.586667 92.586667 0 0 0-62.037333-23.296h-408.490667l-43.946667-110.933333a47.829333 47.829333 0 0 0-43.946666-28.458667H135.722667a105.045333 105.045333 0 0 0-64.64 28.458667A84.010667 84.010667 0 0 0 42.666667 221.312V823.466667a97.408 97.408 0 0 0 93.056 93.098666H877.653333a92.458667 92.458667 0 0 0 64.64-28.458666 84.010667 84.010667 0 0 0 28.416-64.64V360.704a91.776 91.776 0 0 0-25.770666-64.64z m-279.210667 289.578667a14.165333 14.165333 0 0 1-15.488 10.325333H567.466667v186.154667c0 7.765333-12.8 15.530667-28.416 15.530666h-56.874667a33.024 33.024 0 0 1-31.018667-15.530666v-186.154667H368.426667a21.333333 21.333333 0 0 1-15.530667-10.325333 15.829333 15.829333 0 0 1 2.602667-18.090667l139.605333-175.829333a14.634667 14.634667 0 0 1 25.856 0l142.208 175.829333a15.872 15.872 0 0 1 2.56 18.090667z" p-id="24808" fill="#ffffff"></path></svg>',m.title="导出",m.addEventListener("click",(function(){o.currentEditGraph&&o.onExport(o.currentEditGraph)}))),s.appendChild(m),this.editCollection.deleteDivDom?((f=this.editCollection.deleteDivDom).parentElement.removeChild(f),this.editCollection.deleteDivDom=null):((f=document.createElement("div")).id="btnItem",f.style.id="delete",f.style.color="#ffffff",f.style.padding="0",f.style.fontSize="20px",f.style.margin="7px",f.style.opacity="0.8",f.innerHTML='<svg t="1661937719349" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="24807" width="20" height="20"><path d="M805.645277 195.651255H134.016073a35.171491 35.171491 0 0 1-37.333934-37.333934 35.10789 35.10789 0 0 1 37.333934-37.333934h186.542467V83.649453c0-20.606805 16.727129-37.333934 37.333934-37.333934h223.876402a38.16075 38.16075 0 0 1 37.333934 37.333934v37.333934h186.542467a34.917086 34.917086 0 0 1 37.333934 37.333934 35.044289 35.044289 0 0 1-37.333934 37.333934zM134.016073 270.255522h671.629204a35.10789 35.10789 0 0 1 37.333934 37.333934 34.980688 34.980688 0 0 1-10.239801 27.094133 34.980688 34.980688 0 0 1-27.094133 10.239801h-37.270332v525.982341c0 41.21361-33.454258 74.667868-74.667868 74.667868h-447.752803a74.667868 74.667868 0 0 1-74.667868-74.667868v-525.982341H134.016073a35.171491 35.171491 0 0 1-37.333934-37.333934 35.10789 35.10789 0 0 1 37.333934-37.333934z m410.418869 487.948793a38.860364 38.860364 0 0 0 74.667868 0V456.161977a38.796763 38.796763 0 0 0-74.667868 0v302.042338z m-223.876402 0a38.796763 38.796763 0 0 0 74.604267 0V456.161977a38.66956 38.66956 0 0 0-74.604267 0v302.042338z" p-id="24333" fill="#ffffff"></path></svg>',f.title="删除",f.addEventListener("click",(function(){o.fire("plot_delete",o.currentEditGraph);var e=o._engine.sceneTree.getLeaf(o.currentEditGraph.gvolGuid);e?(o.deleteSelectGraph(),o._engine.sceneTree.removeSceneObject(e)):cx.warn("删除失败")}))),s.appendChild(f);var A=document.createElement("div");A.className="operator-btn",A.innerHTML='<i class="operator-img iconfont gp-maoding"></i>',A.title="锚定",A.addEventListener("click",(function(){var e,t=o.currentEditGraphList[0];if(t.anchorHelper&&(null===(e=t.anchorHelper.sourceGraphIdList)||void 0===e?void 0:e.length)&&Vy.anchorClsTreeNodeMap[t.id])Vy.showNotAllowAnchorMessage();else if(t.anchorHelper)t.anchorHelper&&t.anchorHelper.targetGraphId&&(t.anchorHelper.destroyAnchor(),Vy.showCancelAnchoredMessage(t),delete t.anchorHelper);else{o.pickTypes=[JS],o.startPickTarget=!0,o.pickString="请选择锚定对象",t.anchorHelper=new Vy(o.viewer),t.anchorHelper.sourceGraphId=t.id,t.anchorHelper.addAnchorConnectLine(t);o.anchorSub$=o.pickCompleted$.subscribe((function(e){if(e&&e.anchorHelper&&e.anchorHelper.targetGraphId&&t.anchorHelper)return t.anchorHelper.hideAnchorConnectLine(),Vy.showAgainAnchorMessage(),delete t.anchorHelper,o.anchorSub$.unsubscribe(),void(o.anchorSub$=null);if(e&&e.ent&&t.anchorHelper){t.anchorHelper.targetGraphId=e.id,Vy.addAnchoredGraph(t.id),Vy.addIdInSourceGraphIdList(t.id,e.id),o.startPickTarget=!1,o.pickString="";var i=Vy._getGraphPositionCartesian(e.ent),r=Cesium.Cartographic.fromCartesian(i),n=Cesium.Math.toDegrees(r.longitude),s=Cesium.Math.toDegrees(r.latitude),a=r.height;t.anchorHelper.deltaHeading=e.ent.graph.heading-t.ent.graph.heading,t.anchorHelper.prevHeading=e.ent.graph.heading;var l=Vy._getGraphPositionCartesian(t.ent),h=Cesium.Cartographic.fromCartesian(l),c=Cesium.Math.toDegrees(h.longitude),u=Cesium.Math.toDegrees(h.latitude),p=h.height;t.anchorHelper.deltaLng=n-c,t.anchorHelper.deltaLat=s-u,t.anchorHelper.deltaAlt=a-p,t.anchorHelper.addAnchorListenerInRender(),t.anchorHelper.removeConnectLineListen(),o.anchorSub$.unsubscribe(),o.anchorSub$=null,Vy.showAnchoredMessage(t,e)}else t&&t.anchorHelper&&(t.anchorHelper.hideAnchorConnectLine(),Vy.showNoSelected(),delete t.anchorHelper,o.anchorSub$.unsubscribe(),o.anchorSub$=null)}))}})),this.operatorButton=e,this.getOwnerElement().appendChild(s),this.operatorContainer=s,this.operatorContainer.style.display="none";var y=new Cesium.Cartesian2;this.viewer.scene.preRender.addEventListener((function(){var e;if(o.currentEditCollection&&o.currentEditCollection.length>0){if(o.currentEditCollection[0].graph instanceof ZP)return;var t=o.getCenter(),i=o.getCartesianWithTerrainHeight(o.currentEditCollection[0].graph,t),r=o.viewer.scene.cartesianToCanvasCoordinates(i,y);if(!r)return;if(o.operatorContainer&&!o.operatorMoved){o.operatorContainer.style.top=r.y+"px",o.operatorContainer.style.left=r.x+"px";var n=o.operatorContainer.getBoundingClientRect(),s=document.querySelector("#cesium-div"),a=void 0,l=void 0,c=50;if(s){var u=s.getBoundingClientRect();n.top<u.top+c&&(a=u.top+c-n.top),n.bottom>u.bottom-c&&(a=u.bottom-c-n.bottom),n.left<u.left+c&&(l=u.left+c-n.left),n.right>u.right-c&&(l=u.right-c-n.right),o.operatorContainer.style.top="".concat(parseInt(o.operatorContainer.style.top)+a,"px"),o.operatorContainer.style.left="".concat(parseInt(o.operatorContainer.style.left)+l,"px")}}(p=o.currentEditCollection[0]).graph.reloadOperator&&(p.graph.reloadOperator=!1,o.closeOperator(),o.showOperator(p.graph),"flex"==o.pointOperatorContainer.style.display&&(o.closePointOperator(),o.showPointOperator())),h.style.display=p.graph.isReadOnly?"block":"none"}if(1===o.currentEditCollection.length&&(o.currentEditCollection[0].graph instanceof JS||o.currentEditCollection[0].graph instanceof hx||o.currentEditCollection[0].graph instanceof nx)){var p;if(A.style.display="block",!(p=o.currentEditCollection[0]))return;var d=A.querySelector(".operator-img");p.graph&&p.graph.anchorHelper&&(null===(e=p.graph.anchorHelper)||void 0===e?void 0:e.targetGraphId)&&d?(d.className="operator-img iconfont gp-quxiaomaoding",A.title="取消锚定"):!p.graph||p.graph.anchorHelper&&p.graph.anchorHelper.targetGraphId||!d||(d.className="operator-img iconfont gp-maoding",A.title="锚定")}else A.style.display="none"})),this.editCollection.divContainerDom=s,this.editCollection.moveDivDom=a,this.editCollection.editButtonDomCollection=c,this.editCollection.editButtonInfoCollection=l,this.editCollection.exportDivDom=m,this.editCollection.coverDivDom=h,this.editCollection.deleteDivDom=f,this.editCollection.anchorDivDom=A}},t.prototype.getCenter=function(){var e,t,i=[];try{for(var r=mx(this.currentEditGraphList),n=r.next();!n.done;n=r.next()){var o=n.value;i.push(o.getCenter())}}catch(t){e={error:t}}finally{try{n&&!n.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}return Cesium.BoundingSphere.fromPoints(i).center},t.prototype.showOperator=function(e){var t,i,r,n;if(this.operatorEnable&&!(e instanceof ZP))if(this.operatorContainer.style.display="flex",e instanceof rv)try{for(var o=mx(this.operatorButton),s=o.next();!s.done;s=o.next()){(c=s.value).htmlElement.style.display=c.CanOperator(e)?"":"none"}}catch(e){t={error:e}}finally{try{s&&!s.done&&(i=o.return)&&i.call(o)}finally{if(t)throw t.error}}else{var a=function(t){t.htmlElement.style.display=e.filter((function(e){return t.CanOperator(e)})).length==e.length?"":"none"};try{for(var l=mx(this.operatorButton),h=l.next();!h.done;h=l.next()){var c;a(c=h.value)}}catch(e){r={error:e}}finally{try{h&&!h.done&&(n=l.return)&&n.call(l)}finally{if(r)throw r.error}}}},t.prototype.changeCtrlColor=function(e){e instanceof Array&&e.length>1&&e.forEach((function(e){if(e.ctrlsCollection&&e.ctrlsCollection.length>0)for(var t=0;t<e.ctrlsCollection.length;t++)e.ctrlsCollection.get(t).color=Cesium.Color.RED}))},t.prototype.closeOperator=function(){this.operatorEnable&&(this.operatorContainer.style.display="none")},t.prototype.removeOperator=function(){this.operatorContainer&&this.operatorContainer.remove()},t.prototype.operatorBegin=function(e){var t,i,r,n;this.beginValue={};var o=this.beginValue;try{for(var s=mx(this.currentEditGraphList),a=s.next();!a.done;a=s.next()){var l=a.value,h=e.property(l),c={};try{for(var u=(r=void 0,mx(h)),p=u.next();!p.done;p=u.next()){var d=p.value;c[d]=JSON.stringify(l[d])}}catch(e){r={error:e}}finally{try{p&&!p.done&&(n=u.return)&&n.call(u)}finally{if(r)throw r.error}}o[l.id]=c}}catch(e){t={error:e}}finally{try{a&&!a.done&&(i=s.return)&&i.call(s)}finally{if(t)throw t.error}}},t.prototype.operatorEnd=function(e,i){var r,n,o,s;void 0===i&&(i=!1);var a={};try{for(var l=mx(this.currentEditGraphList),h=l.next();!h.done;h=l.next()){var c=h.value,u=e.property(c),p={};try{for(var d=(o=void 0,mx(u)),m=d.next();!m.done;m=d.next()){var f=m.value;p[f]=JSON.stringify(c[f])}}catch(e){o={error:e}}finally{try{m&&!m.done&&(s=d.return)&&s.call(d)}finally{if(o)throw o.error}}a[c.id]=p}}catch(e){r={error:e}}finally{try{h&&!h.done&&(n=l.return)&&n.call(l)}finally{if(r)throw r.error}}t.operatorComplete.next({target:this.currentEditGraphList,begin:this.beginValue,end:a,highlight:i})},t.prototype.rotateByHeading=function(e,t){this.currentEditGraphList.forEach((function(i){return i.rotateByHeading(e,t)}))},t.prototype.rotateHeadingByAngle=function(e,t){this.currentEditGraphList.forEach((function(i){return i.rotateHeadingByAngle(e,t)}))},t.prototype.rotateByPitch=function(e,t){this.currentEditGraphList.forEach((function(i){return i.rotateByPitch(e,t)}))},t.prototype.rotateByRoll=function(e,t){this.currentEditGraphList.forEach((function(i){return i.rotateByRoll(e,t)}))},t.prototype.movePosition=function(e,t){this.currentEditGraphList.forEach((function(i){return i.movePosition(e,t)})),this.currentEditGraphList.forEach((function(e){return e.positionChanged.next(!1)}))},t.prototype.moveHeight=function(e,t){this.currentEditGraphList.forEach((function(i){i.moveHeight(e,t)})),this.currentEditGraphList.forEach((function(e){return e.positionChanged.next(!0)}))},t.prototype.scale=function(e,t){this.currentEditGraphList.forEach((function(i){return i.scale(e,t)}))},t.prototype.scaleZ=function(e,t){this.currentEditGraphList.forEach((function(i){return i.scaleZ(e,t)}))},t.prototype.scaleX=function(e,t){this.currentEditGraphList.forEach((function(i){return i.scaleX(e,t)}))},t.prototype.scaleY=function(e,t){this.currentEditGraphList.forEach((function(i){return i.scaleY(e,t)}))},t.prototype.getGraphScreenCoord=function(e){var t=Cesium.Cartesian3.fromDegrees(e.ctrlPosition[0].lon,e.ctrlPosition[0].lat,e.ctrlPosition[0].alt);return Cesium.SceneTransforms.wgs84ToWindowCoordinates(this.viewer.scene,t)},t.prototype.destroyGraphAnchor=function(e){void 0===e&&(e=!1);var t=this.currentEditGraphList[0];t&&t.anchorHelper&&(t.anchorHelper.destroyAnchor(),e&&delete t.anchorHelper)},t.prototype.removeAnchorConnectLineByRightClick=function(){this.destroyGraphAnchor(!0),this.anchorSub$&&(this.anchorSub$.unsubscribe(),this.anchorSub$=null,Vy.showNoSelected())},t.prototype.isTwoOrThreeBothSelected=function(){return IP.currentEditGraphList.length&&IP.currentBoxList.length},t.operatorComplete=new th.x,px([(0,fy.o)(),dx("design:type",Object)],t,"nzMessageSer",void 0),t}(p);var Ax=function(){function e(){}return e.DefaultConfig=function(){e.init()},e.init=function(){"undefined"!=typeof window&&(e.baseTimeLine=Cesium.JulianDate.fromDate(new Date("2019-01-01")))},e}();function yx(e){return function(t){_x.set(e,t)}}var vx,Cx,_x=new Map;!function(e){e.HoldEnd="0",e.Stop="1"}(vx||(vx={})),function(e){e[e.stopped=0]="stopped",e[e.playing=1]="playing",e[e.inited=2]="inited"}(Cx||(Cx={}));var bx=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},wx=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};"undefined"==typeof Cesium&&(i.g.Cesium={},i.g.Cesium.Viewer={});var Px=function(){function e(){this.id=xw.v4().replace(/-/g,""),this.state=Cx.stopped,this.hideValues=[],this.animationBaseTime=Ax.baseTimeLine,this.fillBehavior=vx.Stop,this.type=this.constructor.name,this.keyframes=[new Sx,new Sx]}return e.prototype.onReload=function(){},e.prototype.setInitValue=function(){},e.prototype.getCesiumAnimationTime=function(e){return Cesium.JulianDate.addSeconds(this.animationBaseTime,e,new Cesium.JulianDate)},Object.defineProperty(e.prototype,"beginTime",{get:function(){return this.keyframes[0].val/1e3},set:function(e){this.keyframes[1]&&(this.keyframes[1].val=1e3*e+1e3*this.duration),this.keyframes[0].val=1e3*e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"duration",{get:function(){return this.keyframes[1]?(this.keyframes[1].val-this.keyframes[0].val)/1e3:0},set:function(e){if(e||0===e){var t=e-this.duration;this.keyframes[1]&&(this.keyframes[1].val=this.keyframes[1].val+1e3*t)}},enumerable:!1,configurable:!0}),e.prototype.destroy=function(){},bx([dy({name:"动画类型",group:"",type:"text-animation",order:1,noEmpty:!0,hidden:!1}),wx("design:type",String)],e.prototype,"label",void 0),bx([(0,fy.o)(),wx("design:type",Cesium.Viewer)],e.prototype,"viewer",void 0),bx([(0,fy.o)(),wx("design:type",Object)],e.prototype,"__meta__",void 0),bx([(0,fy.o)(),wx("design:type",Object)],e.prototype,"animationBaseTime",void 0),bx([(0,fy.o)(),wx("design:type",Number)],e.prototype,"_beginTime",void 0),bx([(0,fy.o)(),dy({name:"开始时间",group:"",type:"numberNew",order:2,min:0,max:1e4}),wx("design:type",Number),wx("design:paramtypes",[Number])],e.prototype,"beginTime",null),bx([(0,fy.o)(),dy({name:"持续时间",group:"",type:"numberNew",order:3,min:0,max:1e3}),wx("design:type",Number),wx("design:paramtypes",[Number])],e.prototype,"duration",null),bx([dy({name:"结束状态",type:"pOption",group:"",order:4,options:[{text:"保持终止",value:vx.HoldEnd},{text:"结束",value:vx.Stop}]}),wx("design:type",String)],e.prototype,"fillBehavior",void 0),bx([(0,fy.o)(),wx("design:type",Boolean)],e.prototype,"selected",void 0),bx([(0,fy.o)(),wx("design:type",String)],e.prototype,"image",void 0),e}(),Sx=function(){function e(){this.selectedFillColor="red",this.shape="rect",this.width=5,this.height=20,this.selected=!1,this.valueChanged=new th.x}return Object.defineProperty(e.prototype,"val",{get:function(){return this._val},set:function(e){this._val=e,this.valueChanged.next(1)},enumerable:!1,configurable:!0}),bx([(0,fy.o)(),wx("design:type",Object)],e.prototype,"selectedFillColor",void 0),bx([(0,fy.o)(),wx("design:type",Object)],e.prototype,"width",void 0),bx([(0,fy.o)(),wx("design:type",Object)],e.prototype,"height",void 0),bx([(0,fy.o)(),wx("design:type",Object)],e.prototype,"selected",void 0),bx([(0,fy.o)(),wx("design:type",Object)],e.prototype,"valueChanged",void 0),e}(),xx=i(5108),Bx=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Mx=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},Ex=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Tx=function(e){function t(){var t=e.call(this)||this;return t.defaultValue=void 0,t}return Bx(t,e),Object.defineProperty(t.prototype,"target",{get:function(){return ey.getGraph(this.targetId)},enumerable:!1,configurable:!0}),t.prototype.initAnimation=function(){this.target?(this.defaultValue=this.target[this.property],this.createSampledProperty(),this.sampledProperty.addSample(Cesium.JulianDate.addSeconds(this.animationBaseTime,this.beginTime,new Cesium.JulianDate),this.from),this.sampledProperty.addSample(Cesium.JulianDate.addSeconds(this.animationBaseTime,this.beginTime+this.duration,new Cesium.JulianDate),this.to)):xx.error("动画关联标绘元素不存在")},t.prototype.onTick=function(e){if(this.target){var t=e;if(t>=this.beginTime+this.duration){var i=vx.HoldEnd;this.fillBehavior===i?this.target[this.property]=this.to:this.stopAnimation()}else if(t>=this.beginTime){var r=this.getCurrentValue(e);this.target[this.property]=r}}},t.prototype.getCurrentValue=function(e){var t=e;return t<this.beginTime?this.from:t>this.beginTime+this.duration?this.to:this.sampledProperty.getValue(this.getCesiumAnimationTime(e))},t.prototype.stopAnimation=function(){this.target&&(this.target[this.property]=this.defaultValue)},Mx([dy({name:"标绘元素",group:"",type:"displayTarget",order:9}),(0,fy.o)(),Ex("design:type",rv),Ex("design:paramtypes",[])],t.prototype,"target",null),Mx([dy({name:"起始值",group:"",type:"owner",order:5,max:1,min:0}),Ex("design:type",Object)],t.prototype,"from",void 0),Mx([dy({name:"终止值",group:"",type:"owner",order:6,max:1,min:0}),Ex("design:type",Object)],t.prototype,"to",void 0),Mx([(0,fy.o)(),Ex("design:type",Cesium.SampledProperty)],t.prototype,"sampledProperty",void 0),t}(Px),Ox=i(5108),Lx=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Dx=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},Ix=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Rx=function(e){function t(){var t=e.call(this)||this;return t.playing=!1,t.increase=!1,t}return Lx(t,e),Object.defineProperty(t.prototype,"isIncrease",{get:function(){return this.increase},set:function(e){this.increase=e},enumerable:!1,configurable:!0}),t.prototype.createSampledProperty=function(){this.sampledProperty=new Cesium.SampledProperty(Number)},t.prototype.initAnimation=function(){this.target?(this.playing=!0,this.defaultValue=this.target[this.property],this.isIncrease?this.from=0:this.from=this.defaultValue,this.to=this.defaultValue,this.createSampledProperty(),this.sampledProperty.addSample(Cesium.JulianDate.addSeconds(this.animationBaseTime,this.beginTime,new Cesium.JulianDate),this.from),this.sampledProperty.addSample(Cesium.JulianDate.addSeconds(this.animationBaseTime,this.beginTime+this.duration,new Cesium.JulianDate),this.to)):Ox.error("动画关联标绘元素不存在")},t.prototype.setInitValue=function(){var e=this;this.target&&setTimeout((function(){e.target&&(e.target[e.property]=1e-4)}))},t.prototype.onTick=function(e){var t=e;if(this.target)if(t>=this.beginTime+this.duration)this.fillBehavior===vx.HoldEnd?this.target[this.property]=this.to:this.playing&&(this.target[this.property]=1e-4);else if(t>=this.beginTime){var i=this.getCurrentValue(e);this.target[this.property]=i}},t.prototype.stopAnimation=function(){this.target&&void 0!==this.defaultValue&&this.playing&&(this.target[this.property]=this.defaultValue),this.playing=!1},Dx([dy({name:"渐显",group:"",subOrder:6,type:"boolean",order:2}),Ix("design:type",Boolean),Ix("design:paramtypes",[Boolean])],t.prototype,"isIncrease",null),t=Dx([yx("ShowAnimation"),Ix("design:paramtypes",[])],t)}(Tx),Hx=i(5108),Fx=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},Nx=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Qx=function(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],r=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};"undefined"==typeof window&&(i.g.Cesium={},i.g.Cesium.Viewer={});var kx=function(){function e(){this._animationList=[],this.offsetSeconds=0,this.isinited=!1}return Object.defineProperty(e.prototype,"animationList",{get:function(){return this._animationList},set:function(e){this._animationList=e},enumerable:!1,configurable:!0}),e.prototype.add=function(e){e?(e.viewer=this.viewer,this.animationList.push(e)):Hx.log("add animation错误")},e.prototype.remove=function(e){ty.Remove(this._animationList,e)},Object.defineProperty(e.prototype,"duration",{get:function(){var e,t,i=0;try{for(var r=Qx(this.animationList),n=r.next();!n.done;n=r.next()){var o=n.value,s=o.beginTime+(o.duration?o.duration:0);i<s&&(i=s)}}catch(t){e={error:t}}finally{try{n&&!n.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}return i},enumerable:!1,configurable:!0}),e.prototype.initAnimation=function(e){var t,i,r,n;try{for(var o=Qx(this.animationList),s=o.next();!s.done;s=o.next()){s.value.initAnimation()}}catch(e){t={error:e}}finally{try{s&&!s.done&&(i=o.return)&&i.call(o)}finally{if(t)throw t.error}}try{for(var a=Qx(this.animationList),l=a.next();!l.done;l=a.next()){l.value.setInitValue()}}catch(e){r={error:e}}finally{try{l&&!l.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}this.isinited=!0},e.prototype.onTick=function(e){var t,i;try{for(var r=Qx(this.animationList),n=r.next();!n.done;n=r.next()){var o=n.value;o.onTick.call(o,e-this.beginTime-this.offsetSeconds)}}catch(e){t={error:e}}finally{try{n&&!n.done&&(i=r.return)&&i.call(r)}finally{if(t)throw t.error}}},e.prototype.stop=function(){var e,t;if(this.isinited)try{for(var i=Qx(this.animationList),r=i.next();!r.done;r=i.next()){r.value.stopAnimation()}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}this.isinited=!1,this.animationList.filter((function(e){return e instanceof Rx})).forEach((function(e){return e.stopAnimation()}))},Fx([(0,fy.o)(),Nx("design:type",Cesium.Viewer)],e.prototype,"viewer",void 0),Fx([(0,fy.o)(),Nx("design:type",Array)],e.prototype,"_animationList",void 0),Fx([(0,fy.o)(),Nx("design:type",Number),Nx("design:paramtypes",[])],e.prototype,"duration",null),Fx([(0,fy.o)(),Nx("design:type",Number)],e.prototype,"beginTime",void 0),Fx([(0,fy.o)(),Nx("design:type",Object)],e.prototype,"isinited",void 0),e}(),Ux=i(9974),jx=i(1739),Gx=function(){function e(t,i){void 0===i&&(i=!1);var r=this;this.currentTime=0,this.isPaused=!1,this.isPaused=i;var n=0;this.timer=jx.HT((function(i){r.isPaused||(r.currentTime=r.currentTime+(i-n)*e.multiplier/1e3,t(r.currentTime)),n=i}))}return e.prototype.pause=function(){this.isPaused=!0},e.prototype.resume=function(){this.isPaused=!1},e.prototype.stop=function(){this.timer.stop()},e.prototype.seek=function(e){this.currentTime=e},e.multiplier=1,e}(),zx=i(5108),Yx=function(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],r=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Zx=function(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var r,n,o=i.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){n={error:e}}finally{try{r&&!r.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}return s},Wx=function(e,t,i){if(i||2===arguments.length)for(var r,n=0,o=t.length;n<o;n++)!r&&n in t||(r||(r=Array.prototype.slice.call(t,0,n)),r[n]=t[n]);return e.concat(r||Array.prototype.slice.call(t))},Xx=function(){function e(e){this._animationGroupList=[],this.baseTimeLine=Ax.baseTimeLine,this.saStop$=new th.x,this._currentIndex=-1,this.timeLineOffset=0,this.viewer=e}return Object.defineProperty(e.prototype,"animationGroupList",{get:function(){return this._animationGroupList},set:function(e){this._animationGroupList=e},enumerable:!1,configurable:!0}),e.prototype.add=function(e){e.viewer=this.viewer,this.animationGroupList.push(e)},e.prototype.load=function(t){var i,r,n,o;this._animationGroupList=[];try{for(var s=Yx(t),a=s.next();!a.done;a=s.next()){var l=a.value,h=(0,Ux.d8)(kx,l);h.viewer=this.viewer;var c=h.animationList;h.animationList=[];try{for(var u=(n=void 0,Yx(c)),p=u.next();!p.done;p=u.next()){var d=p.value,m=e.deserializeSingleAnimation(d);h.add(m),m.onReload()}}catch(e){n={error:e}}finally{try{p&&!p.done&&(o=u.return)&&o.call(u)}finally{if(n)throw n.error}}this._animationGroupList.push(h)}}catch(e){i={error:e}}finally{try{a&&!a.done&&(r=s.return)&&r.call(s)}finally{if(i)throw i.error}}},e.prototype.destroy=function(){var e,t,i,r;try{for(var n=Yx(this.animationGroupList),o=n.next();!o.done;o=n.next()){var s=o.value;try{for(var a=(i=void 0,Yx(s.animationList)),l=a.next();!l.done;l=a.next()){l.value.destroy()}}catch(e){i={error:e}}finally{try{l&&!l.done&&(r=a.return)&&r.call(a)}finally{if(i)throw i.error}}}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}},e.prototype.save=function(){var e,t,i,r,n=[];try{for(var o=Yx(this.animationGroupList),s=o.next();!s.done;s=o.next()){var a=s.value,l=(0,Ux.ZE)(a);l.animationList=[];try{for(var h=(i=void 0,Yx(a.animationList)),c=h.next();!c.done;c=h.next()){var u=c.value,p=(0,Ux.ZE)(u);l.animationList.push(p)}}catch(e){i={error:e}}finally{try{c&&!c.done&&(r=h.return)&&r.call(h)}finally{if(i)throw i.error}}n.push(l)}}catch(t){e={error:t}}finally{try{s&&!s.done&&(t=o.return)&&t.call(o)}finally{if(e)throw e.error}}return n},Object.defineProperty(e.prototype,"totalTime",{get:function(){var e,t,i=0;try{for(var r=Yx(this.animationGroupList),n=r.next();!n.done;n=r.next()){i+=n.value.duration}}catch(t){e={error:t}}finally{try{n&&!n.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}return i},enumerable:!1,configurable:!0}),e.serializeSingleAnimation=function(e){_x.get(e.type);var t=(0,Ux.ZE)(e);return t.keyframes=(0,Ux.d8)(Sx,t.keyframes),t},e.deserializeSingleAnimation=function(e){var t=_x.get(e.type);if(!t)return null;var i=(0,Ux.d8)(t,e),r=i;return r.keyframes=(0,Ux.d8)(Sx,r.keyframes),i},Object.defineProperty(e.prototype,"currentIndex",{get:function(){return this._currentIndex},set:function(e){this._currentIndex=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentAnimationGroup",{get:function(){return this.animationGroupList[this.currentIndex]},enumerable:!1,configurable:!0}),e.prototype.initAnimation=function(e){this._currentIndex=-1;for(var t=0;t<this.animationGroupList.length;t++)this.animationGroupList[t].beginTime=t>0?this.animationGroupList[t-1].beginTime+this.animationGroupList[t-1].duration:0,this.animationGroupList[t].initAnimation(e);var i=e?Cesium.JulianDate.fromDate(e):Ax.baseTimeLine.clone();return this.baseTimeLine=i.clone(),i},e.prototype.initAnimationTime=function(e){this._currentIndex=-1;for(var t=0;t<this.animationGroupList.length;t++)this.animationGroupList[t].beginTime=t>0?this.animationGroupList[t-1].beginTime+this.animationGroupList[t-1].duration:0;var i=e?Cesium.JulianDate.fromDate(e):Ax.baseTimeLine.clone();return this.baseTimeLine=i.clone(),i},e.prototype.start=function(e,t){var i=this;void 0===t&&(t=!1);this.initAnimation(e);if(this.timeLineOffset){var r,n=0;(r=Math.max.apply(Math,Wx([],Zx(this.animationGroupList[0].animationList.map((function(e){return e.duration?e.beginTime+e.duration:e.beginTime}))),!1)))>n&&(n=r),this.timeLineOffset>=n&&(this.timeLineOffset=0)}this._currentIndex=0,this.listener=function(t){zx.log(t);try{var r=t;if(i.currentTime=r,i.viewer.clock.currentTime=Cesium.JulianDate.addSeconds(Cesium.JulianDate.fromDate(e),t,new Cesium.JulianDate),r>=i.currentAnimationGroup.beginTime+i.currentAnimationGroup.duration+i.currentAnimationGroup.offsetSeconds&&(i.currentAnimationGroup.onTick(t),i.currentIndex=i.currentIndex+1,i.currentAnimationGroup&&i.clock.seek(i.currentAnimationGroup.beginTime+i.currentAnimationGroup.offsetSeconds)),i.currentIndex>=i.animationGroupList.length)return void i.stop();i.currentAnimationGroup.onTick(t)}catch(e){zx.error(e),i.stop()}},this.clock=new Gx(this.listener,t)},e.prototype.playByGroup=function(e){var t=this;this._currentIndex=-1;for(var i=0;i<this.animationGroupList.length;i++)this.animationGroupList[i].beginTime=i>0?this.animationGroupList[i-1].beginTime+this.animationGroupList[i-1].duration:0,this.animationGroupList[i].initAnimation(e),this.animationGroupList[i].duration;this.listener=function(i){try{var r=i;if(t.currentTime=r,t.viewer.clock.currentTime=Cesium.JulianDate.addSeconds(Cesium.JulianDate.fromDate(e),i,new Cesium.JulianDate),r>=t.currentAnimationGroup.beginTime+t.currentAnimationGroup.duration+t.currentAnimationGroup.offsetSeconds&&(t.currentAnimationGroup.onTick(i),t.clock.pause(),t.saStop$.next(!1)),t.currentIndex>=t.animationGroupList.length)return void t.stop();if(!t.currentAnimationGroup)return void t.stop();r>=t.currentAnimationGroup.beginTime+t.currentAnimationGroup.offsetSeconds&&t.currentAnimationGroup.onTick(i)}catch(e){zx.error(e)}},this.clock=new Gx(this.listener,!0)},e.prototype.stop=function(){var e,t;this.clock&&this.clock.stop();try{for(var i=Yx(this.animationGroupList),r=i.next();!r.done;r=i.next()){r.value.stop()}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}this.listener=null},e.prototype.canNextAnimation=function(){return this._currentIndex<this.animationGroupList.length-1},e.prototype.next=function(){return this._currentIndex<this.animationGroupList.length-1&&(this._currentIndex=this._currentIndex+1,this.clock.seek(this.currentAnimationGroup.beginTime+this.currentAnimationGroup.offsetSeconds),this.animationGroupList[this._currentIndex-1],this.clock.resume(),!0)},e.prototype.preview=function(){if(this.currentIndex>0){var e=this.animationGroupList[this.currentIndex-1];this.currentIndex=this.currentIndex-1,this.clock.seek(e.beginTime)}},e}(),Jx=i(5108),Kx=function(e,t,i,r){return new(i||(i=Promise))((function(n,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?n(e.value):function(e){return e instanceof i?e:new i((function(t){t(e)}))}(e.value).then(s,a)}l((r=r.apply(e,t||[])).next())}))},Vx=function(e,t){var i,r,n,o,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,r&&(n=2&o[0]?r.return:o[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,o[1])).done)return n;switch(r=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(n=s.trys,(n=n.length>0&&n[n.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){s.label=o[1];break}if(6===o[0]&&s.label<n[1]){s.label=n[1],n=o;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(o);break}n[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{i=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},qx=function(){function e(e,t){this._viewer=e,this._options=t,this._customDataSource=new Cesium.CustomDataSource(t.name),this._pixelRange=t.pixelRange,this._minimumClusterSize=t.minimumClusterSize,this._enable=t.enable,this._customStyleEnable=t.customStyleEnable}return e.prototype.addPoint=function(e){return this._customDataSource.entities.add(e)},e.prototype.removePoint=function(e){this._customDataSource.entities.remove(e)},e.prototype.removePointById=function(e){this._customDataSource.entities.removeById(e)},e.prototype.addToEarth=function(){return Kx(this,void 0,void 0,(function(){var e;return Vx(this,(function(t){switch(t.label){case 0:return[4,this._viewer.dataSources.add(this._customDataSource)];case 1:return e=t.sent(),this._dataSource=e,this._cluster(e),[2]}}))}))},e.prototype.removeFromEarth=function(){this._viewer.dataSources.remove(this._dataSource)},Object.defineProperty(e.prototype,"pixelRange",{get:function(){return this._pixelRange},set:function(e){this._pixelRange=e,Jx.log(e),this._dataSource.clustering.pixelRange=this._pixelRange},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"minimumClusterSize",{get:function(){return this._minimumClusterSize},set:function(e){this._minimumClusterSize=e,this._dataSource.clustering.minimumClusterSize=this._minimumClusterSize},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"enable",{get:function(){return this._enable},set:function(e){this._enable=e,this._dataSource.clustering.enabled=this._enable},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"customStyleEnable",{get:function(){return this._customStyleEnable},set:function(e){this._customStyleEnable=e,e?this._customStyleOpen():Cesium.defined(this._customStyleListener)&&(this._customStyleListener(),this._customStyleListener=void 0,this._resetStyle())},enumerable:!1,configurable:!0}),e.prototype.GxStyleArray=function(){var e=new Cesium.PinBuilder,t=e.fromText("50+",Cesium.Color.BLUE,48).toDataURL(),i=e.fromText("40+",Cesium.Color.BLUE,48).toDataURL(),r=e.fromText("30+",Cesium.Color.BLUE,48).toDataURL(),n=e.fromText("20+",Cesium.Color.BLUE,48).toDataURL(),o=e.fromText("10+",Cesium.Color.BLUE,48).toDataURL(),s=[];s.push({size:10,image:o}),s.push({size:20,image:n}),s.push({size:30,image:r}),s.push({size:40,image:i}),s.push({size:50,image:t});for(var a=new Array(8),l=0;l<a.length;++l){var h=e.fromText(""+(l+2),Cesium.Color.VIOLET,48).toDataURL();s.push({size:l+2,image:h})}},e.prototype._customStyleOpen=function(){var e=this;this._customStyleListener=this._dataSource.clustering.clusterEvent.addEventListener((function(t,i){i.label.show=!1,e._options.setImage(t,i)})),this._resetStyle()},e.prototype._resetStyle=function(){var e=this._dataSource.clustering.pixelRange;this._dataSource.clustering.pixelRange=0,this._dataSource.clustering.pixelRange=e},e.prototype._cluster=function(e){e.clustering.enabled=this._options.enable,e.clustering.pixelRange=this._options.pixelRange,e.clustering.minimumClusterSize=this._options.minimumClusterSize,this.customStyleEnable=this._options.customStyleEnable},e}(),$x=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),eB=function(){return eB=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},eB.apply(this,arguments)},tB=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},iB=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},rB=function(e){function t(t,i,r){var n=e.call(this,t,i,eB({},r))||this;if(n.type="图",n.color="#fff",n.alpha=1,n.rotation=0,n.hideValues=["fill","outline","outlineColor"],r&&r.properties)for(var o in r.properties)n[o]=r.properties[o];return n}return $x(t,e),Object.defineProperty(t.prototype,"image",{get:function(){return this._img},set:function(e){this._img=e,this.material&&this.material.uniforms&&(this.material.uniforms.image=e)},enumerable:!1,configurable:!0}),tB([dy({name:"图",group:"外观",order:8,type:"display",editable:!1}),iB("design:type",String),iB("design:paramtypes",[String])],t.prototype,"image",null),t}(qP);const nB=rB;c.Z.registerType(rB,"EditorImage","Graph");var oB=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),sB=function(){return sB=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},sB.apply(this,arguments)},aB=function(e){function t(t,i,r){return e.call(this,sB({type:"红旗",group:"外观",order:8,image:"redflag1.png"},t),i,r)||this}return oB(t,e),t}(nB);const lB=aB;c.Z.registerType(aB,"EditorRedFlag","Graph");var hB=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),cB=function(){return cB=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},cB.apply(this,arguments)},uB=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},pB=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};"undefined"==typeof window&&(i.g.Cesium={},i.g.Cesium.Viewer={},i.g.Cesium.HeightReference={},i.g.Cesium.Cartesian2={});var dB=function(e){function t(t,i,r){var n=e.call(this,t,i,cB({},r))||this;if(n.maxPointNum=1,n.minPointNum=1,n.scaleProperty=["pixelSize"],n.type="点",n.pixelSize=20,n.colorShow=!0,n.color="#00FF00",n.alpha=1,n.outlineShow=!0,n.outlineWidth=2,n.outlineColor="#FFFFFF",n.distanceDisplay=!1,n.distanceHeight=55e5,n.hideValues=["pointIndex"],r&&r.properties)for(var o in r.properties)r.properties[o]&&(n[o]=r.properties[o]);return n}return hB(t,e),t.prototype.initShape=function(){var e=this;this.ent=this.entities.add(new Cesium.Entity({point:{}})),this.ent.show=this.show,this.fillShape(this.ent),Object.assign(this.ent.point,{pixelSize:new Cesium.CallbackProperty((function(t,i){return e.pixelSize}),!0),color:new Cesium.CallbackProperty((function(t,i){return e.colorShow?Cesium.Color.fromCssColorString(e.color).withAlpha(e.alpha):Cesium.Color.fromCssColorString(e.color).withAlpha(0)}),!0),heightReference:new Cesium.CallbackProperty((function(t,i){return e.heightReference}),!0),outlineColor:new Cesium.CallbackProperty((function(t,i){return Cesium.Color.fromCssColorString(e.outlineColor).withAlpha(e.alpha)}),!0),outlineWidth:new Cesium.CallbackProperty((function(t,i){return e.outlineShow?e.outlineWidth:0}),!0),distanceDisplayCondition:new Cesium.CallbackProperty((function(t,i){if(e.distanceDisplay)return new Cesium.DistanceDisplayCondition(0,e.distanceHeight)}),!0)}),this.ent.position=new Cesium.CallbackProperty((function(t,i){return e.calcuteShape(e._singleControlPosition.concat($A.cursorPos),t)}),!1)},t.prototype.calcuteShape=function(e,t){if(e[0]&&!(e.length<this.minPointNum)){var i=e[0];return this.setInternalControlPosition(e,t),i}},t.prototype.scale=function(e,t){this.scalable&&(this.pixelSize=this.changeScaleByMouse(this.pixelSize,e,t),this.onPropertyChanged())},t.prototype.toEdit=function(){var t=this;e.prototype.toEdit.call(this),this.ent.position=new Cesium.CallbackProperty((function(e,i){return t.calcuteShape(t._singleControlPosition,e)}),!1)},t.prototype.finish=function(){this.ent&&(this.ent.position=this.calcuteShape(this._singleControlPosition,zy.julianDate()),e.prototype.finish.call(this))},t.prototype.gridUpdate=function(){var e=this;if(this.ctrlPosition&&this.ctrlPosition.length>0){var t="Point("+this.ctrlPosition[0].lon+" "+this.ctrlPosition[0].lat+")",i="".concat(window.config.geopptService,"/grid/getPlotGrid"),r=this.gridLevel;r||(r=0);var n=new Request(i,{method:"post",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify({position:t,level:r,isAgg:this.gridIsAgg})});return new Promise((function(t,i){fetch(n).then((function(e){return e.json()})).then((function(t){var i=JSON.parse(t[0].st_withbox);e._gridLevel=i.detailLevel;var r=e.formatBBox(i.cells);e.drawGrid(r)})).catch((function(e){i(!1)}))}))}},uB([(0,fy.o)(),pB("design:type",Object)],t.prototype,"maxPointNum",void 0),uB([(0,fy.o)(),pB("design:type",Object)],t.prototype,"minPointNum",void 0),uB([(0,gy.C)(),dy({name:"不透明度",group:"通用",subGroup:"不透明度",type:"slider",order:2,subOrder:4,min:0,max:1}),pB("design:type",Number)],t.prototype,"alpha",void 0),uB([dy({name:"尺寸",group:"外观",type:"numberNew",order:8,min:0,max:256}),pB("design:type",Number)],t.prototype,"pixelSize",void 0),uB([dy({name:"是否填充",group:"外观",subGroup:"填充",type:"checkboxSub",order:8,subOrder:5}),pB("design:type",Boolean)],t.prototype,"colorShow",void 0),uB([dy({name:"颜色",group:"外观",subGroup:"填充",type:"color",order:8,noEmpty:!1,subOrder:6}),pB("design:type",String)],t.prototype,"color",void 0),uB([dy({name:"是否描边",group:"外观",type:"checkboxSub",order:8,subGroup:"描边",subOrder:7}),pB("design:type",Boolean)],t.prototype,"outlineShow",void 0),uB([dy({name:"描边颜色",group:"外观",subGroup:"描边",order:8,subOrder:8,type:"color"}),pB("design:type",String)],t.prototype,"outlineColor",void 0),uB([dy({name:"描边线宽",group:"外观",subGroup:"描边线宽",order:8,subOrder:9,type:"numberNew",min:0,max:100}),pB("design:type",Number)],t.prototype,"outlineWidth",void 0),uB([(0,fy.o)(),pB("design:type",Function),pB("design:paramtypes",[]),pB("design:returntype",void 0)],t.prototype,"initShape",null),uB([(0,fy.o)(),pB("design:type",Function),pB("design:paramtypes",[Object,Object]),pB("design:returntype",void 0)],t.prototype,"calcuteShape",null),uB([(0,fy.o)(),pB("design:type",Function),pB("design:paramtypes",[Cesium.Cartesian2,Cesium.Cartesian2]),pB("design:returntype",void 0)],t.prototype,"scale",null),uB([(0,fy.o)(),pB("design:type",Function),pB("design:paramtypes",[]),pB("design:returntype",void 0)],t.prototype,"toEdit",null),uB([(0,fy.o)(),pB("design:type",Function),pB("design:paramtypes",[]),pB("design:returntype",void 0)],t.prototype,"finish",null),t}(jS);const mB=dB;c.Z.registerType(dB,"EditorPoint","Graph");var fB=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),gB=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},AB=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const yB=function(e){function t(t,i,r){var n=e.call(this,t,i,{})||this;return n.maxPointNum=1,n.minPointNum=1,n.pinBuilder=new Cesium.PinBuilder,n.scaleProperty=["scalev"],n.rotateByHeadingProperty=["rotation"],n.type="钉",n.rotation=0,n.initPropBySavedValue(),n.imageOffsetX=0,n.imageOffsetY=0,n}return fB(t,e),t.prototype.initPropBySavedValue=function(){var e=$P.getProp(this.type);return this._width=e.width?e.width:30,this._height=e.height?e.height:30,this._scalev=e.scalev?e.scalev:1,this._scaleByDistance=!!e.scaleByDistance&&e.scaleByDistance,this._heightReference=e.heightReference?e.heightReference:Cesium.HeightReference.RELATIVE_TO_GROUND,this._scaleMaxSize=e.scaleMaxSize?e.scaleMaxSize:4,this._scaleMinSize=e.scaleMinSize?e.scaleMinSize:1,e},Object.defineProperty(t.prototype,"rotation",{get:function(){return this._rotation},set:function(e){this._rotation=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"scalev",{get:function(){return this._scalev},set:function(e){$P.saveProp(this.type,"scalev",e),this._scalev=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this._width},set:function(e){$P.saveProp(this.type,"width",e),this._width=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._height},set:function(e){$P.saveProp(this.type,"height",e),this._height=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"scaleByDistance",{get:function(){return this._scaleByDistance},set:function(e){$P.saveProp(this.type,"scaleByDistance",e),this._scaleByDistance=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"scaleMaxSize",{get:function(){return this._scaleMaxSize},set:function(e){$P.saveProp(this.type,"scaleMaxSize",e),this._scaleMaxSize=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"scaleMinSize",{get:function(){return this._scaleMinSize},set:function(e){$P.saveProp(this.type,"scaleMinSize",e),this._scaleMinSize=e},enumerable:!1,configurable:!0}),t.prototype.initShapePin=function(){var e=this;this.ent=this.entities.add(new Cesium.Entity({billboard:{},label:{},polyline:{}})),this.fillShape(this.ent),Object.assign(this.ent.billboard,{scaleByDistance:new Cesium.CallbackProperty((function(t,i){return e.scaleByDistance?new Cesium.NearFarScalar(150,e.scaleMaxSize,15e6,e.scaleMinSize):null}),!0),pixelOffsetScaleByDistance:new Cesium.CallbackProperty((function(t,i){return e.scaleByDistance?new Cesium.NearFarScalar(150,e.scaleMaxSize,15e6,e.scaleMinSize):null}),!0)})},t.prototype.scale=function(e,t){this.scalable&&(this.scalev=this.changeScaleByMouse(this.scalev,e,t),this.onPropertyChanged())},t.prototype.rotateByHeading=function(e,t){if(this.rotatable){var i=this.rotation+(t.x-e.x);this.rotation=i%360,this.onPropertyChanged()}},t.prototype.anchoring=function(){},t.prototype.calculateAnchoringLine=function(){var e=this.getGraphScreenCoord(this),t=new Cesium.Cartesian2(e.x+this.imageOffsetX,e.y+this.imageOffsetY);return[this.viewer.scene.camera.pickEllipsoid(t,this.viewer.scene.globe.ellipsoid),Cesium.Cartesian3.fromDegrees(this.ctrlPosition[0].lon,this.ctrlPosition[0].lat,this.ctrlPosition[0].alt)]},t.prototype.getGraphScreenCoord=function(e){var t=Cesium.Cartesian3.fromDegrees(e.ctrlPosition[0].lon,e.ctrlPosition[0].lat,e.ctrlPosition[0].alt);return Cesium.SceneTransforms.wgs84ToWindowCoordinates(this.viewer.scene,t)},t.prototype.calcuteShape=function(e,t){if(!(e.length<this.minPointNum)&&null!=e[0]){var i=e[0];return this.setInternalControlPosition(e,t),i}},t.prototype.toEdit=function(){var t=this;e.prototype.toEdit.call(this),this.ent.position=new Cesium.CallbackProperty((function(e,i){return t.calcuteShape(t._singleControlPosition,e)}),!1)},t.prototype.finish=function(){this.ent&&(e.prototype.finish.call(this),this.ent.position=this.calcuteShape(this._singleControlPosition,zy.julianDate()))},gB([(0,fy.o)(),AB("design:type",Object)],t.prototype,"pinBuilder",void 0),gB([dy({name:"旋转",group:"外观",type:"whirl",order:8,min:-360,max:360,hiddenGroupName:!1}),AB("design:type",Number),AB("design:paramtypes",[Number])],t.prototype,"rotation",null),gB([dy({name:"缩放",group:"外观",type:"zoom",order:8,min:.5,hiddenGroupName:!1}),AB("design:type",Number),AB("design:paramtypes",[Number])],t.prototype,"scalev",null),gB([dy({name:"W",group:"外观",subGroup:"大小",type:"block",order:8,subOrder:3,min:0,hiddenGroupName:!1}),AB("design:type",Number),AB("design:paramtypes",[Number])],t.prototype,"width",null),gB([dy({name:"H",group:"外观",subGroup:"大小",type:"block",order:8,subOrder:4,min:0,hiddenGroupName:!1}),AB("design:type",Number),AB("design:paramtypes",[Number])],t.prototype,"height",null),gB([dy({name:"X",group:"外观",subGroup:"图片偏移",order:8,subOrder:1,type:"block"}),AB("design:type",Number)],t.prototype,"imageOffsetX",void 0),gB([dy({name:"Y",group:"外观",subGroup:"图片偏移",order:8,subOrder:2,type:"block"}),AB("design:type",Number)],t.prototype,"imageOffsetY",void 0),gB([dy({name:"自动缩放",group:"外观",type:"boolean",order:8,hiddenGroupName:!1}),AB("design:type",Boolean),AB("design:paramtypes",[Boolean])],t.prototype,"scaleByDistance",null),gB([dy({name:"放大倍数",group:"缩放",order:3,type:"number",min:2,max:10}),AB("design:type",Number),AB("design:paramtypes",[Number])],t.prototype,"scaleMaxSize",null),gB([dy({name:"缩小倍数",group:"缩放",order:3,type:"number",min:0,max:1}),AB("design:type",Number),AB("design:paramtypes",[Number])],t.prototype,"scaleMinSize",null),t}(jS);var vB=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),CB=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},_B=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},bB=function(e){function t(t,i,r){var n=e.call(this,t,i,{})||this;if(n.pinBuilder=new Cesium.PinBuilder,n.type="文字板",n.text="A",n.color="#fff",n.alpha=1,e.prototype.initPropBySavedValue.call(n),r&&r.properties)for(var o in r.properties)n[o]=r.properties[o];return n}return vB(t,e),Object.defineProperty(t.prototype,"text",{get:function(){return this._text},set:function(e){this._text=e,this._text.length>10?this.name=this._text.substr(0,10):this.name=this._text},enumerable:!1,configurable:!0}),t.prototype.initShape=function(){var t=this;e.prototype.initShapePin.call(this),Object.assign(this.ent.billboard,{image:new Cesium.CallbackProperty((function(e,i){var r=Cesium.Color.fromCssColorString(t.color).withAlpha(t.alpha);if(t.text&&t.height)return t.pinBuilder.fromText(t.text,r,t.height).toDataURL()}),!0),rotation:new Cesium.CallbackProperty((function(e,i){return 3.14*(360-t.rotation)/180}),!0),scale:new Cesium.CallbackProperty((function(e,i){return t.scalev}),!0),width:new Cesium.CallbackProperty((function(e,i){return t.width}),!0),height:new Cesium.CallbackProperty((function(e,i){return t.height}),!0),heightReference:new Cesium.CallbackProperty((function(e,i){return t.heightReference}),!0),verticalOrigin:Cesium.VerticalOrigin.BOTTOM}),this.ent.position=new Cesium.CallbackProperty((function(e,i){return t.calcuteShape(t._singleControlPosition.concat($A.cursorPos),e)}),!1)},CB([dy({name:"文本",group:"外观",type:"text",order:8}),_B("design:type",String),_B("design:paramtypes",[String])],t.prototype,"text",null),CB([dy({name:"颜色",group:"外观",type:"color",order:8}),_B("design:type",String)],t.prototype,"color",void 0),CB([dy({name:"不透明度",group:"外观",type:"slider",order:8,min:0,max:1}),_B("design:type",Number)],t.prototype,"alpha",void 0),t}(yB);const wB=bB;c.Z.registerType(bB,"EditorPinText","Graph");var PB=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),SB=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},xB=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},BB=function(e){function t(t,i,r){var n=e.call(this,t,i,r)||this;if(n.pinBuilder=new Cesium.PinBuilder,n.type="文字板",n.icon="hospital",n.color="#fff",n.alpha=1,n.size=30,e.prototype.initPropBySavedValue.call(n),n.hideValues=["width","height"],r&&r.properties)for(var o in r.properties)n[o]=r.properties[o];return n}return PB(t,e),t.prototype.initShape=function(){var t=this;e.prototype.initShapePin.call(this),Object.assign(this.ent.billboard,{image:new Cesium.CallbackProperty((function(e,i){var r=Cesium.Color.fromCssColorString(t.color).withAlpha(t.alpha);if(t.size)return t.pinBuilder.fromMakiIconId(t.icon,r,t.size)}),!0),pixelOffset:new Cesium.CallbackProperty((function(e,i){return new Cesium.Cartesian2(t.imageOffsetX,t.imageOffsetY)}),!0),rotation:new Cesium.CallbackProperty((function(e,i){return 3.14*(360-t.rotation)/180}),!0),scale:new Cesium.CallbackProperty((function(e,i){return t.scalev}),!0),width:new Cesium.CallbackProperty((function(e,i){return t.size}),!0),height:new Cesium.CallbackProperty((function(e,i){return t.size}),!0),heightReference:new Cesium.CallbackProperty((function(e,i){return t.heightReference}),!0),verticalOrigin:Cesium.VerticalOrigin.BOTTOM}),this.ent.position=new Cesium.CallbackProperty((function(e,i){return t.calcuteShape(t._singleControlPosition.concat($A.cursorPos),e)}),!1)},SB([dy({name:"图标名",group:"外观",type:"display",order:8,min:0,max:1}),xB("design:type",String)],t.prototype,"icon",void 0),SB([dy({name:"颜色",group:"外观",type:"color",order:8}),xB("design:type",String)],t.prototype,"color",void 0),SB([dy({name:"不透明度",group:"外观",type:"slider",order:8,min:0,max:1}),xB("design:type",Number)],t.prototype,"alpha",void 0),SB([dy({name:"尺寸",group:"外观",type:"number",order:8,subOrder:5,min:0,hiddenGroupName:!1}),xB("design:type",Number)],t.prototype,"size",void 0),t}(yB);const MB=BB;c.Z.registerType(BB,"EditorPinMakiIcon","Graph");var EB=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),TB=function(){return TB=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},TB.apply(this,arguments)},OB=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},LB=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},DB=function(e){function t(t,i,r){var n=e.call(this,t,i,TB({},r))||this;if(n.maxPointNum=1,n.minPointNum=1,n.scaleProperty=["scalev"],n.rotateByHeadingProperty=["rotation"],n.type="图标",n.image=r.uri,n.alpha=1,n.textColor="#ffffff",n.textSize=16,n.textFont="黑体",n.textColor="#ffffff",n.textOffsetX=0,n.textOffsetY=0,n.fontWeight=0,n.showMode=0,n.scalev=1,n.rotation=0,n.imageOffsetX=0,n.imageOffsetY=0,n.scaleMaxSize=4,n.scaleMinSize=1,r&&r.properties)for(var o in r.properties)n[o]=r.properties[o];return n}return EB(t,e),t.prototype.setPrimitivePosition=function(e){if(e instanceof Array||(e=[e]),e[0]||(e=e.slice(1)),!(e.length<1))if(this.setInternalControlPosition(e),0==this.showMode)this.label.position=e[0],this.billboard.position=e[0];else{var t=e[0],i=Cesium.Math.toRadians(this.rotation),r=new Cesium.HeadingPitchRoll(i,0,0),n=Cesium.Transforms.headingPitchRollToFixedFrame(t,r,Cesium.Ellipsoid.WGS84,Cesium.Transforms.eastNorthUpToFixedFrame,new Cesium.Matrix4),o=new Cesium.Cartesian3(8e4*this.scalev,8e4*this.scalev,1),s=Cesium.Matrix4.fromScale(o);Cesium.Matrix4.multiply(n,s,n),this.ent.modelMatrix=n}},t.prototype.initProps=function(e){},Object.defineProperty(t.prototype,"showMode",{get:function(){return this._showMode},set:function(e){this._showMode=e,this.ent&&this.createEnt(this._singleControlPosition[0])},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rotation",{get:function(){return this._rotation},set:function(e){this._rotation=e,this.ent&&(0==this.showMode?this.billboard.rotation=3.14*(360-this.rotation)/180:this.setPrimitivePosition(this._singleControlPosition))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"scalev",{get:function(){return this._scalev},set:function(e){$P.saveProp(this.type,"scalev",e),this._scalev=e,this.ent&&(0==this.showMode?this.billboard.scale=e:this.setPrimitivePosition(this._singleControlPosition))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"imageOffsetX",{get:function(){return this._imageOffsetX},set:function(e){this._imageOffsetX=e,this.ent&&0==this.showMode&&(this.label.pixelOffset=new Cesium.Cartesian2(this.imageOffsetX,this.imageOffsetY))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"imageOffsetY",{get:function(){return this._imageOffsetY},set:function(e){this._imageOffsetY=e,this.ent&&0==this.showMode&&(this.label.pixelOffset=new Cesium.Cartesian2(this.imageOffsetX,this.imageOffsetY))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"scaleByDistance",{get:function(){return this._scaleByDistance},set:function(e){$P.saveProp(this.type,"scaleByDistance",e),this._scaleByDistance=e,this.ent&&0==this.showMode&&this.setScaleByDistance()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"scaleMaxSize",{get:function(){return this._scaleMaxSize},set:function(e){$P.saveProp(this.type,"scaleMaxSize",e),this._scaleMaxSize=e,this.ent&&0==this.showMode&&this.setScaleByDistance()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"scaleMinSize",{get:function(){return this._scaleMinSize},set:function(e){$P.saveProp(this.type,"scaleMinSize",e),this._scaleMinSize=e,this.ent&&0==this.showMode&&this.setScaleByDistance()},enumerable:!1,configurable:!0}),t.prototype.setScaleByDistance=function(){this.label.pixelOffsetScaleByDistance=this.scaleByDistance?new Cesium.NearFarScalar(150,this.scaleMaxSize,15e6,this.scaleMinSize):void 0,this.label.scaleByDistance=this.scaleByDistance?new Cesium.NearFarScalar(150,this.scaleMaxSize,15e6,this.scaleMinSize):void 0,this.billboard.pixelOffsetScaleByDistance=this.scaleByDistance?new Cesium.NearFarScalar(150,this.scaleMaxSize,15e6,this.scaleMinSize):void 0,this.billboard.scaleByDistance=this.scaleByDistance?new Cesium.NearFarScalar(150,this.scaleMaxSize,15e6,this.scaleMinSize):void 0},Object.defineProperty(t.prototype,"alpha",{get:function(){return this._alpha},set:function(e){this._alpha=e,this.ent&&(0==this.showMode?(this.label.fillColor=Cesium.Color.fromCssColorString(this.textColor).withAlpha(this.alpha),this.billboard.color=Cesium.Color.WHITE.withAlpha(this.alpha)):this.setColor(this.ent.appearance.material))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"text",{get:function(){return this._text},set:function(e){this._text=e,this._text.length>10?this.name=this._text.substr(0,10):this.name=this._text,this.ent&&(0==this.showMode?this.label.text=e:this.editCanvas())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"textSize",{get:function(){return this._textSize},set:function(e){this._textSize=e,this.ent&&(0==this.showMode?this.label.font=this.textSize+"px "+this.textFont:this.editCanvas())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"textFont",{get:function(){return this._textFont},set:function(e){this._textFont=e,this.ent&&(0==this.showMode?this.label.font=this.textSize+"px "+this.textFont:this.editCanvas())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontWeight",{get:function(){return this._fontWeight},set:function(e){this._fontWeight=e,this.ent&&(0==this.showMode?this.label.font=this.textSize+"px "+this.textFont:this.editCanvas())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"textOffsetX",{get:function(){return this._textOffsetX},set:function(e){this._textOffsetX=e,this.ent&&0==this.showMode&&(this.billboard.pixelOffset=new Cesium.Cartesian2(this.textOffsetX,this.textOffsetY))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"textOffsetY",{get:function(){return this._textOffsetY},set:function(e){this._textOffsetY=e,this.ent&&0==this.showMode&&(this.billboard.pixelOffset=new Cesium.Cartesian2(this.textOffsetX,this.textOffsetY))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"textColor",{get:function(){return this._textColor},set:function(e){this._textColor=e,this.ent&&(0==this.showMode?this.label.fillColor=Cesium.Color.fromCssColorString(e).withAlpha(this.alpha):this.setColor(this.ent.appearance.material))},enumerable:!1,configurable:!0}),t.prototype.scale=function(e,t){this.scalable&&(this.scalev=this.changeScaleByMouse(this.scalev,e,t),this.onPropertyChanged())},t.prototype.rotateByHeading=function(e,t){if(this.rotatable){var i=this.rotation+(t.x-e.x);this.rotation=i%360,this.onPropertyChanged()}},t.prototype.createHiDPICanvas=function(e,t,i){var r,n,o=(n=document.createElement("canvas").getContext("2d")||{},(window.devicePixelRatio||1)/(n.webkitBackingStorePixelRatio||n.mozBackingStorePixelRatio||n.msBackingStorePixelRatio||n.oBackingStorePixelRatio||n.backingStorePixelRatio||1));i||(i=o);var s=document.createElement("canvas");return s.width=e*i,s.height=t*i,null===(r=s.getContext("2d"))||void 0===r||r.setTransform(i,0,0,i,0,0),s},t.prototype.drawText=function(){var e=this.createHiDPICanvas(200,200,3),t=e.getContext("2d");if(t.fillStyle="white",1==this.fontWeight?t.font="bold "+this.textSize+"px "+this.textFont:t.font=this.textSize+"px "+this.textFont,t.textBaseline="hanging",this.text&&this.text.length>0)for(var i=this.text,r=0,n=e.width/3,o=15,s=0,a=0;a<i.length;a++)(r+=t.measureText(i[a]).width)>n&&(t.fillText(i.substring(s,a),0,o),o+=this.textSize,r=0,s=a),a==i.length-1&&t.fillText(i.substring(s,a+1),0,o);return e},t.prototype.createMaterial=function(){var e={type:"OurMappedPlastic",uniforms:{image1:Cesium.Material.DefaultImageId,image2:Cesium.Material.DefaultImageId,repeat:new Cesium.Cartesian2(1,1),color:new Cesium.Color(1,1,1,1)},source:"\n      czm_material czm_getMaterial(czm_materialInput materialInput) \n         {\n             czm_material material = czm_getDefaultMaterial(materialInput); \n             vec2 st = materialInput.st; \n             vec4 colorImage1=texture2D(image1,st);\n             vec4 colorImage2=texture2D(image2,st);\n             if(colorImage2.a>0.0){\n              material.diffuse = colorImage2.rgb;\n              material.diffuse= material.diffuse*color.rgb;\n             }\n             else{\n              material.diffuse = colorImage1.rgb;\n             }\n             if(colorImage1.a>colorImage2.a){\n              material.alpha=colorImage1.a;\n             }\n             else{\n              material.alpha=colorImage2.a;\n             }\n             material.alpha=material.alpha*color.a;\n              return material;\n         }"};return this.material||(this.material=new Cesium.Material({fabric:e}),this.material.uniforms.image1=this.image,this.material.uniforms.image2=this.drawText()),this.setColor(this.material),this.material},t.prototype.setColor=function(e){e.uniforms.color=Cesium.Color.fromCssColorString(this.textColor).withAlpha(1==this.alpha?.99999:this.alpha)},t.prototype.createEnt=function(e){if(t.billboardCollection||(t.billboardCollection=new Cesium.BillboardCollection,this.viewer.scene.primitives.add(t.billboardCollection)),t.labelCollection||(t.labelCollection=new Cesium.LabelCollection,this.viewer.scene.primitives.add(t.labelCollection)),this.billboard&&(t.labelCollection.remove(this.label),t.billboardCollection.remove(this.billboard)),this.ent instanceof Cesium.Primitive&&this.viewer.scene.primitives.remove(this.ent),0==this.showMode)this.label=t.labelCollection.add({text:this.text,show:this.show,font:this.textSize+"px "+this.textFont,fillColor:Cesium.Color.fromCssColorString(this.textColor).withAlpha(this.alpha),pixelOffset:new Cesium.Cartesian2(this.textOffsetX,this.textOffsetY),scaleByDistance:this.scaleByDistance?new Cesium.NearFarScalar(150,this.scaleMaxSize,15e6,this.scaleMinSize):void 0,pixelOffsetScaleByDistance:this.scaleByDistance?new Cesium.NearFarScalar(150,this.scaleMaxSize,15e6,this.scaleMinSize):void 0}),this.billboard=t.billboardCollection.add({show:this.show,verticalOrigin:Cesium.VerticalOrigin.BOTTOM,image:this.image,pixelOffset:new Cesium.Cartesian2(this.textOffsetX,this.textOffsetY),scaleByDistance:this.scaleByDistance?new Cesium.NearFarScalar(150,this.scaleMaxSize,15e6,this.scaleMinSize):void 0,pixelOffsetScaleByDistance:this.scaleByDistance?new Cesium.NearFarScalar(150,this.scaleMaxSize,15e6,this.scaleMinSize):void 0}),this.ent=this.billboard;else{var i=this.createMaterial();this.setColor(i);var r=new Cesium.Primitive({geometryInstances:t.getGeometryInstance(),appearance:new Cesium.EllipsoidSurfaceAppearance({material:i,flat:!0,aboveGround:!0}),asynchronous:!0,releaseGeometryInstances:!0});this.ent=r,this.viewer.scene.primitives.add(r)}this.fillShape(this.ent)},t.prototype.editCanvas=function(){this.ent.appearance.material.uniforms.image2=this.drawText()},t.getGeometryInstance=function(){return t._geometryInstance||(t._geometryInstance=new Cesium.GeometryInstance({geometry:Cesium.PlaneGeometry.createGeometry(new Cesium.PlaneGeometry({vertexFormat:Cesium.EllipsoidSurfaceAppearance.VERTEX_FORMAT}))})),t._geometryInstance},t.prototype.initShape=function(){var e=this;this.createEnt(Cesium.Cartesian3.ZERO),this.positionProperty=function(){var t=e._singleControlPosition.concat($A.cursorPos);t&&e.setPrimitivePosition(t)}},t.prototype.delete=function(){e.prototype.delete.call(this),this.billboard&&(t.billboardCollection.remove(this.billboard),t.labelCollection.remove(this.label))},t.prototype.toEdit=function(){var t=this;e.prototype.toEdit.call(this),this.positionProperty=function(){var e=t._singleControlPosition;t.setPrimitivePosition(e)}},t.prototype.finish=function(){if(this.ent){e.prototype.finish.call(this);var t=this._singleControlPosition;this.positionProperty=t}},Object.defineProperty(t.prototype,"show",{get:function(){return this._show},set:function(e){this._show=e,this.label&&(this.label.show=e)},enumerable:!1,configurable:!0}),OB([dy({name:"显示模式",group:"外观",order:8,subOrder:4,type:"option",options:[{label:"图标",value:0},{label:"贴地",value:1}]}),LB("design:type",Number),LB("design:paramtypes",[Object])],t.prototype,"showMode",null),OB([dy({name:"旋转",group:"外观",type:"whirl",order:8,min:-360,max:360,hiddenGroupName:!1}),LB("design:type",Number),LB("design:paramtypes",[Number])],t.prototype,"rotation",null),OB([dy({name:"缩放",group:"外观",type:"zoom",order:8,min:.5,hiddenGroupName:!1}),LB("design:type",Number),LB("design:paramtypes",[Number])],t.prototype,"scalev",null),OB([dy({name:"X",group:"外观",subGroup:"图片偏移",order:8,subOrder:1,type:"block"}),LB("design:type",Number),LB("design:paramtypes",[Number])],t.prototype,"imageOffsetX",null),OB([dy({name:"Y",group:"外观",subGroup:"图片偏移",order:8,subOrder:2,type:"block"}),LB("design:type",Number),LB("design:paramtypes",[Number])],t.prototype,"imageOffsetY",null),OB([dy({name:"自动缩放",group:"外观",type:"boolean",order:8,hiddenGroupName:!1}),LB("design:type",Boolean),LB("design:paramtypes",[Boolean])],t.prototype,"scaleByDistance",null),OB([dy({name:"放大倍数",group:"外观",order:8,type:"number",min:2,max:10}),LB("design:type",Number),LB("design:paramtypes",[Number])],t.prototype,"scaleMaxSize",null),OB([dy({name:"缩小倍数",group:"外观",order:8,type:"number",min:0,max:1}),LB("design:type",Number),LB("design:paramtypes",[Number])],t.prototype,"scaleMinSize",null),OB([dy({name:"透明度",group:"通用",type:"slider",order:2,min:0,max:1}),LB("design:type",Number),LB("design:paramtypes",[Number])],t.prototype,"alpha",null),OB([dy({name:"文字",group:"文本",order:6,type:"textArea",hiddenGroupName:!0}),LB("design:type",String),LB("design:paramtypes",[String])],t.prototype,"text",null),OB([dy({name:"文字大小",group:"文本",subGroup:"大小粗细",order:6,subOrder:3,type:"size",hiddenGroupName:!0}),LB("design:type",Number),LB("design:paramtypes",[Number])],t.prototype,"textSize",null),OB([dy({name:"字体",group:"文本",order:6,type:"font"}),LB("design:type",String),LB("design:paramtypes",[String])],t.prototype,"textFont",null),OB([dy({name:"字体粗细",group:"文本",subGroup:"大小粗细",order:6,subOrder:4,type:"option",hiddenGroupName:!0,options:[{label:"正常",value:0},{label:"加粗",value:1}]}),LB("design:type",Number),LB("design:paramtypes",[Number])],t.prototype,"fontWeight",null),OB([dy({name:"X",group:"文本",subGroup:"偏移",order:6,subOrder:7,type:"block",hiddenGroupName:!0}),LB("design:type",Number),LB("design:paramtypes",[Number])],t.prototype,"textOffsetX",null),OB([dy({name:"Y",group:"文本",subGroup:"偏移",order:6,subOrder:8,type:"block",hiddenGroupName:!0}),LB("design:type",Number),LB("design:paramtypes",[Number])],t.prototype,"textOffsetY",null),OB([dy({name:"文字颜色",group:"文本",order:6,type:"color"}),LB("design:type",String),LB("design:paramtypes",[String])],t.prototype,"textColor",null),OB([(0,fy.o)(),LB("design:type",Function),LB("design:paramtypes",[Object,Object,Object]),LB("design:returntype",void 0)],t.prototype,"createHiDPICanvas",null),OB([(0,fy.o)(),LB("design:type",Function),LB("design:paramtypes",[]),LB("design:returntype",void 0)],t.prototype,"drawText",null),OB([(0,fy.o)(),LB("design:type",Object)],t.prototype,"material",void 0),OB([(0,fy.o)(),LB("design:type",Cesium.Label)],t.prototype,"label",void 0),OB([(0,fy.o)(),LB("design:type",Cesium.Billboard)],t.prototype,"billboard",void 0),OB([(0,fy.o)(),LB("design:type",Function),LB("design:paramtypes",[]),LB("design:returntype",void 0)],t.prototype,"editCanvas",null),t}(UP);const IB=DB;c.Z.registerType(DB,"EditorPinCanvas","Graph");var RB=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),HB=function(){return HB=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},HB.apply(this,arguments)},FB=function(e){function t(t,i,r){var n=e.call(this,t,i,HB({},r))||this;if(n.maxPointNum=2,n.minPointNum=2,n.type="单箭头",r&&r.properties)for(var o in r.properties)n[o]=r.properties[o];return n}return RB(t,e),t.prototype.calcuteShape=function(e,t){if(e.length<this.minPointNum)return[];var i=e.map((function(e){var t=zy.cartesian2lonlat(e);return xt.xmu(t)}));if(i.length>1){var r=[],n=i[0],o=i[1],s=xt.Y30(n,o),a={units:"kilometers"};r.push(xt.mY0(n,100,s,a)),r.push(xt.mY0(n,50,s+90,a)),r.push(xt.mY0(o,100,s+170,a)),r.push(xt.mY0(o,150,s+150,a)),r.push(xt.mY0(o,0,s,a)),r.push(xt.mY0(o,150,s-150,a)),r.push(xt.mY0(o,100,s-170,a)),r.push(xt.mY0(n,50,s-90,a));var l=r.map((function(e){return zy.lonlat2Cartesian(xt.c9W(e))}));return this.setInternalControlPosition(e,t),l}return[]},t}(mS);const NB=FB;c.Z.registerType(FB,"EditorArrow1","Graph");var QB=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),kB=function(){return kB=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},kB.apply(this,arguments)},UB=function(e){function t(t,i,r){var n=e.call(this,t,i,kB({},r))||this;if(n.maxPointNum=3,n.minPointNum=2,n.type="椭圆",r&&r.properties)for(var o in r.properties)n[o]=r.properties[o];return n}return QB(t,e),t.prototype.calcuteShape=function(e,t){if(e.length<this.minPointNum)return[];var i,r=e.map((function(e){return zy.cartesian2turfPoint(e)}));if(e.length===this.minPointNum){var n=this.getDistance(r[0],r[1]);i=xt.Xwo(r[0],n,{units:"meters"})}else{var o=this.getDistance(r[0],r[1]),s=this.getDistance(r[0],r[2]);i=xt.Hpm(r[0],o,s,{units:"meters"})}this.turfGeo=i;var a=zy.turfGeometry2Cartesians(i);return this.setInternalControlPosition(e,t),a},t.prototype.getDistance=function(e,t){return 1|xt.TE$(e,t,{units:"meters"})},t}(mS);const jB=UB;c.Z.registerType(UB,"EditorEllipse","Graph");var GB=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),zB=function(){return zB=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},zB.apply(this,arguments)},YB=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},ZB=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},WB=function(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var r,n,o=i.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){n={error:e}}finally{try{r&&!r.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}return s},XB=function(e,t,i){if(i||2===arguments.length)for(var r,n=0,o=t.length;n<o;n++)!r&&n in t||(r||(r=Array.prototype.slice.call(t,0,n)),r[n]=t[n]);return e.concat(r||Array.prototype.slice.call(t))},JB=function(e){function t(t,i,r){var n=e.call(this,t,i,zB({},r))||this;if(n.maxPointNum=2,n.minPointNum=2,n.firstDraw=!0,n.entitys=[],n.type="波束",n.color="#00FF00",n.rotation=0,n.distanceDisplay=!1,n.distanceHeight=55e5,n.alpha=.4,n.hideValues=["heightReference","clampToGround","allowCrossGround","gridSwitch","gridLevel","gridIsAgg","gridColor","gridOutlineColor","gridUpdate"],r&&r.properties)for(var o in r.properties)n[o]=r.properties[o];return n}return GB(t,e),t.prototype.setPrimitivePosition=function(e){e[0]||(e=e.slice(1)),this.setInternalControlPosition(e),this.createEnt(e)},Object.defineProperty(t.prototype,"color",{get:function(){return this._color},set:function(e){this._color=e,this.ent&&this.setColor(this.ent.appearance.material)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"alpha",{get:function(){return this._alpha},set:function(e){this._alpha=e,this.ent&&this.setColor(this.ent.appearance.material)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"distanceDisplay",{get:function(){return this._distanceDisplay},set:function(e){this._distanceDisplay=e,this.ent&&(this.last_pos=null,this.createEnt(this._singleControlPosition))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"distanceHeight",{get:function(){return this._distanceHeight},set:function(e){this._distanceHeight=e,this.ent&&(this.last_pos=null,this.createEnt(this._singleControlPosition))},enumerable:!1,configurable:!0}),t.prototype.distanceCondition=function(){return this.distanceDisplay?new Cesium.DistanceDisplayConditionGeometryInstanceAttribute(0,this.distanceHeight):void 0},t.prototype.initProps=function(e,t){void 0===t&&(t=!0)},t.prototype.setColor=function(e){e.uniforms.color=Cesium.Color.fromCssColorString(this.color).withAlpha(this.alpha)},t.prototype.createMaterial=function(){var e=Cesium.Material.fromType("Color");return this.setColor(e),e},t.prototype.createEnt=function(e){if(!ty.Cartesian3ArrayEqual(this.last_pos,e)&&e&&!(e.length<=1)){this.last_pos=XB([],WB(e),!1);var t=[],i=this.calcuteShape(e);if(i&&!(i.length<=1)){this.collection||(this.collection=new Cesium.PrimitiveCollection,this.viewer.scene.primitives.add(this.collection)),this.ent&&this.collection.remove(this.ent);for(var r=0;r<36;r+=3){var n=new Cesium.PolygonGeometry({polygonHierarchy:new Cesium.PolygonHierarchy(this.getHierarchy(r,i)),perPositionHeight:!0}),o=new Cesium.GeometryInstance({geometry:n,attributes:{distanceDisplayCondition:this.distanceCondition()}});t.push(o)}var s=Cesium.Material.fromType("Color");this.setColor(s),this.ent=new Cesium.Primitive({geometryInstances:t,appearance:new Cesium.EllipsoidSurfaceAppearance({material:s,flat:!1,faceForward:!1,translucent:!0,aboveGround:!0}),vertexCacheOptimize:!0,interleave:!1,compressVertices:!0,releaseGeometryInstances:!0,asynchronous:!1,allowPicking:!0}),this.collection.add(this.ent),this.fillShape(this.ent)}}},t.prototype.getHierarchy=function(e,t){var i=t[1];if(!Cesium.defined(i))return Cesium.Cartesian3.fromDegreesArrayHeights([]);for(var r=i[1],n=i[0],o=i[2],s=t[0],a=s[0],l=s[1],h=s[2],c=6e5,u=[],p=0;p<360;p+=30){var d=this.offsetToLongLat([n,r],[Math.cos(Math.PI*p/180)*c,Math.sin(Math.PI*p/180)*c]);u.push(d[0]),u.push(d[1]),u.push(o)}var m=[a,l,h,u[e],u[e+1],u[e+2]];return e+3==u.length?(m.push(u[0]),m.push(u[1]),m.push(u[2])):(m.push(u[e+3]),m.push(u[e+4]),m.push(u[e+5])),Cesium.Cartesian3.fromDegreesArrayHeights(m)},t.prototype.offsetToLongLat=function(e,t){var i=6378137,r=parseFloat(e[1]),n=parseFloat(e[0]),o=parseFloat(t[1]),s=parseFloat(t[0]),a=o/i,l=Math.PI;return[n+180*(s/(i*Math.cos(l*r/180)))/l,r+180*a/l]},t.prototype.initShape=function(){var e=this;this.positionProperty=function(){var t=e._singleControlPosition.concat($A.cursorPos);t&&e.setPrimitivePosition(t)},this.ent={},this.createEnt([]),this.fillShape(this.ent),this.last_pos=void 0},t.prototype.calcuteShape=function(e){if(2==e.length){var t=e;return[zy.cartesian2lonlat(t[0]),zy.cartesian2lonlat(t[1])]}},t.prototype.toEdit=function(){var t=this;e.prototype.toEdit.call(this),this.positionProperty=function(){if(t.firstDraw){t.firstDraw=!1;var e=zy.cartesian2lonlat(t._singleControlPosition[0]);t._singleControlPosition[0]=zy.lonlat2Cartesian(e,3e6),t.setInternalControlPosition(t._singleControlPosition),t.resetControlPosition(t._singleControlPosition)}var i=t._singleControlPosition;t.setPrimitivePosition(i)}},t.prototype.finish=function(){if(this.ent){e.prototype.finish.call(this);var t=this._singleControlPosition;this.positionProperty=t}},YB([dy({name:"旋转",group:"外观",order:8,type:"numberNew",hidden:!0}),ZB("design:type",Number)],t.prototype,"rotation",void 0),YB([(0,gy.C)(),dy({name:"颜色",group:"外观",subGroup:"填充",type:"color",order:8,subOrder:2,noEmpty:!1}),ZB("design:type",String),ZB("design:paramtypes",[String])],t.prototype,"color",null),YB([(0,gy.C)(),dy({name:"不透明度",group:"通用",subGroup:"不透明度",type:"slider",order:2,subOrder:3,min:0,max:1}),ZB("design:type",Number),ZB("design:paramtypes",[Number])],t.prototype,"alpha",null),YB([dy({name:"可视高度",group:"通用",subGroup:"可视高度",subOrder:1,type:"checkboxSub",order:2,hiddenGroupName:!1}),ZB("design:type",Boolean),ZB("design:paramtypes",[Boolean])],t.prototype,"distanceDisplay",null),YB([dy({name:"可视高度距离",group:"通用",subGroup:"可视高度",subOrder:2,type:"number3",order:2,hiddenGroupName:!1,min:0,max:2e7}),ZB("design:type",Number),ZB("design:paramtypes",[Number])],t.prototype,"distanceHeight",null),YB([(0,fy.o)(),ZB("design:type",Object)],t.prototype,"last_pos",void 0),t}(nS);const KB=JB;c.Z.registerType(JB,"EditorFrustum","Graph");var VB=i(5108),qB=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),$B=function(){return $B=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},$B.apply(this,arguments)},eM=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},tM=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},iM=function(e,t,i,r){return new(i||(i=Promise))((function(n,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?n(e.value):function(e){return e instanceof i?e:new i((function(t){t(e)}))}(e.value).then(s,a)}l((r=r.apply(e,t||[])).next())}))},rM=function(e,t){var i,r,n,o,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,r&&(n=2&o[0]?r.return:o[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,o[1])).done)return n;switch(r=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(n=s.trys,(n=n.length>0&&n[n.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){s.label=o[1];break}if(6===o[0]&&s.label<n[1]){s.label=n[1],n=o;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(o);break}n[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{i=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},nM=function(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],r=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},oM=function(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var r,n,o=i.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){n={error:e}}finally{try{r&&!r.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}return s},sM=function(e,t,i){if(i||2===arguments.length)for(var r,n=0,o=t.length;n<o;n++)!r&&n in t||(r||(r=Array.prototype.slice.call(t,0,n)),r[n]=t[n]);return e.concat(r||Array.prototype.slice.call(t))},aM=function(e){function t(t,i,r){var n=e.call(this,t,i,$B({},r))||this;if(n.minPointNum=2,n._polylineSmooth=100,n.arrowImage="",n._polylineMaterial="",n.isConstant=!0,n.uniformListenr=function(){if(n.polylineent){var e=n.polylineent.appearance.material;e&&(1==n.duration?e.uniforms.time=e.uniforms.time>=1?0:e.uniforms.time+1.1:e.uniforms.time=e.uniforms.time>=1?0:e.uniforms.time+1/n.duration)}else n.stopClock()},n.scratchTimeVec=new Cesium.Cartesian4,n.scratchTemp=new Cesium.Cartesian3,n._lastTimeIndex=0,n.type="折线",n.width=3,n.colorShow=!0,n.color="#ED6F00",n.alpha=.8,n.polylineMaterial="",n.arcType=1,n.duration=2e3,n.interplate=!1,n.clampToGround=!0,n.outlineWidth=2,n.percent=1,n.percentStart=0,n.outlineColor="#FFFFFF",n.distanceDisplay=!1,n.distanceHeight=55e5,n.hideValues=["heightReference"],n.moveHeight=null,Object.defineProperty(n,"moveHeight",{configurable:!0,enumerable:!0,get:function(){return n.clampToGround?void 0:n.internalmoveHeight}}),r&&r.properties)for(var o in r.properties)n[o]=r.properties[o];return n}return qB(t,e),t.prototype.setPrimitivePosition=function(e){var t,i;e[0]||(e=e.slice(1)),e=e.filter((function(e){return e}));var r=[],n=function(e){0==r.filter((function(t){return Cesium.Cartesian3.equals(t,e)})).length&&r.push(e)};try{for(var o=nM(e),s=o.next();!s.done;s=o.next()){n(s.value)}}catch(e){t={error:e}}finally{try{s&&!s.done&&(i=o.return)&&i.call(o)}finally{if(t)throw t.error}}0!=(e=r).length&&(this.setInternalControlPosition(e),this.createEnt(e))},t.prototype.resetControlPosition=function(t){this.lasPoints=t?this.calcuteShape(this._singleControlPosition.concat($A.cursorPos),Cesium.JulianDate.now()):this.calcuteShape(this._singleControlPosition,Cesium.JulianDate.now()),e.prototype.resetControlPosition.call(this,t)},Object.defineProperty(t.prototype,"interplate",{get:function(){return this._interplate},set:function(e){this._interplate=e,this.polylineent&&(this.positionChanged.next(!0),this.redraw())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"percent",{get:function(){return this._percent},set:function(e){this._percent=e,this.polylineent&&this.setColor(this.polylineent.appearance.material)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"percentStart",{get:function(){return this._percentStart},set:function(e){this._percentStart=e,this.polylineent&&this.setColor(this.polylineent.appearance.material)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"percentRange",{get:function(){return this._percentRange||(this._percentRange=[0,1]),this._percentRange.length=0,this._percentRange.push(this.percentStart),this._percentRange.push(this.percent),this._percentRange},set:function(e){this._percentRange=e,this.percentStart=e[0],this.percent=e[1]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"clampToGround",{get:function(){return this._clampToGround},set:function(e){this._clampToGround=e,this.heightReference=e?Cesium.HeightReference.CLAMP_TO_GROUND:Cesium.HeightReference.NONE,this.resetHeightReference(),this.polylineent&&(this.redraw(),this.reloadOperator=!0),e&&this.allowCrossGround&&(this.allowCrossGround=!1)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"allowCrossGround",{get:function(){return this._allowCrossGround},set:function(e){this._allowCrossGround=e,e&&this.clampToGround&&(this.clampToGround=!1)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"arcType",{get:function(){return this._arcType},set:function(e){"string"==typeof e&&(e=Number.parseInt(e)),this.clampToGround&&0==e?this.arcType=this.arcType:(this._arcType=e,this.redraw())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"defaultHeight",{get:function(){return this._defaultHeight},set:function(e){this._defaultHeight=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this._width},set:function(e){this._width=e,this.redraw()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"colorShow",{get:function(){return this._colorShow},set:function(e){this._colorShow=e,this.resetCesiumColor()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){return this._color},set:function(e){this._color=e,this.resetCesiumColor()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"outlineShow",{get:function(){return this._outlineShow},set:function(e){if(this._outlineShow=e,this.polylineent){var t=this.createMaterial();this.polylineent.appearance.material=t,this.setColor(t)}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"outlineColor",{get:function(){return this._outlineColor},set:function(e){this._outlineColor=e,this.polylineent&&this.setColor(this.polylineent.appearance.material)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"outlineWidth",{get:function(){return this._outlineWidth},set:function(e){this._outlineWidth=e,this.polylineent&&this.setColor(this.polylineent.appearance.material)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"polylineSmooth",{get:function(){return this._polylineSmooth},set:function(e){this._polylineSmooth=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"distanceDisplay",{get:function(){return this._distanceDisplay},set:function(e){this._distanceDisplay=e,this.redraw()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"distanceHeight",{get:function(){return this._distanceHeight},set:function(e){this._distanceHeight=e,this.redraw()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"alpha",{get:function(){return this._alpha},set:function(e){this._alpha=e,this.resetCesiumColor()},enumerable:!1,configurable:!0}),t.prototype.internalmoveHeight=function(e,t){var i,r,n=this.getCenter(),o=zy.getHeightByCartesian3(n,this.viewer),s=this.ChangeLengthByMouse(o,t.y-e.y,1),a=[];try{for(var l=nM(this._singleControlPosition),h=l.next();!h.done;h=l.next()){var c=h.value,u=zy.getHeightByCartesian3(c,this.viewer)-o+s;this.allowCrossGround||u<0&&(u=0),a.push(zy.getHeightdefineByXYZ(c,u,this.viewer))}}catch(e){i={error:e}}finally{try{h&&!h.done&&(r=l.return)&&r.call(l)}finally{if(i)throw i.error}}this._singleControlPosition=a,this.onPropertyChanged()},t.prototype.createArrowMaterial=function(){var e={uniforms:{percent:1,percentStart:0,color:new Cesium.Color(1,0,0,1)},source:"\n      #ifdef GL_OES_standard_derivatives\n      #extension GL_OES_standard_derivatives : enable\n      #endif\n      uniform vec4 color;\n\n      float getPointOnLine(vec2 p0, vec2 p1, float x)\n      {\n          float slope = (p0.y - p1.y) / (p0.x - p1.x);\n          return slope * (x - p0.x) + p0.y;\n      }\n      \n      czm_material czm_getMaterial(czm_materialInput materialInput)\n      {\n          czm_material material = czm_getDefaultMaterial(materialInput);\n      \n          vec2 st = materialInput.st;\n      \n      #ifdef GL_OES_standard_derivatives\n          float base = 1.0 - abs(fwidth(st.s)) * 10.0 * czm_pixelRatio;\n      #else\n          float base = 0.975; // 2.5% of the line will be the arrow head\n      #endif\n      \n          vec2 center = vec2(1.0, 0.5);\n          float ptOnUpperLine = getPointOnLine(vec2(base, 1.0), center, st.s);\n          float ptOnLowerLine = getPointOnLine(vec2(base, 0.0), center, st.s);\n      \n          float halfWidth = 0.15;\n          float s = step(0.5 - halfWidth, st.t);\n          s *= 1.0 - step(0.5 + halfWidth, st.t);\n          s *= 1.0 - step(base, st.s);\n      \n          float t = step(base, materialInput.st.s);\n          t *= 1.0 - step(ptOnUpperLine, st.t);\n          t *= step(ptOnLowerLine, st.t);\n      \n          // Find the distance from the closest separator (region between two colors)\n          float dist;\n          if (st.s < base)\n          {\n              float d1 = abs(st.t - (0.5 - halfWidth));\n              float d2 = abs(st.t - (0.5 + halfWidth));\n              dist = min(d1, d2);\n          }\n          else\n          {\n              float d1 = czm_infinity;\n              if (st.t < 0.5 - halfWidth && st.t > 0.5 + halfWidth)\n              {\n                  d1 = abs(st.s - base);\n              }\n              float d2 = abs(st.t - ptOnUpperLine);\n              float d3 = abs(st.t - ptOnLowerLine);\n              dist = min(min(d1, d2), d3);\n          }\n      \n          vec4 outsideColor = vec4(0.0);\n          vec4 currentColor = mix(outsideColor, color, clamp(s + t, 0.0, 1.0));\n          vec4 outColor = czm_antialias(outsideColor, color, currentColor, dist);\n      \n          outColor = czm_gammaCorrect(outColor);\n          material.diffuse = outColor.rgb;\n          material.alpha = outColor.a;\n          float dis = distance(materialInput.st, vec2(1.0, materialInput.st.y));\n          if(percent<0.0){\n            if(dis >1.0 -  abs(percent)){\n              material.alpha=0.0;\n            }\n            \n          }\n          else{\n            if(dis < 1.0-percent || dis > 1.0 - percentStart){\n              material.alpha=0.0;\n            }\n            \n          }\n          return material;\n      }\n      "};return new Cesium.Material({fabric:e})},t.prototype.createOutLineMaterial=function(){var e={uniforms:{percent:1,percentStart:0,color:new Cesium.Color(1,0,0,1),outlineColor:new Cesium.Color(1,0,0,1),outlineWidth:1},source:"uniform vec4 color;\n      uniform vec4 outlineColor;\n      uniform float outlineWidth;\n      varying float v_width;\n      czm_material czm_getMaterial(czm_materialInput materialInput)\n      {\n      czm_material material = czm_getDefaultMaterial(materialInput);\n      vec2 st = materialInput.st;\n      float halfInteriorWidth =  0.5 * (v_width - outlineWidth) / v_width;\n      float b = step(0.5 - halfInteriorWidth, st.t);\n      b *= 1.0 - step(0.5 + halfInteriorWidth, st.t);\n      float d1 = abs(st.t - (0.5 - halfInteriorWidth));\n      float d2 = abs(st.t - (0.5 + halfInteriorWidth));\n      float dist = min(d1, d2);\n      vec4 currentColor = mix(outlineColor, color, b);\n      vec4 outColor = czm_antialias(outlineColor, color, currentColor, dist);\n      outColor = czm_gammaCorrect(outColor);\n      material.diffuse = outColor.rgb;\n      material.alpha = outColor.a;\n      float dis = distance(materialInput.st, vec2(1.0, materialInput.st.y));\n      if(percent<0.0){\n        if(dis >1.0 -  abs(percent)){\n          material.alpha=0.0;\n        }\n        \n      }\n      else{\n        if(dis < 1.0-percent || dis > 1.0 - percentStart){\n          material.alpha=0.0;\n        }\n        \n      }\n      return material;\n      }\n      "};return new Cesium.Material({fabric:e})},t.prototype.createSimpleMaterial=function(){var e={uniforms:{percent:1,percentStart:0,color:new Cesium.Color(1,0,0,1)},source:"\n      czm_material czm_getMaterial(czm_materialInput materialInput)\n      {\n          czm_material material = czm_getDefaultMaterial(materialInput);\n          float dis = distance(materialInput.st, vec2(1.0, materialInput.st.y));\n          //vec2 st = materialInput.st;\n          if(percent<0.0){\n            if(dis >1.0 -  abs(percent)){\n              material.alpha=0.0;\n            }\n            else{\n              material.alpha=1.0;\n            }\n          }\n          else{\n            if(dis < 1.0-percent || dis > 1.0 - percentStart){\n              material.alpha=0.0;\n            }\n            else{\n              material.alpha=1.0;\n            }\n          }\n          material.diffuse = color.rgb;\n          material.alpha=color.a* material.alpha;\n          // float glow = glowPower / abs(st.t - 0.5) - (glowPower / 0.5);\n\n          // material.emission = max(vec3(glow - 1.0 + color.rgb), color.rgb);\n          // material.alpha = clamp(0.0, 1.0, glow) * color.a * st.s;\n\n          //material.emission =  color.rgb;\n          //material.alpha =  color.a;\n\n          return material;\n      }"};return new Cesium.Material({fabric:e})},t.prototype.redraw=function(){this.last_pos=null,this.createEnt(this._singleControlPosition)},Object.defineProperty(t.prototype,"polylineMaterial",{get:function(){return this._polylineMaterial},set:function(e){if(this._polylineMaterial=e,this.polylineent){var t=this.createMaterial();this.polylineent.appearance.material=t}this.percentRange.length>0&&(this.percentRange=this.percentRange)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"duration",{get:function(){return this._duration},set:function(e){this._duration=e},enumerable:!1,configurable:!0}),t.prototype.resetCesiumColor=function(){this.color&&(this.colorShow?this.cesiumColor=Cesium.Color.fromCssColorString(this.color).withAlpha(this.alpha):this.cesiumColor=Cesium.Color.fromCssColorString(this.color).withAlpha(0)),this.polylineent&&this.setColor(this.polylineent.appearance.material)},t.prototype.initShape=function(){var e=this;this.positionProperty=function(){var t=e._singleControlPosition.concat($A.cursorPos);t&&e.setPrimitivePosition(t)},this.primtiveCollection=new Cesium.PrimitiveCollection,this.ent=this.primtiveCollection,this.createEnt([]),this.fillShape(this.ent),this.viewer.scene.orderGroundPrimitives.add(this.primtiveCollection,this.level)},t.prototype.setColor=function(e){"railway"!=this.polylineMaterial?(this.colorShow?e.uniforms.color=Cesium.Color.fromCssColorString(this.color).withAlpha(this.alpha):e.uniforms.color=Cesium.Color.fromCssColorString(this.color).withAlpha(0),e.uniforms.percent=this.percent,e.uniforms.percentStart=this.percentStart,e.uniforms.outlineColor=Cesium.Color.fromCssColorString(this.outlineColor).withAlpha(this.alpha),e.uniforms.outlineWidth=this.outlineWidth):(e.uniforms.color=e.uniforms.color.withAlpha(this.alpha),e.uniforms.gapColor=e.uniforms.gapColor.withAlpha(this.alpha))},t.prototype.createEnt=function(e){if(!ty.Cartesian3ArrayEqual(this.last_pos,e)&&(this.last_pos=sM([],oM(e),!1),e&&!(e.length<=1))){if(e=this.calcuteShape(e,null),this.polylineent&&this.primtiveCollection.remove(this.polylineent),this.clampToGround){var t=new Cesium.GroundPolylineGeometry({positions:e,width:this.width}),i=new Cesium.GeometryInstance({geometry:t,id:this.id,attributes:{distanceDisplayCondition:this.distanceCondition()}}),r=this.createMaterial();this.setColor(r),this.polylineent=new Cesium.GroundPolylinePrimitive({geometryInstances:i,appearance:new Cesium.PolylineMaterialAppearance({material:r,translucent:!0}),vertexCacheOptimize:!0,interleave:!1,compressVertices:!0,releaseGeometryInstances:!1,asynchronous:!1,allowPicking:!0,show:!0}),this.primtiveCollection.add(this.polylineent)}else{t=new Cesium.PolylineGeometry({positions:e,width:this.width,arcType:this.arcType}),i=new Cesium.GeometryInstance({geometry:t,id:this.id,attributes:{distanceDisplayCondition:this.distanceCondition()}}),r=this.createMaterial();this.setColor(r),this.polylineent=new Cesium.Primitive({geometryInstances:i,appearance:new Cesium.PolylineMaterialAppearance({material:r,translucent:!0}),vertexCacheOptimize:!0,interleave:!1,compressVertices:!0,releaseGeometryInstances:!1,asynchronous:!1,allowPicking:!0,show:!0}),this.primtiveCollection.add(this.polylineent)}this.bsphere=Cesium.BoundingSphere.fromPoints(e),this.fillShape(this.polylineent)}},t.prototype.distanceCondition=function(){return this.distanceDisplay?new Cesium.DistanceDisplayConditionGeometryInstanceAttribute(0,this.distanceHeight):void 0},t.prototype.addCtlPoint=function(e,t){void 0===t&&(t=void 0),this.defaultHeight&&(e.alt=this.defaultHeight);var i=zy.lonlathei2Cartesian(e);if(t||(t=this._singleControlPosition.length),this._singleControlPosition.splice(t,0,i),this.isAddControlPointEntity)this.addCtl(i,t)},t.prototype.startClock=function(){this.viewer.clock.onTick.addEventListener(this.uniformListenr)},t.prototype.stopClock=function(){this.viewer.clock.onTick.removeEventListener(this.uniformListenr)},t.prototype.createMaterial=function(){var e=this.polylineMaterial;switch(this.stopClock(),this.startClock(),e){case"arrow":var t=Cesium.Material.fromType("PolylineArrowLink");return this.arrowImage&&(t.uniforms.image=this.arrowImage),t;case"polylinearrow":return this.createArrowMaterial();case"pulse":return Cesium.Material.fromType("PolylinePulseLink");case"trail":return Cesium.Material.fromType("PolylineTrailLinkType");case"attack":return Cesium.Material.fromType("PolylineAttackLink");case"glowing":return Cesium.Material.fromType("PolylineGlowLinkType");case"railway":return Cesium.Material.fromType("PolylineDash",{color:Cesium.Color.BLACK,gapColor:Cesium.Color.WHITE,dashLength:30});case"dash":return Cesium.Material.fromType("PolylineDash",{color:this.color,gapColor:Cesium.Color.TRANSPARENT,dashLength:30});default:return this.outlineShow?this.createOutLineMaterial():this.createSimpleMaterial()}},t.prototype.createterraininteropLine=function(){return iM(this,void 0,void 0,(function(){var e,t,i,r,n,o,s,a,l,h,c,u,p,d;return rM(this,(function(m){e=this.polylineent.geometryInstances.geometry._positions,t=[],i=0,r=[];try{for(n=nM(e),o=n.next();!o.done;o=n.next())s=o.value,zy.lonlat2Cartesian,a=Cesium.Cartographic.fromCartesian(s),l=this.viewer.scene.globe.getHeight(a),a.height=l,r.push(this.viewer.scene.globe.ellipsoid.cartographicToCartesian(a))}catch(e){p={error:e}}finally{try{o&&!o.done&&(d=n.return)&&d.call(n)}finally{if(p)throw p.error}}for(e=r,u=0;u<e.length-1;u++)h=Cesium.Cartesian3.distance(e[u],e[u+1]),t.push(h),i+=h;for(c=[0],u=0;u<t.length;u++)c.push(t[u]/i+c[u]);return this.terraininteropLine=new Cesium.LinearSpline({times:c,points:e}),[2]}))}))},t.prototype.calcuteShape=function(e,t){if((e=e.filter((function(e){return null!=e}))).length<this.minPointNum)return[];var i=e;this.setInternalControlPosition(i,t);for(var r=[0],n=[],o=0,s=0;s<e.length-1;s++){var a=Cesium.Cartesian3.distance(e[s],e[s+1]);n.push(a),o+=a}for(var l=0;l<n.length;l++)r.push(n[l]/o+r[l]);if(this.interplate){i=[],this.interopLine=Cesium.HermiteSpline.createNaturalCubic({times:r,points:e});for(var h=20*e.length,c=0;c<=h;c++){var u;u=this.interopLine instanceof Cesium.LinearSpline?this.interopLine.evaluate(c/h):this.evaluate(c/h),i.push(u)}}else this.interopLine=new Cesium.LinearSpline({times:r,points:e});return i},t.prototype.lerp=function(t,i){if(this.interplate){if(this.interopLine){try{var r=(this.interopLine.times[t]+this.interopLine.times[i])/2;return this.interopLine.evaluate(r)}catch(e){VB.log(e)}return e.prototype.lerp.call(this,t,i)}return e.prototype.lerp.call(this,t,i)}return e.prototype.lerp.call(this,t,i)},t.prototype.handleNewCtl=function(e){},t.prototype.toEdit=function(){var t=this;e.prototype.toEdit.call(this),this.positionProperty=function(){var e=t._singleControlPosition;e&&t.setPrimitivePosition(e)},this.positionChanged.next(!1)},t.prototype.getUpdateLevelPrimtive=function(){return this.primtiveCollection},t.prototype.finish=function(){this.ent&&(e.prototype.finish.call(this),this.positionProperty=this._singleControlPosition,this.positionChanged.next(!1))},t.prototype.toGeoJsonGeometry=function(){var e,t,i={type:"LineString",coordinates:[]};try{for(var r=nM(this.ctrlPosition),n=r.next();!n.done;n=r.next()){var o=n.value;i.coordinates.push([o.lon,o.lat,o.alt])}}catch(t){e={error:t}}finally{try{n&&!n.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}return i},t.prototype.gridUpdate=function(){var e,t,i=this;if(this._singleControlPosition&&this._singleControlPosition.length>0){var r="LINESTRING (",n=this.calcuteShape(this._singleControlPosition,Cesium.JulianDate.now());try{for(var o=nM(n),s=o.next();!s.done;s=o.next()){var a=s.value;r=r+zy.getLongitudeByCartesian3(a,this.viewer)+" "+zy.getLatitudeByCartesian3(a,this.viewer)+", "}}catch(t){e={error:t}}finally{try{s&&!s.done&&(t=o.return)&&t.call(o)}finally{if(e)throw e.error}}r=r.substring(0,r.length-2)+")";var l="".concat(window.config.geopptService,"/grid/getPlotGrid"),h=this.gridLevel;h||(h=0);var c=new Request(l,{method:"post",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify({position:r,level:h,isAgg:this.gridIsAgg})});return new Promise((function(e,t){fetch(c).then((function(e){return e.json()})).then((function(e){var t=JSON.parse(e[0].st_withbox);i._gridLevel=t.detailLevel;var r=i.formatBBox(t.cells);i.drawGrid(r)})).catch((function(e){t(!1)}))}))}},t.prototype.evaluate=function(e){var t=new Cesium.Cartesian3,i=this.interopLine.points;if(i.length<=2)return i;var r=this.interopLine.times,n=this.interopLine.inTangents,o=this.interopLine.outTangents;this._lastTimeIndex=this.interopLine.findTimeInterval(e,this._lastTimeIndex);var s=this._lastTimeIndex,a=r[s+1]-r[s],l=(e-r[s])/a,h=this.scratchTimeVec;h.z=l,h.y=l*l,h.x=h.y*l,h.w=1;var c=Cesium.Matrix4.multiplyByVector(Cesium.HermiteSpline.hermiteCoefficientMatrix,h,h);return t=Cesium.Cartesian3.multiplyByScalar(i[s],c.x,t),Cesium.Cartesian3.multiplyByScalar(i[s+1],c.y,this.scratchTemp),Cesium.Cartesian3.add(t,this.scratchTemp,t),Cesium.Cartesian3.multiplyByScalar(o[s],c.z,this.scratchTemp),Cesium.Cartesian3.add(t,this.scratchTemp,t),Cesium.Cartesian3.multiplyByScalar(n[s],c.w,this.scratchTemp),Cesium.Cartesian3.add(t,this.scratchTemp,t)},eM([(0,fy.o)(),tM("design:type",Cesium.PrimitiveCollection)],t.prototype,"primtiveCollection",void 0),eM([(0,fy.o)(),tM("design:type",Object)],t.prototype,"minPointNum",void 0),eM([(0,fy.o)(),tM("design:type",Cesium.Color)],t.prototype,"cesiumColor",void 0),eM([dy({name:"平滑",group:"外观",type:"checkbox",order:8,min:1,max:256}),tM("design:type",Boolean),tM("design:paramtypes",[Boolean])],t.prototype,"interplate",null),eM([(0,fy.o)(),tM("design:type",Array)],t.prototype,"_percentRange",void 0),eM([dy({name:"百分比",group:"外观",type:"percentSlider",order:8}),tM("design:type",Object),tM("design:paramtypes",[Object])],t.prototype,"percentRange",null),eM([dy({name:"贴地",group:"外观",type:"tiediCheckbox",order:8}),tM("design:type",Boolean),tM("design:paramtypes",[Boolean])],t.prototype,"clampToGround",null),eM([dy({name:"曲线类型",group:"外观",order:8,type:"option",options:[{label:"大地线",value:1},{label:"直线(贴地无效)",value:0}]}),tM("design:type",Number),tM("design:paramtypes",[Number])],t.prototype,"arcType",null),eM([dy({name:"默认高度",group:"外观",type:"deHeight",order:8,subGroup:"默认高度",subOrder:4,hidden:!0}),tM("design:type",Number),tM("design:paramtypes",[Number])],t.prototype,"defaultHeight",null),eM([dy({name:"线宽",group:"外观",type:"numberNew",order:8,min:1,max:200}),tM("design:type",Number),tM("design:paramtypes",[Number])],t.prototype,"width",null),eM([dy({name:"是否填充",group:"外观",subGroup:"填充",type:"checkboxSub",order:8,subOrder:5}),tM("design:type",Boolean),tM("design:paramtypes",[Boolean])],t.prototype,"colorShow",null),eM([dy({name:"颜色",group:"外观",subGroup:"填充",subOrder:6,type:"color",order:8,noEmpty:!1}),tM("design:type",String),tM("design:paramtypes",[String])],t.prototype,"color",null),eM([dy({name:"是否描边",group:"外观",type:"checkboxSub",order:8,subGroup:"描边",subOrder:7}),tM("design:type",Boolean),tM("design:paramtypes",[Boolean])],t.prototype,"outlineShow",null),eM([dy({name:"描边颜色",group:"外观",subGroup:"描边",order:8,subOrder:8,type:"color"}),tM("design:type",String),tM("design:paramtypes",[String])],t.prototype,"outlineColor",null),eM([dy({name:"描边线宽",group:"外观",subGroup:"描边线宽",order:8,subOrder:9,type:"numberNew",min:0,max:100}),tM("design:type",Number),tM("design:paramtypes",[Number])],t.prototype,"outlineWidth",null),eM([dy({name:"流畅度",group:"外观",type:"option",order:8,hidden:!0,options:[{label:"基础",value:100},{label:"一般",value:400},{label:"高级",value:700},{label:"超级",value:1e3}]}),tM("design:type",Number),tM("design:paramtypes",[Number])],t.prototype,"polylineSmooth",null),eM([dy({name:"可视高度",group:"通用",subGroup:"可视高度",subOrder:1,type:"checkboxSub",order:2,hiddenGroupName:!1}),tM("design:type",Boolean),tM("design:paramtypes",[Boolean])],t.prototype,"distanceDisplay",null),eM([dy({name:"可视高度距离",group:"通用",subGroup:"可视高度",subOrder:2,type:"number3",order:2,hiddenGroupName:!1,min:0,max:2e7}),tM("design:type",Number),tM("design:paramtypes",[Number])],t.prototype,"distanceHeight",null),eM([dy({name:"不透明度",group:"通用",subGroup:"不透明度",subOrder:3,type:"slider",order:2,min:0,max:1}),tM("design:type",Number),tM("design:paramtypes",[Number])],t.prototype,"alpha",null),eM([(0,fy.o)(),tM("design:type",Function),tM("design:paramtypes",[Cesium.Cartesian2,Cesium.Cartesian2]),tM("design:returntype",void 0)],t.prototype,"internalmoveHeight",null),eM([dy({name:"特效",group:"外观",type:"option",order:8,subGroup:"特效",subOrder:10,options:[{label:"箭头",value:"polylinearrow"},{label:"流动箭头",value:"arrow"},{label:"滋滋",value:"pulse"},{label:"攻击",value:"attack"},{label:"行动",value:"trail"},{label:"发光",value:"glowing"},{label:"铁路",value:"railway"},{label:"无",value:""}]}),tM("design:type",String),tM("design:paramtypes",[String])],t.prototype,"polylineMaterial",null),eM([dy({name:"周期",group:"外观",type:"number",order:8,subGroup:"周期",subOrder:11,min:1}),tM("design:type",Number),tM("design:paramtypes",[Number])],t.prototype,"duration",null),eM([(0,fy.o)(),tM("design:type",Object)],t.prototype,"polylineent",void 0),eM([(0,fy.o)(),tM("design:type",Object)],t.prototype,"last_pos",void 0),eM([(0,fy.o)(),tM("design:type",Function),tM("design:paramtypes",[Object,Number]),tM("design:returntype",void 0)],t.prototype,"addCtlPoint",null),eM([(0,fy.o)(),tM("design:type",Object)],t.prototype,"uniformListenr",void 0),eM([(0,fy.o)(),tM("design:type",Function),tM("design:paramtypes",[]),tM("design:returntype",void 0)],t.prototype,"createMaterial",null),eM([(0,fy.o)(),(0,fy.o)(),tM("design:type",Object)],t.prototype,"interopLine",void 0),eM([(0,fy.o)(),tM("design:type",Cesium.LinearSpline)],t.prototype,"terraininteropLine",void 0),eM([(0,fy.o)(),tM("design:type",Function),tM("design:paramtypes",[Array,Object]),tM("design:returntype",void 0)],t.prototype,"calcuteShape",null),eM([(0,fy.o)(),tM("design:type",Function),tM("design:paramtypes",[Object]),tM("design:returntype",void 0)],t.prototype,"handleNewCtl",null),eM([(0,fy.o)(),tM("design:type",Object)],t.prototype,"lasPoints",void 0),t}(nS);const lM=aM;c.Z.registerType(aM,"EditorPolyline","Graph");var hM=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),cM=function(){return cM=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},cM.apply(this,arguments)},uM=i(8405),pM=function(e){function t(t,i,r){var n=e.call(this,t,i,cM({type:"n阶bezier曲线"},r))||this;if(n.minPointNum=3,n.type="n阶bezier曲线",r&&r.properties)for(var o in r.properties)n[o]=r.properties[o];return n}return hM(t,e),t.prototype.calcuteShape=function(e,t){if(e.length<this.minPointNum)return[];if(e.length<2)return e;var i=e.map((function(e){return zy.cartesian2lonlat(e)})),r=i.map((function(e){return{x:e[0],y:e[1]}})),n=new uM(r).getLUT(),o=i[0][2],s=n.map((function(e){return zy.lonlat2Cartesian([e.x,e.y],o)}));return this.setInternalControlPosition(e,t),s},t}(lM);const dM=pM;c.Z.registerType(pM,"EditorBezierN","Graph");var mM=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),fM=function(){return fM=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},fM.apply(this,arguments)},gM=function(e){function t(t,i,r){var n=e.call(this,t,i,fM({type:"2阶bezier曲线"},r))||this;if(n.maxPointNum=3,n.minPointNum=3,n.type="2阶bezier曲线",r&&r.properties)for(var o in r.properties)n[o]=r.properties[o];return n}return mM(t,e),t}(dM);const AM=gM;c.Z.registerType(gM,"EditorBezier1","Graph");var yM=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),vM=function(){return vM=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},vM.apply(this,arguments)},CM=function(e){function t(t,i,r){var n=e.call(this,t,i,vM({type:"3阶bezier曲线"},r))||this;if(n.maxPointNum=4,n.minPointNum=4,n.type="3阶bezier曲线",r&&r.properties)for(var o in r.properties)n[o]=r.properties[o];return n}return yM(t,e),t}(dM);const _M=CM;c.Z.registerType(CM,"EditorBezier2","Graph");var bM=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),wM=function(){return wM=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},wM.apply(this,arguments)},PM=function(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],r=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},SM=function(e){function t(t,i,r){var n=e.call(this,t,i,wM({type:"平滑bezier曲线"},r))||this;if(n.type="平滑bezier曲线",n.hideValues=["interplate","polylineSmooth"],r&&r.properties)for(var o in r.properties)n[o]=r.properties[o];return n}return bM(t,e),t.prototype.calcuteShape=function(e,t){var i,r;if(e.length<this.minPointNum)return[];var n=e.map((function(e){return zy.cartesian2lonlat(e)})),o=xt.TuJ(n),s=xt.Y2u(o).geometry.coordinates,a=o.geometry.coordinates[0][2];try{for(var l=PM(s),h=l.next();!h.done;h=l.next()){h.value.push(a)}}catch(e){i={error:e}}finally{try{h&&!h.done&&(r=l.return)&&r.call(l)}finally{if(i)throw i.error}}var c=s.map((function(e){return zy.lonlat2Cartesian(e,e[2])}));return this.setInternalControlPosition(e,t),c},t.prototype.calculateBisectionPoint=function(e,t){if(e.length<this.minPointNum)return[];var i=e.map((function(e){return zy.cartesian2lonlat(e)})),r=xt.TuJ(i);return xt.Y2u(r,{resolution:10*(t+2)}).geometry.coordinates.map((function(e){return zy.lonlat2Cartesian(e)}))},t}(lM);const xM=SM;c.Z.registerType(SM,"EditorBezierSpline","Graph");var BM=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),MM=function(){return MM=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},MM.apply(this,arguments)},EM=function(e){function t(t,i,r){var n=e.call(this,t,i,MM({type:"曲线"},r))||this;if(n.type="曲线",n.interplate=!0,r&&r.properties)for(var o in r.properties)n[o]=r.properties[o];return n}return BM(t,e),t}(lM);const TM=EM;c.Z.registerType(EM,"EditorCurve","Graph");var OM=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),LM=function(){return LM=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},LM.apply(this,arguments)},DM=function(e){function t(t,i,r){var n=e.call(this,t,i,LM({type:"圆弧线"},r))||this;if(n.maxPointNum=3,n.minPointNum=3,n.type="圆弧线",r&&r.properties)for(var o in r.properties)n[o]=r.properties[o];return n}return OM(t,e),t.prototype.calcuteShape=function(e,t){if(e.length<this.minPointNum)return[];var i=e.map((function(e){var t=zy.cartesian2lonlat(e);return xt.xmu(t)})),r=xt.Y30(i[0],i[1]),n=xt.Y30(i[0],i[2]),o=xt.TE$(i[0],i[1],{units:"kilometers"}),s=xt.TE$(i[0],i[2],{units:"kilometers"}),a=o>s?o:s,l=xt.cA_(i[0],a,r,n).geometry.coordinates.map((function(e){return zy.lonlat2Cartesian(e)}));return this.setInternalControlPosition(e,t),l},t}(lM);const IM=DM;c.Z.registerType(DM,"EditorCircleArc","Graph");var RM=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),HM=function(){return HM=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},HM.apply(this,arguments)},FM=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},NM=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},QM=function(e){function t(t,i,r){var n=e.call(this,t,i,HM({},r))||this;if(n.type="顶点折线",n.width=1,n.color="#00FF00",n.alpha=.8,n.pointPixelSize=12,n.pointColor="#00FF00",n.pointAlpha=.8,r&&r.properties)for(var o in r.properties)n[o]=r.properties[o];return n}return RM(t,e),t.prototype.initProps=function(e){},t.prototype.handleNewCtl=function(e){var t=this,i=this.entities.add(new Cesium.Entity({point:{}}));i.show=this.show,this.fillShape(i),Object.assign(i.point,{pixelSize:new Cesium.CallbackProperty((function(e,i){return t.pointPixelSize}),!0),color:new Cesium.CallbackProperty((function(e,i){var r=Cesium.Color.fromCssColorString(t.pointColor).withAlpha(t.pointAlpha);return t.ent.highLighted?r.brighten(.6,new Cesium.Color):r}),!0)}),i.position=new Cesium.CallbackProperty((function(t,i){return e.position.getValue(Cesium.JulianDate.fromDate(new Date))}),!1)},FM([dy({name:"顶点颜色",group:"外观",subGroup:"顶点颜色",order:8,subOrder:-2,type:"color"}),NM("design:type",String)],t.prototype,"pointColor",void 0),FM([dy({name:"顶点不透明度",group:"外观",subGroup:"顶点颜色",order:8,subOrder:-1,type:"slider",max:1,min:0}),NM("design:type",Number)],t.prototype,"pointAlpha",void 0),FM([dy({name:"顶点大小",group:"外观",order:8,type:"number",min:1,max:256}),NM("design:type",Number)],t.prototype,"pointPixelSize",void 0),t}(lM);const kM=QM;c.Z.registerType(QM,"EditorPointLine","Graph");var UM=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),jM=function(){return jM=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},jM.apply(this,arguments)},GM=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},zM=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},YM=function(e){function t(t,i,r){var n=e.call(this,t,i,jM({},r))||this;if(n.minPointNum=2,n.firstEditText=!0,n.textCollection=[],n.entcollection=new Cesium.EntityCollection,n.idcollection=[],n.type="路径文字",n.width=1,n.alpha=.8,n.text="路径文字",n.textSize=36,n.textFont="黑体",n.textColor="#000000",n.fontWeight=0,n._scaleByDistance=!0,n._scaleMaxSize=2,n._scaleMinSize=.1,n.interplate=!0,n.distanceDisplay=!1,n.distanceHeight=55e5,n.hideValues=["duration","polylineMaterial","arcType","clampToGround","interplate","width","color","colorShow","heightReference","allowCrossGround","gridSwitch","gridLevel","gridIsAgg","gridColor","gridOutlineColor","gridUpdate"],r&&r.properties)for(var o in r.properties)n[o]=r.properties[o];return n}return UM(t,e),Object.defineProperty(t.prototype,"alpha",{get:function(){return this._alpha},set:function(e){this._alpha=e,this.resetFont()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"outlineShow",{get:function(){return this._outlineShow},set:function(e){this._outlineShow=e,this.resetFont()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"outlineColor",{get:function(){return this._outlineColor},set:function(e){this._outlineColor=e,this.resetFont()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"outlineWidth",{get:function(){return this._outlineWidth},set:function(e){this._outlineWidth=e,this.resetFont()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"text",{get:function(){return this._text},set:function(e){this._text=e,this.textCollection=[];for(var t=0;t<e.length;t++)if("|"==e[t]){var i=e.indexOf("|",t+1);if(i<0){var r=e.substring(t+1,e.length);this.textCollection.push(r),t=e.length}else{r=e.substring(t+1,i);this.textCollection.push(r),t=i}}else this.textCollection.push(e[t]);this.initLabel(),this.initStyle(),this.positionChanged.next(!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"textFont",{get:function(){return this._textFont},set:function(e){this._textFont=e,this.resetFont()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"textSize",{get:function(){return this._textSize},set:function(e){"string"==typeof e&&(e=parseInt(e)),this._textSize=e,this.resetFont()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontWeight",{get:function(){return this._fontWeight},set:function(e){this._fontWeight=e,this.resetFont()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"textColor",{get:function(){return this._textColor},set:function(e){this._textColor=e,this.resetFont()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"scaleByDistance",{get:function(){return this._scaleByDistance},set:function(e){if(this._scaleByDistance=e,e)for(var t=0;t<this.textCollection.length;t++)this.labelColleciton.get(t).scaleByDistance=new Cesium.NearFarScalar(150,this.scaleMaxSize,15e6,this.scaleMinSize);else for(t=0;t<this.textCollection.length;t++)this.labelColleciton.get(t).scaleByDistance=void 0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"scaleMaxSize",{get:function(){return this._scaleMaxSize},set:function(e){if(this._scaleMaxSize=e,this.scaleByDistance)for(var t=0;t<this.textCollection.length;t++)this.labelColleciton.get(t).scaleByDistance=new Cesium.NearFarScalar(150,e,15e6,this.scaleMinSize);else for(t=0;t<this.textCollection.length;t++)this.labelColleciton.get(t).scaleByDistance=void 0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"scaleMinSize",{get:function(){return this._scaleMinSize},set:function(e){if(e<.1&&(e=.1),this._scaleMinSize=e,this.scaleByDistance)for(var t=0;t<this.textCollection.length;t++)this.labelColleciton.get(t).scaleByDistance=new Cesium.NearFarScalar(150,this.scaleMaxSize,15e6,e);else for(t=0;t<this.textCollection.length;t++)this.labelColleciton.get(t).scaleByDistance=void 0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"distanceDisplay",{get:function(){return this._distanceDisplay},set:function(e){if(this._distanceDisplay=e,this.textCollection&&this.labelColleciton)if(e)for(var t=0;t<this.textCollection.length;t++)this.labelColleciton.get(t).distanceDisplayCondition=new Cesium.DistanceDisplayCondition(0,this.distanceHeight);else for(t=0;t<this.textCollection.length;t++)this.labelColleciton.get(t).distanceDisplayCondition=void 0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"distanceHeight",{get:function(){return this._distanceHeight},set:function(e){if(this._distanceHeight=e,this.textCollection&&this.labelColleciton)if(this.distanceDisplay)for(var t=0;t<this.textCollection.length;t++)this.labelColleciton.get(t).distanceDisplayCondition=new Cesium.DistanceDisplayCondition(0,e);else for(t=0;t<this.textCollection.length;t++)this.labelColleciton.get(t).distanceDisplayCondition=void 0},enumerable:!1,configurable:!0}),t.prototype.resetFont=function(){this.initStyle()},t.prototype.initLabel=function(){if(this.ent){if(this.labelColleciton.length!=this.textCollection.length){var e=this.labelColleciton.length-this.textCollection.length;if(e>0)for(var t=0;t<e;t++)this.labelColleciton.remove(this.labelColleciton.get(0));else for(t=0;t<Math.abs(e);t++){var i=this.labelColleciton.add({text:this.textCollection[t]});this.scaleByDistance&&(i.scaleByDistance=new Cesium.NearFarScalar(150,this.scaleMaxSize,15e6,this.scaleMinSize)),this.fillShape(i)}}for(t=0;t<this.textCollection.length;t++){this.labelColleciton.get(t).text=this.textCollection[t]}}},t.prototype.initStyle=function(){if(this.ent){var e=(this._textSize?this._textSize:1)+"px "+this._textFont;1==this.fontWeight&&(e="bold "+e),this.cesiumfont=e;for(var t=0;t<this.textCollection.length;t++)this.labelColleciton.get(t).font=this.cesiumfont,this.labelColleciton.get(t).fillColor=Cesium.Color.fromCssColorString(this.textColor).withAlpha(this.alpha);if(this.outlineShow)for(t=0;t<this.textCollection.length;t++)this.labelColleciton.get(t).outlineColor=Cesium.Color.fromCssColorString(this.outlineColor).withAlpha(this.alpha),this.labelColleciton.get(t).outlineWidth=this.outlineWidth,this.labelColleciton.get(t).style=Cesium.LabelStyle.FILL_AND_OUTLINE;else for(t=0;t<this.textCollection.length;t++)this.labelColleciton.get(t).style=Cesium.LabelStyle.FILL}},t.prototype.calculatePosition=function(e){if(this.ent&&this.lasPoints&&this.interopLine)if(1==this.textCollection.length)this.labelColleciton.get(0).position=this.interopLine.points[0];else{if(this.textCollection.length<1)return;for(var t=0;t<this.textCollection.length;t++)this.labelColleciton.get(t).position=this.interopLine.evaluate(t/(this.textCollection.length-1))}},t.prototype.initShape=function(){var t=this;e.prototype.initShape.call(this),this.labelColleciton=this.viewer.scene.primitives.add(new Cesium.LabelCollection),this.initLabel(),this.positionChanged.subscribe((function(e){t.calculatePosition(e)})),this.initStyle()},Object.defineProperty(t.prototype,"show",{get:function(){return this._show},set:function(e){if(this._show=e,this.textCollection)for(var t=0;t<this.textCollection.length;t++){if(!this.labelColleciton.get(t))return;this.labelColleciton.get(t).show=e}},enumerable:!1,configurable:!0}),t.prototype.delete=function(){e.prototype.delete.call(this),this.viewer.scene.primitives.remove(this.labelColleciton)},t.prototype.toEdit=function(){e.prototype.toEdit.call(this),this.ent.show=!0},t.prototype.finish=function(){this.ent&&(e.prototype.finish.call(this),this.ent.show=!1)},GM([(0,fy.o)(),zM("design:type",Object)],t.prototype,"minPointNum",void 0),GM([dy({name:"是否描边",group:"文本",type:"checkboxSub",order:6,subGroup:"描边",subOrder:7}),zM("design:type",Boolean),zM("design:paramtypes",[Boolean])],t.prototype,"outlineShow",null),GM([dy({name:"描边颜色",group:"文本",subGroup:"描边",order:6,subOrder:8,type:"color"}),zM("design:type",String),zM("design:paramtypes",[String])],t.prototype,"outlineColor",null),GM([dy({name:"描边线宽",group:"文本",subGroup:"描边线宽",order:6,subOrder:9,type:"numberNew",min:0,max:6}),zM("design:type",Number),zM("design:paramtypes",[Number])],t.prototype,"outlineWidth",null),GM([dy({name:"文字",group:"文本",order:6,type:"textArea",hiddenGroupName:!0}),zM("design:type",String),zM("design:paramtypes",[String])],t.prototype,"text",null),GM([dy({name:"字体",group:"文本",order:6,type:"font",hiddenGroupName:!0}),zM("design:type",String),zM("design:paramtypes",[String])],t.prototype,"textFont",null),GM([dy({name:"文字大小",group:"文本",subGroup:"大小粗细",order:6,subOrder:1,hiddenGroupName:!0,type:"size"}),zM("design:type",Number),zM("design:paramtypes",[Number])],t.prototype,"textSize",null),GM([dy({name:"字体粗细",group:"文本",subGroup:"大小粗细",order:6,subOrder:2,hiddenGroupName:!0,type:"option",options:[{label:"正常",value:0},{label:"加粗",value:1}]}),zM("design:type",Number),zM("design:paramtypes",[Number])],t.prototype,"fontWeight",null),GM([dy({name:"颜色",group:"文本",type:"color",order:6,noEmpty:!1,subGroup:"填充",subOrder:4}),zM("design:type",String),zM("design:paramtypes",[String])],t.prototype,"textColor",null),GM([dy({name:"自动缩放",group:"文本",type:"checkbox",order:6,subGroup:"自动缩放",subOrder:13}),zM("design:type",Boolean),zM("design:paramtypes",[Boolean])],t.prototype,"scaleByDistance",null),GM([dy({name:"放大倍数",group:"文本",order:6,type:"numberNew",subGroup:"放大倍数",subOrder:14,min:2,max:10}),zM("design:type",Number),zM("design:paramtypes",[Number])],t.prototype,"scaleMaxSize",null),GM([dy({name:"缩小倍数",group:"文本",order:6,type:"numberNew",subGroup:"缩小倍数",subOrder:15,min:0,max:1}),zM("design:type",Number),zM("design:paramtypes",[Number])],t.prototype,"scaleMinSize",null),GM([dy({name:"可视高度",group:"通用",subGroup:"可视高度",subOrder:1,type:"checkboxSub",order:2,hiddenGroupName:!1}),zM("design:type",Boolean),zM("design:paramtypes",[Boolean])],t.prototype,"distanceDisplay",null),GM([dy({name:"可视高度距离",group:"通用",subGroup:"可视高度",subOrder:2,type:"number3",order:2,hiddenGroupName:!1,min:0,max:2e7}),zM("design:type",Number),zM("design:paramtypes",[Number])],t.prototype,"distanceHeight",null),GM([(0,fy.o)(),zM("design:type",Object)],t.prototype,"entcollection",void 0),GM([(0,fy.o)(),zM("design:type",Object)],t.prototype,"idcollection",void 0),GM([(0,fy.o)(),zM("design:type",Object)],t.prototype,"cesiumfont",void 0),GM([(0,fy.o)(),zM("design:type",Function),zM("design:paramtypes",[]),zM("design:returntype",void 0)],t.prototype,"resetFont",null),GM([(0,fy.o)(),zM("design:type",Cesium.LabelCollection)],t.prototype,"labelColleciton",void 0),GM([(0,fy.o)(),zM("design:type",Function),zM("design:paramtypes",[]),zM("design:returntype",void 0)],t.prototype,"initLabel",null),GM([(0,fy.o)(),zM("design:type",Function),zM("design:paramtypes",[]),zM("design:returntype",void 0)],t.prototype,"initStyle",null),GM([(0,fy.o)(),zM("design:type",Function),zM("design:paramtypes",[Object]),zM("design:returntype",void 0)],t.prototype,"calculatePosition",null),GM([(0,fy.o)(),zM("design:type",Object)],t.prototype,"currentPositions",void 0),t}(lM);const ZM=YM;c.Z.registerType(YM,"EditorRouteText","Graph");var WM=function(){function e(){this.eventsLog=[],this.aspectRatioStep=.5,this.angleStep=5}return e.prototype.largestRect=function(e,t){var i=this;if(e.length<3)return null;t||(t={}),t.maxAspectRatio||(t.maxAspectRatio=15),t.minWidth||(t.minWidth=0),t.minHeight||(t.minHeight=0),this.angles||(this.angles=[0]);var r=[];e.forEach((function(e){r.push(e)})),r.push(e[0]);var n=xt.yue([r]),o=xt.SOn(n);if(o<=0)return null;var s=this.extent(e),a=s[0],l=s[1],h=s[2],c=s[3];this.eventsLog.push({type:"simplify",poly:e});var u=Math.abs(l-a),p=Math.abs(c-h),d=Math.min(u,p)/50;if(!this.origins){this.origins=[];var m=xt.beQ(n),f=[m.geometry.coordinates[0],m.geometry.coordinates[1]];this.pointInPoly(f,e)&&this.origins.push(f)}this.eventsLog.push({type:"origins",points:this.origins});var g=0,A=null;return this.angles.forEach((function(r){var n=-r*Math.PI/180;i.eventsLog.push({type:"angle",angle:r});for(var s=0;s<i.origins.length;s++){var a=i.origins[s],l=i.intersectPoints(e,a,n),h=l[0],c=l[1],u=i.intersectPoints(e,a,n+Math.PI/2),p=u[0],m=u[1],f=[];h&&c&&f.push([(h[0]+c[0])/2,(h[1]+c[1])/2]),p&&m&&f.push([(p[0]+m[0])/2,(p[1]+m[1])/2]),i.eventsLog.push({type:"modifOrigin",idx:s,p1W:h,p2W:c,p1H:p,p2H:m,modifOrigins:f});for(var y=0;y<f.length;y++){var v=f[y];i.eventsLog.push({type:"origin",cx:v[0],cy:v[1]});var C=i.intersectPoints(e,v,n),_=C[0],b=C[1];if(null!=_&&null!=b){var w=Math.min(i.squaredDist(v,h),i.squaredDist(v,c)),P=2*Math.sqrt(w),S=i.intersectPoints(e,v,n+Math.PI/2),x=S[0],B=S[1];if(null!=x&&null!=B){var M=Math.min(i.squaredDist(v,p),i.squaredDist(v,m)),E=2*Math.sqrt(M);if(!(P*E<g)){var T=void 0;if(i.aspectRatios)T=i.aspectRatios;else{var O=Math.max(1,t.minWidth/E,g/(E*E)),L=Math.min(t.maxAspectRatio,P/t.minHeight,P*P/g);T=i.range(O,L+i.aspectRatioStep,i.aspectRatioStep)}for(var D=0;D<T.length;D++){var I=T[D],R=Math.max(t.minWidth,Math.sqrt(g*I)),H=Math.min(P,E*I);if(!(R*H<g))for(H-R>=d&&i.eventsLog.push({type:"aRatio",aRatio:I});H-R>=d;){var F=(R+H)/2,N=F/I,Q=v[0],k=v[1],U=[[Q-F/2,k-N/2],[Q+F/2,k-N/2],[Q+F/2,k+N/2],[Q-F/2,k+N/2]];U=i.rotatePoly(U,n,v);var j=void 0;i.polyInsidePoly(U,e)?(j=!0,g=F*N,A={centerX:Q,centerY:k,width:F,height:N,angle:r},R=F):(j=!1,H=F),i.eventsLog.push({type:"rectangle",centerX:Q,centerY:k,width:F,height:N,areaFraction:F*N/o,angle:r,insidePoly:j})}}}}}}}})),[A,g,this.eventsLog]},e.prototype.range=function(e,t,i){for(var r=[],n=e;n<t;)r.push(n),n+=i;return r},e.prototype.extent=function(e){var t=-180,i=-90,r=180,n=90;return e.forEach((function(e){e[0]<r&&(r=e[0]),e[0]>t&&(t=e[0]),e[1]<n&&(n=e[1]),e[1]>i&&(i=e[1])})),[r,t,n,i]},e.prototype.pointInPoly=function(e,t){var i,r,n,o,s;for(o=-1,r=t[(s=t.length)-1],n=0;++o<s;)i=r,r=t[o],this.rayIntersectsSegment(e,i,r)&&n++;return n%2!=0},e.prototype.rayIntersectsSegment=function(e,t,i){var r,n,o,s;return r=(s=t[1]<i[1]?[t,i]:[i,t])[0],n=s[1],e[1]!==n[1]&&e[1]!==r[1]||(e[1]+=Number.MIN_VALUE),!(e[1]>n[1]||e[1]<r[1])&&(!(e[0]>r[0]&&e[0]>n[0])&&(e[0]<r[0]&&e[0]<n[0]||(o=(n[1]-r[1])/(n[0]-r[0]),(e[1]-r[1])/(e[0]-r[0])>o)))},e.prototype.intersectPoints=function(e,t,i){var r,n,o,s,a,l,h,c,u,p,d,m,f,g,A;for(a=1e-9,g=(t=[t[0]+a*Math.cos(i),t[1]+a*Math.sin(i)])[0],A=t[1],m=[g+Math.cos(i),A+Math.sin(i)],h=0,Math.abs(m[0]-g)<a&&(h=1),l=-1,n=e[(p=e.length)-1],c=Number.MAX_VALUE,u=Number.MAX_VALUE,o=null,s=null;++l<p;)r=n,n=e[l],null!=(d=this.lineIntersection(t,m,r,n))&&this.pointInSegmentBox(d,r,n)&&(f=this.squaredDist(t,d),d[h]<t[h]?f<c&&(c=f,o=d):d[h]>t[h]&&f<u&&(u=f,s=d));return[o,s]},e.prototype.lineIntersection=function(e,t,i,r){var n,o,s,a,l,h,c;return 1e-9,a=e[0]-t[0],h=e[1]-t[1],l=i[0]-r[0],s=a*(c=i[1]-r[1])-h*l,Math.abs(s)<1e-9?null:[((n=e[0]*t[1]-e[1]*t[0])*l-(o=i[0]*r[1]-i[1]*r[0])*a)/s,(n*c-o*h)/s]},e.prototype.pointInSegmentBox=function(e,t,i){var r,n,o;return r=1e-9,n=e[0],o=e[1],!(n<Math.min(t[0],i[0])-r||n>Math.max(t[0],i[0])+r||o<Math.min(t[1],i[1])-r||o>Math.max(t[1],i[1])+r)},e.prototype.squaredDist=function(e,t){var i,r;return(i=t[0]-e[0])*i+(r=t[1]-e[1])*r},e.prototype.rotatePoly=function(e,t,i){for(var r,n=[],o=0;o<e.length;o++)r=e[o],n.push(this.rotatePoint(r,t,i));return n},e.prototype.rotatePoint=function(e,t,i){var r,n,o,s;return null==i&&(i=[0,0]),o=e[0]-i[0],s=e[1]-i[1],[(r=Math.cos(t))*o-(n=Math.sin(t))*s+i[0],n*o+r*s+i[1]]},e.prototype.polyInsidePoly=function(e,t){var i,r,n,o,s,a,l,h;for(s=-1,l=e.length,h=t.length,n=e[l-1];++s<l;)for(i=n,n=e[s],a=-1,o=t[h-1];++a<h;)if(r=o,o=t[a],this.segmentsIntersect(i,n,r,o))return!1;return this.pointInPoly(e[0],t)},e.prototype.segmentsIntersect=function(e,t,i,r){var n;return null!=(n=this.lineIntersection(e,t,i,r))&&(this.pointInSegmentBox(n,e,t)&&this.pointInSegmentBox(n,i,r))},e}(),XM=i(5108),JM=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),KM=function(){return KM=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},KM.apply(this,arguments)},VM=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},qM=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},$M=function(e){function t(t,i,r){var n=e.call(this,t,i,KM({},r))||this;if(n.minPointNum=3,n.type="区域文字",n.color="#000000",n.textColor="#fff",n.alpha=.8,n.text="区域文字",n.textSize=48,n.textFont="黑体",n.stRotation=0,n.fontWeight=0,n.show=!0,n.hideValues=["effect"],r&&r.properties)for(var o in r.properties)n[o]=r.properties[o];return n}return JM(t,e),Object.defineProperty(t.prototype,"textColor",{get:function(){return this._textColor},set:function(e){this._textColor=e,this.rectangle&&this.editCanvas()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"stRotation",{get:function(){return this._stRotation},set:function(e){this._stRotation=e,this.rectangle&&this.editCanvas()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"text",{get:function(){return this._text},set:function(e){this._text=e,this.rectangle&&this.editCanvas()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"textSize",{get:function(){return this._textSize},set:function(e){this._textSize=e,this.rectangle&&this.editCanvas()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"textFont",{get:function(){return this._textFont},set:function(e){this._textFont=e,this.rectangle&&this.editCanvas()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontWeight",{get:function(){return this._fontWeight},set:function(e){this._fontWeight=e,this.rectangle&&this.editCanvas()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"alpha",{get:function(){return this._alpha},set:function(e){this._alpha=e,this.rectangle&&this.editCanvas()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"show",{get:function(){return this._show},set:function(e){this._show=e,this.ent&&(this.ent.show=e),this.onPropertyChanged("show"),this.rectangle&&this.editCanvas()},enumerable:!1,configurable:!0}),t.prototype.initShape=function(){e.prototype.initShape.call(this),this.fillShape(this.ent)},t.prototype.createHiDPICanvas=function(e,t,i){var r,n,o=(n=document.createElement("canvas").getContext("2d")||{},(window.devicePixelRatio||1)/(n.webkitBackingStorePixelRatio||n.mozBackingStorePixelRatio||n.msBackingStorePixelRatio||n.oBackingStorePixelRatio||n.backingStorePixelRatio||1));i||(i=o);var s=document.createElement("canvas");return s.width=e*i,s.height=t*i,null===(r=s.getContext("2d"))||void 0===r||r.setTransform(i,0,0,i,0,0),s},t.prototype.drawText=function(){this.canvas=this.createHiDPICanvas(200,200,3);var e=this.canvas.getContext("2d");return this.textColor&&(e.fillStyle=this.textColor),this.alpha&&(e.globalAlpha=this.alpha),1==this.fontWeight?e.font="bold "+this.textSize+"px "+this.textFont:e.font=this.textSize+"px "+this.textFont,0==this.show&&(e.globalAlpha=0),e.textBaseline="hanging",e.fillText(this.text,0,10),this.canvas},t.prototype.getRectangle=function(e){if(!(e.length<3)){var t=(new WM).largestRect(e);if(t&&t[0]&&t[0].centerX){if(null===t[0].centerX)return;var i=[t[0].centerX-t[0].width/2,t[0].centerY+t[0].height/2],r=[t[0].centerX-t[0].width/2,t[0].centerY-t[0].height/2],n=[i,[t[0].centerX+t[0].width/2,t[0].centerY+t[0].height/2],[t[0].centerX+t[0].width/2,t[0].centerY-t[0].height/2],r];this.largestRectangle=n;var o=[];return n.forEach((function(e){var i=(e[0]-t[0].centerX)*Math.cos(t[0].angle)-(e[1]-t[0].centerY)*Math.sin(t[0].angle)+t[0].centerX,r=(e[0]-t[0].centerX)*Math.sin(t[0].angle)+(e[1]-t[0].centerY)*Math.cos(t[0].angle)+t[0].centerY;o.push([i,r])})),[o[0][0],o[0][1],o[2][0],o[2][1]]}XM.log("largets: ",t)}},t.prototype.initRectangle=function(){var e=this;this.ent&&Object.assign(this.rectangle.rectangle,{material:new Cesium.ImageMaterialProperty({image:this.drawText(),transparent:!0}),stRotation:new Cesium.CallbackProperty((function(t,i){return Cesium.Math.toRadians(e.stRotation)}),!1)})},t.prototype.finish=function(){var t=this;if(XM.log("EditorAreaText finish"),e.prototype.finish.call(this),!this.rectangle){var i=this._singleControlPosition.concat($A.cursorPos),r=this.convertCo(i),n=this.getRectangle(r);if(!n||0===n.length)return void this.delete();this.rectangle=this.entities.add(new Cesium.Entity({rectangle:{}})),Object.assign(this.rectangle.rectangle,{coordinates:new Cesium.CallbackProperty((function(e,t){return Cesium.Rectangle.fromDegrees(n[0],n[3],n[2],n[1])}),!1),material:new Cesium.ImageMaterialProperty({image:this.drawText(),transparent:!0}),stRotation:new Cesium.CallbackProperty((function(e,i){return Cesium.Math.toRadians(t.stRotation)}),!1),zIndex:99}),this.fillShape(this.ent),this.fillShape(this.rectangle)}},t.prototype.toEdit=function(){var t=this;XM.log("EditorAreaText toEdit"),e.prototype.toEdit.call(this),this.ent.polygon.hierarchy=new Cesium.CallbackProperty((function(e,i){return{positions:t.calcuteShape(t._singleControlPosition,e)}}),!1),this.rectangle&&(this.rectangle.rectangle.coordinates=new Cesium.CallbackProperty((function(e,i){var r=t.calcuteShape(t._singleControlPosition,e),n=t.convertCo(r),o=t.getRectangle(n);return o?Cesium.Rectangle.fromDegrees(o[0],o[3],o[2],o[1]):(t.delete(),null)}),!1))},t.prototype.delete=function(){e.prototype.delete.call(this),this.entities.remove(this.rectangle)},t.prototype.convertCo=function(e){var t=[],i=this.viewer.scene.globe.ellipsoid;return e.forEach((function(e){var r=i.cartesianToCartographic(e),n=Cesium.Math.toDegrees(r.latitude),o=Cesium.Math.toDegrees(r.longitude);t.push([o,n])})),t},t.prototype.editCanvas=function(){this.rectangle.rectangle.material.image=this.drawText()},VM([(0,fy.o)(),qM("design:type",Object)],t.prototype,"minPointNum",void 0),VM([dy({name:"颜色",group:"文本",type:"color",order:6,noEmpty:!1}),qM("design:type",String),qM("design:paramtypes",[String])],t.prototype,"textColor",null),VM([dy({name:"倾斜角度",group:"外观",subGroup:"倾斜角度",type:"text",order:8,subOrder:1,noEmpty:!1}),qM("design:type",Number),qM("design:paramtypes",[Number])],t.prototype,"stRotation",null),VM([dy({name:"文字",group:"外观",order:8,type:"textArea"}),qM("design:type",String),qM("design:paramtypes",[String])],t.prototype,"text",null),VM([dy({name:"文字大小",group:"文本",subGroup:"大小粗细",hiddenGroupName:!0,order:6,subOrder:6,type:"size"}),qM("design:type",Number),qM("design:paramtypes",[Number])],t.prototype,"textSize",null),VM([dy({name:"字体",group:"文本",order:6,type:"font"}),qM("design:type",String),qM("design:paramtypes",[String])],t.prototype,"textFont",null),VM([dy({name:"字体粗细",group:"文本",subGroup:"大小粗细",hiddenGroupName:!0,order:6,subOrder:7,type:"option",options:[{label:"正常",value:0},{label:"加粗",value:1}]}),qM("design:type",Number),qM("design:paramtypes",[Number])],t.prototype,"fontWeight",null),VM([(0,fy.o)(),qM("design:type",Object)],t.prototype,"canvas",void 0),VM([(0,fy.o)(),qM("design:type",Function),qM("design:paramtypes",[Object,Object,Object]),qM("design:returntype",void 0)],t.prototype,"createHiDPICanvas",null),VM([(0,fy.o)(),qM("design:type",Function),qM("design:paramtypes",[]),qM("design:returntype",void 0)],t.prototype,"drawText",null),VM([(0,fy.o)(),qM("design:type",Object)],t.prototype,"largestRectangle",void 0),VM([(0,fy.o)(),qM("design:type",Object)],t.prototype,"rectangleCesium",void 0),VM([(0,fy.o)(),qM("design:type",Function),qM("design:paramtypes",[Object]),qM("design:returntype",void 0)],t.prototype,"getRectangle",null),VM([(0,fy.o)(),qM("design:type",Function),qM("design:paramtypes",[]),qM("design:returntype",void 0)],t.prototype,"initRectangle",null),VM([(0,fy.o)(),qM("design:type",Object)],t.prototype,"rectangle",void 0),VM([(0,fy.o)(),qM("design:type",Function),qM("design:paramtypes",[Object]),qM("design:returntype",void 0)],t.prototype,"convertCo",null),VM([(0,fy.o)(),qM("design:type",Function),qM("design:paramtypes",[]),qM("design:returntype",void 0)],t.prototype,"editCanvas",null),t}(mS);const eE=$M;c.Z.registerType($M,"EditorAreaText","Graph");var tE=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),iE=function(){return iE=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},iE.apply(this,arguments)},rE=function(e){function t(t,i,r){var n=e.call(this,t,i,iE({type:"顶点平滑曲线"},r))||this;if(n.type="顶点平滑曲线",r&&r.properties)for(var o in r.properties)n[o]=r.properties[o];return n}return tE(t,e),t.prototype.calcuteShape=function(e,t){if(e.length<this.minPointNum)return[];var i=e.map((function(e){return zy.cartesian2lonlat(e)})),r=xt.TuJ(i),n=xt.Y2u(r).geometry.coordinates.map((function(e){return zy.lonlat2Cartesian(e)}));return this.setInternalControlPosition(e,t),n},t}(kM);const nE=rE;c.Z.registerType(rE,"EditorPointSpline","Graph");var oE=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),sE=function(){return sE=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},sE.apply(this,arguments)},aE=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},lE=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},hE=function(e){function t(t,i,r){var n=e.call(this,t,i,sE({},r))||this;if(n.maxPointNum=1,n.minPointNum=1,n.firstEditText=!0,n._width=8e3,n._height=8e3,n.scaleProperty=["textSize"],n.type="文字",n.textSize=16,n.textFont="黑体",n.textColor="#ffffff",n.alpha=1,n.textOffsetX=0,n.textOffsetY=0,n.bjColor="#ff0000",n._bjColorShow=!1,n.fontWeight="normal",n.outlineShow=!1,n.outlineWidth=2,n.outlineColor="#000000",n.distanceDisplay=!1,n.distanceHeight=55e5,n.scaleMaxSize=6,n.hideValues=["pointIndex","heightReference","gridSwitch","gridLevel","gridIsAgg","gridColor","gridOutlineColor","gridUpdate"],n.initPropBySavedValue(),r&&r.properties)for(var o in r.properties)n[o]=r.properties[o];return n}return oE(t,e),t.prototype.setPrimitivePosition=function(e){e instanceof Array||(e=[e]),e[0]||(e=e.slice(1)),e.length<1||(this.setInternalControlPosition(e),this.label.position=e[0])},t.prototype.initPropBySavedValue=function(){var e=$P.getProp(this.type);return this._scaleByDistance=!!e.scaleByDistance&&e.scaleByDistance,this._scaleMaxSize=e.scaleMaxSize?e.scaleMaxSize:4,this._scaleMinSize=e.scaleMinSize?e.scaleMinSize:1,e},Object.defineProperty(t.prototype,"text",{get:function(){return this._text},set:function(e){this._text=e,this.ent&&(this.label.text=e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"textFont",{get:function(){return this._textFont},set:function(e){this._textFont=e,this.ent&&(this.label.font=this.fontWeight+" "+this.textSize+"px "+e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"textSize",{get:function(){return this._textSize},set:function(e){this._textSize=e,this.ent&&(this.label.font=this.fontWeight+" "+e+"px "+this.textFont)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontWeight",{get:function(){return 0==this._fontWeight||"normal"===this._fontWeight?"normal":"bold"},set:function(e){this._fontWeight=e,this.ent&&(this.label.font=e+" "+this.textSize+"px "+this.textFont)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"textColor",{get:function(){return this._textColor},set:function(e){this._textColor=e,this.ent&&(this.label.fillColor=Cesium.Color.fromCssColorString(e).withAlpha(this.alpha))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bjColorShow",{get:function(){return this._bjColorShow},set:function(e){this._bjColorShow=e,this.ent&&(this.label.backgroundColor=e?Cesium.Color.fromCssColorString(this.bjColor).withAlpha(this.alpha):Cesium.Color.fromCssColorString(this.bjColor).withAlpha(0))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bjColor",{get:function(){return this._bjColor},set:function(e){this._bjColor=e,this.ent&&(this.label.backgroundColor=Cesium.Color.fromCssColorString(e).withAlpha(this.alpha))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"outlineShow",{get:function(){return this._outlineShow},set:function(e){this._outlineShow=e,this.ent&&(this.label.outlineWidth=e?this.outlineWidth:0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"outlineColor",{get:function(){return this._outlineColor},set:function(e){this._outlineColor=e,this.ent&&(this.label.outlineColor=Cesium.Color.fromCssColorString(e).withAlpha(this.alpha))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"outlineWidth",{get:function(){return this._outlineWidth},set:function(e){this._outlineWidth=e,this.ent&&(this.label.outlineWidth=e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){return this.textColor},set:function(e){this.textColor=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this._name},set:function(e){this._name=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"alpha",{get:function(){return this._alpha},set:function(e){this._alpha=e,this.ent&&(this.label.fillColor=Cesium.Color.fromCssColorString(this.textColor).withAlpha(e),this.label.backgroundColor=this._bjColorShow?Cesium.Color.fromCssColorString(this.bjColor).withAlpha(e):Cesium.Color.fromCssColorString(this.bjColor).withAlpha(0),this.label.outlineColor=Cesium.Color.fromCssColorString(this.outlineColor).withAlpha(e))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"scaleByDistance",{get:function(){return this._scaleByDistance},set:function(e){$P.saveProp(this.type,"scaleByDistance",e),this._scaleByDistance=e,this.ent&&(this.label.scaleByDistance=e?new Cesium.NearFarScalar(150,this.scaleMaxSize,15e6,this.scaleMinSize):void 0,this.label.pixelOffsetScaleByDistance=e?new Cesium.NearFarScalar(150,this.scaleMaxSize,15e6,this.scaleMinSize):void 0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"scaleMaxSize",{get:function(){return this._scaleMaxSize},set:function(e){$P.saveProp(this.type,"scaleMaxSize",e),this._scaleMaxSize=e,this.ent&&(this.label.scaleByDistance=this.scaleByDistance?new Cesium.NearFarScalar(150,e,15e6,this.scaleMinSize):void 0,this.label.pixelOffsetScaleByDistance=this.scaleByDistance?new Cesium.NearFarScalar(150,e,15e6,this.scaleMinSize):void 0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"scaleMinSize",{get:function(){return this._scaleMinSize},set:function(e){$P.saveProp(this.type,"scaleMinSize",e),this._scaleMinSize=e,this.ent&&(this.label.scaleByDistance=this.scaleByDistance?new Cesium.NearFarScalar(150,this.scaleMaxSize,15e6,e):void 0,this.label.pixelOffsetScaleByDistance=this.scaleByDistance?new Cesium.NearFarScalar(150,this.scaleMaxSize,15e6,e):void 0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"textOffsetX",{get:function(){return this._textOffsetX},set:function(e){this._textOffsetX=e,this.ent&&(this.label.pixelOffset=new Cesium.Cartesian2(e,this.textOffsetY))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"textOffsetY",{get:function(){return this._textOffsetY},set:function(e){this._textOffsetY=e,this.ent&&(this.label.pixelOffset=new Cesium.Cartesian2(this.textOffsetX,e))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"clampToGround",{get:function(){return this._clampToGround},set:function(e){this._clampToGround=e,e&&this.allowCrossGround&&(this.allowCrossGround=!1),this.ent&&(this.heightReference=e?1:0,this.resetHeightReference())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"heightReference",{get:function(){return this._heightReference},set:function(e){"string"==typeof e&&(e=Number.parseInt(e)),this._heightReference=e,this.ent&&(this.label.heightReference=this.heightReference),this.resetHeightReference()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"allowCrossGround",{get:function(){return this._allowCrossGround},set:function(e){this._allowCrossGround=e,e&&this.clampToGround&&(this.clampToGround=!1)},enumerable:!1,configurable:!0}),t.prototype.scale=function(e,t){this.textSize=this.changeScaleByMouse(this.textSize,e,t)},Object.defineProperty(t.prototype,"distanceDisplay",{get:function(){return this._distanceDisplay},set:function(e){this._distanceDisplay=e,this.ent&&(this.label.distanceDisplayCondition=e?new Cesium.DistanceDisplayCondition(0,this.distanceHeight):void 0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"distanceHeight",{get:function(){return this._distanceHeight},set:function(e){this._distanceHeight=e,this.ent&&(this.label.distanceDisplayCondition=this.distanceDisplay?new Cesium.DistanceDisplayCondition(0,e):void 0)},enumerable:!1,configurable:!0}),t.prototype.createEnt=function(e){t.labelCollection&&this.label||(t.labelCollection=new Cesium.LabelCollection({scene:this.viewer.scene}),t.labelCollection._scene=this.viewer.scene,this.viewer.scene.primitives.add(t.labelCollection)),this.label&&t.labelCollection.remove(this.label),this.ent instanceof Cesium.Primitive&&this.viewer.scene.primitives.remove(this.ent),this.label=t.labelCollection.add({text:this.text,show:this.show,font:this.fontWeight+" "+this.textSize+"px "+this.textFont,fillColor:Cesium.Color.fromCssColorString(this.textColor).withAlpha(this.alpha),backgroundColor:this._bjColorShow?Cesium.Color.fromCssColorString(this.bjColor).withAlpha(this.alpha):Cesium.Color.fromCssColorString(this.bjColor).withAlpha(0),showBackground:!0,scaleByDistance:this.scaleByDistance?new Cesium.NearFarScalar(150,this.scaleMaxSize,15e6,this.scaleMinSize):void 0,pixelOffsetScaleByDistance:this.scaleByDistance?new Cesium.NearFarScalar(150,this.scaleMaxSize,15e6,this.scaleMinSize):void 0,pixelOffset:new Cesium.Cartesian2(this.textOffsetX,this.textOffsetY),outlineColor:Cesium.Color.fromCssColorString(this.outlineColor).withAlpha(this.alpha),outlineWidth:this.outlineShow?this.outlineWidth:0,distanceDisplayCondition:this.distanceDisplay?new Cesium.DistanceDisplayCondition(0,this.distanceHeight):void 0,style:Cesium.LabelStyle.FILL_AND_OUTLINE}),this.label.heightReference=this.heightReference,this.ent=this.label,this.fillShape(this.ent)},t.prototype.initShape=function(){var e=this;this.createEnt(Cesium.Cartesian3.ZERO),this.positionProperty=function(){var t=e._singleControlPosition.concat($A.cursorPos);t&&e.setPrimitivePosition(t)}},t.prototype.delete=function(){e.prototype.delete.call(this),this.label&&t.labelCollection.remove(this.label)},t.prototype.toEdit=function(){var t=this;e.prototype.toEdit.call(this),this.positionProperty=function(){var e=t._singleControlPosition;t.setPrimitivePosition(e)}},t.prototype.finish=function(){if(this.ent){e.prototype.finish.call(this);var t=this._singleControlPosition;this.positionProperty=t}},Object.defineProperty(t.prototype,"show",{get:function(){return this._show},set:function(e){this._show=e,this.label&&(this.label.show=e)},enumerable:!1,configurable:!0}),aE([dy({name:"文字",group:"文本",order:6,type:"textArea",hiddenGroupName:!0}),lE("design:type",String),lE("design:paramtypes",[String])],t.prototype,"text",null),aE([dy({name:"字体",group:"文本",order:6,type:"font",hiddenGroupName:!0}),lE("design:type",String),lE("design:paramtypes",[String])],t.prototype,"textFont",null),aE([dy({name:"文字大小",group:"文本",subGroup:"大小粗细",order:6,subOrder:1,type:"size",hiddenGroupName:!0}),lE("design:type",Number),lE("design:paramtypes",[Number])],t.prototype,"textSize",null),aE([dy({name:"字体粗细",group:"文本",subGroup:"大小粗细",order:6,subOrder:2,type:"option",hiddenGroupName:!0,options:[{label:"正常",value:"normal"},{label:"加粗",value:"bold"}]}),lE("design:type",String),lE("design:paramtypes",[String])],t.prototype,"fontWeight",null),aE([dy({name:"颜色",group:"文本",order:6,type:"color",subGroup:"填充",subOrder:4}),lE("design:type",String),lE("design:paramtypes",[String])],t.prototype,"textColor",null),aE([dy({name:"背景颜色可选",group:"文本",subGroup:"背景颜色",order:6,subOrder:5,type:"checkboxSub"}),lE("design:type",Boolean),lE("design:paramtypes",[Boolean])],t.prototype,"bjColorShow",null),aE([dy({name:"背景颜色",group:"文本",subGroup:"背景颜色",order:6,subOrder:6,type:"color"}),lE("design:type",String),lE("design:paramtypes",[String])],t.prototype,"bjColor",null),aE([dy({name:"是否描边",group:"文本",type:"checkboxSub",order:6,subGroup:"描边",subOrder:7}),lE("design:type",Boolean),lE("design:paramtypes",[Boolean])],t.prototype,"outlineShow",null),aE([dy({name:"描边颜色",group:"文本",subGroup:"描边",order:6,subOrder:8,type:"color"}),lE("design:type",String),lE("design:paramtypes",[String])],t.prototype,"outlineColor",null),aE([dy({name:"描边线宽",group:"文本",subGroup:"描边线宽",order:6,subOrder:9,type:"numberNew",min:0,max:6}),lE("design:type",Number),lE("design:paramtypes",[Number])],t.prototype,"outlineWidth",null),aE([(0,fy.o)(),lE("design:type",String),lE("design:paramtypes",[String])],t.prototype,"color",null),aE([dy({name:"不透明度",group:"通用",subGroup:"不透明度",order:2,subOrder:5,type:"slider"}),lE("design:type",Number),lE("design:paramtypes",[Number])],t.prototype,"alpha",null),aE([dy({name:"自动缩放",group:"文本",type:"checkbox",order:6,subGroup:"自动缩放",subOrder:13}),lE("design:type",Boolean),lE("design:paramtypes",[Boolean])],t.prototype,"scaleByDistance",null),aE([dy({name:"放大倍数",group:"文本",order:6,type:"numberNew",subGroup:"放大倍数",subOrder:14,min:2,max:10}),lE("design:type",Number),lE("design:paramtypes",[Number])],t.prototype,"scaleMaxSize",null),aE([dy({name:"缩小倍数",group:"文本",order:6,type:"numberNew",subGroup:"缩小倍数",subOrder:15,min:0,max:1}),lE("design:type",Number),lE("design:paramtypes",[Number])],t.prototype,"scaleMinSize",null),aE([dy({name:"X",group:"文本",subGroup:"文字偏移",order:6,subOrder:16,type:"pyblock",min:-1e3,max:1e3}),lE("design:type",Number),lE("design:paramtypes",[Number])],t.prototype,"textOffsetX",null),aE([dy({name:"Y",group:"文本",subGroup:"文字偏移",order:6,subOrder:17,type:"pyblock",min:-1e3,max:1e3}),lE("design:type",Number),lE("design:paramtypes",[Number])],t.prototype,"textOffsetY",null),aE([dy({name:"贴地",group:"外观",type:"tiediCheckbox",order:8}),lE("design:type",Boolean),lE("design:paramtypes",[Boolean])],t.prototype,"clampToGround",null),aE([dy({name:"可视高度",group:"通用",subGroup:"可视高度",subOrder:1,type:"checkboxSub",order:2,hiddenGroupName:!1}),lE("design:type",Boolean),lE("design:paramtypes",[Boolean])],t.prototype,"distanceDisplay",null),aE([dy({name:"可视高度距离",group:"通用",subGroup:"可视高度",subOrder:2,type:"number3",order:2,hiddenGroupName:!1,min:0,max:2e7}),lE("design:type",Number),lE("design:paramtypes",[Number])],t.prototype,"distanceHeight",null),aE([(0,fy.o)(),lE("design:type",Cesium.Label)],t.prototype,"label",void 0),t}(nS);const cE=hE;c.Z.registerType(hE,"EditorText","Graph");var uE=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),pE=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},dE=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},mE=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return uE(t,e),t.prototype.setPrimitivePosition=function(e){},pE([(0,fy.o)(),dE("design:type",Object)],t.prototype,"lastPoisiton",void 0),t}(UP);const fE=mE;c.Z.registerType(mE,"EditorJBLine","Graph");var gE=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),AE=function(){return AE=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},AE.apply(this,arguments)},yE=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},vE=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},CE=function(e,t,i,r){return new(i||(i=Promise))((function(n,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?n(e.value):function(e){return e instanceof i?e:new i((function(t){t(e)}))}(e.value).then(s,a)}l((r=r.apply(e,t||[])).next())}))},_E=function(e,t){var i,r,n,o,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,r&&(n=2&o[0]?r.return:o[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,o[1])).done)return n;switch(r=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(n=s.trys,(n=n.length>0&&n[n.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){s.label=o[1];break}if(6===o[0]&&s.label<n[1]){s.label=n[1],n=o;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(o);break}n[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{i=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},bE=function(e){function t(t,i,r,n){var o=e.call(this,t,i,AE({},r))||this;if(n&&(o.jbData=n),o.type="贴地点军标",o.alpha=1,o.code="1000100",r&&r.properties)for(var s in r.properties)o[s]=r.properties[s];return o}return gE(t,e),t.prototype.initProps=function(e){},t.prototype.initShape=function(){var t=this;this._imageUrl=this.jbData+this.code,this.modifySvg().then((function(e){t.svgStr=e})),this.ent=this.entities.add(new Cesium.Entity({rectangle:{}})),this.ent.show=this.show,e.prototype.fillShape.call(this,this.ent),Object.assign(this.ent.rectangle,{material:new Cesium.ImageMaterialProperty({image:new Cesium.CallbackProperty((function(e,i){return t.svgStr}),!0),color:new Cesium.CallbackProperty((function(e,i){return Cesium.Color.WHITE.withAlpha(t.alpha)}),!0),transparent:!0}),stRotation:new Cesium.CallbackProperty((function(e,i){return 3.14*t.rotation/180}),!1),rotation:new Cesium.CallbackProperty((function(e,i){return 3.14*t.rotation/180}),!1),coordinates:new Cesium.CallbackProperty((function(e,i){return t.calcuteShape(t._singleControlPosition.concat($A.cursorPos))}),!1)})},t.prototype.rotateByHeading=function(e,t){var i=this.rotation+(t.x-e.x);this.rotation=i},t.prototype.modifySvg=function(){return CE(this,void 0,void 0,(function(){var e,t;return _E(this,(function(i){switch(i.label){case 0:return this._imageUrl?[4,fetch(this._imageUrl)]:[2];case 1:return[4,i.sent().text()];case 2:return e=i.sent(),t=this.color,e=(e=e.replace(/rgb\(255,0,0\)/g,t)).replace(/white/g,t),[2,this.exportSVG(e)]}}))}))},t.prototype.cesiumRgb2Hex=function(e){return Math.round((1<<24)+(255*e.red<<16)+(255*e.green<<8)+255*e.blue).toString(16).slice(1)},t.prototype.exportSVG=function(e){var t="data:image/svg+xml;base64,";return t+=btoa(unescape(encodeURIComponent(e)))},yE([dy({name:"军标码",group:"外观",order:8,type:"display",editable:!1}),vE("design:type",String)],t.prototype,"code",void 0),t}(qP);const wE=bE;c.Z.registerType(bE,"EditorJBPointObject","Graph");var PE=i(5108),SE=function(e,t,i,r){return new(i||(i=Promise))((function(n,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?n(e.value):function(e){return e instanceof i?e:new i((function(t){t(e)}))}(e.value).then(s,a)}l((r=r.apply(e,t||[])).next())}))},xE=function(e,t){var i,r,n,o,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,r&&(n=2&o[0]?r.return:o[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,o[1])).done)return n;switch(r=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(n=s.trys,(n=n.length>0&&n[n.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){s.label=o[1];break}if(6===o[0]&&s.label<n[1]){s.label=n[1],n=o;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(o);break}n[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{i=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},BE=function(){function e(e){this.textOptions={x:68,y:60,width:416,height:192,backgroundColor:"#ffffff70",fontSize:90,textX:68,textY:202,textColor:"#ff0000",textLength:416,lengthAdjust:"spacingAndGlyphs"},this._textTail="</text>",this._imageUrl=e}return e.prototype.changeFlagText=function(e,t){return SE(this,void 0,void 0,(function(){return xE(this,(function(i){return this._fullTextSvgContent=this.getTextElements(t)+e+this._textTail,this.insertText(),[2]}))}))},e.prototype.insertText=function(){var e=this._newStr.lastIndexOf("<");this._newStr.indexOf("text")<0?(this._newStr=this._newStr.slice(0,e)+this._fullTextSvgContent+this._newStr.slice(e),this.svgStrBase64=this.exportSVG(this._newStr)):(this._newStr=this._newStr.slice(0,this._newStr.indexOf("/>")+2)+this._fullTextSvgContent+this._newStr.slice(e),this.svgStrBase64=this.exportSVG(this._newStr))},e.prototype.getTextElements=function(e){return Object.assign(this.textOptions,e),'<rect x="'.concat(this.textOptions.x,'" y="').concat(this.textOptions.y,'" width="').concat(this.textOptions.width,'"\n     height="').concat(this.textOptions.height,'" style="fill:').concat(this.textOptions.backgroundColor,';stroke-width:0; "/>\n    <text style="font-size:').concat(this.textOptions.fontSize,'px" x="').concat(this.textOptions.textX,'" y="').concat(this.textOptions.textY,'" fill="').concat(this.textOptions.textColor,'" \n    textLength="').concat(this.textOptions.textLength,'" lengthAdjust="').concat(this.textOptions.lengthAdjust,'">')},e.prototype.modifySvgColor=function(e){return SE(this,void 0,void 0,(function(){var t,i;return xE(this,(function(r){switch(r.label){case 0:return PE.log("modifySvgColor",e),this._imageUrl?this._svgStr?[3,3]:[4,fetch(this._imageUrl)]:[2];case 1:return t=r.sent(),i=this,[4,t.text()];case 2:i._svgStr=r.sent(),r.label=3;case 3:return this._newStr=this._svgStr.replace(/rgb\(255,0,0\)/g,e),this._newStr=this._newStr.replace(/white/g,e),this._fullTextSvgContent&&this.insertText(),this.svgStrBase64=this.exportSVG(this._newStr),[2]}}))}))},e.prototype.exportSVG=function(e){var t="data:image/svg+xml;base64,";return t+=btoa(unescape(encodeURIComponent(e)))},e.textSpacingOption=[{label:"间隔",value:"spacing"},{label:"拉伸",value:"spacingAndGlyphs"}],e}(),ME=i(5108),EE=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),TE=function(){return TE=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},TE.apply(this,arguments)},OE=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},LE=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},DE=function(e){function t(t,i,r,n){var o=e.call(this,t,i,TE({},r))||this;n&&(o.jbData=n),o.type="屏幕点军标",o.code="1000100";var s=e.prototype.initPropBySavedValue.call(o);if(o.initPropBySavedValuePointJb(s),o.imageOffsetX=1.4*r.offsetX,ME.log("imageOffsetX",o.imageOffsetX),o.imageOffsetY=0,o.text="",o.textOffsetX=0,o.textOffsetY=0,r&&r.properties)for(var a in r.properties)o[a]=r.properties[a];return o}return EE(t,e),t.prototype.initPropBySavedValuePointJb=function(e){this._alpha=e.alpha?e.alpha:1,this._color=e.color?e.color:"#ff0000",this._flagTextSize=e.flagTextSize?e.flagTextSize:90,this._flagTextColor=e.flagTextColor?e.flagTextColor:"#ff0000",this._lengthAdjust=e.lengthAdjust?e.lengthAdjust:"spacingAndGlyphs",this._flagBgColor=e.flagBgColor?e.flagBgColor:"#ffffff70",this._textVisible=!!e.textVisible&&e.textVisible,this._textSize=e.textSize?e.textSize:24,this._textFont=e.textFont?e.textFont:"黑体",this._textColor=e.textColor?e.textColor:"#ffffff"},Object.defineProperty(t.prototype,"color",{get:function(){return this._color},set:function(e){this._color=e,$P.saveProp(this.type,"color",e),this.svgHelper&&this.svgHelper.modifySvgColor(this._color)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"alpha",{get:function(){return this._alpha},set:function(e){this._alpha=e,$P.saveProp(this.type,"alpha",e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"textVisible",{get:function(){return this._textVisible},set:function(e){$P.saveProp(this.type,"textVisible",e),this._textVisible=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"textSize",{get:function(){return this._textSize},set:function(e){$P.saveProp(this.type,"textSize",e),this._textSize=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"textFont",{get:function(){return this._textFont},set:function(e){$P.saveProp(this.type,"textFont",e),this._textFont=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"textColor",{get:function(){return this._textColor},set:function(e){$P.saveProp(this.type,"textColor",e),this._textColor=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"flagText",{get:function(){return this._flagText},set:function(e){this._flagText=e,this._flagText.length>10?this.name=this._flagText.substr(0,10):this.name=this._flagText,this.svgHelper&&this.svgHelper.changeFlagText(this._flagText,null)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"flagTextSize",{get:function(){return this._flagTextSize},set:function(e){$P.saveProp(this.type,"flagTextSize",e),this._flagTextSize=e,this.svgHelper&&this.svgHelper.changeFlagText(this._flagText,{fontSize:this._flagTextSize})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lengthAdjust",{get:function(){return this._lengthAdjust},set:function(e){$P.saveProp(this.type,"lengthAdjust",e),this._lengthAdjust=e,this.svgHelper&&this.svgHelper.changeFlagText(this._flagText,{lengthAdjust:this._lengthAdjust})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"flagTextColor",{get:function(){return this._flagTextColor},set:function(e){$P.saveProp(this.type,"flagTextColor",e),this._flagTextColor=e,this.svgHelper&&this.svgHelper.changeFlagText(this._flagText,{textColor:this._flagTextColor})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"flagBgColor",{get:function(){return this._flagBgColor},set:function(e){$P.saveProp(this.type,"flagBgColor",e),this._flagBgColor=e,this.svgHelper&&this.svgHelper.changeFlagText(this._flagText,{backgroundColor:this._flagBgColor})},enumerable:!1,configurable:!0}),t.prototype.initProps=function(e){},t.prototype.initShape=function(){var t=this;this.svgHelper=new BE(this.jbData+this.code),this.svgHelper.modifySvgColor(this._color).then((function(e){t.flagTextColor&&t.flagText?(t.svgHelper.textOptions.fontSize=t.flagTextSize,t.svgHelper.textOptions.lengthAdjust=t.lengthAdjust,t.svgHelper.textOptions.textColor=t.flagTextColor,t.flagTextSize=t.flagTextSize,t.lengthAdjust=t.lengthAdjust,t.flagTextColor=t.flagTextColor):(t.svgHelper.textOptions.fontSize=t._flagTextSize,t.svgHelper.textOptions.lengthAdjust=t._lengthAdjust,t.svgHelper.textOptions.textColor=t._flagTextColor)})),e.prototype.initShapePin.call(this),Object.assign(this.ent.billboard,{image:new Cesium.CallbackProperty((function(e,i){return t.svgHelper.svgStrBase64}),!1),pixelOffset:new Cesium.CallbackProperty((function(e,i){return new Cesium.Cartesian2(t.imageOffsetX*t.scalev,t.imageOffsetY)}),!0),heightReference:new Cesium.CallbackProperty((function(e,i){return t.heightReference}),!0),color:new Cesium.CallbackProperty((function(e,i){return Cesium.Color.WHITE.withAlpha(t.alpha)}),!0),rotation:new Cesium.CallbackProperty((function(e,i){return 3.14*(360-t.rotation)/180}),!0),scale:new Cesium.CallbackProperty((function(e,i){return t.scalev}),!0),width:new Cesium.CallbackProperty((function(e,i){return t.width}),!0),height:new Cesium.CallbackProperty((function(e,i){return t.height}),!0),verticalOrigin:Cesium.VerticalOrigin.BOTTOM}),Object.assign(this.ent.label,{text:new Cesium.CallbackProperty((function(e,i){return t.text}),!0),show:new Cesium.CallbackProperty((function(e,i){return t.textVisible}),!0),font:new Cesium.CallbackProperty((function(e,i){return t.textSize+"px "+t.textFont}),!0),fillColor:new Cesium.CallbackProperty((function(e,i){return Cesium.Color.fromCssColorString(t.textColor)}),!0),pixelOffset:new Cesium.CallbackProperty((function(e,i){return new Cesium.Cartesian2(t.textOffsetX,t.textOffsetY)}),!0),scaleByDistance:new Cesium.CallbackProperty((function(e,i){return t.scaleByDistance?new Cesium.NearFarScalar(150,t.scaleMaxSize,15e6,t.scaleMinSize):null}),!0),pixelOffsetScaleByDistance:new Cesium.CallbackProperty((function(e,i){return t.scaleByDistance?new Cesium.NearFarScalar(150,t.scaleMaxSize,15e6,t.scaleMinSize):null}),!0)}),this.ent.position=new Cesium.CallbackProperty((function(e,i){return t.calcuteShape(t._singleControlPosition.concat($A.cursorPos),e)}),!1)},OE([(0,fy.o)(),LE("design:type",BE)],t.prototype,"svgHelper",void 0),OE([dy({name:"军标码",group:"标号",order:2,subOrder:1,type:"display",editable:!1}),LE("design:type",String)],t.prototype,"code",void 0),OE([dy({name:"颜色",group:"标号",subGroup:"颜色",order:2,subOrder:3,type:"color"}),LE("design:type",String),LE("design:paramtypes",[String])],t.prototype,"color",null),OE([dy({name:"不透明度",group:"标号",subGroup:"颜色",order:3,subOrder:4,type:"slider",max:1,min:0}),LE("design:type",Number),LE("design:paramtypes",[Number])],t.prototype,"alpha",null),OE([dy({name:"X",group:"标号",subGroup:"标号偏移",order:3,subOrder:1,type:"block"}),LE("design:type",Number)],t.prototype,"imageOffsetX",void 0),OE([dy({name:"Y",group:"标号",subGroup:"标号偏移",order:3,subOrder:2,type:"block"}),LE("design:type",Number)],t.prototype,"imageOffsetY",void 0),OE([dy({name:"代字",group:"番号",order:1,subGroup:"代字",subOrder:2,type:"string"}),LE("design:type",String)],t.prototype,"text",void 0),OE([dy({name:"文字是否可见",group:"番号",subGroup:"代字",order:1,subOrder:1,type:"boolean"}),LE("design:type",Boolean),LE("design:paramtypes",[Boolean])],t.prototype,"textVisible",null),OE([dy({name:"文字大小",group:"番号",subGroup:"代字样式",order:1,subOrder:7,type:"size",min:1,max:200}),LE("design:type",Number),LE("design:paramtypes",[Number])],t.prototype,"textSize",null),OE([dy({name:"字体",group:"番号",subGroup:"代字样式",order:1,subOrder:6,type:"font"}),LE("design:type",String)],t.prototype,"_textFont",void 0),OE([dy({name:"文字颜色",group:"番号",subGroup:"代字样式",order:1,subOrder:5,type:"color"}),LE("design:type",String),LE("design:paramtypes",[String])],t.prototype,"textColor",null),OE([dy({name:"X",group:"番号",subGroup:"代字偏移",order:1,subOrder:3,type:"block",hiddenGroupName:!1}),LE("design:type",Number)],t.prototype,"textOffsetX",void 0),OE([dy({name:"Y",group:"番号",subGroup:"代字偏移",order:1,subOrder:4,type:"block",hiddenGroupName:!1}),LE("design:type",Number)],t.prototype,"textOffsetY",void 0),OE([dy({name:"旗面文字",group:"旗面",order:1,type:"text"}),LE("design:type",String),LE("design:paramtypes",[String])],t.prototype,"flagText",null),OE([dy({name:"文字大小",group:"旗面",order:1,type:"number",min:10,max:200}),LE("design:type",Number),LE("design:paramtypes",[Number])],t.prototype,"flagTextSize",null),OE([dy({name:"文字间隔",group:"旗面",order:1,type:"option",options:BE.textSpacingOption}),LE("design:type",String),LE("design:paramtypes",[String])],t.prototype,"lengthAdjust",null),OE([dy({name:"文字颜色",group:"旗面",subGroup:"文字颜色",order:1,type:"color"}),LE("design:type",String),LE("design:paramtypes",[String])],t.prototype,"flagTextColor",null),OE([dy({name:"背景颜色",group:"旗面",subGroup:"背景颜色",order:1,type:"color",colorType:"rgb",alpha:!0}),LE("design:type",String),LE("design:paramtypes",[String])],t.prototype,"flagBgColor",null),t}(yB);const IE=DE;c.Z.registerType(DE,"EditorJBPointScreen","Graph");var RE=i(5108),HE=function(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],r=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},FE=function(){function e(e,t,i,r){var n=this,o=new NE;for(var s in r)o[s]=r[s];this._position=new A(t,i),this._radarOption=o,this.viewer=e,this.create(),this.createScan(),this.createPrimitive(),this.updateModelMatrix();var a=0,l=!0,h=Date.now();this.render=function(){if(n.primitive.isDestroyed())n.viewer.scene.postRender.removeEventListener(n.render);else{var e=Cesium.Matrix3.fromRotationX(Cesium.Math.toRadians(-a)),t=Cesium.Matrix4.multiplyByMatrix3(n.originalMatrix,e,new Cesium.Matrix4);n.primitive.get(2)&&(n.primitive.get(2).modelMatrix=t),n.primitive.get(3)&&(n.primitive.get(3).modelMatrix=t);var i=(n.radarOption.endAngle-n.radarOption.scanAngle-n.radarOption.startAngle)/100*n.radarOption.scanSpeed,r=Date.now(),o=(r-h)/1e3*i;h=r,n.radarOption.scanReserve?l?a+=o:a-=o:a+=o,a>=n.radarOption.endAngle-n.radarOption.scanAngle-n.radarOption.startAngle&&(n.radarOption.scanReserve?(l=!l,a=n.radarOption.endAngle-n.radarOption.scanAngle-n.radarOption.startAngle):a=0),a<0&&(a=0,n.radarOption.scanReserve&&(l=!l))}},this.viewer.scene.postRender.addEventListener(this.render)}return Object.defineProperty(e.prototype,"position",{get:function(){return this._position},set:function(e){this._position=e,this.updateModelMatrix()},enumerable:!1,configurable:!0}),e.prototype.create=function(){var e,t,i,r,n=this.radarOption.startAngle,o=this.radarOption.endAngle,s=this.radarOption.vStartAngle,a=this.radarOption.vEndAngle,l=this.radarOption.radius/1e3,h=xt.xmu([0,0]),c=10,u=a-s,p=Cesium.Color.fromCssColorString(this.radarOption.outerColor),d=this.radarOption.outerAlpha,m=Cesium.Color.RED,f=Cesium.Color.fromCssColorString(this.radarOption.lineColor);function g(e){e.push(p.red),e.push(p.green),e.push(p.blue),e.push(d)}function A(e){e.push(m.red),e.push(m.green),e.push(m.blue),e.push(0)}function y(e){e.push(f.red),e.push(f.green),e.push(f.blue),e.push(1)}for(var v=[],C=[],_=[],b=0;b<=c;b++){var w=Cesium.Math.toRadians(s+b/c*u),P=0==w?l:Math.cos(w)*l,S=0==w?0:Math.sin(w)*l*1e3,x=[];if(0==P)for(var B=0;B<18;B++)x.push({lon:0,lat:0,alt:S});else{var M=xt.Q$S(h,P,n,o);try{for(var E=(e=void 0,HE(M.geometry.coordinates[0])),T=E.next();!T.done;T=E.next()){var O=T.value;x.push({lon:O[0],lat:O[1],alt:S})}}catch(t){e={error:t}}finally{try{T&&!T.done&&(t=E.return)&&t.call(E)}finally{if(e)throw e.error}}}x.splice(0,1),x.splice(x.length-1,1),0==n&&360==o&&x.push(x[0]),_.push(x)}for(b=0;b<c;b++){var L=_[0].length;for(B=0;B<L-1;B++){var D=_[b][B],I=Cesium.Cartesian3.fromDegrees(D.lon,D.lat,D.alt),R=_[b][B+1],H=Cesium.Cartesian3.fromDegrees(R.lon,R.lat,R.alt),F=_[b+1][B],N=Cesium.Cartesian3.fromDegrees(F.lon,F.lat,F.alt);v.push(I),v.push(H),v.push(N),g(C),g(C),g(C)}}for(b=1;b<11;b++)for(L=_[0].length,B=0;B<L-1;B++){D=_[b][B],I=Cesium.Cartesian3.fromDegrees(D.lon,D.lat,D.alt),R=_[b][B+1],H=Cesium.Cartesian3.fromDegrees(R.lon,R.lat,R.alt),F=_[b-1][B+1],N=Cesium.Cartesian3.fromDegrees(F.lon,F.lat,F.alt);v.push(I),v.push(H),v.push(N),g(C),g(C),g(C)}var Q=[];0==s||Math.sin(Cesium.Math.toRadians(s));var k=(0==a?0:Math.sin(Cesium.Math.toRadians(a))*l*1e3)-0,U=Math.cos(Cesium.Math.toRadians(a))*l;if(0!=U){for(b=c;b>=0;b--){S=b/c*k+0,x=[];if(0==(P=b/c*U)){var j=Q[0].length;for(B=0;B<j;B++)x.push({lon:0,lat:0,alt:S})}else{M=xt.Q$S(h,P,n,o);try{for(var G=(i=void 0,HE(M.geometry.coordinates[0])),z=G.next();!z.done;z=G.next()){var Y=z.value;x.push({lon:Y[0],lat:Y[1],alt:S})}}catch(e){i={error:e}}finally{try{z&&!z.done&&(r=G.return)&&r.call(G)}finally{if(i)throw i.error}}x.splice(0,1),x.splice(x.length-1,1)}0==n&&360==o&&x.push(x[0]),Q.push(x)}Q[0][0];var Z=Q[10][0];for(b=c;b>=0;b--){var W=0+(Z.lon-0)/c*b,X=0+(Z.lat-0)/c*b,J=0+(Z.alt-0)/c*b;Q[b].push({lon:W,lat:X,alt:J}),Q[b].splice(0,0,{lon:W,lat:X,alt:J})}for(b=0;b<c;b++)for(L=Q[0].length,B=0;B<L-1;B++){D=Q[b][B],I=Cesium.Cartesian3.fromDegrees(D.lon,D.lat,D.alt),R=Q[b][B+1],H=Cesium.Cartesian3.fromDegrees(R.lon,R.lat,R.alt),F=Q[b+1][B],N=Cesium.Cartesian3.fromDegrees(F.lon,F.lat,F.alt);v.push(I),v.push(H),v.push(N),A(C),A(C),A(C)}for(b=1;b<11;b++)for(L=Q[0].length,B=0;B<L-1;B++){D=Q[b][B],I=Cesium.Cartesian3.fromDegrees(D.lon,D.lat,D.alt),R=Q[b][B+1],H=Cesium.Cartesian3.fromDegrees(R.lon,R.lat,R.alt),F=Q[b-1][B+1],N=Cesium.Cartesian3.fromDegrees(F.lon,F.lat,F.alt);v.push(I),v.push(H),v.push(N),A(C),A(C),A(C)}}if(0!=n||360!=o){for(b=0;b<c;b++){var K=_[b].length;D=_[b][K-1],I=Cesium.Cartesian3.fromDegrees(D.lon,D.lat,D.alt),R=_[b+1][K-1],H=Cesium.Cartesian3.fromDegrees(R.lon,R.lat,R.alt),N=Cesium.Cartesian3.fromDegrees(0,0,0);v.push(I),v.push(H),v.push(N),A(C),A(C),A(C)}for(b=0;b<c;b++){_[b].length,D=_[b][0],I=Cesium.Cartesian3.fromDegrees(D.lon,D.lat,D.alt),R=_[b+1][0],H=Cesium.Cartesian3.fromDegrees(R.lon,R.lat,R.alt),N=Cesium.Cartesian3.fromDegrees(0,0,0);v.push(I),v.push(H),v.push(N),A(C),A(C),A(C)}}this.primitiveTriangles=new Wy(this.viewer,v,C);var V=[],q=[],$=!1;for(b=0;b<=c;b++){var ee=_[0].length;if($)for(B=0;B<ee;B++){var te=_[b][B],ie=Cesium.Cartesian3.fromDegrees(te.lon,te.lat,te.alt);V.push(ie),y(q)}else for(B=ee-1;B>=0;B--){var re=_[b][B];ie=Cesium.Cartesian3.fromDegrees(re.lon,re.lat,re.alt);V.push(ie),y(q)}$=!$}var ne=_[0].length;for(B=0;B<ne;B++){if($)for(b=c;b>=0;b--){var oe=_[b][B];ie=Cesium.Cartesian3.fromDegrees(oe.lon,oe.lat,oe.alt);V.push(ie),y(q)}else for(var b=0;b<=c;b++){var se=_[b][B];se||RE.log(se);var ie=Cesium.Cartesian3.fromDegrees(se.lon,se.lat,se.alt);V.push(ie),y(q)}$=!$}if(0!=n||360!=o){ie=Cesium.Cartesian3.fromDegrees(0,0,0);V.push(ie),q.push(1),q.push(1),q.push(0),q.push(1);for(b=c;b>=0;b--){var ae=Q[b].length,le=Q[b][ae-2];ie=Cesium.Cartesian3.fromDegrees(le.lon,le.lat,le.alt),V.push(ie),y(q)}for(b=0;b<=c;b++){var he=Q[b].length,ce=Q[b][he-2];ie=Cesium.Cartesian3.fromDegrees(ce.lon,ce.lat,ce.alt),V.push(ie),y(q)}var ue=_[0][0];ie=Cesium.Cartesian3.fromDegrees(ue.lon,ue.lat,ue.alt);V.push(ie),y(q);ie=Cesium.Cartesian3.fromDegrees(0,0,0);V.push(ie),y(q);for(b=c;b>=0;b--){var pe=Q[b][1];ie=Cesium.Cartesian3.fromDegrees(pe.lon,pe.lat,pe.alt),V.push(ie),y(q)}}this.primitivePolyline=new Zy(this.viewer,V,q)},e.prototype.createScan=function(){var e,t,i=this.radarOption.startAngle,r=this.radarOption.startAngle+Number(this.radarOption.scanAngle),n=this.radarOption.vStartAngle,o=this.radarOption.vEndAngle,s=this.radarOption.radius/1e3,a=xt.xmu([0,0]),l=10,h=o-n,c=Cesium.Color.fromCssColorString(this.radarOption.scanColor),u=this.radarOption.outerAlpha,p=Cesium.Color.fromCssColorString(this.radarOption.scanColor);function d(e){e.push(c.red),e.push(c.green),e.push(c.blue),e.push(u)}function m(e){e.push(p.red),e.push(p.green),e.push(p.blue),e.push(1)}for(var f=[],g=[],A=[],y=0;y<=l;y++){var v=Cesium.Math.toRadians(n+y/l*h),C=0==v?s:Math.cos(v)*s,_=0==v?0:Math.sin(v)*s*1e3,b=[];if(0==C)for(var w=0;w<18;w++)b.push({lon:0,lat:0,alt:_});else{var P=xt.Q$S(a,C,i,r);try{for(var S=(e=void 0,HE(P.geometry.coordinates[0])),x=S.next();!x.done;x=S.next()){var B=x.value;b.push({lon:B[0],lat:B[1],alt:_})}}catch(t){e={error:t}}finally{try{x&&!x.done&&(t=S.return)&&t.call(S)}finally{if(e)throw e.error}}}b.splice(0,1),b.splice(b.length-1,1),0==i&&360==r&&b.push(b[0]),A.push(b)}for(y=0;y<l;y++){var M=A[0].length;for(w=0;w<M-1;w++){var E=A[y][w],T=Cesium.Cartesian3.fromDegrees(E.lon,E.lat,E.alt),O=A[y][w+1],L=Cesium.Cartesian3.fromDegrees(O.lon,O.lat,O.alt),D=A[y+1][w],I=Cesium.Cartesian3.fromDegrees(D.lon,D.lat,D.alt);f.push(T),f.push(L),f.push(I),d(g),d(g),d(g)}}for(y=1;y<11;y++)for(M=A[0].length,w=0;w<M-1;w++){E=A[y][w],T=Cesium.Cartesian3.fromDegrees(E.lon,E.lat,E.alt),O=A[y][w+1],L=Cesium.Cartesian3.fromDegrees(O.lon,O.lat,O.alt),D=A[y-1][w+1],I=Cesium.Cartesian3.fromDegrees(D.lon,D.lat,D.alt);f.push(T),f.push(L),f.push(I),d(g),d(g),d(g)}this.scanPrimitiveTriangles=new Wy(this.viewer,f,g);var R=[],H=[],F=A[0].length,N=Cesium.Cartesian3.fromDegrees(0,0,0);R.push(N),m(H);for(y=0;y<=l;y++){B=A[y][0];N=Cesium.Cartesian3.fromDegrees(B.lon,B.lat,B.alt),R.push(N),m(H)}N=Cesium.Cartesian3.fromDegrees(0,0,0),R.push(N),m(H);for(y=0;y<=l;y++){B=A[y][F-1];N=Cesium.Cartesian3.fromDegrees(B.lon,B.lat,B.alt),R.push(N),m(H)}N=Cesium.Cartesian3.fromDegrees(0,0,0),R.push(N),m(H),this.scanPrimitivePolyline=new Zy(this.viewer,R,H)},e.prototype.updateModelMatrix=function(){var e=Cesium.Cartesian3.fromDegrees(0,0),t=Cesium.Cartesian3.fromDegrees(this.position.lon,this.position.lat),i=Cesium.Cartesian3.angleBetween(e,t),r=new Cesium.Cartesian3(e.y*t.z-e.z*t.y,e.z*t.x-e.x*t.z,e.x*t.y-e.y*t.x),n=Math.sqrt(r.x*r.x+r.y*r.y+r.z*r.z);0==n&&(n=.1);var o=r.x/n,s=r.y/n,a=r.z/n,l=new Cesium.Cartesian3(o,s,a),h=Math.cos(i)+l.x*l.x*(1-Math.cos(i)),c=l.x*l.y*(1-Math.cos(i))-l.z*Math.sin(i),u=l.y*Math.sin(i)+l.x*l.z*(1-Math.cos(i)),p=l.z*Math.sin(i)+l.x*l.y*(1-Math.cos(i)),d=Math.cos(i)+l.y*l.y*(1-Math.cos(i)),m=-l.x*Math.sin(i)+l.y*l.z*(1-Math.cos(i)),f=[h,p,-l.y*Math.sin(i)+l.x*l.z*(1-Math.cos(i)),c,d,l.x*Math.sin(i)+l.y*l.z*(1-Math.cos(i)),u,m,Math.cos(i)+l.z*l.z*(1-Math.cos(i))],g=Cesium.Matrix3.fromArray(f),A=Cesium.Matrix4.fromRotationTranslation(g);this.originalMatrix=A,this.primitive.get(0)&&(this.primitive.get(0).modelMatrix=A),this.primitive.get(1)&&(this.primitive.get(1).modelMatrix=A),this.primitive.get(2)&&(this.primitive.get(2).modelMatrix=A),this.primitive.get(3)&&(this.primitive.get(3).modelMatrix=A)},e.prototype.to255Values=function(e,t){var i=Cesium.Color.fromCssColorString(e);return[255*i.red,255*i.green,255*i.blue,255*t*this.radarOption.alpha]},e.prototype.createPrimitive=function(){this.primitive||(this.primitive=new Cesium.PrimitiveCollection({destroyPrimitives:!1})),this.radarOption.endAngle-this.radarOption.startAngle>0&&(this.primitiveInstancePolyline=new Cesium.Primitive({geometryInstances:new Cesium.GeometryInstance({geometry:this.primitivePolyline.geometry,attributes:{color:Cesium.ColorGeometryInstanceAttribute.fromColor(Cesium.Color.fromCssColorString(this.radarOption.lineColor).withAlpha(this.radarOption.alpha))},id:"0"}),appearance:this.primitivePolyline.appearance,asynchronous:!1}),this.primitive.add(this.primitiveInstancePolyline),this.primitiveInstanceTriangles=new Cesium.Primitive({geometryInstances:[new Cesium.GeometryInstance({geometry:this.primitiveTriangles.geometry,id:"1",attributes:{color:Cesium.ColorGeometryInstanceAttribute.fromColor(Cesium.Color.fromCssColorString(this.radarOption.outerColor).withAlpha(this.radarOption.alpha*this.radarOption.outerAlpha))}})],appearance:this.primitiveTriangles.appearance,asynchronous:!1}),this.primitive.add(this.primitiveInstanceTriangles)),0!=this.radarOption.scanAngle&&(this.scanPrimitiveInstanceTriangles=new Cesium.Primitive({geometryInstances:[new Cesium.GeometryInstance({geometry:this.scanPrimitiveTriangles.geometry,id:"2",attributes:{color:Cesium.ColorGeometryInstanceAttribute.fromColor(Cesium.Color.fromCssColorString(this.radarOption.scanColor).withAlpha(this.radarOption.alpha))}})],asynchronous:!1,appearance:this.scanPrimitiveTriangles.appearance,show:this.radarOption.showScan}),this.primitive.add(this.scanPrimitiveInstanceTriangles),this.scanPrimitiveInstancePolyline=new Cesium.Primitive({geometryInstances:[new Cesium.GeometryInstance({geometry:this.scanPrimitivePolyline.geometry,id:"3",attributes:{color:Cesium.ColorGeometryInstanceAttribute.fromColor(Cesium.Color.fromCssColorString(this.radarOption.lineColor).withAlpha(this.radarOption.alpha))}})],appearance:this.scanPrimitivePolyline.appearance,asynchronous:!1,show:this.radarOption.showScan}),this.primitive.add(this.scanPrimitiveInstancePolyline));for(var e=this.primitive,t=0;t<e.length;t++)e.get(t).owner=this.primitive},e.prototype.updateColorAlhpa=function(){var e=this.primitiveInstancePolyline.getGeometryInstanceAttributes("0");e&&(e.color=Cesium.ColorGeometryInstanceAttribute.toValue(Cesium.Color.fromCssColorString(this.radarOption.lineColor).withAlpha(this.radarOption.alpha))),(e=this.primitiveInstanceTriangles.getGeometryInstanceAttributes("1"))&&(e.color=Cesium.ColorGeometryInstanceAttribute.toValue(Cesium.Color.fromCssColorString(this.radarOption.outerColor).withAlpha(this.radarOption.alpha*this.radarOption.outerAlpha))),(e=this.scanPrimitiveInstanceTriangles.getGeometryInstanceAttributes("2"))&&(e.color=Cesium.ColorGeometryInstanceAttribute.toValue(Cesium.Color.fromCssColorString(this.radarOption.scanColor).withAlpha(this.radarOption.alpha))),(e=this.scanPrimitiveInstancePolyline.getGeometryInstanceAttributes("3"))&&(e.color=Cesium.ColorGeometryInstanceAttribute.toValue(Cesium.Color.fromCssColorString(this.radarOption.lineColor).withAlpha(this.radarOption.alpha)))},e.prototype.update=function(){this.primitive.removeAll(),this.create(),this.createScan(),this.createPrimitive(),this.updateModelMatrix()},Object.defineProperty(e.prototype,"radarOption",{get:function(){return this._radarOption},set:function(e){for(var t in e)this._radarOption[t]=e[t]},enumerable:!1,configurable:!0}),e}(),NE=function(){this.outerColor="#00FF00",this.outerAlpha=.1,this.lineColor="#00FF00",this.startAngle=0,this.endAngle=120,this.vStartAngle=20,this.vEndAngle=60,this.radius=3e5,this.scanAngle=5,this.scanColor="#FF0000",this.scanReserve=!1,this.scanSpeed=20,this.showScan=!0},QE=i(5108),kE=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),UE=function(){return UE=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},UE.apply(this,arguments)},jE=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},GE=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},zE=function(e){function t(t,i,r){var n=e.call(this,t,i,UE({},r))||this;if(n.maxPointNum=1,n.minPointNum=1,n.scaleProperty=["radius"],n.type="雷达",n.alpha=1,n.outerColor="#00FF00",n.outerAlpha=.1,n.innerColor="#FFFF00",n.innerAlhpa=.1,n.lineColor="#00FF00",n.startAngle=0,n.endAngle=120,n.vStartAngle=20,n.vEndAngle=60,n.radius=3e5,n.scanAngle=5,n.scanColor="#FF0000",n.scanReserve=!1,n.scanSpeed=20,n.showScan=!0,n.hideValues=["distanceDisplay","distanceHeight","allowCrossGround","heightReference","gridSwitch","gridLevel","gridIsAgg","gridColor","gridOutlineColor","gridUpdate"],n.moveHeight=null,n.support2D=!1,n.heightReference=Cesium.HeightReference.CLAMP_TO_GROUND,r&&r.properties)for(var o in r.properties)n[o]=r.properties[o];return n}return kE(t,e),t.prototype.setPrimitivePosition=function(e){var t=zy.getLongitudeByCartesian3(e,this.viewer),i=zy.getLatitudeByCartesian3(e,this.viewer);this.radarItem.position=new A(t,i),this.setInternalControlPosition([e])},Object.defineProperty(t.prototype,"alpha",{get:function(){return this._alpha},set:function(e){this._alpha=e,this.updateColor()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"scanColor",{get:function(){return this._scanColor},set:function(e){this._scanColor=e,this.updatePrimitive()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"outerColor",{get:function(){return this._outerColor},set:function(e){this._outerColor=e,this.updateColor()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"outerAlpha",{get:function(){return this._outerAlpha},set:function(e){this._outerAlpha=e,this.updateColor()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"innerColor",{get:function(){return this._innerColor},set:function(e){this._innerColor=e,this.updateColor()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"innerAlhpa",{get:function(){return this._innerAlhpa},set:function(e){this._innerAlhpa=e,this.updateColor()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lineColor",{get:function(){return this._lineColor},set:function(e){this._lineColor=e,this.updatePrimitive()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"horizontalAngle",{get:function(){return this._horizontalAngle||(this._horizontalAngle=[0,120]),this._horizontalAngle.length=0,this._horizontalAngle.push(this.startAngle),this._horizontalAngle.push(this.endAngle),this._horizontalAngle},set:function(e){this._horizontalAngle=e,this.startAngle=e[0],this.endAngle=e[1]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"startAngle",{get:function(){return this._startAngle},set:function(e){this._startAngle=e,this.updatePrimitive()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"endAngle",{get:function(){return this._endAngle},set:function(e){this._endAngle=e,this.updatePrimitive()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"verticalAngle",{get:function(){return this._verticalAngle||(this._verticalAngle=[20,60]),this._verticalAngle.length=0,this._verticalAngle.push(this.vStartAngle),this._verticalAngle.push(this.vEndAngle),this._verticalAngle},set:function(e){this._verticalAngle=e,this.vStartAngle=e[0],this.vEndAngle=e[1]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"vStartAngle",{get:function(){return this._vStartAngle},set:function(e){this._vStartAngle=e,this.updatePrimitive()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"vEndAngle",{get:function(){return this._vEndAngle},set:function(e){this._vEndAngle=e,this.updatePrimitive()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"radius",{get:function(){return this._radius},set:function(e){if("number"==typeof e)this._radius=e,this.updatePrimitive();else try{this._radius=Number.parseFloat(e),this.updatePrimitive()}catch(e){QE.log("属性转换失败")}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"scanAngle",{get:function(){return this._scanAngle},set:function(e){this._scanAngle=e,this.updatePrimitive()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"scanReserve",{get:function(){return this._scanReserve},set:function(e){this._scanReserve=e,this.updatePrimitive()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"scanSpeed",{get:function(){return this._scanSpeed},set:function(e){this._scanSpeed=e,this.updatePrimitive()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"showScan",{get:function(){return this._showScan},set:function(e){this._showScan=e,this.updatePrimitive()},enumerable:!1,configurable:!0}),t.prototype.initProps=function(e){},t.prototype.updatePrimitive=function(){this.radarItem&&this.radarItem.primitive&&(this.radarItem.radarOption=this.createOption(),this.radarItem.update())},t.prototype.updateColor=function(){this.radarItem&&this.radarItem.primitive&&(this.radarItem.radarOption=this.createOption(),this.radarItem.updateColorAlhpa())},t.prototype.createOption=function(){var e=new NE;return e.alpha=this.alpha,e.outerColor=this.outerColor,e.outerAlpha=this.outerAlpha,e.lineColor=this.lineColor,e.startAngle=this.startAngle,e.endAngle=this.endAngle,e.vStartAngle=this.vStartAngle,e.vEndAngle=this.vEndAngle,e.radius=this.radius,e.scanAngle=Number(this.scanAngle),e.scanColor=this.scanColor,e.scanReserve=this.scanReserve,e.scanSpeed=Number(this.scanSpeed),e.showScan=this.showScan,e},t.prototype.initShape=function(){this.radarItem=new FE(this.viewer,0,0,this.createOption()),this.ent=this.radarItem.primitive,this.ent.show=!1,this.fillShape(this.ent),this.viewer.scene.primitives.add(this.ent)},t.prototype.calcuteShape=function(e,t){},t.prototype.scale=function(e,t){this.radius+=100*(t.x-e.x)},t.prototype.toEdit=function(){var t=this;e.prototype.toEdit.call(this),this.positionProperty=function(){var e=t._singleControlPosition[0];t.setPrimitivePosition(e),t.ent.show=t.show}},t.prototype.finish=function(){if(this.ent){e.prototype.finish.call(this);var t=this._singleControlPosition[0];this.positionProperty=t}},jE([(0,fy.o)(),GE("design:type",FE)],t.prototype,"radarItem",void 0),jE([dy({name:"不透明度",group:"通用",subGroup:"不透明度",type:"slider",order:2,subOrder:4,min:0,max:1}),GE("design:type",Number),GE("design:paramtypes",[Number])],t.prototype,"alpha",null),jE([dy({name:"扫描颜色",group:"外观",subGroup:"扫描颜色",order:8,type:"color",min:0}),GE("design:type",String),GE("design:paramtypes",[String])],t.prototype,"scanColor",null),jE([dy({name:"外部颜色",group:"外观",subGroup:"外部颜色",subOrder:3,order:8,type:"color"}),GE("design:type",String),GE("design:paramtypes",[String])],t.prototype,"outerColor",null),jE([dy({name:"外部不透明度",group:"外观",subGroup:"外部透明度",subOrder:4,order:8,type:"slider",max:1,min:0}),GE("design:type",Number),GE("design:paramtypes",[Number])],t.prototype,"outerAlpha",null),jE([dy({name:"线条颜色",group:"外观",subGroup:"线条颜色",subOrder:1,order:8,type:"color"}),GE("design:type",String),GE("design:paramtypes",[String])],t.prototype,"lineColor",null),jE([(0,fy.o)(),GE("design:type",Array)],t.prototype,"_horizontalAngle",void 0),jE([dy({name:"水平角",group:"外观",type:"sliderRadar",order:8,max:360,min:0}),GE("design:type",Object),GE("design:paramtypes",[Object])],t.prototype,"horizontalAngle",null),jE([(0,fy.o)(),GE("design:type",Array)],t.prototype,"_verticalAngle",void 0),jE([dy({name:"垂直角",group:"外观",type:"sliderRadar",order:8,max:90,min:0}),GE("design:type",Object),GE("design:paramtypes",[Object])],t.prototype,"verticalAngle",null),jE([dy({name:"半径(米)",group:"外观",order:8,type:"numberNew",max:2e6,min:1}),GE("design:type",Number),GE("design:paramtypes",[Number])],t.prototype,"radius",null),jE([dy({name:"扫描角度",group:"外观",subOrder:12,order:8,type:"numberNew",max:360,min:0}),GE("design:type",Number),GE("design:paramtypes",[Number])],t.prototype,"scanAngle",null),jE([dy({name:"往复扫描",group:"外观",order:8,type:"boolean",min:0}),GE("design:type",Boolean),GE("design:paramtypes",[Boolean])],t.prototype,"scanReserve",null),jE([dy({name:"扫描速度",group:"外观",subOrder:14,order:8,type:"numberNew",min:0,max:100}),GE("design:type",Number),GE("design:paramtypes",[Number])],t.prototype,"scanSpeed",null),jE([dy({name:"显示扫描",group:"外观",order:8,type:"boolean"}),GE("design:type",Boolean),GE("design:paramtypes",[Boolean])],t.prototype,"showScan",null),t}(nS);const YE=zE;c.Z.registerType(zE,"EditorRadar","Graph");var ZE=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),WE=function(e){function t(t,i){var r=e.call(this,t,i)||this;r._listenerFun=function(){var e=r._appearance.material.uniforms.offset;e<1&&((e+=r._data.speed)>=1&&(e=0),r._appearance.material.uniforms.offset=e)},r._map=t,r._data=i;JSON.stringify(i);return r._currMatrix=null,r._appearance=null,r._geometry=null,r.init(i),r}return ZE(t,e),t.prototype.init=function(e){this._appearance=this._createMaterial(),this._geometry=this._getConicGeometry(),this._renderObj=this._createPrimitive();this._map&&(this._currMatrix||(this._currMatrix=this._renderObj.modelMatrix),this._updateModelMatrix(),this._map.scene.primitives.add(this._renderObj),this._map.clock.onTick.addEventListener(this._listenerFun));e&&(this._renderObj.dataId=e.id,this._renderObj.dataName=e.name),this._renderObj.owner=this},t.prototype._createMaterial=function(){return new Cesium.MaterialAppearance({material:new Cesium.Material({fabric:{type:"Stripe",uniforms:{evenColor:this.getColor(this._data.evenColor),oddColor:this.getColor(this._data.oddColor),repeat:20,offset:0}}})})},t.prototype._createGeometry=function(e,t){return new Cesium.Geometry({attributes:{position:new Cesium.GeometryAttribute({componentDatatype:Cesium.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:e}),st:new Cesium.GeometryAttribute({componentDatatype:Cesium.ComponentDatatype.FLOAT,componentsPerAttribute:2,values:t})},primitiveType:Cesium.PrimitiveType.TRIANGLES,boundingSphere:Cesium.BoundingSphere.fromVertices(e)})},t.prototype._getConicGeometry=function(){for(var e=[],t=[],i=360/this._data.slice,r=0,n=0,o=0;Math.ceil(o)<360;o+=i){var s=Math.PI/180*o,a=Math.PI/180*(o+i),l=Cesium.Cartesian3.fromDegrees(0,0,this._data.height);e[r++]=l.x,e[r++]=l.y,e[r++]=l.z,t[n++]=.5,t[n++]=.5;var h=Cesium.Cartesian3.fromDegrees(this._data.radius*Math.cos(s),this._data.radius*Math.sin(s),0);e[r++]=h.x,e[r++]=h.y,e[r++]=h.z,t[n++]=s/(2*Math.PI),t[n++]=1;var c=Cesium.Cartesian3.fromDegrees(this._data.radius*Math.cos(a),this._data.radius*Math.sin(a),0);e[r++]=c.x,e[r++]=c.y,e[r++]=c.z,t[n++]=a/(2*Math.PI),t[n++]=1}var u=new Float64Array(e),p=new Float32Array(t);return this._createGeometry(u,p)},t.prototype._createPrimitive=function(){return new Cesium.Primitive({geometryInstances:new Cesium.GeometryInstance({geometry:this._geometry}),appearance:this._appearance,asynchronous:!1,releaseGeometryInstances:!1})},t.prototype.clear=function(){this._map.clock.onTick.removeEventListener(this._listenerFun),this._map.scene.primitives.remove(this._renderObj),this._map=void 0,this._renderObj=void 0,this._data=void 0,this._currMatrix=void 0,this._appearance=void 0,this._geometry=void 0},t.prototype._updateModelMatrix=function(){var e=Cesium.Cartesian3.fromDegrees(0,0),t=Cesium.Cartesian3.fromDegrees(this._data.position[0],this._data.position[1]),i=Cesium.Cartesian3.angleBetween(e,t),r=new Cesium.Cartesian3(e.y*t.z-e.z*t.y,e.z*t.x-e.x*t.z,e.x*t.y-e.y*t.x),n=Math.sqrt(r.x*r.x+r.y*r.y+r.z*r.z);0==n&&(n=.1);var o=r.x/n,s=r.y/n,a=r.z/n,l=new Cesium.Cartesian3(o,s,a),h=Math.cos(i)+l.x*l.x*(1-Math.cos(i)),c=l.x*l.y*(1-Math.cos(i))-l.z*Math.sin(i),u=l.y*Math.sin(i)+l.x*l.z*(1-Math.cos(i)),p=l.z*Math.sin(i)+l.x*l.y*(1-Math.cos(i)),d=Math.cos(i)+l.y*l.y*(1-Math.cos(i)),m=-l.x*Math.sin(i)+l.y*l.z*(1-Math.cos(i)),f=[h,p,-l.y*Math.sin(i)+l.x*l.z*(1-Math.cos(i)),c,d,l.x*Math.sin(i)+l.y*l.z*(1-Math.cos(i)),u,m,Math.cos(i)+l.z*l.z*(1-Math.cos(i))],g=Cesium.Matrix3.fromArray(f),A=Cesium.Matrix4.fromRotationTranslation(g);this._renderObj.modelMatrix=A},t.prototype.updateAttribute=function(e){new uy;if(this._renderObj&&this._data)switch(e){case"visible":this._renderObj.show=this._data[e];break;case"position":this._updateModelMatrix();break;case"evenColor":case"oddColor":var t=this._appearance.material.uniforms;if(!t)return;t[e]=this.getColor(this._data[e]);break;case"speed":this._data[e]=.01*this._data[e]+.005;break;case"height":case"radius":if(this._renderObj){var i=this._renderObj.show;this._map.clock.onTick.removeEventListener(this._listenerFun),this._map.scene.primitives.remove(this._renderObj),this.init(),this._renderObj.show=i}}},t}(uy);const XE=WE;var JE=new Map;JE.set("point",{position:[0,0],color:"#ff0000",pixelSize:10,outlineWidth:0,outlineColor:"#ff0000",heightReference:"none",distanceDisplayCondition:void 0,scaleByDistance:void 0}),JE.set("billboard",{position:null,scale:1,image:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAsCAMAAAAzZkq9AAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAACkVBMVEUAAADzXWjzXWjzXWjzXWjzXWjzXWjzXWjzXWjzW2bzXWjzXWjzV2PzXWjzXWjzW2bzXWjzV2PyVWDzXWjzV2PzV2PzW2bxR1TzV2PzV2PzXWjxRFHzWmbyT1vxRFHxPUrwN0XwNUPwNUPwNkTwNUPwOkjwOkfxQ1DyTlrwNELyTlrwNkTxRVLwNELxRVLwNUPwNUPxQk/wNELwNUPxRlPwNELwOEbwNELxQk/wNELxQk/wN0XwNELxRVLwNELxO0nwNELxO0nwNkTwNELwNkTwNELxR1TwNELwNELxP0zwNEIAAAAAAAAAAAB9HibtM0EAAAAAAAAAAACYIyzvNEIAAACwJzEAAADEKjYAAAAAAAAAAADyT1vxRVLxPUrwN0XwNUPxRFHwNkPwNELxR1TnMT7VKTbHIzDAHyu9HyvxPEniLjzGIy+9HirBHivEHyvFHyzwOEbuM0HOJjPDHyvGHyzJICzJIC3KIC3LIC3sMkDFIy/xO0nHHyzNJzPLIzD66er//////v7bY2zOLjregYnGJTHMLjruyczbjpTgnqPdgYjlMD3TbXXAIi389fbTLDj89PT11tj55OXIKDTwycvonqTZXGbHKDTAIi7el5y/OUPHUFn++/vwxsnhlZvQPEbSTlnux8rfnaG2Him2HSjRb3bAIy/y1dfmsLT67u/yyMv44+TILDjSanK/Hiq+ICz46Onqub3z2dvUN0P66+zvu7/vur700dPjpKnFOkXWe4LTN0LnQU3HLDjlk5n56+zmkpjjRlHjRVHxPkzPN0L14eL35efwS1fGKze1HCi1HSjuUFzwUl7yTFjkTVjGLDfyU1/pU17XP0rILTm+HyvwOkjyUl7zWWTzXGcAAADCbhQMAAAAXHRSTlMADFeYyOn4JJv0CIj5iSPPMujqCdDRifqbnA30V5rI6/ny+Nbanp5ZCvELlyX7JKOkIfiKDeRRrBXpFk+WCdAk8CVP/lCIA7i5D9YEEh5F7iAyM2j6KXwokycsMMXtcvsAAAABYktHRACIBR1IAAAACXBIWXMAAAsSAAALEgHS3X78AAADCklEQVQ4y22U919SURjGT5ntsrSybE8rW5ZmZrZoWZmG2S6QhwYiF0KmiHXbtrOyYcMgo7KybNieUNLScmT/TXcBl/H8dO55vp/3fc+573sI8atT56gu0V27RneJ6tyJhKtb9x5bt22XyeWy7du29ujeLcTu2at3gQJ+KQp69+kp9vvGKOXAjp27dqtUu3ft3AHIlTGiIP36FwLqIg2l1THSUpoiNVDYv58/fewe6Is1BqPJbLFaLWaT0aAp1mNPrBAjboAMJTbKaGJcXhaTkbKVQDYwjgMGlUJvo+x+m0PslE2P0kFcgfFAGWXfu4/mtf+AQJQB8WySwXKoNUbLQdqnQ3wMo0YN+RBCEoYChw0m6xGaPlpeXn6Mpo/zWUyGw8DQBDJMgRNMABY4SVHUqdM+gAlxAophZDhwhjJZWeBsRUXFOX8Eq4k6AwwnI4DzWjMHCLpQWVl5kQHM2kvACDISuKyzcMCVqqqqq9c46DqbQ3cZGElGASqdlQNuVFdX3+QBB5tDpwJGkdEBQJDzVs1tPzCGjAVcQoo7TqfzLk3fq6297+BSuIBxZDzwQCjyYV1d3aPT9OP6+icOrsgHwASSCDwVjvnseUPDC5p++erVawd3zDdAIpk4CW+FixLJwV3UW0yaTEgSSt8xV/0+CPjwkbnqd6VIYn7WlKn4xISgQ8QE+Iyp09j/PR1uD2X/Eux/tVMeN2ZwDZM8E41e6tv3GpG+f6O8jZiZzPfcLCh+eENbzvtDgVlC06akQvbTE9y0np8ypKb42no2Myq/mpoDbd/c9IsZo9mBwUhjpsn9+09Lq6utzdXa8ue3m9lIE03WnHR24NqVfzv+/ev4q2xnv9LnimcvA2HKCJ7eeaH+vJDxzpwf7M/PDH0fFiwU+wsXhb8giyUBX7IkwhNDlgaApZF8smy5z1+xLCJAslby/sqsiPaq1dlrclg/Z0326lXhdu5aqVSatw5Yl8cs1uaGIvlSTuslkvX8Kj8E2MBvSzdulEYG+BR+hafgity0eYtUumXzJnGR/wE7HMK3ftCJggAAAABJRU5ErkJggg==",heightReference:"none",color:"#fff",horizontalOrigin:"center",verticalOrigin:"center",pixelOffset:[0,0],eyeOffset:[0,0,0],rotation:0,width:10,height:10,sizeInMeters:!1,scaleByDistance:null,pixelOffsetScaleByDistance:null,distanceDisplayCondition:null}),JE.set("polygon",{positions:null,height:null,heightReference:"none",extrudedHeight:null,extrudedHeightReference:null,fill:!0,color:"#ff0000",outline:!1,outlineColor:"#ED6F00",outlineWidth:1,stRotation:0,visible:!0,arcType:"geodesic",perPositionHeight:!1,closeTop:!0,closeBotton:!0,distanceDisplayCondition:null,classificationType:"both",zIndex:0}),JE.set("polyline",{positions:null,zIndex:2,clampToGround:!1,visible:!0,name:"polyline",color:"#ff0000",arcType:"none",width:10,distanceDisplayCondition:null,classificationType:"both"}),JE.set("arrowPolyline",{positions:null,visible:!0,name:"arrowPolyline",color:"#ff0000",arcType:"none",clampToGround:!1,width:10,distanceDisplayCondition:null,classificationType:"both",zIndex:0}),JE.set("dashPolyline",{positions:null,visible:!0,name:"dashPolyline",color:"#ff0000",gapColor:"#00ff00",dashLength:16,dashPattern:255,arcType:"none",clampToGround:!1,width:10,distanceDisplayCondition:null,classificationType:"both",zIndex:0}),JE.set("radar",{position:null,visible:!0,outerColor:"#00FF00",outerAlpha:.1,innerColor:"#FFFF00",innerAlhpa:.1,lineColor:"#00FF00",startAngle:0,endAngle:120,vStartAngle:20,vEndAngle:60,radius:3e5,scanAngle:5,scanColor:"#FF0000",scanReserve:!1,scanSpeed:20,showScan:!0}),JE.set("cumulusCloud",{positon:null,scalewithMaxSize:!0,scanX:21,scanY:21,maxScanX:21,maxScanY:12,maxScanZ:20,isRenderSlice:!0,slice:.36,brightness:1}),JE.set("glowPolyline",{positions:null,visible:!0,name:"glowPolyline",glowPower:.25,color:"#00ff00",arcType:"none",clampToGround:!1,width:10,distanceDisplayCondition:null,classificationType:"both",zIndex:0}),JE.set("outlinePolyline",{positions:null,visible:!0,name:"outlinePolyline",color:"#ff0000",outlineColor:"#00ff00",outlineWidth:3,arcType:"none",clampToGround:!1,width:10,distanceDisplayCondition:null,classificationType:"both",zIndex:0}),JE.set("volumePolyline",{positions:null,visible:!0,shape:[[-5e4,-5e4],[5e4,-5e4],[5e4,5e4],[-5e4,5e4]],name:"volumePolyline",cornerType:"mitered",fill:!0,outline:!1,outlineWidth:2,outlineColor:"#ff0000",color:"#00CC99",distanceDisplayCondition:null}),JE.set("wall",{positions:null,visible:!0,name:"wall",maximumHeights:null,minimumHeights:null,fill:!0,outline:!1,outlineWidth:2,outlineColor:"#ff0000",color:"#000000",distanceDisplayCondition:null}),JE.set("model",{name:"model",position:null,scale:1,heading:0,pitch:0,roll:0,url:"",heightReference:"none",color:"#fff",minimumPixelSize:128,maximumScale:2e4,runAnimations:!0,clampAnimations:!0,silhouetteColor:"#def",scaleByDistance:null,silhouetteSize:0,distanceDisplayCondition:null}),JE.set("label",{name:"label",position:null,scale:1,text:"geovis",font:"30px sans-serif",style:"fill",heightReference:"none",fillColor:"#fff",outlineColor:"#ddd",backgroundColor:"#ccc",horizontalOrigin:"center",verticalOrigin:"center",pixelOffset:[0,0],eyeOffset:[0,0,0],showBackground:!1,outlineWidth:1,scaleByDistance:null,pixelOffsetScaleByDistance:null,distanceDisplayCondition:null,translucencyByDistance:null}),JE.set("rectangle",{coordinates:null,height:0,heightReference:"none",extrudedHeight:1,extrudedHeightReference:"none",fill:!0,color:"#ccc",image:null,outline:!1,outlineColor:"#fff",outlineWidth:1,shadows:"disabled",distanceDisplayCondition:null}),JE.set("ellipse",{position:null,semiMinorAxis:1e4,semiMajorAxis:3e4,height:0,heightReference:null,extrudedHeight:1,extrudedHeightReference:null,fill:!0,material:"#ccc",outline:!1,outlineColor:"#fff",outlineWidth:1,numberOfVerticalLines:16,rotation:0,stRotation:0,granularity:"degrees_per_radian",shadows:!1,distanceDisplayCondition:null,classificationType:"both",zIndex:0}),JE.set("circle",{position:null,semiMinorAxis:3e4,semiMajorAxis:3e4,height:0,heightReference:null,extrudedHeight:0,extrudedHeightReference:null,fill:!0,material:"#E9967A",outline:!1,outlineColor:"#fff",outlineWidth:1,numberOfVerticalLines:16,rotation:0,stRotation:0,granularity:"degrees_per_radian",shadows:!1,distanceDisplayCondition:null,classificationType:"both",zIndex:0}),JE.set("ellipsoid",{heightReference:null,position:null,radii:[2e5,2e5,3e5],fill:!0,material:"#FF00FF",outline:!1,outlineColor:"#fff",outlineWidth:1,subdivisions:128,stackPartitions:64,slicePartitions:64,shadows:!1,distanceDisplayCondition:null}),JE.set("sphere",{heightReference:null,position:null,radii:[2e5,2e5,2e5],fill:!0,material:"#FF00FF",outline:!1,outlineColor:"#000",outlineWidth:1,subdivisions:128,stackPartitions:64,slicePartitions:64,shadows:!1,distanceDisplayCondition:null}),JE.set("cylinder",{position:null,length:1,topRadius:2e5,bottomRadius:2e5,heightReference:null,fill:!0,material:"#1E90FF",outline:!1,outlineColor:"#fff",outlineWidth:1,numberOfVerticalLines:16,slices:1128,shadows:!1,distanceDisplayCondition:null}),JE.set("cones",{position:null,length:1,topRadius:0,bottomRadius:2e5,heightReference:null,fill:!0,material:"#1E90FF",outline:!1,outlineColor:"#fff",outlineWidth:1,numberOfVerticalLines:16,slices:1128,shadows:!1,distanceDisplayCondition:null}),JE.set("dynamicRipple",{id:"dynamicRipple",name:"dynamicRipple",position:null,radius:1e4,height:0,heightReference:null,color:"#ccc",outline:!1,outlineColor:"#fff",outlineWidth:1,distanceDisplayCondition:null,classificationType:"both",zIndex:0}),JE.set("sensor",{id:"sensor",name:"sensor",position:null,radius:1e6,color:"rgba(0,255,255,0.4)",xHalfAngle:45,yHalfAngle:45,lineColor:"rgba(0,255,255,1)",showScanPlane:!0,scanPlaneColor:"rgba(0,255,255,1)",scanPlaneMode:"vertical",scanPlaneRate:3}),JE.set("arcPolyline",{positions:null,visible:!0,name:"arcPolyline",color:"#ff0000",width:10}),JE.set("activePolyline",{positions:null,visible:!0,name:"activePolyline",color:"#ff0000",duration:1e3,width:10,image:"arrow"}),JE.set("coneCommunicateWave",{position:null,evenColor:"rgba(106, 90, 205, 1)",oddColor:"rgba(255, 245, 238, 1);",radius:5,speed:.005,height:25e5,slice:240});var KE=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),VE=function(e){function t(t){var i=e.call(this)||this;return i._renderObj=void 0,i._paramJson(t),i}return KE(t,e),t.prototype._paramJson=function(e){e||(e={}),e.id=qh.createGuid(),this.id=e.id,this.name=e.name,this.visible=qh.defaultValue(e.visible,!0);var t=function(e){if(JE.has(e)){var t=JSON.stringify(JE.get(e));return JSON.parse(t)}}(this.type);for(var i in t)e[i]?this[i]=e[i]:this["_".concat(i)]=t[i];this._defaultData=t},t.prototype._update=function(e){this._renderObj&&this._renderObj.updateAttribute(e)},t.prototype.clear=function(){this._renderObj&&(this._renderObj.clear(),this._renderObj=void 0)},Object.defineProperty(t.prototype,"type",{get:function(){return"node"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"visible",{get:function(){return this._visible},set:function(e){this._visible!==e&&(this._visible=e,this._update("visible"))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this._id},set:function(e){this._id=e,this._update("visible")},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this._name},set:function(e){this._name=e,this._update("visible")},enumerable:!1,configurable:!0}),t.prototype.toJson=function(){var e={};for(var t in this._defaultData)this[t]!==this._defaultData[t]&&(e[t]=this[t]);return e.id=this.id,e.name=this.name,e.visible=this.visible,e.type=this.type,e},t}(p);const qE=VE;var $E=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}();const eT=function(e){function t(t){return e.call(this,t)||this}return $E(t,e),Object.defineProperty(t.prototype,"type",{get:function(){return"coneCommunicateWave"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"evenColor",{get:function(){return this._evenColor},set:function(e){e=Pt.checkColor(e,this._evenColor),this._evenColor!==e&&(this._evenColor=e,this._update("evenColor"))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"oddColor",{get:function(){return this._oddColor},set:function(e){e=Pt.checkColor(e,this._oddColor),this._oddColor!==e&&(this._oddColor=e,this._update("oddColor"))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"slice",{get:function(){return this._slice},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"speed",{get:function(){return this._speed},set:function(e){e=Pt.checkNumber(e,this._speed),this._speed!==e&&(this._speed=e,this._update("speed"))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"position",{get:function(){return this._position},set:function(e){e.length<2||this._position==e||(this._position=e,this._update("position"))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"radius",{get:function(){return this._radius},set:function(e){e=Pt.checkNumber(e,this._radius),this._radius!==e&&(this._radius=e,this._update("radius"))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._height},set:function(e){e=Pt.checkNumber(e,this._height),this._height!==e&&(this._height=e,this._update("height"))},enumerable:!1,configurable:!0}),t}(qE);var tT=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),iT=function(){return iT=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},iT.apply(this,arguments)},rT=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},nT=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},oT=function(e){function t(t,i,r){var n=e.call(this,t,i,iT({},r))||this;if(n.maxPointNum=1,n.minPointNum=1,n.support2D=!1,n.type="锥形波",n.alpha=1,n.oddColor="#000000",n.oddAlpha=0,n.evenColor="#FF00FF",n.evenAlpha=1,n.speed=.005,n.radius=5,r&&r.properties)for(var o in r.properties)n[o]=r.properties[o];return n}return tT(t,e),t.prototype.setPrimitivePosition=function(e){var t=zy.getLongitudeByCartesian3(e,this.viewer),i=zy.getLatitudeByCartesian3(e,this.viewer),r=zy.getHeightByCartesian3(e,this.viewer);this.data.position=[t,i],this.sensor.updateAttribute("position");var n=this.data.height-r;Math.abs(n)>1&&(this.data.height=r,this.sensor.updateAttribute("height")),this.setInternalControlPosition([e])},Object.defineProperty(t.prototype,"alpha",{get:function(){return this._alpha},set:function(e){this._alpha=e,this.onPropertyChanged("alpha"),this.onPropertyChanged("oddColor"),this.onPropertyChanged("evenColor")},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"oddColor",{get:function(){return this._oddColor},set:function(e){this._oddColor=e,this.onPropertyChanged("oddColor")},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"oddAlpha",{get:function(){return this._oddAlpha},set:function(e){this._oddAlpha=e,this.onPropertyChanged("oddAlpha")},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"evenColor",{get:function(){return this._evenColor},set:function(e){this._evenColor=e,this.onPropertyChanged("evenColor")},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"evenAlpha",{get:function(){return this._evenAlpha},set:function(e){this._evenAlpha=e,this.onPropertyChanged("evenAlpha")},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"speed",{get:function(){return this._speed},set:function(e){this._speed=e,this.onPropertyChanged("speed")},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"radius",{get:function(){return this._radius},set:function(e){this._radius=e,this.onPropertyChanged("radius")},enumerable:!1,configurable:!0}),t.prototype.initProps=function(e){},t.prototype.getColorWidthAlpha=function(e,t){var i=Cesium.Color.fromCssColorString(e);return"rgba(".concat(255*i.red,",").concat(255*i.green,",").concat(255*i.blue,",").concat(t,")")},t.prototype.initShape=function(){var e=this;this.data=new eT({position:[123,23],oddColor:this.getColorWidthAlpha(this.oddColor,this.oddAlpha),evenColor:this.getColorWidthAlpha(this.evenColor,this.evenAlpha),radius:this.radius,height:10,speed:this.speed}),this.sensor=new XE(this.viewer,this.data),this.propertyChanged.addEventListener((function(t){"show"==t?e.sensor._renderObj.show=e.show:"oddColor"==t||"oddAlpha"==t?(e.data.oddColor=e.getColorWidthAlpha(e.oddColor,e.oddAlpha*e.alpha),e.sensor.updateAttribute("oddColor")):"evenAlpha"==t||"evenColor"==t?(e.data.evenColor=e.getColorWidthAlpha(e.evenColor,e.evenAlpha*e.alpha),e.sensor.updateAttribute("evenColor")):(e.data[t]=e[t],e.sensor.updateAttribute(t))})),this.ent=this.sensor,this.fillShape(this.ent),this.positionProperty=function(){var t=$A.cursor.position.getValue(Cesium.JulianDate.now());t&&e.setPrimitivePosition(t)}},t.prototype.calcuteShape=function(e,t){},t.prototype.toEdit=function(){var t=this;e.prototype.toEdit.call(this),this.positionProperty=function(){var e=t._singleControlPosition[0];t.setPrimitivePosition(e)}},t.prototype.finish=function(){if(this.show=!0,this.ent){e.prototype.finish.call(this);var t=this._singleControlPosition[0];this.positionProperty=t}},rT([(0,fy.o)(),nT("design:type",XE)],t.prototype,"sensor",void 0),rT([dy({name:"透明度",group:"外观",order:8,type:"slider",max:1,min:0}),nT("design:type",Number),nT("design:paramtypes",[Number])],t.prototype,"alpha",null),rT([dy({name:"颜色1",group:"外观",subGroup:"颜色1",subOrder:1,order:8,type:"color2"}),nT("design:type",String),nT("design:paramtypes",[String])],t.prototype,"oddColor",null),rT([dy({name:"颜色1透明度",group:"外观",subGroup:"颜色1",subOrder:2,order:8,type:"slider",max:1,min:0}),nT("design:type",Number),nT("design:paramtypes",[Number])],t.prototype,"oddAlpha",null),rT([dy({name:"颜色2",group:"外观",subGroup:"颜色2",subOrder:3,order:8,type:"color2"}),nT("design:type",String),nT("design:paramtypes",[String])],t.prototype,"evenColor",null),rT([dy({name:"颜色2透明度",group:"外观",subGroup:"颜色2",subOrder:4,order:8,type:"slider",max:1,min:0}),nT("design:type",Number),nT("design:paramtypes",[Number])],t.prototype,"evenAlpha",null),rT([dy({name:"速率",group:"外观",order:8,type:"number",min:0}),nT("design:type",Number),nT("design:paramtypes",[Number])],t.prototype,"speed",null),rT([dy({name:"角度",group:"外观",order:8,type:"numberNew",min:0,max:45}),nT("design:type",Number),nT("design:paramtypes",[Number])],t.prototype,"radius",null),t}(UP);const sT=oT;c.Z.registerType(oT,"EditorCommunicateWave","Graph");var aT=i(5108),lT=function(){function e(e,t,i,r){var n=new hT;for(var o in r)n[o]=r[o];this._position=new A(t,i),this._cloudOption=n,this.viewer=e,this.createPrimitive();Date.now();this.render=function(){},this.viewer.scene.postRender.addEventListener(this.render)}return Object.defineProperty(e.prototype,"position",{get:function(){return this._position},set:function(e){this._position=e,this.updateModelMatrix()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cloudOption",{get:function(){return this._cloudOption},set:function(e){for(var t in e)this._cloudOption[t]=e[t]},enumerable:!1,configurable:!0}),e.prototype.updateModelMatrix=function(){this.cloud.position=Cesium.Cartesian3.fromDegrees(this.position.lon,this.position.lat,this.position.alt)},e.prototype.createPrimitive=function(){if(!this.primitive){this.primitive=new Cesium.PrimitiveCollection({destroyPrimitives:!1}),this.primitiveClouds=new Cesium.CloudCollection({noiseDetail:16,noiseOffset:0});var e=Cesium.Cartesian3.fromDegrees(this.position.lon,this.position.lat,this.position.alt);this.cloud=this.primitiveClouds.add({position:e,scale:new Cesium.Cartesian2(this.cloudOption.scaleX,this.cloudOption.scaleY),maximumSize:new Cesium.Cartesian3(this.cloudOption.maximumSizeX,this.cloudOption.maximumSizeY,this.cloudOption.maximumSizeZ),slice:this.cloudOption.renderSlice?this.cloudOption.slice:-1,brightness:this.cloudOption.brightness}),this.primitive.add(this.primitiveClouds)}for(var t=this.primitive,i=0;i<t.length;i++)t.get(i).owner=this.primitive},e.prototype.update=function(){this.primitive.removeAll(),this.createPrimitive()},e.prototype.updatePrimitive=function(){this.cloud&&(this.cloud.scale=new Cesium.Cartesian2(this.cloudOption.scaleX,this.cloudOption.scaleY),this.cloud.maximumSize=new Cesium.Cartesian3(this.cloudOption.maximumSizeX,this.cloudOption.maximumSizeY,this.cloudOption.maximumSizeZ),this.cloudOption.renderSlice?this.cloud.slice=Number(this.cloudOption.slice):this.cloud.slice=-1,this.cloud.brightness=Number(this.cloudOption.brightness),aT.log("***********************************************************************"),aT.log("********************",this.cloud.scale),aT.log("********************",this.cloud.maximumSize),aT.log("********************",this.cloud.slice),aT.log("********************",this.cloud.brightness),aT.log("***********************************************************************"))},e}(),hT=function(){this.scaleWithMaximumSize=!0,this.scaleX=25,this.scaleY=12,this.maximumSizeX=25,this.maximumSizeY=12,this.maximumSizeZ=15,this.renderSlice=!0,this.slice=.36,this.brightness=1},cT=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),uT=function(){return uT=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},uT.apply(this,arguments)},pT=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},dT=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},mT=function(e){function t(t,i,r){var n=e.call(this,t,i,uT({},r))||this;if(n.maxPointNum=1,n.minPointNum=1,n.type="体积云",n.cscaleX=85e3,n.cscaleY=42e3,n.maximumSizeX=25,n.maximumSizeY=12,n.maximumSizeZ=15,n.slice=.36,n.brightness=1,r&&r.properties)for(var o in r.properties)n[o]=r.properties[o];return n}return cT(t,e),t.prototype.setPrimitivePosition=function(e){var t=zy.getLongitudeByCartesian3(e,this.viewer),i=zy.getLatitudeByCartesian3(e,this.viewer),r=zy.getHeightByCartesian3(e,this.viewer);this.cloudItem.position=new A(t,i,r),this.setInternalControlPosition([e])},Object.defineProperty(t.prototype,"cscaleX",{get:function(){return this._cscaleX},set:function(e){this._cscaleX=e,this.updatePrimitive()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cscaleY",{get:function(){return this._cscaleY},set:function(e){this._cscaleY=e,this.updatePrimitive()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maximumSizeX",{get:function(){return this._maximumSizeX},set:function(e){this._maximumSizeX=e,this.updatePrimitive()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maximumSizeY",{get:function(){return this._maximumSizeY},set:function(e){this._maximumSizeY=e,this.updatePrimitive()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maximumSizeZ",{get:function(){return this._maximumSizeZ},set:function(e){this._maximumSizeZ=e,this.updatePrimitive()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"slice",{get:function(){return this._slice},set:function(e){this._slice=e,this.updatePrimitive()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"brightness",{get:function(){return this._brightness},set:function(e){this._brightness=e,this.updatePrimitive()},enumerable:!1,configurable:!0}),t.prototype.updatePrimitive=function(){this.cloudItem&&this.cloudItem.primitive&&(this.cloudItem.cloudOption=this.createOption(),this.cloudItem.updatePrimitive())},t.prototype.createOption=function(){var e=new hT;return e.scaleX=this.cscaleX,e.scaleY=this.cscaleY,e.maximumSizeX=this.maximumSizeX,e.maximumSizeY=this.maximumSizeY,e.maximumSizeZ=this.maximumSizeZ,e.slice=this.slice,e.brightness=this.brightness,e},t.prototype.resetOrientation=function(e){this.headingPR.heading=Cesium.Math.toRadians(this.heading),this.headingPR.pitch=Cesium.Math.toRadians(this.pitch),this.headingPR.roll=Cesium.Math.toRadians(this.roll);var t=e||this.ent.position.getValue(Cesium.JulianDate.now());this.orientation=Cesium.Transforms.headingPitchRollQuaternion(t,this.headingPR)},t.prototype.initShape=function(){this.cloudItem=new lT(this.viewer,0,0,this.createOption()),this.ent=this.cloudItem.primitive,this.ent.show=!1,this.fillShape(this.ent),this.viewer.scene.primitives.add(this.ent)},t.prototype.toEdit=function(){var t=this;e.prototype.toEdit.call(this),this.positionProperty=function(){var e=t._singleControlPosition[0];t.setPrimitivePosition(e),t.ent.show=t.show}},t.prototype.finish=function(){if(this.ent){e.prototype.finish.call(this);var t=this._singleControlPosition[0];this.positionProperty=t}},pT([(0,fy.o)(),dT("design:type",lT)],t.prototype,"cloudItem",void 0),pT([dy({name:"朝向",group:"外观",order:8,subGroup:"朝向",subOrder:9,type:"numberNew",min:-360,max:360}),dT("design:type",Number)],t.prototype,"heading",void 0),pT([dy({name:"俯仰",group:"外观",order:8,subGroup:"俯仰",subOrder:10,type:"numberNew",min:-360,max:360}),dT("design:type",Number)],t.prototype,"pitch",void 0),pT([dy({name:"倾斜",group:"外观",order:8,subGroup:"倾斜",subOrder:11,type:"numberNew",min:-360,max:360}),dT("design:type",Number)],t.prototype,"roll",void 0),pT([dy({name:"沿X轴缩放",group:"外观",type:"sliderCloud",order:8,subGroup:"沿X轴缩放",hiddenGroupName:!1}),dT("design:type",Number),dT("design:paramtypes",[Number])],t.prototype,"cscaleX",null),pT([dy({name:"沿Y轴缩放",group:"外观",type:"sliderCloud",order:8,subGroup:"沿Y轴缩放",hiddenGroupName:!1}),dT("design:type",Number),dT("design:paramtypes",[Number])],t.prototype,"cscaleY",null),pT([dy({name:"X轴最大缩放范围",group:"外观",type:"sliderCloudXYZ",order:8,subGroup:"X最大缩放",hiddenGroupName:!1}),dT("design:type",Number),dT("design:paramtypes",[Number])],t.prototype,"maximumSizeX",null),pT([dy({name:"Y轴最大缩放范围",group:"外观",type:"sliderCloudXYZ",order:8,subGroup:"Y最大缩放",hiddenGroupName:!1}),dT("design:type",Number),dT("design:paramtypes",[Number])],t.prototype,"maximumSizeY",null),pT([dy({name:"Z轴最大缩放范围",group:"外观",type:"sliderCloudXYZ",order:8,subGroup:"Z最大缩放",hiddenGroupName:!1}),dT("design:type",Number),dT("design:paramtypes",[Number])],t.prototype,"maximumSizeZ",null),pT([dy({name:"片大小",group:"外观",subGroup:"片大小",order:8,type:"slider",max:1,min:0}),dT("design:type",Number),dT("design:paramtypes",[Number])],t.prototype,"slice",null),pT([dy({name:"粗细",group:"外观",subGroup:"粗细",order:8,type:"slider",max:1,min:0}),dT("design:type",Number),dT("design:paramtypes",[Number])],t.prototype,"brightness",null),t}(UP);const fT=mT;c.Z.registerType(mT,"EditorCloud","Graph");var gT=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),AT=function(){return AT=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},AT.apply(this,arguments)},yT=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},vT=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},CT=function(e){function t(t,i,r){var n=e.call(this,t,i,AT({},r))||this;if(n.scaleZProperty=["z"],n.scaleXProperty=["x"],n.scaleYProperty=["y"],n.scaleProperty=["x","y","z"],n.type="球体",n.x=100*n.numScale,n.y=100*n.numScale,n.z=100*n.numScale,r&&r.properties)for(var o in r.properties)n[o]=r.properties[o];return n}return gT(t,e),t.prototype.initProps=function(e){},t.prototype.initShape=function(){var t=this;"invalid"==Pt.CheckIsColor(this.color)&&(this.color="#E3C42E"),e.prototype.initShapeCube.call(this,"ellipsoid",[{radii:new Cesium.CallbackProperty((function(e,i){return new Cesium.Cartesian3(t.x,t.y,t.z)}),!1)}])},t.prototype.scaleZ=function(e,t){this.z+=10*this.calcMouseDelta(e,t)},t.prototype.scaleX=function(e,t){this.x+=10*this.calcMouseDelta(e,t)},t.prototype.scaleY=function(e,t){this.y+=10*this.calcMouseDelta(e,t)},t.prototype.scale=function(e,t){if(this.scalable){var i=10*this.calcMouseDelta(e,t);this.x=this.x+=i,this.y=this.y+=i,this.z=this.z+=i}},yT([dy({name:"长",group:"外观",order:8,subOrder:4,type:"numberNew",min:0}),vT("design:type",Number)],t.prototype,"x",void 0),yT([dy({name:"宽",group:"外观",order:8,subOrder:5,type:"numberNew",min:0}),vT("design:type",Number)],t.prototype,"y",void 0),yT([dy({name:"高",group:"外观",order:8,subOrder:6,type:"numberNew",min:0}),vT("design:type",Number)],t.prototype,"z",void 0),t}(LS);const _T=CT;c.Z.registerType(CT,"EditorEllipsoid","Graph");var bT=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),wT=function(){return wT=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},wT.apply(this,arguments)},PT=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},ST=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},xT=function(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],r=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},BT=function(e){function t(t,i,r){var n=e.call(this,t,i,wT({},r))||this;if(n.scaleZProperty=["length"],n.scaleXProperty=["bottomRadius"],n.scaleYProperty=["topRadius"],n.scalePropert=["length","bottomRadius"],n.type="圆锥体",n.length=100*n.numScale,n.topRadius=1*n.numScale,n.bottomRadius=100*n.numScale,r&&r.properties)for(var o in r.properties)n[o]=r.properties[o];return n}return bT(t,e),t.prototype.initProps=function(e){},t.prototype.initShape=function(){var t=this;e.prototype.initShapeCube.call(this,"cylinder",[{length:new Cesium.CallbackProperty((function(e,i){return t.length}),!1),topRadius:new Cesium.CallbackProperty((function(e,i){return t.topRadius}),!1),bottomRadius:new Cesium.CallbackProperty((function(e,i){return t.bottomRadius}),!1)}])},t.prototype.scaleZ=function(e,t){this.length+=10*this.calcMouseDelta(e,t)},t.prototype.scaleX=function(e,t){this.bottomRadius+=10*this.calcMouseDelta(e,t)},t.prototype.scaleY=function(e,t){this.topRadius+=10*this.calcMouseDelta(e,t)},t.prototype.scale=function(e,t){this.scalable&&(this.length+=10*this.calcMouseDelta(e,t),this.bottomRadius+=10*this.calcMouseDelta(e,t))},t.prototype.nearsRestoPoint=function(e){var t,i,r,n,o,s,a,l,h,c,u,p,d,m,f,g=e.ent.position.getValue(Cesium.JulianDate.now()),A=zy.cartesian2lonlat(g),y=A[0],v=A[1],C=(A[2],this.length),_=zy.cartesian2lonlat(this.ent.position.getValue(Cesium.JulianDate.now())),b=_[0],w=_[1],P=_[2]-C/2,S=Number.MAX_VALUE,x=void 0;d=Cesium.Cartesian3.fromDegrees(b,w,P),m=this.bottomRadius;var B,M=zy.cartesian2lonlat(d),E=xt.Xwo(M,m,{units:"meters"}).geometry.coordinates,T=[];try{for(var O=xT(E),L=O.next();!L.done;L=O.next()){var D=L.value;try{for(var I=(r=void 0,xT(D)),R=I.next();!R.done;R=I.next()){var H=R.value;T.push(H[0]),T.push(H[1]),T.push(M[2])}}catch(e){r={error:e}}finally{try{R&&!R.done&&(n=I.return)&&n.call(I)}finally{if(r)throw r.error}}}}catch(e){t={error:e}}finally{try{L&&!L.done&&(i=O.return)&&i.call(O)}finally{if(t)throw t.error}}try{for(var F=xT(Cesium.Cartesian3.fromDegreesArrayHeights(T)),N=F.next();!N.done;N=F.next()){D=N.value;(V=Cesium.Cartesian3.distance(D,g))<S&&(S=V,x=D)}}catch(e){o={error:e}}finally{try{N&&!N.done&&(s=F.return)&&s.call(F)}finally{if(o)throw o.error}}f=x,d=Cesium.Cartesian3.fromDegrees(b,w,P+C),m=this.topRadius;M=zy.cartesian2lonlat(d),E=xt.Xwo(M,m,{units:"meters"}).geometry.coordinates,T=[];try{for(var Q=xT(E),k=Q.next();!k.done;k=Q.next()){D=k.value;try{for(var U=(h=void 0,xT(D)),j=U.next();!j.done;j=U.next()){H=j.value;T.push(H[0]),T.push(H[1]),T.push(M[2])}}catch(e){h={error:e}}finally{try{j&&!j.done&&(c=U.return)&&c.call(U)}finally{if(h)throw h.error}}}}catch(e){a={error:e}}finally{try{k&&!k.done&&(l=Q.return)&&l.call(Q)}finally{if(a)throw a.error}}var G=Number.MAX_VALUE,z=void 0;try{for(var Y=xT(Cesium.Cartesian3.fromDegreesArrayHeights(T)),Z=Y.next();!Z.done;Z=Y.next()){D=Z.value;(V=Cesium.Cartesian3.distance(D,g))<G&&(G=V,z=D)}}catch(e){u={error:e}}finally{try{Z&&!Z.done&&(p=Y.return)&&p.call(Y)}finally{if(u)throw u.error}}B=z;for(var W=Number.MAX_VALUE,X=void 0,J=new Cesium.LinearSpline({times:[0,1],points:[f,B]}),K=0;K<1e3;K++){var V,q=J.evaluate(K/1e3);(V=Cesium.Cartesian3.distance(q,g))<W&&(W=V,X=q)}var $,ee=y,te=v,ie=P,re=Cesium.Cartesian3.distance(Cesium.Cartesian3.fromDegrees(b,w,P),Cesium.Cartesian3.fromDegrees(ee,te,ie));re<this.bottomRadius&&(($=Cesium.Cartesian3.distance(g,Cesium.Cartesian3.fromDegrees(ee,te,ie)))<W&&(W=$,X=Cesium.Cartesian3.fromDegrees(ee,te,ie)));(ie=P+C,(re=Cesium.Cartesian3.distance(Cesium.Cartesian3.fromDegrees(b,w,P+C),Cesium.Cartesian3.fromDegrees(ee,te,ie)))<this.topRadius)&&(($=Cesium.Cartesian3.distance(g,Cesium.Cartesian3.fromDegrees(ee,te,ie)))<W&&(W=$,X=Cesium.Cartesian3.fromDegrees(ee,te,ie)));return{point:X,length:W}},PT([dy({name:"长",group:"外观",order:8,subOrder:4,type:"numberNew",min:0}),ST("design:type",Number)],t.prototype,"length",void 0),PT([dy({name:"顶部半径",group:"外观",order:8,subOrder:7,type:"numberNew",min:0}),ST("design:type",Number)],t.prototype,"topRadius",void 0),PT([dy({name:"底部半径",group:"外观",order:8,subOrder:8,type:"numberNew",min:0}),ST("design:type",Number)],t.prototype,"bottomRadius",void 0),t}(LS);const MT=BT;c.Z.registerType(BT,"EditorCylinder","Graph");var ET=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),TT=function(){return TT=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},TT.apply(this,arguments)},OT=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},LT=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},DT=function(e){function t(t,i,r){var n=e.call(this,t,i,TT({},r))||this;if(n.maxPointNum=2,n.minPointNum=2,n.radius=0,n.Ea=6378137,n.Eb=6356725,n.hideValues=["interplate","heightReference","allowCrossGround"],n.middleClosed=!1,n.type="扇形",n.startAngle=0,n.endAngle=90,r&&r.properties)for(var o in r.properties)n[o]=r.properties[o];return n}return ET(t,e),t.prototype.finish=function(){if(0==this.radius)e.prototype.finish.call(this);else if(this._singleControlPosition&&this._singleControlPosition.length>0){var t=this._singleControlPosition.map((function(e){return zy.cartesian2turfPoint(e)})),i=xt.Xwo(t[0],this.radius,{units:"meters"}),r=zy.turfGeometry2Cartesians(i);this._singleControlPosition.push(r[0]),e.prototype.finish.call(this)}},t.prototype.calcuteShape=function(e,t){if(e.length<this.minPointNum)return[];var i=e.map((function(e){return zy.cartesian2turfPoint(e)})),r=xt.TE$(i[0],i[1],{units:"meters"});r|=1;var n=xt.Q$S(i[0],r/1e3,this.startAngle,this.endAngle),o=zy.turfGeometry2Cartesians(n);return this.setInternalControlPosition(e,t),o},OT([dy({name:"起始角度",group:"外观",order:8,type:"number"}),LT("design:type",Number)],t.prototype,"startAngle",void 0),OT([dy({name:"终止角度",group:"外观",order:8,type:"number",min:1,max:360}),LT("design:type",Number)],t.prototype,"endAngle",void 0),t}(mS);const IT=DT;c.Z.registerType(DT,"EditorSector","Graph");var RT=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),HT=function(){return HT=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},HT.apply(this,arguments)},FT=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},NT=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},QT=function(e){function t(t,i,r){var n=e.call(this,t,i,HT({},r))||this;if(n.maxPointNum=1,n.minPointNum=1,n.scaleProperty=["radius"],n.type="点弧线",n.startAngle=0,n.endAngle=90,n.radius=100,r&&r.properties)for(var o in r.properties)n[o]=r.properties[o];return n}return RT(t,e),t.prototype.initProps=function(e){},t.prototype.scale=function(e,t){this.radius=this.changeScaleByMouse(this.radius,e,t)},t.prototype.calcuteShape=function(e,t){if(e.length<this.minPointNum)return[];var i=0,r=e.map((function(e){var t=zy.cartesian2lonlat(e);return i=t[2],xt.xmu(t)})),n=this.radius,o=xt.cA_(r[0],n,this.startAngle,this.endAngle).geometry.coordinates.map((function(e){return zy.lonlat2Cartesian(e,i)}));return this.setInternalControlPosition(e,t),o},FT([dy({name:"起始角",group:"外观",order:8,subGroup:"角",subOrder:1,type:"number2",min:0,max:360}),NT("design:type",Number)],t.prototype,"startAngle",void 0),FT([dy({name:"终止角",group:"外观",order:8,subGroup:"角",subOrder:2,type:"number2",min:0,max:360}),NT("design:type",Number)],t.prototype,"endAngle",void 0),FT([dy({name:"半径(KM)",group:"外观",order:8,type:"numberNew",min:1}),NT("design:type",Number)],t.prototype,"radius",void 0),t}(lM);const kT=QT;c.Z.registerType(QT,"EditorPointArc","Graph");var UT=i(5108),jT=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),GT=function(){return GT=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},GT.apply(this,arguments)},zT=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},YT=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},ZT=function(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],r=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},WT=function(e){function t(t,i,r){var n=e.call(this,t,i,GT({},r))||this;if(n.showFacade=!1,n.facadeHeight=0,n.minPointNum=3,n._colorShow=!0,n._outline=!0,n.type="多边形01",n.color="#00FF00",n._width=1,n._outlineColor="#ff0000",n.rotation=0,n.material="",n.alpha=.8,n.effect="",n.showFacade=!1,n.percentAngle=360,n.moveHeight=null,r&&r.properties)for(var o in r.properties)n[o]=r.properties[o];return n}return jT(t,e),Object.defineProperty(t.prototype,"effect",{get:function(){return this._effect},set:function(e){this._effect=e,this.onPropertyChanged("effect")},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"percentAngle",{get:function(){return this._percentAngle},set:function(e){this._percentAngle=e,this.ent&&(this.ent.appearance.material.uniforms.percentAngle=e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"colorShow",{get:function(){return this._colorShow},set:function(e){this._colorShow=e,this.ent.show=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"outline",{get:function(){return this._outline},set:function(e){this._outline=e,this.pLine&&(this.pLine.show=e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this._width},set:function(e){this._width=e,this.outline&&(this.reDrawEdge(),this.setOutlineColor(this.pLine.appearance.material))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"outlineColor",{get:function(){return this._outlineColor},set:function(e){this._outlineColor=e,this.pLine&&this.setOutlineColor(this.pLine.appearance.material)},enumerable:!1,configurable:!0}),t.prototype.setOutlineColor=function(e){e.uniforms.color=Cesium.Color.fromCssColorString(this.outlineColor).withAlpha(this.alpha)},t.prototype.reDrawEdge=function(){this.pLine&&(this.primtiveCollection.remove(this.pLine),this.pLine=null),this.pLine=this.createEdge(this._singleControlPosition),this.fillShape(this.pLine),this.primtiveCollection.add(this.pLine,this.level)},t.prototype.createEdge=function(e){!1===this.show&&(this.outline=!1);var t=new Cesium.GroundPolylineGeometry({positions:e,width:this.width}),i=new Cesium.GeometryInstance({geometry:t,id:this.id}),r=Cesium.Material.fromType("Color",{color:this.outlineColor});return this.setOutlineColor(r),new Cesium.GroundPolylinePrimitive({geometryInstances:i,appearance:new Cesium.PolylineMaterialAppearance({material:r,translucent:!0}),vertexCacheOptimize:!0,interleave:!1,compressVertices:!0,releaseGeometryInstances:!0,asynchronous:!1,allowPicking:!0,show:this.outline})},t.prototype.setPrimitivePosition=function(e){e[0]||(e=e.slice(1)),this.setInternalControlPosition(e),this.createEnt(e)},t.prototype.initProps=function(e){},t.prototype.initShape=function(){this.primtiveCollection=new Cesium.PrimitiveCollection,this.ent={},this.createEnt(this._singleControlPosition),this.fillShape(this.ent),this.viewer.scene.orderGroundPrimitives.add(this.primtiveCollection,this.level)},t.prototype.createEnt=function(e){if(UT.log("画一个单面"),!ty.Cartesian3ArrayEqual(this.last_pos,e)&&(this.last_pos=e,e&&!(e.length<=1))){var t=this.showFacade?this.facadeHeight:0;this.p&&this.primtiveCollection.remove(this.p),this.pLine&&this.primtiveCollection.remove(this.pLine);var i=new Cesium.PolygonHierarchy(e),r=new Cesium.PolygonGeometry({polygonHierarchy:i,extrudedHeight:0,height:t,vertexFormat:Cesium.EllipsoidSurfaceAppearance.VERTEX_FORMAT}),n=new Cesium.GeometryInstance({geometry:r,id:this.id});this.createMaterial();var o=Cesium.Material.fromType("Color");this.setColor(o);var s={geometryInstances:n,appearance:new Cesium.EllipsoidSurfaceAppearance({material:this.internalMaterial,flat:!0,translucent:!0,aboveGround:!0}),vertexCacheOptimize:!0,interleave:!1,compressVertices:!0,releaseGeometryInstances:!0,asynchronous:!1,allowPicking:!0,show:this.colorShow};this.p=this.showFacade?new Cesium.Primitive(s):new Cesium.GroundPrimitive(s),this.pLine=this.createEdge(i.positions),UT.log("十三五",this.pLine),this.primtiveCollection.add(this.p,this.level),this.primtiveCollection.add(this.pLine,this.level),this.fillShape(this.p),this.fillShape(this.pLine),this.ent=this.p,this.entArr=[this.p,this.pLine]}},t.prototype.calcuteShape=function(e,t){if(e.length<this.minPointNum)return[];return this.setInternalControlPosition(e,t),e},t.prototype.createMaterial=function(){var e={type:"InterMaterial",uniforms:{repeat:new Cesium.Cartesian2(1,1),color:new Cesium.Color(1,1,1,1),percentAngle:360,time:1},source:"\n      czm_material czm_getMaterial(czm_materialInput materialInput)\n      {\n          czm_material material = czm_getDefaultMaterial(materialInput);\n          //float dis = distance(materialInput.st, vec2(0.5, 0.5));\n          material.diffuse =color.rgb; \n          material.alpha=color.a;\n          float a = atan( materialInput.st.y-0.5, materialInput.st.x-0.5 );\n          float ang = degrees(a)+180.0+90.0;\n          if(ang<0.0){\n            ang=ang+360.0;\n          }\n          if(ang> 360.0){\n            ang = ang-360.0;\n          }\n          float angle=percentAngle;\n          if(angle>360.0){\n            angle=angle-360.0;\n          }\n          if(ang < 360.0 - angle){\n            material.alpha=0.0;\n          }\n          //material.alpha=1.0-mix(0.0,2.0,dis);\n          //material.alpha= material.alpha*time;\n          // if(material.alpha<0.1){\n          //   material.alpha=0.0;\n          // }\n          return material;\n      }"};this.internalMaterial=new Cesium.Material({fabric:e}),this.setColor(this.internalMaterial)},t.prototype.flashPrimitive=function(){this.p.show=!this.p.show},t.prototype.toGeoJsonGeometry=function(){var e,t,i={type:"Polygon",coordinates:[[]]};try{for(var r=ZT(this.ctrlPosition),n=r.next();!n.done;n=r.next()){var o=n.value;i.coordinates[0].push([o.lon,o.lat,o.alt])}}catch(t){e={error:t}}finally{try{n&&!n.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}return i},zT([dy({name:"动态纹理",group:"外观",order:8,type:"option",options:[{label:"波纹",value:"wave"},{label:"无",value:""}]}),YT("design:type",String),YT("design:paramtypes",[String])],t.prototype,"effect",null),zT([dy({name:"旋转",group:"外观",order:8,type:"numberNew",hidden:!0}),YT("design:type",Number)],t.prototype,"rotation",void 0),zT([dy({name:"纹理",group:"外观",order:8,type:"string",hidden:!0}),YT("design:type",String)],t.prototype,"material",void 0),zT([(0,fy.o)(),YT("design:type",Object)],t.prototype,"last_pos",void 0),zT([(0,fy.o)(),YT("design:type",Cesium.Material)],t.prototype,"internalMaterial",void 0),zT([dy({name:"显示角度",group:"外观",type:"angle",order:8,min:-360,max:360,hiddenGroupName:!1}),YT("design:type",Number),YT("design:paramtypes",[Number])],t.prototype,"percentAngle",null),zT([dy({name:"是否填充",group:"外观",subGroup:"填充",type:"checkboxSub",order:8,subOrder:1}),YT("design:type",Boolean),YT("design:paramtypes",[Boolean])],t.prototype,"colorShow",null),zT([dy({name:"边框",group:"外观",order:8,subGroup:"边框",subOrder:4,type:"checkboxSub"}),YT("design:type",Boolean),YT("design:paramtypes",[Boolean])],t.prototype,"outline",null),zT([dy({name:"线宽",group:"外观",type:"number",order:8,min:1,max:200}),YT("design:type",Number),YT("design:paramtypes",[Number])],t.prototype,"width",null),zT([dy({name:"边框颜色",group:"外观",order:8,subGroup:"边框",subOrder:5,type:"color"}),YT("design:type",String),YT("design:paramtypes",[String])],t.prototype,"outlineColor",null),t}(ZP);const XT=WT;c.Z.registerType(WT,"EditorGeometryPolygon","Graph");var JT=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),KT=function(){return KT=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},KT.apply(this,arguments)},VT=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},qT=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const $T=function(e){function t(t,i,r){var n=e.call(this,t,i,KT({},r))||this;return n.percent=1,n.percentStart=0,n}return JT(t,e),t.prototype.flashPrimitive=function(){throw new Error("flashPrimitive Method not implemented.")},t.prototype.setPrimitivePosition=function(e){throw new Error(" setPrimitivePosition Method not implemented.")},Object.defineProperty(t.prototype,"percent",{get:function(){return this._percent},set:function(e){this._percent=e,this.p&&(this.p.appearance.material.uniforms.percent=e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"percentStart",{get:function(){return this._percentStart},set:function(e){this._percentStart=e,this.p&&(this.p.appearance.material.uniforms.percentStart=e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"percentRange",{get:function(){return this._percentRange||(this._percentRange=[0,1]),this._percentRange.length=0,this._percentRange.push(this.percentStart),this._percentRange.push(this.percent),this._percentRange},set:function(e){this._percentRange=e,this.percentStart=e[0],this.percent=e[1]},enumerable:!1,configurable:!0}),t.prototype.createSimpleMaterial=function(){var e={uniforms:{percent:1,percentStart:0,color:new Cesium.Color(0,1,1,1)},source:"\n          czm_material czm_getMaterial(czm_materialInput materialInput)\n          {\n              czm_material material = czm_getDefaultMaterial(materialInput);\n              float dis = distance(materialInput.st, vec2(1.0, materialInput.st.y));\n              //vec2 st = materialInput.st;\n              if(percent<0.0){\n                if(dis >1.0 -  abs(percent)){\n                  material.alpha=0.0;\n                }\n                else{\n                  material.alpha=1.0;\n                }\n              }\n              else{\n                if(dis < 1.0-percent || dis > 1.0 - percentStart){\n                  material.alpha=0.0;\n                }\n                else{\n                  material.alpha=1.0;\n                }\n              }\n              material.diffuse = color.rgb;\n              material.alpha=color.a* material.alpha;\n              // float glow = glowPower / abs(st.t - 0.5) - (glowPower / 0.5);\n    \n              // material.emission = max(vec3(glow - 1.0 + color.rgb), color.rgb);\n              // material.alpha = clamp(0.0, 1.0, glow) * color.a * st.s;\n    \n              //material.emission =  color.rgb;\n              //material.alpha =  color.a;\n    \n              return material;\n          }"};return new Cesium.Material({fabric:e})},t.prototype.getBoundingRectangle=function(){return this.ctrlPosition.length>0?Cesium.Rectangle.fromCartesianArray(this.ctrlPosition.map((function(e){return Cesium.Cartesian3.fromDegrees(e.lon,e.lat)}))):Cesium.Rectangle.fromCartesianArray(this._singleControlPosition)},VT([(0,fy.o)(),qT("design:type",Array)],t.prototype,"_percentRange",void 0),VT([dy({name:"百分比",group:"外观",type:"percentSlider",order:8}),qT("design:type",Object),qT("design:paramtypes",[Object])],t.prototype,"percentRange",null),VT([(0,fy.o)(),qT("design:type",Function),qT("design:paramtypes",[]),qT("design:returntype",Cesium.Rectangle)],t.prototype,"getBoundingRectangle",null),t}(ZP);var eO=i(5108),tO=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),iO=function(){return iO=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},iO.apply(this,arguments)},rO=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},nO=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},oO=function(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],r=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},sO=function(e){function t(t,i,r){var n=e.call(this,t,i,iO({},r))||this;if(n.minPointNum=2,n.type="折线1",n._width=1,n.color="#00FF00",n.alpha=.8,n.arcType=1,n.clampToGround=!1,n.moveHeight=null,Object.defineProperty(n,"moveHeight",{configurable:!0,enumerable:!0,get:function(){return n.clampToGround?void 0:n.internalmoveHeight}}),r&&r.properties)for(var o in r.properties)n[o]=r.properties[o];return n}return tO(t,e),t.prototype.setPrimitivePosition=function(e){e[0]||(e=e.slice(1)),this.setInternalControlPosition(e),this.createEnt(e)},Object.defineProperty(t.prototype,"width",{get:function(){return this._width},set:function(e){this._width=e,this.redrawLine()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"clampToGround",{get:function(){return this._clampToGround},set:function(e){this._clampToGround=e,this.redraw()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"arcType",{get:function(){return this._arcType},set:function(e){"string"==typeof e&&(e=Number.parseInt(e)),this.clampToGround&&0==e?this.arcType=this.arcType:this._arcType=e},enumerable:!1,configurable:!0}),t.prototype.internalmoveHeight=function(e,t){var i,r,n=this.getCenter(),o=zy.getHeightByCartesian3(n,this.viewer),s=this.ChangeLengthByMouse(o,t.y-e.y,1),a=[];try{for(var l=oO(this._singleControlPosition),h=l.next();!h.done;h=l.next()){var c=h.value,u=zy.getHeightByCartesian3(c,this.viewer)-o+s;u<0&&(u=0),a.push(zy.getHeightdefineByXYZ(c,u,this.viewer))}}catch(e){i={error:e}}finally{try{h&&!h.done&&(r=l.return)&&r.call(l)}finally{if(i)throw i.error}}this._singleControlPosition=a,this.onPropertyChanged()},t.prototype.initProps=function(e){},t.prototype.initShape=function(){eO.log("init>>>>>"),this.primtiveCollection=new Cesium.PrimitiveCollection,this.ent={},this.createEnt(this._singleControlPosition),this.fillShape(this.ent),this.viewer.scene.orderGroundPrimitives.add(this.primtiveCollection,this.level)},t.prototype.createEnt=function(e){if(!ty.Cartesian3ArrayEqual(this.last_pos,e)&&(this.last_pos=e,e&&!(e.length<=1))){if(this.p&&this.primtiveCollection.remove(this.p),this.clampToGround){var t=new Cesium.GroundPolylineGeometry({positions:e,width:this.width,arcType:this.arcType}),i=new Cesium.GeometryInstance({geometry:t,id:this.id});(r=this.createSimpleMaterial()).uniforms.percent=this.percent,r.uniforms.percentStart=this.percentStart,this.setColor(r),this.p=new Cesium.GroundPolylinePrimitive({geometryInstances:i,appearance:new Cesium.PolylineMaterialAppearance({material:r,translucent:!0}),vertexCacheOptimize:!0,interleave:!1,compressVertices:!0,releaseGeometryInstances:!0,asynchronous:!1,allowPicking:!0,show:!0})}else{var r;t=new Cesium.PolylineGeometry({positions:e,width:this.width,arcType:this.arcType}),i=new Cesium.GeometryInstance({geometry:t,id:this.id});(r=this.createSimpleMaterial()).uniforms.percent=this.percent,r.uniforms.percentStart=this.percentStart,this.setColor(r),this.p=new Cesium.Primitive({geometryInstances:i,appearance:new Cesium.PolylineMaterialAppearance({material:r,translucent:!0}),vertexCacheOptimize:!0,interleave:!1,compressVertices:!0,releaseGeometryInstances:!0,asynchronous:!1,allowPicking:!0,show:!0})}this.fillShape(this.p),this.ent=this.p,this.primtiveCollection.add(this.p,this.level)}},t.prototype.calcuteShape=function(e,t){if(e.length<this.minPointNum)return[];return this.setInternalControlPosition(e,t),e},t.prototype.flashPrimitive=function(){this.p.show=!this.p.show},t.prototype.toGeoJsonGeometry=function(){var e,t,i={type:"LineString",coordinates:[]};try{for(var r=oO(this.ctrlPosition),n=r.next();!n.done;n=r.next()){var o=n.value;i.coordinates.push([o.lon,o.lat,o.alt])}}catch(t){e={error:t}}finally{try{n&&!n.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}return i},t.prototype.redraw=function(){this.p&&(this.last_pos=null,this.createEnt(this._singleControlPosition))},t.prototype.redrawLine=function(){this.p&&(this.last_pos=null,this.createEnt(this._singleControlPosition))},rO([(0,fy.o)(),dy({name:"线宽",group:"外观",type:"number",order:8,min:1,max:256}),nO("design:type",Number),nO("design:paramtypes",[Number])],t.prototype,"width",null),rO([dy({name:"贴地",group:"外观",type:"boolean",order:8,min:1,max:256}),nO("design:type",Boolean),nO("design:paramtypes",[Boolean])],t.prototype,"clampToGround",null),rO([dy({name:"曲线类型",group:"外观",order:8,type:"option",options:[{label:"大地线",value:1},{label:"直线(贴地无效)",value:0}]}),nO("design:type",Number),nO("design:paramtypes",[Number])],t.prototype,"arcType",null),rO([(0,fy.o)(),nO("design:type",Function),nO("design:paramtypes",[Cesium.Cartesian2,Cesium.Cartesian2]),nO("design:returntype",void 0)],t.prototype,"internalmoveHeight",null),rO([(0,fy.o)(),nO("design:type",Object)],t.prototype,"last_pos",void 0),t}($T);const aO=sO;c.Z.registerType(sO,"EditorGeometryPolyline","Graph");var lO=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),hO=function(){return hO=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},hO.apply(this,arguments)},cO=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},uO=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},pO=function(e){function t(t,i,r){var n=e.call(this,hO({},r),t,i)||this;return n.minPointNum=2,n.type="多边形01",n.color="#00FF00",n.alpha=1,n.moveHeight=null,n}return lO(t,e),t.prototype.setPrimitivePosition=function(e){e&&(e[0]||(e=e.slice(1)),this.setInternalControlPosition(e),this.createEnt(e))},t.prototype.reDraw=function(){this.last_pos=null,this.delete(),this.setPrimitivePosition(this.ctls)},t.prototype.reDrawLine=function(){this.last_pos=null,this.delete(),this.setPrimitivePosition(this.polygonHoles)},t.prototype.initProps=function(e){},t.prototype.initShape=function(){this.primtiveCollection=new Cesium.PrimitiveCollection,this.ent={},this.createEnt([]),this.fillShape(this.ent),this.viewer.scene.orderGroundPrimitives.add(this.primtiveCollection,this.level)},t.prototype.createEnt=function(e){if(!ty.Cartesian3ArrayEqual(this.last_pos,e)){var t=Cesium.Material.fromType("Color");this.setColor(t);var i=this.createPrimitive(this.polygonHoles,t);this.fillShape(i),this.p=i,this.primtiveCollection.add(this.p,this.level),this.last_pos=e,this.ent=this.p}},t.prototype.flashPrimitive=function(){this.p.show=!this.p.show},t.prototype.initCtls=function(){var e=this;this._singleControlPosition=[],this.ctls&&(this.ctrlPosition=this.ctls),this.holes&&this.holes.length>0&&(this.polygonHoles=this.holes.map((function(t){return t.map((function(t){return e.ctrlPosition.push(t),zy.lonlathei2Cartesian(t)}))}))),this.ctrlPosition},cO([(0,fy.o)(),uO("design:type",Object)],t.prototype,"last_pos",void 0),cO([(0,fy.o)(),uO("design:type",Object)],t.prototype,"holes",void 0),cO([(0,fy.o)(),uO("design:type",Function),uO("design:paramtypes",[]),uO("design:returntype",void 0)],t.prototype,"initCtls",null),t}(ZP),dO=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),mO=function(){return mO=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},mO.apply(this,arguments)},fO=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},gO=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},AO=function(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],r=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},yO=function(e){function t(t,i,r){var n=e.call(this,t,i,mO({},r))||this;if(n.type="多边形组",n.distanceDisplay=!1,n.distanceHeight=55e5,r&&r.properties)for(var o in r.properties)n[o]=r.properties[o];return n}return dO(t,e),Object.defineProperty(t.prototype,"distanceDisplay",{get:function(){return this._distanceDisplay},set:function(e){this._distanceDisplay=e,this.ent&&this.reDraw()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"distanceHeight",{get:function(){return this._distanceHeight},set:function(e){this._distanceHeight=e,this.ent&&this.reDraw()},enumerable:!1,configurable:!0}),t.prototype.distanceCondition=function(){return this.distanceDisplay?new Cesium.DistanceDisplayConditionGeometryInstanceAttribute(0,this.distanceHeight):void 0},t.prototype.createPrimitive=function(e,t){var i,r,n=[];if(e)try{for(var o=AO(e),s=o.next();!s.done;s=o.next()){var a=s.value,l=new Cesium.PolygonGeometry({polygonHierarchy:new Cesium.PolygonHierarchy(a),extrudedHeight:0,height:0,vertexFormat:Cesium.EllipsoidSurfaceAppearance.VERTEX_FORMAT}),h=new Cesium.GeometryInstance({geometry:l,attributes:{distanceDisplayCondition:this.distanceCondition()}});n.push(h)}}catch(e){i={error:e}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return new Cesium.GroundPrimitive({geometryInstances:n,appearance:new Cesium.EllipsoidSurfaceAppearance({material:t,flat:!0,faceForward:!1,translucent:!0,aboveGround:!1}),vertexCacheOptimize:!0,interleave:!1,compressVertices:!0,releaseGeometryInstances:!0,asynchronous:!1,allowPicking:!0,show:!0})},t.prototype.toGeoJsonGeometry=function(){var e,t,i={type:"MultiPolygon",coordinates:[]};try{for(var r=AO(this.holes),n=r.next();!n.done;n=r.next()){var o=n.value;i.coordinates.push(o)}}catch(t){e={error:t}}finally{try{n&&!n.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}return i},fO([dy({name:"可视高度",group:"通用",subGroup:"可视高度",subOrder:1,type:"checkboxSub",order:2,hiddenGroupName:!1}),gO("design:type",Boolean),gO("design:paramtypes",[Boolean])],t.prototype,"distanceDisplay",null),fO([dy({name:"可视高度距离",group:"通用",subGroup:"可视高度",subOrder:2,type:"number3",order:2,hiddenGroupName:!1,min:0,max:2e7}),gO("design:type",Number),gO("design:paramtypes",[Number])],t.prototype,"distanceHeight",null),t}(pO);const vO=yO;c.Z.registerType(yO,"EditorGeometryMultiPolygon","Graph");var CO=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),_O=function(){return _O=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},_O.apply(this,arguments)},bO=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},wO=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},PO=function(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],r=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},SO=function(e){function t(t,i,r){var n=e.call(this,t,i,_O({},r))||this;if(n.type="折线组",n._width=4,n.distanceDisplay=!1,n.distanceHeight=55e5,r&&r.properties)for(var o in r.properties)n[o]=r.properties[o];return n}return CO(t,e),Object.defineProperty(t.prototype,"width",{get:function(){return this._width},set:function(e){this._width=e,this.reDrawLine()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"distanceDisplay",{get:function(){return this._distanceDisplay},set:function(e){this._distanceDisplay=e,this.ent&&this.reDraw()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"distanceHeight",{get:function(){return this._distanceHeight},set:function(e){this._distanceHeight=e,this.ent&&this.reDraw()},enumerable:!1,configurable:!0}),t.prototype.distanceCondition=function(){return this.distanceDisplay?new Cesium.DistanceDisplayConditionGeometryInstanceAttribute(0,this.distanceHeight):void 0},t.prototype.createPrimitive=function(e,t){var i,r,n=[];if(e)try{for(var o=PO(e),s=o.next();!s.done;s=o.next()){var a=s.value,l=new Cesium.GroundPolylineGeometry({positions:a,width:this.width}),h=new Cesium.GeometryInstance({geometry:l,id:this.id,attributes:{distanceDisplayCondition:this.distanceCondition()}});n.push(h)}}catch(e){i={error:e}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return new Cesium.GroundPolylinePrimitive({geometryInstances:n,appearance:new Cesium.PolylineMaterialAppearance({material:t,translucent:!0}),vertexCacheOptimize:!0,interleave:!1,compressVertices:!0,releaseGeometryInstances:!0,asynchronous:!1,allowPicking:!0,show:!0})},t.prototype.toGeoJsonGeometry=function(){var e,t,i={type:"MultiLineString",coordinates:[]};try{for(var r=PO(this.holes),n=r.next();!n.done;n=r.next()){var o=n.value;i.coordinates.push(o)}}catch(t){e={error:t}}finally{try{n&&!n.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}return i},bO([dy({name:"线宽",group:"外观",type:"number",order:8,min:1,max:256}),wO("design:type",Number),wO("design:paramtypes",[Number])],t.prototype,"width",null),bO([dy({name:"可视高度",group:"通用",subGroup:"可视高度",subOrder:1,type:"checkboxSub",order:2,hiddenGroupName:!1}),wO("design:type",Boolean),wO("design:paramtypes",[Boolean])],t.prototype,"distanceDisplay",null),bO([dy({name:"可视高度距离",group:"通用",subGroup:"可视高度",subOrder:2,type:"number3",order:2,hiddenGroupName:!1,min:0,max:2e7}),wO("design:type",Number),wO("design:paramtypes",[Number])],t.prototype,"distanceHeight",null),t}(pO);const xO=SO;c.Z.registerType(SO,"EditorGeometryMultiPolyline","Graph");var BO=i(4951),MO=i(5108),EO=function(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],r=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},TO=function(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var r,n,o=i.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){n={error:e}}finally{try{r&&!r.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}return s},OO=function(e,t,i){if(i||2===arguments.length)for(var r,n=0,o=t.length;n<o;n++)!r&&n in t||(r||(r=Array.prototype.slice.call(t,0,n)),r[n]=t[n]);return e.concat(r||Array.prototype.slice.call(t))},LO=i(3614);function DO(e){var t,i,r={Point:[],MultiPoint:[],LineString:[],MultiLineString:[],Polygon:[],MultiPolygon:[]};try{for(var n=EO(e),o=n.next();!o.done;o=n.next()){var s=o.value,a=s.geometry;if(!a)return;r[a.type].push(s)}}catch(e){t={error:e}}finally{try{o&&!o.done&&(i=n.return)&&i.call(n)}finally{if(t)throw t.error}}return r}function IO(e,t){var i=DO(e);return HO(i.MultiLineString.concat(i.LineString),t.MultiLineString),HO(i.MultiPolygon.concat(i.Polygon),t.MultiPolygon),t}function RO(e,t){var i,r,n,o,s,a,l,h,c,u,p,d;t.holes.length=0,t.ctls.length=0;var m=FO(e.geometry.coordinates);if(2===m){var f=[];try{for(var g=EO(e.geometry.coordinates),y=g.next();!y.done;y=g.next()){var v=y.value;f.push(new A(v[0],v[1])),t.ctls.push(new A(v[0],v[1]))}}catch(e){i={error:e}}finally{try{y&&!y.done&&(r=g.return)&&r.call(g)}finally{if(i)throw i.error}}t.holes.push(f)}else if(3===m)try{for(var C=EO(e.geometry.coordinates),_=C.next();!_.done;_=C.next()){v=_.value,f=[];try{for(var b=(s=void 0,EO(v)),w=b.next();!w.done;w=b.next()){var P={lon:(L=w.value)[0],lat:L[1]};f.push(P),t.ctls.push(P)}}catch(e){s={error:e}}finally{try{w&&!w.done&&(a=b.return)&&a.call(b)}finally{if(s)throw s.error}}t.holes.push(f)}}catch(e){n={error:e}}finally{try{_&&!_.done&&(o=C.return)&&o.call(C)}finally{if(n)throw n.error}}else if(4===m)try{for(var S=EO(e.geometry.coordinates),x=S.next();!x.done;x=S.next()){v=x.value;try{for(var B=(c=void 0,EO(v)),M=B.next();!M.done;M=B.next()){var E=M.value;f=[];try{for(var T=(p=void 0,EO(E)),O=T.next();!O.done;O=T.next()){var L;P={lon:(L=O.value)[0],lat:L[1]};f.push(P),t.ctls.push(P)}}catch(e){p={error:e}}finally{try{O&&!O.done&&(d=T.return)&&d.call(T)}finally{if(p)throw p.error}}t.holes.push(f)}}catch(e){c={error:e}}finally{try{M&&!M.done&&(u=B.return)&&u.call(B)}finally{if(c)throw c.error}}}}catch(e){l={error:e}}finally{try{x&&!x.done&&(h=S.return)&&h.call(S)}finally{if(l)throw l.error}}return t}function HO(e,t){var i,r,n,o,s,a,l,h,c,u,p,d,m,f;if(t.holes.length=0,t.ctls.length=0,Array.isArray(e)){try{for(var g=EO(e),y=g.next();!y.done;y=g.next()){var v=y.value,C=FO(v.geometry.coordinates);if(2===C){var _=[];try{for(var b=(n=void 0,EO(v.geometry.coordinates)),w=b.next();!w.done;w=b.next()){var P=w.value;_.push(new A(P[0],P[1])),t.ctls.push(new A(P[0],P[1]))}}catch(e){n={error:e}}finally{try{w&&!w.done&&(o=b.return)&&o.call(b)}finally{if(n)throw n.error}}t.holes.push(_)}else if(3===C)try{for(var S=(s=void 0,EO(v.geometry.coordinates)),x=S.next();!x.done;x=S.next()){P=x.value,_=[];try{for(var B=(l=void 0,EO(P)),M=B.next();!M.done;M=B.next()){var E={lon:(F=M.value)[0],lat:F[1]};_.push(E),t.ctls.push(E)}}catch(e){l={error:e}}finally{try{M&&!M.done&&(h=B.return)&&h.call(B)}finally{if(l)throw l.error}}t.holes.push(_)}}catch(e){s={error:e}}finally{try{x&&!x.done&&(a=S.return)&&a.call(S)}finally{if(s)throw s.error}}else if(4===C)try{for(var T=(c=void 0,EO(v.geometry.coordinates)),O=T.next();!O.done;O=T.next()){P=O.value;try{for(var L=(p=void 0,EO(P)),D=L.next();!D.done;D=L.next()){var I=D.value;_=[];try{for(var R=(m=void 0,EO(I)),H=R.next();!H.done;H=R.next()){var F;E={lon:(F=H.value)[0],lat:F[1]};_.push(E),t.ctls.push(E)}}catch(e){m={error:e}}finally{try{H&&!H.done&&(f=R.return)&&f.call(R)}finally{if(m)throw m.error}}t.holes.push(_)}}catch(e){p={error:e}}finally{try{D&&!D.done&&(d=L.return)&&d.call(L)}finally{if(p)throw p.error}}}}catch(e){c={error:e}}finally{try{O&&!O.done&&(u=T.return)&&u.call(T)}finally{if(c)throw c.error}}}}catch(e){i={error:e}}finally{try{y&&!y.done&&(r=g.return)&&r.call(g)}finally{if(i)throw i.error}}return t}}function FO(e){return e instanceof Array?1+parseInt(FO(e[0])):0}var NO=function(){function e(){this.eventContainer=new Map}return e.prototype.on=function(e,t){this.eventContainer.has(e)||this.eventContainer.set(e,t)},e.prototype.off=function(e){this.eventContainer.has(e)&&this.eventContainer.delete(e)},e.prototype.emit=function(e,t){var i=this.eventContainer.get(e);i&&i.apply(this,OO([],TO(arguments),!1).slice(1))},e}();function QO(e,t){MO.log("矢量资源id>>>",e);var i="".concat(window.config.geopptService,"/map/queryFeatureById?id=").concat(e);MO.log("矢量请求地址>>>",i);var r="".concat(window.config.geopptService,"/map/ExistFeatureById?id=").concat(e);return new Promise((function(n,o){fetch(r).then((function(e){return e.text()})).then((function(r){"true"==r?fetch(i).then((function(e){return e.arrayBuffer()})).then((function(i){if(i&&i.byteLength>0){var r=BO.decode(new LO(i));MO.log("geojson",r),MO.log("矢量文件名",t);var s=function(e,t){return new File([e],t)}(i,"".concat(t,".geojson")),a=new FormData;a.append("file",s),a.append("type","json");var l=void 0,h=localStorage.getItem("userMessage");if(h)l=JSON.parse(h).id;var c="".concat(window.config.uploadfileService,"/userResource/upload?uid=").concat(l);fetch(c,{method:"post",body:a}).then((function(e){return e.json()})).then((function(t){MO.log("上传矢量数据>>>",t);var i={id:e,geojson:{features:r.features},ossUrl:t.original_url};n(i)}))}else o(!1)})):(n("暂无该数据，请联系管理员"),MO.log("暂无该数据，请联系管理员"))})).catch((function(e){o(!1)}))}))}function kO(e,t,i){if(void 0===i&&(i=""),i)return MO.log("geojson阿里云地址>>>",i),new Promise(e?function(e,t){fetch(i).then((function(e){return e.arrayBuffer()})).then((function(i){if(i&&i.byteLength>0){var r=BO.decode(new LO(i));MO.log("geojson",r);var n={features:r.features};e(n)}else t(!1)}))}:function(e,t){fetch(i).then((function(e){return e.json()})).then((function(t){e(t)})).catch((function(e){t(!1)}))});if(e){var r="".concat(window.config.geopptService,"/map/queryFeatureById?id=").concat(t),n="".concat(window.config.geopptService,"/map/ExistFeatureById?id=").concat(t);return new Promise((function(e,t){fetch(n).then((function(e){return e.text()})).then((function(i){"true"==i?fetch(r).then((function(e){return e.arrayBuffer()})).then((function(i){if(i&&i.byteLength>0){var r=BO.decode(new LO(i));MO.log("geojson",r);var n={features:r.features};e(n)}else t(!1)})):(e("暂无该数据，请联系管理员"),MO.log("暂无该数据，请联系管理员"))})).catch((function(e){t(!1)}))}))}var o="".concat(window.config.uploadfileService,"/userResource/detail?id=").concat(t);return new Promise((function(e,t){fetch(o).then((function(e){return e.json()})).then((function(i){fetch(i.original_url).then((function(e){return e.json()})).then((function(t){e(t)})).catch((function(e){t(!1)}))})).catch((function(e){t(!1)}))}))}var UO=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),jO=function(){return jO=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},jO.apply(this,arguments)},GO=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},zO=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},YO=function(e,t,i,r){return new(i||(i=Promise))((function(n,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?n(e.value):function(e){return e instanceof i?e:new i((function(t){t(e)}))}(e.value).then(s,a)}l((r=r.apply(e,t||[])).next())}))},ZO=function(e,t){var i,r,n,o,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,r&&(n=2&o[0]?r.return:o[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,o[1])).done)return n;switch(r=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(n=s.trys,(n=n.length>0&&n[n.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){s.label=o[1];break}if(6===o[0]&&s.label<n[1]){s.label=n[1],n=o;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(o);break}n[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{i=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},WO=function(e){function t(t,i,r){var n=e.call(this,t,i,jO({},r))||this;return n.isFinish=!1,n.finishedSub$=new th.x,n.minPointNum=2,n.polygonEvent=new NO,n.type="多边形01",n.color="#00FF00",n.alpha=1,n.moveHeight=null,n}return UO(t,e),t.prototype.setPrimitivePosition=function(e){e&&(e[0]||(e=e.slice(1)),this.setInternalControlPosition(e),this.createEnt(e))},t.prototype.reDraw=function(){this.pLine&&this.primtiveCollection.remove(this.pLine),this.p&&this.primtiveCollection.remove(this.p),this.last_pos=null,this.setPrimitivePosition(this.ctls)},t.prototype.reDrawLine=function(){this.pLine&&this.primtiveCollection.remove(this.pLine),this.p&&this.primtiveCollection.remove(this.p),this.last_pos=null,this.setPrimitivePosition(this.polygonHoles)},t.prototype.initProps=function(e){},t.prototype.initShape=function(){this.primtiveCollection=new Cesium.PrimitiveCollection,this.ent={},this.createEnt([]),this.fillShape(this.ent),this.viewer.scene.orderGroundPrimitives.add(this.primtiveCollection,this.level)},t.prototype.initPolygonHoles=function(){return YO(this,void 0,void 0,(function(){var e,t;return ZO(this,(function(i){switch(i.label){case 0:return[4,kO(this.isVectorData,this.resourceId,this.ossUrl)];case 1:return(e=function(e){var t={type:"FeatureCollection",features:[]};if(e&&"GeometryCollection"===e.type)return e.geometries.forEach((function(e){var i={type:"Feature",properties:{},geometry:e};t.features.push(i)})),t;var i=!1;return Array.isArray(e.features)?(e.features.forEach((function(e){"GeometryCollection"===e.geometry.type&&(i=!0,e.geometry.geometries.forEach((function(e){var i={type:"Feature",properties:{},geometry:e};t.features.push(i)})))})),i?t:e):void 0}(e=i.sent())).features?(t={MultiLineString:{ctls:[],holes:[]},MultiPolygon:{ctls:[],holes:[]}},[2,IO(e.features,t)]):[2]}}))}))},t.prototype.createEnt=function(e){var t=this;if(this.isFinish=!1,!ty.Cartesian3ArrayEqual(this.last_pos,e)){var i=Cesium.Material.fromType("Color");if(this.polygonHoles){this.setColor(i),this._singleControlPosition=e;var r=this.createPrimitive(this.polygonHoles,i);this.handleP(r,e),this.isFinish=!0}else this.polygonEvent.on("polygonObj",(function(r){if(t.ent){t.setColor(i);var n=t.createPrimitiveDiff(r,i);t.handleP(n,e),t.isFinish=!0}}))}},t.prototype.handleP=function(e,t){Array.isArray(e)?(this.p&&this.primtiveCollection.remove(this.p),this.pLine&&this.primtiveCollection.remove(this.pLine),this.fillShape(e[0]),this.p=e[0],this.pLine=e[1],this.setOutlineColor(this.pLine.appearance.material),this.primtiveCollection.add(e[1],this.level),this.primtiveCollection.add(e[0],this.level),this.last_pos=t,this.ent=e[0],this.entArr=e):(this.p&&this.primtiveCollection.remove(this.p),this.fillShape(e),this.p=e,this.primtiveCollection.add(e,this.level),this.last_pos=t,this.ent=this.p)},t.prototype.flashPrimitive=function(){this.p&&(this.p.show=!this.p.show)},t.prototype.initCtls=function(){var e=this;this._singleControlPosition=[],this.ctls?this.ctrlPosition=this.ctls:this.initPolygonHoles().then((function(t){e.polygonEvent.emit("polygonObj",t)})).then((function(){e.finishedSub$.next(1)})),this.holes&&this.holes.length>0&&(this.polygonHoles=this.holes.map((function(t){return t.map((function(t){return e.ctrlPosition.push(t),zy.lonlathei2Cartesian(t)}))}))),this.ctrlPosition},GO([(0,fy.o)(),zO("design:type",Boolean)],t.prototype,"isFinish",void 0),GO([(0,fy.o)(),zO("design:type",Object)],t.prototype,"finishedSub$",void 0),GO([(0,fy.o)(),zO("design:type",Array)],t.prototype,"polygonHoles",void 0),GO([(0,fy.o)(),zO("design:type",Array)],t.prototype,"entArr",void 0),GO([(0,fy.o)(),zO("design:type",Object)],t.prototype,"polygonEvent",void 0),GO([(0,fy.o)(),zO("design:type",Object)],t.prototype,"last_pos",void 0),GO([(0,fy.o)(),zO("design:type",Function),zO("design:paramtypes",[]),zO("design:returntype",Promise)],t.prototype,"initPolygonHoles",null),GO([(0,fy.o)(),zO("design:type",Function),zO("design:paramtypes",[Array]),zO("design:returntype",void 0)],t.prototype,"createEnt",null),GO([(0,fy.o)(),zO("design:type",Object)],t.prototype,"holes",void 0),GO([(0,fy.o)(),zO("design:type",Function),zO("design:paramtypes",[]),zO("design:returntype",void 0)],t.prototype,"initCtls",null),t}(ZP),XO=i(5108),JO=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),KO=function(){return KO=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},KO.apply(this,arguments)},VO=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},qO=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},$O=function(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],r=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},eL=function(e){function t(t,i,r){var n=e.call(this,t,i,KO({},r))||this;if(n._ctrlPosition=[],n._colorShow=!0,n._outline=!0,n.type="多边形组",n._width=1,n._outlineColor="#ff0000",n.distanceDisplay=!1,n.distanceHeight=55e5,r&&r.properties)for(var o in r.properties)n[o]=r.properties[o];return n}return JO(t,e),Object.defineProperty(t.prototype,"colorShow",{get:function(){return this._colorShow},set:function(e){this._colorShow=e,this.ent.show=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"outline",{get:function(){return this._outline},set:function(e){this._outline=e,this.entArr&&this.entArr[1]&&(this.entArr[1].show=e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this._width},set:function(e){this._width=e,this.outline=!0,this.pLine&&this.setOutlineColor(this.pLine.appearance.material),this.reDrawLine()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"distanceDisplay",{get:function(){return this._distanceDisplay},set:function(e){this._distanceDisplay=e,this.ent&&this.reDraw()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"distanceHeight",{get:function(){return this._distanceHeight},set:function(e){this._distanceHeight=e,this.ent&&this.reDraw()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"outlineColor",{get:function(){return this._outlineColor},set:function(e){this._outlineColor=e,this.pLine&&this.setOutlineColor(this.pLine.appearance.material)},enumerable:!1,configurable:!0}),t.prototype.setOutlineColor=function(e){e.uniforms.color=Cesium.Color.fromCssColorString(this.outlineColor).withAlpha(this.alpha)},t.prototype.distanceCondition=function(){return this.distanceDisplay?new Cesium.DistanceDisplayConditionGeometryInstanceAttribute(0,this.distanceHeight):void 0},t.prototype.createLine=function(e){var t,i;!1===this.show&&(this.outline=!1);var r=[];try{for(var n=$O(e),o=n.next();!o.done;o=n.next()){var s=o.value,a=new Cesium.GroundPolylineGeometry({positions:s,width:this.width}),l=new Cesium.GeometryInstance({geometry:a,id:this.id,attributes:{distanceDisplayCondition:this.distanceCondition()}});r.push(l)}}catch(e){t={error:e}}finally{try{o&&!o.done&&(i=n.return)&&i.call(n)}finally{if(t)throw t.error}}return new Cesium.GroundPolylinePrimitive({geometryInstances:r,appearance:new Cesium.PolylineMaterialAppearance({material:Cesium.Material.fromType("Color",{color:this.outlineColor}),translucent:!0}),vertexCacheOptimize:!0,interleave:!1,compressVertices:!0,releaseGeometryInstances:!0,asynchronous:!1,allowPicking:!0,show:this.outline})},t.prototype.createPrimitive=function(e,t){var i,r,n=[];try{for(var o=$O(e),s=o.next();!s.done;s=o.next()){var a=s.value,l=new Cesium.PolygonGeometry({polygonHierarchy:new Cesium.PolygonHierarchy(a),extrudedHeight:0,height:0,vertexFormat:Cesium.EllipsoidSurfaceAppearance.VERTEX_FORMAT}),h=new Cesium.GeometryInstance({geometry:l,attributes:{distanceDisplayCondition:this.distanceCondition()}});n.push(h)}}catch(e){i={error:e}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return[new Cesium.GroundPrimitive({geometryInstances:n,appearance:new Cesium.EllipsoidSurfaceAppearance({material:t,flat:!0,faceForward:!1,translucent:!0,aboveGround:!1}),vertexCacheOptimize:!0,interleave:!1,compressVertices:!0,releaseGeometryInstances:!0,asynchronous:!1,allowPicking:!0,show:this.colorShow}),this.createLine(e)]},t.prototype.createPrimitiveDiff=function(e,t){var i,r,n=this;XO.log("面>>>",e),!1===this.show&&(this.colorShow=!1),this.polygonHoles=e.MultiPolygon.holes.map((function(e){return e.map((function(e){return n.ctrlPosition.push(e),zy.lonlathei2Cartesian(e)}))})),this.ctrlPosition=e.MultiPolygon.ctls,this.ctls=e.MultiPolygon.ctls;var o=[];try{for(var s=$O(this.polygonHoles),a=s.next();!a.done;a=s.next()){var l=a.value,h=new Cesium.PolygonGeometry({polygonHierarchy:new Cesium.PolygonHierarchy(l),extrudedHeight:0,height:0,vertexFormat:Cesium.EllipsoidSurfaceAppearance.VERTEX_FORMAT}),c=new Cesium.GeometryInstance({geometry:h,attributes:{distanceDisplayCondition:this.distanceCondition()}});o.push(c)}}catch(e){i={error:e}}finally{try{a&&!a.done&&(r=s.return)&&r.call(s)}finally{if(i)throw i.error}}return[new Cesium.GroundPrimitive({geometryInstances:o,appearance:new Cesium.EllipsoidSurfaceAppearance({material:t,flat:!0,faceForward:!1,translucent:!0,aboveGround:!1}),vertexCacheOptimize:!0,interleave:!1,compressVertices:!0,releaseGeometryInstances:!0,asynchronous:!1,allowPicking:!0,show:this.colorShow}),this.createLine(this.polygonHoles)]},t.prototype.toGeoJsonGeometry=function(){var e,t,i={type:"MultiPolygon",coordinates:[]};try{for(var r=$O(this.holes),n=r.next();!n.done;n=r.next()){var o=n.value;i.coordinates.push(o)}}catch(t){e={error:t}}finally{try{n&&!n.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}return i},VO([(0,fy.o)(),qO("design:type",Array)],t.prototype,"_ctrlPosition",void 0),VO([dy({name:"是否填充",group:"外观",subGroup:"填充",type:"checkboxSub",order:8,subOrder:1}),qO("design:type",Boolean),qO("design:paramtypes",[Boolean])],t.prototype,"colorShow",null),VO([dy({name:"边框",group:"外观",order:8,subGroup:"边框",subOrder:4,type:"checkboxSub"}),qO("design:type",Boolean),qO("design:paramtypes",[Boolean])],t.prototype,"outline",null),VO([dy({name:"线宽",group:"外观",type:"number",order:8,min:1,max:200}),qO("design:type",Number),qO("design:paramtypes",[Number])],t.prototype,"width",null),VO([dy({name:"可视高度",group:"通用",subGroup:"可视高度",subOrder:1,type:"checkboxSub",order:2,hiddenGroupName:!1}),qO("design:type",Boolean),qO("design:paramtypes",[Boolean])],t.prototype,"distanceDisplay",null),VO([dy({name:"可视高度距离",group:"通用",subGroup:"可视高度",subOrder:2,type:"number3",order:2,hiddenGroupName:!1,min:0,max:2e7}),qO("design:type",Number),qO("design:paramtypes",[Number])],t.prototype,"distanceHeight",null),VO([dy({name:"边框颜色",group:"外观",order:8,subGroup:"边框",subOrder:5,type:"color"}),qO("design:type",String),qO("design:paramtypes",[String])],t.prototype,"outlineColor",null),t}(WO);const tL=eL;c.Z.registerType(eL,"EditorGeojsonMultiPolygon","Graph");var iL=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),rL=function(){return rL=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},rL.apply(this,arguments)},nL=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},oL=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const sL=function(e){function t(t,i,r){var n=e.call(this,t,i,rL({},r))||this;return n.percent=1,n.percentStart=0,n}return iL(t,e),t.prototype.createPrimitive=function(e,t){throw new Error("Method not implemented.")},t.prototype.createPrimitiveDiff=function(e,t){throw new Error("Method not implemented.")},t.prototype.setOutlineColor=function(e){throw new Error("Method not implemented.")},Object.defineProperty(t.prototype,"percent",{get:function(){return this._percent},set:function(e){this._percent=e,this.p&&(this.p.appearance.material.uniforms.percent=e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"percentStart",{get:function(){return this._percentStart},set:function(e){this._percentStart=e,this.p&&(this.p.appearance.material.uniforms.percentStart=e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"percentRange",{get:function(){return this._percentRange||(this._percentRange=[0,1]),this._percentRange.length=0,this._percentRange.push(this.percentStart),this._percentRange.push(this.percent),this._percentRange},set:function(e){this._percentRange=e,this.percentStart=e[0],this.percent=e[1]},enumerable:!1,configurable:!0}),t.prototype.createSimpleMaterial=function(){var e={uniforms:{percent:1,percentStart:0,color:new Cesium.Color(0,1,1,1)},source:"\n          czm_material czm_getMaterial(czm_materialInput materialInput)\n          {\n              czm_material material = czm_getDefaultMaterial(materialInput);\n              float dis = distance(materialInput.st, vec2(1.0, materialInput.st.y));\n              //vec2 st = materialInput.st;\n              if(percent<0.0){\n                if(dis >1.0 -  abs(percent)){\n                  material.alpha=0.0;\n                }\n                else{\n                  material.alpha=1.0;\n                }\n              }\n              else{\n                if(dis < 1.0-percent || dis > 1.0 - percentStart){\n                  material.alpha=0.0;\n                }\n                else{\n                  material.alpha=1.0;\n                }\n              }\n              material.diffuse = color.rgb;\n              material.alpha=color.a* material.alpha;\n              // float glow = glowPower / abs(st.t - 0.5) - (glowPower / 0.5);\n    \n              // material.emission = max(vec3(glow - 1.0 + color.rgb), color.rgb);\n              // material.alpha = clamp(0.0, 1.0, glow) * color.a * st.s;\n    \n              //material.emission =  color.rgb;\n              //material.alpha =  color.a;\n    \n              return material;\n          }"};return new Cesium.Material({fabric:e})},t.prototype.getBoundingRectangle=function(){return this.ctrlPosition.length>0?Cesium.Rectangle.fromCartesianArray(this.ctrlPosition.map((function(e){return Cesium.Cartesian3.fromDegrees(e.lon,e.lat)}))):Cesium.Rectangle.fromCartesianArray(this._singleControlPosition)},nL([(0,fy.o)(),oL("design:type",Array)],t.prototype,"_percentRange",void 0),nL([dy({name:"百分比",group:"外观",type:"percentSlider",order:8}),oL("design:type",Object),oL("design:paramtypes",[Object])],t.prototype,"percentRange",null),nL([(0,fy.o)(),oL("design:type",Function),oL("design:paramtypes",[]),oL("design:returntype",Cesium.Rectangle)],t.prototype,"getBoundingRectangle",null),t}(WO);var aL=i(5108),lL=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),hL=function(){return hL=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},hL.apply(this,arguments)},cL=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},uL=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},pL=function(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],r=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},dL=function(e){function t(t,i,r){var n=e.call(this,t,i,hL({},r))||this;if(n._ctrlPosition=[],n.type="折线组",n._width=1,n.distanceDisplay=!1,n.distanceHeight=55e5,n.clampToGround=!1,r&&r.properties)for(var o in r.properties)n[o]=r.properties[o];return n}return lL(t,e),Object.defineProperty(t.prototype,"clampToGround",{get:function(){return this._clampToGround},set:function(e){this._clampToGround=e,this.reDraw()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this._width},set:function(e){this._width=e,this.reDrawLine()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"distanceDisplay",{get:function(){return this._distanceDisplay},set:function(e){this._distanceDisplay=e,this.ent&&this.reDraw()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"distanceHeight",{get:function(){return this._distanceHeight},set:function(e){this._distanceHeight=e,this.ent&&this.reDraw()},enumerable:!1,configurable:!0}),t.prototype.setOutlineColor=function(e){aL.log(e)},t.prototype.distanceCondition=function(){return this.distanceDisplay?new Cesium.DistanceDisplayConditionGeometryInstanceAttribute(0,this.distanceHeight):void 0},t.prototype.createPrimitive=function(e,t){var i,r,n,o;(t=this.createSimpleMaterial()).uniforms.percent=this.percent,t.uniforms.percentStart=this.percentStart,this.setColor(t);var s,a=[];if(this.clampToGround){try{for(var l=pL(e),h=l.next();!h.done;h=l.next()){var c=h.value,u=new Cesium.GroundPolylineGeometry({positions:c,width:this.width}),p=new Cesium.GeometryInstance({geometry:u,id:this.id,attributes:{distanceDisplayCondition:this.distanceCondition()}});a.push(p)}}catch(e){i={error:e}}finally{try{h&&!h.done&&(r=l.return)&&r.call(l)}finally{if(i)throw i.error}}s=new Cesium.GroundPolylinePrimitive({geometryInstances:a,appearance:new Cesium.PolylineMaterialAppearance({material:t,translucent:!0}),vertexCacheOptimize:!0,interleave:!1,compressVertices:!0,releaseGeometryInstances:!0,asynchronous:!1,allowPicking:!0,show:!0})}else{try{for(var d=pL(e),m=d.next();!m.done;m=d.next()){c=m.value,u=new Cesium.PolylineGeometry({positions:c,width:this.width}),p=new Cesium.GeometryInstance({geometry:u,id:this.id,attributes:{distanceDisplayCondition:this.distanceCondition()}});a.push(p)}}catch(e){n={error:e}}finally{try{m&&!m.done&&(o=d.return)&&o.call(d)}finally{if(n)throw n.error}}s=new Cesium.Primitive({geometryInstances:a,appearance:new Cesium.PolylineMaterialAppearance({material:t,translucent:!0}),vertexCacheOptimize:!0,interleave:!1,compressVertices:!0,releaseGeometryInstances:!0,asynchronous:!1,allowPicking:!0,show:!0})}return s},t.prototype.createPrimitiveDiff=function(e,t){var i,r,n,o,s,a=this;if((t=this.createSimpleMaterial()).uniforms.percent=this.percent,t.uniforms.percentStart=this.percentStart,this.setColor(t),aL.log("线>>>",e,void 0===this.show),this.polygonHoles=e.MultiLineString.holes.map((function(e){return e.map((function(e){return a.ctrlPosition.push(e),zy.lonlathei2Cartesian(e)}))})),this.ctrlPosition=e.MultiLineString.ctls,this.ctls=e.MultiLineString.ctls,this.clampToGround){var l=[];try{for(var h=pL(this.polygonHoles),c=h.next();!c.done;c=h.next()){var u=c.value,p=new Cesium.GroundPolylineGeometry({positions:u,width:this.width}),d=new Cesium.GeometryInstance({geometry:p,id:this.id,attributes:{distanceDisplayCondition:this.distanceCondition()}});l.push(d)}}catch(e){i={error:e}}finally{try{c&&!c.done&&(r=h.return)&&r.call(h)}finally{if(i)throw i.error}}s=new Cesium.GroundPolylinePrimitive({geometryInstances:l,appearance:new Cesium.PolylineMaterialAppearance({material:t,translucent:!0}),vertexCacheOptimize:!0,interleave:!1,compressVertices:!0,releaseGeometryInstances:!0,asynchronous:!1,allowPicking:!0,show:void 0===this.show||this.show})}else{l=[];try{for(var m=pL(this.polygonHoles),f=m.next();!f.done;f=m.next()){u=f.value,p=new Cesium.PolylineGeometry({positions:u,width:this.width}),d=new Cesium.GeometryInstance({geometry:p,id:this.id,attributes:{distanceDisplayCondition:this.distanceCondition()}});l.push(d)}}catch(e){n={error:e}}finally{try{f&&!f.done&&(o=m.return)&&o.call(m)}finally{if(n)throw n.error}}s=new Cesium.Primitive({geometryInstances:l,appearance:new Cesium.PolylineMaterialAppearance({material:t,translucent:!0}),vertexCacheOptimize:!0,interleave:!1,compressVertices:!0,releaseGeometryInstances:!0,asynchronous:!1,allowPicking:!0,show:void 0===this.show||this.show})}return s},t.prototype.toGeoJsonGeometry=function(){var e,t,i={type:"MultiLineString",coordinates:[]};try{for(var r=pL(this.holes),n=r.next();!n.done;n=r.next()){var o=n.value;i.coordinates.push(o)}}catch(t){e={error:t}}finally{try{n&&!n.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}return i},cL([(0,fy.o)(),uL("design:type",Array)],t.prototype,"_ctrlPosition",void 0),cL([dy({name:"贴地",group:"外观",type:"boolean",order:8,min:1,max:256}),uL("design:type",Boolean),uL("design:paramtypes",[Boolean])],t.prototype,"clampToGround",null),cL([dy({name:"线宽",group:"外观",type:"number",order:8,min:1,max:200}),uL("design:type",Number),uL("design:paramtypes",[Number])],t.prototype,"width",null),cL([dy({name:"可视高度",group:"通用",subGroup:"可视高度",subOrder:1,type:"checkboxSub",order:2,hiddenGroupName:!1}),uL("design:type",Boolean),uL("design:paramtypes",[Boolean])],t.prototype,"distanceDisplay",null),cL([dy({name:"可视高度距离",group:"通用",subGroup:"可视高度",subOrder:2,type:"number3",order:2,hiddenGroupName:!1,min:0,max:2e7}),uL("design:type",Number),uL("design:paramtypes",[Number])],t.prototype,"distanceHeight",null),t}(sL);const mL=dL;c.Z.registerType(dL,"EditorGeojsonMultiPolyline","Graph");var fL=i(5108),gL=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),AL=function(){return AL=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},AL.apply(this,arguments)},yL=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},vL=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},CL=function(e){function t(t,i,r){var n=e.call(this,t,i,AL({},r))||this;if(n.isFinish=!1,n._ctrlPosition=[],r&&r.properties)for(var o in r.properties)n[o]=r.properties[o];return n}return gL(t,e),t.prototype.initShape=function(){var e=this;fL.log("单面initShape>>>",this.resourceId,this.ossUrl),this.primtiveCollection=new Cesium.PrimitiveCollection,this.isFinish=!1,(this.resourceId||this.ossUrl)&&kO(this.isVectorData,this.resourceId,this.ossUrl).then((function(t){if(e.ent&&Array.isArray(t.features)){var i=t.features.filter((function(e){return"Polygon"===e.geometry.type}))[e.jsonId].geometry.coordinates.map((function(e){return e.map((function(e){return zy.lonlat2Cartesian(e)}))}));e.ent={},e._singleControlPosition=i[0],e.createEnt(i[0]),e.fillShape(e.ent),e.viewer.scene.orderGroundPrimitives.add(e.primtiveCollection,e.level),e.isFinish=!0}})),this.createEnt([]),this.ent={},this.fillShape(this.ent)},yL([(0,fy.o)(),vL("design:type",Boolean)],t.prototype,"isFinish",void 0),yL([(0,fy.o)(),vL("design:type",Object)],t.prototype,"holes",void 0),yL([(0,fy.o)(),vL("design:type",Array)],t.prototype,"_ctrlPosition",void 0),t}(XT);const _L=CL;c.Z.registerType(CL,"EditorGeojsonPolygon","Graph");var bL=i(5108),wL=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),PL=function(){return PL=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},PL.apply(this,arguments)},SL=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},xL=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},BL=function(e){function t(t,i,r){var n=e.call(this,t,i,PL({},r))||this;if(n.isFinish=!1,n._ctrlPosition=[],r&&r.properties)for(var o in r.properties)n[o]=r.properties[o];return n}return wL(t,e),t.prototype.initShape=function(){var e=this;this.isFinish=!1,this.primtiveCollection=new Cesium.PrimitiveCollection,bL.log("单线initShape>>>"),(this.resourceId||this.ossUrl)&&kO(this.isVectorData,this.resourceId,this.ossUrl).then((function(t){if(e.ent&&Array.isArray(t.features)){var i=t.features.filter((function(e){return"LineString"===e.geometry.type}))[e.jsonId].geometry.coordinates.map((function(e){return zy.lonlat2Cartesian(e)}));e.ent={},e._singleControlPosition=i,e.createEnt(i),e.fillShape(e.ent),e.viewer.scene.orderGroundPrimitives.add(e.primtiveCollection,e.level),e.isFinish=!0}})),this.ent={},this.createEnt([]),this.fillShape(this.ent)},SL([(0,fy.o)(),xL("design:type",Boolean)],t.prototype,"isFinish",void 0),SL([(0,fy.o)(),xL("design:type",Object)],t.prototype,"holes",void 0),SL([(0,fy.o)(),xL("design:type",Array)],t.prototype,"_ctrlPosition",void 0),t}(aO);const ML=BL;c.Z.registerType(BL,"EditorGeojsonPolyline","Graph");
/**
  @license
  fontmetrics.js - https://github.com/Pomax/fontmetrics.js

  Copyright (C) 2011 by Mike "Pomax" Kamermans

  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to deal
  in the Software without restriction, including without limitation the rights
  to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
  copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:

  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
  THE SOFTWARE.
**/
var EL=function(e,t){return document.defaultView.getComputedStyle(e,null).getPropertyValue(t)},TL=function(e,t,i,r){var n=e.measureText(t),o={};o.width=n.width;var s=EL(e.canvas,"font-family"),a=EL(e.canvas,"font-size").replace("px",""),l=EL(e.canvas,"font-style"),h=EL(e.canvas,"font-weight"),c=!/\S/.test(t);o.fontsize=a;var u=document.createElement("div");u.style.position="absolute",u.style.opacity="0",u.style.font=l+" "+h+" "+a+"px "+s,u.innerHTML=t+"<br/>"+t,document.body.appendChild(u),o.leading=1.2*a;var p=EL(u,"height");if((p=p.replace("px",""))>=2*a&&(o.leading=p/2|0),document.body.removeChild(u),c)o.ascent=0,o.descent=0,o.bounds={minx:0,maxx:o.width,miny:0,maxy:0},o.height=0;else{var d=document.createElement("canvas"),m=100;d.width=o.width+m,d.height=3*a,d.style.opacity="1",d.style.fontFamily=s,d.style.fontSize=a,d.style.fontStyle=l,d.style.fontWeight=h;var f=d.getContext("2d");f.font=l+" "+h+" "+a+"px "+s;var g=d.width,A=d.height,y=A/2;f.fillStyle="white",f.fillRect(-1,-1,g+2,A+2),i&&(f.strokeStyle="black",f.lineWidth=e.lineWidth,f.strokeText(t,50,y)),r&&(f.fillStyle="black",f.fillText(t,50,y));for(var v=f.getImageData(0,0,g,A).data,C=0,_=4*g,b=v.length;++C<b&&255===v[C];);var w=C/_|0;for(C=b-1;--C>0&&255===v[C];);var P=C/_|0;for(C=0;C<b&&255===v[C];)(C+=_)>=b&&(C=C-b+4);var S=C%_/4|0,x=1;for(C=b-3;C>=0&&255===v[C];)(C-=_)<0&&(C=b-3-4*x++);var B=C%_/4+1|0;o.ascent=y-w,o.descent=P-y,o.bounds={minx:S-50,maxx:B-50,miny:0,maxy:P-w},o.height=P-w+1}return o};const OL=TL;const LL=function(e){return null!=e};function DL(e){var t;this.name="DeveloperError",this.message=e;try{throw new Error}catch(e){t=e.stack}this.stack=t}LL(Object.create)&&(DL.prototype=Object.create(Error.prototype),DL.prototype.constructor=DL),DL.prototype.toString=function(){var e=this.name+": "+this.message;return LL(this.stack)&&(e+="\n"+this.stack.toString()),e},DL.throwInstantiationError=function(){throw new DL("This function defines an interface and should not be called directly.")};const IL=DL;var RL={};function HL(e,t,i){return"Expected "+i+" to be typeof "+t+", actual typeof was "+e}RL.typeOf={},RL.defined=function(e,t){if(!LL(t))throw new IL(function(e){return e+" is required, actual value was undefined"}(e))},RL.typeOf.func=function(e,t){if("function"!=typeof t)throw new IL(HL(typeof t,"function",e))},RL.typeOf.string=function(e,t){if("string"!=typeof t)throw new IL(HL(typeof t,"string",e))},RL.typeOf.number=function(e,t){if("number"!=typeof t)throw new IL(HL(typeof t,"number",e))},RL.typeOf.number.lessThan=function(e,t,i){if(RL.typeOf.number(e,t),t>=i)throw new IL("Expected "+e+" to be less than "+i+", actual value was "+t)},RL.typeOf.number.lessThanOrEquals=function(e,t,i){if(RL.typeOf.number(e,t),t>i)throw new IL("Expected "+e+" to be less than or equal to "+i+", actual value was "+t)},RL.typeOf.number.greaterThan=function(e,t,i){if(RL.typeOf.number(e,t),t<=i)throw new IL("Expected "+e+" to be greater than "+i+", actual value was "+t)},RL.typeOf.number.greaterThanOrEquals=function(e,t,i){if(RL.typeOf.number(e,t),t<i)throw new IL("Expected "+e+" to be greater than or equal to"+i+", actual value was "+t)},RL.typeOf.object=function(e,t){if("object"!=typeof t)throw new IL(HL(typeof t,"object",e))},RL.typeOf.bool=function(e,t){if("boolean"!=typeof t)throw new IL(HL(typeof t,"boolean",e))},RL.typeOf.number.equals=function(e,t,i,r){if(RL.typeOf.number(e,i),RL.typeOf.number(t,r),i!==r)throw new IL(e+" must be equal to "+t+", the actual values are "+i+" and "+r)};const FL=RL;function NL(e,t){return null!=e?e:t}NL.EMPTY_OBJECT=Object.freeze({});const QL=NL;
/**
  @license
  when.js - https://github.com/cujojs/when

  MIT License (c) copyright B Cavalier & J Hann

 * A lightweight CommonJS Promises/A and when() implementation
 * when is part of the cujo.js family of libraries (http://cujojs.com/)
 *
 * Licensed under the MIT License at:
 * http://www.opensource.org/licenses/mit-license.php
 *
 * @version 1.7.1
 */
var kL,UL,jL;function GL(e,t,i,r){return zL(e).then(t,i,r)}function zL(e){var t,i;return e instanceof YL?t=e:XL(e)?(i=WL(),e.then((function(e){i.resolve(e)}),(function(e){i.reject(e)}),(function(e){i.progress(e)})),t=i.promise):t=function(e){return new YL((function(t){try{return zL(t?t(e):e)}catch(e){return ZL(e)}}))}(e),t}function YL(e){this.then=e}function ZL(e){return new YL((function(t,i){try{return i?zL(i(e)):ZL(e)}catch(e){return ZL(e)}}))}function WL(){var e,t,i,r,n,o;return e=new YL(s),t=[],i=[],r=function(e,r,n){var o,s;return o=WL(),s="function"==typeof n?function(e){try{o.progress(n(e))}catch(e){o.progress(e)}}:function(e){o.progress(e)},t.push((function(t){t.then(e,r).then(o.resolve,o.reject,s)})),i.push(s),o.promise},n=function(e){return qL(i,e),e},o=function(e){return e=zL(e),r=e.then,o=zL,n=eD,qL(t,e),i=t=jL,e},{then:s,resolve:a,reject:l,progress:h,promise:e,resolver:{resolve:a,reject:l,progress:h}};function s(e,t,i){return r(e,t,i)}function a(e){return o(e)}function l(e){return o(ZL(e))}function h(e){return n(e)}}function XL(e){return e&&"function"==typeof e.then}function JL(e,t,i,r,n){return $L(2,arguments),GL(e,(function(e){var o,s,a,l,h,c,u,p,d,m;if(d=e.length>>>0,o=Math.max(0,Math.min(t,d)),a=[],s=d-o+1,l=[],h=WL(),o)for(p=h.progress,u=function(e){l.push(e),--s||(c=u=eD,h.reject(l))},c=function(e){a.push(e),--o||(c=u=eD,h.resolve(a))},m=0;m<d;++m)m in e&&GL(e[m],g,f,p);else h.resolve(a);return h.then(i,r,n);function f(e){u(e)}function g(e){c(e)}}))}function KL(e,t,i,r){return $L(1,arguments),VL(e,tD).then(t,i,r)}function VL(e,t){return GL(e,(function(e){var i,r,n,o,s,a;if(n=r=e.length>>>0,i=[],a=WL(),n)for(o=function(e,r){GL(e,t).then((function(e){i[r]=e,--n||a.resolve(i)}),a.reject)},s=0;s<r;s++)s in e?o(e[s],s):--n;else a.resolve(i);return a.promise}))}function qL(e,t){for(var i,r=0;i=e[r++];)i(t)}function $L(e,t){for(var i,r=t.length;r>e;)if(null!=(i=t[--r])&&"function"!=typeof i)throw new Error("arg "+r+" must be a function")}function eD(){}function tD(e){return e}GL.defer=WL,GL.resolve=zL,GL.reject=function(e){return GL(e,ZL)},GL.join=function(){return VL(arguments,tD)},GL.all=KL,GL.map=VL,GL.reduce=function(e,t){var i=UL.call(arguments,1);return GL(e,(function(e){var r;return r=e.length,i[0]=function(e,i,n){return GL(e,(function(e){return GL(i,(function(i){return t(e,i,n,r)}))}))},kL.apply(e,i)}))},GL.any=function(e,t,i,r){return JL(e,1,(function(e){return t?t(e[0]):e[0]}),i,r)},GL.some=JL,GL.chain=function(e,t,i){var r=arguments.length>2;return GL(e,(function(e){return e=r?i:e,t.resolve(e),e}),(function(e){return t.reject(e),ZL(e)}),t.progress)},GL.isPromise=XL,YL.prototype={always:function(e,t){return this.then(e,e,t)},otherwise:function(e){return this.then(jL,e)},yield:function(e){return this.then((function(){return e}))},spread:function(e){return this.then((function(t){return KL(t,(function(t){return e.apply(jL,t)}))}))}},UL=[].slice,kL=[].reduce||function(e){var t,i,r,n,o;if(o=0,n=(t=Object(this)).length>>>0,(i=arguments).length<=1)for(;;){if(o in t){r=t[o++];break}if(++o>=n)throw new TypeError}else r=i[1];for(;o<n;++o)o in t&&(r=e(r,t[o],o,t));return r};const iD=GL;var rD,nD={requestFullscreen:void 0,exitFullscreen:void 0,fullscreenEnabled:void 0,fullscreenElement:void 0,fullscreenchange:void 0,fullscreenerror:void 0},oD={};Object.defineProperties(oD,{element:{get:function(){if(oD.supportsFullscreen())return document[nD.fullscreenElement]}},changeEventName:{get:function(){if(oD.supportsFullscreen())return nD.fullscreenchange}},errorEventName:{get:function(){if(oD.supportsFullscreen())return nD.fullscreenerror}},enabled:{get:function(){if(oD.supportsFullscreen())return document[nD.fullscreenEnabled]}},fullscreen:{get:function(){if(oD.supportsFullscreen())return null!==oD.element}}}),oD.supportsFullscreen=function(){if(LL(rD))return rD;rD=!1;var e=document.body;if("function"==typeof e.requestFullscreen)return nD.requestFullscreen="requestFullscreen",nD.exitFullscreen="exitFullscreen",nD.fullscreenEnabled="fullscreenEnabled",nD.fullscreenElement="fullscreenElement",nD.fullscreenchange="fullscreenchange",nD.fullscreenerror="fullscreenerror",rD=!0;for(var t,i=["webkit","moz","o","ms","khtml"],r=0,n=i.length;r<n;++r){var o=i[r];("function"==typeof e[t=o+"RequestFullscreen"]||"function"==typeof e[t=o+"RequestFullScreen"])&&(nD.requestFullscreen=t,rD=!0),t=o+"ExitFullscreen","function"==typeof document[t]?nD.exitFullscreen=t:(t=o+"CancelFullScreen","function"==typeof document[t]&&(nD.exitFullscreen=t)),t=o+"FullscreenEnabled",void 0!==document[t]?nD.fullscreenEnabled=t:(t=o+"FullScreenEnabled",void 0!==document[t]&&(nD.fullscreenEnabled=t)),t=o+"FullscreenElement",void 0!==document[t]?nD.fullscreenElement=t:(t=o+"FullScreenElement",void 0!==document[t]&&(nD.fullscreenElement=t)),t=o+"fullscreenchange",void 0!==document["on"+t]&&("ms"===o&&(t="MSFullscreenChange"),nD.fullscreenchange=t),t=o+"fullscreenerror",void 0!==document["on"+t]&&("ms"===o&&(t="MSFullscreenError"),nD.fullscreenerror=t)}return rD},oD.requestFullscreen=function(e,t){oD.supportsFullscreen()&&e[nD.requestFullscreen]({vrDisplay:t})},oD.exitFullscreen=function(){oD.supportsFullscreen()&&document[nD.exitFullscreen]()},oD._names=nD;const sD=oD;var aD,lD,hD,cD,uD,pD,dD,mD,fD,gD,AD,yD,vD,CD,_D,bD,wD;function PD(e){for(var t=e.split("."),i=0,r=t.length;i<r;++i)t[i]=parseInt(t[i],10);return t}function SD(){if(!LL(lD)&&(lD=!1,!ED())){var e=/ Chrome\/([\.0-9]+)/.exec(aD.userAgent);null!==e&&(lD=!0,hD=PD(e[1]))}return lD}function xD(){if(!LL(cD)&&(cD=!1,!SD()&&!ED()&&/ Safari\/[\.0-9]+/.test(aD.userAgent))){var e=/ Version\/([\.0-9]+)/.exec(aD.userAgent);null!==e&&(cD=!0,uD=PD(e[1]))}return cD}function BD(){if(!LL(pD)){pD=!1;var e=/ AppleWebKit\/([\.0-9]+)(\+?)/.exec(aD.userAgent);null!==e&&(pD=!0,(dD=PD(e[1])).isNightly=!!e[2])}return pD}function MD(){var e;LL(mD)||(mD=!1,"Microsoft Internet Explorer"===aD.appName?null!==(e=/MSIE ([0-9]{1,}[\.0-9]{0,})/.exec(aD.userAgent))&&(mD=!0,fD=PD(e[1])):"Netscape"===aD.appName&&null!==(e=/Trident\/.*rv:([0-9]{1,}[\.0-9]{0,})/.exec(aD.userAgent))&&(mD=!0,fD=PD(e[1])));return mD}function ED(){if(!LL(gD)){gD=!1;var e=/ Edge\/([\.0-9]+)/.exec(aD.userAgent);null!==e&&(gD=!0,AD=PD(e[1]))}return gD}function TD(){if(!LL(yD)){yD=!1;var e=/Firefox\/([\.0-9]+)/.exec(aD.userAgent);null!==e&&(yD=!0,vD=PD(e[1]))}return yD}function OD(){if(!LL(wD)){var e=document.createElement("canvas");e.setAttribute("style","image-rendering: -moz-crisp-edges;image-rendering: pixelated;");var t=e.style.imageRendering;(wD=LL(t)&&""!==t)&&(bD=t)}return wD}function LD(){if(!LD.initialized)throw new IL("You must call FeatureDetection.supportsWebP.initialize and wait for the promise to resolve before calling FeatureDetection.supportsWebP");return LD._result}aD="undefined"!=typeof navigator?navigator:{},LD._promise=void 0,LD._result=void 0,LD.initialize=function(){if(LL(LD._promise))return LD._promise;var e=iD.defer();if(LD._promise=e.promise,ED())return LD._result=!1,e.resolve(LD._result),e.promise;var t=new Image;return t.onload=function(){LD._result=t.width>0&&t.height>0,e.resolve(LD._result)},t.onerror=function(){LD._result=!1,e.resolve(LD._result)},t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",e.promise},Object.defineProperties(LD,{initialized:{get:function(){return LL(LD._result)}}});var DD=[];"undefined"!=typeof ArrayBuffer&&(DD.push(Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array),"undefined"!=typeof Uint8ClampedArray&&DD.push(Uint8ClampedArray),"undefined"!=typeof Uint8ClampedArray&&DD.push(Uint8ClampedArray));var ID={isChrome:SD,chromeVersion:function(){return SD()&&hD},isSafari:xD,safariVersion:function(){return xD()&&uD},isWebkit:BD,webkitVersion:function(){return BD()&&dD},isInternetExplorer:MD,internetExplorerVersion:function(){return MD()&&fD},isEdge:ED,edgeVersion:function(){return ED()&&AD},isFirefox:TD,firefoxVersion:function(){return TD()&&vD},isWindows:function(){return LL(CD)||(CD=/Windows/i.test(aD.appVersion)),CD},hardwareConcurrency:QL(aD.hardwareConcurrency,3),supportsPointerEvents:function(){return LL(_D)||(_D=!TD()&&"undefined"!=typeof PointerEvent&&(!LL(aD.pointerEnabled)||aD.pointerEnabled)),_D},supportsImageRenderingPixelated:OD,supportsWebP:LD,imageRenderingValue:function(){return OD()?bD:void 0},typedArrayTypes:DD,supportsFullscreen:function(){return sD.supportsFullscreen()},supportsTypedArrays:function(){return"undefined"!=typeof ArrayBuffer},supportsWebWorkers:function(){return"undefined"!=typeof Worker},supportsWebAssembly:function(){return"undefined"!=typeof WebAssembly&&!ID.isEdge()}};const RD=ID;
/**
@license
mersenne-twister.js - https://gist.github.com/banksean/300494

   Copyright (C) 1997 - 2002, Makoto Matsumoto and Takuji Nishimura,
   All rights reserved.

   Redistribution and use in source and binary forms, with or without
   modification, are permitted provided that the following conditions
   are met:

     1. Redistributions of source code must retain the above copyright
        notice, this list of conditions and the following disclaimer.

     2. Redistributions in binary form must reproduce the above copyright
        notice, this list of conditions and the following disclaimer in the
        documentation and/or other materials provided with the distribution.

     3. The names of its contributors may not be used to endorse or promote
        products derived from this software without specific prior written
        permission.

   THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
   "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
   LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
   A PARTICULAR PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE COPYRIGHT OWNER OR
   CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
   EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
   PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
   PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
   LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
   NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
   SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/
function HD(e){null==e&&(e=(new Date).getTime()),this.N=624,this.M=397,this.MATRIX_A=2567483615,this.UPPER_MASK=2147483648,this.LOWER_MASK=2147483647,this.mt=new Array(this.N),this.mti=this.N+1,this.init_genrand(e)}HD.prototype.init_genrand=function(e){for(this.mt[0]=e>>>0,this.mti=1;this.mti<this.N;this.mti++){e=this.mt[this.mti-1]^this.mt[this.mti-1]>>>30;this.mt[this.mti]=(1812433253*((4294901760&e)>>>16)<<16)+1812433253*(65535&e)+this.mti,this.mt[this.mti]>>>=0}},HD.prototype.genrand_int32=function(){var e,t=new Array(0,this.MATRIX_A);if(this.mti>=this.N){var i;for(this.mti==this.N+1&&this.init_genrand(5489),i=0;i<this.N-this.M;i++)e=this.mt[i]&this.UPPER_MASK|this.mt[i+1]&this.LOWER_MASK,this.mt[i]=this.mt[i+this.M]^e>>>1^t[1&e];for(;i<this.N-1;i++)e=this.mt[i]&this.UPPER_MASK|this.mt[i+1]&this.LOWER_MASK,this.mt[i]=this.mt[i+(this.M-this.N)]^e>>>1^t[1&e];e=this.mt[this.N-1]&this.UPPER_MASK|this.mt[0]&this.LOWER_MASK,this.mt[this.N-1]=this.mt[this.M-1]^e>>>1^t[1&e],this.mti=0}return e=this.mt[this.mti++],e^=e>>>11,e^=e<<7&2636928640,e^=e<<15&4022730752,(e^=e>>>18)>>>0},HD.prototype.random=function(){return this.genrand_int32()*(1/4294967296)};const FD=HD;var ND={EPSILON1:.1,EPSILON2:.01,EPSILON3:.001,EPSILON4:1e-4,EPSILON5:1e-5,EPSILON6:1e-6,EPSILON7:1e-7,EPSILON8:1e-8,EPSILON9:1e-9,EPSILON10:1e-10,EPSILON11:1e-11,EPSILON12:1e-12,EPSILON13:1e-13,EPSILON14:1e-14,EPSILON15:1e-15,EPSILON16:1e-16,EPSILON17:1e-17,EPSILON18:1e-18,EPSILON19:1e-19,EPSILON20:1e-20,EPSILON21:1e-21,GRAVITATIONALPARAMETER:3986004418e5,SOLAR_RADIUS:6955e5,LUNAR_RADIUS:1737400,SIXTY_FOUR_KILOBYTES:65536,FOUR_GIGABYTES:4294967296};ND.sign=QL(Math.sign,(function(e){return 0===(e=+e)||e!=e?e:e>0?1:-1})),ND.signNotZero=function(e){return e<0?-1:1},ND.toSNorm=function(e,t){return t=QL(t,255),Math.round((.5*ND.clamp(e,-1,1)+.5)*t)},ND.fromSNorm=function(e,t){return t=QL(t,255),ND.clamp(e,0,t)/t*2-1},ND.normalize=function(e,t,i){return 0===(i=Math.max(i-t,0))?0:ND.clamp((e-t)/i,0,1)},ND.sinh=QL(Math.sinh,(function(e){return(Math.exp(e)-Math.exp(-e))/2})),ND.cosh=QL(Math.cosh,(function(e){return(Math.exp(e)+Math.exp(-e))/2})),ND.lerp=function(e,t,i){return(1-i)*e+i*t},ND.PI=Math.PI,ND.ONE_OVER_PI=1/Math.PI,ND.PI_OVER_TWO=Math.PI/2,ND.PI_OVER_THREE=Math.PI/3,ND.PI_OVER_FOUR=Math.PI/4,ND.PI_OVER_SIX=Math.PI/6,ND.THREE_PI_OVER_TWO=3*Math.PI/2,ND.TWO_PI=2*Math.PI,ND.ONE_OVER_TWO_PI=1/(2*Math.PI),ND.RADIANS_PER_DEGREE=Math.PI/180,ND.DEGREES_PER_RADIAN=180/Math.PI,ND.RADIANS_PER_ARCSECOND=ND.RADIANS_PER_DEGREE/3600,ND.toRadians=function(e){if(!LL(e))throw new IL("degrees is required.");return e*ND.RADIANS_PER_DEGREE},ND.toDegrees=function(e){if(!LL(e))throw new IL("radians is required.");return e*ND.DEGREES_PER_RADIAN},ND.convertLongitudeRange=function(e){if(!LL(e))throw new IL("angle is required.");var t=ND.TWO_PI,i=e-Math.floor(e/t)*t;return i<-Math.PI?i+t:i>=Math.PI?i-t:i},ND.clampToLatitudeRange=function(e){if(!LL(e))throw new IL("angle is required.");return ND.clamp(e,-1*ND.PI_OVER_TWO,ND.PI_OVER_TWO)},ND.negativePiToPi=function(e){if(!LL(e))throw new IL("angle is required.");return e>=-ND.PI&&e<=ND.PI?e:ND.zeroToTwoPi(e+ND.PI)-ND.PI},ND.zeroToTwoPi=function(e){if(!LL(e))throw new IL("angle is required.");if(e>=0&&e<=ND.TWO_PI)return e;var t=ND.mod(e,ND.TWO_PI);return Math.abs(t)<ND.EPSILON14&&Math.abs(e)>ND.EPSILON14?ND.TWO_PI:t},ND.mod=function(e,t){if(!LL(e))throw new IL("m is required.");if(!LL(t))throw new IL("n is required.");if(0===t)throw new IL("divisor cannot be 0.");return ND.sign(e)===ND.sign(t)&&Math.abs(e)<Math.abs(t)?e:(e%t+t)%t},ND.equalsEpsilon=function(e,t,i,r){if(!LL(e))throw new IL("left is required.");if(!LL(t))throw new IL("right is required.");i=QL(i,0),r=QL(r,i);var n=Math.abs(e-t);return n<=r||n<=i*Math.max(Math.abs(e),Math.abs(t))},ND.lessThan=function(e,t,i){if(!LL(e))throw new IL("first is required.");if(!LL(t))throw new IL("second is required.");if(!LL(i))throw new IL("absoluteEpsilon is required.");return e-t<-i},ND.lessThanOrEquals=function(e,t,i){if(!LL(e))throw new IL("first is required.");if(!LL(t))throw new IL("second is required.");if(!LL(i))throw new IL("absoluteEpsilon is required.");return e-t<i},ND.greaterThan=function(e,t,i){if(!LL(e))throw new IL("first is required.");if(!LL(t))throw new IL("second is required.");if(!LL(i))throw new IL("absoluteEpsilon is required.");return e-t>i},ND.greaterThanOrEquals=function(e,t,i){if(!LL(e))throw new IL("first is required.");if(!LL(t))throw new IL("second is required.");if(!LL(i))throw new IL("absoluteEpsilon is required.");return e-t>-i};var QD=[1];ND.factorial=function(e){if("number"!=typeof e||e<0)throw new IL("A number greater than or equal to 0 is required.");var t=QD.length;if(e>=t)for(var i=QD[t-1],r=t;r<=e;r++){var n=i*r;QD.push(n),i=n}return QD[e]},ND.incrementWrap=function(e,t,i){if(i=QL(i,0),!LL(e))throw new IL("n is required.");if(t<=i)throw new IL("maximumValue must be greater than minimumValue.");return++e>t&&(e=i),e},ND.isPowerOfTwo=function(e){if("number"!=typeof e||e<0||e>4294967295)throw new IL("A number between 0 and (2^32)-1 is required.");return 0!==e&&0==(e&e-1)},ND.nextPowerOfTwo=function(e){if("number"!=typeof e||e<0||e>2147483648)throw new IL("A number between 0 and 2^31 is required.");return--e,e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,e|=e>>16,++e},ND.previousPowerOfTwo=function(e){if("number"!=typeof e||e<0||e>4294967295)throw new IL("A number between 0 and (2^32)-1 is required.");return e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,e|=e>>16,e=((e|=e>>32)>>>0)-(e>>>1)},ND.clamp=function(e,t,i){if(!LL(e))throw new IL("value is required");if(!LL(t))throw new IL("min is required.");if(!LL(i))throw new IL("max is required.");return e<t?t:e>i?i:e};var kD=new FD;ND.setRandomNumberSeed=function(e){if(!LL(e))throw new IL("seed is required.");kD=new FD(e)},ND.nextRandomNumber=function(){return kD.random()},ND.randomBetween=function(e,t){return ND.nextRandomNumber()*(t-e)+e},ND.acosClamped=function(e){if(!LL(e))throw new IL("value is required.");return Math.acos(ND.clamp(e,-1,1))},ND.asinClamped=function(e){if(!LL(e))throw new IL("value is required.");return Math.asin(ND.clamp(e,-1,1))},ND.chordLength=function(e,t){if(!LL(e))throw new IL("angle is required.");if(!LL(t))throw new IL("radius is required.");return 2*t*Math.sin(.5*e)},ND.logBase=function(e,t){if(!LL(e))throw new IL("number is required.");if(!LL(t))throw new IL("base is required.");return Math.log(e)/Math.log(t)},ND.cbrt=QL(Math.cbrt,(function(e){var t=Math.pow(Math.abs(e),1/3);return e<0?-t:t})),ND.log2=QL(Math.log2,(function(e){return Math.log(e)*Math.LOG2E})),ND.fog=function(e,t){var i=e*t;return 1-Math.exp(-i*i)},ND.fastApproximateAtan=function(e){return FL.typeOf.number("x",e),e*(-.1784*Math.abs(e)-.0663*e*e+1.0301)},ND.fastApproximateAtan2=function(e,t){var i,r;FL.typeOf.number("x",e),FL.typeOf.number("y",t);var n=Math.abs(e);i=Math.abs(t),r=Math.max(n,i);var o=(i=Math.min(n,i))/r;if(isNaN(o))throw new IL("either x or y must be nonzero");return n=ND.fastApproximateAtan(o),n=Math.abs(t)>Math.abs(e)?ND.PI_OVER_TWO-n:n,n=e<0?ND.PI-n:n,n=t<0?-n:n};const UD=ND;function jD(e,t,i){return i<0&&(i+=1),i>1&&(i-=1),6*i<1?e+6*(t-e)*i:2*i<1?t:3*i<2?e+(t-e)*(2/3-i)*6:e}function GD(e,t,i,r){this.red=QL(e,1),this.green=QL(t,1),this.blue=QL(i,1),this.alpha=QL(r,1)}var zD,YD,ZD;GD.fromCartesian4=function(e,t){return FL.typeOf.object("cartesian",e),LL(t)?(t.red=e.x,t.green=e.y,t.blue=e.z,t.alpha=e.w,t):new GD(e.x,e.y,e.z,e.w)},GD.fromBytes=function(e,t,i,r,n){return e=GD.byteToFloat(QL(e,255)),t=GD.byteToFloat(QL(t,255)),i=GD.byteToFloat(QL(i,255)),r=GD.byteToFloat(QL(r,255)),LL(n)?(n.red=e,n.green=t,n.blue=i,n.alpha=r,n):new GD(e,t,i,r)},GD.fromAlpha=function(e,t,i){return FL.typeOf.object("color",e),FL.typeOf.number("alpha",t),LL(i)?(i.red=e.red,i.green=e.green,i.blue=e.blue,i.alpha=t,i):new GD(e.red,e.green,e.blue,t)},RD.supportsTypedArrays()&&(zD=new ArrayBuffer(4),YD=new Uint32Array(zD),ZD=new Uint8Array(zD)),GD.fromRgba=function(e,t){return YD[0]=e,GD.fromBytes(ZD[0],ZD[1],ZD[2],ZD[3],t)},GD.fromHsl=function(e,t,i,r,n){e=QL(e,0)%1,t=QL(t,0),i=QL(i,0),r=QL(r,1);var o=i,s=i,a=i;if(0!==t){var l,h=2*i-(l=i<.5?i*(1+t):i+t-i*t);o=jD(h,l,e+1/3),s=jD(h,l,e),a=jD(h,l,e-1/3)}return LL(n)?(n.red=o,n.green=s,n.blue=a,n.alpha=r,n):new GD(o,s,a,r)},GD.fromRandom=function(e,t){var i=(e=QL(e,QL.EMPTY_OBJECT)).red;if(!LL(i)){var r=QL(e.minimumRed,0),n=QL(e.maximumRed,1);FL.typeOf.number.lessThanOrEquals("minimumRed",r,n),i=r+UD.nextRandomNumber()*(n-r)}var o=e.green;if(!LL(o)){var s=QL(e.minimumGreen,0),a=QL(e.maximumGreen,1);FL.typeOf.number.lessThanOrEquals("minimumGreen",s,a),o=s+UD.nextRandomNumber()*(a-s)}var l=e.blue;if(!LL(l)){var h=QL(e.minimumBlue,0),c=QL(e.maximumBlue,1);FL.typeOf.number.lessThanOrEquals("minimumBlue",h,c),l=h+UD.nextRandomNumber()*(c-h)}var u=e.alpha;if(!LL(u)){var p=QL(e.minimumAlpha,0),d=QL(e.maximumAlpha,1);FL.typeOf.number.lessThanOrEquals("minumumAlpha",p,d),u=p+UD.nextRandomNumber()*(d-p)}return LL(t)?(t.red=i,t.green=o,t.blue=l,t.alpha=u,t):new GD(i,o,l,u)};var WD=/^#([0-9a-f])([0-9a-f])([0-9a-f])([0-9a-f])?$/i,XD=/^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})?$/i,JD=/^rgba?\(\s*([0-9.]+%?)\s*,\s*([0-9.]+%?)\s*,\s*([0-9.]+%?)(?:\s*,\s*([0-9.]+))?\s*\)$/i,KD=/^hsla?\(\s*([0-9.]+)\s*,\s*([0-9.]+%)\s*,\s*([0-9.]+%)(?:\s*,\s*([0-9.]+))?\s*\)$/i;GD.fromCssColorString=function(e,t){FL.typeOf.string("color",e),LL(t)||(t=new GD);var i=GD[(e=e.replace(/\s/g,"")).toUpperCase()];if(LL(i))return GD.clone(i,t),t;var r=WD.exec(e);return null!==r?(t.red=parseInt(r[1],16)/15,t.green=parseInt(r[2],16)/15,t.blue=parseInt(r[3],16)/15,t.alpha=parseInt(QL(r[4],"f"),16)/15,t):null!==(r=XD.exec(e))?(t.red=parseInt(r[1],16)/255,t.green=parseInt(r[2],16)/255,t.blue=parseInt(r[3],16)/255,t.alpha=parseInt(QL(r[4],"ff"),16)/255,t):null!==(r=JD.exec(e))?(t.red=parseFloat(r[1])/("%"===r[1].substr(-1)?100:255),t.green=parseFloat(r[2])/("%"===r[2].substr(-1)?100:255),t.blue=parseFloat(r[3])/("%"===r[3].substr(-1)?100:255),t.alpha=parseFloat(QL(r[4],"1.0")),t):null!==(r=KD.exec(e))?GD.fromHsl(parseFloat(r[1])/360,parseFloat(r[2])/100,parseFloat(r[3])/100,parseFloat(QL(r[4],"1.0")),t):t=void 0},GD.packedLength=4,GD.pack=function(e,t,i){return FL.typeOf.object("value",e),FL.defined("array",t),i=QL(i,0),t[i++]=e.red,t[i++]=e.green,t[i++]=e.blue,t[i]=e.alpha,t},GD.unpack=function(e,t,i){return FL.defined("array",e),t=QL(t,0),LL(i)||(i=new GD),i.red=e[t++],i.green=e[t++],i.blue=e[t++],i.alpha=e[t],i},GD.byteToFloat=function(e){return e/255},GD.floatToByte=function(e){return 1===e?255:256*e|0},GD.clone=function(e,t){if(LL(e))return LL(t)?(t.red=e.red,t.green=e.green,t.blue=e.blue,t.alpha=e.alpha,t):new GD(e.red,e.green,e.blue,e.alpha)},GD.equals=function(e,t){return e===t||LL(e)&&LL(t)&&e.red===t.red&&e.green===t.green&&e.blue===t.blue&&e.alpha===t.alpha},GD.equalsArray=function(e,t,i){return e.red===t[i]&&e.green===t[i+1]&&e.blue===t[i+2]&&e.alpha===t[i+3]},GD.prototype.clone=function(e){return GD.clone(this,e)},GD.prototype.equals=function(e){return GD.equals(this,e)},GD.prototype.equalsEpsilon=function(e,t){return this===e||LL(e)&&Math.abs(this.red-e.red)<=t&&Math.abs(this.green-e.green)<=t&&Math.abs(this.blue-e.blue)<=t&&Math.abs(this.alpha-e.alpha)<=t},GD.prototype.toString=function(){return"("+this.red+", "+this.green+", "+this.blue+", "+this.alpha+")"},GD.prototype.toCssColorString=function(){var e=GD.floatToByte(this.red),t=GD.floatToByte(this.green),i=GD.floatToByte(this.blue);return 1===this.alpha?"rgb("+e+","+t+","+i+")":"rgba("+e+","+t+","+i+","+this.alpha+")"},GD.prototype.toCssHexString=function(){var e=GD.floatToByte(this.red).toString(16);e.length<2&&(e="0"+e);var t=GD.floatToByte(this.green).toString(16);t.length<2&&(t="0"+t);var i=GD.floatToByte(this.blue).toString(16);if(i.length<2&&(i="0"+i),this.alpha<1){var r=GD.floatToByte(this.alpha).toString(16);return r.length<2&&(r="0"+r),"#"+e+t+i+r}return"#"+e+t+i},GD.prototype.toBytes=function(e){var t=GD.floatToByte(this.red),i=GD.floatToByte(this.green),r=GD.floatToByte(this.blue),n=GD.floatToByte(this.alpha);return LL(e)?(e[0]=t,e[1]=i,e[2]=r,e[3]=n,e):[t,i,r,n]},GD.prototype.toRgba=function(){return ZD[0]=GD.floatToByte(this.red),ZD[1]=GD.floatToByte(this.green),ZD[2]=GD.floatToByte(this.blue),ZD[3]=GD.floatToByte(this.alpha),YD[0]},GD.prototype.brighten=function(e,t){return FL.typeOf.number("magnitude",e),FL.typeOf.number.greaterThanOrEquals("magnitude",e,0),FL.typeOf.object("result",t),e=1-e,t.red=1-(1-this.red)*e,t.green=1-(1-this.green)*e,t.blue=1-(1-this.blue)*e,t.alpha=this.alpha,t},GD.prototype.darken=function(e,t){return FL.typeOf.number("magnitude",e),FL.typeOf.number.greaterThanOrEquals("magnitude",e,0),FL.typeOf.object("result",t),e=1-e,t.red=this.red*e,t.green=this.green*e,t.blue=this.blue*e,t.alpha=this.alpha,t},GD.prototype.withAlpha=function(e,t){return GD.fromAlpha(this,e,t)},GD.add=function(e,t,i){return FL.typeOf.object("left",e),FL.typeOf.object("right",t),FL.typeOf.object("result",i),i.red=e.red+t.red,i.green=e.green+t.green,i.blue=e.blue+t.blue,i.alpha=e.alpha+t.alpha,i},GD.subtract=function(e,t,i){return FL.typeOf.object("left",e),FL.typeOf.object("right",t),FL.typeOf.object("result",i),i.red=e.red-t.red,i.green=e.green-t.green,i.blue=e.blue-t.blue,i.alpha=e.alpha-t.alpha,i},GD.multiply=function(e,t,i){return FL.typeOf.object("left",e),FL.typeOf.object("right",t),FL.typeOf.object("result",i),i.red=e.red*t.red,i.green=e.green*t.green,i.blue=e.blue*t.blue,i.alpha=e.alpha*t.alpha,i},GD.divide=function(e,t,i){return FL.typeOf.object("left",e),FL.typeOf.object("right",t),FL.typeOf.object("result",i),i.red=e.red/t.red,i.green=e.green/t.green,i.blue=e.blue/t.blue,i.alpha=e.alpha/t.alpha,i},GD.mod=function(e,t,i){return FL.typeOf.object("left",e),FL.typeOf.object("right",t),FL.typeOf.object("result",i),i.red=e.red%t.red,i.green=e.green%t.green,i.blue=e.blue%t.blue,i.alpha=e.alpha%t.alpha,i},GD.lerp=function(e,t,i,r){return FL.typeOf.object("start",e),FL.typeOf.object("end",t),FL.typeOf.number("t",i),FL.typeOf.object("result",r),r.red=UD.lerp(e.red,t.red,i),r.green=UD.lerp(e.green,t.green,i),r.blue=UD.lerp(e.blue,t.blue,i),r.alpha=UD.lerp(e.alpha,t.alpha,i),r},GD.multiplyByScalar=function(e,t,i){return FL.typeOf.object("color",e),FL.typeOf.number("scalar",t),FL.typeOf.object("result",i),i.red=e.red*t,i.green=e.green*t,i.blue=e.blue*t,i.alpha=e.alpha*t,i},GD.divideByScalar=function(e,t,i){return FL.typeOf.object("color",e),FL.typeOf.number("scalar",t),FL.typeOf.object("result",i),i.red=e.red/t,i.green=e.green/t,i.blue=e.blue/t,i.alpha=e.alpha/t,i},GD.ALICEBLUE=Object.freeze(GD.fromCssColorString("#F0F8FF")),GD.ANTIQUEWHITE=Object.freeze(GD.fromCssColorString("#FAEBD7")),GD.AQUA=Object.freeze(GD.fromCssColorString("#00FFFF")),GD.AQUAMARINE=Object.freeze(GD.fromCssColorString("#7FFFD4")),GD.AZURE=Object.freeze(GD.fromCssColorString("#F0FFFF")),GD.BEIGE=Object.freeze(GD.fromCssColorString("#F5F5DC")),GD.BISQUE=Object.freeze(GD.fromCssColorString("#FFE4C4")),GD.BLACK=Object.freeze(GD.fromCssColorString("#000000")),GD.BLANCHEDALMOND=Object.freeze(GD.fromCssColorString("#FFEBCD")),GD.BLUE=Object.freeze(GD.fromCssColorString("#0000FF")),GD.BLUEVIOLET=Object.freeze(GD.fromCssColorString("#8A2BE2")),GD.BROWN=Object.freeze(GD.fromCssColorString("#A52A2A")),GD.BURLYWOOD=Object.freeze(GD.fromCssColorString("#DEB887")),GD.CADETBLUE=Object.freeze(GD.fromCssColorString("#5F9EA0")),GD.CHARTREUSE=Object.freeze(GD.fromCssColorString("#7FFF00")),GD.CHOCOLATE=Object.freeze(GD.fromCssColorString("#D2691E")),GD.CORAL=Object.freeze(GD.fromCssColorString("#FF7F50")),GD.CORNFLOWERBLUE=Object.freeze(GD.fromCssColorString("#6495ED")),GD.CORNSILK=Object.freeze(GD.fromCssColorString("#FFF8DC")),GD.CRIMSON=Object.freeze(GD.fromCssColorString("#DC143C")),GD.CYAN=Object.freeze(GD.fromCssColorString("#00FFFF")),GD.DARKBLUE=Object.freeze(GD.fromCssColorString("#00008B")),GD.DARKCYAN=Object.freeze(GD.fromCssColorString("#008B8B")),GD.DARKGOLDENROD=Object.freeze(GD.fromCssColorString("#B8860B")),GD.DARKGRAY=Object.freeze(GD.fromCssColorString("#A9A9A9")),GD.DARKGREEN=Object.freeze(GD.fromCssColorString("#006400")),GD.DARKGREY=GD.DARKGRAY,GD.DARKKHAKI=Object.freeze(GD.fromCssColorString("#BDB76B")),GD.DARKMAGENTA=Object.freeze(GD.fromCssColorString("#8B008B")),GD.DARKOLIVEGREEN=Object.freeze(GD.fromCssColorString("#556B2F")),GD.DARKORANGE=Object.freeze(GD.fromCssColorString("#FF8C00")),GD.DARKORCHID=Object.freeze(GD.fromCssColorString("#9932CC")),GD.DARKRED=Object.freeze(GD.fromCssColorString("#8B0000")),GD.DARKSALMON=Object.freeze(GD.fromCssColorString("#E9967A")),GD.DARKSEAGREEN=Object.freeze(GD.fromCssColorString("#8FBC8F")),GD.DARKSLATEBLUE=Object.freeze(GD.fromCssColorString("#483D8B")),GD.DARKSLATEGRAY=Object.freeze(GD.fromCssColorString("#2F4F4F")),GD.DARKSLATEGREY=GD.DARKSLATEGRAY,GD.DARKTURQUOISE=Object.freeze(GD.fromCssColorString("#00CED1")),GD.DARKVIOLET=Object.freeze(GD.fromCssColorString("#9400D3")),GD.DEEPPINK=Object.freeze(GD.fromCssColorString("#FF1493")),GD.DEEPSKYBLUE=Object.freeze(GD.fromCssColorString("#00BFFF")),GD.DIMGRAY=Object.freeze(GD.fromCssColorString("#696969")),GD.DIMGREY=GD.DIMGRAY,GD.DODGERBLUE=Object.freeze(GD.fromCssColorString("#1E90FF")),GD.FIREBRICK=Object.freeze(GD.fromCssColorString("#B22222")),GD.FLORALWHITE=Object.freeze(GD.fromCssColorString("#FFFAF0")),GD.FORESTGREEN=Object.freeze(GD.fromCssColorString("#228B22")),GD.FUCHSIA=Object.freeze(GD.fromCssColorString("#FF00FF")),GD.GAINSBORO=Object.freeze(GD.fromCssColorString("#DCDCDC")),GD.GHOSTWHITE=Object.freeze(GD.fromCssColorString("#F8F8FF")),GD.GOLD=Object.freeze(GD.fromCssColorString("#FFD700")),GD.GOLDENROD=Object.freeze(GD.fromCssColorString("#DAA520")),GD.GRAY=Object.freeze(GD.fromCssColorString("#808080")),GD.GREEN=Object.freeze(GD.fromCssColorString("#008000")),GD.GREENYELLOW=Object.freeze(GD.fromCssColorString("#ADFF2F")),GD.GREY=GD.GRAY,GD.HONEYDEW=Object.freeze(GD.fromCssColorString("#F0FFF0")),GD.HOTPINK=Object.freeze(GD.fromCssColorString("#FF69B4")),GD.INDIANRED=Object.freeze(GD.fromCssColorString("#CD5C5C")),GD.INDIGO=Object.freeze(GD.fromCssColorString("#4B0082")),GD.IVORY=Object.freeze(GD.fromCssColorString("#FFFFF0")),GD.KHAKI=Object.freeze(GD.fromCssColorString("#F0E68C")),GD.LAVENDER=Object.freeze(GD.fromCssColorString("#E6E6FA")),GD.LAVENDAR_BLUSH=Object.freeze(GD.fromCssColorString("#FFF0F5")),GD.LAWNGREEN=Object.freeze(GD.fromCssColorString("#7CFC00")),GD.LEMONCHIFFON=Object.freeze(GD.fromCssColorString("#FFFACD")),GD.LIGHTBLUE=Object.freeze(GD.fromCssColorString("#ADD8E6")),GD.LIGHTCORAL=Object.freeze(GD.fromCssColorString("#F08080")),GD.LIGHTCYAN=Object.freeze(GD.fromCssColorString("#E0FFFF")),GD.LIGHTGOLDENRODYELLOW=Object.freeze(GD.fromCssColorString("#FAFAD2")),GD.LIGHTGRAY=Object.freeze(GD.fromCssColorString("#D3D3D3")),GD.LIGHTGREEN=Object.freeze(GD.fromCssColorString("#90EE90")),GD.LIGHTGREY=GD.LIGHTGRAY,GD.LIGHTPINK=Object.freeze(GD.fromCssColorString("#FFB6C1")),GD.LIGHTSEAGREEN=Object.freeze(GD.fromCssColorString("#20B2AA")),GD.LIGHTSKYBLUE=Object.freeze(GD.fromCssColorString("#87CEFA")),GD.LIGHTSLATEGRAY=Object.freeze(GD.fromCssColorString("#778899")),GD.LIGHTSLATEGREY=GD.LIGHTSLATEGRAY,GD.LIGHTSTEELBLUE=Object.freeze(GD.fromCssColorString("#B0C4DE")),GD.LIGHTYELLOW=Object.freeze(GD.fromCssColorString("#FFFFE0")),GD.LIME=Object.freeze(GD.fromCssColorString("#00FF00")),GD.LIMEGREEN=Object.freeze(GD.fromCssColorString("#32CD32")),GD.LINEN=Object.freeze(GD.fromCssColorString("#FAF0E6")),GD.MAGENTA=Object.freeze(GD.fromCssColorString("#FF00FF")),GD.MAROON=Object.freeze(GD.fromCssColorString("#800000")),GD.MEDIUMAQUAMARINE=Object.freeze(GD.fromCssColorString("#66CDAA")),GD.MEDIUMBLUE=Object.freeze(GD.fromCssColorString("#0000CD")),GD.MEDIUMORCHID=Object.freeze(GD.fromCssColorString("#BA55D3")),GD.MEDIUMPURPLE=Object.freeze(GD.fromCssColorString("#9370DB")),GD.MEDIUMSEAGREEN=Object.freeze(GD.fromCssColorString("#3CB371")),GD.MEDIUMSLATEBLUE=Object.freeze(GD.fromCssColorString("#7B68EE")),GD.MEDIUMSPRINGGREEN=Object.freeze(GD.fromCssColorString("#00FA9A")),GD.MEDIUMTURQUOISE=Object.freeze(GD.fromCssColorString("#48D1CC")),GD.MEDIUMVIOLETRED=Object.freeze(GD.fromCssColorString("#C71585")),GD.MIDNIGHTBLUE=Object.freeze(GD.fromCssColorString("#191970")),GD.MINTCREAM=Object.freeze(GD.fromCssColorString("#F5FFFA")),GD.MISTYROSE=Object.freeze(GD.fromCssColorString("#FFE4E1")),GD.MOCCASIN=Object.freeze(GD.fromCssColorString("#FFE4B5")),GD.NAVAJOWHITE=Object.freeze(GD.fromCssColorString("#FFDEAD")),GD.NAVY=Object.freeze(GD.fromCssColorString("#000080")),GD.OLDLACE=Object.freeze(GD.fromCssColorString("#FDF5E6")),GD.OLIVE=Object.freeze(GD.fromCssColorString("#808000")),GD.OLIVEDRAB=Object.freeze(GD.fromCssColorString("#6B8E23")),GD.ORANGE=Object.freeze(GD.fromCssColorString("#FFA500")),GD.ORANGERED=Object.freeze(GD.fromCssColorString("#FF4500")),GD.ORCHID=Object.freeze(GD.fromCssColorString("#DA70D6")),GD.PALEGOLDENROD=Object.freeze(GD.fromCssColorString("#EEE8AA")),GD.PALEGREEN=Object.freeze(GD.fromCssColorString("#98FB98")),GD.PALETURQUOISE=Object.freeze(GD.fromCssColorString("#AFEEEE")),GD.PALEVIOLETRED=Object.freeze(GD.fromCssColorString("#DB7093")),GD.PAPAYAWHIP=Object.freeze(GD.fromCssColorString("#FFEFD5")),GD.PEACHPUFF=Object.freeze(GD.fromCssColorString("#FFDAB9")),GD.PERU=Object.freeze(GD.fromCssColorString("#CD853F")),GD.PINK=Object.freeze(GD.fromCssColorString("#FFC0CB")),GD.PLUM=Object.freeze(GD.fromCssColorString("#DDA0DD")),GD.POWDERBLUE=Object.freeze(GD.fromCssColorString("#B0E0E6")),GD.PURPLE=Object.freeze(GD.fromCssColorString("#800080")),GD.RED=Object.freeze(GD.fromCssColorString("#FF0000")),GD.ROSYBROWN=Object.freeze(GD.fromCssColorString("#BC8F8F")),GD.ROYALBLUE=Object.freeze(GD.fromCssColorString("#4169E1")),GD.SADDLEBROWN=Object.freeze(GD.fromCssColorString("#8B4513")),GD.SALMON=Object.freeze(GD.fromCssColorString("#FA8072")),GD.SANDYBROWN=Object.freeze(GD.fromCssColorString("#F4A460")),GD.SEAGREEN=Object.freeze(GD.fromCssColorString("#2E8B57")),GD.SEASHELL=Object.freeze(GD.fromCssColorString("#FFF5EE")),GD.SIENNA=Object.freeze(GD.fromCssColorString("#A0522D")),GD.SILVER=Object.freeze(GD.fromCssColorString("#C0C0C0")),GD.SKYBLUE=Object.freeze(GD.fromCssColorString("#87CEEB")),GD.SLATEBLUE=Object.freeze(GD.fromCssColorString("#6A5ACD")),GD.SLATEGRAY=Object.freeze(GD.fromCssColorString("#708090")),GD.SLATEGREY=GD.SLATEGRAY,GD.SNOW=Object.freeze(GD.fromCssColorString("#FFFAFA")),GD.SPRINGGREEN=Object.freeze(GD.fromCssColorString("#00FF7F")),GD.STEELBLUE=Object.freeze(GD.fromCssColorString("#4682B4")),GD.TAN=Object.freeze(GD.fromCssColorString("#D2B48C")),GD.TEAL=Object.freeze(GD.fromCssColorString("#008080")),GD.THISTLE=Object.freeze(GD.fromCssColorString("#D8BFD8")),GD.TOMATO=Object.freeze(GD.fromCssColorString("#FF6347")),GD.TURQUOISE=Object.freeze(GD.fromCssColorString("#40E0D0")),GD.VIOLET=Object.freeze(GD.fromCssColorString("#EE82EE")),GD.WHEAT=Object.freeze(GD.fromCssColorString("#F5DEB3")),GD.WHITE=Object.freeze(GD.fromCssColorString("#FFFFFF")),GD.WHITESMOKE=Object.freeze(GD.fromCssColorString("#F5F5F5")),GD.YELLOW=Object.freeze(GD.fromCssColorString("#FFFF00")),GD.YELLOWGREEN=Object.freeze(GD.fromCssColorString("#9ACD32")),GD.TRANSPARENT=Object.freeze(new GD(0,0,0,0));const VD=GD;var qD,$D=function(){function e(){}return e.measureSize=function(e,t){if(!LL(e))throw new IL("text is required.");if(""!==e){t=QL(t,QL.EMPTY_OBJECT);var i=QL(t.font,"10px sans-serif"),r=QL(t.stroke,!1),n=QL(t.fill,!0),o=QL(t.strokeWidth,1),s=(QL(t.backgroundColor,VD.TRANSPARENT),QL(t.padding,0),document.createElement("canvas"));s.width=1,s.height=1,s.style.font=i;var a=s.getContext("2d");LL(qD)||(LL(a.imageSmoothingEnabled)?qD="imageSmoothingEnabled":LL(a.mozImageSmoothingEnabled)?qD="mozImageSmoothingEnabled":LL(a.webkitImageSmoothingEnabled)?qD="webkitImageSmoothingEnabled":LL(a.msImageSmoothingEnabled)&&(qD="msImageSmoothingEnabled")),a.font=i,a.lineJoin="round",a.lineWidth=o,a[qD]=!1,a.textBaseline=QL(t.textBaseline,"bottom"),s.style.visibility="hidden",document.body.appendChild(s);var l=new OL(a,e,r,n);return document.body.removeChild(s),s.style.visibility="",l}},e}();const eI=$D;var tI=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),iI=function(){return iI=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},iI.apply(this,arguments)},rI=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},nI=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},oI=function(e){function t(t,i,r){var n=e.call(this,t,i,iI({},r))||this;n.maxPointNum=1,n.minPointNum=1,n.firstEditText=!0,n.canvasWidth=0,n.canvasHeight=0,n.scaleProperty=["scalev"],n.rotateByHeadingProperty=["rotation"],n.type="贴地文字",n.alpha=1,n.textSize=108,n.textFont="黑体",n.fontWeight=0,n.text="贴地文字",n.rotation=0,n.outlineShow=!1,n.outlineWidth=2,n.outlineColor="#000000",n.distanceDisplay=!1,n.distanceHeight=55e5,n.showMode=1,n.heightReference=Cesium.HeightReference.NONE,n.hideValues=["gridSwitch","gridLevel","gridIsAgg","gridColor","gridOutlineColor","gridUpdate"];var o=Math.ceil(t.viewer.camera.positionCartographic.height);if(n.scalev=Math.ceil(.001*o),r&&r.properties)for(var s in r.properties)n[s]=r.properties[s];return n}return tI(t,e),t.prototype.setPrimitivePosition=function(e){if(e[0]||(e=e.slice(1)),!(e.length<1)){this.setInternalControlPosition(e);var t=e[0],i=Cesium.Math.toRadians(this.rotation),r=new Cesium.HeadingPitchRoll(i,0,0),n=Cesium.Transforms.headingPitchRollToFixedFrame(t,r,Cesium.Ellipsoid.WGS84,Cesium.Transforms.eastNorthUpToFixedFrame,new Cesium.Matrix4);if(2==this.showMode){var o=Cesium.Matrix4.fromRotationTranslation(Cesium.Matrix3.fromRotationX(Cesium.Math.toRadians(90)));Cesium.Matrix4.multiply(n,o,n)}var s=new Cesium.Cartesian3(this.canvasWidth*this.scalev,this.canvasHeight*this.scalev,1),a=Cesium.Matrix4.fromScale(s);Cesium.Matrix4.multiply(n,a,n),this.ent.modelMatrix=n}},t.prototype.initProps=function(e){},Object.defineProperty(t.prototype,"rotation",{get:function(){return this._rotation},set:function(e){this._rotation=e,this.ent&&this.rotatable&&this.setPrimitivePosition(this._singleControlPosition)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"scalev",{get:function(){return this._scalev},set:function(e){e<.5&&(e=.5),$P.saveProp(this.type,"scalev",e),this._scalev=e,this.ent&&this.setPrimitivePosition(this._singleControlPosition)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"showMode",{get:function(){return this._showMode},set:function(e){this._showMode=e,this.ent&&this.createEnt(this._singleControlPosition[0])},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"distanceDisplay",{get:function(){return this._distanceDisplay},set:function(e){this._distanceDisplay=e,this.ent&&this.createEnt(Cesium.Cartesian3.ZERO)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"distanceHeight",{get:function(){return this._distanceHeight},set:function(e){this._distanceHeight=e,this.ent&&this.createEnt(Cesium.Cartesian3.ZERO)},enumerable:!1,configurable:!0}),t.prototype.distanceCondition=function(){return this.distanceDisplay?new Cesium.DistanceDisplayConditionGeometryInstanceAttribute(0,this.distanceHeight):void 0},Object.defineProperty(t.prototype,"alpha",{get:function(){return this._alpha},set:function(e){this._alpha=e,this.ent&&this.editCanvas()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"text",{get:function(){return this._text},set:function(e){this._text=e,this.ent&&this.editCanvas()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"textFont",{get:function(){return this._textFont},set:function(e){this._textFont=e,this.ent&&this.editCanvas()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"textSize",{get:function(){return this._textSize},set:function(e){this._textSize=Number.parseFloat(e),this.ent&&this.editCanvas()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontWeight",{get:function(){return this._fontWeight},set:function(e){this._fontWeight=e,this.ent&&this.editCanvas()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){return this._color},set:function(e){this._color=e,this.ent&&this.editCanvas()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"outlineShow",{get:function(){return this._outlineShow},set:function(e){this._outlineShow=e,this.ent&&this.editCanvas()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"outlineColor",{get:function(){return this._outlineColor},set:function(e){this._outlineColor=e,this.ent&&this.editCanvas()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"outlineWidth",{get:function(){return this._outlineWidth},set:function(e){this._outlineWidth=e,this.ent&&this.editCanvas()},enumerable:!1,configurable:!0}),t.prototype.scale=function(e,t){this.scalable&&(this.scalev=this.changeScaleByMouse(this.scalev,e,t),this.onPropertyChanged())},t.prototype.rotateByHeading=function(e,t){if(this.rotatable){var i=this.rotation+(t.x-e.x);this.rotation=i%360,this.onPropertyChanged()}},t.prototype.createHiDPICanvas=function(e,t,i){var r,n=(r=document.createElement("canvas").getContext("2d")||{},(window.devicePixelRatio||1)/(r.webkitBackingStorePixelRatio||r.mozBackingStorePixelRatio||r.msBackingStorePixelRatio||r.oBackingStorePixelRatio||r.backingStorePixelRatio||1));i||(i=n);var o=document.createElement("canvas");return o.width=e,o.height=t,o},t.prototype.drawText=function(){var e="";e=1==this.fontWeight?"bold "+this.textSize+"px "+this.textFont:"normal "+this.textSize+"px "+this.textFont;for(var t=eI.measureSize("国",{font:e,fillColor:Cesium.Color.BLACK,stroke:this.outlineShow,strokeColor:this.outlineColor,strokeWidth:this.outlineWidth}),i=this.text.split("\n"),r=0,n=0;n<i.length;n++)i[n].length>r&&(r=i[n].length);if(t.width&&t.height){r>0&&i.length>0?(this.canvasWidth=r*t.width,this.canvasHeight=i.length*(t.height+this.outlineWidth/2)+20):(this.canvasWidth=t.width,this.canvasHeight=t.height+this.outlineWidth/2+20);var o=this.createHiDPICanvas(this.canvasWidth,this.canvasHeight,3),s=o.getContext("2d");s.fillStyle=this.color,s.globalAlpha=this.alpha,s.font=e,s.textBaseline="hanging",s.strokeStyle=this.outlineColor,s.lineWidth=this.outlineWidth;var a=t.ascent;if(i&&i.length>0){var l=a/6;for(n=0;n<i.length;n++)s.fillText(i[n],0,l),this.outlineShow&&s.strokeText(i[n],0,l),l+=t.height}else s.fillText(this.text,0,a/6),this.outlineShow&&s.strokeText(this.text,0,a/6);return o}},t.prototype.createMaterial=function(){var e={type:"AlphaText",uniforms:{image:this.drawText()},components:{diffuse:"texture2D(image, fract(materialInput.st)).rgb",alpha:"texture2D(image, fract(materialInput.st)).a"}};return this.material=new Cesium.Material({fabric:e,translucent:!0}),this.material},t.prototype.setColor=function(e){e.uniforms.color=Cesium.Color.fromCssColorString(this.color).withAlpha(1==this.alpha?1:this.alpha)},t.prototype.createEnt=function(e){this.ent instanceof Cesium.Primitive&&this.viewer.scene.primitives.remove(this.ent);var t=this.createMaterial(),i=new Cesium.GeometryInstance({geometry:Cesium.PlaneGeometry.createGeometry(new Cesium.PlaneGeometry({vertexFormat:Cesium.EllipsoidSurfaceAppearance.VERTEX_FORMAT})),attributes:{distanceDisplayCondition:this.distanceCondition()}}),r=new Cesium.Primitive({geometryInstances:i,appearance:new Cesium.EllipsoidSurfaceAppearance({material:t,flat:!0,aboveGround:!0}),asynchronous:!0,releaseGeometryInstances:!0});this.ent=r,this.editCanvas(),this.viewer.scene.primitives.add(r),this.fillShape(this.ent)},t.prototype.editCanvas=function(){this.ent.appearance.material.uniforms.image=this.drawText()},t.prototype.initShape=function(){var e=this;this.createEnt(Cesium.Cartesian3.ZERO),this.positionProperty=function(){var t=e._singleControlPosition.concat($A.cursorPos);t&&e.setPrimitivePosition(t)}},t.prototype.toEdit=function(){var t=this;e.prototype.toEdit.call(this),this.positionProperty=function(){var e=t._singleControlPosition;t.setPrimitivePosition(e)}},t.prototype.finish=function(){if(this.ent){e.prototype.finish.call(this);var t=this._singleControlPosition;this.positionProperty=t}},rI([dy({name:"旋转",group:"外观",type:"whirl",order:8,min:-360,max:360,hiddenGroupName:!1}),nI("design:type",Number),nI("design:paramtypes",[Number])],t.prototype,"rotation",null),rI([dy({name:"缩放",group:"外观",type:"zoom",order:8,min:1,max:1e4,hiddenGroupName:!1}),nI("design:type",Number),nI("design:paramtypes",[Number])],t.prototype,"scalev",null),rI([dy({name:"显示模式",group:"外观",order:8,subOrder:4,type:"option",options:[{label:"贴地",value:1},{label:"立面",value:2}]}),nI("design:type",Number),nI("design:paramtypes",[Object])],t.prototype,"showMode",null),rI([dy({name:"可视高度",group:"通用",subGroup:"可视高度",subOrder:1,type:"checkboxSub",order:2,hiddenGroupName:!1}),nI("design:type",Boolean),nI("design:paramtypes",[Boolean])],t.prototype,"distanceDisplay",null),rI([dy({name:"可视高度距离",group:"通用",subGroup:"可视高度",subOrder:2,type:"number3",order:2,hiddenGroupName:!1,min:0,max:2e7}),nI("design:type",Number),nI("design:paramtypes",[Number])],t.prototype,"distanceHeight",null),rI([dy({name:"不透明度",group:"通用",type:"slider",order:2,min:0,max:1}),nI("design:type",Number),nI("design:paramtypes",[Number])],t.prototype,"alpha",null),rI([dy({name:"文字",group:"文本",order:6,type:"textArea",hiddenGroupName:!0}),nI("design:type",String),nI("design:paramtypes",[String])],t.prototype,"text",null),rI([dy({name:"字体",group:"文本",order:6,type:"font",hiddenGroupName:!0}),nI("design:type",String),nI("design:paramtypes",[String])],t.prototype,"textFont",null),rI([dy({name:"文字大小",group:"文本",subGroup:"大小粗细",order:6,subOrder:3,type:"size",min:40,max:400,hiddenGroupName:!0}),nI("design:type",Number),nI("design:paramtypes",[Number])],t.prototype,"textSize",null),rI([dy({name:"字体粗细",group:"文本",subGroup:"大小粗细",order:6,subOrder:4,type:"option",hiddenGroupName:!0,options:[{label:"正常",value:0},{label:"加粗",value:1}]}),nI("design:type",Number),nI("design:paramtypes",[Number])],t.prototype,"fontWeight",null),rI([(0,gy.C)(),dy({name:"颜色",group:"文本",type:"color",order:6,subGroup:"填充",subOrder:4,noEmpty:!1}),nI("design:type",String),nI("design:paramtypes",[String])],t.prototype,"color",null),rI([dy({name:"是否描边",group:"文本",type:"checkboxSub",order:6,subGroup:"描边",subOrder:7}),nI("design:type",Boolean),nI("design:paramtypes",[Boolean])],t.prototype,"outlineShow",null),rI([dy({name:"描边颜色",group:"文本",subGroup:"描边",order:6,subOrder:8,type:"color"}),nI("design:type",String),nI("design:paramtypes",[String])],t.prototype,"outlineColor",null),rI([dy({name:"描边线宽",group:"文本",subGroup:"描边线宽",order:6,subOrder:9,type:"number4",min:1,max:6}),nI("design:type",Number),nI("design:paramtypes",[Number])],t.prototype,"outlineWidth",null),rI([(0,fy.o)(),nI("design:type",Function),nI("design:paramtypes",[Object,Object,Object]),nI("design:returntype",void 0)],t.prototype,"createHiDPICanvas",null),rI([(0,fy.o)(),nI("design:type",Function),nI("design:paramtypes",[]),nI("design:returntype",void 0)],t.prototype,"drawText",null),rI([(0,fy.o)(),nI("design:type",Object)],t.prototype,"material",void 0),rI([(0,fy.o)(),nI("design:type",Function),nI("design:paramtypes",[]),nI("design:returntype",void 0)],t.prototype,"editCanvas",null),t}(UP);const sI=oI;c.Z.registerType(oI,"EditorPlaneText","Graph");var aI=i(5108),lI=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),hI=function(){return hI=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},hI.apply(this,arguments)},cI=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},uI=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},pI=function(e){function t(t,i,r){var n=e.call(this,t,i,hI({},r))||this;if(n.isEditing=!1,n.maxPointNum=1,n.minPointNum=1,n._width=0,n._height=0,n._alpha=1,n._scalev=1,n.scaleProperty=["scalev"],n.type="动图",n.distanceDisplay?n.gifSwitch=!0:n.gifSwitch=!1,r&&r.properties)for(var o in r.properties)n[o]=r.properties[o];return n}return lI(t,e),Object.defineProperty(t.prototype,"imageUrl",{get:function(){return this._imageUrl},set:function(e){this._imageUrl=e,this.htmlElement&&(this.htmlElement.src=e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this._width},set:function(e){this._width=e,this.htmlElement&&this.htmlElement.style&&(this.htmlElement.style.width=e+"px")},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._height},set:function(e){this._height=e,this.htmlElement&&this.htmlElement.style&&(this.htmlElement.style.height=e+"px")},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"show",{get:function(){return this._show},set:function(e){this._show=e,this.gifSwitch=!1,this.htmlElement&&this.htmlElement.style&&(this.htmlElement.style.display=this._show?"block":"none"),this.onPropertyChanged("show")},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"alpha",{get:function(){return this._alpha},set:function(e){this._alpha=e,this.show=1===e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"scalev",{get:function(){return this._scalev},set:function(e){$P.saveProp(this.type,"scalev",e),this._scalev=e,this.htmlElement&&this.htmlElement.style&&(this.htmlElement.style.transform="scale(".concat(e,")"))},enumerable:!1,configurable:!0}),t.prototype.initShape=function(){var e=this;if(this.ent=this.entities.add(new Cesium.Entity({point:{}})),this.ent.show=this.show,this.fillShape(this.ent),Object.assign(this.ent.point,{pixelSize:new Cesium.CallbackProperty((function(t,i){return e._width}),!0),color:Cesium.Color.AQUA.withAlpha(.01),outlineWidth:0,outlineColor:Cesium.Color.AQUA.withAlpha(0),heightReference:Cesium.HeightReference.NONE}),this.ent){this.ent.position=new Cesium.CallbackProperty((function(t,i){return e.calcuteShape(e._singleControlPosition.concat($A.cursorPos),t)}),!1),this.htmlElement=document.createElement("img"),aI.log("this.imageUrl",this.imageUrl),this.imageUrl.indexOf("https")<0&&(this.imageUrl=this.imageUrl.replace("http","https")),aI.log("this.imageUrl",this.imageUrl),this.htmlElement.src=this.imageUrl,this.htmlElement.style.position="absolute",this.htmlElement.style.pointerEvents="none",this.htmlElement.style.top="-500px",this.height>0&&(this.htmlElement.style.height=this.height+"px",this.htmlElement.style.width=this.width+"px",this.htmlElement.style.display=this.show?"block":"none",this.htmlElement.style.transform="scale(".concat(this.scalev,")"));var t=document.getElementsByTagName("app-cesium");t&&t.length>0&&(t[0].appendChild(this.htmlElement),this.htmlElement.onload=function(t){0===e._height&&(e._height=Number.parseInt(getComputedStyle(e.htmlElement).height),e._width=Number.parseInt(getComputedStyle(e.htmlElement).width)),e._cb=e.viewer.scene.preRender.addEventListener((function(){if(e.gifSwitch&&e.show){var t=Math.ceil(e.viewer.camera.positionCartographic.height);e.distanceDisplay?t&&e.distanceHeight&&(t>e.distanceHeight?e.htmlElement.style.display="none":e.htmlElement.style.display="block"):e.htmlElement.style.display="block"}!1===e.isEditing&&e.ent&&e.setHtmlPosition(e.ent.position._value)}))})}},t.prototype.calcuteShape=function(e,t){if(e[0]&&!(e.length<this.minPointNum)){var i=e[0];return this.setHtmlPosition(i),this.setInternalControlPosition(e,t),i}},t.prototype.toEdit=function(){var t=this;this.isEditing=!0,e.prototype.toEdit.call(this),this.ent&&(this.ent.position=new Cesium.CallbackProperty((function(e,i){return t.calcuteShape(t._singleControlPosition,e)}),!1))},t.prototype.finish=function(){this.ent&&(this.ent.position=this.calcuteShape(this._singleControlPosition,zy.julianDate()),e.prototype.finish.call(this),this.isEditing=!1)},t.prototype.delete=function(){aI.log("gif delete"),this.htmlElement.style.display="none",this.viewer.container.contains(this.htmlElement)&&this.htmlElement.parentNode.removeChild(this.htmlElement),this.viewer.scene.preRender.removeEventListener(this._cb),e.prototype.delete.call(this)},t.prototype.setHtmlPosition=function(e){var t=this.viewer.scene.cartesianToCanvasCoordinates(e);if(t&&Cesium.defined(t)){var i=Cesium.Ellipsoid.WGS84,r=this.viewer.camera;new Cesium.EllipsoidalOccluder(i,r.position).isPointVisible(e)?(this.htmlElement.style.visibility="visible",this.htmlElement.style.top=t.y-this.width/2+"px",this.htmlElement.style.left=t.x-this.width/2+"px"):this.htmlElement.style.visibility="hidden"}},t.prototype.scale=function(e,t){this.scalable&&(this.scalev=this.changeScaleByMouse(this.scalev,e,t),this.onPropertyChanged())},cI([(0,fy.o)(),uI("design:type",Object)],t.prototype,"isEditing",void 0),cI([(0,fy.o)(),uI("design:type",Object)],t.prototype,"maxPointNum",void 0),cI([(0,fy.o)(),uI("design:type",Object)],t.prototype,"minPointNum",void 0),cI([(0,fy.o)(),uI("design:type",Object)],t.prototype,"htmlElement",void 0),cI([dy({name:"图片路径",group:"外观",type:"display",order:8}),uI("design:type",String),uI("design:paramtypes",[String])],t.prototype,"imageUrl",null),cI([dy({name:"宽",group:"大小",subGroup:"大小",type:"block",order:3,subOrder:3,min:0,hiddenGroupName:!1}),uI("design:type",Number),uI("design:paramtypes",[Number])],t.prototype,"width",null),cI([dy({name:"高",group:"大小",subGroup:"大小",type:"block",order:3,subOrder:4,min:0,hiddenGroupName:!1}),uI("design:type",Number),uI("design:paramtypes",[Number])],t.prototype,"height",null),cI([dy({name:"可见性",group:"通用",subOrder:7,type:"boolean",order:2}),uI("design:type",Boolean),uI("design:paramtypes",[Boolean])],t.prototype,"show",null),cI([(0,fy.o)(),uI("design:type",Number),uI("design:paramtypes",[Number])],t.prototype,"alpha",null),cI([dy({name:"缩放",group:"外观",type:"zoom",order:8,min:.001,hiddenGroupName:!1}),uI("design:type",Number),uI("design:paramtypes",[Number])],t.prototype,"scalev",null),cI([(0,fy.o)(),uI("design:type",Object)],t.prototype,"_cb",void 0),t}(rv);const dI=pI;c.Z.registerType(pI,"EditorHtmlImage","Graph");var mI=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),fI=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},gI=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},AI=function(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var r,n,o=i.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){n={error:e}}finally{try{r&&!r.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}return s},yI=function(e,t,i){if(i||2===arguments.length)for(var r,n=0,o=t.length;n<o;n++)!r&&n in t||(r||(r=Array.prototype.slice.call(t,0,n)),r[n]=t[n]);return e.concat(r||Array.prototype.slice.call(t))},vI=function(e){function t(t,i,r){var n=e.call(this,t,i,r)||this;return n.middleClosed=!1,n.outline=!0,n.hideValues=["interplate","heightReference","allowCrossGround"],n.minPointNum=2,n}return mI(t,e),t.prototype.setCoordinates=function(e,t){},t.prototype.calcuteShape=function(e,t){var i=e.map((function(e){return zy.cartesian2lonlat(e)}));return this.points=i,this.getPointCount=this.points.length,this.generate().map((function(e){var t=e;return zy.lonlat2Cartesian(t)}))},t.prototype.generate=function(){throw new Error("Method not implemented.")},t.prototype.getPoints=function(){for(var e=[],t=0,i=1;i<this.points.length;i++)if(Math.abs(this.points[i][0])+Math.abs(this.points[i-1][0])>180){this.points[i-1][0]>0&&this.points[i][0]<0?t=1:this.points[i-1][0]<0&&this.points[i][0]>0&&(t=2);break}return 1==t?(this.points.forEach((function(t){var i=yI([],AI(t),!1);i[0]<0&&(i[0]=360+i[0]),e.push(i)})),e):2==t?(this.points.forEach((function(t){var i=yI([],AI(t),!1);i[0]>0&&(i[0]=i[0]-360),e.push(i)})),e):this.points},fI([(0,fy.o)(),gI("design:type",Array)],t.prototype,"points",void 0),fI([(0,fy.o)(),gI("design:type",Number)],t.prototype,"getPointCount",void 0),t}(mS);const CI=Math.PI/2,_I=(Math.PI,(e,t)=>Math.sqrt(Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2))),bI=e=>{let t=0;return e&&Array.isArray(e)&&e.length>0&&e.forEach(((i,r)=>{r<e.length-1&&(t+=_I(i,e[r+1]))})),t},wI=e=>Math.pow(bI(e),.99),PI=(e,t)=>[(e[0]+t[0])/2,(e[1]+t[1])/2],SI=(e,t)=>{let i,r=Math.asin(Math.abs(t[1]-e[1])/_I(e,t));return t[1]>=e[1]&&t[0]>=e[0]?i=r+Math.PI:t[1]>=e[1]&&t[0]<e[0]?i=2*Math.PI-r:t[1]<e[1]&&t[0]<e[0]?i=r:t[1]<e[1]&&t[0]>=e[0]&&(i=Math.PI-r),i},xI=(e,t,i)=>{let r=SI(t,e)-SI(t,i);return r<0?r+2*Math.PI:r},BI=(e,t,i)=>(i[1]-e[1])*(t[0]-e[0])>(t[1]-e[1])*(i[0]-e[0]),MI=(e,t,i,r,n)=>{e=Math.max(Math.min(e,1),0);let[o,s]=[1-e,e*e],a=s*e,l=o*o,h=l*o;return[h*t[0]+3*l*e*i[0]+3*o*s*r[0]+a*n[0],h*t[1]+3*l*e*i[1]+3*o*s*r[1]+a*n[1]]},EI=(e,t,i,r,n)=>{let o=SI(e,t),s=n?o+i:o-i,a=r*Math.cos(s),l=r*Math.sin(s);return[t[0]+a,t[1]+l]},TI=(e,t,i,r)=>{let n=OI(t,i,r),[o,s,a,l,h]=[null,null,null,null,null],c=Math.sqrt(n[0]*n[0]+n[1]*n[1]),u=n[0]/c,p=n[1]/c,d=_I(t,i),m=_I(i,r);return c>1e-4?BI(t,i,r)?(a=e*d,l=i[0]-a*p,h=i[1]+a*u,o=[l,h],a=e*m,l=i[0]+a*p,h=i[1]-a*u,s=[l,h]):(a=e*d,l=i[0]+a*p,h=i[1]-a*u,o=[l,h],a=e*m,l=i[0]-a*p,h=i[1]+a*u,s=[l,h]):(l=i[0]+e*(t[0]-i[0]),h=i[1]+e*(t[1]-i[1]),o=[l,h],l=i[0]+e*(r[0]-i[0]),h=i[1]+e*(r[1]-i[1]),s=[l,h]),[o,s]},OI=(e,t,i)=>{let r=e[0]-t[0],n=e[1]-t[1],o=Math.sqrt(r*r+n*n);r/=o,n/=o;let s=i[0]-t[0],a=i[1]-t[1],l=Math.sqrt(s*s+a*a);return s/=l,a/=l,[r+s,n+a]},LI=function(e){if(e.length<=2)return e;{let t=[],i=e.length-1;for(let r=0;r<=1;r+=.01){let[n,o]=[0,0];for(let t=0;t<=i;t++){let s=II(i,t),a=Math.pow(r,t),l=Math.pow(1-r,i-t);n+=s*a*l*e[t][0],o+=s*a*l*e[t][1]}t.push([n,o])}return t.push(e[i]),t}},DI=e=>{let t=1;switch(e){case e<=1:t=1;break;case 2===e:t=2;break;case 3===e:t=6;break;case 24===e:t=24;break;case 5===e:t=120;break;default:for(let i=1;i<=e;i++)t*=i}return t},II=(e,t)=>DI(e)/(DI(t)*DI(e-t)),RI=e=>{if(e.length<=2)return e;{let[t,i]=[2,[]],r=e.length-t-1;i.push(e[0]);for(let n=0;n<=r;n++)for(let r=0;r<=1;r+=.05){let[o,s]=[0,0];for(let i=0;i<=t;i++){let t=HI(i,r);o+=t*e[n+i][0],s+=t*e[n+i][1]}i.push([o,s])}return i.push(e[e.length-1]),i}},HI=(e,t)=>{let i=0;return 0===e?i=Math.pow(t-1,2)/2:1===e?i=(-2*Math.pow(t,2)+2*t+1)/2:2===e&&(i=Math.pow(t,2)/2),i};var FI=i(5108),NI=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),QI=function(){return QI=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},QI.apply(this,arguments)},kI=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},UI=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},jI=function(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var r,n,o=i.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){n={error:e}}finally{try{r&&!r.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}return s},GI=function(e){function t(t,i,r){var n=e.call(this,t,i,QI({},r))||this;if(n.type="双箭头",n.headHeightFactor=.25,n.headWidthFactor=.3,n.neckHeightFactor=.85,n.neckWidthFactor=.15,n.connPoint=null,n.fixPointCount=4,n.maxPointNum=4,n.minPointNum=3,r&&r.properties)for(var o in r.properties)r.properties[o]&&(n[o]=r.properties[o]);return n}return NI(t,e),t.prototype.getPlotType=function(){return this.type},t.prototype.generate=function(){try{var e=this.getPointCount;if(e<2)return this.points;if(2===e)return this.points;var t=this.getPoints();if(e>2){var i=jI([t[0],t[1],t[2]],3),r=i[0],n=i[1],o=i[2];3===e?(this.tempPoint4=this.getTempPoint4(r,n,o),this.connPoint=PI(r,n)):4===e?(this.tempPoint4=t[3],this.connPoint=PI(r,n)):(this.tempPoint4=t[3],this.connPoint=t[4]);var s=jI([void 0,void 0],2),a=s[0],l=s[1];BI(r,n,o)?(a=this.getArrowPoints(r,this.connPoint,this.tempPoint4,!1),l=this.getArrowPoints(this.connPoint,n,o,!0)):(a=this.getArrowPoints(n,this.connPoint,o,!1),l=this.getArrowPoints(this.connPoint,r,this.tempPoint4,!0));var h=a.length,c=(h-5)/2,u=a.slice(0,c),p=a.slice(c,c+5),d=a.slice(c+5,h),m=l.slice(0,c),f=l.slice(c,c+5),g=l.slice(c+5,h);m=LI(m);var A=LI(g.concat(u.slice(1)));return d=LI(d),m.concat(f,A,p,d)}}catch(e){FI.log(e)}},t.prototype.getArrowPoints=function(e,t,i,r){var n=PI(e,t),o=_I(n,i),s=EI(i,n,0,.3*o,!0),a=EI(i,n,0,.5*o,!0),l=[n,s=EI(n,s,CI,o/5,r),a=EI(n,a,CI,o/4,r),i],h=this.getArrowHeadPoints(l);if(!(h&&Array.isArray(h)&&h.length>0))throw new Error("插值出错");var c=jI([h[0],h[4]],2),u=c[0],p=c[1],d=_I(e,t)/wI(l)/2,m=this.getArrowBodyPoints(l,u,p,d);if(m){var f=m.length,g=m.slice(0,f/2),A=m.slice(f/2,f);return g.push(u),A.push(p),(g=g.reverse()).push(t),(A=A.reverse()).push(e),g.reverse().concat(h,A)}},t.prototype.getArrowHeadPoints=function(e){try{var t=wI(e)*this.headHeightFactor,i=e[e.length-1],r=t*this.headWidthFactor,n=t*this.neckWidthFactor,o=t*this.neckHeightFactor,s=EI(e[e.length-2],i,0,t,!0),a=EI(e[e.length-2],i,0,o,!0),l=EI(i,s,CI,r,!1),h=EI(i,s,CI,r,!0);return[EI(i,a,CI,n,!1),l,i,h,EI(i,a,CI,n,!0)]}catch(e){FI.log(e)}},t.prototype.getArrowBodyPoints=function(e,t,i,r){for(var n=bI(e),o=wI(e)*r,s=(o-_I(t,i))/2,a=jI([0,[],[]],3),l=a[0],h=a[1],c=a[2],u=1;u<e.length-1;u++){var p=xI(e[u-1],e[u],e[u+1])/2,d=(o/2-(l+=_I(e[u-1],e[u]))/n*s)/Math.sin(p),m=EI(e[u-1],e[u],Math.PI-p,d,!0),f=EI(e[u-1],e[u],p,d,!1);h.push(m),c.push(f)}return h.concat(c)},t.prototype.getTempPoint4=function(e,t,i){try{var r=PI(e,t),n=_I(r,i),o=xI(e,r,i),s=jI([void 0,void 0,void 0,void 0],4),a=s[0],l=s[1],h=s[2],c=s[3];return o<CI?(l=n*Math.sin(o),h=n*Math.cos(o),c=EI(e,r,CI,l,!1),a=EI(r,c,CI,h,!0)):o>=CI&&o<Math.PI?(l=n*Math.sin(Math.PI-o),h=n*Math.cos(Math.PI-o),c=EI(e,r,CI,l,!1),a=EI(r,c,CI,h,!1)):o>=Math.PI&&o<1.5*Math.PI?(l=n*Math.sin(o-Math.PI),h=n*Math.cos(o-Math.PI),c=EI(e,r,CI,l,!0),a=EI(r,c,CI,h,!0)):(l=n*Math.sin(2*Math.PI-o),h=n*Math.cos(2*Math.PI-o),c=EI(e,r,CI,l,!0),a=EI(r,c,CI,h,!1)),a}catch(e){FI.log(e)}},t.prototype.isPlot=function(){return!0},t.prototype.setPoints=function(e){this.points=e||[],this.points.length>=1&&this.generate()},t.prototype.updatePoint=function(e,t){t>=0&&t<this.points.length&&(this.points[t]=e,this.generate())},t.prototype.updateLastPoint=function(e){this.updatePoint(e,this.points.length-1)},t.prototype.finishDrawing=function(){3===this.getPointCount&&null!==this.tempPoint4&&this.points.push(this.tempPoint4),null!==this.connPoint&&this.points.push(this.connPoint)},kI([(0,fy.o)(),UI("design:type",Object)],t.prototype,"tempPoint4",void 0),kI([(0,fy.o)(),UI("design:type",Object)],t.prototype,"connPoint",void 0),kI([(0,fy.o)(),UI("design:type",Object)],t.prototype,"headHeightFactor",void 0),kI([(0,fy.o)(),UI("design:type",Number)],t.prototype,"headWidthFactor",void 0),kI([(0,fy.o)(),UI("design:type",Number)],t.prototype,"fixPointCount",void 0),kI([(0,fy.o)(),UI("design:type",Number)],t.prototype,"neckHeightFactor",void 0),kI([(0,fy.o)(),UI("design:type",Number)],t.prototype,"neckWidthFactor",void 0),t}(vI);c.Z.registerType(GI,"EditorDoubleArrow","Graph");var zI=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),YI=function(){return YI=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},YI.apply(this,arguments)},ZI=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},WI=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},XI=function(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var r,n,o=i.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){n={error:e}}finally{try{r&&!r.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}return s},JI=function(e){function t(t,i,r){var n=e.call(this,t,i,YI({},r))||this;if(n.type="集结地",n.t=.4,n.fixPointCount=3,n.maxPointNum=3,r&&r.properties)for(var o in r.properties)n[o]=r.properties[o];return n}return zI(t,e),t.prototype.generate=function(){var e=this.getPoints(),t=this.getPointCount;if(e.length<2)return!1;if(2===t){var i=PI(e[0],e[1]),r=_I(e[0],i)/.9,n=EI(e[0],i,CI,r,!0);e=[e[0],n,e[1]]}var o=PI(e[0],e[2]);e.push(o,e[0],e[1]);for(var s=XI([[],void 0,void 0,void 0,[]],5),a=s[0],l=s[1],h=s[2],c=s[3],u=s[4],p=0;p<e.length-2;p++){l=e[p],h=e[p+1],c=e[p+2];var d=TI(this.t,l,h,c);a=a.concat(d)}var m=a.length;a=[a[m-1]].concat(a.slice(0,m-1));for(p=0;p<e.length-2;p++){l=e[p],h=e[p+1],u.push(l);for(var f=0;f<=100;f++){n=MI(f/100,l,a[2*p],a[2*p+1],h);u.push(n)}u.push(h)}return u},ZI([(0,fy.o)(),WI("design:type",Number)],t.prototype,"t",void 0),ZI([(0,fy.o)(),WI("design:type",Number)],t.prototype,"fixPointCount",void 0),t}(vI);c.Z.registerType(JI,"EditorGatheringPlace","Graph");var KI=i(5108),VI=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),qI=function(){return qI=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},qI.apply(this,arguments)},$I=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},eR=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},tR=function(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var r,n,o=i.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){n={error:e}}finally{try{r&&!r.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}return s},iR=function(e){function t(t,i,r){var n=e.call(this,t,i,qI({},r))||this;if(n.type="进攻方向",n.headHeightFactor=.18,n.headWidthFactor=.3,n.neckHeightFactor=.85,n.neckWidthFactor=.15,n.headTailFactor=.8,n.minPointNum=3,r&&r.properties)for(var o in r.properties)n[o]=r.properties[o];return n}return VI(t,e),t.prototype.generate=function(){try{var e=this.getPointCount;if(e<2)return!1;if(2===e)return this.points;var t=this.getPoints(),i=tR([t[0],t[1]],2),r=i[0],n=i[1];BI(t[0],t[1],t[2])&&(r=t[1],n=t[0]);var o=[PI(r,n)].concat(t.slice(2)),s=this.getArrowHeadPoints(o,r,n),a=tR([s[0],s[4]],2),l=a[0],h=a[1],c=_I(r,n)/wI(o),u=this.getArrowBodyPoints(o,l,h,c),p=u.length,d=[r].concat(u.slice(0,p/2));d.push(l);var m=[n].concat(u.slice(p/2,p));return m.push(h),d=RI(d),m=RI(m),d.concat(s,m.reverse())}catch(e){KI.log(e)}},t.prototype.getArrowPoints=function(e,t,i,r){var n=PI(e,t),o=_I(n,i),s=EI(i,n,0,.3*o,!0),a=EI(i,n,0,.5*o,!0),l=[n,s=EI(n,s,CI,o/5,r),a=EI(n,a,CI,o/4,r),i],h=this.getArrowHeadPoints(l);if(!(h&&Array.isArray(h)&&h.length>0))throw new Error("插值出错");var c=tR([h[0],h[4]],2),u=c[0],p=c[1],d=_I(e,t)/wI(l)/2,m=this.getArrowBodyPoints(l,u,p,d);if(m){var f=m.length,g=m.slice(0,f/2),A=m.slice(f/2,f);return g.push(u),A.push(p),(g=g.reverse()).push(t),(A=A.reverse()).push(e),g.reverse().concat(h,A)}},t.prototype.getArrowHeadPoints=function(e,t,i){try{var r=wI(e),n=r*this.headHeightFactor,o=e[e.length-1];r=_I(o,e[e.length-2]);var s=_I(t,i);n>s*this.headTailFactor&&(n=s*this.headTailFactor);var a=n*this.headWidthFactor,l=n*this.neckWidthFactor,h=(n=n>r?r:n)*this.neckHeightFactor,c=EI(e[e.length-2],o,0,n,!0),u=EI(e[e.length-2],o,0,h,!0),p=EI(o,c,CI,a,!1),d=EI(o,c,CI,a,!0);return[EI(o,u,CI,l,!1),p,o,d,EI(o,u,CI,l,!0)]}catch(e){KI.log(e)}},t.prototype.getArrowBodyPoints=function(e,t,i,r){for(var n=bI(e),o=wI(e)*r,s=(o-_I(t,i))/2,a=tR([0,[],[]],3),l=a[0],h=a[1],c=a[2],u=1;u<e.length-1;u++){var p=xI(e[u-1],e[u],e[u+1])/2,d=(o/2-(l+=_I(e[u-1],e[u]))/n*s)/Math.sin(p),m=EI(e[u-1],e[u],Math.PI-p,d,!0),f=EI(e[u-1],e[u],p,d,!1);h.push(m),c.push(f)}return h.concat(c)},t.prototype.getTempPoint4=function(e,t,i){try{var r=PI(e,t),n=_I(r,i),o=xI(e,r,i),s=tR([void 0,void 0,void 0,void 0],4),a=s[0],l=s[1],h=s[2],c=s[3];return o<CI?(l=n*Math.sin(o),h=n*Math.cos(o),c=EI(e,r,CI,l,!1),a=EI(r,c,CI,h,!0)):o>=CI&&o<Math.PI?(l=n*Math.sin(Math.PI-o),h=n*Math.cos(Math.PI-o),c=EI(e,r,CI,l,!1),a=EI(r,c,CI,h,!1)):o>=Math.PI&&o<1.5*Math.PI?(l=n*Math.sin(o-Math.PI),h=n*Math.cos(o-Math.PI),c=EI(e,r,CI,l,!0),a=EI(r,c,CI,h,!0)):(l=n*Math.sin(2*Math.PI-o),h=n*Math.cos(2*Math.PI-o),c=EI(e,r,CI,l,!0),a=EI(r,c,CI,h,!1)),a}catch(e){KI.log(e)}},$I([(0,fy.o)(),eR("design:type",Number)],t.prototype,"headHeightFactor",void 0),$I([(0,fy.o)(),eR("design:type",Number)],t.prototype,"headWidthFactor",void 0),$I([(0,fy.o)(),eR("design:type",Number)],t.prototype,"neckHeightFactor",void 0),$I([(0,fy.o)(),eR("design:type",Number)],t.prototype,"neckWidthFactor",void 0),$I([(0,fy.o)(),eR("design:type",Number)],t.prototype,"tailWidthFactor",void 0),$I([(0,fy.o)(),eR("design:type",Number)],t.prototype,"headTailFactor",void 0),$I([(0,fy.o)(),eR("design:type",Number)],t.prototype,"swallowTailFactor",void 0),$I([(0,fy.o)(),eR("design:type",Object)],t.prototype,"swallowTailPnt",void 0),t}(vI);c.Z.registerType(iR,"EditorAttackArrow","Graph");var rR=i(5108),nR=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),oR=function(){return oR=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},oR.apply(this,arguments)},sR=function(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var r,n,o=i.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){n={error:e}}finally{try{r&&!r.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}return s},aR=function(e){function t(t,i,r){var n=e.call(this,t,i,oR({},r))||this;if(n.type="进攻方向(尾)",n.headHeightFactor=.18,n.headWidthFactor=.3,n.neckHeightFactor=.85,n.neckWidthFactor=.15,n.tailWidthFactor=.1,n.headTailFactor=.8,n.swallowTailFactor=1,n.swallowTailPnt=null,r&&r.properties)for(var o in r.properties)n[o]=r.properties[o];return n}return nR(t,e),t.prototype.generate=function(){try{var e=this.getPointCount;if(e<2)return!1;if(2===e)return this.points;var t=this.getPoints(),i=sR([t[0],t[1]],2),r=i[0],n=i[1];BI(t[0],t[1],t[2])&&(r=t[1],n=t[0]);var o=[PI(r,n)].concat(t.slice(2)),s=this.getArrowHeadPoints(o,r,n),a=sR([s[0],s[4]],2),l=a[0],h=a[1],c=_I(r,n),u=wI(o),p=u*this.tailWidthFactor*this.swallowTailFactor;this.swallowTailPnt=EI(o[1],o[0],0,p,!0);var d=c/u,m=this.getArrowBodyPoints(o,l,h,d),f=m.length,g=[r].concat(m.slice(0,f/2));g.push(l);var A=[n].concat(m.slice(f/2,f));return A.push(h),g=RI(g),A=RI(A),g.concat(s,A.reverse(),[this.swallowTailPnt,g[0]])}catch(e){rR.log(e)}},t}(iR);c.Z.registerType(aR,"EditorTailedAttackArrow","Graph");var lR=i(5108),hR=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),cR=function(){return cR=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},cR.apply(this,arguments)},uR=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},pR=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},dR=function(e){function t(t,i,r){var n=e.call(this,t,i,cR({},r))||this;if(n.type="分队战斗行动(尾)",n.headHeightFactor=.18,n.headWidthFactor=.3,n.neckHeightFactor=.85,n.neckWidthFactor=.15,n.tailWidthFactor=.1,n.swallowTailFactor=1,n.swallowTailPnt=null,n.minPointNum=2,r&&r.properties)for(var o in r.properties)n[o]=r.properties[o];return n}return hR(t,e),t.prototype.generate=function(){try{if(this.getPointCount<2)return!1;var e=this.getPoints(),t=this.getTailPoints(e),i=this.getArrowHeadPoints(e,t[0],t[2]),r=i[0],n=i[4],o=this.getArrowBodyPoints(e,r,n,this.tailWidthFactor),s=o.length,a=[t[0]].concat(o.slice(0,s/2));a.push(r);var l=[t[2]].concat(o.slice(s/2,s));return l.push(n),a=RI(a),l=RI(l),a.concat(i,l.reverse(),[t[1],a[0]])}catch(e){lR.log(e)}},t.prototype.getTailPoints=function(e){var t=wI(e)*this.tailWidthFactor,i=EI(e[1],e[0],CI,t,!1),r=EI(e[1],e[0],CI,t,!0),n=t*this.swallowTailFactor;return[i,EI(e[1],e[0],0,n,!0),r]},uR([(0,fy.o)(),pR("design:type",Number)],t.prototype,"fixPointCount",void 0),t}(iR);c.Z.registerType(dR,"EditorTailedSquadCombat","Graph");var mR=i(5108),fR=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),gR=function(){return gR=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},gR.apply(this,arguments)},AR=function(e){function t(t,i,r){var n=e.call(this,t,i,gR({},r))||this;if(n.type="分队战斗行动",n.headHeightFactor=.18,n.headWidthFactor=.3,n.neckHeightFactor=.85,n.neckWidthFactor=.15,n.tailWidthFactor=.1,n.minPointNum=2,r&&r.properties)for(var o in r.properties)n[o]=r.properties[o];return n}return fR(t,e),t.prototype.generate=function(){try{if(this.getPointCount<2)return!1;var e=this.getPoints(),t=this.getTailPoints(e),i=this.getArrowHeadPoints(e,t[0],t[1]),r=i[0],n=i[4],o=this.getArrowBodyPoints(e,r,n,this.tailWidthFactor),s=o.length,a=[t[0]].concat(o.slice(0,s/2));a.push(r);var l=[t[1]].concat(o.slice(s/2,s));return l.push(n),a=RI(a),l=RI(l),a.concat(i,l.reverse())}catch(e){mR.log(e)}},t.prototype.getTailPoints=function(e){var t=wI(e)*this.tailWidthFactor;return[EI(e[1],e[0],CI,t,!1),EI(e[1],e[0],CI,t,!0)]},t}(iR);c.Z.registerType(AR,"EditorSquadCombat","Graph");var yR=i(5108),vR=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),CR=function(){return CR=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},CR.apply(this,arguments)},_R=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},bR=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},wR=function(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var r,n,o=i.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){n={error:e}}finally{try{r&&!r.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}return s},PR=function(e){function t(t,i,r){var n=e.call(this,t,i,CR({},r))||this;if(n.type="粗单尖头箭头",n.tailWidthFactor=.1,n.neckWidthFactor=.2,n.headWidthFactor=.25,n.headAngle=Math.PI/8.5,n.neckAngle=Math.PI/13,n.fixPointCount=2,n.maxPointNum=2,n.minPointNum=2,r&&r.properties)for(var o in r.properties)n[o]=r.properties[o];return n}return vR(t,e),t.prototype.generate=function(){try{if(this.getPointCount<2)return!1;var e=this.getPoints(),t=wR([e[0],e[1]],2),i=t[0],r=t[1],n=wI(e),o=n*this.tailWidthFactor,s=n*this.neckWidthFactor,a=n*this.headWidthFactor,l=EI(r,i,CI,o,!0),h=EI(r,i,CI,o,!1),c=EI(i,r,this.headAngle,a,!1),u=EI(i,r,this.headAngle,a,!0);return[l,EI(i,r,this.neckAngle,s,!1),c,r,u,EI(i,r,this.neckAngle,s,!0),h]}catch(e){yR.log(e)}},_R([(0,fy.o)(),bR("design:type",Number)],t.prototype,"headAngle",void 0),_R([(0,fy.o)(),bR("design:type",Number)],t.prototype,"neckAngle",void 0),_R([(0,fy.o)(),bR("design:type",Number)],t.prototype,"fixPointCount",void 0),t}(iR);c.Z.registerType(PR,"EditorFineArrow","Graph");var SR=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),xR=function(){return xR=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},xR.apply(this,arguments)},BR=function(e){function t(t,i,r){var n=e.call(this,t,i,xR({},r))||this;if(n.type="粗单直箭头",n.tailWidthFactor=.05,n.neckWidthFactor=.1,n.headWidthFactor=.15,n.headAngle=Math.PI/4,n.neckAngle=.17741*Math.PI,r&&r.properties)for(var o in r.properties)n[o]=r.properties[o];return n}return SR(t,e),t}(PR);c.Z.registerType(BR,"EditorAssaultDirection","Graph");var MR=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),ER=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},TR=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},OR=function(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var r,n,o=i.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){n={error:e}}finally{try{r&&!r.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}return s},LR=function(e,t,i){if(i||2===arguments.length)for(var r,n=0,o=t.length;n<o;n++)!r&&n in t||(r||(r=Array.prototype.slice.call(t,0,n)),r[n]=t[n]);return e.concat(r||Array.prototype.slice.call(t))},DR=function(e){function t(t,i,r){var n=e.call(this,t,i,r)||this;return n.middleClosed=!1,n}return MR(t,e),t.prototype.setCoordinates=function(e,t){},t.prototype.calcuteShape=function(e,t){var i=e.map((function(e){return zy.cartesian2lonlat(e)}));this.points=i,this.getPointCount=this.points.length;var r=this.generate();return r||(r=[]),r.map((function(e){var t=e;return zy.lonlat2Cartesian(t)}))},t.prototype.generate=function(){throw new Error("Method not implemented.")},t.prototype.getPoints=function(){for(var e=[],t=0,i=1;i<this.points.length;i++)if(Math.abs(this.points[i][0])+Math.abs(this.points[i-1][0])>180){this.points[i-1][0]>0&&this.points[i][0]<0?t=1:this.points[i-1][0]<0&&this.points[i][0]>0&&(t=2);break}return 1==t?(this.points.forEach((function(t){var i=LR([],OR(t),!1);i[0]<0&&(i[0]=360+i[0]),e.push(i)})),e):2==t?(this.points.forEach((function(t){var i=LR([],OR(t),!1);i[0]>0&&(i[0]=i[0]-360),e.push(i)})),e):this.points},ER([(0,fy.o)(),TR("design:type",Array)],t.prototype,"points",void 0),ER([(0,fy.o)(),TR("design:type",Number)],t.prototype,"getPointCount",void 0),t}(lM),IR=i(5108),RR=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),HR=function(){return HR=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},HR.apply(this,arguments)},FR=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},NR=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},QR=function(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var r,n,o=i.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){n={error:e}}finally{try{r&&!r.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}return s},kR=function(e){function t(t,i,r){var n=e.call(this,t,i,HR({},r))||this;if(n.type="细直箭头",n.maxPointNum=2,n.maxArrowLength=3e6,n.arrowLengthScale=5,Object.defineProperty(n,"moveHeight",{configurable:!0,enumerable:!0,get:function(){}}),r&&r.properties)for(var o in r.properties)n[o]=r.properties[o];return n}return RR(t,e),t.prototype.generate=function(){try{if(this.getPointCount<2)return!1;var e=this.getPoints(),t=QR([e[0],e[1]],2),i=t[0],r=t[1],n=_I(i,r);if(n<=0)return;var o=n/this.arrowLengthScale;return o=o>this.maxArrowLength?this.maxArrowLength:o,[i,r,EI(i,r,Math.PI/6,o,!1),r,EI(i,r,Math.PI/6,o,!0)]}catch(e){IR.log(e)}},FR([(0,fy.o)(),NR("design:type",Number)],t.prototype,"maxArrowLength",void 0),FR([(0,fy.o)(),NR("design:type",Number)],t.prototype,"arrowLengthScale",void 0),t}(DR);c.Z.registerType(kR,"EditorStraightLineArrow","Graph");var UR=i(6932),jR=i(2965),GR=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),zR=function(){return zR=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},zR.apply(this,arguments)},YR=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},ZR=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},WR=function(e,t,i,r){return new(i||(i=Promise))((function(n,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?n(e.value):function(e){return e instanceof i?e:new i((function(t){t(e)}))}(e.value).then(s,a)}l((r=r.apply(e,t||[])).next())}))},XR=function(e,t){var i,r,n,o,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,r&&(n=2&o[0]?r.return:o[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,o[1])).done)return n;switch(r=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(n=s.trys,(n=n.length>0&&n[n.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){s.label=o[1];break}if(6===o[0]&&s.label<n[1]){s.label=n[1],n=o;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(o);break}n[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{i=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},JR=function(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],r=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},KR=(i(8405),function(e){function t(t,i,r){var n=e.call(this,t,i,zR({type:"路径规划线"},r))||this;if(n.recalculate$=new th.x,n.needRedraw=!1,n.routers=[],n.type="路径规划线",n.minPointNum=2,n.maxPointNum=2,n.recalculate$.pipe((0,jR.b)(500)).subscribe((function(e){n.calculate()})),r&&r.properties)for(var o in r.properties)n[o]=r.properties[o];return n}return GR(t,e),t.prototype.setPrimitivePosition=function(t){var i,r;t[0]||(t=t.slice(1)),t=t.filter((function(e){return e}));var n=[],o=function(e){0==n.filter((function(t){return Cesium.Cartesian3.equals(t,e)})).length&&n.push(e)};try{for(var s=JR(t),a=s.next();!a.done;a=s.next()){o(a.value)}}catch(e){i={error:e}}finally{try{a&&!a.done&&(r=s.return)&&r.call(s)}finally{if(i)throw i.error}}0!=(t=n).length&&(this.last_pos=null,e.prototype.createEnt.call(this,t))},t.prototype.finish=function(){e.prototype.finish.call(this),this.recalculate$&&this.recalculate$.next(!0)},t.prototype.resetControlPosition=function(t){e.prototype.resetControlPosition.call(this,t),this.recalculate$&&this.recalculate$.next(!0)},t.prototype.calcuteShape=function(t,i){if(!this.routers||this.routers.length<2)return e.prototype.calcuteShape.call(this,t,i);t=this.routers,this.setInternalControlPosition(this._singleControlPosition,i);for(var r=[],n=[0],o=[],s=0,a=0;a<t.length-1;a++){var l=Cesium.Cartesian3.distance(t[a],t[a+1]);o.push(l),s+=l}for(var h=0;h<o.length;h++)n.push(o[h]/s+n[h]);if(this.interplate){r=[],this.interopLine=Cesium.HermiteSpline.createNaturalCubic({times:n,points:t});for(var c=10*t.length,u=0;u<=c;u++){var p=this.interopLine.evaluate(u/c);r.push(p)}}else this.interopLine=new Cesium.LinearSpline({times:n,points:t});return t},t.prototype.calculate=function(){return WR(this,void 0,void 0,(function(){var e,t,i,r,n,o,s,a,l,h,c,u,p,d,m,f,g;return XR(this,(function(A){switch(A.label){case 0:return this.ctrlPosition.length<2?[2]:(e=this.ctrlPosition[0],t=this.ctrlPosition[this.ctrlPosition.length-1],i='https://api.tianditu.gov.cn/drive?postStr={"orig":"'.concat(e.lon,",").concat(e.lat,'","dest":"').concat(t.lon,",").concat(t.lat,'","style":"0"}&type=search&tk=491891e3aa43f2e0d8530ff44e831952'),[4,fetch(i)]);case 1:return[4,A.sent().text()];case 2:if(r=A.sent(),n=new UR.XMLParser,o=n.parse(r),null!=(s=o.result.routelatlon)){a=s.split(";"),l=[];try{for(h=JR(a),c=h.next();!c.done;c=h.next())u=c.value,2==(p=u.split(",")).length&&(d=[Number.parseFloat(p[0]),Number.parseFloat(p[1])],m=zy.lonlat2Cartesian([d[0],d[1]]),l.push(m))}catch(e){f={error:e}}finally{try{c&&!c.done&&(g=h.return)&&g.call(h)}finally{if(f)throw f.error}}return this.routers=l,this.setPrimitivePosition(this.routers),[2]}return[2]}}))}))},YR([(0,fy.o)(),ZR("design:type",th.x)],t.prototype,"recalculate$",void 0),YR([(0,fy.o)(),ZR("design:type",Boolean)],t.prototype,"needRedraw",void 0),t}(lM));const VR=KR;c.Z.registerType(KR,"EditorRoutePolyline","Graph");var qR=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),$R=function(){return $R=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},$R.apply(this,arguments)},eH=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},tH=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},iH=function(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],r=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},rH=function(e){function t(t,i,r){var n=e.call(this,t,i,$R({},r))||this;if(n.minPointNum=2,n.type="立体线-墙",n.color="#00FF00",n.alpha=.8,n.moveHeight=null,r&&r.properties)for(var o in r.properties)n[o]=r.properties[o];return n}return qR(t,e),Object.defineProperty(t.prototype,"lineHeight",{get:function(){return this._lineHeight},set:function(e){this._lineHeight=e,this.redraw()},enumerable:!1,configurable:!0}),t.prototype.internalmoveHeight=function(e,t){var i,r,n=this.getCenter(),o=zy.getHeightByCartesian3(n,this.viewer),s=this.ChangeLengthByMouse(o,t.y-e.y,1),a=[];try{for(var l=iH(this._singleControlPosition),h=l.next();!h.done;h=l.next()){var c=h.value,u=zy.getHeightByCartesian3(c,this.viewer)-o+s;u<0&&(u=0),a.push(zy.getHeightdefineByXYZ(c,u,this.viewer))}}catch(e){i={error:e}}finally{try{h&&!h.done&&(r=l.return)&&r.call(l)}finally{if(i)throw i.error}}this._singleControlPosition=a,this.onPropertyChanged()},t.prototype.initProps=function(e){},t.prototype.initShape=function(){var e=this;this.positionProperty=function(){var t=e._singleControlPosition;t&&e.setPrimitivePosition(t)},this.ent={},this.createEnt([]),this.fillShape(this.ent)},t.prototype.createEnt=function(e){if(!ty.Cartesian3ArrayEqual(this.last_pos,e)&&(this.last_pos=e,e&&!(e.length<=1))){this.p&&this.viewer.scene.primitives.remove(this.p);var t=Cesium.WallGeometry.fromConstantHeights({positions:e,minimumHeight:0,maximumHeight:this.lineHeight}),i=Cesium.WallGeometry.createGeometry(t),r=new Cesium.GeometryInstance({geometry:i,id:this.id}),n=Cesium.Material.fromType("Color");this.setColor(n),this.p=new Cesium.Primitive({geometryInstances:r,appearance:new Cesium.MaterialAppearance({material:n}),vertexCacheOptimize:!0,interleave:!1,compressVertices:!0,releaseGeometryInstances:!0,asynchronous:!1,allowPicking:!0,show:!0}),this.viewer.scene.primitives.add(this.p),this.fillShape(this.p),this.ent=this.p}},t.prototype.calcuteShape=function(e,t){if(e.length<this.minPointNum)return[];return this.setInternalControlPosition(e,t),e},t.prototype.setPrimitivePosition=function(e){e[0]||(e=e.slice(1)),this.setInternalControlPosition(e),this.createEnt(e)},t.prototype.flashPrimitive=function(){this.p.show=!this.p.show},t.prototype.toGeoJsonGeometry=function(){var e,t,i={type:"LineString",coordinates:[]};try{for(var r=iH(this.ctrlPosition),n=r.next();!n.done;n=r.next()){var o=n.value;i.coordinates.push([o.lon,o.lat,o.alt])}}catch(t){e={error:t}}finally{try{n&&!n.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}return i},t.prototype.redraw=function(){this.last_pos=null,this.createEnt(this._singleControlPosition)},eH([(0,fy.o)(),tH("design:type",Object)],t.prototype,"last_pos",void 0),eH([(0,fy.o)(),dy({name:"线高度",group:"外观",type:"number",order:8,min:1,max:1e5}),tH("design:type",Number),tH("design:paramtypes",[Number])],t.prototype,"lineHeight",null),eH([(0,fy.o)(),tH("design:type",Function),tH("design:paramtypes",[Cesium.Cartesian2,Cesium.Cartesian2]),tH("design:returntype",void 0)],t.prototype,"internalmoveHeight",null),t}(ZP);const nH=rH;c.Z.registerType(rH,"EditorGeometryWall","Graph");var oH=i(5108),sH=function(){function e(){}return e.createObj0=function(t,i,r,n){var o;if(t.gvolType||t.obj&&(t=JSON.parse(JSON.stringify(t).replace(/obj/g,"gvolType"))),t.isCustom){if(t.gvolType)var s=c.Z.typesMap[t.gvolType];if(!s)return void oH.warn("无效的标绘类型，请认真阅读接口指南");o=new s(i,r,t)}else switch(t.gvolType&&(t.gvolType=t.gvolType.replace("Editor","")),t.gvolType){case"RedFlag":o=new lB(i,r,t);break;case"Image":o=new nB(i,r,t);break;case"HtmlImage":o=new dI(i,r,t);break;case"Point":o=new mB(i,r,t);break;case"Model":o=new JS(i,r,t);break;case"PinText":o=new wB(i,r,t);break;case"PinMakiIcon":case"PinIcon":o=new MB(i,r,t);break;case"PinImage":o=new nx(i,r,t);break;case"PinCanvas":o=new IB(i,r,t);break;case"Polygon":o=new mS(i,r,t);break;case"Arrow1":o=new NB(i,r,t);break;case"Circle":o=new PS(i,r,t);break;case"Ellipse":o=new jB(i,r,t);break;case"Rectangle":o=new qP(i,r,t);break;case"RectangleExpand":o=new CS(i,r,t);break;case"Frustum":o=new KB(i,r,t);break;case"Text":o=new cE(i,r,t);break;case"Polyline":o=new lM(i,r,t);break;case"Bezier1":o=new AM(i,r,t);break;case"Bezier2":o=new _M(i,r,t);break;case"BezierN":o=new dM(i,r,t);break;case"BezierSpline":o=new xM(i,r,t);break;case"Curve":o=new TM(i,r,t);break;case"CircleArc":o=new IM(i,r,t);break;case"PointLine":o=new kM(i,r,t);break;case"PointSpline":o=new nE(i,r,t);break;case"JBLine":o=new fE(i,r,t);break;case"JBPointObject":o=new wE(i,r,t,n);break;case"JBPointScreen":o=new IE(i,r,t,n);break;case"Radar":o=new YE(i,r,t);break;case"CommunicateWave":o=new sT(i,r,t);break;case"Particle":o=new hx(i,r,t);break;case"Cloud":o=new fT(i,r,t);break;case"GeometryPolygon":o=new XT(i,r,t);break;case"GeometryPolyline":o=new aO(i,r,t);break;case"GeometryWall":o=new nH(i,r,t);break;case"GeometryMultiPolygon":o=new vO(i,r,t);break;case"GeometryMultiPolyline":o=new xO(i,r,t);break;case"GeojsonMultiPolygon":o=new tL(i,r,t);break;case"GeojsonMultiPolyline":o=new mL(i,r,t);break;case"GeojsonPolygon":o=new _L(i,r,t);break;case"GeojsonPolyline":o=new ML(i,r,t);break;case"CubeBox":o=new NS(i,r,t);break;case"Ellipsoid":o=new _T(i,r,t);break;case"Cylinder":o=new MT(i,r,t);break;case"PlaneText":o=new sI(i,r,t);break;case"Sector":o=new IT(i,r,t);break;case"PointArc":o=new kT(i,r,t);break;case"JB":o=e.createJb(i,r,t);break;case"RouteText":o=new ZM(i,r,t);break;case"AreaText":o=new eE(i,r,t);break;case"DoubleArrow":o=new GI(i,r,t);break;case"GatheringPlace":o=new JI(i,r,t);break;case"AttackArrow":o=new iR(i,r,t);break;case"TailedAttackArrow":o=new aR(i,r,t);break;case"SquadCombat":o=new AR(i,r,t);break;case"TailedSquadCombat":o=new dR(i,r,t);break;case"AssaultDirection":o=new BR(i,r,t);break;case"FineArrow":o=new PR(i,r,t);break;case"StraightLineArrow":o=new kR(i,r,t);break;case"RoutePolyline":o=new VR(i,r,t);break;default:return void oH.warn("无效的标绘类型，请认真阅读接口指南")}for(var a in t)o[a]=t[a];return o instanceof ZP?o.initCtls(!1):o.initCtls(),o.initShape(),o},e.createJb=function(e,t,i){var r=e.code;return r?r.includes("-0")?"object"==e.showMode?new wE(e,t,i):new IE(e,t,i):new fE(e,t,i):(oH.log("missing jbcode param"),null)},e}(),aH=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),lH=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},hH=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},cH=function(e,t,i,r){return new(i||(i=Promise))((function(n,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?n(e.value):function(e){return e instanceof i?e:new i((function(t){t(e)}))}(e.value).then(s,a)}l((r=r.apply(e,t||[])).next())}))},uH=function(e,t){var i,r,n,o,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,r&&(n=2&o[0]?r.return:o[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,o[1])).done)return n;switch(r=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(n=s.trys,(n=n.length>0&&n[n.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){s.label=o[1];break}if(6===o[0]&&s.label<n[1]){s.label=n[1],n=o;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(o);break}n[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{i=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},pH=function(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],r=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},dH=i(3502);const mH=function(e){function t(i,r,n){var o=e.call(this)||this;return o._isChanged=!1,o.graphList=[],o._graphicList=[],o.treeList=[],"undefined"==typeof window||(o.cesService=n,window.gm=o,o.sg=py.getInstance(),o.config=r,o.engine=i,o.serviceManager=i.serviceManager,o.viewer=i.viewer,o._animationManager=new Xx(o.viewer),o.layer=o.viewer.entities.getOrCreateEntity(o.config.layerId),o.editor=new gx(o.engine,o.config.editAfterCreate,o.config.isReadOnly,o.config.operatorEnable,o.layer),o.editor.onExport=function(e){var t=o.classToPlain(e),i=JSON.stringify(t),r=new Blob([i],{type:"text/json"}),n=document.createElement("a");n.download=e.name+".json",n.href=window.URL.createObjectURL(r),n.click()},t.baseJbUrl=r.baseJbUrl),o}return aH(t,e),Object.defineProperty(t,"svgCache",{get:function(){return t._svgCache||(t._svgCache=new Map),t._svgCache},enumerable:!1,configurable:!0}),t.getPng=function(e){return dH.algorithm.getPng(e)},t.getJbData=function(e){return t.baseJbUrl+e},Object.defineProperty(t.prototype,"isChanged",{get:function(){return this._isChanged||null!=this.graphList.find((function(e){return 1==e.graph.isChanged}))},enumerable:!1,configurable:!0}),t.prototype.resetChanged=function(){var e,t;this._isChanged=!1;try{for(var i=pH(this.graphList),r=i.next();!r.done;r=i.next()){r.value.graph.isChanged=!1}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}},Object.defineProperty(t.prototype,"graphicList",{get:function(){var e=this;return this._graphicList=[],this.graphList.forEach((function(t){e._graphicList.push(t.graph)})),this._graphicList},enumerable:!1,configurable:!0}),t.prototype.showUnClusteredPoint=function(){if(this.sg.gxCluster._customDataSource.clustering._billboardCollection){var e=this.sg.gxCluster._customDataSource.clustering._billboardCollection._billboards.filter((function(e){return e._clusterShow})).map((function(e){return e.id.id}));this.graphList.filter((function(t){return e.includes(t.graph.clusterPoint.id)})).forEach((function(e){return e.graph.props.show.value=!0}))}},Object.defineProperty(t.prototype,"animationManager",{get:function(){return this._animationManager},enumerable:!1,configurable:!0}),t.prototype.start=function(){this.editor.start()},t.prototype.destroyHandler=function(){this.editor&&this.editor.destroyHandler()},t.prototype.create=function(e){var t=this.createObj(e);return t?(t.graphList=this.graphList,this.editor.create(t)):null},t.prototype.pickOrCreate=function(){},t.prototype.removeDrawItem=function(e){var t;if(this.graphList.length>0){var i=null===(t=this.graphList.find((function(t){return t.graph.id==e.id})))||void 0===t?void 0:t.graph;i&&this.delete(i)}},t.prototype.cancelCreate=function(){this.editor.cancelCreate(),this.deleteAll()},t.prototype.draw=function(e){var t=this.createObj(e);return t?(t.show=!0,this.graphList.push(t),t.graphList=this.graphList,this.editor.draw(t)):null},t.prototype.delete=function(e){var t=void 0;if(e){e.delete&&e.delete();var i=(t=e).id,r=this.graphList.find((function(e){return e.graph.id==i}));ty.Remove(this.graphList,r)}else(t=this.editor.deleteSelectGraph())&&this.graphList.remove(t);return this._isChanged=!0,t},t.prototype.clean=function(){this.graphList.forEach((function(e){e.graph.delete()})),this.graphList.splice(0,this.graphList.length),this._isChanged=!0,this.sg.gxCluster&&this.sg.gxCluster.removeFromEarth()},t.prototype.deleteAll=function(){this.clean()},t.prototype.close=function(){this.clean(),this.editor.removeOperator()},t.prototype.load=function(e){var t,i,r=this;e.graphs.map((function(e){null!=e&&r.draw(e)}));try{for(var n=pH(this.graphList),o=n.next();!o.done;o=n.next()){var s=o.value;s.graph.show=s.graph.show,s.graph.anchorHelper&&(s.graph.anchorHelper=(0,Ux.d8)(Vy,s.graph.anchorHelper),s.graph.anchorHelper.viewer=this.viewer,Vy.cesService=this.cesService)}}catch(e){t={error:e}}finally{try{o&&!o.done&&(i=n.return)&&i.call(n)}finally{if(t)throw t.error}}this._animationManager.load(e.animations),this.viewPoint=e.viewPoint,this._isChanged=!1},t.prototype.flyTo=function(e){this.viewPoint},t.prototype.classToPlain=function(e){return(0,Ux.zb)(e)},t.prototype.save=function(){var e,t,i=[];try{for(var r=pH(this.graphList),n=r.next();!n.done;n=r.next()){var o=n.value,s=void 0;o.graph.anchorHelper&&(s=this.classToPlain(o.graph.anchorHelper));var a=this.classToPlain(o.graph);a.anchorHelper=s,i.push(a)}}catch(t){e={error:t}}finally{try{n&&!n.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}return{graphs:i,animations:this.animationManager.save()}},t.prototype.toGeoJson=function(e,t){var i,r,n={type:"Feature",properties:{},geometry:{type:"Point",coordinates:[1,2]}},o=Object.keys(e).remove("_ctrlPosition");try{for(var s=pH(o),a=s.next();!a.done;a=s.next()){var l=a.value;n.properties[l]=e[l]}}catch(e){i={error:e}}finally{try{a&&!a.done&&(r=s.return)&&r.call(s)}finally{if(i)throw i.error}}return n.geometry=t,n},t.prototype.createObj=function(e){var i=sH.createObj0(e,this.engine,this.layer,t.baseJbUrl);return this._isChanged=!0,i&&i.ent?i.ent:null},t.prototype.loadResource=function(e){return cH(this,void 0,void 0,(function(){var t,i,r=this;return uH(this,(function(n){switch(n.label){case 0:return this.config.clusterEnable?[4,this.serviceManager.clusterService.clusterConfig]:[3,2];case 1:(t=n.sent()).setImage=function(e,i){var n=e.map((function(e){return e._id}));r.graphList.filter((function(e){return n.includes(e.graph.clusterPoint.id)})).forEach((function(e){return e.graph.props.show.value=!1})),t.setImage1(e,i)},this.sg.gxCluster=new qx(this.viewer,t),this.sg.gxClusterOption=t,this.sg.gxCluster.addToEarth(),this.viewer.camera.changed.addEventListener((function(){setTimeout((function(){r.showUnClusteredPoint()}),50)}),{passive:!0}),n.label=2;case 2:return e?[4,this.serviceManager.httpService.getData(e)]:[3,4];case 3:i=n.sent(),this.treeList=i,n.label=4;case 4:return this.serviceManager.plotService.storageJbs=JSON.parse(localStorage.getItem("recently"))||[],[2]}}))}))},t.prototype.parseIcons=function(e,t){return cH(this,void 0,void 0,(function(){return uH(this,(function(i){return this.iconsTreeDataResolve(e,t),this.iconsTreeHideFile(e),[2]}))}))},t.prototype.iconsTreeHideFile=function(e){var t=this;e.parent&&!e.children&&delete e.parent.children,e.children&&e.children.length>0&&e.children.forEach((function(e){return t.iconsTreeHideFile(e)}))},t.prototype.iconsTreeDataResolve=function(e,t){var i=this;if(e.kind=t,"model"===t&&e.path&&(e.path=e.path.replace(/\\/g,"/")),"image"===t&&e.path&&(e.path=e.path.replace(/\\/g,"/")),e.data&&e.data.codeName){var r=e.data.codeName.lastIndexOf("-"),n=e.data.codeName.substr(0,r);if("1"===e.data.codeName[r-1]){var o={code:n,color:"#ff0000",name:e.label,obj:"JB"};e.params=o,e.kind="jbline1";var s=e.path.indexOf("军事标绘");e.path.substr(s,e.path.length-s);e.imagePath=e.path,delete e.extension}else if(e.data.noSvg)e.kind="image";else if(e.data.codeName.includes("-0-")){o={code:n,color:"#ff0000",name:e.label,obj:"JB",offsetX:e.data.offsetX,offsetY:e.data.offsetY};e.jbId=n,e.params=o,delete e.extension}}e.children&&e.children.length>0&&(e.data=e.children,e.children.forEach((function(t){return t.parent=e})),e.children.forEach((function(e){i.iconsTreeDataResolve(e,t)})))},lH([(0,fy.o)(),hH("design:type",Object)],t.prototype,"cesService",void 0),t}(p);var fH,gH=i(5108),AH=function(e,t,i,r){return new(i||(i=Promise))((function(n,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?n(e.value):function(e){return e instanceof i?e:new i((function(t){t(e)}))}(e.value).then(s,a)}l((r=r.apply(e,t||[])).next())}))},yH=function(e,t){var i,r,n,o,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,r&&(n=2&o[0]?r.return:o[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,o[1])).done)return n;switch(r=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(n=s.trys,(n=n.length>0&&n[n.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){s.label=o[1];break}if(6===o[0]&&s.label<n[1]){s.label=n[1],n=o;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(o);break}n[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{i=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},vH=function(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],r=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},CH=function(){function e(e){this.geopptServicePlaceHolder="-gsph-",this.resourceTypeOpen=new th.x,this.resourceTypeClose=new th.x,this.showSelectionSub$=new th.x,this.curJb=null,this.curPlots=[],this._showFrameSelection=!1,this.detailFlag=!1,this.attrsFlag=!0,this.createFlag=!0,this.layerName="",this.layerId="",this.currentLayer=null,this.asideFlag=!1,this.copyFlag=!1,this.lockFlag=!1,this.$subject=new th.x,this.recentlyUsedJbArray=[],this.scalable=!0,this.rotatable=!0,this.scenarioList=[],this.isEmptyForLabel=!0,this.isRefresh=new th.x,this.savePageGraphBoardsSub$=new th.x,this.savePageGraphAnchorsSub$=new th.x,this.isCrossSelectedNodes2Or3="",this.clearCrossSelectedNodes$=new th.x,this.layerComponentRefresh$=new th.x,this.litener=function(){},this.onSelectChanged=new th.x,this.copystr=void 0,this.serviceManager=e.serviceManager,this._engine=e,this._viewer=e.viewer,this.fontMode=["微软雅黑","宋体","仿宋","楷体","隶书","幼圆","黑体"],this.fontSize=[12,14,16,18,20,22,24,26,28,36,48,60,72,84,96,108,120,132,144,156],this.lineWidth=[{label:"1",value:1},{label:"2",value:2},{label:"3",value:3},{label:"4",value:4},{label:"5",value:5}],this.rightClickPosition=new _H;var t=localStorage.getItem("pasteLocation");this.pasteLocation=!t||"true"==t}return Object.defineProperty(e.prototype,"gm",{get:function(){return this._gm||(this._gm=this.createOrEdit(this._baseUrl)),this._gm},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"showFrameSelection",{get:function(){return this._showFrameSelection},set:function(e){this._showFrameSelection=e,this.showSelectionSub$.next(!1)},enumerable:!1,configurable:!0}),e.prototype.initConfig=function(){this.layerIpReg=new RegExp(window.config.geopptService,"g"),this.placeHolderReg=new RegExp(this.geopptServicePlaceHolder,"g")},e.prototype.controlScale=function(e){gH.log("scale: ",e),!e.o.scalable&&e.o.ent.billboard?e.o.ent.billboard.scale=e.value:e.o.ent&&e.o.ent.billboard&&(e.o.ent.billboard.scale=new Cesium.CallbackProperty((function(t,i){return e.value}),!0))},e.prototype.contains=function(e,t){try{if(null==t||null==t||0==t.length||null==e||null==e)return!1;var i=new RegExp(t,"ig"),r=t.charCodeAt(0);if(r>=19968&&r<=40869){var n=e.match(i);if(null==n||0==n.length)return!1}else{var o=this.serviceManager.pinyinTool.makePy(e);if(null==o||0==o.length)return!1;var s=o[0].match(i);if(null==s||0==s.length)return!1}}catch(e){gH.log(e)}return!0},e.prototype.addPlot=function(e,t,i){if(i.stopPropagation(),e){if(["geojson","kml"].indexOf(e.kind)>-1)return!0;if("html"!=e.kind){var r=null,n=e.label;if("jb"==e.kind||"jbnew"==e.kind)r={obj:"JB",code:e.jbId,offsetX:e.data.offsetX,offsetY:e.data.offsetY,showMode:t?"screen":"object",name:n};else if("model"==e.kind){Sw.deServiceIp;r={obj:"Model",uri:Sw.geopptServiceIp+"/"+"".concat(e.path),scalev:100,minimumPixelSize:20,alpha:1}}else if(e.extension)switch(e.extension){case".png":case".jpeg":case".jpg":r={obj:"PinImage"},e.path&&(r.image="".concat(this.picPublicPath).concat(e.path)),t||(r.obj="Image");break;case".gif":r={obj:"HtmlImage"},e.path&&(r.imageUrl="".concat(this.picPublicPath).concat(e.path))}else(r=EP.deepClone(e.params)).image&&(r.image=MP.formatURL(r.image));e.gvolType&&(r.gvolType=e.gvolType),r.name=n,this.gm.create(r),this.setRecentlyUsedJb(e),gH.log("点击",e),this.plot_icon=e.path}}},e.prototype.draw=function(e,t,i,r){void 0===r&&(r=!0);var n=this.gm.draw(e);if(n){var o=n.graph;return o.iconName=t,o.name=i,r&&this.isRefresh.next([o]),o}return null},e.prototype.drawObj=function(e){this.gm.graphList.push(e)},e.prototype.setRecentlyUsedJb=function(e){var t=this.storageJbs.length;!!t&&this.storageJbs.find((function(t){return t.label===e.label}))||(t>=4&&this.storageJbs.shift(),e.parent&&delete e.parent,e.hover=!1,this.storageJbs.push(JSON.parse(JSON.stringify(e))),localStorage.setItem("recently",JSON.stringify(this.storageJbs)))},Object.defineProperty(e.prototype,"editItem",{get:function(){return this._editItem},set:function(e){this._editItem instanceof rv&&this.editItem.propertyChanged.removeEventListener(this.litener),this._editItem=e,this._editItem&&(this.serviceManager.geojsonPlotService.currentGeojson=null),e instanceof rv&&e.propertyChanged.addEventListener(this.litener)},enumerable:!1,configurable:!0}),e.prototype.createOrEdit=function(e,t){var i=this;void 0===t&&(t=null);var r=Sw.deServiceIp,n=new mH(this._engine,{layerId:"plot"+Yy.newGuid(),editAfterCreate:!0,baseJbUrl:r+"api/jb/jbsvg/",operatorEnable:!0,clusterEnable:!1,isReadOnly:!1},"");if(n.loadResource(e),n.editor.hideHTMLBoxesOperatorSub$.subscribe((function(){i.serviceManager.htmlDrawService.hideOperator()})),n.editor.stopContextMenu$.subscribe((function(e){i.rightClickPosition.showPasteButton=!1})),n.editor.isCrossSelectedNodes2Or3Sub$.subscribe((function(e){i.isCrossSelectedNodes2Or3=e})),t){var o=JSON.stringify(t);t=JSON.parse(o),n.load(t),t.html,t.geojson&&this.serviceManager.geojsonPlotService.setListByData(t.geojson,!0),t.bigfile&&(gH.log("json bigfile",t.bigfile),this.serviceManager.drawbigfileService.setListByData(t.bigfile)),t.music&&this.serviceManager.musicService.recoverData(t.music)}return this.plotList=n.graphList,n.editor.onEditCollectionChanged=function(e){i.isRefresh.next(e),e&&e.length>0?(i.editItem=1==e.length?e[0]:e,i.asideFlag=!0,i.detailFlag=!0,i.attrsFlag=!0,e.length,i.onSelectChanged.next(i.editItem)):(i.editItem=void 0,IP.currentBoxList.length&&!IP.currentEditGraphList.length&&n.editor.isCtrlPressed?i.onSelectChanged.next(IP.currentBoxList[0]):IP.currentEditGraphList.length||i.onSelectChanged.next(null)),i.litener()},n},e.prototype.clean=function(){this.gm&&(this.gm.close(),this.gm.animationManager.destroy()),this.serviceManager.geojsonPlotService.clearGjPlot(),this.serviceManager.drawbigfileService.cleanAll()},e.prototype.createEntityName=function(e){if(!this.plotList||0==this.plotList.length)return e;for(var t=0,i=function(){var i=0===t||1===t?e:"".concat(e,"(").concat(t,")");if(null==r.plotList.find((function(e){return e.graph.name===i})))return{value:i};t++},r=this;;){var n=i();if("object"==typeof n)return n.value}},e.prototype.saveData=function(e,t){return AH(this,void 0,void 0,(function(){var t,i;return yH(this,(function(r){switch(r.label){case 0:return e.gm&&delete e.gm,[4,this.serviceManager.configService.getDeServiceIp()];case 1:return t=r.sent(),t+"api/scenes",i=new RegExp(t,"g"),e.content=e.content.replace(i,"hellogeovis"),[2]}}))}))},e.prototype.saveScenarios=function(){return AH(this,void 0,void 0,(function(){var e,t,i,r,n,o,s,a,l;return yH(this,(function(h){switch(h.label){case 0:this.serviceManager.geojsonPlotService.isEditing=!1,h.label=1;case 1:if(h.trys.push([1,10,,11]),e=this.gm.save(),t=(t=JSON.stringify(e)).replace(this.layerIpReg,this.geopptServicePlaceHolder),(e=JSON.parse(t)).geojson=this.serviceManager.geojsonPlotService.getListDataToSave(),e.bigfile=this.serviceManager.drawbigfileService.getListDataToSave(),e.tree=this.serviceManager.layerService.save(),e.music=this.serviceManager.musicService.saveData(),!(e.graphs&&Array.isArray(e.graphs)&&Array.isArray(e.graphs)))return[3,9];h.label=2;case 2:h.trys.push([2,7,8,9]),i=vH(e.graphs),r=i.next(),h.label=3;case 3:return r.done?[3,6]:!(n=r.value).resourceId||n.ossUrl?[3,5]:(gH.log("装配云地址>>>>"),[4,QO(n.resourceId,n._name)]);case 4:o=h.sent(),gH.log("获取云地址结果>>>>",o),o&&"string"!=typeof o&&(n.ossUrl=o.ossUrl),h.label=5;case 5:return r=i.next(),[3,3];case 6:return[3,9];case 7:return s=h.sent(),a={error:s},[3,9];case 8:try{r&&!r.done&&(l=i.return)&&l.call(i)}finally{if(a)throw a.error}return[7];case 9:return gH.log("保存contentObj>>>",e),[2,e];case 10:return h.sent(),gH.log("保存出错"),[2,void 0];case 11:return[2]}}))}))},e.prototype.changeSelect=function(e){this.gm&&(e instanceof Array?this.gm.editor.currentEditGraphList=e:this.gm.editor.currentEditGraph=e)},e.prototype.removeAll=function(){this.gm&&this.gm.deleteAll(),this.editItem=null,this.plotList=[]},e.prototype.clear=function(){this.detailFlag=!1},e.prototype.copy=function(e,t,i){var r=this;if(gH.log("当前选中的 ",e),e){var n;if(e instanceof rv){if(n={type:"plot",data:this.gm.classToPlain(e)},i&&i.size>0){var o=i.get(e.id);o&&(n.data.name=o,n.data._name=o)}}else if(e instanceof Array&&e[0]instanceof rv){var s=[];e.forEach((function(e){s.push(r.gm.classToPlain(e))})),n={type:"plotArray",data:(0,Ux.ZE)(s)},i&&i.size>0&&n.data.forEach((function(e){var t=i.get(e.id);t&&(e.name=t,e._name=t)}))}this.copystr=JSON.stringify(n),this.addToClipbrd(this.copystr,t)}},e.prototype.addToClipbrd=function(e,t){function i(t){e&&(t.clipboardData.setData("text/plain",e),t.preventDefault())}document.addEventListener("copy",i,{passive:!1}),document.execCommand("copy"),document.removeEventListener("copy",i)},e.prototype.getFromClipbrd=function(){return AH(this,void 0,void 0,(function(){return yH(this,(function(e){switch(e.label){case 0:return[4,navigator.clipboard.readText()];case 1:return[2,e.sent()]}}))}))},e.prototype.pastePlot=function(e,t,i){var r,n,o,s,a=this;if("plot"==e.type){var l=e.data,h=l._name,c=this.GetPasateNam(l._name,this.plotList.map((function(e){return e.graph.name})));if(null!=i){if(!this.rightClickPosition.lon||!this.rightClickPosition.lat)return void alert("当前粘贴位置无效！");var u=i.lon-l._ctrlPosition[0].lon,p=i.lat-l._ctrlPosition[0].lat;try{for(var d=vH(l._ctrlPosition),m=d.next();!m.done;m=d.next()){(y=m.value).lon=y.lon+u,y.lat=y.lat+p}}catch(e){r={error:e}}finally{try{m&&!m.done&&(n=d.return)&&n.call(d)}finally{if(r)throw r.error}}}else if(this.pasteLocation){var f=8e-8*t.camera.positionCartographic.height;try{for(var g=vH(l._ctrlPosition),A=g.next();!A.done;A=g.next()){var y;(y=A.value).lon=y.lon+f,y.lat=y.lat+f}}catch(e){o={error:e}}finally{try{A&&!A.done&&(s=g.return)&&s.call(g)}finally{if(o)throw o.error}}}l.id=Yy.newGuid(),l._name=c,l.name=c;var v=this.gm.draw(l);l._name=h,l.name=h;var C=new Map;C.set(v.graph.id,h),this.copy(v.graph,this._viewer,C),this.isRefresh.next([v.graph])}else if("plotArray"==e.type){if(!(null==i||this.rightClickPosition.lon&&this.rightClickPosition.lat))return void alert("当前粘贴位置无效！");var _=e.data,b=new Map,w=[];_.forEach((function(e){var r,n,o,s,l=e._name,h=a.GetPasateNam(e._name,a.plotList.map((function(e){return e.graph.name})));if(null!=i){var c=i.lon-e._ctrlPosition[0].lon,u=i.lat-e._ctrlPosition[0].lat;try{for(var p=vH(e._ctrlPosition),d=p.next();!d.done;d=p.next()){(A=d.value).lon=A.lon+c,A.lat=A.lat+u}}catch(e){r={error:e}}finally{try{d&&!d.done&&(n=p.return)&&n.call(p)}finally{if(r)throw r.error}}}else if(a.pasteLocation){var m=8e-8*t.camera.positionCartographic.height;try{for(var f=vH(e._ctrlPosition),g=f.next();!g.done;g=f.next()){var A;(A=g.value).lon=A.lon+m,A.lat=A.lat+m}}catch(e){o={error:e}}finally{try{g&&!g.done&&(s=f.return)&&s.call(f)}finally{if(o)throw o.error}}}e.id=Yy.newGuid(),e._name=h,e.name=h;var y=a.gm.draw(e);e._name=l,e.name=l,b.set(y.graph.id,l),w.push(y.graph)})),this.isRefresh.next(w),this.copy(w,this._viewer,b)}else"html"==e.type||e.type},Object.defineProperty(e.prototype,"pasteLocation",{get:function(){return this._pasteLocation},set:function(e){this._pasteLocation=e,localStorage.setItem("pasteLocation",!0===e?"true":"false")},enumerable:!1,configurable:!0}),e.prototype.paste=function(e,t){return AH(this,void 0,void 0,(function(){var i,r;return yH(this,(function(n){switch(n.label){case 0:return[4,this.getFromClipbrd()];case 1:if(!(i=n.sent()))return alert("剪切板无内容"),[2];try{r=JSON.parse(i)}catch(e){gH.log("剪切板数据（格式不对）: ",i)}return r&&(t?(gH.log("右键粘贴"),this.pastePlot(r,e,this.rightClickPosition)):(gH.log("贴在旁边"),this.pastePlot(r,e)),this.copystr=JSON.stringify(r)),[2]}}))}))},e.prototype.GetPasateNam=function(e,t){for(var i=0;;){var r=0==i?e:1==i?e+"副本":"".concat(e,"副本(").concat(i,")");if(null==t.find((function(e){return e==r})))return r;i++}},e.prototype.cut=function(){this.copystr=JSON.stringify(this.editItem.toJson()),this.gm.delete(this.editItem)},e.prototype.lock=function(){this.editItem},e.prototype.handleControlPoints=function(e){e.lat=Number(e.lat)+1,e.lgt=Number(e.lat)+1,e.controlPoints=[[e.lgt,e.lat]]},e.prototype.changeLabelStatus=function(e,t){this.isEmptyForLabel=!!e.target.value,t&&(t.isError=!this.isEmptyForLabel)},e.prototype.isAllow=function(){var e=this;this.isEmptyForLabel||this.throwError("this.isEmptyForLabel"),this.gm.graphList.forEach((function(t){for(var i in t.graph.__proto__.__meta__){var r=t.graph.__proto__.__meta__[i];r.isError&&e.throwError(r)}}))},e.prototype.throwError=function(e){throw gH.error(e),new Error("属性面板中有属性不合法")},e.prototype.addPoint=function(e,t){var i,r,n=0,o=0,s=0,a=e[t].lon*Math.PI/180,l=e[t].lat*Math.PI/180;t===e.length-1?(i=e[t-1].lon*Math.PI/180,r=e[t-1].lat*Math.PI/180):(i=e[t+1].lon*Math.PI/180,r=e[t+1].lat*Math.PI/180),n=Math.cos(l)*Math.cos(a)+Math.cos(r)*Math.cos(i),o=Math.cos(l)*Math.sin(a)+Math.cos(r)*Math.sin(i),s=Math.sin(l)+Math.sin(r),n/=2,o/=2,s/=2;var h=Math.atan2(o,n),c=Math.atan2(s,Math.sqrt(n*n+o*o)),u={lon:180*h/Math.PI,lat:180*c/Math.PI,alt:e[t].alt},p=t===e.length-1?t:t+1;e.splice(p,0,u)},e.prototype.deletePoint=function(e,t){e.length>2&&e.splice(t,1)},e.prototype.editPoint=function(e){e&&(e.editFlag=!0,e.highLight=!1)},e.prototype.savePoint=function(e){var t=this.gm.editor.currentEditGraph;gH.log("copyPoints.length<minPointNum: ",t),this.copyPoints.length>(null==t?void 0:t.maxPointNum)||this.copyPoints.length<(null==t?void 0:t.minPointNum)?gH.log("坐标参数不符合要求"):(t.ctrlPosition=this.copyPoints,t.initCtls(),t.finish(),t.toEdit(),e&&e.emit())},e.prototype.cancel=function(e){this.copyPoints=[],e&&e.emit()},e.prototype.pasteByMouse=function(e){var t=this;this.pasteHandler||(this.pasteHandler=new Cesium.ScreenSpaceEventHandler(e.scene.canvas)),this.pasteHandler.setInputAction((function(i){if(t.gm.editor.startPickTarget)t.gm.editor.startPickTarget=!1;else{$A.calculateMouseEvent(i);var r=e.camera.getPickRay(i.position),n=e.scene.globe.pick(r,e.scene);if(!Cesium.defined(n))return t.rightClickPosition.lon=void 0,void(t.rightClickPosition.lat=void 0);var o=e.scene.globe.ellipsoid.cartesianToCartographic(n);t.rightClickPosition.lat=Cesium.Math.toDegrees(o.latitude),t.rightClickPosition.lon=Cesium.Math.toDegrees(o.longitude),t.rightClickPosition.showPasteButton=!0}}),Cesium.ScreenSpaceEventType.RIGHT_CLICK)},e.prototype.transformFromTree=function(e){return e.map((function(e){var t={};return"folder"!==e.icon?Object.keys(e).forEach((function(i){"entity"!==i&&(t[i]=e[i])})):delete(t=Object.assign({},e)).children,t}))},e.prototype.plotEnable=function(e){this.gm&&(this.gm.editor.isReadOnly=e)},e}(),_H=function(){this.showPasteButton=!1},bH=i(5108),wH=function(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],r=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},PH=function(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var r,n,o=i.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){n={error:e}}finally{try{r&&!r.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}return s},SH=function(e,t,i){if(i||2===arguments.length)for(var r,n=0,o=t.length;n<o;n++)!r&&n in t||(r||(r=Array.prototype.slice.call(t,0,n)),r[n]=t[n]);return e.concat(r||Array.prototype.slice.call(t))},xH=function(){function e(e){this.rename$=new th.x,this.itemTreeLocate$=new th.x,this.startDragTreeNodeInd=-1,this.startDragNodeFlag=!1,this.clearInCtrlList$=new th.x,this.isLayerCtrlPressed=!1,this.setCurrentNodeListSub$=new th.x,this.setCrossSelectedNodesSub$=new th.x,this.previousFolder=null,this.serviceManager=e,Vy.layService=this}return e.prototype.getTreeOptions=function(e){var t,i,r=(0,Ux.ZE)(e.origin);e.parentNode?r.pid=e.parentNode.origin.id:r.pid=0,this.options.push(r);try{for(var n=wH(e.children),o=n.next();!o.done;o=n.next()){var s=o.value;this.getTreeOptions(s)}}catch(e){t={error:e}}finally{try{o&&!o.done&&(i=n.return)&&i.call(n)}finally{if(t)throw t.error}}},e.prototype.getNodeByid=function(e,t){var i,r;if(e==t.origin.id)return t;try{for(var n=wH(t.children),o=n.next();!o.done;o=n.next()){var s=o.value,a=this.getNodeByid(e,s);if(a)return a}}catch(e){i={error:e}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(i)throw i.error}}return null},e.prototype.getById=function(e){var t,i;try{for(var r=wH(this.nodes),n=r.next();!n.done;n=r.next()){var o=n.value,s=this.getNodeByid(e,o);if(s)return s}}catch(e){t={error:e}}finally{try{n&&!n.done&&(i=r.return)&&i.call(r)}finally{if(t)throw t.error}}},e.prototype.save=function(){var e,t;if(this.options=[],this.nodes&&this.nodes.length)try{for(var i=wH(this.nodes),r=i.next();!r.done;r=i.next()){var n=r.value;this.getTreeOptions(n)}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}return this.options},e.prototype.reNameElement=function(e){e.origin.lock||("folder"!==e.icon?(bH.log("子节点"),this.editEleName=e.title.trim(),this.selectedEle=e.origin.entity):(bH.log("文件夹"),this.editEleName=e.title.trim(),this.selectedEle=e.origin),!1===e.isChecked&&(e.isChecked=!0))},e.prototype.selectboxtoggle=function(e){this.previousFolder?this.previousFolder===e?this.previousFolder.isChecked=!this.previousFolder.isChecked:(this.previousFolder.isChecked=!1,e.isChecked=!0,this.previousFolder=e):(e.isChecked=!0,this.previousFolder=e)},e.prototype.editElelist=function(e){var t,i,r,n,o,s,a,l;bH.log("ele编辑校验",e);var h=!0,c=[];if("folder"!==e.icon){var u=null===(s=null===(o=e.origin.entity)||void 0===o?void 0:o.name)||void 0===s?void 0:s.trim();bH.log("子节点"),u&&""!==u||(this.serviceManager.message.error("元素名称不能为空"),h=!1,e.isChecked=!1),c=this.getChildnodes();try{for(var p=wH(c),d=p.next();!d.done;d=p.next()){var m=d.value;(null===(a=m.origin.entity)||void 0===a?void 0:a.id)!==this.selectedEle.id&&(null===(l=m.origin.entity)||void 0===l?void 0:l.name.trim())===this.selectedEle.name.trim()&&(this.serviceManager.message.error("元素名称不能重复"),h=!1,e.isChecked=!1)}}catch(e){t={error:e}}finally{try{d&&!d.done&&(i=p.return)&&i.call(p)}finally{if(t)throw t.error}}if(!h)return this.selectedEle.name=this.editEleName.trim(),this.editEleName="",this.selectedEle="",h}else{bH.log("文件夹");var f=e.origin.label.trim();f&&""!==f||(this.serviceManager.message.error("文件夹名称不能为空"),h=!1,e.isChecked=!1);try{for(var g=wH(this.nodes),A=g.next();!A.done;A=g.next()){var y=A.value;y.origin.id!==this.selectedEle.id&&y.origin.label.trim()===this.selectedEle.label.trim()&&(this.serviceManager.message.error("文件夹名称不能重复"),h=!1,e.isChecked=!1)}}catch(e){r={error:e}}finally{try{A&&!A.done&&(n=g.return)&&n.call(g)}finally{if(r)throw r.error}}if(!h)return this.selectedEle.label=this.editEleName.trim(),this.editEleName="",this.selectedEle="",h}return h},e.prototype.getChildnodes=function(){var e,t,i=[];try{for(var r=wH(this.nodes),n=r.next();!n.done;n=r.next()){var o=n.value;o.children.length>0&&i.push.apply(i,SH([],PH(o.children),!1))}}catch(t){e={error:t}}finally{try{n&&!n.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}return i},e.prototype.eleAttrNameCheck=function(e){var t=this,i=this.getChildnodes(),r=e.name.trim();return r&&""!==r?!!i.filter((function(t){var i;return(null===(i=t.origin.entity)||void 0===i?void 0:i.id)!==e.id})).find((function(e){var i;if((null===(i=e.origin.entity)||void 0===i?void 0:i.name.trim())===r)return t.serviceManager.message.error("元素名称不能重复"),!0})):(this.serviceManager.message.error("元素名称不能为空"),!0)},e}(),BH=i(5108),MH=function(){function e(){}return e.prototype.error=function(e){BH.log(e)},e.prototype.success=function(e){BH.log(e)},e}(),EH=i(5108),TH=function(){function e(){this.isVisible=!1,this.isOpenPic=!1,this.isHtmlEditContent=!0,this.picList=[]}return e.prototype.updateImgs=function(){EH.log("this.plotResourceService.picList///",this.picList);var e=document.querySelector(".my-slider");if(EH.log("con",e),e){this.tnsObj&&this.tnsObj.destroy();var t="";this.picList.forEach((function(e){t="".concat(t,'<div style="width: 729.59px;\n        height: 452px;"><img style="width:100%;height:100%" src=\'').concat(e.imgPath,"'></div>")})),t="<div id='mytns'>".concat(t,"</div>"),e.innerHTML=t,this.tnsObj=window.tns({container:"#mytns",items:1,swipeAngle:!1,speed:400,navPosition:"",controls:!1})}},e}(),OH=function(){function e(){}return e.strChineseFirstPY="YDYQSXMWZSSXJBYMGCCZQPSSQBYCDSCDQLDYLYBSSJGYZZJJFKCCLZDHWDWZJLJPFYYNWJJTMYHZWZHFLZPPQHGSCYYYNJQYXXGJHHSDSJNKKTMOMLCRXYPSNQSECCQZGGLLYJLMYZZSECYKYYHQWJSSGGYXYZYJWWKDJHYCHMYXJTLXJYQBYXZLDWRDJRWYSRLDZJPCBZJJBRCFTLECZSTZFXXZHTRQHYBDLYCZSSYMMRFMYQZPWWJJYFCRWFDFZQPYDDWYXKYJAWJFFXYPSFTZYHHYZYSWCJYXSCLCXXWZZXNBGNNXBXLZSZSBSGPYSYZDHMDZBQBZCWDZZYYTZHBTSYYBZGNTNXQYWQSKBPHHLXGYBFMJEBJHHGQTJCYSXSTKZHLYCKGLYSMZXYALMELDCCXGZYRJXSDLTYZCQKCNNJWHJTZZCQLJSTSTBNXBTYXCEQXGKWJYFLZQLYHYXSPSFXLMPBYSXXXYDJCZYLLLSJXFHJXPJBTFFYABYXBHZZBJYZLWLCZGGBTSSMDTJZXPTHYQTGLJSCQFZKJZJQNLZWLSLHDZBWJNCJZYZSQQYCQYRZCJJWYBRTWPYFTWEXCSKDZCTBZHYZZYYJXZCFFZZMJYXXSDZZOTTBZLQWFCKSZSXFYRLNYJMBDTHJXSQQCCSBXYYTSYFBXDZTGBCNSLCYZZPSAZYZZSCJCSHZQYDXLBPJLLMQXTYDZXSQJTZPXLCGLQTZWJBHCTSYJSFXYEJJTLBGXSXJMYJQQPFZASYJNTYDJXKJCDJSZCBARTDCLYJQMWNQNCLLLKBYBZZSYHQQLTWLCCXTXLLZNTYLNEWYZYXCZXXGRKRMTCNDNJTSYYSSDQDGHSDBJGHRWRQLYBGLXHLGTGXBQJDZPYJSJYJCTMRNYMGRZJCZGJMZMGXMPRYXKJNYMSGMZJYMKMFXMLDTGFBHCJHKYLPFMDXLQJJSMTQGZSJLQDLDGJYCALCMZCSDJLLNXDJFFFFJCZFMZFFPFKHKGDPSXKTACJDHHZDDCRRCFQYJKQCCWJDXHWJLYLLZGCFCQDSMLZPBJJPLSBCJGGDCKKDEZSQCCKJGCGKDJTJDLZYCXKLQSCGJCLTFPCQCZGWPJDQYZJJBYJHSJDZWGFSJGZKQCCZLLPSPKJGQJHZZLJPLGJGJJTHJJYJZCZMLZLYQBGJWMLJKXZDZNJQSYZMLJLLJKYWXMKJLHSKJGBMCLYYMKXJQLBMLLKMDXXKWYXYSLMLPSJQQJQXYXFJTJDXMXXLLCXQBSYJBGWYMBGGBCYXPJYGPEPFGDJGBHBNSQJYZJKJKHXQFGQZKFHYGKHDKLLSDJQXPQYKYBNQSXQNSZSWHBSXWHXWBZZXDMNSJBSBKBBZKLYLXGWXDRWYQZMYWSJQLCJXXJXKJEQXSCYETLZHLYYYSDZPAQYZCMTLSHTZCFYZYXYLJSDCJQAGYSLCQLYYYSHMRQQKLDXZSCSSSYDYCJYSFSJBFRSSZQSBXXPXJYSDRCKGJLGDKZJZBDKTCSYQPYHSTCLDJDHMXMCGXYZHJDDTMHLTXZXYLYMOHYJCLTYFBQQXPFBDFHHTKSQHZYYWCNXXCRWHOWGYJLEGWDQCWGFJYCSNTMYTOLBYGWQWESJPWNMLRYDZSZTXYQPZGCWXHNGPYXSHMYQJXZTDPPBFYHZHTJYFDZWKGKZBLDNTSXHQEEGZZYLZMMZYJZGXZXKHKSTXNXXWYLYAPSTHXDWHZYMPXAGKYDXBHNHXKDPJNMYHYLPMGOCSLNZHKXXLPZZLBMLSFBHHGYGYYGGBHSCYAQTYWLXTZQCEZYDQDQMMHTKLLSZHLSJZWFYHQSWSCWLQAZYNYTLSXTHAZNKZZSZZLAXXZWWCTGQQTDDYZTCCHYQZFLXPSLZYGPZSZNGLNDQTBDLXGTCTAJDKYWNSYZLJHHZZCWNYYZYWMHYCHHYXHJKZWSXHZYXLYSKQYSPSLYZWMYPPKBYGLKZHTYXAXQSYSHXASMCHKDSCRSWJPWXSGZJLWWSCHSJHSQNHCSEGNDAQTBAALZZMSSTDQJCJKTSCJAXPLGGXHHGXXZCXPDMMHLDGTYBYSJMXHMRCPXXJZCKZXSHMLQXXTTHXWZFKHCCZDYTCJYXQHLXDHYPJQXYLSYYDZOZJNYXQEZYSQYAYXWYPDGXDDXSPPYZNDLTWRHXYDXZZJHTCXMCZLHPYYYYMHZLLHNXMYLLLMDCPPXHMXDKYCYRDLTXJCHHZZXZLCCLYLNZSHZJZZLNNRLWHYQSNJHXYNTTTKYJPYCHHYEGKCTTWLGQRLGGTGTYGYHPYHYLQYQGCWYQKPYYYTTTTLHYHLLTYTTSPLKYZXGZWGPYDSSZZDQXSKCQNMJJZZBXYQMJRTFFBTKHZKBXLJJKDXJTLBWFZPPTKQTZTGPDGNTPJYFALQMKGXBDCLZFHZCLLLLADPMXDJHLCCLGYHDZFGYDDGCYYFGYDXKSSEBDHYKDKDKHNAXXYBPBYYHXZQGAFFQYJXDMLJCSQZLLPCHBSXGJYNDYBYQSPZWJLZKSDDTACTBXZDYZYPJZQSJNKKTKNJDJGYYPGTLFYQKASDNTCYHBLWDZHBBYDWJRYGKZYHEYYFJMSDTYFZJJHGCXPLXHLDWXXJKYTCYKSSSMTWCTTQZLPBSZDZWZXGZAGYKTYWXLHLSPBCLLOQMMZSSLCMBJCSZZKYDCZJGQQDSMCYTZQQLWZQZXSSFPTTFQMDDZDSHDTDWFHTDYZJYQJQKYPBDJYYXTLJHDRQXXXHAYDHRJLKLYTWHLLRLLRCXYLBWSRSZZSYMKZZHHKYHXKSMDSYDYCJPBZBSQLFCXXXNXKXWYWSDZYQOGGQMMYHCDZTTFJYYBGSTTTYBYKJDHKYXBELHTYPJQNFXFDYKZHQKZBYJTZBXHFDXKDASWTAWAJLDYJSFHBLDNNTNQJTJNCHXFJSRFWHZFMDRYJYJWZPDJKZYJYMPCYZNYNXFBYTFYFWYGDBNZZZDNYTXZEMMQBSQEHXFZMBMFLZZSRXYMJGSXWZJSPRYDJSJGXHJJGLJJYNZZJXHGXKYMLPYYYCXYTWQZSWHWLYRJLPXSLSXMFSWWKLCTNXNYNPSJSZHDZEPTXMYYWXYYSYWLXJQZQXZDCLEEELMCPJPCLWBXSQHFWWTFFJTNQJHJQDXHWLBYZNFJLALKYYJLDXHHYCSTYYWNRJYXYWTRMDRQHWQCMFJDYZMHMYYXJWMYZQZXTLMRSPWWCHAQBXYGZYPXYYRRCLMPYMGKSJSZYSRMYJSNXTPLNBAPPYPYLXYYZKYNLDZYJZCZNNLMZHHARQMPGWQTZMXXMLLHGDZXYHXKYXYCJMFFYYHJFSBSSQLXXNDYCANNMTCJCYPRRNYTYQNYYMBMSXNDLYLYSLJRLXYSXQMLLYZLZJJJKYZZCSFBZXXMSTBJGNXYZHLXNMCWSCYZYFZLXBRNNNYLBNRTGZQYSATSWRYHYJZMZDHZGZDWYBSSCSKXSYHYTXXGCQGXZZSHYXJSCRHMKKBXCZJYJYMKQHZJFNBHMQHYSNJNZYBKNQMCLGQHWLZNZSWXKHLJHYYBQLBFCDSXDLDSPFZPSKJYZWZXZDDXJSMMEGJSCSSMGCLXXKYYYLNYPWWWGYDKZJGGGZGGSYCKNJWNJPCXBJJTQTJWDSSPJXZXNZXUMELPXFSXTLLXCLJXJJLJZXCTPSWXLYDHLYQRWHSYCSQYYBYAYWJJJQFWQCQQCJQGXALDBZZYJGKGXPLTZYFXJLTPADKYQHPMATLCPDCKBMTXYBHKLENXDLEEGQDYMSAWHZMLJTWYGXLYQZLJEEYYBQQFFNLYXRDSCTGJGXYYNKLLYQKCCTLHJLQMKKZGCYYGLLLJDZGYDHZWXPYSJBZKDZGYZZHYWYFQYTYZSZYEZZLYMHJJHTSMQWYZLKYYWZCSRKQYTLTDXWCTYJKLWSQZWBDCQYNCJSRSZJLKCDCDTLZZZACQQZZDDXYPLXZBQJYLZLLLQDDZQJYJYJZYXNYYYNYJXKXDAZWYRDLJYYYRJLXLLDYXJCYWYWNQCCLDDNYYYNYCKCZHXXCCLGZQJGKWPPCQQJYSBZZXYJSQPXJPZBSBDSFNSFPZXHDWZTDWPPTFLZZBZDMYYPQJRSDZSQZSQXBDGCPZSWDWCSQZGMDHZXMWWFYBPDGPHTMJTHZSMMBGZMBZJCFZWFZBBZMQCFMBDMCJXLGPNJBBXGYHYYJGPTZGZMQBQTCGYXJXLWZKYDPDYMGCFTPFXYZTZXDZXTGKMTYBBCLBJASKYTSSQYYMSZXFJEWLXLLSZBQJJJAKLYLXLYCCTSXMCWFKKKBSXLLLLJYXTYLTJYYTDPJHNHNNKBYQNFQYYZBYYESSESSGDYHFHWTCJBSDZZTFDMXHCNJZYMQWSRYJDZJQPDQBBSTJGGFBKJBXTGQHNGWJXJGDLLTHZHHYYYYYYSXWTYYYCCBDBPYPZYCCZYJPZYWCBDLFWZCWJDXXHYHLHWZZXJTCZLCDPXUJCZZZLYXJJTXPHFXWPYWXZPTDZZBDZCYHJHMLXBQXSBYLRDTGJRRCTTTHYTCZWMXFYTWWZCWJWXJYWCSKYBZSCCTZQNHXNWXXKHKFHTSWOCCJYBCMPZZYKBNNZPBZHHZDLSYDDYTYFJPXYNGFXBYQXCBHXCPSXTYZDMKYSNXSXLHKMZXLYHDHKWHXXSSKQYHHCJYXGLHZXCSNHEKDTGZXQYPKDHEXTYKCNYMYYYPKQYYYKXZLTHJQTBYQHXBMYHSQCKWWYLLHCYYLNNEQXQWMCFBDCCMLJGGXDQKTLXKGNQCDGZJWYJJLYHHQTTTNWCHMXCXWHWSZJYDJCCDBQCDGDNYXZTHCQRXCBHZTQCBXWGQWYYBXHMBYMYQTYEXMQKYAQYRGYZSLFYKKQHYSSQYSHJGJCNXKZYCXSBXYXHYYLSTYCXQTHYSMGSCPMMGCCCCCMTZTASMGQZJHKLOSQYLSWTMXSYQKDZLJQQYPLSYCZTCQQPBBQJZCLPKHQZYYXXDTDDTSJCXFFLLCHQXMJLWCJCXTSPYCXNDTJSHJWXDQQJSKXYAMYLSJHMLALYKXCYYDMNMDQMXMCZNNCYBZKKYFLMCHCMLHXRCJJHSYLNMTJZGZGYWJXSRXCWJGJQHQZDQJDCJJZKJKGDZQGJJYJYLXZXXCDQHHHEYTMHLFSBDJSYYSHFYSTCZQLPBDRFRZTZYKYWHSZYQKWDQZRKMSYNBCRXQBJYFAZPZZEDZCJYWBCJWHYJBQSZYWRYSZPTDKZPFPBNZTKLQYHBBZPNPPTYZZYBQNYDCPJMMCYCQMCYFZZDCMNLFPBPLNGQJTBTTNJZPZBBZNJKLJQYLNBZQHKSJZNGGQSZZKYXSHPZSNBCGZKDDZQANZHJKDRTLZLSWJLJZLYWTJNDJZJHXYAYNCBGTZCSSQMNJPJYTYSWXZFKWJQTKHTZPLBHSNJZSYZBWZZZZLSYLSBJHDWWQPSLMMFBJDWAQYZTCJTBNNWZXQXCDSLQGDSDPDZHJTQQPSWLYYJZLGYXYZLCTCBJTKTYCZJTQKBSJLGMGZDMCSGPYNJZYQYYKNXRPWSZXMTNCSZZYXYBYHYZAXYWQCJTLLCKJJTJHGDXDXYQYZZBYWDLWQCGLZGJGQRQZCZSSBCRPCSKYDZNXJSQGXSSJMYDNSTZTPBDLTKZWXQWQTZEXNQCZGWEZKSSBYBRTSSSLCCGBPSZQSZLCCGLLLZXHZQTHCZMQGYZQZNMCOCSZJMMZSQPJYGQLJYJPPLDXRGZYXCCSXHSHGTZNLZWZKJCXTCFCJXLBMQBCZZWPQDNHXLJCTHYZLGYLNLSZZPCXDSCQQHJQKSXZPBAJYEMSMJTZDXLCJYRYYNWJBNGZZTMJXLTBSLYRZPYLSSCNXPHLLHYLLQQZQLXYMRSYCXZLMMCZLTZSDWTJJLLNZGGQXPFSKYGYGHBFZPDKMWGHCXMSGDXJMCJZDYCABXJDLNBCDQYGSKYDQTXDJJYXMSZQAZDZFSLQXYJSJZYLBTXXWXQQZBJZUFBBLYLWDSLJHXJYZJWTDJCZFQZQZZDZSXZZQLZCDZFJHYSPYMPQZMLPPLFFXJJNZZYLSJEYQZFPFZKSYWJJJHRDJZZXTXXGLGHYDXCSKYSWMMZCWYBAZBJKSHFHJCXMHFQHYXXYZFTSJYZFXYXPZLCHMZMBXHZZSXYFYMNCWDABAZLXKTCSHHXKXJJZJSTHYGXSXYYHHHJWXKZXSSBZZWHHHCWTZZZPJXSNXQQJGZYZYWLLCWXZFXXYXYHXMKYYSWSQMNLNAYCYSPMJKHWCQHYLAJJMZXHMMCNZHBHXCLXTJPLTXYJHDYYLTTXFSZHYXXSJBJYAYRSMXYPLCKDUYHLXRLNLLSTYZYYQYGYHHSCCSMZCTZQXKYQFPYYRPFFLKQUNTSZLLZMWWTCQQYZWTLLMLMPWMBZSSTZRBPDDTLQJJBXZCSRZQQYGWCSXFWZLXCCRSZDZMCYGGDZQSGTJSWLJMYMMZYHFBJDGYXCCPSHXNZCSBSJYJGJMPPWAFFYFNXHYZXZYLREMZGZCYZSSZDLLJCSQFNXZKPTXZGXJJGFMYYYSNBTYLBNLHPFZDCYFBMGQRRSSSZXYSGTZRNYDZZCDGPJAFJFZKNZBLCZSZPSGCYCJSZLMLRSZBZZLDLSLLYSXSQZQLYXZLSKKBRXBRBZCYCXZZZEEYFGKLZLYYHGZSGZLFJHGTGWKRAAJYZKZQTSSHJJXDCYZUYJLZYRZDQQHGJZXSSZBYKJPBFRTJXLLFQWJHYLQTYMBLPZDXTZYGBDHZZRBGXHWNJTJXLKSCFSMWLSDQYSJTXKZSCFWJLBXFTZLLJZLLQBLSQMQQCGCZFPBPHZCZJLPYYGGDTGWDCFCZQYYYQYSSCLXZSKLZZZGFFCQNWGLHQYZJJCZLQZZYJPJZZBPDCCMHJGXDQDGDLZQMFGPSYTSDYFWWDJZJYSXYYCZCYHZWPBYKXRYLYBHKJKSFXTZJMMCKHLLTNYYMSYXYZPYJQYCSYCWMTJJKQYRHLLQXPSGTLYYCLJSCPXJYZFNMLRGJJTYZBXYZMSJYJHHFZQMSYXRSZCWTLRTQZSSTKXGQKGSPTGCZNJSJCQCXHMXGGZTQYDJKZDLBZSXJLHYQGGGTHQSZPYHJHHGYYGKGGCWJZZYLCZLXQSFTGZSLLLMLJSKCTBLLZZSZMMNYTPZSXQHJCJYQXYZXZQZCPSHKZZYSXCDFGMWQRLLQXRFZTLYSTCTMJCXJJXHJNXTNRZTZFQYHQGLLGCXSZSJDJLJCYDSJTLNYXHSZXCGJZYQPYLFHDJSBPCCZHJJJQZJQDYBSSLLCMYTTMQTBHJQNNYGKYRQYQMZGCJKPDCGMYZHQLLSLLCLMHOLZGDYYFZSLJCQZLYLZQJESHNYLLJXGJXLYSYYYXNBZLJSSZCQQCJYLLZLTJYLLZLLBNYLGQCHXYYXOXCXQKYJXXXYKLXSXXYQXCYKQXQCSGYXXYQXYGYTQOHXHXPYXXXULCYEYCHZZCBWQBBWJQZSCSZSSLZYLKDESJZWMYMCYTSDSXXSCJPQQSQYLYYZYCMDJDZYWCBTJSYDJKCYDDJLBDJJSODZYSYXQQYXDHHGQQYQHDYXWGMMMAJDYBBBPPBCMUUPLJZSMTXERXJMHQNUTPJDCBSSMSSSTKJTSSMMTRCPLZSZMLQDSDMJMQPNQDXCFYNBFSDQXYXHYAYKQYDDLQYYYSSZBYDSLNTFQTZQPZMCHDHCZCWFDXTMYQSPHQYYXSRGJCWTJTZZQMGWJJTJHTQJBBHWZPXXHYQFXXQYWYYHYSCDYDHHQMNMTMWCPBSZPPZZGLMZFOLLCFWHMMSJZTTDHZZYFFYTZZGZYSKYJXQYJZQBHMBZZLYGHGFMSHPZFZSNCLPBQSNJXZSLXXFPMTYJYGBXLLDLXPZJYZJYHHZCYWHJYLSJEXFSZZYWXKZJLUYDTMLYMQJPWXYHXSKTQJEZRPXXZHHMHWQPWQLYJJQJJZSZCPHJLCHHNXJLQWZJHBMZYXBDHHYPZLHLHLGFWLCHYYTLHJXCJMSCPXSTKPNHQXSRTYXXTESYJCTLSSLSTDLLLWWYHDHRJZSFGXTSYCZYNYHTDHWJSLHTZDQDJZXXQHGYLTZPHCSQFCLNJTCLZPFSTPDYNYLGMJLLYCQHYSSHCHYLHQYQTMZYPBYWRFQYKQSYSLZDQJMPXYYSSRHZJNYWTQDFZBWWTWWRXCWHGYHXMKMYYYQMSMZHNGCEPMLQQMTCWCTMMPXJPJJHFXYYZSXZHTYBMSTSYJTTQQQYYLHYNPYQZLCYZHZWSMYLKFJXLWGXYPJYTYSYXYMZCKTTWLKSMZSYLMPWLZWXWQZSSAQSYXYRHSSNTSRAPXCPWCMGDXHXZDZYFJHGZTTSBJHGYZSZYSMYCLLLXBTYXHBBZJKSSDMALXHYCFYGMQYPJYCQXJLLLJGSLZGQLYCJCCZOTYXMTMTTLLWTGPXYMZMKLPSZZZXHKQYSXCTYJZYHXSHYXZKXLZWPSQPYHJWPJPWXQQYLXSDHMRSLZZYZWTTCYXYSZZSHBSCCSTPLWSSCJCHNLCGCHSSPHYLHFHHXJSXYLLNYLSZDHZXYLSXLWZYKCLDYAXZCMDDYSPJTQJZLNWQPSSSWCTSTSZLBLNXSMNYYMJQBQHRZWTYYDCHQLXKPZWBGQYBKFCMZWPZLLYYLSZYDWHXPSBCMLJBSCGBHXLQHYRLJXYSWXWXZSLDFHLSLYNJLZYFLYJYCDRJLFSYZFSLLCQYQFGJYHYXZLYLMSTDJCYHBZLLNWLXXYGYYHSMGDHXXHHLZZJZXCZZZCYQZFNGWPYLCPKPYYPMCLQKDGXZGGWQBDXZZKZFBXXLZXJTPJPTTBYTSZZDWSLCHZHSLTYXHQLHYXXXYYZYSWTXZKHLXZXZPYHGCHKCFSYHUTJRLXFJXPTZTWHPLYXFCRHXSHXKYXXYHZQDXQWULHYHMJTBFLKHTXCWHJFWJCFPQRYQXCYYYQYGRPYWSGSUNGWCHKZDXYFLXXHJJBYZWTSXXNCYJJYMSWZJQRMHXZWFQSYLZJZGBHYNSLBGTTCSYBYXXWXYHXYYXNSQYXMQYWRGYQLXBBZLJSYLPSYTJZYHYZAWLRORJMKSCZJXXXYXCHDYXRYXXJDTSQFXLYLTSFFYXLMTYJMJUYYYXLTZCSXQZQHZXLYYXZHDNBRXXXJCTYHLBRLMBRLLAXKYLLLJLYXXLYCRYLCJTGJCMTLZLLCYZZPZPCYAWHJJFYBDYYZSMPCKZDQYQPBPCJPDCYZMDPBCYYDYCNNPLMTMLRMFMMGWYZBSJGYGSMZQQQZTXMKQWGXLLPJGZBQCDJJJFPKJKCXBLJMSWMDTQJXLDLPPBXCWRCQFBFQJCZAHZGMYKPHYYHZYKNDKZMBPJYXPXYHLFPNYYGXJDBKXNXHJMZJXSTRSTLDXSKZYSYBZXJLXYSLBZYSLHXJPFXPQNBYLLJQKYGZMCYZZYMCCSLCLHZFWFWYXZMWSXTYNXJHPYYMCYSPMHYSMYDYSHQYZCHMJJMZCAAGCFJBBHPLYZYLXXSDJGXDHKXXTXXNBHRMLYJSLTXMRHNLXQJXYZLLYSWQGDLBJHDCGJYQYCMHWFMJYBMBYJYJWYMDPWHXQLDYGPDFXXBCGJSPCKRSSYZJMSLBZZJFLJJJLGXZGYXYXLSZQYXBEXYXHGCXBPLDYHWETTWWCJMBTXCHXYQXLLXFLYXLLJLSSFWDPZSMYJCLMWYTCZPCHQEKCQBWLCQYDPLQPPQZQFJQDJHYMMCXTXDRMJWRHXCJZYLQXDYYNHYYHRSLSRSYWWZJYMTLTLLGTQCJZYABTCKZCJYCCQLJZQXALMZYHYWLWDXZXQDLLQSHGPJFJLJHJABCQZDJGTKHSSTCYJLPSWZLXZXRWGLDLZRLZXTGSLLLLZLYXXWGDZYGBDPHZPBRLWSXQBPFDWOFMWHLYPCBJCCLDMBZPBZZLCYQXLDOMZBLZWPDWYYGDSTTHCSQSCCRSSSYSLFYBFNTYJSZDFNDPDHDZZMBBLSLCMYFFGTJJQWFTMTPJWFNLBZCMMJTGBDZLQLPYFHYYMJYLSDCHDZJWJCCTLJCLDTLJJCPDDSQDSSZYBNDBJLGGJZXSXNLYCYBJXQYCBYLZCFZPPGKCXZDZFZTJJFJSJXZBNZYJQTTYJYHTYCZHYMDJXTTMPXSPLZCDWSLSHXYPZGTFMLCJTYCBPMGDKWYCYZCDSZZYHFLYCTYGWHKJYYLSJCXGYWJCBLLCSNDDBTZBSCLYZCZZSSQDLLMQYYHFSLQLLXFTYHABXGWNYWYYPLLSDLDLLBJCYXJZMLHLJDXYYQYTDLLLBUGBFDFBBQJZZMDPJHGCLGMJJPGAEHHBWCQXAXHHHZCHXYPHJAXHLPHJPGPZJQCQZGJJZZUZDMQYYBZZPHYHYBWHAZYJHYKFGDPFQSDLZMLJXKXGALXZDAGLMDGXMWZQYXXDXXPFDMMSSYMPFMDMMKXKSYZYSHDZKXSYSMMZZZMSYDNZZCZXFPLSTMZDNMXCKJMZTYYMZMZZMSXHHDCZJEMXXKLJSTLWLSQLYJZLLZJSSDPPMHNLZJCZYHMXXHGZCJMDHXTKGRMXFWMCGMWKDTKSXQMMMFZZYDKMSCLCMPCGMHSPXQPZDSSLCXKYXTWLWJYAHZJGZQMCSNXYYMMPMLKJXMHLMLQMXCTKZMJQYSZJSYSZHSYJZJCDAJZYBSDQJZGWZQQXFKDMSDJLFWEHKZQKJPEYPZYSZCDWYJFFMZZYLTTDZZEFMZLBNPPLPLPEPSZALLTYLKCKQZKGENQLWAGYXYDPXLHSXQQWQCQXQCLHYXXMLYCCWLYMQYSKGCHLCJNSZKPYZKCQZQLJPDMDZHLASXLBYDWQLWDNBQCRYDDZTJYBKBWSZDXDTNPJDTCTQDFXQQMGNXECLTTBKPWSLCTYQLPWYZZKLPYGZCQQPLLKCCYLPQMZCZQCLJSLQZDJXLDDHPZQDLJJXZQDXYZQKZLJCYQDYJPPYPQYKJYRMPCBYMCXKLLZLLFQPYLLLMBSGLCYSSLRSYSQTMXYXZQZFDZUYSYZTFFMZZSMZQHZSSCCMLYXWTPZGXZJGZGSJSGKDDHTQGGZLLBJDZLCBCHYXYZHZFYWXYZYMSDBZZYJGTSMTFXQYXQSTDGSLNXDLRYZZLRYYLXQHTXSRTZNGZXBNQQZFMYKMZJBZYMKBPNLYZPBLMCNQYZZZSJZHJCTZKHYZZJRDYZHNPXGLFZTLKGJTCTSSYLLGZRZBBQZZKLPKLCZYSSUYXBJFPNJZZXCDWXZYJXZZDJJKGGRSRJKMSMZJLSJYWQSKYHQJSXPJZZZLSNSHRNYPZTWCHKLPSRZLZXYJQXQKYSJYCZTLQZYBBYBWZPQDWWYZCYTJCJXCKCWDKKZXSGKDZXWWYYJQYYTCYTDLLXWKCZKKLCCLZCQQDZLQLCSFQCHQHSFSMQZZLNBJJZBSJHTSZDYSJQJPDLZCDCWJKJZZLPYCGMZWDJJBSJQZSYZYHHXJPBJYDSSXDZNCGLQMBTSFSBPDZDLZNFGFJGFSMPXJQLMBLGQCYYXBQKDJJQYRFKZTJDHCZKLBSDZCFJTPLLJGXHYXZCSSZZXSTJYGKGCKGYOQXJPLZPBPGTGYJZGHZQZZLBJLSQFZGKQQJZGYCZBZQTLDXRJXBSXXPZXHYZYCLWDXJJHXMFDZPFZHQHQMQGKSLYHTYCGFRZGNQXCLPDLBZCSCZQLLJBLHBZCYPZZPPDYMZZSGYHCKCPZJGSLJLNSCDSLDLXBMSTLDDFJMKDJDHZLZXLSZQPQPGJLLYBDSZGQLBZLSLKYYHZTTNTJYQTZZPSZQZTLLJTYYLLQLLQYZQLBDZLSLYYZYMDFSZSNHLXZNCZQZPBWSKRFBSYZMTHBLGJPMCZZLSTLXSHTCSYZLZBLFEQHLXFLCJLYLJQCBZLZJHHSSTBRMHXZHJZCLXFNBGXGTQJCZTMSFZKJMSSNXLJKBHSJXNTNLZDNTLMSJXGZJYJCZXYJYJWRWWQNZTNFJSZPZSHZJFYRDJSFSZJZBJFZQZZHZLXFYSBZQLZSGYFTZDCSZXZJBQMSZKJRHYJZCKMJKHCHGTXKXQGLXPXFXTRTYLXJXHDTSJXHJZJXZWZLCQSBTXWXGXTXXHXFTSDKFJHZYJFJXRZSDLLLTQSQQZQWZXSYQTWGWBZCGZLLYZBCLMQQTZHZXZXLJFRMYZFLXYSQXXJKXRMQDZDMMYYBSQBHGZMWFWXGMXLZPYYTGZYCCDXYZXYWGSYJYZNBHPZJSQSYXSXRTFYZGRHZTXSZZTHCBFCLSYXZLZQMZLMPLMXZJXSFLBYZMYQHXJSXRXSQZZZSSLYFRCZJRCRXHHZXQYDYHXSJJHZCXZBTYNSYSXJBQLPXZQPYMLXZKYXLXCJLCYSXXZZLXDLLLJJYHZXGYJWKJRWYHCPSGNRZLFZWFZZNSXGXFLZSXZZZBFCSYJDBRJKRDHHGXJLJJTGXJXXSTJTJXLYXQFCSGSWMSBCTLQZZWLZZKXJMLTMJYHSDDBXGZHDLBMYJFRZFSGCLYJBPMLYSMSXLSZJQQHJZFXGFQFQBPXZGYYQXGZTCQWYLTLGWSGWHRLFSFGZJMGMGBGTJFSYZZGZYZAFLSSPMLPFLCWBJZCLJJMZLPJJLYMQDMYYYFBGYGYZMLYZDXQYXRQQQHSYYYQXYLJTYXFSFSLLGNQCYHYCWFHCCCFXPYLYPLLZYXXXXXKQHHXSHJZCFZSCZJXCPZWHHHHHAPYLQALPQAFYHXDYLUKMZQGGGDDESRNNZLTZGCHYPPYSQJJHCLLJTOLNJPZLJLHYMHEYDYDSQYCDDHGZUNDZCLZYZLLZNTNYZGSLHSLPJJBDGWXPCDUTJCKLKCLWKLLCASSTKZZDNQNTTLYYZSSYSSZZRYLJQKCQDHHCRXRZYDGRGCWCGZQFFFPPJFZYNAKRGYWYQPQXXFKJTSZZXSWZDDFBBXTBGTZKZNPZZPZXZPJSZBMQHKCYXYLDKLJNYPKYGHGDZJXXEAHPNZKZTZCMXCXMMJXNKSZQNMNLWBWWXJKYHCPSTMCSQTZJYXTPCTPDTNNPGLLLZSJLSPBLPLQHDTNJNLYYRSZFFJFQWDPHZDWMRZCCLODAXNSSNYZRESTYJWJYJDBCFXNMWTTBYLWSTSZGYBLJPXGLBOCLHPCBJLTMXZLJYLZXCLTPNCLCKXTPZJSWCYXSFYSZDKNTLBYJCYJLLSTGQCBXRYZXBXKLYLHZLQZLNZCXWJZLJZJNCJHXMNZZGJZZXTZJXYCYYCXXJYYXJJXSSSJSTSSTTPPGQTCSXWZDCSYFPTFBFHFBBLZJCLZZDBXGCXLQPXKFZFLSYLTUWBMQJHSZBMDDBCYSCCLDXYCDDQLYJJWMQLLCSGLJJSYFPYYCCYLTJANTJJPWYCMMGQYYSXDXQMZHSZXPFTWWZQSWQRFKJLZJQQYFBRXJHHFWJJZYQAZMYFRHCYYBYQWLPEXCCZSTYRLTTDMQLYKMBBGMYYJPRKZNPBSXYXBHYZDJDNGHPMFSGMWFZMFQMMBCMZZCJJLCNUXYQLMLRYGQZCYXZLWJGCJCGGMCJNFYZZJHYCPRRCMTZQZXHFQGTJXCCJEAQCRJYHPLQLSZDJRBCQHQDYRHYLYXJSYMHZYDWLDFRYHBPYDTSSCNWBXGLPZMLZZTQSSCPJMXXYCSJYTYCGHYCJWYRXXLFEMWJNMKLLSWTXHYYYNCMMCWJDQDJZGLLJWJRKHPZGGFLCCSCZMCBLTBHBQJXQDSPDJZZGKGLFQYWBZYZJLTSTDHQHCTCBCHFLQMPWDSHYYTQWCNZZJTLBYMBPDYYYXSQKXWYYFLXXNCWCXYPMAELYKKJMZZZBRXYYQJFLJPFHHHYTZZXSGQQMHSPGDZQWBWPJHZJDYSCQWZKTXXSQLZYYMYSDZGRXCKKUJLWPYSYSCSYZLRMLQSYLJXBCXTLWDQZPCYCYKPPPNSXFYZJJRCEMHSZMSXLXGLRWGCSTLRSXBZGBZGZTCPLUJLSLYLYMTXMTZPALZXPXJTJWTCYYZLBLXBZLQMYLXPGHDSLSSDMXMBDZZSXWHAMLCZCPJMCNHJYSNSYGCHSKQMZZQDLLKABLWJXSFMOCDXJRRLYQZKJMYBYQLYHETFJZFRFKSRYXFJTWDSXXSYSQJYSLYXWJHSNLXYYXHBHAWHHJZXWMYLJCSSLKYDZTXBZSYFDXGXZJKHSXXYBSSXDPYNZWRPTQZCZENYGCXQFJYKJBZMLJCMQQXUOXSLYXXLYLLJDZBTYMHPFSTTQQWLHOKYBLZZALZXQLHZWRRQHLSTMYPYXJJXMQSJFNBXYXYJXXYQYLTHYLQYFMLKLJTMLLHSZWKZHLJMLHLJKLJSTLQXYLMBHHLNLZXQJHXCFXXLHYHJJGBYZZKBXSCQDJQDSUJZYYHZHHMGSXCSYMXFEBCQWWRBPYYJQTYZCYQYQQZYHMWFFHGZFRJFCDPXNTQYZPDYKHJLFRZXPPXZDBBGZQSTLGDGYLCQMLCHHMFYWLZYXKJLYPQHSYWMQQGQZMLZJNSQXJQSYJYCBEHSXFSZPXZWFLLBCYYJDYTDTHWZSFJMQQYJLMQXXLLDTTKHHYBFPWTYYSQQWNQWLGWDEBZWCMYGCULKJXTMXMYJSXHYBRWFYMWFRXYQMXYSZTZZTFYKMLDHQDXWYYNLCRYJBLPSXCXYWLSPRRJWXHQYPHTYDNXHHMMYWYTZCSQMTSSCCDALWZTCPQPYJLLQZYJSWXMZZMMYLMXCLMXCZMXMZSQTZPPQQBLPGXQZHFLJJHYTJSRXWZXSCCDLXTYJDCQJXSLQYCLZXLZZXMXQRJMHRHZJBHMFLJLMLCLQNLDXZLLLPYPSYJYSXCQQDCMQJZZXHNPNXZMEKMXHYKYQLXSXTXJYYHWDCWDZHQYYBGYBCYSCFGPSJNZDYZZJZXRZRQJJYMCANYRJTLDPPYZBSTJKXXZYPFDWFGZZRPYMTNGXZQBYXNBUFNQKRJQZMJEGRZGYCLKXZDSKKNSXKCLJSPJYYZLQQJYBZSSQLLLKJXTBKTYLCCDDBLSPPFYLGYDTZJYQGGKQTTFZXBDKTYYHYBBFYTYYBCLPDYTGDHRYRNJSPTCSNYJQHKLLLZSLYDXXWBCJQSPXBPJZJCJDZFFXXBRMLAZHCSNDLBJDSZBLPRZTSWSBXBCLLXXLZDJZSJPYLYXXYFTFFFBHJJXGBYXJPMMMPSSJZJMTLYZJXSWXTYLEDQPJMYGQZJGDJLQJWJQLLSJGJGYGMSCLJJXDTYGJQJQJCJZCJGDZZSXQGSJGGCXHQXSNQLZZBXHSGZXCXYLJXYXYYDFQQJHJFXDHCTXJYRXYSQTJXYEFYYSSYYJXNCYZXFXMSYSZXYYSCHSHXZZZGZZZGFJDLTYLNPZGYJYZYYQZPBXQBDZTZCZYXXYHHSQXSHDHGQHJHGYWSZTMZMLHYXGEBTYLZKQWYTJZRCLEKYSTDBCYKQQSAYXCJXWWGSBHJYZYDHCSJKQCXSWXFLTYNYZPZCCZJQTZWJQDZZZQZLJJXLSBHPYXXPSXSHHEZTXFPTLQYZZXHYTXNCFZYYHXGNXMYWXTZSJPTHHGYMXMXQZXTSBCZYJYXXTYYZYPCQLMMSZMJZZLLZXGXZAAJZYXJMZXWDXZSXZDZXLEYJJZQBHZWZZZQTZPSXZTDSXJJJZNYAZPHXYYSRNQDTHZHYYKYJHDZXZLSWCLYBZYECWCYCRYLCXNHZYDZYDYJDFRJJHTRSQTXYXJRJHOJYNXELXSFSFJZGHPZSXZSZDZCQZBYYKLSGSJHCZSHDGQGXYZGXCHXZJWYQWGYHKSSEQZZNDZFKWYSSTCLZSTSYMCDHJXXYWEYXCZAYDMPXMDSXYBSQMJMZJMTZQLPJYQZCGQHXJHHLXXHLHDLDJQCLDWBSXFZZYYSCHTYTYYBHECXHYKGJPXHHYZJFXHWHBDZFYZBCAPNPGNYDMSXHMMMMAMYNBYJTMPXYYMCTHJBZYFCGTYHWPHFTWZZEZSBZEGPFMTSKFTYCMHFLLHGPZJXZJGZJYXZSBBQSCZZLZCCSTPGXMJSFTCCZJZDJXCYBZLFCJSYZFGSZLYBCWZZBYZDZYPSWYJZXZBDSYUXLZZBZFYGCZXBZHZFTPBGZGEJBSTGKDMFHYZZJHZLLZZGJQZLSFDJSSCBZGPDLFZFZSZYZYZSYGCXSNXXCHCZXTZZLJFZGQSQYXZJQDCCZTQCDXZJYQJQCHXZTDLGSCXZSYQJQTZWLQDQZTQCHQQJZYEZZZPBWKDJFCJPZTYPQYQTTYNLMBDKTJZPQZQZZFPZSBNJLGYJDXJDZZKZGQKXDLPZJTCJDQBXDJQJSTCKNXBXZMSLYJCQMTJQWWCJQNJNLLLHJCWQTBZQYDZCZPZZDZYDDCYZZZCCJTTJFZDPRRTZTJDCQTQZDTJNPLZBCLLCTZSXKJZQZPZLBZRBTJDCXFCZDBCCJJLTQQPLDCGZDBBZJCQDCJWYNLLZYZCCDWLLXWZLXRXNTQQCZXKQLSGDFQTDDGLRLAJJTKUYMKQLLTZYTDYYCZGJWYXDXFRSKSTQTENQMRKQZHHQKDLDAZFKYPBGGPZREBZZYKZZSPEGJXGYKQZZZSLYSYYYZWFQZYLZZLZHWCHKYPQGNPGBLPLRRJYXCCSYYHSFZFYBZYYTGZXYLXCZWXXZJZBLFFLGSKHYJZEYJHLPLLLLCZGXDRZELRHGKLZZYHZLYQSZZJZQLJZFLNBHGWLCZCFJYSPYXZLZLXGCCPZBLLCYBBBBUBBCBPCRNNZCZYRBFSRLDCGQYYQXYGMQZWTZYTYJXYFWTEHZZJYWLCCNTZYJJZDEDPZDZTSYQJHDYMBJNYJZLXTSSTPHNDJXXBYXQTZQDDTJTDYYTGWSCSZQFLSHLGLBCZPHDLYZJYCKWTYTYLBNYTSDSYCCTYSZYYEBHEXHQDTWNYGYCLXTSZYSTQMYGZAZCCSZZDSLZCLZRQXYYELJSBYMXSXZTEMBBLLYYLLYTDQYSHYMRQWKFKBFXNXSBYCHXBWJYHTQBPBSBWDZYLKGZSKYHXQZJXHXJXGNLJKZLYYCDXLFYFGHLJGJYBXQLYBXQPQGZTZPLNCYPXDJYQYDYMRBESJYYHKXXSTMXRCZZYWXYQYBMCLLYZHQYZWQXDBXBZWZMSLPDMYSKFMZKLZCYQYCZLQXFZZYDQZPZYGYJYZMZXDZFYFYTTQTZHGSPCZMLCCYTZXJCYTJMKSLPZHYSNZLLYTPZCTZZCKTXDHXXTQCYFKSMQCCYYAZHTJPCYLZLYJBJXTPNYLJYYNRXSYLMMNXJSMYBCSYSYLZYLXJJQYLDZLPQBFZZBLFNDXQKCZFYWHGQMRDSXYCYTXNQQJZYYPFZXDYZFPRXEJDGYQBXRCNFYYQPGHYJDYZXGRHTKYLNWDZNTSMPKLBTHBPYSZBZTJZSZZJTYYXZPHSSZZBZCZPTQFZMYFLYPYBBJQXZMXXDJMTSYSKKBJZXHJCKLPSMKYJZCXTMLJYXRZZQSLXXQPYZXMKYXXXJCLJPRMYYGADYSKQLSNDHYZKQXZYZTCGHZTLMLWZYBWSYCTBHJHJFCWZTXWYTKZLXQSHLYJZJXTMPLPYCGLTBZZTLZJCYJGDTCLKLPLLQPJMZPAPXYZLKKTKDZCZZBNZDYDYQZJYJGMCTXLTGXSZLMLHBGLKFWNWZHDXUHLFMKYSLGXDTWWFRJEJZTZHYDXYKSHWFZCQSHKTMQQHTZHYMJDJSKHXZJZBZZXYMPAGQMSTPXLSKLZYNWRTSQLSZBPSPSGZWYHTLKSSSWHZZLYYTNXJGMJSZSUFWNLSOZTXGXLSAMMLBWLDSZYLAKQCQCTMYCFJBSLXCLZZCLXXKSBZQCLHJPSQPLSXXCKSLNHPSFQQYTXYJZLQLDXZQJZDYYDJNZPTUZDSKJFSLJHYLZSQZLBTXYDGTQFDBYAZXDZHZJNHHQBYKNXJJQCZMLLJZKSPLDYCLBBLXKLELXJLBQYCXJXGCNLCQPLZLZYJTZLJGYZDZPLTQCSXFDMNYCXGBTJDCZNBGBQYQJWGKFHTNPYQZQGBKPBBYZMTJDYTBLSQMPSXTBNPDXKLEMYYCJYNZCTLDYKZZXDDXHQSHDGMZSJYCCTAYRZLPYLTLKXSLZCGGEXCLFXLKJRTLQJAQZNCMBYDKKCXGLCZJZXJHPTDJJMZQYKQSECQZDSHHADMLZFMMZBGNTJNNLGBYJBRBTMLBYJDZXLCJLPLDLPCQDHLXZLYCBLCXZZJADJLNZMMSSSMYBHBSQKBHRSXXJMXSDZNZPXLGBRHWGGFCXGMSKLLTSJYYCQLTSKYWYYHYWXBXQYWPYWYKQLSQPTNTKHQCWDQKTWPXXHCPTHTWUMSSYHBWCRWXHJMKMZNGWTMLKFGHKJYLSYYCXWHYECLQHKQHTTQKHFZLDXQWYZYYDESBPKYRZPJFYYZJCEQDZZDLATZBBFJLLCXDLMJSSXEGYGSJQXCWBXSSZPDYZCXDNYXPPZYDLYJCZPLTXLSXYZYRXCYYYDYLWWNZSAHJSYQYHGYWWAXTJZDAXYSRLTDPSSYYFNEJDXYZHLXLLLZQZSJNYQYQQXYJGHZGZCYJCHZLYCDSHWSHJZYJXCLLNXZJJYYXNFXMWFPYLCYLLABWDDHWDXJMCXZTZPMLQZHSFHZYNZTLLDYWLSLXHYMMYLMBWWKYXYADTXYLLDJPYBPWUXJMWMLLSAFDLLYFLBHHHBQQLTZJCQJLDJTFFKMMMBYTHYGDCQRDDWRQJXNBYSNWZDBYYTBJHPYBYTTJXAAHGQDQTMYSTQXKBTZPKJLZRBEQQSSMJJBDJOTGTBXPGBKTLHQXJJJCTHXQDWJLWRFWQGWSHCKRYSWGFTGYGBXSDWDWRFHWYTJJXXXJYZYSLPYYYPAYXHYDQKXSHXYXGSKQHYWFDDDPPLCJLQQEEWXKSYYKDYPLTJTHKJLTCYYHHJTTPLTZZCDLTHQKZXQYSTEEYWYYZYXXYYSTTJKLLPZMCYHQGXYHSRMBXPLLNQYDQHXSXXWGDQBSHYLLPJJJTHYJKYPPTHYYKTYEZYENMDSHLCRPQFDGFXZPSFTLJXXJBSWYYSKSFLXLPPLBBBLBSFXFYZBSJSSYLPBBFFFFSSCJDSTZSXZRYYSYFFSYZYZBJTBCTSBSDHRTJJBYTCXYJEYLXCBNEBJDSYXYKGSJZBXBYTFZWGENYHHTHZHHXFWGCSTBGXKLSXYWMTMBYXJSTZSCDYQRCYTWXZFHMYMCXLZNSDJTTTXRYCFYJSBSDYERXJLJXBBDEYNJGHXGCKGSCYMBLXJMSZNSKGXFBNBPTHFJAAFXYXFPXMYPQDTZCXZZPXRSYWZDLYBBKTYQPQJPZYPZJZNJPZJLZZFYSBTTSLMPTZRTDXQSJEHBZYLZDHLJSQMLHTXTJECXSLZZSPKTLZKQQYFSYGYWPCPQFHQHYTQXZKRSGTTSQCZLPTXCDYYZXSQZSLXLZMYCPCQBZYXHBSXLZDLTCDXTYLZJYYZPZYZLTXJSJXHLPMYTXCQRBLZSSFJZZTNJYTXMYJHLHPPLCYXQJQQKZZSCPZKSWALQSBLCCZJSXGWWWYGYKTJBBZTDKHXHKGTGPBKQYSLPXPJCKBMLLXDZSTBKLGGQKQLSBKKTFXRMDKBFTPZFRTBBRFERQGXYJPZSSTLBZTPSZQZSJDHLJQLZBPMSMMSXLQQNHKNBLRDDNXXDHDDJCYYGYLXGZLXSYGMQQGKHBPMXYXLYTQWLWGCPBMQXCYZYDRJBHTDJYHQSHTMJSBYPLWHLZFFNYPMHXXHPLTBQPFBJWQDBYGPNZTPFZJGSDDTQSHZEAWZZYLLTYYBWJKXXGHLFKXDJTMSZSQYNZGGSWQSPHTLSSKMCLZXYSZQZXNCJDQGZDLFNYKLJCJLLZLMZZNHYDSSHTHZZLZZBBHQZWWYCRZHLYQQJBEYFXXXWHSRXWQHWPSLMSSKZTTYGYQQWRSLALHMJTQJSMXQBJJZJXZYZKXBYQXBJXSHZTSFJLXMXZXFGHKZSZGGYLCLSARJYHSLLLMZXELGLXYDJYTLFBHBPNLYZFBBHPTGJKWETZHKJJXZXXGLLJLSTGSHJJYQLQZFKCGNNDJSSZFDBCTWWSEQFHQJBSAQTGYPQLBXBMMYWXGSLZHGLZGQYFLZBYFZJFRYSFMBYZHQGFWZSYFYJJPHZBYYZFFWODGRLMFTWLBZGYCQXCDJYGZYYYYTYTYDWEGAZYHXJLZYYHLRMGRXXZCLHNELJJTJTPWJYBJJBXJJTJTEEKHWSLJPLPSFYZPQQBDLQJJTYYQLYZKDKSQJYYQZLDQTGJQYZJSUCMRYQTHTEJMFCTYHYPKMHYZWJDQFHYYXWSHCTXRLJHQXHCCYYYJLTKTTYTMXGTCJTZAYYOCZLYLBSZYWJYTSJYHBYSHFJLYGJXXTMZYYLTXXYPZLXYJZYZYYPNHMYMDYYLBLHLSYYQQLLNJJYMSOYQBZGDLYXYLCQYXTSZEGXHZGLHWBLJHEYXTWQMAKBPQCGYSHHEGQCMWYYWLJYJHYYZLLJJYLHZYHMGSLJLJXCJJYCLYCJPCPZJZJMMYLCQLNQLJQJSXYJMLSZLJQLYCMMHCFMMFPQQMFYLQMCFFQMMMMHMZNFHHJGTTHHKHSLNCHHYQDXTMMQDCYZYXYQMYQYLTDCYYYZAZZCYMZYDLZFFFMMYCQZWZZMABTBYZTDMNZZGGDFTYPCGQYTTSSFFWFDTZQSSYSTWXJHXYTSXXYLBYQHWWKXHZXWZNNZZJZJJQJCCCHYYXBZXZCYZTLLCQXYNJYCYYCYNZZQYYYEWYCZDCJYCCHYJLBTZYYCQWMPWPYMLGKDLDLGKQQBGYCHJXY",e.oMultiDiff={19969:"DZ",19975:"WM",19988:"QJ",20048:"YL",20056:"SC",20060:"NM",20094:"QG",20127:"QJ",20167:"QC",20193:"YG",20250:"KH",20256:"ZC",20282:"SC",20285:"QJG",20291:"TD",20314:"YD",20340:"NE",20375:"TD",20389:"YJ",20391:"CZ",20415:"PB",20446:"YS",20447:"SQ",20504:"TC",20608:"KG",20854:"QJ",20857:"ZC",20911:"PF",20985:"AW",21032:"PB",21048:"XQ",21049:"SC",21089:"YS",21119:"JC",21242:"SB",21273:"SC",21305:"YP",21306:"QO",21330:"ZC",21333:"SDC",21345:"QK",21378:"CA",21397:"SC",21414:"XS",21442:"SC",21477:"JG",21480:"TD",21484:"ZS",21494:"YX",21505:"YX",21512:"HG",21523:"XH",21537:"PB",21542:"PF",21549:"KH",21571:"E",21574:"DA",21588:"TD",21589:"O",21618:"ZC",21621:"KHA",21632:"ZJ",21654:"KG",21679:"LKG",21683:"KH",21710:"A",21719:"YH",21734:"WOE",21769:"A",21780:"WN",21804:"XH",21834:"A",21899:"ZD",21903:"RN",21908:"WO",21939:"ZC",21956:"SA",21964:"YA",21970:"TD",22003:"A",22031:"JG",22040:"XS",22060:"ZC",22066:"ZC",22079:"MH",22129:"XJ",22179:"XA",22237:"NJ",22244:"TD",22280:"JQ",22300:"YH",22313:"XW",22331:"YQ",22343:"YJ",22351:"PH",22395:"DC",22412:"TD",22484:"PB",22500:"PB",22534:"ZD",22549:"DH",22561:"PB",22612:"TD",22771:"KQ",22831:"HB",22841:"JG",22855:"QJ",22865:"XQ",23013:"ML",23081:"WM",23487:"SX",23558:"QJ",23561:"YW",23586:"YW",23614:"YW",23615:"SN",23631:"PB",23646:"ZS",23663:"ZT",23673:"YG",23762:"TD",23769:"ZS",23780:"QJ",23884:"QK",24055:"XH",24113:"DC",24162:"ZC",24191:"GA",24273:"QJ",24324:"NL",24377:"TD",24378:"QJ",24439:"PF",24554:"ZS",24683:"TD",24694:"WE",24733:"LK",24925:"TN",25094:"ZG",25100:"XQ",25103:"XH",25153:"PB",25170:"PB",25179:"KG",25203:"PB",25240:"ZS",25282:"FB",25303:"NA",25324:"KG",25341:"ZY",25373:"WZ",25375:"XJ",25384:"A",25457:"A",25528:"SD",25530:"SC",25552:"TD",25774:"ZC",25874:"ZC",26044:"YW",26080:"WM",26292:"PB",26333:"PB",26355:"ZY",26366:"CZ",26397:"ZC",26399:"QJ",26415:"ZS",26451:"SB",26526:"ZC",26552:"JG",26561:"TD",26588:"JG",26597:"CZ",26629:"ZS",26638:"YL",26646:"XQ",26653:"KG",26657:"XJ",26727:"HG",26894:"ZC",26937:"ZS",26946:"ZC",26999:"KJ",27099:"KJ",27449:"YQ",27481:"XS",27542:"ZS",27663:"ZS",27748:"TS",27784:"SC",27788:"ZD",27795:"TD",27812:"O",27850:"PB",27852:"MB",27895:"SL",27898:"PL",27973:"QJ",27981:"KH",27986:"HX",27994:"XJ",28044:"YC",28065:"WG",28177:"SM",28267:"QJ",28291:"KH",28337:"ZQ",28463:"TL",28548:"DC",28601:"TD",28689:"PB",28805:"JG",28820:"QG",28846:"PB",28952:"TD",28975:"ZC",29100:"A",29325:"QJ",29575:"SL",29602:"FB",30010:"TD",30044:"CX",30058:"PF",30091:"YSP",30111:"YN",30229:"XJ",30427:"SC",30465:"SX",30631:"YQ",30655:"QJ",30684:"QJG",30707:"SD",30729:"XH",30796:"LG",30917:"PB",31074:"NM",31085:"JZ",31109:"SC",31181:"ZC",31192:"MLB",31293:"JQ",31400:"YX",31584:"YJ",31896:"ZN",31909:"ZY",31995:"XJ",32321:"PF",32327:"ZY",32418:"HG",32420:"XQ",32421:"HG",32438:"LG",32473:"GJ",32488:"TD",32521:"QJ",32527:"PB",32562:"ZSQ",32564:"JZ",32735:"ZD",32793:"PB",33071:"PF",33098:"XL",33100:"YA",33152:"PB",33261:"CX",33324:"BP",33333:"TD",33406:"YA",33426:"WM",33432:"PB",33445:"JG",33486:"ZN",33493:"TS",33507:"QJ",33540:"QJ",33544:"ZC",33564:"XQ",33617:"YT",33632:"QJ",33636:"XH",33637:"YX",33694:"WG",33705:"PF",33728:"YW",33882:"SR",34067:"WM",34074:"YW",34121:"QJ",34255:"ZC",34259:"XL",34425:"JH",34430:"XH",34485:"KH",34503:"YS",34532:"HG",34552:"XS",34558:"YE",34593:"ZL",34660:"YQ",34892:"XH",34928:"SC",34999:"QJ",35048:"PB",35059:"SC",35098:"ZC",35203:"TQ",35265:"JX",35299:"JX",35782:"SZ",35828:"YS",35830:"E",35843:"TD",35895:"YG",35977:"MH",36158:"JG",36228:"QJ",36426:"XQ",36466:"DC",36710:"JC",36711:"ZYG",36767:"PB",36866:"SK",36951:"YW",37034:"YX",37063:"XH",37218:"ZC",37325:"ZC",38063:"PB",38079:"TD",38085:"QY",38107:"DC",38116:"TD",38123:"YD",38224:"HG",38241:"XTC",38271:"ZC",38415:"YE",38426:"KH",38461:"YD",38463:"AE",38466:"PB",38477:"XJ",38518:"YT",38551:"WK",38585:"ZC",38704:"XS",38739:"LJ",38761:"GJ",38808:"SQ",39048:"JG",39049:"XJ",39052:"HG",39076:"CZ",39271:"XT",39534:"TD",39552:"TD",39584:"PB",39647:"SB",39730:"LG",39748:"TPB",40109:"ZQ",40479:"ND",40516:"HG",40536:"HG",40583:"QJ",40765:"YQ",40784:"QJ",40840:"YK",40863:"QJG"},e}(),LH=function(){function e(){}return e.prototype.makePy=function(e){if("string"!=typeof e)throw new Error("函数makePy需要字符串类型参数!");for(var t=new Array,i=0,r=e.length;i<r;i++){var n=e.charAt(i);t.push(this.checkCh(n))}return this.mkRslt(t)},e.prototype.checkCh=function(e){var t=e.charCodeAt(0);return t>40869||t<19968?e:OH.oMultiDiff[t]?OH.oMultiDiff[t]:OH.strChineseFirstPY.charAt(t-19968)},e.prototype.mkRslt=function(e){for(var t=[""],i=0,r=e.length;i<r;i++){var n=e[i],o=n.length;if(1==o)for(var s=0;s<t.length;s++)t[s]+=n;else{var a=t.slice(0);for(t=[],s=0;s<o;s++){for(var l=a.slice(0),h=0;h<l.length;h++)l[h]+=n.charAt(s);t=t.concat(l)}}}return t},e}();!function(e){e[e.byClick=0]="byClick",e[e.withPrevious=1]="withPrevious",e[e.afterPrevious=2]="afterPrevious"}(fH||(fH={}));var DH,IH=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),RH=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},HH=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},FH=function(e){function t(){return e.call(this)||this}return IH(t,e),Object.defineProperty(t.prototype,"htmlElement",{get:function(){return this._htmlElement||(this._htmlElement=document.getElementById(this.htmlElementId)),this._htmlElement},enumerable:!1,configurable:!0}),t.prototype.initAnimation=function(){},t.prototype.onTick=function(e){},t.prototype.stopAnimation=function(){},RH([(0,fy.o)(),HH("design:type",Object)],t.prototype,"_htmlElement",void 0),RH([(0,fy.o)(),HH("design:type",Object),HH("design:paramtypes",[])],t.prototype,"htmlElement",null),RH([(0,fy.o)(),HH("design:type",Object)],t.prototype,"sampledProperty",void 0),t=RH([yx("CssAnimationBase"),HH("design:paramtypes",[])],t)}(Px),NH=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),QH=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},kH=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},UH=function(e){function t(){var t=e.call(this)||this;return t.hasReadFulltime=!1,setTimeout((function(){t.initAnimation()}),1e3),t}return NH(t,e),t.prototype.initAnimation=function(){this.media=document.getElementById(this.htmlElementId+"_media"),this.media&&!this.hasReadFulltime&&(this.initComplete=new th.x,this.fulltime=this.media.duration,this.duration=this.fulltime,this.hasReadFulltime=!0,this.initComplete.next(1))},t.prototype.onTick=function(e){var t=e;this.htmlElement&&(t>=this.beginTime+this.duration?this.stopAnimation():t>=this.beginTime&&this.media.paused&&this.media.play())},t.prototype.stopAnimation=function(){this.htmlElement&&this.media.load()},t=QH([yx("VideoAnimation"),kH("design:paramtypes",[])],t)}(FH),jH=i(5108),GH=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),zH=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},YH=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},ZH=function(e){function t(){var t=e.call(this)||this;return t.hasReadFulltime=!1,setTimeout((function(){t.initAnimation()}),1e3),t.hideValues=["fillBehavior"],t}return GH(t,e),Object.defineProperty(t.prototype,"target",{get:function(){return DP.getMusic(this.targetId)},enumerable:!1,configurable:!0}),t.prototype.initAnimation=function(){var e;this.label="音效",this.media=null===(e=this.target)||void 0===e?void 0:e.audioObj,this.media&&!this.hasReadFulltime&&(this.initComplete=new th.x,this.fulltime=this.media.duration,this.duration=this.fulltime,this.hasReadFulltime=!0,this.initComplete.next(1))},t.prototype.onTick=function(e){var t=e;if(t>=this.beginTime+this.duration)this.stopAnimation();else if(t>=this.beginTime)try{this.media.paused&&this.media.play()}catch(e){jH.log(e)}},t.prototype.stopAnimation=function(){this.media.load()},zH([(0,fy.o)(),YH("design:type",Object),YH("design:paramtypes",[])],t.prototype,"target",null),zH([(0,fy.o)(),YH("design:type",Object)],t.prototype,"media",void 0),t=zH([yx("AudioAnimation"),YH("design:paramtypes",[])],t)}(Px),WH=i(5108),XH=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),JH=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},KH=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},VH=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.defaultValue=void 0,t}return XH(t,e),t.prototype.createSampledProperty=function(){},t.prototype.initAnimation=function(){var e=this;this.geojsonDataSource=this.viewer.dataSources._dataSources.find((function(t){return t.name===e.dataSourceName})),this.geojsonDataSource&&(WH.log("geojsonDataSource",this.geojsonDataSource),this.defaultValue=this.geojsonDataSource[this.property])},t.prototype.stopAnimation=function(){this.geojsonDataSource&&(this.geojsonDataSource[this.property]=this.defaultValue)},t.prototype.onTick=function(e){var t=this,i=e;if(this.geojsonDataSource)if(i>=this.beginTime+this.duration){var r=vx.HoldEnd;this.fillBehavior==r?this.geojsonDataSource[this.property]=this.to:this.stopAnimation(),this.geojsonDataSource.addedGJPlot.show=this.defaultValue}else if(i>=this.beginTime){var n=this.getCurrentValue(e);this.geojsonDataSource[this.property]=n,this.entityType&&this.geojsonDataSource.entities.values.forEach((function(e){return e[t.entityType][t.property]=n})),this.geojsonDataSource.addedGJPlot.show=n}},t.prototype.getCurrentValue=function(e){var t=e,i=this.beginTime+this.duration;return t<this.beginTime?this.from:t>i?this.to:this.sampledProperty.getValue(this.getCesiumAnimationTime(e))},JH([(0,fy.o)(),KH("design:type",Object)],t.prototype,"geojsonDataSource",void 0),JH([dy({name:"起始值",group:"",type:"owner",order:5,max:1,min:0}),KH("design:type",Object)],t.prototype,"from",void 0),JH([dy({name:"终止值",group:"",type:"owner",order:6,max:1,min:0}),KH("design:type",Object)],t.prototype,"to",void 0),t=JH([yx("GeojsonAnimation")],t)}(Px),qH=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),$H=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},eF=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},tF=function(e){function t(){var t=e.call(this)||this;return t.isexecuted=!1,t.speed=1,t.hideValues=["fillBehavior"],t}return qH(t,e),t.prototype.stopAnimation=function(){},t.prototype.initAnimation=function(){this.isexecuted=!1},t.prototype.onTick=function(e){var t=e;if(t>=this.beginTime+this.duration||t<this.beginTime)this.isexecuted=!1;else if(t>=this.beginTime){if(this.isexecuted){var i=this.viewer,r=i.camera,n=i.clock,o=i.scene;if(o.mode!==Cesium.SceneMode.SCENE3D)return;o.globe.ellipsoid.cartesianToCartographic(r.position).height,n.currentTime;r.rotate(Cesium.Cartesian3.UNIT_Z,Math.PI/86400*1440*(this.speed*Gx.multiplier/100))}else void 0!==this.heading&&void 0!==this.pitch&&void 0!==this.roll&&void 0!==this.lon&&void 0!==this.lat&&void 0!==this.alt&&this.viewer.camera.setView({destination:Cesium.Cartesian3.fromDegrees(this.lon,this.lat,this.alt),orientation:{heading:Cesium.Math.toRadians(this.heading),pitch:Cesium.Math.toRadians(this.pitch),roll:this.roll}});this.isexecuted=!0}},t.prototype.set=function(){var e=this.viewer.camera,t=this.viewer.camera.positionWC;for(var i in this.lon=zy.getLongitudeByCartesian3(t,this.viewer),this.lat=zy.getLatitudeByCartesian3(t,this.viewer),this.alt=zy.getHeightByCartesian3(t,this.viewer),this.heading=Cesium.Math.toDegrees(e.heading),this.pitch=Cesium.Math.toDegrees(e.pitch),this.roll=e.roll,this.__meta__)this.__meta__[i].isError=!1},$H([(0,fy.o)(),eF("design:type",Object)],t.prototype,"isexecuted",void 0),$H([dy({name:"自转速率",group:"",type:"autoRotateSpeed",order:16,min:1,max:10}),eF("design:type",Number)],t.prototype,"speed",void 0),$H([dy({name:"获取视角",group:"",type:"function",order:17}),eF("design:type",Function),eF("design:paramtypes",[]),eF("design:returntype",void 0)],t.prototype,"set",null),t=$H([yx("AutoRotationAnimation"),eF("design:paramtypes",[])],t)}(Px),iF=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),rF=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},nF=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},oF=function(e){function t(){var t=e.call(this)||this;return t.pHeight=25e3,t.isexecuted=!1,t.hideValues=["fillBehavior"],t}return iF(t,e),t.prototype.stopAnimation=function(){},t.prototype.initAnimation=function(){this.isexecuted=!1},t.prototype.onTick=function(e){var t=this,i=e;i>=this.beginTime+this.duration||i<this.beginTime||this.isexecuted||(this.isexecuted=!0,this.viewer.camera.flyTo({destination:Cesium.Cartesian3.fromDegrees(this.lon,this.lat,1e3*this.pHeight),orientation:{heading:Cesium.Math.toRadians(this.heading),pitch:Cesium.Math.toRadians(this.pitch),roll:this.roll},duration:this.duration/(10*Gx.multiplier)*3,easingFunction:function(e){return e},complete:function(){t.viewer.camera.flyTo({destination:Cesium.Cartesian3.fromDegrees(t.lon,t.lat,t.alt),orientation:{heading:Cesium.Math.toRadians(t.heading),pitch:Cesium.Math.toRadians(t.pitch),roll:t.roll},duration:t.duration/(10*Gx.multiplier)*7,easingFunction:function(e){return e*(2-e)}})}}))},t.prototype.set=function(){var e=this.viewer.camera,t=this.viewer.camera.positionWC;for(var i in this.lon=zy.getLongitudeByCartesian3(t,this.viewer),this.lat=zy.getLatitudeByCartesian3(t,this.viewer),this.alt=zy.getHeightByCartesian3(t,this.viewer),this.heading=Cesium.Math.toDegrees(e.heading),this.pitch=Cesium.Math.toDegrees(e.pitch),this.roll=e.roll,this.__meta__)this.__meta__[i].isError=!1},rF([dy({name:"相机经度",group:"",type:"zoomSliderInput",order:11,min:-180,max:180}),nF("design:type",Number)],t.prototype,"lon",void 0),rF([dy({name:"相机纬度",group:"",type:"zoomSliderInput",order:12,min:-90,max:90}),nF("design:type",Number)],t.prototype,"lat",void 0),rF([dy({name:"相机高度",group:"",type:"zoomSliderInput",order:13,min:0,max:99999999}),nF("design:type",Number)],t.prototype,"alt",void 0),rF([dy({name:"相机朝向",group:"",type:"zoomSliderInput",order:14,min:-360,max:360}),nF("design:type",Number)],t.prototype,"heading",void 0),rF([dy({name:"相机俯仰",group:"",type:"zoomSliderInput",order:15,min:-360,max:360}),nF("design:type",Number)],t.prototype,"pitch",void 0),rF([dy({name:"相机偏航",group:"",type:"zoomSliderInput",order:16,min:-360,max:360}),nF("design:type",Number)],t.prototype,"roll",void 0),rF([dy({name:"拉起高度",group:"",type:"zoomSliderInput",order:16,min:0,max:99999}),nF("design:type",Object)],t.prototype,"pHeight",void 0),rF([(0,fy.o)(),nF("design:type",Object)],t.prototype,"isexecuted",void 0),rF([dy({name:"获取视角",group:"",type:"function",order:17}),nF("design:type",Function),nF("design:paramtypes",[]),nF("design:returntype",void 0)],t.prototype,"set",null),t=rF([yx("ZoomToFlyAnimation"),nF("design:paramtypes",[])],t)}(Px),sF=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),aF=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},lF=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},hF=function(e){function t(){var t=e.call(this)||this;return t.isexecuted=!1,t.hideValues=["fillBehavior"],t}return sF(t,e),t.prototype.stopAnimation=function(){},t.prototype.initAnimation=function(){this.isexecuted=!1},t.prototype.onTick=function(e){var t=e;t>=this.beginTime+this.duration?this.isexecuted=!1:t>=this.beginTime&&(this.isexecuted||this.viewer.camera.flyTo({destination:Cesium.Cartesian3.fromDegrees(this.lon,this.lat,this.alt),orientation:{heading:Cesium.Math.toRadians(this.heading),pitch:Cesium.Math.toRadians(this.pitch),roll:this.roll},duration:this.duration}),this.isexecuted=!0)},t.prototype.set=function(){var e=this.viewer.camera,t=this.viewer.camera.positionWC;for(var i in this.lon=zy.getLongitudeByCartesian3(t,this.viewer),this.lat=zy.getLatitudeByCartesian3(t,this.viewer),this.alt=zy.getHeightByCartesian3(t,this.viewer),this.heading=Cesium.Math.toDegrees(e.heading),this.pitch=Cesium.Math.toDegrees(e.pitch),this.roll=e.roll,this.__meta__)this.__meta__[i].isError=!1},aF([(0,fy.o)(),lF("design:type",Object)],t.prototype,"isexecuted",void 0),aF([dy({name:"相机经度",group:"",type:"numberNew",order:11,min:-180,max:180}),lF("design:type",Number)],t.prototype,"lon",void 0),aF([dy({name:"相机纬度",group:"",type:"numberNew",order:12,min:-90,max:90}),lF("design:type",Number)],t.prototype,"lat",void 0),aF([dy({name:"相机高度",group:"",type:"numberNew",order:13,min:0}),lF("design:type",Number)],t.prototype,"alt",void 0),aF([dy({name:"相机朝向",group:"",type:"numberNew",order:14,min:-360,max:360}),lF("design:type",Number)],t.prototype,"heading",void 0),aF([dy({name:"相机俯仰",group:"",type:"numberNew",order:15,min:-360,max:360}),lF("design:type",Number)],t.prototype,"pitch",void 0),aF([dy({name:"相机偏航",group:"",type:"numberNew",order:16,min:-360,max:360}),lF("design:type",Number)],t.prototype,"roll",void 0),aF([dy({name:"获取视角",group:"",type:"function",order:17}),lF("design:type",Function),lF("design:paramtypes",[]),lF("design:returntype",void 0)],t.prototype,"set",null),t=aF([yx("CameraFlyAnimation"),lF("design:paramtypes",[])],t)}(Px),cF=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),uF=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},pF=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},dF=function(e){function t(){var t=e.call(this)||this;return t.isexecuted=!1,t.hideValues=["fillBehavior"],t}return cF(t,e),t.prototype.stopAnimation=function(){this.isexecuted=!1,this.polyLine,this.viewer.trackedEntity=void 0},t.prototype.initAnimation=function(){this.isexecuted=!1},t.prototype.onTick=function(e){var t=e;if(t>=this.beginTime+this.duration)this.stopAnimation();else if(t>=this.beginTime){t-=this.beginTime;var i=this.polyLine.interopLine.evaluate(t/this.duration);this.viewer.scene.camera.setView({destination:i,orientation:{heading:Cesium.Math.toRadians(this.heading),pitch:Cesium.Math.toRadians(this.pitch),role:Cesium.Math.toRadians(this.roll)}})}},t.prototype.set=function(){var e=this.viewer.camera;this.viewer.camera.positionWC;for(var t in this.heading=Cesium.Math.toDegrees(e.heading),this.pitch=Cesium.Math.toDegrees(e.pitch),this.roll=Cesium.Math.toDegrees(e.roll),this.__meta__)this.__meta__[t].isError=!1},Object.defineProperty(t.prototype,"polyLine",{get:function(){return ey.getGraph(this.polyLineId)},enumerable:!1,configurable:!0}),t.prototype.toRadians=function(e){return e*Math.PI/180},t.prototype.toDegrees=function(e){return 180*e/Math.PI},t.prototype.car3ToLonlat=function(e){var t=this.viewer.scene.globe.ellipsoid.cartesianToCartographic(e);return{lat:Cesium.Math.toDegrees(t.latitude),lng:Cesium.Math.toDegrees(t.longitude)}},uF([(0,fy.o)(),pF("design:type",Array)],t.prototype,"polyLinePosition",void 0),uF([(0,fy.o)(),pF("design:type",Object)],t.prototype,"defaultPolyLinePosition",void 0),uF([(0,fy.o)(),pF("design:type",Object)],t.prototype,"isexecuted",void 0),uF([dy({name:"相机朝向",group:"",type:"numberNew",order:14,min:-360,max:360}),pF("design:type",Number)],t.prototype,"heading",void 0),uF([dy({name:"相机俯仰",group:"",type:"numberNew",order:15,min:-360,max:360}),pF("design:type",Number)],t.prototype,"pitch",void 0),uF([dy({name:"相机偏航",group:"",type:"numberNew",order:16,min:-360,max:360}),pF("design:type",Number)],t.prototype,"roll",void 0),uF([dy({name:"获取视角",group:"",type:"function",order:17}),pF("design:type",Function),pF("design:paramtypes",[]),pF("design:returntype",void 0)],t.prototype,"set",null),uF([dy({name:"路径线",group:"",type:"displayTarget",order:9}),(0,fy.o)(),pF("design:type",lM),pF("design:paramtypes",[])],t.prototype,"polyLine",null),uF([(0,fy.o)(),pF("design:type",Cesium.SampledPositionProperty)],t.prototype,"sampledProperty",void 0),t=uF([yx("CameraRoamAnimation"),pF("design:paramtypes",[])],t)}(Px),mF=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),fF=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},gF=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},AF=function(e){function t(){var t=e.call(this)||this;return t.isexecuted=!1,t.hideValues=["fillBehavior"],t}return mF(t,e),Object.defineProperty(t.prototype,"target",{get:function(){return ey.getGraph(this.targetId)},enumerable:!1,configurable:!0}),t.prototype.stopAnimation=function(){this.isexecuted=!1},t.prototype.initAnimation=function(){this.isexecuted=!1},t.prototype.initTargetPosition=function(){if(this.target instanceof UP)if(this.target instanceof sI||this.target instanceof cE){var e=this.target.ctrlPosition[0];this.targetPosition=Cesium.Cartesian3.fromDegrees(e.lon,e.lat,e.alt,this.viewer.scene.globe.ellipsoid)}else this.targetPosition=this.target.positionProperty;else this.target instanceof LS||this.target instanceof JS?this.targetPosition=this.target.ent.position.getValue():this.targetPosition=this.target.ent.position._value;this.targetPosition&&(this.targetLLA=this.car3ToLonlat(this.targetPosition))},t.prototype.onTick=function(e){var t=e;if(t>=this.beginTime+this.duration)this.stopAnimation();else if(t>=this.beginTime){t-=this.beginTime,this.initTargetPosition();var i=this.polyLine.interopLine.evaluate(t/this.duration);if(this.targetPosition&&i){var r=this.computerOrient(i,this.targetPosition);this.viewer.scene.camera.setView({destination:i,orientation:{heading:Cesium.Math.toRadians(r.heading+90),pitch:Cesium.Math.toRadians(r.pitch),role:Cesium.Math.toRadians(r.roll)}})}}},Object.defineProperty(t.prototype,"polyLine",{get:function(){return ey.getGraph(this.polyLineId)},enumerable:!1,configurable:!0}),t.prototype.car3ToLonlat=function(e){var t=this.viewer.scene.globe.ellipsoid.cartesianToCartographic(e);return{lat:Cesium.Math.toDegrees(t.latitude),lng:Cesium.Math.toDegrees(t.longitude)}},t.prototype.vec1ToVec2Mat=function(e,t){var i=Cesium.Cartesian3.cross(e,t,new Cesium.Cartesian3(0,0,0)),r=Cesium.Math.acosClamped(Cesium.Cartesian3.dot(e,t)/(Cesium.Cartesian3.magnitude(e)*Cesium.Cartesian3.magnitude(t))),n=Cesium.Quaternion.fromAxisAngle(i,r,new Cesium.Quaternion(0,0,0,0));return Cesium.Matrix3.fromQuaternion(n,new Cesium.Matrix3)},t.prototype.computerOrient=function(e,t){var i,r,n=Cesium.Transforms.eastNorthUpToFixedFrame(e),o=Cesium.Quaternion.clone(Cesium.Quaternion.IDENTITY),s=(Cesium.Matrix3.clone(Cesium.Matrix3.IDENTITY),Cesium.Matrix3.clone(Cesium.Matrix3.IDENTITY)),a=Cesium.Matrix3.clone(Cesium.Matrix3.IDENTITY),l=new Cesium.Cartesian3(0,0,0);return s=Cesium.Matrix4.getMatrix3(n,s),l=Cesium.Cartesian3.subtract(t,e,l),a=Cesium.Matrix3.inverse(s,a),l=Cesium.Matrix3.multiplyByVector(a,l,l),i=this.vec1ToVec2Mat(Cesium.Cartesian3.UNIT_X,Cesium.Cartesian3.normalize(l,l)),o=Cesium.Quaternion.fromRotationMatrix(i,o),r=Cesium.HeadingPitchRoll.fromQuaternion(o,r),{heading:Cesium.Math.toDegrees(r.heading),pitch:Cesium.Math.toDegrees(r.pitch),roll:Cesium.Math.toDegrees(r.roll)}},fF([dy({name:"标绘元素",group:"",type:"displayTarget",order:9}),(0,fy.o)(),gF("design:type",rv),gF("design:paramtypes",[])],t.prototype,"target",null),fF([(0,fy.o)(),gF("design:type",Object)],t.prototype,"isexecuted",void 0),fF([dy({name:"路径线",group:"",type:"displayTarget",order:9}),(0,fy.o)(),gF("design:type",lM),gF("design:paramtypes",[])],t.prototype,"polyLine",null),t=fF([yx("FollowAnimation"),gF("design:paramtypes",[])],t)}(Px),yF=function(){function e(){}return e.getModelMatrix=function(t,i,r,n,o){if(null==t)return r;var s=Cesium.Property.getValueOrUndefined(t.position,i,e.positionScratch);if(Cesium.defined(s)){if(n){var a=n.scene.globe.ellipsoid.cartesianToCartographic(s),l=n.scene.globe.getHeight(a);o&&(l+=o),a.height=l,s=n.scene.globe.ellipsoid.cartographicToCartesian(a)}var h=Cesium.Property.getValueOrUndefined(t.orientation,i,e.orientationScratch);return r=Cesium.defined(h)?Cesium.Matrix4.fromRotationTranslation(Cesium.Matrix3.fromQuaternion(h),s,r):Cesium.Transforms.eastNorthUpToFixedFrame(s,void 0,r)}},e.matrix3Scratch=Cesium.Matrix3,e.positionScratch=Cesium.Cartesian3?new Cesium.Cartesian3:null,e.orientationScratch=Cesium.Quaternion?new Cesium.Quaternion:null,e}(),vF=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),CF=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},_F=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},bF=function(e){function t(){var t=e.call(this)||this;return t.isexecuted=!1,t.cameraPath=void 0,t.heightConfig=2e5,t.scratch=new Cesium.Matrix4,t.hideValues=["fillBehavior"],t.startAngle=-180,t.endAngle=180,t}return vF(t,e),Object.defineProperty(t.prototype,"target",{get:function(){return ey.getGraph(this.targetId)},enumerable:!1,configurable:!0}),t.prototype.stopAnimation=function(){this.isexecuted=!1},t.prototype.initAnimation=function(){this.isexecuted=!1},t.prototype.initTargetPosition=function(){if(this.target instanceof UP)if(this.target instanceof sI||this.target instanceof cE){var e=this.target.ctrlPosition[0];this.targetPosition=Cesium.Cartesian3.fromDegrees(e.lon,e.lat,e.alt,this.viewer.scene.globe.ellipsoid)}else this.targetPosition=this.target.positionProperty;else this.target instanceof LS||this.target instanceof JS?this.targetPosition=this.target.ent.position.getValue():this.targetPosition=this.target.ent.position._value;this.targetPosition&&(this.targetLLA=this.car3ToLonlat(this.targetPosition))},t.prototype.createPathLine=function(){var e=this;if(this.initTargetPosition(),this.targetPosition){if(this.cameraPath&&this.removePathLine(),this.viewer.terrainProvider.availability){var t=this.viewer.terrainProvider.availability._maximumLevel?this.viewer.terrainProvider.availability._maximumLevel:10,i=[Cesium.Cartographic.fromDegrees(this.targetLLA.lon,this.targetLLA.lat)],r=Cesium.sampleTerrain(this.viewer.terrainProvider,t,i),n=this;r.then((function(e){if(e[0].height){var t=Math.ceil(e[0].height);n.__meta__.lineHeight.min=t,n.__meta__.lineHeight.max=t+n.heightConfig}}))}else this.__meta__.lineHeight.min=0,this.__meta__.lineHeight.max=this.heightConfig;this.lineHeight||0===this.lineHeight||(this.lineHeight=this.__meta__.lineHeight.min+8e3),this.cameraPath=this.viewer.entities.add({name:"环绕路径线",polyline:{positions:new Cesium.CallbackProperty((function(t,i){var r=xt.xmu([e.targetLLA.lon,e.targetLLA.lat]),n=[],o=e.startAngle,s=e.endAngle;e.startAngle>e.endAngle&&(o=e.endAngle,s=e.startAngle);for(var a=o;a<s;a++){var l=xt.Pmk(r,e.circleRadius/1e3,a).geometry.coordinates,h=Cesium.Cartesian3.fromDegrees(l[0],l[1],e.lineHeight);n.push(h)}return n}),!1),width:1,material:Cesium.Color.RED}})}},t.prototype.removePathLine=function(){this.cameraPath&&this.viewer.entities.contains(this.cameraPath)&&this.viewer.entities.remove(this.cameraPath)},t.prototype.onTick=function(e){var t=e;if(t>=this.beginTime+this.duration)this.stopAnimation();else if(t>=this.beginTime){if(t-=this.beginTime,this.initTargetPosition(),!this.targetLLA)return;var i=xt.xmu([this.targetLLA.lon,this.targetLLA.lat]),r=(this.endAngle-this.startAngle)*(t/this.duration)+this.startAngle,n=xt.Pmk(i,this.circleRadius/1e3,r).geometry.coordinates,o=Cesium.Cartesian3.fromDegrees(n[0],n[1],this.lineHeight);if(o&&this.targetPosition){var s=this.computerOrient(o,this.targetPosition);this.viewer.scene.camera.setView({destination:o,orientation:{heading:Cesium.Math.toRadians(s.heading+90),pitch:Cesium.Math.toRadians(s.pitch),role:Cesium.Math.toRadians(s.roll)}})}}},Object.defineProperty(t.prototype,"startAngle",{get:function(){return this._startAngle},set:function(e){this._startAngle=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"endAngle",{get:function(){return this._endAngle},set:function(e){this._endAngle=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cameraHeight",{get:function(){return this.lineHeight},set:function(e){this.lineHeight=e,this.setCamera()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cameraRadius",{get:function(){return this.circleRadius},set:function(e){this.circleRadius=e,this.setCamera()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cameraHeading",{get:function(){return this._cameraHeading},set:function(e){this._cameraHeading=e,this.setCamera()},enumerable:!1,configurable:!0}),t.prototype.setCamera=function(){if(this.target&&this.target.ent){yF.getModelMatrix(this.target.ent,this.viewer.clock.currentTime,this.scratch);var e=Cesium.Math.toRadians(this.cameraHeading),t=180*Math.asin(this.lineHeight/Math.sqrt(Math.pow(this.lineHeight,2)+Math.pow(this.circleRadius,2)))/Math.PI+10,i=Cesium.Math.toRadians(-1*t),r=Math.sqrt(Math.pow(this.lineHeight,2)+Math.pow(this.circleRadius,2));this.viewer.camera.lookAtTransform(this.scratch,new Cesium.HeadingPitchRange(e,i,r))}},t.prototype.car3ToLonlat=function(e){var t=this.viewer.scene.globe.ellipsoid.cartesianToCartographic(e),i=Cesium.Math.toDegrees(t.latitude);return{lon:Cesium.Math.toDegrees(t.longitude),lat:i,alt:t.height}},t.prototype.vec1ToVec2Mat=function(e,t){var i=Cesium.Cartesian3.cross(e,t,new Cesium.Cartesian3(0,0,0)),r=Cesium.Math.acosClamped(Cesium.Cartesian3.dot(e,t)/(Cesium.Cartesian3.magnitude(e)*Cesium.Cartesian3.magnitude(t))),n=Cesium.Quaternion.fromAxisAngle(i,r,new Cesium.Quaternion(0,0,0,0));return Cesium.Matrix3.fromQuaternion(n,new Cesium.Matrix3)},t.prototype.computerOrient=function(e,t){var i,r,n=Cesium.Transforms.eastNorthUpToFixedFrame(e),o=Cesium.Quaternion.clone(Cesium.Quaternion.IDENTITY),s=Cesium.Matrix3.clone(Cesium.Matrix3.IDENTITY),a=Cesium.Matrix3.clone(Cesium.Matrix3.IDENTITY),l=new Cesium.Cartesian3(0,0,0);return s=Cesium.Matrix4.getMatrix3(n,s),l=Cesium.Cartesian3.subtract(t,e,l),a=Cesium.Matrix3.inverse(s,a),l=Cesium.Matrix3.multiplyByVector(a,l,l),i=this.vec1ToVec2Mat(Cesium.Cartesian3.UNIT_X,Cesium.Cartesian3.normalize(l,l)),o=Cesium.Quaternion.fromRotationMatrix(i,o),r=Cesium.HeadingPitchRoll.fromQuaternion(o,r),{heading:Cesium.Math.toDegrees(r.heading),pitch:Cesium.Math.toDegrees(r.pitch),roll:Cesium.Math.toDegrees(r.roll)}},CF([(0,fy.o)(),_F("design:type",Object)],t.prototype,"scratch",void 0),CF([dy({name:"标绘元素",group:"",type:"displayTarget",order:9}),(0,fy.o)(),_F("design:type",rv),_F("design:paramtypes",[])],t.prototype,"target",null),CF([(0,fy.o)(),_F("design:type",Object)],t.prototype,"isexecuted",void 0),CF([(0,fy.o)(),_F("design:type",Object)],t.prototype,"cameraPath",void 0),CF([(0,fy.o)(),_F("design:type",Object)],t.prototype,"heightConfig",void 0),CF([dy({name:"视角高度",group:"",subGroup:"视角高度",subOrder:1,type:"cameraSlider",order:17,min:0,max:2e5,hiddenGroupName:!0}),_F("design:type",Number)],t.prototype,"lineHeight",void 0),CF([dy({name:"环绕半径",group:"",subGroup:"环绕半径",subOrder:2,type:"cameraSlider",order:18,min:1,max:3e4,hiddenGroupName:!0}),_F("design:type",Number)],t.prototype,"circleRadius",void 0),CF([dy({name:"开始角度",group:"",subGroup:"开始角度",subOrder:3,type:"cameraSlider2",order:0,max:180,min:-180,hiddenGroupName:!0}),_F("design:type",Number),_F("design:paramtypes",[Number])],t.prototype,"startAngle",null),CF([dy({name:"结束角度",group:"",subGroup:"结束角度",subOrder:4,type:"cameraSlider2",order:0,max:180,min:-180,hiddenGroupName:!0}),_F("design:type",Number),_F("design:paramtypes",[Number])],t.prototype,"endAngle",null),t=CF([yx("SurroundAnimation"),_F("design:paramtypes",[])],t)}(Px),wF=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),PF=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},SF=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},xF=function(e){function t(){var t=e.call(this)||this;return t.isexecuted=!1,t.cameraPath=void 0,t.hideValues=["fillBehavior"],t}return wF(t,e),Object.defineProperty(t.prototype,"target",{get:function(){return ey.getGraph(this.targetId)},enumerable:!1,configurable:!0}),t.prototype.stopAnimation=function(){this.isexecuted=!1},t.prototype.initAnimation=function(){this.isexecuted=!1},t.prototype.initTargetPosition=function(){if(this.target instanceof UP)if(this.target instanceof sI||this.target instanceof cE){var e=this.target.ctrlPosition[0];this.targetPosition=Cesium.Cartesian3.fromDegrees(e.lon,e.lat,e.alt,this.viewer.scene.globe.ellipsoid)}else this.targetPosition=this.target.positionProperty;else this.target instanceof LS||this.target instanceof JS?this.targetPosition=this.target.ent.position.getValue():this.targetPosition=this.target.ent.position._value;this.targetPosition&&(this.targetLLA=this.car3ToLonlat(this.targetPosition))},t.prototype.createPathLine=function(){var e=this;if(this.initTargetPosition(),this.targetPosition){if(this.cameraPath&&this.removePathLine(),this.viewer.terrainProvider.availability){var t=this.viewer.terrainProvider.availability._maximumLevel?this.viewer.terrainProvider.availability._maximumLevel:10,i=[Cesium.Cartographic.fromDegrees(this.targetLLA.lon,this.targetLLA.lat)],r=Cesium.sampleTerrain(this.viewer.terrainProvider,t,i),n=this;r.then((function(e){if(e[0].height){var t=Math.ceil(e[0].height);n.__meta__.startHeight.min=t,n.__meta__.startHeight.max=t+5e3,n.__meta__.endHeight.min=t,n.__meta__.endHeight.max=t+5e3}}))}else this.__meta__.startHeight.min=0,this.__meta__.startHeight.max=5e3,this.__meta__.endHeight.min=0,this.__meta__.endHeight.max=5e3;this.startHeight||0===this.startHeight||(this.startHeight=this.__meta__.startHeight.min+2500),this.endHeight||0===this.endHeight||(this.endHeight=this.__meta__.endHeight.min+500),this.cameraPath=this.viewer.entities.add({name:"螺旋路径线",polyline:{positions:new Cesium.CallbackProperty((function(t,i){for(var r=xt.xmu([e.targetLLA.lon,e.targetLLA.lat]),n=[],o=1;o<360;o++){var s=o-180,a=e.startRadius-o/360*(e.startRadius-e.endRadius),l=xt.Pmk(r,a/1e3,s).geometry.coordinates,h=e.heightOfPoint(o),c=Cesium.Cartesian3.fromDegrees(l[0],l[1],h);n.push(c)}return n}),!1),width:1,material:Cesium.Color.RED}})}},t.prototype.heightOfPoint=function(e){var t=0,i=this.startHeight-this.endHeight,r=i/2,n=i/4,o=i/8;return t=e<=90?r/90*e:e<=180?r+n/90*(e-90):e<=270?r+n+o/90*(e-180):r+n+o+o/90*(e-270),this.startHeight-t},t.prototype.removePathLine=function(){this.cameraPath&&this.viewer.entities.contains(this.cameraPath)&&this.viewer.entities.remove(this.cameraPath)},t.prototype.onTick=function(e){var t=e;if(t>=this.beginTime+this.duration)this.stopAnimation();else if(t>=this.beginTime){if(t-=this.beginTime,this.initTargetPosition(),!this.targetLLA)return;var i=xt.xmu([this.targetLLA.lon,this.targetLLA.lat]),r=t/this.duration*360-180,n=this.startRadius-t/this.duration*(this.startRadius-this.endRadius),o=xt.Pmk(i,n/1e3,r).geometry.coordinates,s=this.heightOfPoint(t/this.duration*360),a=Cesium.Cartesian3.fromDegrees(o[0],o[1],s);if(a&&this.targetPosition){var l=this.computerOrient(a,this.targetPosition);this.viewer.scene.camera.setView({destination:a,orientation:{heading:Cesium.Math.toRadians(l.heading+90),pitch:Cesium.Math.toRadians(l.pitch),role:Cesium.Math.toRadians(l.roll)}})}}},t.prototype.car3ToLonlat=function(e){var t=this.viewer.scene.globe.ellipsoid.cartesianToCartographic(e),i=Cesium.Math.toDegrees(t.latitude);return{lon:Cesium.Math.toDegrees(t.longitude),lat:i,alt:t.height}},t.prototype.vec1ToVec2Mat=function(e,t){var i=Cesium.Cartesian3.cross(e,t,new Cesium.Cartesian3(0,0,0)),r=Cesium.Math.acosClamped(Cesium.Cartesian3.dot(e,t)/(Cesium.Cartesian3.magnitude(e)*Cesium.Cartesian3.magnitude(t))),n=Cesium.Quaternion.fromAxisAngle(i,r,new Cesium.Quaternion(0,0,0,0));return Cesium.Matrix3.fromQuaternion(n,new Cesium.Matrix3)},t.prototype.computerOrient=function(e,t){var i,r,n=Cesium.Transforms.eastNorthUpToFixedFrame(e),o=Cesium.Quaternion.clone(Cesium.Quaternion.IDENTITY),s=(Cesium.Matrix3.clone(Cesium.Matrix3.IDENTITY),Cesium.Matrix3.clone(Cesium.Matrix3.IDENTITY)),a=Cesium.Matrix3.clone(Cesium.Matrix3.IDENTITY),l=new Cesium.Cartesian3(0,0,0);return s=Cesium.Matrix4.getMatrix3(n,s),l=Cesium.Cartesian3.subtract(t,e,l),a=Cesium.Matrix3.inverse(s,a),l=Cesium.Matrix3.multiplyByVector(a,l,l),i=this.vec1ToVec2Mat(Cesium.Cartesian3.UNIT_X,Cesium.Cartesian3.normalize(l,l)),o=Cesium.Quaternion.fromRotationMatrix(i,o),r=Cesium.HeadingPitchRoll.fromQuaternion(o,r),{heading:Cesium.Math.toDegrees(r.heading),pitch:Cesium.Math.toDegrees(r.pitch),roll:Cesium.Math.toDegrees(r.roll)}},PF([dy({name:"标绘元素",group:"",type:"displayTarget",order:9}),(0,fy.o)(),SF("design:type",rv),SF("design:paramtypes",[])],t.prototype,"target",null),PF([(0,fy.o)(),SF("design:type",Object)],t.prototype,"isexecuted",void 0),PF([(0,fy.o)(),SF("design:type",Object)],t.prototype,"cameraPath",void 0),PF([dy({name:"开始高度",group:"",subGroup:"开始高度",subOrder:1,type:"cameraSlider",order:17,min:0,max:5e3,hiddenGroupName:!0}),SF("design:type",Number)],t.prototype,"startHeight",void 0),PF([dy({name:"结束高度",group:"",subGroup:"结束高度",subOrder:2,type:"cameraSlider",order:18,min:0,max:5e3,hiddenGroupName:!0}),SF("design:type",Number)],t.prototype,"endHeight",void 0),PF([dy({name:"开始半径",group:"",subGroup:"开始半径",subOrder:3,type:"cameraSlider",order:19,max:2e3,min:0,hiddenGroupName:!0}),SF("design:type",Number)],t.prototype,"startRadius",void 0),PF([dy({name:"结束半径",group:"",subGroup:"结束半径",subOrder:4,type:"cameraSlider",order:20,max:2e3,min:0,hiddenGroupName:!0}),SF("design:type",Number)],t.prototype,"endRadius",void 0),t=PF([yx("SpiralAnimation"),SF("design:paramtypes",[])],t)}(Px),BF=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),MF=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},EF=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},TF=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return BF(t,e),Object.defineProperty(t.prototype,"target",{get:function(){return ey.getGraph(this.targetId)},enumerable:!1,configurable:!0}),t.prototype.stopAnimation=function(){this.target.ent.model.runAnimations=!1},t.prototype.initAnimation=function(){},t.prototype.onTick=function(e){var t=e;t>=this.beginTime+this.duration?this.stopAnimation():t>=this.beginTime&&(this.target.ent.model.runAnimations=!0)},MF([(0,fy.o)(),EF("design:type",JS),EF("design:paramtypes",[])],t.prototype,"target",null),t=MF([yx("GxModelAnimation")],t)}(Px);!function(e){e.All="0",e.Pass="1",e.Furture="2",e.No="3"}(DH||(DH={}));var OF,LF=i(5720),DF=i(5108),IF=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),RF=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},HF=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},FF=function(e){function t(){var t=e.call(this)||this;return t.headingFix=0,t.pathMode=DH.No,t.cameraType="none",t.defaultMap=new Map,t.keyPositionMap=new Map,t.scratch=new Cesium.Matrix4,t.cameraHeight=0,t}return IF(t,e),Object.defineProperty(t.prototype,"target",{get:function(){return ey.getGraph(this.targetId)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"targetId",{get:function(){return this._targetId},set:function(e){var t=this;this._targetId=e,this.targetSub=this.target.positionChanged.subscribe((function(e){t.polyLine.setCtrlPosition(0,t.target.ctrlPosition[0]),t.polyLine.setPrimitivePosition(t.polyLine._singleControlPosition)}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"polyLine",{get:function(){return ey.getGraph(this.polyLineId)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cameraHeight",{get:function(){return this._cameraHeight},set:function(e){this._cameraHeight=e,"custom"===this.cameraType&&this.setCamera()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cameraHeading",{get:function(){return this._cameraHeading},set:function(e){this._cameraHeading=e,this.setCamera()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cameraPitch",{get:function(){return this._cameraPitch},set:function(e){this._cameraPitch=e,this.setCamera()},enumerable:!1,configurable:!0}),t.prototype.onReload=function(){this.targetId=this.targetId},t.prototype.initAnimation=function(){if(DF.log("initAnimation"),this.keyPositionMap=new Map,this.headingFix=Number.parseFloat(this.headingFix.toString()),this.defaultMap=new Map,this.target instanceof UP?this.defaultValue=this.target.positionProperty:this.target.ent&&(this.defaultValue=this.target.ent.position),this.target instanceof JS?(this.defaultMap.set("heading",this.target.heading),this.defaultMap.set("pitch",this.target.pitch),this.defaultMap.set("roll",this.target.roll)):(this.target instanceof yB||this.target instanceof nx)&&this.defaultMap.set("rotation",this.target.rotation),this.polyLine&&(this.defaultPercent=this.polyLine.percent),!this.target.animationInitPropArray.includes("PathAnimation")){this.target.animationInitPropArray.push("PathAnimation");var e=this.polyLine.interopLine.evaluate(0);this.target instanceof UP?this.target.positionProperty=e:this.target.ent.position=e}},t.prototype.onTick=function(e){var t=0,i=0;if(!this.__meta__.cameraType.hidden)switch(this.cameraType){case"none":void 0!==this.viewer.trackedEntity&&(this.viewer.trackedEntity=void 0);break;case"follow":this.viewer.trackedEntity!==this.target.ent&&(this.viewer.trackedEntity=this.target.ent);break;case"first":this.viewer.trackedEntity!==this.target.ent&&(this.viewer.trackedEntity=this.target.ent),yF.getModelMatrix(this.viewer.trackedEntity,this.viewer.clock.currentTime,this.scratch),t=200,i=50,this.viewer.scene.camera.lookAtTransform(this.scratch,new Cesium.Cartesian3(-t,0,i));break;case"god":this.viewer.trackedEntity!==this.target.ent&&(this.viewer.trackedEntity=this.target.ent),yF.getModelMatrix(this.viewer.trackedEntity,this.viewer.clock.currentTime,this.scratch),i=5e3+this.cameraHeight,this.viewer.scene.camera.lookAtTransform(this.scratch,new Cesium.Cartesian3(-1,0,i));break;case"custom":this.viewer.trackedEntity!==this.target.ent&&(this.viewer.trackedEntity=this.target.ent),this.setCamera()}var r=e;if(r>=this.beginTime+this.duration){var n=vx.HoldEnd;this.fillBehavior===n||this.stopAnimation()}else if(r>this.beginTime){(r-=this.beginTime)<.01&&(r=.01);var o=this.polyLine.interopLine,s=void 0;this.polyLine.clampToGround;var a=o.evaluate(r/this.duration);if(s=this.target.ent.position instanceof Cesium.Cartesian3?this.target.ent.position:this.target.ent.position.getValue(),this.polyLine.clampToGround){var l=Cesium.Cartographic.fromCartesian(a),h=this.viewer.scene.globe.getHeight(l);l.height=h,a=this.viewer.scene.globe.ellipsoid.cartographicToCartesian(l);var c=Cesium.Cartographic.fromCartesian(s),u=this.viewer.scene.globe.getHeight(c);c.height=u,s=this.viewer.scene.globe.ellipsoid.cartographicToCartesian(c)}var p=this.computerOrient(s,a);if(Object.is(p.heading,NaN)||Object.is(p.pitch,NaN)||Object.is(p.roll,NaN))return;if(this.target instanceof JS||this.target instanceof nx)try{this.target instanceof JS?(this.target.ent.position=a,this.target.heading=p.heading+this.headingFix,this.target.pitch=p.pitch,this.target.resetOrientation()):(this.target.rotation=p.heading+this.headingFix,this.target.positionProperty=a)}catch(e){DF.log(e)}else if(this.target instanceof UP){var d=o.evaluate(r/this.duration);this.target.positionProperty=d}else{var m=o.evaluate(r/this.duration);this.target.ent.position=m}switch(this.pathMode){case DH.All:break;case DH.Pass:this.polyLine.percent=r/this.duration;break;case DH.Furture:this.polyLine.percent=-r/this.duration;break;case DH.No:this.polyLine.percent=0}this.target.tmpHeading=p.heading}},t.prototype.stopAnimation=function(){var e=this;this.target instanceof UP?this.target.positionProperty=this.defaultValue:this.target.ent&&(this.target.ent.position=this.defaultValue),this.defaultMap.forEach((function(t,i){e.target[i]=t})),this.polyLine&&(this.polyLine.percent=this.defaultPercent,this.polyLine.terraininteropLine=void 0),this.viewer.trackedEntity=void 0,this.target.animationInitPropArray=[]},t.prototype.setCamera=function(){if(this.target&&this.target.ent){yF.getModelMatrix(this.target.ent,this.viewer.clock.currentTime,this.scratch);var e=Cesium.Math.toRadians(this.cameraHeading),t=this.cameraPitch;-90===this.cameraPitch&&(t=-89.9);var i=Cesium.Math.toRadians(t),r=this.cameraHeight;this.viewer.camera.lookAtTransform(this.scratch,new Cesium.HeadingPitchRange(e,i,r))}},t.prototype.computerOrient=function(e,t){var i,r,n=Cesium.Transforms.eastNorthUpToFixedFrame(e),o=Cesium.Quaternion.clone(Cesium.Quaternion.IDENTITY),s=(Cesium.Matrix3.clone(Cesium.Matrix3.IDENTITY),Cesium.Matrix3.clone(Cesium.Matrix3.IDENTITY)),a=Cesium.Matrix3.clone(Cesium.Matrix3.IDENTITY),l=new Cesium.Cartesian3(0,0,0);return s=Cesium.Matrix4.getMatrix3(n,s),l=Cesium.Cartesian3.subtract(t,e,l),a=Cesium.Matrix3.inverse(s,a),l=Cesium.Matrix3.multiplyByVector(a,l,l),i=this.vec1ToVec2Mat(Cesium.Cartesian3.UNIT_X,Cesium.Cartesian3.normalize(l,l)),o=Cesium.Quaternion.fromRotationMatrix(i,o),r=Cesium.HeadingPitchRoll.fromQuaternion(o,r),{heading:Cesium.Math.toDegrees(r.heading),pitch:Cesium.Math.toDegrees(r.pitch),roll:Cesium.Math.toDegrees(r.roll)}},t.prototype.vec1ToVec2Mat=function(e,t){var i=Cesium.Cartesian3.cross(e,t,new Cesium.Cartesian3(0,0,0)),r=Cesium.Math.acosClamped(Cesium.Cartesian3.dot(e,t)/(Cesium.Cartesian3.magnitude(e)*Cesium.Cartesian3.magnitude(t))),n=Cesium.Quaternion.fromAxisAngle(i,r,new Cesium.Quaternion(0,0,0,0));return Cesium.Matrix3.fromQuaternion(n,new Cesium.Matrix3)},t.prototype.destroy=function(){this.targetSub.unsubscribe()},RF([dy({name:"标绘元素",group:"",type:"displayTarget",order:9}),(0,fy.o)(),HF("design:type",rv),HF("design:paramtypes",[])],t.prototype,"target",null),RF([(0,fy.o)(),HF("design:type",LF.w0)],t.prototype,"targetSub",void 0),RF([dy({name:"路径线",group:"",type:"displayTarget",order:9}),(0,fy.o)(),HF("design:type",lM),HF("design:paramtypes",[])],t.prototype,"polyLine",null),RF([dy({name:"航向修正",group:"",type:"numberNew",order:3,min:-360,max:360}),HF("design:type",Number)],t.prototype,"headingFix",void 0),RF([dy({name:"显示路径",type:"pOption",group:"",order:8,options:[{text:"显示",value:DH.All},{text:"显示经过的",value:DH.Pass},{text:"显示将要经过",value:DH.Furture},{text:"不显示",value:DH.No}]}),HF("design:type",String)],t.prototype,"pathMode",void 0),RF([dy({name:"视角",type:"pOption",group:"",order:9,options:[{text:"无",value:"none"},{text:"跟随视角",value:"follow"},{text:"第一视角",value:"first"},{text:"上帝视角",value:"god"},{text:"自定义",value:"custom"}]}),HF("design:type",Object)],t.prototype,"cameraType",void 0),RF([dy({name:"距离",group:"相机",subGroup:"",subOrder:1,type:"pathCameraSlider",order:17,min:0,max:1e6,hiddenGroupName:!0}),HF("design:type",Number),HF("design:paramtypes",[Number])],t.prototype,"cameraHeight",null),RF([dy({name:"方向",group:"相机",subGroup:"",subOrder:2,type:"pathCameraParam",order:18,min:-1e6,max:1e6,hiddenGroupName:!0}),HF("design:type",Number),HF("design:paramtypes",[Number])],t.prototype,"cameraHeading",null),RF([dy({name:"俯仰",group:"相机",subGroup:"",subOrder:3,type:"pathCameraParam",order:19,min:-1e6,max:1e6,hiddenGroupName:!0}),HF("design:type",Number),HF("design:paramtypes",[Number])],t.prototype,"cameraPitch",null),RF([(0,fy.o)(),HF("design:type",Object)],t.prototype,"scratch",void 0),RF([(0,fy.o)(),HF("design:type",Object)],t.prototype,"defaultValue",void 0),RF([(0,fy.o)(),HF("design:type",Object)],t.prototype,"defaultOrientation",void 0),RF([(0,fy.o)(),HF("design:type",Object)],t.prototype,"defaultMap",void 0),RF([(0,fy.o)(),HF("design:type",Map)],t.prototype,"keyPositionMap",void 0),RF([(0,fy.o)(),HF("design:type",Object)],t.prototype,"defaultPercent",void 0),t=RF([yx("PathAnimation"),HF("design:paramtypes",[])],t)}(Px),NF=i(5108),QF=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),kF=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},UF=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},jF=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.defaultMap=new Map,t}return QF(t,e),Object.defineProperty(t.prototype,"target",{get:function(){return ey.getGraph(this.targetId)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fllowTarget",{get:function(){return ey.getGraph(this.followTargetId)},enumerable:!1,configurable:!0}),t.prototype.stopAnimation=function(){var e=this;this.target instanceof UP?this.target.positionProperty=this.defaultValue:this.target.ent&&(this.target.ent.position=this.defaultValue),this.defaultMap.forEach((function(t,i){e.target[i]=t}))},t.prototype.initAnimation=function(){var e,t,i,r,n,o;this.defaultMap=new Map,this.target instanceof UP?this.defaultValue=this.target.positionProperty:this.target.ent&&(this.defaultValue=this.target.ent.position,this.target instanceof JS?(this.defaultMap.set("heading",this.target.heading),this.defaultMap.set("pitch",this.target.pitch),this.defaultMap.set("roll",this.target.roll)):(this.target instanceof yB||this.target instanceof nx)&&this.defaultMap.set("rotation",this.target.rotation)),this.fllowTarget.tmpHeading=0,this.preheading=this.getFollowHeading();var s=(null===(e=this.target)||void 0===e?void 0:e.ctrlPosition[0].lon)-(null===(t=this.fllowTarget)||void 0===t?void 0:t.ctrlPosition[0].lon),a=(null===(i=this.target)||void 0===i?void 0:i.ctrlPosition[0].lat)-(null===(r=this.fllowTarget)||void 0===r?void 0:r.ctrlPosition[0].lat),l=(null===(n=this.target)||void 0===n?void 0:n.ctrlPosition[0].alt)-(null===(o=this.fllowTarget)||void 0===o?void 0:o.ctrlPosition[0].alt);this.positionsub=[s,a,l]},t.prototype.getFollowHeading=function(){return this.fllowTarget instanceof JS?this.fllowTarget.heading:this.fllowTarget instanceof nx||this.fllowTarget instanceof yB?this.fllowTarget.rotation:this.fllowTarget.tmpHeading},t.prototype.onTick=function(e){var t,i,r=e;if(r>=this.beginTime+this.duration){var n=vx.HoldEnd;this.fillBehavior===n||this.stopAnimation()}else if(r>this.beginTime){r-=this.beginTime;var o=void 0;if(this.fllowTarget instanceof UP){var s=null===(t=this.fllowTarget)||void 0===t?void 0:t.ctrlPosition[0];o=[s.lon,s.lat,s.alt]}else{var a=null===(i=this.fllowTarget)||void 0===i?void 0:i.ent.position._value;o=zy.cartesian2lonlat(a)}var l=[o[0]+this.positionsub[0],o[1]+this.positionsub[1],o[2]+this.positionsub[2]],h=Cesium.Cartesian3.fromDegrees(l[0],l[1],l[2]);if(this.lastpos){var c=zy.lonlat2Cartesian(o,o[2]),u=this.getFollowHeading()-this.preheading,p=this.RotateMatrix(c,u),d=Cesium.Matrix3.multiplyByVector(p,h,new Cesium.Cartesian3),m=this.computerOrient(this.lastpos,h);if(!m)return;if(this.target instanceof JS||this.target instanceof nx)try{this.lastpos&&(this.target instanceof JS?(this.target.ent.position=d,this.target.heading=m.heading,this.target.pitch=m.pitch,this.target.resetOrientation()):this.target.positionProperty=h)}catch(e){NF.log(e)}else this.target instanceof UP?this.target.positionProperty=d:this.target.ent.position=d;this.target.tmpHeading=m.heading}this.lastpos=h}},t.prototype.computerOrient=function(e,t){if(Cesium.Cartesian3.equals(e,t))return null;var i,r,n=Cesium.Transforms.eastNorthUpToFixedFrame(e),o=Cesium.Quaternion.clone(Cesium.Quaternion.IDENTITY),s=(Cesium.Matrix3.clone(Cesium.Matrix3.IDENTITY),Cesium.Matrix3.clone(Cesium.Matrix3.IDENTITY)),a=Cesium.Matrix3.clone(Cesium.Matrix3.IDENTITY),l=new Cesium.Cartesian3(0,0,0);return s=Cesium.Matrix4.getMatrix3(n,s),l=Cesium.Cartesian3.subtract(t,e,l),a=Cesium.Matrix3.inverse(s,a),l=Cesium.Matrix3.multiplyByVector(a,l,l),i=this.vec1ToVec2Mat(Cesium.Cartesian3.UNIT_X,Cesium.Cartesian3.normalize(l,l)),o=Cesium.Quaternion.fromRotationMatrix(i,o),r=Cesium.HeadingPitchRoll.fromQuaternion(o,r),{heading:Cesium.Math.toDegrees(r.heading),pitch:Cesium.Math.toDegrees(r.pitch),roll:Cesium.Math.toDegrees(r.roll)}},t.prototype.RotateMatrix=function(e,t){var i=Cesium.Math.toRadians(t),r=Math.sin(i),n=Math.cos(i),o=Math.sqrt(e.x*e.x+e.y*e.y+e.z*e.z),s=e.x/o,a=e.y/o,l=e.z/o,h=[n+(1-n)*s*s,-r*l+(1-n)*s*a,r*a+(1-n)*s*l,r*l+(1-n)*s*a,n+(1-n)*a*a,-r*s+(1-n)*a*l,-r*a+(1-n)*s*l,r*s+(1-n)*a*l,n+(1-n)*l*l];return Cesium.Matrix3.fromArray(h)},t.prototype.vec1ToVec2Mat=function(e,t){var i=Cesium.Cartesian3.cross(e,t,new Cesium.Cartesian3(0,0,0)),r=Cesium.Math.acosClamped(Cesium.Cartesian3.dot(e,t)/(Cesium.Cartesian3.magnitude(e)*Cesium.Cartesian3.magnitude(t))),n=Cesium.Quaternion.fromAxisAngle(i,r,new Cesium.Quaternion(0,0,0,0));return Cesium.Matrix3.fromQuaternion(n,new Cesium.Matrix3)},kF([(0,fy.o)(),UF("design:type",Object)],t.prototype,"positionsub",void 0),kF([(0,fy.o)(),UF("design:type",Object)],t.prototype,"lastpos",void 0),kF([(0,fy.o)(),UF("design:type",Object)],t.prototype,"preheading",void 0),kF([(0,fy.o)(),UF("design:type",Object)],t.prototype,"defaultMap",void 0),kF([(0,fy.o)(),UF("design:type",Object)],t.prototype,"defaultValue",void 0),kF([dy({name:"标绘元素",group:"",type:"displayTarget",order:9}),(0,fy.o)(),UF("design:type",rv),UF("design:paramtypes",[])],t.prototype,"target",null),kF([dy({name:"跟随元素",group:"",type:"displayTarget",order:9}),(0,fy.o)(),UF("design:type",rv),UF("design:paramtypes",[])],t.prototype,"fllowTarget",null),t=kF([yx("TargetFllowAnimation")],t)}(Px);!function(e){e.LefttoRight="0",e.ToptoBottom="1"}(OF||(OF={}));var GF,zF,YF=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),ZF=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},WF=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},XF=function(e){function t(){var t=e.call(this)||this;return t.maskBehavior=OF.LefttoRight,t}return YF(t,e),Object.defineProperty(t.prototype,"target",{get:function(){return ey.getGraph(this.targetId)},enumerable:!1,configurable:!0}),t.prototype.initAnimation=function(){},t.prototype.onTick=function(e){var t=e;switch(this.maskBehavior){case OF.LefttoRight:this.target.showRange=[0,0,t/this.duration*1,1];break;case OF.ToptoBottom:this.target.showRange=[0,(this.duration-t)/this.duration*1,1,1]}},t.prototype.stopAnimation=function(){this.target.showRange=[0,0,1,1]},ZF([dy({name:"蒙版方向",type:"pOption",group:"",order:4,options:[{text:"从左至右",value:OF.LefttoRight},{text:"从上至下",value:OF.ToptoBottom}]}),WF("design:type",String)],t.prototype,"maskBehavior",void 0),ZF([(0,fy.o)(),WF("design:type",mS),WF("design:paramtypes",[])],t.prototype,"target",null),t=ZF([yx("PolygonMaskAnimation"),WF("design:paramtypes",[])],t)}(Px),JF=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),KF=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},VF=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},qF=function(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var r,n,o=i.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){n={error:e}}finally{try{r&&!r.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}return s},$F=function(e,t,i){if(i||2===arguments.length)for(var r,n=0,o=t.length;n<o;n++)!r&&n in t||(r||(r=Array.prototype.slice.call(t,0,n)),r[n]=t[n]);return e.concat(r||Array.prototype.slice.call(t))},eN=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return JF(t,e),t.prototype.stopAnimation=function(){var e;null===(e=this.target)||void 0===e||e.setPrimitivePosition(this.ogigonalPositions)},t.prototype.initAnimation=function(){var e,t=[0],i=[];this.ogigonalPositions=$F([],qF(this.target._singleControlPosition),!1);var r=this.target.minPointNum,n=null===(e=this.target)||void 0===e?void 0:e._singleControlPosition;if(3==r){var o=Cesium.Cartesian3.lerp(this.target._singleControlPosition[0],this.target._singleControlPosition[1],.5,new Cesium.Cartesian3);(n=[]).push(o),n.push.apply(n,$F([],qF(this.target._singleControlPosition.slice(r-1)),!1))}if(n){for(var s=0,a=0;a<n.length-1;a++){var l=Cesium.Cartesian3.distance(n[a],n[a+1]);i.push(l),s+=l}for(a=0;a<i.length;a++)t.push(i[a]/s+t[a]);this.interopLine=Cesium.HermiteSpline.createNaturalCubic({times:t,points:n})}},t.prototype.onTick=function(e){var t,i=e;if(i<=this.beginTime+this.duration&&i>=this.beginTime){i-=this.beginTime;var r=this.target.minPointNum,n=i/this.duration,o=[];3==r?o.push(this.ogigonalPositions[0],this.ogigonalPositions[1]):o.push(this.ogigonalPositions[0]);for(var s=this.ogigonalPositions.length-(r-1),a=0;a<s;a++){var l=this.interopLine.evaluate((a+1)/s*n);o.push(l)}null===(t=this.target)||void 0===t||t.setPrimitivePosition(o)}},Object.defineProperty(t.prototype,"target",{get:function(){return ey.getGraph(this.targetId)},enumerable:!1,configurable:!0}),KF([(0,fy.o)(),VF("design:type",Cesium.LinearSpline)],t.prototype,"interopLine",void 0),KF([(0,fy.o)(),VF("design:type",Array)],t.prototype,"ogigonalPositions",void 0),KF([dy({name:"标绘元素",group:"",type:"displayTarget",order:9}),(0,fy.o)(),VF("design:type",vI),VF("design:paramtypes",[])],t.prototype,"target",null),t=KF([yx("ArrowDirectAnimation")],t)}(Px),tN=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),iN=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},rN=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},nN=function(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],r=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},oN=function(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var r,n,o=i.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){n={error:e}}finally{try{r&&!r.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}return s},sN=function(e,t,i){if(i||2===arguments.length)for(var r,n=0,o=t.length;n<o;n++)!r&&n in t||(r||(r=Array.prototype.slice.call(t,0,n)),r[n]=t[n]);return e.concat(r||Array.prototype.slice.call(t))},aN=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.pathMode=DH.Pass,t.keyPositionMap=new Map,t}return tN(t,e),Object.defineProperty(t.prototype,"target",{get:function(){return ey.getGraph(this.targetId)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"polyLine",{get:function(){return ey.getGraph(this.polyLineId)},enumerable:!1,configurable:!0}),t.prototype.onTick=function(e){var t=e;if(t>=this.beginTime+this.duration){var i=vx.HoldEnd;this.fillBehavior==i?this.target instanceof UP?this.target.positionProperty=this.entPosition:this.target.ent.position=this.entPosition:this.stopAnimation()}else if(t>this.beginTime){if(this.target instanceof UP){var r=this.sampledProperty.getValue(this.getCesiumAnimationTime(e));this.target.positionProperty=r}else this.target.ent.position=this.sampledProperty,this.target.ent.orientation=this.orientationProperty;switch(this.pathMode){case DH.All:break;case DH.Pass:this.polyLinePosition.push(this.sampledProperty.getValue(this.getCesiumAnimationTime(e)));break;case DH.Furture:var n=t,o=[];o.push(this.sampledProperty.getValue(this.getCesiumAnimationTime(e))),this.keyPositionMap.forEach((function(e,t){t>=n&&o.push(e)})),this.polyLinePosition=o;case DH.No:}}},t.prototype.initAnimation=function(){var e,t,i=this;this.keyPositionMap=new Map,this.sampledProperty=new Cesium.SampledPositionProperty,this.target instanceof UP?this.defaultValue=this.target.positionProperty:this.target.ent&&(this.defaultValue=this.target.ent.position,this.defaultOrientation=this.target.ent.orientation);for(var r=this.polyLine.calcuteShape(this.polyLine._singleControlPosition,Cesium.JulianDate.now()),n=[0],o=0;o<r.length-1;o++){var s=Cesium.Cartesian3.distance(r[o],r[o+1]);n.push(s)}var a=0;try{for(var l=nN(n),h=l.next();!h.done;h=l.next()){a+=h.value}}catch(t){e={error:t}}finally{try{h&&!h.done&&(t=l.return)&&t.call(l)}finally{if(e)throw e.error}}var c=Cesium.JulianDate.addSeconds(this.animationBaseTime,this.beginTime,new Cesium.JulianDate);for(o=0;o<r.length;o++){var u=n[o]/a*this.duration,p=Cesium.JulianDate.addSeconds(c,u,new Cesium.JulianDate),d=(c=p).secondsOfDay-this.beginTime-this.animationBaseTime.secondsOfDay;this.keyPositionMap.set(d,r[o]),this.sampledProperty.addSample(p,r[o])}switch(this.entPosition=r[r.length-1],this.orientationProperty=new Cesium.VelocityOrientationProperty(this.sampledProperty),this.defaultPolyLinePosition=this.polyLine.ent.polyline.positions,this.polyLinePosition=[],this.pathMode){case DH.All:this.polyLinePosition=r;break;case DH.Pass:break;case DH.Furture:this.polyLinePosition=sN([],oN(r),!1);case DH.No:}this.polyLine.ent.polyline.positions=new Cesium.CallbackProperty((function(){return i.polyLinePosition}),!1)},t.prototype.stopAnimation=function(){this.target instanceof UP?this.target.positionProperty=this.defaultValue:(this.target.ent.position=this.defaultValue,this.target.ent.orientation=this.defaultOrientation),this.polyLine.ent.polyline.positions=this.defaultPolyLinePosition},iN([dy({name:"标绘元素",group:"",type:"displayTarget",order:9}),(0,fy.o)(),rN("design:type",rv),rN("design:paramtypes",[])],t.prototype,"target",null),iN([dy({name:"路径线",group:"",type:"displayTarget",order:9}),(0,fy.o)(),rN("design:type",lM),rN("design:paramtypes",[])],t.prototype,"polyLine",null),iN([(0,fy.o)(),rN("design:type",Cesium.SampledPositionProperty)],t.prototype,"sampledProperty",void 0),iN([(0,fy.o)(),rN("design:type",Object)],t.prototype,"defaultValue",void 0),iN([(0,fy.o)(),rN("design:type",Object)],t.prototype,"defaultOrientation",void 0),iN([(0,fy.o)(),rN("design:type",Cesium.VelocityOrientationProperty)],t.prototype,"orientationProperty",void 0),iN([(0,fy.o)(),rN("design:type",Object)],t.prototype,"defaultPolyLinePosition",void 0),iN([(0,fy.o)(),rN("design:type",Cesium.Cartesian3)],t.prototype,"entPosition",void 0),iN([(0,fy.o)(),rN("design:type",Array)],t.prototype,"polyLinePosition",void 0),iN([(0,fy.o)(),rN("design:type",Map)],t.prototype,"keyPositionMap",void 0),t=iN([yx("PathShowAnimation")],t)}(Px),lN=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),hN=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},cN=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},uN=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return lN(t,e),Object.defineProperty(t.prototype,"viewerContainer",{get:function(){return this.viewer.container},enumerable:!1,configurable:!0}),t.prototype.createSampledProperty=function(){this.sampledProperty=new Cesium.SampledProperty(Number)},t.prototype.stopAnimation=function(){this.viewerContainer.style.opacity="1"},t.prototype.initAnimation=function(){this.createSampledProperty(),this.sampledProperty.addSample(Cesium.JulianDate.addSeconds(this.animationBaseTime,this.beginTime,new Cesium.JulianDate),1),this.sampledProperty.addSample(Cesium.JulianDate.addSeconds(this.animationBaseTime,this.beginTime+this.duration/2,new Cesium.JulianDate),0),this.sampledProperty.addSample(Cesium.JulianDate.addSeconds(this.animationBaseTime,this.beginTime+this.duration,new Cesium.JulianDate),1)},t.prototype.onTick=function(e){var t=e;if(t>=this.beginTime+this.duration)this.stopAnimation();else if(t>=this.beginTime){var i=this.getCurrentValue(e);this.viewerContainer.style.opacity=i.toString()}},t.prototype.getCurrentValue=function(e){var t=e;return t<this.beginTime||t>this.beginTime+this.duration?1:this.sampledProperty.getValue(this.getCesiumAnimationTime(e))},hN([(0,fy.o)(),cN("design:type",Cesium.SampledProperty)],t.prototype,"sampledProperty",void 0),t=hN([yx("PageShowAnimation")],t)}(Px),pN=i(5108),dN=function(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],r=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},mN=function(){function e(e){this.both2DAnd3DSub$=new th.x,this.both2D3DOperateList=[],this.both2D3DActionSub$=new th.x,this.count=0,this.geoGraph={LineString:{name:"",ossUrl:"",resourceId:"",obj:"GeojsonPolyline",color:"#2bfff8",ctls:new Array,holes:new Array,alpha:.7,isVectorData:!1},MultiLineString:{name:"",ossUrl:"",resourceId:"",obj:"GeojsonMultiPolyline",color:"#2bfff8",ctls:new Array,holes:new Array,alpha:.7,isVectorData:!1},Polygon:{name:"",ossUrl:"",resourceId:"",obj:"GeojsonPolygon",color:"#2bfff8",ctls:new Array,holes:new Array,alpha:.7,isVectorData:!1},MultiPolygon:{name:"",ossUrl:"",resourceId:"",obj:"GeojsonMultiPolygon",color:"#2bfff8",ctls:new Array,holes:new Array,alpha:.7,isVectorData:!1}},this.serviceManager=e,this._viewer=e.viewer}return e.prototype.createPlot=function(e,t,i){var r=this;if(void 0===i&&(i=!0),pN.log("create plot begin >>>>>>>>>>>>>>"),e){if(["geojson","kml"].indexOf(e.kind)>-1)return!0;if(["html","richText","picCollection","videoBox","newRichText"].includes(e.kind))return this.serviceManager.htmlDrawService.currentBoxType=e.kind,"newRichText"!==e.kind&&(this.serviceManager.htmlDrawService.isDrawPanelShow=!0),"newRichText"===e.kind&&this.serviceManager.htmlDrawService.initParam(e),void("videoBox"===e.kind&&(this.serviceManager.htmlDrawService.currentBoxPath=e.original_url));var n,o=null;if(n=e.params&&e.params.obj&&"Text"==e.params.obj?e.params.text?this.serviceManager.plotService.createEntityName(e.params.text):void 0:e.label?e.extension?this.serviceManager.plotService.createEntityName(e.label.replace(e.extension,"")):this.serviceManager.plotService.createEntityName(e.label):void 0,n=OP.createEntityName(n,this.serviceManager.plotService.gm.graphList.map((function(e){return e.name}))),"jb"===e.kind||"jbnew"===e.kind)o={obj:"JB",code:e.jbId,offsetX:e.data.offsetX,offsetY:e.data.offsetY,showMode:t?"screen":"object",name:n};else if("model"==e.kind){o={obj:"Model",uri:"".concat(e.path),minimumPixelSize:20,alpha:1,icon:"gp-moxing"},this.plot_icon="gp-moxing",o.uri&&""!==o.uri||(i=!1)}else if(e.extension){switch(e.extension.toLowerCase()){case".tif":case".tiff":return void this.serviceManager.drawbigfileService.draw(e);case".zip":return pN.log("tif,zip>>>",e),void(e.service_info.serviceUrl?this.serviceManager.drawbigfileService.draw(e):pN.warn("资源不可用"));case".glb":(o={obj:"Model",uri:e.original_url,scalev:100,minimumPixelSize:20,alpha:1,icon:"gp-moxing"}).uri&&""!==o.uri||(i=!1),pN.warn("无效的参数，请认真阅读接口指南");break;case".bmp":case".ico":case".svg":case".png":case".jpeg":case".jpg":o={obj:"PinImage",icon:"gp-tuding"},e.path&&-1===e.path.indexOf("http")?o.image="".concat(this.serviceManager.plotService.picPublicPath).concat(e.path):o.image=e.original_url,t||(o.obj="Image",o.icon="gp-tupian1");break;case".gif":o={obj:"HtmlImage",icon:"gp-tuding"},e.path&&-1===e.path.indexOf("http")?o.imageUrl="".concat(this.serviceManager.plotService.picPublicPath).concat(e.path):o.imageUrl=e.path;break;case".ogg":case".mp3":var s=3e3,a=this.serviceManager.musicService.addMusic(e);if(a.audioObj){a.audioObj.load();var l=function(){s=Math.ceil(1e3*Number(a.audioObj.duration));var e={isAudio:!0,type:BP,animation:{type:"AudioAnimation",keyframes:[{val:0},{val:s}]},title:a.name,icon:"gv-Route",image:"视角动画图片/音效.png",webp:"视角动画WEBP文件/螺旋.webp"};r.addAnimation(e),a.audioObj.removeEventListener("canplay",l)};a.audioObj.addEventListener("canplay",l)}return}this.plot_icon=o.icon}else o=EP.deepClone(e.params),this.plot_icon=e.path;var h=n.lastIndexOf(".");return o.name=-1!==h?n.slice(0,n.lastIndexOf(".")):n,e.gvolType&&(o.gvolType=e.gvolType),i?this.createGraph(o):o}},e.prototype.createDraw=function(e){var t;if(e)if(Array.isArray(e))pN.warn("传入的feature，不应该是数组类型。");else{var i={gvolType:e.gvolType,ctls:new Array,holes:new Array},r=function(e,t){var i,r,n,o,s,a,l,h,c,u,p,d;if(t.holes.length=0,t.ctls.length=0,!Array.isArray(e)){if(e.geometry&&e.geometry.coordinates){var m=FO(e.geometry.coordinates);if(1===m){var f=[],g=e.geometry.coordinates;f.push(new A(g[0],g[1],g[2])),t.ctls.push(new A(g[0],g[1],g[2])),t.holes.push(f)}else if(2===m){f=[];try{for(var y=EO(e.geometry.coordinates),v=y.next();!v.done;v=y.next())g=v.value,f.push(new A(g[0],g[1],g[2])),t.ctls.push(new A(g[0],g[1],g[2]))}catch(e){i={error:e}}finally{try{v&&!v.done&&(r=y.return)&&r.call(y)}finally{if(i)throw i.error}}t.holes.push(f)}else if(3===m)try{for(var C=EO(e.geometry.coordinates),_=C.next();!_.done;_=C.next()){g=_.value,f=[];try{for(var b=(s=void 0,EO(g)),w=b.next();!w.done;w=b.next()){var P={lon:(L=w.value)[0],lat:L[1]};f.push(P),t.ctls.push(P)}}catch(e){s={error:e}}finally{try{w&&!w.done&&(a=b.return)&&a.call(b)}finally{if(s)throw s.error}}t.holes.push(f)}}catch(e){n={error:e}}finally{try{_&&!_.done&&(o=C.return)&&o.call(C)}finally{if(n)throw n.error}}else if(4===m)try{for(var S=EO(e.geometry.coordinates),x=S.next();!x.done;x=S.next()){g=x.value;try{for(var B=(c=void 0,EO(g)),M=B.next();!M.done;M=B.next()){var E=M.value;f=[];try{for(var T=(p=void 0,EO(E)),O=T.next();!O.done;O=T.next()){var L;P={lon:(L=O.value)[0],lat:L[1]},f.push(P),t.ctls.push(P)}}catch(e){p={error:e}}finally{try{O&&!O.done&&(d=T.return)&&d.call(T)}finally{if(p)throw p.error}}t.holes.push(f)}}catch(e){c={error:e}}finally{try{M&&!M.done&&(u=B.return)&&u.call(B)}finally{if(c)throw c.error}}}}catch(e){l={error:e}}finally{try{x&&!x.done&&(h=S.return)&&h.call(S)}finally{if(l)throw l.error}}}else e._ctrlPosition?(t.ctls=Array.from(e._ctrlPosition),e.holes&&(t.holes=Array.from(e.holes))):MO.warn("传入的feature，feature.geometry 参数无效。");return t}}(e,JSON.parse(JSON.stringify(i)));Object.assign(e,r),t=this.serviceManager.plotService.draw(e,"gp-tubiaodian",e.name,!1)}return t},e.prototype.createDrawGeojson=function(e,t,i){var r=this;void 0===i&&(i=!1),this.count=0,Object.keys(this.geoGraph).forEach((function(e){r.geoGraph[e].isVectorData=!!i}));var n=[];if(!e.features)return pN.log("格式有误"),n;var o=DO(e.features);if(o){if(o.Point.length>0&&n.push(this.drawObj(o.Point,t,"Point")),o.MultiPoint.length>0&&n.push(this.drawObj(o.MultiPoint,t,"MultiPoint")),1===o.LineString.length&&0===o.MultiLineString.length&&n.push(this.drawObj(o.LineString,t,"LineString")),1===o.Polygon.length&&0===o.MultiPolygon.length&&n.push(this.drawObj(o.Polygon,t,"Polygon")),o.MultiLineString.length>0||o.LineString.length>1){var s=o.MultiLineString.concat(o.LineString);n.push(this.drawObj(s,t,"MultiLineString"))}if(o.MultiPolygon.length>0||o.Polygon.length>1){s=o.MultiPolygon.concat(o.Polygon);n.push(this.drawObj(s,t,"MultiPolygon"))}}return n},e.prototype.drawObj=function(e,t,i){var r;switch(i){case"Point":r=this.drawPoint(e,t);break;case"MultiPoint":r=this.drawMultiPoint(e,t);break;case"LineString":r=this.drawLineString(e,t);break;case"MultiLineString":r=this.drawMultiLineString(e,t);break;case"Polygon":r=this.drawPolygon(e,t);break;case"MultiPolygon":r=this.drawMultiPolygon(e,t)}return r},e.prototype.addAnimation=function(e,t,i){var r,n,o,s,a=this;pN.log("animationItem>>>>>>>>>>>>>>",e);var l=this.serviceManager.animationService.cloneAnimation(e.animation);l.image=e.image,l.title=e.title,1==l.keyframes.length&&(l.keyframes[0].shape="point"),l.viewer=this._viewer,l.startState||(l.startState=fH.withPrevious);var h=function(){l.label=e.title,l.id=xw.v4(),a.serviceManager.animationService.rebuildAnimation(),a.serviceManager.animationService.showGlobalTimeLine=!1};if(l instanceof uN){var c=l;return h(),l}if(e.isHtml)return l instanceof UH&&pN.log("ani",l),h(),l;if(e.isGeojson){var u=void 0;if(this.serviceManager.geojsonService.geojsonList.length&&(u=this.serviceManager.geojsonService.geojsonList.filter((function(e){return e.id===t}))[0]),u||(u=this.serviceManager.geojsonService.currentGeojson),l instanceof VH)if(u)(c=l).dataSourceName=u.id,c.geojsonDataSource=u.cesiumDataSource;return h(),l}if(e.isTif){var p=this.serviceManager.drawbigfileService.currentFile;if(l instanceof Tx)(c=l).targetId=p.id;return h(),l}if(e.isAudio){var d=this.serviceManager.musicService.currentMusic;if(l instanceof ZH)(c=l).targetId=d.id;return h(),l}if(l instanceof hF)return(c=l).set(),h(),l;if(l instanceof tF)return(c=l).set(),h(),l;if(l instanceof oF)return(c=l).set(),h(),l;if(l instanceof dF){(c=l).set();var m,f=this.serviceManager.plotService.createEntityName("相机漫游"),g=Math.ceil(this._viewer.camera.positionCartographic.height)/50,y=this.serviceManager.plotService.gm.create({obj:"Polyline",color:"#f00",name:f,interplate:!0,clampToGround:!1,defaultHeight:g}).graph,v=function(e){y==e&&(h(),y.defaultHeight=void 0),m.unsubscribe()};m=this.serviceManager.plotService.gm.editor.onCreateFinished.subscribe(v),c.polyLineId=y.id}else{if(null==e.type&&l instanceof AF){var C,_=l,b=this.serviceManager.plotService.createEntityName("路径凝视"),w=Math.ceil(this._viewer.camera.positionCartographic.height)/50;this.serviceManager.plotService.gm.editor.pickTypes=[mB,cE,sI,LS,JS],this.serviceManager.plotService.gm.editor.pickString="请选择凝视元素或绘制一个元素",this.serviceManager.plotService.gm.editor.startPickTarget=!0;var P=function(e){if(e){if(e instanceof Cesium.Cartesian3){var t=a._viewer.scene.globe.ellipsoid.cartesianToCartographic(e),i=Cesium.Math.toDegrees(t.latitude),r=Cesium.Math.toDegrees(t.longitude),n=t.height;if(!Cesium.defined(e))return;var o=a.serviceManager.plotService.gm.editor.layerId,s={obj:"Point",color:"#ED6F00",name:"图标点",_ctrlPosition:[{lon:r,lat:i,alt:n,time:void 0}]},l=new mB(s,a._viewer,o);for(var c in s)l[c]=s[c];l instanceof ZP?l.initCtls(!1):l.initCtls(),l.initShape(),a.serviceManager.plotService.gm.editor.draw(l.ent),e=l}a.serviceManager.plotService.gm.graphList.indexOf(e.ent)<0&&(e.ent.graph.iconName="gp-tubiaodian",a.serviceManager.plotService.gm.graphList.push(e.ent),a.serviceManager.plotService.isRefresh.next([e.ent.graph])),_.targetId=e.id;var u,p=a.serviceManager.plotService.gm.create({obj:"Polyline",color:"#f00",name:b,interplate:!0,clampToGround:!1,defaultHeight:w}).graph;_.polyLineId=p.id,u=a.serviceManager.plotService.gm.editor.onCreateFinished.subscribe((function(e){p==e&&(h(),p.defaultHeight=void 0),u.unsubscribe()})),C.unsubscribe()}};return C=this.serviceManager.plotService.gm.editor.pickCompleted$.subscribe(P),l}if(null==e.type&&l instanceof bF){var S,x=l;this.serviceManager.plotService.gm.editor.pickTypes=[mB,cE,sI,LS,JS],this.serviceManager.plotService.gm.editor.startPickTarget=!0,this.serviceManager.plotService.gm.editor.pickString="请选择环绕凝视元素或绘制一个元素";P=function(e){if(e){if(e instanceof Cesium.Cartesian3){var t=a._viewer.scene.globe.ellipsoid.cartesianToCartographic(e),i=Cesium.Math.toDegrees(t.latitude),r=Cesium.Math.toDegrees(t.longitude);t.height;if(!Cesium.defined(e))return;var n=a.serviceManager.plotService.gm.editor.layerId,o={obj:"Point",color:"#ED6F00",name:"图标点",_ctrlPosition:[{lon:r,lat:i,alt:0,time:void 0}]},s=new mB(o,a._viewer,n);for(var l in o)s[l]=o[l];s instanceof ZP?s.initCtls(!1):s.initCtls(),s.initShape(),a.serviceManager.plotService.gm.editor.draw(s.ent),e=s}if(a.serviceManager.plotService.gm.graphList.indexOf(e.ent)<0&&(e.ent.graph.iconName="gp-tubiaodian",a.serviceManager.plotService.gm.graphList.push(e.ent),a.serviceManager.plotService.isRefresh.next([e.ent.graph])),x.targetId=e.id,a._viewer.terrainProvider.availability){var c=a._viewer.terrainProvider.availability._maximumLevel?a._viewer.terrainProvider.availability._maximumLevel:10,u=[Cesium.Cartographic.fromDegrees(e.ctrlPosition[0].lon,e.ctrlPosition[0].lat)];Cesium.sampleTerrain(a._viewer.terrainProvider,c,u).then((function(e){if(e[0].height){var t=Math.ceil(e[0].height);x.__meta__.lineHeight.min=t,x.__meta__.lineHeight.max=t+2e4}}))}x.lineHeight=x.__meta__.lineHeight.min+400,x.circleRadius=1500,h(),S.unsubscribe()}};return S=this.serviceManager.plotService.gm.editor.pickCompleted$.subscribe(P),l}if(null==e.type&&l instanceof xF){var B,M=l;this.serviceManager.plotService.createEntityName("螺旋动画");M.startRadius=2e3,M.endRadius=500,this.serviceManager.plotService.gm.editor.pickTypes=[mB,cE,sI,LS,JS],this.serviceManager.plotService.gm.editor.startPickTarget=!0,this.serviceManager.plotService.gm.editor.pickString="请选择螺旋凝视元素或绘制一个元素";P=function(e){if(e){if(e instanceof Cesium.Cartesian3){var t=a._viewer.scene.globe.ellipsoid.cartesianToCartographic(e),i=Cesium.Math.toDegrees(t.latitude),r=Cesium.Math.toDegrees(t.longitude);t.height;if(!Cesium.defined(e))return;var n=a.serviceManager.plotService.gm.editor.layerId,o={obj:"Point",color:"#ED6F00",name:"图标点",_ctrlPosition:[{lon:r,lat:i,alt:0,time:void 0}]},s=new mB(o,a._viewer,n);for(var l in o)s[l]=o[l];s instanceof ZP?s.initCtls(!1):s.initCtls(),s.initShape(),a.serviceManager.plotService.gm.editor.draw(s.ent),e=s}if(a.serviceManager.plotService.gm.graphList.indexOf(e.ent)<0&&(e.ent.graph.iconName="gp-tubiaodian",a.serviceManager.plotService.gm.graphList.push(e.ent),a.serviceManager.plotService.isRefresh.next([e.ent.graph])),a._viewer.terrainProvider.availability){var c=a._viewer.terrainProvider.availability._maximumLevel?a._viewer.terrainProvider.availability._maximumLevel:10,u=[Cesium.Cartographic.fromDegrees(e.ctrlPosition[0].lon,e.ctrlPosition[0].lat)];Cesium.sampleTerrain(a._viewer.terrainProvider,c,u).then((function(e){if(e[0].height){var t=Math.ceil(e[0].height);M.__meta__.startHeight.min=t,M.__meta__.startHeight.max=t+5e3,M.__meta__.endHeight.min=t,M.__meta__.endHeight.max=t+5e3}}))}M.startHeight=M.__meta__.startHeight.min+2500,M.endHeight=M.__meta__.endHeight.min+500,M.targetId=e.id,h(),B.unsubscribe()}};return B=this.serviceManager.plotService.gm.editor.pickCompleted$.subscribe(P),l}if(l instanceof jF){var E,T=this.serviceManager.plotService.gm.editor.currentEditGraphList[0],O=l;this.serviceManager.plotService.createEntityName("跟随动画");this.serviceManager.plotService.gm.editor.pickTypes=[mB,yB,nx,cE,sI,LS,JS],this.serviceManager.plotService.gm.editor.startPickTarget=!0,this.serviceManager.plotService.gm.editor.pickString="请选择跟随元素";P=function(e){if(e)return e instanceof Cesium.Cartesian3?(E.unsubscribe(),void pN.log("未选中元素,动画取消")):void(e!=T?(a.serviceManager.plotService.gm.graphList.indexOf(e.ent)<0&&(a.serviceManager.plotService.gm.graphList.push(e.ent),a.serviceManager.plotService.isRefresh.next([e.ent.graph])),O.followTargetId=e.id,O.targetId=T.id,h(),E.unsubscribe()):pN.log("不能跟随自身,动画取消"))};return E=this.serviceManager.plotService.gm.editor.pickCompleted$.subscribe(P),l}var L;if(!(L=t?this.serviceManager.plotService.gm.editor.currentEditGraphList.filter((function(e){return e.id===t}))[0]:this.serviceManager.plotService.gm.editor.currentEditGraphList[0]))return;if(l instanceof Tx)(c=l).targetId=L.id,h();else if(l instanceof TF){(c=l).targetId=L.id,h()}else if(l instanceof XF){(c=l).targetId=L.id,h()}else if(l instanceof eN){(c=l).targetId=L.id,h()}else if(l instanceof FF){try{for(var D=dN(this.serviceManager.animationService.allAnimation),I=D.next();!I.done;I=D.next()){var R=I.value;try{for(var H=(o=void 0,dN(R)),F=H.next();!F.done;F=H.next()){var N=F.value;if(N instanceof FF&&N.target==L)return void pN.log("该元素已经包含路径动画,禁止重复创建!")}}catch(e){o={error:e}}finally{try{F&&!F.done&&(s=H.return)&&s.call(H)}finally{if(o)throw o.error}}}}catch(e){r={error:e}}finally{try{I&&!I.done&&(n=D.return)&&n.call(D)}finally{if(r)throw r.error}}var Q,k=l;this.serviceManager.plotService.gm.editor.pickTypes=[lM],this.serviceManager.plotService.gm.editor.startPickTarget=!0,this.serviceManager.plotService.gm.editor.pickString="请选择路径线或绘制一条路径";P=function(e){var t,i,r,n;if(e){if(e instanceof Cesium.Cartesian3){var o,s,c=a.serviceManager.plotService.createEntityName("路径直线");"飞行动画"==l.title?(o=a.serviceManager.plotService.gm.create({obj:"Polyline",color:"#f00",name:c,interplate:!0,clampToGround:!1,defaultHeight:1e4}).graph,L instanceof JS&&(o.defaultHeight=L.elevation,L.heightReference=0)):o=a.serviceManager.plotService.gm.create({obj:"Polyline",color:"#f00",name:c,interplate:!0,clampToGround:!0,defaultHeight:0}).graph;o.addCtlPoint(L.ctrlPosition[0]);var u=zy.getLongitudeByCartesian3(e,a._viewer),p=zy.getLatitudeByCartesian3(e,a._viewer),d=zy.getHeightByCartesian3(e,a._viewer);L instanceof JS&&"飞行动画"!=l.title&&(d=0);var m=new A(u,p,d);o.addCtlPoint(m),s=a.serviceManager.plotService.gm.editor.onCreateFinished.subscribe((function(e){o==e&&(h(),o.defaultHeight=void 0),s.unsubscribe()})),k.polyLineId=o.id}else{try{for(var f=dN(a.serviceManager.animationService.allAnimation),g=f.next();!g.done;g=f.next()){var y=g.value;try{for(var v=(r=void 0,dN(y)),C=v.next();!C.done;C=v.next()){var _=C.value;if(_ instanceof FF&&_.polyLine==e)return pN.log("该路径已经作为路径动画,禁止重复选择!"),void(a.serviceManager.plotService.gm.editor.startPickTarget=!0)}}catch(e){r={error:e}}finally{try{C&&!C.done&&(n=v.return)&&n.call(v)}finally{if(r)throw r.error}}}}catch(e){t={error:e}}finally{try{g&&!g.done&&(i=f.return)&&i.call(f)}finally{if(t)throw t.error}}L.setCtrlPosition(0,e.ctrlPosition[0]),a.serviceManager.plotService.gm.graphList.indexOf(e.ent)<0&&(a.serviceManager.plotService.gm.graphList.push(e.ent),a.serviceManager.plotService.isRefresh.next([e.ent.graph])),k.polyLineId=e.id,h()}k.targetId=L.id,Q.unsubscribe()}};Q=this.serviceManager.plotService.gm.editor.pickCompleted$.subscribe(P)}else if(l instanceof aN){var U=this.serviceManager.plotService.gm.draw({obj:"Point",color:"#f00",show:!1,ctls:[{lon:98,lat:37}]});U.show=!1,(c=l).targetId=U.id,c.polyLineId=L.id,h()}else if(l instanceof AF){(c=l).targetId=L.id;var j,G=this.serviceManager.plotService.createEntityName("路径凝视"),z=(g=Math.ceil(this._viewer.camera.positionCartographic.height)/10,this.serviceManager.plotService.gm.create({obj:"Polyline",color:"#f00",name:G,interplate:!0,clampToGround:!1,defaultHeight:g}).graph);v=function(e){z==e&&(h(),z.defaultHeight=void 0),j.unsubscribe()};j=this.serviceManager.plotService.gm.editor.onCreateFinished.subscribe(v),c.polyLineId=z.id}else if(l instanceof bF){var Y=l;Y.targetId=L.id;this.serviceManager.plotService.createEntityName("环绕动画");if(this._viewer.terrainProvider.availability){var Z=this._viewer.terrainProvider.availability._maximumLevel?this._viewer.terrainProvider.availability._maximumLevel:10,W=[Cesium.Cartographic.fromDegrees(L.ctrlPosition[0].lon,L.ctrlPosition[0].lat)];Cesium.sampleTerrain(this._viewer.terrainProvider,Z,W).then((function(e){if(e[0].height){var t=Math.ceil(e[0].height);Y.__meta__.lineHeight.min=t,Y.__meta__.lineHeight.max=t+2e4}}))}Y.lineHeight=Y.__meta__.lineHeight.min+400,Y.circleRadius=1500,h()}else if(l instanceof xF){var X=l;X.targetId=L.id;this.serviceManager.plotService.createEntityName("螺旋动画");if(this._viewer.terrainProvider.availability){Z=this._viewer.terrainProvider.availability._maximumLevel?this._viewer.terrainProvider.availability._maximumLevel:10,W=[Cesium.Cartographic.fromDegrees(L.ctrlPosition[0].lon,L.ctrlPosition[0].lat)];Cesium.sampleTerrain(this._viewer.terrainProvider,Z,W).then((function(e){if(e[0].height){var t=Math.ceil(e[0].height);X.__meta__.startHeight.min=t,X.__meta__.startHeight.max=t+5e3,X.__meta__.endHeight.min=t,X.__meta__.endHeight.max=t+5e3}}))}X.startHeight=X.__meta__.startHeight.min+2500,X.endHeight=X.__meta__.endHeight.min+500,X.startRadius=2e3,X.endRadius=500,h()}}},e.prototype.createGraph=function(e){var t=this.serviceManager.plotService.gm.create(e);return t?t.graph:null},e.prototype.drawPoint=function(e,t){var i=this,r=[];return e.forEach((function(e){i.count++;var n={name:t,obj:"Point",ctls:[new A(e.geometry.coordinates[0],e.geometry.coordinates[1])]};Object.assign(n,e.properties);var o=i.serviceManager.plotService.draw(n,"gp-tubiaodian","".concat(t,"-").concat(i.count),!1);r.push(o)})),r},e.prototype.drawMultiPoint=function(e,t){var i=this,r=[];return e.forEach((function(e){var n=[];e.geometry.coordinates.forEach((function(e){var t=new A(e[0],e[1]);n.push(t)})),n.forEach((function(e){i.count++;var n={name:t,obj:"Point",ctls:[e]},o=i.serviceManager.plotService.draw(n,"gp-tubiaodian","".concat(t,"-").concat(i.count),!1);r.push(o)}))})),r},e.prototype.drawLineString=function(e,t){var i=this,r=[];return e.forEach((function(e,n){i.count++;var o=t;i.count>0&&(o+="-".concat(i.count));var s=RO(e,JSON.parse(JSON.stringify(i.geoGraph.LineString)));s.jsonId=n;var a=i.serviceManager.plotService.draw(s,"gp-zhixian",o,!1);r.push(a)})),r},e.prototype.drawMultiLineString=function(e,t){var i=[],r=HO(e,JSON.parse(JSON.stringify(this.geoGraph.MultiLineString))),n=this.serviceManager.plotService.draw(r,"gp-zhixian",t,!1);return i.push(n),i},e.prototype.drawPolygon=function(e,t){var i=this,r=[];return e.forEach((function(e,n){var o=t;i.count++,i.count>0&&(o+="-".concat(i.count));var s=RO(e,JSON.parse(JSON.stringify(i.geoGraph.Polygon)));s.jsonId=n,pN.log("features polygon>>>",s);var a=i.serviceManager.plotService.draw(s,"gp-zidingyixingzhuang",o,!1);r.push(a)})),r},e.prototype.drawMultiPolygon=function(e,t){var i=[],r=HO(e,this.geoGraph.MultiPolygon),n=this.serviceManager.plotService.draw(r,"gp-zidingyixingzhuang",t,!1);return i.push(n),i},e}(),fN=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),gN=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},AN=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return fN(t,e),t.prototype.createSampledProperty=function(){this.sampledProperty=new Cesium.SampledProperty(Cesium.Color)},t.prototype.initAnimation=function(){this.createSampledProperty(),this.target&&this.target instanceof ZM&&(this.property="textColor"),this.defaultValue=this.target[this.property],this.sampledProperty.addSample(Cesium.JulianDate.addSeconds(this.animationBaseTime,this.beginTime,new Cesium.JulianDate),Cesium.Color.fromCssColorString(this.from)),this.sampledProperty.addSample(Cesium.JulianDate.addSeconds(this.animationBaseTime,this.beginTime+this.duration,new Cesium.JulianDate),Cesium.Color.fromCssColorString(this.to))},t.prototype.getCurrentValue=function(e){var t=e;return t<this.beginTime?this.from:t>this.beginTime+this.duration?this.to:this.sampledProperty.getValue(this.getCesiumAnimationTime(e)).toCssColorString()},t=gN([yx("ColorAnimation")],t)}(Tx),yN=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),vN=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},CN=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return yN(t,e),t.prototype.createSampledProperty=function(){this.sampledProperty=new Cesium.SampledProperty(Number)},t=vN([yx("NumberAnimation")],t)}(Tx),_N=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),bN=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},wN=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},PN=function(e){function t(){var t=e.call(this)||this;return t.count=0,t.flag=!1,t.hideValues=["from","to"],t}return _N(t,e),t.prototype.createSampledProperty=function(){},t.prototype.initAnimation=function(){this.defaultValue=this.target[this.property]},t.prototype.getCurrentValue=function(e){return this.count>100-this.frequency&&(this.count=0,this.flag=!this.flag),this.count++,this.flag?this.from:this.to},bN([dy({name:"频率",group:"",type:"number",order:7,min:1,max:100}),wN("design:type",Number)],t.prototype,"frequency",void 0),t=bN([yx("RepeatAnimation"),wN("design:paramtypes",[])],t)}(Tx),SN=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),xN=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},BN=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},MN=function(e){function t(){var t=e.call(this)||this;return t.hideValues=["duration","fillBehavior"],t}return SN(t,e),t.prototype.onTick=function(e){e>=this.beginTime&&(this.isexecuted||this.viewer.camera.setView({destination:Cesium.Cartesian3.fromDegrees(this.lon,this.lat,this.alt),orientation:{heading:Cesium.Math.toRadians(this.heading),pitch:Cesium.Math.toRadians(this.pitch),roll:this.roll}}),this.isexecuted=!0)},t=xN([yx("CameraSetAnimation"),BN("design:paramtypes",[])],t)}(hF),EN=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),TN=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},ON=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},LN=function(e){function t(){var t=e.call(this)||this;return t.hideValues=["duration"],t}return EN(t,e),t.prototype.createSampledProperty=function(){},t.prototype.initAnimation=function(){this.defaultValue=this.target[this.property]},t.prototype.onTick=function(e){var t=e;if(t>=this.beginTime+this.duration){var i=vx.HoldEnd;this.fillBehavior==i?this.target[this.property]=this.to:this.stopAnimation()}else t>=this.beginTime&&(this.target[this.property]=this.to)},t=TN([yx("StateChangeAnimation"),ON("design:paramtypes",[])],t)}(Tx),DN=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),IN=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},RN=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},HN=function(e){function t(){var t=e.call(this)||this;return t.stopped=!1,t.createSampledProperty(),t.hideValues=["from","to"],t}return DN(t,e),t.prototype.createSampledProperty=function(){this.sampledProperty=new Cesium.SampledProperty(Number)},t.prototype.initAnimation=function(){e.prototype.initAnimation.call(this),this.htmlElement&&("left"===this.property&&(this.from=0-Number.parseInt(getComputedStyle(this.htmlElement).width),this.to=Number.parseInt(getComputedStyle(this.htmlElement).left)),this.createSampledProperty(),this.defaultValue=this.htmlElement.style[this.property],"opacity"===this.property&&(this.htmlElement.style[this.property]=this.from),this.sampledProperty.addSample(Cesium.JulianDate.addSeconds(this.animationBaseTime,this.beginTime,new Cesium.JulianDate),this.from),this.sampledProperty.addSample(Cesium.JulianDate.addSeconds(this.animationBaseTime,this.beginTime+this.duration,new Cesium.JulianDate),this.to))},t.prototype.onTick=function(e){var t=e;if(t>=this.beginTime+this.duration){var i=vx.HoldEnd;this.fillBehavior===i?this.htmlElement.style[this.property]=this.to:this.stopAnimation()}else if(t>=this.beginTime){var r=this.getCurrentValue(e);"opacity"===this.property?this.htmlElement.style[this.property]=r+"":this.htmlElement.style[this.property]=r+"px"}},t.prototype.getCesiumAnimationTime=function(e){return Cesium.JulianDate.addSeconds(this.animationBaseTime,e,new Cesium.JulianDate)},t.prototype.getCurrentValue=function(e){return e>this.beginTime+this.duration?this.to:this.sampledProperty.getValue(this.getCesiumAnimationTime(e))},t.prototype.stopAnimation=function(){this.stopped=!0,this.htmlElement&&(this.htmlElement.style[this.property]=this.defaultValue,this.htmlElement.style.pointerEvents="all")},IN([(0,fy.o)(),RN("design:type",Cesium.SampledProperty)],t.prototype,"sampledProperty",void 0),IN([dy({name:"起始值",group:"",order:1,type:"owner",max:1,min:0}),RN("design:type",Object)],t.prototype,"from",void 0),IN([dy({name:"终止值",group:"",order:1,type:"owner",max:1,min:0}),RN("design:type",Object)],t.prototype,"to",void 0),t=IN([yx("CssValueAnimation"),RN("design:paramtypes",[])],t)}(FH),FN=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),NN=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},QN=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return FN(t,e),t.prototype.createSampledProperty=function(){Cesium&&Cesium.SampledProperty&&(this.sampledProperty=new Cesium.SampledProperty(Number))},t=NN([yx("CssNumberAnimation")],t)}(HN),kN=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),UN=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},jN=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},GN=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.count=0,t.flag=!1,t.endVisible=!0,t}return kN(t,e),t.prototype.createSampledProperty=function(){},t.prototype.getCurrentValue=function(e){return this.count>this.frequency&&(this.count=0,this.flag=!this.flag),this.count++,this.flag?this.from:this.to},t.prototype.stopAnimation=function(){this.geojsonDataSource&&(this.geojsonDataSource[this.property]=this.endVisible)},UN([dy({name:"频率",group:"",type:"number",order:7,min:0,max:100}),jN("design:type",Number)],t.prototype,"frequency",void 0),UN([dy({name:"结束时显示",group:"",type:"boolean",order:8}),jN("design:type",Object)],t.prototype,"endVisible",void 0),t=UN([yx("GeojsonRepeatAnimation")],t)}(VH),zN=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),YN=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},ZN=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},WN=function(e){function t(){return e.call(this)||this}return zN(t,e),t.prototype.initAnimation=function(){this.defaultValue=this.htmlElement.style[this.property]},t.prototype.onTick=function(e){var t=e;if(t>=this.beginTime+this.duration){var i=vx.HoldEnd;this.fillBehavior===i?this.htmlElement.style[this.property]=this.defaultValue:this.stopAnimation()}else t>=this.beginTime&&(this.htmlElement.style[this.property]=this.to)},t.prototype.stopAnimation=function(){this.htmlElement&&(this.htmlElement.style[this.property]=this.defaultValue)},t=YN([yx("CssPropChangeAnimation"),ZN("design:paramtypes",[])],t)}(FH),XN=i(5108),JN=function(){function e(){this.synth=window.speechSynthesis}return e.getInstance=function(){return"undefined"==typeof window?{}:(e.instance||(e.instance=new e),e.instance)},e.prototype.init=function(){var e=this;if(this.synth){var t=this.synth.getVoices();if(0!==t.length){var i=t.filter((function(e){return e.localService&&"zh-CN"===e.lang}));if(0!==i.length){var r=i.find((function(e){return"Microsoft Yaoyao - Chinese (Simplified, PRC)"===e.name}));r||(r=i[0]),this.voice=r}}else setTimeout((function(){e.init()}),2e3)}},e.prototype.speak=function(e,t){var i=this;return void 0===t&&(t=1),new Promise((function(r,n){if(!i.voice)return XN.log("语音不存在"),void n("语音不存在");if(LP.isNullOrEmpty(e))n(null);else{i.synth.speaking&&i.synth.cancel();var o=new SpeechSynthesisUtterance(e);o.voice=i.voice,o.pitch=1,o.rate=t,i.synth.speak(o),o.onend=function(e){XN.log("speak end"),r("speak end")},o.onerror=function(e){XN.log("speak onerror"),n("SpeechSynthesisUtterance.onerror")}}}))},e.prototype.stop=function(){this.synth&&this.synth.cancel()},e.prototype.pause=function(){this.synth&&this.synth.pause()},e.prototype.replay=function(){this.synth&&this.synth.resume()},e}(),KN=i(5108),VN=function(){function e(){this.synth=window.speechSynthesis;var e=window.AudioContext;e&&(this.audioContext=new e,this.audioContext.resume())}return e.getInstance=function(){return"undefined"==typeof window?{}:(e.instance||(e.instance=new e),e.instance)},e.prototype.getRequest=function(e,t){void 0===t&&(t="aisxping");var i=new URLSearchParams(window.location.search).get("scene"),r=i||"sceneId1",n=window.config.uploadfileService+"/audio/buff?sceneId=".concat(r,"&msg=").concat(e,"&vcn=").concat(t);return new Request(n,{method:"get",headers:{"Content-Type":"application/json",responseType:"blob"}})},e.prototype.playSound=function(e){this.bufferSource=this.audioContext.createBufferSource(),this.bufferSource.buffer=e,this.bufferSource.connect(this.audioContext.destination),this.bufferSource.start()},e.prototype.init=function(e,t){void 0===t&&(t="aisxping");var i=this.getRequest(e,t);fetch(i).catch((function(e){KN.error("讯飞语音请求错误",e)}))},e.prototype.speak=function(e,t){var i=this;void 0===t&&(t="aisxping");var r=this.getRequest(e,t);return new Promise((function(e,t){fetch(r).then((function(e){return e.blob()})).then((function(t){e("speak end");var r=new FileReader;r.readAsArrayBuffer(t);var n=i;r.onload=function(e){this.result instanceof ArrayBuffer&&n.audioContext.decodeAudioData(this.result,(function(e){n.playSound(e)}),(function(e){KN.log("error with decoding audio data:",e)}))}})).catch((function(e){t("SpeechSynthesisUtterance.onerror")}))}))},e.prototype.stop=function(){if(this.bufferSource)try{this.bufferSource.stop()}catch(e){KN.log(e)}},e.prototype.pause=function(){if(this.audioContext)try{this.audioContext.suspend()}catch(e){KN.log(e)}},e.prototype.replay=function(){if(this.audioContext)try{this.audioContext.resume()}catch(e){KN.log(e)}},e}(),qN=function(){function e(){this.isPause=!1}return e.getInstance=function(){return"undefined"==typeof window?{}:(e.instance||(e.instance=new e),e.instance)},e.prototype.init=function(t){if(!e.SpeakType.startsWith("1")){var i=e.SpeakType.split("-")[1];return VN.getInstance().init(t,i)}},e.prototype.speak=function(t,i){if(void 0===i&&(i=1),this.isPause=!1,e.SpeakType.startsWith("1"))return JN.getInstance().speak(t,i);var r=e.SpeakType.split("-")[1];return VN.getInstance().speak(t,r)},e.prototype.stop=function(){this.isPause=!0,e.SpeakType.startsWith("1")?JN.getInstance().stop():VN.getInstance().stop()},e.prototype.pause=function(){this.isPause=!0,e.SpeakType.startsWith("1")?JN.getInstance().pause():VN.getInstance().pause()},e.prototype.replay=function(){this.isPause=!1,e.SpeakType.startsWith("1")?JN.getInstance().replay():VN.getInstance().replay()},e.SpeakType="1",e}(),$N=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),eQ=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},tQ=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},iQ=function(e){function t(){var t=e.call(this)||this;return t.rate=1,t.isSpeak=!0,t.rd=!0,t.hasSpoken=!1,t}return $N(t,e),Object.defineProperty(t.prototype,"subText",{get:function(){return this.htmlElement?this.htmlElement.innerText:"zzz"},enumerable:!1,configurable:!0}),t.prototype.resetDuration=function(){this.duration=Number.parseFloat((this.subText.trim().length/4).toFixed(2))},t.prototype.onTick=function(e){var t=e;if(this.htmlElement)if(t>=this.beginTime+this.duration){var i=vx.HoldEnd;this.fillBehavior===i?this.htmlElement.style.display="none":this.stopAnimation()}else t>=this.beginTime&&(this.htmlElement.style.display="inline",qN.SpeakType.startsWith("0")||!this.isSpeak||this.hasSpoken||(qN.getInstance().speak(this.htmlElement.innerText,this.rate),this.hasSpoken=!0))},t.prototype.stopAnimation=function(){this.htmlElement&&(this.htmlElement.style.display="none",this.hasSpoken=!1)},eQ([(0,fy.o)(),tQ("design:type",String),tQ("design:paramtypes",[])],t.prototype,"subText",null),eQ([dy({name:"语速",group:"",type:"number",order:4,min:0,max:10}),tQ("design:type",Object)],t.prototype,"rate",void 0),eQ([dy({name:"朗读",group:"",type:"boolean",order:3}),tQ("design:type",Object)],t.prototype,"isSpeak",void 0),eQ([(0,fy.o)(),dy({name:"动画时长",group:"",type:"resetDuration",order:4}),tQ("design:type",Object)],t.prototype,"rd",void 0),t=eQ([yx("SubtitleAnimation"),tQ("design:paramtypes",[])],t)}(FH),rQ=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),nQ=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},oQ=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},sQ=function(e){function t(){var t=e.call(this)||this;return t.hideValues=["from","to"],t}return rQ(t,e),t.prototype.createSampledProperty=function(){this.sampledProperty=new Cesium.SampledProperty(Number)},t.prototype.initAnimation=function(){this.createSampledProperty(),this.target&&(this.defaultValue=this.target[this.property]),this.sampledProperty.addSample(Cesium.JulianDate.addSeconds(this.animationBaseTime,this.beginTime,new Cesium.JulianDate),0),this.sampledProperty.addSample(Cesium.JulianDate.addSeconds(this.animationBaseTime,this.beginTime+this.duration,new Cesium.JulianDate),1)},t.prototype.getCurrentValue=function(e){var t=e;return t<this.beginTime?this.from:t>this.beginTime+this.duration?this.to:this.sampledProperty.getValue(this.getCesiumAnimationTime(e))},t=nQ([yx("ForwardAnimation"),oQ("design:paramtypes",[])],t)}(Tx),aQ=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),lQ=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},hQ=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return aQ(t,e),t.prototype.initAnimation=function(){var e=this;this.geojsonDataSource=this.viewer.dataSources._dataSources.find((function(t){return t.name===e.dataSourceName})),this.geojsonDataSource&&(this.defaultValue=this.geojsonDataSource[this.property])},t.prototype.onTick=function(e){var t=e;if(t>=this.beginTime+this.duration){var i=vx.HoldEnd;this.fillBehavior===i?this.geojsonDataSource[this.property]=this.defaultValue:this.stopAnimation()}else t>=this.beginTime&&(this.geojsonDataSource[this.property]=this.to)},t=lQ([yx("GeojsonVisibleAnimation")],t)}(VH),cQ=i(5108),uQ=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),pQ=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},dQ=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},mQ=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.direction="left",t}return uQ(t,e),t.prototype.initAnimation=function(){cQ.log("initAnimation",this.htmlElement),this.property="left",e.prototype.initAnimation.call(this),this.htmlElement&&("left"===this.direction?this.from=0-Number.parseInt(getComputedStyle(this.htmlElement).width):this.from=Number.parseInt(getComputedStyle(this.htmlElement.parentNode.parentNode).width),this.to=Number.parseInt(getComputedStyle(this.htmlElement).left),cQ.log("飞入动画",this.from,this.to),this.createSampledProperty(),this.defaultValue=this.htmlElement.style[this.property],this.htmlElement.style[this.property]=this.from+"px",this.sampledProperty.addSample(Cesium.JulianDate.addSeconds(this.animationBaseTime,this.beginTime,new Cesium.JulianDate),this.from),this.sampledProperty.addSample(Cesium.JulianDate.addSeconds(this.animationBaseTime,this.beginTime+this.duration,new Cesium.JulianDate),this.to))},pQ([dy({name:"方向",type:"pOption",group:"",order:2,options:[{text:"左",value:"left"},{text:"右",value:"right"}]}),dQ("design:type",Object)],t.prototype,"direction",void 0),t=pQ([yx("CssMoveHorizonAnimation")],t)}(QN),fQ=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),gQ=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},AQ=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},yQ=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.direction="top",t}return fQ(t,e),t.prototype.initAnimation=function(){this.property="top",e.prototype.initAnimation.call(this),this.htmlElement&&("top"===this.direction?this.from=0-Number.parseInt(getComputedStyle(this.htmlElement).height):this.from=Number.parseInt(getComputedStyle(this.htmlElement.parentNode.parentNode).height),this.to=Number.parseInt(getComputedStyle(this.htmlElement).top),this.createSampledProperty(),this.defaultValue=this.htmlElement.style[this.property],this.htmlElement.style[this.property]=this.from+"px",this.sampledProperty.addSample(Cesium.JulianDate.addSeconds(this.animationBaseTime,this.beginTime,new Cesium.JulianDate),this.from),this.sampledProperty.addSample(Cesium.JulianDate.addSeconds(this.animationBaseTime,this.beginTime+this.duration,new Cesium.JulianDate),this.to))},gQ([dy({name:"方向",type:"pOption",group:"",order:2,options:[{text:"上",value:"top"},{text:"下",value:"bottom"}]}),AQ("design:type",Object)],t.prototype,"direction",void 0),t=gQ([yx("CssMoveVerticalAnimation")],t)}(QN),vQ=i(5108),CQ=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),_Q=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},bQ=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},wQ=function(e){function t(){return e.call(this)||this}return CQ(t,e),Object.defineProperty(t.prototype,"targetTif",{get:function(){return Ow.getGp(this.targetId)},enumerable:!1,configurable:!0}),t.prototype.createSampledProperty=function(){this.sampledProperty=new Cesium.SampledProperty(Number)},t.prototype.initAnimation=function(){this.targetTif?(this.defaultValue=this.targetTif[this.property],this.createSampledProperty(),this.sampledProperty.addSample(Cesium.JulianDate.addSeconds(this.animationBaseTime,this.beginTime,new Cesium.JulianDate),this.from),this.sampledProperty.addSample(Cesium.JulianDate.addSeconds(this.animationBaseTime,this.beginTime+this.duration,new Cesium.JulianDate),this.to)):vQ.error("动画关联标绘元素不存在")},t.prototype.setInitValue=function(){this.targetTif&&(this.targetTif[this.property]=1e-4)},t.prototype.onTick=function(e){if(this.targetTif){var t=e;if(t>=this.beginTime+this.duration)this.fillBehavior===vx.HoldEnd?this.targetTif[this.property]=this.to:this.targetTif[this.property]=1;else if(t>=this.beginTime){var i=this.getCurrentValue(e);this.targetTif[this.property]=i}}},_Q([(0,fy.o)(),bQ("design:type",Tw),bQ("design:paramtypes",[])],t.prototype,"targetTif",null),t=_Q([yx("ShowTifAnimation"),bQ("design:paramtypes",[])],t)}(Tx),PQ=i(5108),SQ=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),xQ=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},BQ=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},MQ=function(e){function t(){var t=e.call(this)||this;return t.increase=!1,t}return SQ(t,e),Object.defineProperty(t.prototype,"isIncrease",{get:function(){return this.increase},set:function(e){this.increase=e},enumerable:!1,configurable:!0}),t.prototype.createSampledProperty=function(){this.sampledProperty=new Cesium.SampledProperty(Number)},t.prototype.initAnimation=function(){this.target?(this.defaultValue=this.target[this.property],this.isIncrease?this.from=this.defaultValue:this.from=0,this.to=0,this.createSampledProperty(),this.sampledProperty.addSample(Cesium.JulianDate.addSeconds(this.animationBaseTime,this.beginTime,new Cesium.JulianDate),this.from),this.sampledProperty.addSample(Cesium.JulianDate.addSeconds(this.animationBaseTime,this.beginTime+this.duration,new Cesium.JulianDate),this.to)):PQ.error("动画关联标绘元素不存在")},t.prototype.onTick=function(e){if(this.target){var t=e;if(t>=this.beginTime+this.duration)this.fillBehavior===vx.HoldEnd?this.target[this.property]=this.to:this.target[this.property]=this.defaultValue;else if(t>=this.beginTime){var i=this.getCurrentValue(e);this.target[this.property]=i}}},t.prototype.stopAnimation=function(){this.target&&void 0!==this.defaultValue&&(this.target[this.property]=this.defaultValue)},xQ([dy({name:"渐隐",group:"",subOrder:6,type:"boolean",order:2}),BQ("design:type",Boolean),BQ("design:paramtypes",[Boolean])],t.prototype,"isIncrease",null),t=xQ([yx("HideAnimation"),BQ("design:paramtypes",[])],t)}(Tx),EQ=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),TQ=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},OQ=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},LQ=function(e){function t(){var t=e.call(this)||this;return t.increase=!1,t}return EQ(t,e),Object.defineProperty(t.prototype,"isIncrease",{get:function(){return this.increase},set:function(e){this.increase=e,this.increase?this.from=0:this.from=1},enumerable:!1,configurable:!0}),t.prototype.initAnimation=function(){this.stopped=!1,this.htmlElement&&(this.createSampledProperty(),this.defaultValue=1,this.htmlElement.style.opacity=0,this.sampledProperty.addSample(Cesium.JulianDate.addSeconds(this.animationBaseTime,this.beginTime,new Cesium.JulianDate),this.from),this.sampledProperty.addSample(Cesium.JulianDate.addSeconds(this.animationBaseTime,this.beginTime+this.duration,new Cesium.JulianDate),this.to),this.htmlElement.style.pointerEvents="none")},t.prototype.onTick=function(e){var t=e;if(!this.stopped)if(t>=this.beginTime+this.duration){var i=vx.HoldEnd;this.fillBehavior===i?this.htmlElement.style.opacity=this.to:this.htmlElement.style.opacity=0}else if(t>=this.beginTime){var r=this.getCurrentValue(e);this.htmlElement.style.opacity=r+""}},TQ([dy({name:"渐显",group:"",subOrder:6,type:"boolean",order:2}),OQ("design:type",Boolean),OQ("design:paramtypes",[Boolean])],t.prototype,"isIncrease",null),t=TQ([yx("CssShowAnimation"),OQ("design:paramtypes",[])],t)}(HN),DQ=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),IQ=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},RQ=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},HQ=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isexecuted=!1,t}return DQ(t,e),t.prototype.stopAnimation=function(){},t.prototype.initAnimation=function(){this.isexecuted=!1},t.prototype.onTick=function(e){e>=this.beginTime+this.duration&&(this.isexecuted=!1)},IQ([(0,fy.o)(),RQ("design:type",Object)],t.prototype,"isexecuted",void 0),t=IQ([yx("PopulationTimeAnimation")],t)}(Px),FQ=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),NQ=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},QQ=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},kQ=function(e){function t(){var t=e.call(this)||this;return t.increase=!1,t}return FQ(t,e),Object.defineProperty(t.prototype,"isIncrease",{get:function(){return this.increase},set:function(e){this.increase=e,this.increase?this.from=1:this.from=0},enumerable:!1,configurable:!0}),t.prototype.initAnimation=function(){this.stopped=!1,this.htmlElement&&(this.createSampledProperty(),this.htmlElement.style.opacity=1,this.sampledProperty.addSample(Cesium.JulianDate.addSeconds(this.animationBaseTime,this.beginTime,new Cesium.JulianDate),this.from),this.sampledProperty.addSample(Cesium.JulianDate.addSeconds(this.animationBaseTime,this.beginTime+this.duration,new Cesium.JulianDate),this.to))},t.prototype.onTick=function(e){var t=e;if(!this.stopped)if(t>=this.beginTime+this.duration){var i=vx.HoldEnd;this.fillBehavior===i?this.htmlElement.style.opacity=this.to:this.htmlElement.style.opacity=1}else if(t>=this.beginTime){var r=this.getCurrentValue(e);this.htmlElement.style.opacity=r+""}},NQ([dy({name:"渐隐",group:"",subOrder:6,type:"boolean",order:2}),QQ("design:type",Boolean),QQ("design:paramtypes",[Boolean])],t.prototype,"isIncrease",null),t=NQ([yx("CssHideAnimation"),QQ("design:paramtypes",[])],t)}(HN),UQ=i(5108),jQ=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),GQ=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},zQ=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},YQ=function(e){function t(){var t=e.call(this)||this;return t.maskBehavior=OF.LefttoRight,t.stopped=!1,t.isInited=!1,delete t.__meta__.fillBehavior,t}return jQ(t,e),t.prototype.initAnimation=function(){this.isInited=!1,this.stopped=!1},t.prototype.onTick=function(e){var t,i=this,r=e;if(this.maskBehavior===OF.LefttoRight?t=this.startWidth/this.duration:this.maskBehavior===OF.ToptoBottom&&(t=this.startHeight/this.duration),r>=this.beginTime+this.duration)this.stopAnimation();else if(r>=this.beginTime){if(!this.isInited){if("html-draw-container"!==this.htmlElement.parentNode.id)return;if(this.htmlElement.style.display="inline",UQ.log("蒙版  初始化"),!this.currentAni)return;var n=document.getElementById("html-draw-container");if(!n)return;"html-box-subtitle"==this.htmlElement.className?(UQ.log("isSubtitle"),this.maskBox=document.createElement("div"),["width","bottom","left"].forEach((function(e){i.maskBox.style[e]=i.htmlElement.style[e]})),this.maskBox.style.height=getComputedStyle(this.htmlElement).height,this.maskBox.style["background-color"]="rgba(255, 255, 255, 0)",this.maskBox.style.position="absolute",this.maskBox.style.overflow="hidden",n.removeChild(this.htmlElement),this.htmlElement.style.bottom=0,this.htmlElement.style.left=0,this.htmlElement.style.width="1536px",this.htmlElement.style.wordWrap="break-word",n.appendChild(this.maskBox),this.maskBox.appendChild(this.htmlElement),this.startWidth=this.maskBox.style.width.split("%")[0],this.startHeight=this.maskBox.style.height.split("px")[0]):(this.maskBox=document.createElement("div"),["width","height","top","left"].forEach((function(e){i.maskBox.style[e]=i.htmlElement.style[e]})),this.maskBox.style["background-color"]="rgba(255, 255, 255, 0)",this.maskBox.style.position="absolute",this.maskBox.style.overflow="hidden",n.removeChild(this.htmlElement),this.htmlElement.style.top=0,this.htmlElement.style.left=0,this.htmlElement.style.wordWrap="break-word",n.appendChild(this.maskBox),this.maskBox.appendChild(this.htmlElement),this.startWidth=this.maskBox.style.width.split("px")[0],this.startHeight=this.maskBox.style.height.split("px")[0]),this.isInited=!0}"html-box-subtitle"==this.htmlElement.className?this.maskBehavior===OF.LefttoRight?this.maskBox.style.width=(r-this.beginTime)*t+"%":this.maskBehavior===OF.ToptoBottom&&(this.maskBox.style.height=(r-this.beginTime)*t+"px"):this.maskBehavior===OF.LefttoRight?this.maskBox.style.width=(r-this.beginTime)*t+"px":this.maskBehavior===OF.ToptoBottom&&(this.maskBox.style.height=(r-this.beginTime)*t+"px")}},t.prototype.stopAnimation=function(){var e=this;if(!this.stopped&&(this.stopped=!0,UQ.log("蒙版  stopAnimation"),this.currentAni)){var t=document.getElementById("html-draw-container");t&&this.maskBox&&this.maskBox instanceof HTMLElement&&(this.maskBox.removeChild(this.htmlElement),t.removeChild(this.maskBox),"html-box-subtitle"==this.htmlElement.className?(this.htmlElement.style.width="80%",this.htmlElement.style.bottom="100px",this.htmlElement.style.left="10%",this.htmlElement.style.height=getComputedStyle(this.htmlElement).height):["top","left"].forEach((function(t){e.htmlElement.style[t]=e.maskBox.style[t]})),t.appendChild(this.htmlElement))}},GQ([dy({name:"蒙版方向",type:"pOption",group:"",order:4,options:[{text:"从左至右",value:OF.LefttoRight},{text:"从上至下",value:OF.ToptoBottom}]}),zQ("design:type",String)],t.prototype,"maskBehavior",void 0),t=GQ([yx("CssMaskAnimation"),zQ("design:paramtypes",[])],t)}(FH),ZQ=function(){function e(){}return e.init=function(){e.animationList=[{type:rv,animation:{type:"ColorAnimation",property:"color",from:"#ED6F00",to:"#00FF00",keyframes:[{val:0},{val:3e3}]},title:"颜色渐变",icon:"gv-taishibiaohui",image:"样式动画图片/颜色渐变.png",webp:"页面动画WEBP/颜色渐变.webp"},{type:mB,animation:{type:"PathAnimation",keyframes:[{val:0},{val:3e3}]},title:"路径动画",icon:"gv-Route",image:"样式动画图片/路径动画.png",webp:"页面动画WEBP/路径动画.webp"},{type:mB,animation:{type:"PathAnimation",keyframes:[{val:0},{val:3e3}]},title:"飞行动画",icon:"gv-Route",image:"样式动画图片/飞行动画.png",webp:"页面动画WEBP/飞行动画.webp"},{type:lM,animation:{type:"ForwardAnimation",property:"percent",keyframes:[{val:0},{val:3e3}]},title:"路径生长",icon:"gv-Route",image:"样式动画图片/路径生长.png",webp:"页面动画WEBP/路径生长.webp"},{type:JS,animation:{type:"PathAnimation",keyframes:[{val:0},{val:3e3}]},title:"路径动画",icon:"gv-Route",image:"样式动画图片/路径动画.png",webp:"页面动画WEBP/路径动画.webp"},{type:JS,animation:{type:"PathAnimation",keyframes:[{val:0},{val:3e3}]},title:"飞行动画",icon:"gv-Route",image:"样式动画图片/飞行动画.png",webp:"页面动画WEBP/飞行动画.webp"},{type:yB,animation:{type:"PathAnimation",keyframes:[{val:0},{val:3e3}],hideValues:["cameraType","cameraHeight"]},title:"路径动画",icon:"gv-Route",image:"样式动画图片/路径动画.png",webp:"页面动画WEBP/路径动画.webp"},{type:yB,animation:{type:"PathAnimation",keyframes:[{val:0},{val:3e3}],hideValues:["cameraType","cameraHeight"]},title:"飞行动画",icon:"gv-Route",image:"样式动画图片/飞行动画.png",webp:"页面动画WEBP/飞行动画.webp"},{type:nx,animation:{type:"PathAnimation",keyframes:[{val:0},{val:3e3}],hideValues:["cameraType","cameraHeight"]},title:"路径动画",icon:"gv-Route",image:"样式动画图片/路径动画.png",webp:"页面动画WEBP/路径动画.webp"},{type:nx,animation:{type:"PathAnimation",keyframes:[{val:0},{val:3e3}],hideValues:["cameraType","cameraHeight"]},title:"飞行动画",icon:"gv-Route",image:"样式动画图片/飞行动画.png",webp:"页面动画WEBP/飞行动画.webp"},{type:rv,animation:{type:"RepeatAnimation",keyframes:[{val:0},{val:3e3}],property:"show",from:!0,to:!1,frequency:90},title:"闪烁",icon:"gv-baozha",image:"样式动画图片/闪烁动画.png",webp:"页面动画WEBP/闪烁动画.webp"},{type:rv,animation:{type:"ShowAnimation",keyframes:[{val:0},{val:3e3}],from:1,to:1,property:"alpha",hideValues:["from","to"]},title:"显示",icon:"gp-yincang",image:"样式动画图片/显示动画.png",webp:"页面动画WEBP/显示动画.webp"},{type:rv,animation:{type:"HideAnimation",keyframes:[{val:0},{val:3e3}],from:0,to:0,property:"alpha",hideValues:["from","to"]},title:"隐藏",icon:"gp-yincang",image:"样式动画图片/隐藏动画.png",webp:"页面动画WEBP/隐藏动画.webp"},{type:mL,animation:{type:"ForwardAnimation",property:"percent",keyframes:[{val:0},{val:3e3}]},title:"路径生长",icon:"gv-Route",image:"样式动画图片/路径生长.png",webp:"页面动画WEBP/路径生长.webp"},{type:aO,animation:{type:"ForwardAnimation",property:"percent",keyframes:[{val:0},{val:3e3}]},title:"路径生长",icon:"gv-Route",image:"样式动画图片/路径生长.png",webp:"页面动画WEBP/路径生长.webp"},{isGeojson:!0,type:cP,animation:{type:"GeojsonRepeatAnimation",keyframes:[{val:0},{val:3e3}],property:"show",from:!0,to:!1,frequency:10},title:"闪烁",icon:"gv-baozha",image:"样式动画图片/闪烁动画.png",webp:"页面动画WEBP/闪烁动画.webp"},{isGeojson:!0,type:cP,animation:{type:"GeojsonVisibleAnimation",keyframes:[{val:0},{val:3e3}],property:"show",from:!1,to:!0,fillBehavior:"0",hideValues:["from","to"]},title:"显示",icon:"gv-yanjing_xianshi",image:"样式动画图片/显示动画.png",webp:"页面动画WEBP/显示动画.webp"},{isGeojson:!0,type:cP,animation:{type:"GeojsonVisibleAnimation",keyframes:[{val:0}],property:"show",from:!0,to:!1,fillBehavior:"0",hideValues:["from","to","duration"]},title:"隐藏",icon:"gp-yincang",image:"样式动画图片/隐藏动画.png",webp:"页面动画WEBP/隐藏动画.webp"},{type:mB,animation:{type:"FollowAnimation",keyframes:[{val:0},{val:1e4}]},title:"路径凝视",icon:"gv-Route",image:"视角动画图片/凝视.png",webp:"视角动画WEBP文件/凝视_00000_iSpt.webp"},{type:cE,animation:{type:"FollowAnimation",keyframes:[{val:0},{val:1e4}]},title:"路径凝视",icon:"gv-Route",image:"视角动画图片/凝视.png",webp:"视角动画WEBP文件/凝视_00000_iSpt.webp"},{type:sI,animation:{type:"FollowAnimation",keyframes:[{val:0},{val:1e4}]},title:"路径凝视",icon:"gv-Route",image:"视角动画图片/凝视.png",webp:"视角动画WEBP文件/凝视_00000_iSpt.webp"},{type:LS,animation:{type:"FollowAnimation",keyframes:[{val:0},{val:1e4}]},title:"路径凝视",icon:"gv-Route",image:"视角动画图片/凝视.png",webp:"视角动画WEBP文件/凝视_00000_iSpt.webp"},{type:JS,animation:{type:"FollowAnimation",keyframes:[{val:0},{val:1e4}]},title:"路径凝视",icon:"gv-Route",image:"视角动画图片/凝视.png",webp:"视角动画WEBP文件/凝视_00000_iSpt.webp"},{type:mB,animation:{type:"SurroundAnimation",keyframes:[{val:0},{val:1e4}]},title:"环绕凝视",icon:"gv-Route",image:"视角动画图片/环绕.png",webp:"视角动画WEBP文件/环绕_00000_iSpt.webp"},{type:cE,animation:{type:"SurroundAnimation",keyframes:[{val:0},{val:1e4}]},title:"环绕凝视",icon:"gv-Route",image:"视角动画图片/环绕.png",webp:"视角动画WEBP文件/环绕_00000_iSpt.webp"},{type:sI,animation:{type:"SurroundAnimation",keyframes:[{val:0},{val:1e4}]},title:"环绕凝视",icon:"gv-Route",image:"视角动画图片/环绕.png",webp:"视角动画WEBP文件/环绕_00000_iSpt.webp"},{type:LS,animation:{type:"SurroundAnimation",keyframes:[{val:0},{val:1e4}]},title:"环绕凝视",icon:"gv-Route",image:"视角动画图片/环绕.png",webp:"视角动画WEBP文件/环绕_00000_iSpt.webp"},{type:JS,animation:{type:"SurroundAnimation",keyframes:[{val:0},{val:1e4}]},title:"环绕凝视",icon:"gv-Route",image:"视角动画图片/环绕.png",webp:"视角动画WEBP文件/环绕_00000_iSpt.webp"},{type:mB,animation:{type:"SpiralAnimation",keyframes:[{val:0},{val:1e4}]},title:"螺旋凝视",icon:"gv-Route",image:"视角动画图片/螺旋.png",webp:"视角动画WEBP文件/螺旋.webp"},{type:cE,animation:{type:"SpiralAnimation",keyframes:[{val:0},{val:1e4}]},title:"螺旋凝视",icon:"gv-Route",image:"视角动画图片/螺旋.png",webp:"视角动画WEBP文件/螺旋.webp"},{type:sI,animation:{type:"SpiralAnimation",keyframes:[{val:0},{val:1e4}]},title:"螺旋凝视",icon:"gv-Route",image:"视角动画图片/螺旋.png",webp:"视角动画WEBP文件/螺旋.webp"},{type:LS,animation:{type:"SpiralAnimation",keyframes:[{val:0},{val:1e4}]},title:"螺旋凝视",icon:"gv-Route",image:"视角动画图片/螺旋.png",webp:"视角动画WEBP文件/螺旋.webp"},{type:JS,animation:{type:"SpiralAnimation",keyframes:[{val:0},{val:1e4}]},title:"螺旋凝视",icon:"gv-Route",image:"视角动画图片/螺旋.png",webp:"视角动画WEBP文件/螺旋.webp"},{isAudio:!0,type:BP,animation:{type:"AudioAnimation",keyframes:[{val:0},{val:3e3}]},title:"音频播放",icon:"gv-Route",image:"视角动画图片/音效.png",webp:"视角动画WEBP文件/螺旋.webp"},{type:null,animation:{type:"CameraSetAnimation",keyframes:[{val:0}]},title:"视角切换",icon:"gp-shijiaoqiehuan",image:"视角动画图片/视角切换.png",webp:"视角动画WEBP文件/视角切换_00000_iSpt.webp"},{type:null,animation:{type:"CameraFlyAnimation",keyframes:[{val:0},{val:1e4}]},title:"视角飞入",icon:"gp-shijiaofeiru",image:"视角动画图片/视角飞入.png",webp:"视角动画WEBP文件/视角飞入_00000_iSpt.webp"},{type:null,animation:{type:"CameraRoamAnimation",keyframes:[{val:0},{val:1e4}]},title:"相机漫游",icon:"gp-lujingmanyou",image:"视角动画图片/相机漫游.png",webp:"视角动画WEBP文件/相机漫游_00000_iSpt.webp"},{type:null,animation:{type:"FollowAnimation",keyframes:[{val:0},{val:1e4}]},title:"路径凝视",icon:"gp-lujingmanyou",image:"视角动画图片/凝视.png",webp:"视角动画WEBP文件/凝视_00000_iSpt.webp"},{type:null,animation:{type:"SurroundAnimation",keyframes:[{val:0},{val:1e4}]},title:"环绕凝视",icon:"gv-Route",image:"视角动画图片/环绕.png",webp:"视角动画WEBP文件/环绕_00000_iSpt.webp"},{type:null,animation:{type:"SpiralAnimation",keyframes:[{val:0},{val:1e4}]},title:"螺旋凝视",icon:"gv-Route",image:"视角动画图片/螺旋.png",webp:"视角动画WEBP文件/螺旋.webp"},{type:JS,animation:{type:"GxModelAnimation",keyframes:[{val:0},{val:3e3}]},title:"骨骼动画",icon:"gv-Plotting",image:"样式动画图片/模型动画.png",webp:"页面动画WEBP/模型.webp"},{type:iR,animation:{type:"ArrowDirectAnimation",keyframes:[{val:0},{val:3e3}]},title:"箭头生长",icon:"gv-Route",image:"样式动画图片/箭头生长.png",webp:"页面动画WEBP/箭头生长.webp"},{type:mB,animation:{type:"TargetFllowAnimation",keyframes:[{val:0},{val:3e3}]},title:"目标跟随",icon:"gv-Route",image:"样式动画图片/目标跟随.png",webp:"页面动画WEBP/目标跟随.webp"},{type:hx,animation:{type:"TargetFllowAnimation",keyframes:[{val:0},{val:3e3}]},title:"目标跟随",icon:"gv-Route",image:"样式动画图片/目标跟随.png",webp:"页面动画WEBP/目标跟随.webp"},{type:JS,animation:{type:"TargetFllowAnimation",keyframes:[{val:0},{val:3e3}]},title:"目标跟随",icon:"gv-Route",image:"样式动画图片/目标跟随.png",webp:"页面动画WEBP/目标跟随.webp"},{isTif:!0,type:Tw,animation:{type:"ShowTifAnimation",keyframes:[{val:0},{val:3e3}],from:0,to:1,property:"alpha",hideValues:["from","to"]},title:"显示",icon:"gv-yanjing_xianshi",image:"样式动画图片/显示动画.png",webp:"页面动画WEBP/显示动画.webp"},{type:nx,animation:{type:"TargetFllowAnimation",keyframes:[{val:0},{val:3e3}]},title:"目标跟随",icon:"gv-Route",image:"样式动画图片/目标跟随.png",webp:"页面动画WEBP/目标跟随.webp"},{type:cE,animation:{type:"TargetFllowAnimation",keyframes:[{val:0},{val:3e3}]},title:"目标跟随",icon:"gv-Route",image:"样式动画图片/目标跟随.png",webp:"页面动画WEBP/目标跟随.webp"},{type:mS,animation:{type:"NumberAnimation",keyframes:[{val:0},{val:3e3}],property:"percentAngle",from:0,to:360,minvalue:0,maxvalue:360},title:"旋转填充",icon:"gv-Route",image:"样式动画图片/旋转填充.png",webp:"页面动画WEBP/旋转填充.webp"},{type:XT,animation:{type:"NumberAnimation",keyframes:[{val:0},{val:3e3}],property:"percentAngle",from:0,to:360,minvalue:0,maxvalue:360},title:"旋转填充",icon:"gv-Route",image:"样式动画图片/旋转填充.png",webp:"页面动画WEBP/旋转填充.webp"},{type:null,animation:{type:"AutoRotationAnimation",keyframes:[{val:0},{val:1e4}]},title:"地球自转",icon:"gp-shijiaoqiehuan",image:"视角动画图片/地球自转.png",webp:"视角动画WEBP文件/地球自转.webp"},{type:null,animation:{type:"ZoomToFlyAnimation",keyframes:[{val:0},{val:1e4}]},title:"缩放至",icon:"gp-shijiaoqiehuan",image:"视角动画图片/缩放至.png",webp:"视角动画WEBP文件/缩放至.webp"}]},e.animationRegister=[AN,CN,Rx,wQ,MQ,PN,FF,Tx,hF,MN,dF,uN,TF,LN,HN,QN,WN,mQ,yQ,LQ,kQ,GN,VH,hQ,iQ,aN,sQ,AF,bF,xF,eN,HQ,UH,ZH,YQ,tF,oF,XF],e.animationList=[],e}(),WQ=i(381),XQ=function(e,t,i,r){return new(i||(i=Promise))((function(n,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?n(e.value):function(e){return e instanceof i?e:new i((function(t){t(e)}))}(e.value).then(s,a)}l((r=r.apply(e,t||[])).next())}))},JQ=function(e,t){var i,r,n,o,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,r&&(n=2&o[0]?r.return:o[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,o[1])).done)return n;switch(r=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(n=s.trys,(n=n.length>0&&n[n.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){s.label=o[1];break}if(6===o[0]&&s.label<n[1]){s.label=n[1],n=o;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(o);break}n[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{i=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},KQ=function(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],r=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},VQ=function(){function e(e){var t,i,r=this;this.takePicture=!1,this.pictureMove=!1,this.refSub$=new th.x,this.pageImage="",this.select$=new th.x,this.startPlay$=new th.x,this.allAnimation=[],this.timelineModeChanged$=new th.x,this.cesiumTimlineZoom$=new th.x,this._showGlobalTimeLine=!1,this.isPaused=!1,this.show=!1,this.isMultiSelect=!1,this.isInitAnimationListWrapper=!1,this.initAnimationListWrapper=new th.x,this.animationListWrapperNode=[],this.getLayersNodeList=new th.x,this.needDetectd$=new th.x,this.needRedraw$=new th.x,this.subjects=[],this.setTimelines$=new th.x,this.sliderMin=.1,this.sliderMax=80,this.stopAnimationSub$=new th.x,this.rePlayPage$=new th.x,this.currentSelected=[],this.animationType=!1,this.needRefresh=!1,this._currentTime=0,this.itemAnimation=[],this.serviceManager=e,this._viewer=e.viewer,ZQ.init();try{for(var n=KQ(ZQ.animationList),o=n.next();!o.done;o=n.next()){var s=o.value;s.animation=Xx.deserializeSingleAnimation(s.animation)}}catch(e){t={error:e}}finally{try{o&&!o.done&&(i=n.return)&&i.call(n)}finally{if(t)throw t.error}}this.onSelectGraph(null);var a=localStorage.getItem("showGlobalTimeLine");this.showGlobalTimeLine="true"==a,this.initAnimationListWrapper.pipe((0,jR.b)(300)).subscribe((function(){r.isInitAnimationListWrapper=!0,r.getLayersNodeList.next(null);var e=[];r.animationListWrapperNode.length&&(r.animationListWrapperNode.forEach((function(t,i){e=0===i?r.initAnimationList(t.origin.entity):r.intersectTwoArr(e,r.initAnimationList(t.origin.entity))})),r.animationType=!0,r.itemAnimation=e),r.isInitAnimationListWrapper=!1}))}return Object.defineProperty(e.prototype,"showGlobalTimeLine",{get:function(){return this._showGlobalTimeLine},set:function(e){this._showGlobalTimeLine=e,localStorage.setItem("showGlobalTimeLine",e?"true":"false"),this.timelineModeChanged$.next(1),this.cesiumTimlineZoom$.next(1)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"component",{get:function(){return this._component},set:function(e){var t=this;this._component=e,this.component.startAllPause.subscribe((function(e){t.isPaused=!0}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"selectTimeLine",{get:function(){return this._selectTimeLine},set:function(e){var t,i,r=this;if(this.select$.next(e),this.subjects.forEach((function(e){e.unsubscribe()})),this.subjects=[],this._selectTimeLine&&(this._selectTimeLine instanceof Array?this._selectTimeLine.forEach((function(e){return e.selected=!1})):this._selectTimeLine.selected=!1),this._selectTimeLine=e,this._selectTimeLine)if(this._selectTimeLine instanceof Array)this._selectTimeLine.forEach((function(e){var t,i;e.selected=!0;try{for(var n=KQ(e.keyframes),o=n.next();!o.done;o=n.next()){var s=o.value;r.subjects.push(s.valueChanged.subscribe((function(e){r.needRedraw$.next(1)})))}}catch(e){t={error:e}}finally{try{o&&!o.done&&(i=n.return)&&i.call(n)}finally{if(t)throw t.error}}}));else{this._selectTimeLine.selected=!0;try{for(var n=KQ(this._selectTimeLine.keyframes),o=n.next();!o.done;o=n.next()){var s=o.value;this.subjects.push(s.valueChanged.subscribe((function(e){r.needRedraw$.next(1)})))}}catch(e){t={error:e}}finally{try{o&&!o.done&&(i=n.return)&&i.call(n)}finally{if(t)throw t.error}}}this.needRedraw$.next(1)},enumerable:!1,configurable:!0}),e.prototype.onSelectGraph=function(e){this.initAnimationList(e)},e.prototype.initAnimationList=function(e){var t,i;if(!this.isMultiSelect||this.isInitAnimationListWrapper){if(this.needDetectd$.next(1),e){if(e instanceof Tw&&!e.isAni)return;var r=[];try{for(var n=KQ(ZQ.animationList),o=n.next();!o.done;o=n.next()){var s=o.value;if((!(e instanceof wE||e instanceof IE)||"ColorAnimation"!=s.animation.type)&&(!(e instanceof ZM&&"ForwardAnimation"==s.animation.type)&&null!=s.type&&e instanceof s.type)){if(s.animation instanceof Tx&&!e[s.animation.property]&&0!=e[s.animation.property])continue;r.push(s)}}}catch(e){t={error:e}}finally{try{o&&!o.done&&(i=n.return)&&i.call(n)}finally{if(t)throw t.error}}if(e instanceof YE){var a=r.findIndex((function(e){return"颜色渐变"===e.title}));a>-1&&r.splice(a,1)}return this.animationType=!0,this.itemAnimation=r,r}var l=ZQ.animationList.filter((function(e){return null==e.type||null==e.type}));return this.itemAnimation=l,this.animationType=!1,l}this.initAnimationListWrapper.next(null)},e.prototype.cloneAnimation=function(e){var t=Xx.serializeSingleAnimation(e),i=e.type,r=JSON.stringify(t),n=JSON.parse(r);return n.type=i,n=Xx.deserializeSingleAnimation(n)},e.prototype.loadFromGm=function(){var e=[],t=this.serviceManager.plotService.gm.animationManager.animationGroupList;this.animationGroupList=t;for(var i=ZQ.animationList.filter((function(e){return e.animation})),r=0;r<t.length;r++){for(var n=[],o=function(e){var o=t[r].animationList[e],s=i.find((function(e){return e.animation.type===o.type}));s&&(o.image=s.image),n.push(o)},s=0;s<t[r].animationList.length;s++)o(s);e.push(n)}this.allAnimation=e,this.needDetectd$.next(1)},Object.defineProperty(e.prototype,"currentTime",{get:function(){return this._currentTime},set:function(e){this._currentTime=e},enumerable:!1,configurable:!0}),e.prototype.rebuildAnimation=function(){var e,t,i,r;if(!this.serviceManager.plotService.gm)return!1;this.stopAnimatin();var n=this.serviceManager.plotService.gm.animationManager.animationGroupList.map((function(e){return e.offsetSeconds}));if(this.populationLayer?(this.serviceManager.plotService.gm.animationManager.animationGroupList=[],this.serviceManager.plotService.gm.animationManager.add(this.populationGroup)):this.serviceManager.plotService.gm.animationManager.animationGroupList=[],this.allAnimation){var o=0;try{for(var s=KQ(this.allAnimation),a=s.next();!a.done;a=s.next()){var l=a.value,h=new kx;h.offsetSeconds=n[o]&&!this.serviceManager.plotService.gm.animationManager.animationGroupList.includes(this.populationGroup)?n[o]:0==o?0:this.serviceManager.plotService.gm.animationManager.animationGroupList[o-1].offsetSeconds+2,o++,this.serviceManager.plotService.gm.animationManager.add(h);try{for(var c=(i=void 0,KQ(l)),u=c.next();!u.done;u=c.next()){var p=u.value;if(LP.isNullOrEmpty(p.label))return!1;h.add(p)}}catch(e){i={error:e}}finally{try{u&&!u.done&&(r=c.return)&&r.call(c)}finally{if(i)throw i.error}}}}catch(t){e={error:t}}finally{try{a&&!a.done&&(t=s.return)&&t.call(s)}finally{if(e)throw e.error}}}return this.serviceManager.plotService.gm.animationManager.initAnimationTime(new Date(this.pageTime)),!0},e.prototype.startPlay=function(e){var t=this;if(this.pageTime=e.pageTime,this.isPaused)this._viewer.clock.shouldAnimate=!0;else{var i=this.serviceManager.engine.sceneManager.gm.animationManager;i.currentIndex=0,this.startPlay$.next(1),this.rebuildAnimation();var r=0;this.serviceManager.plotService.plotEnable(!0),i.animationGroupList.length>0?(i.start(new Date(e.pageTime)),this.cesiumTimlineZoom$.next(1),this.listener=function(){var e=i.animationGroupList[i.currentIndex];if(!e)return t._viewer.clock.onTick.removeEventListener(t.listener),t.listener=null,t.currentTime=0,t.isPaused=!1,void(t.needRefresh=!1);var n=t._viewer.clock.currentTime.secondsOfDay-i.baseTimeLine.secondsOfDay-e.beginTime;r=n,t.currentTime=r},this._viewer.clock.onTick.addEventListener(this.listener),this.needRefresh=!0):setTimeout((function(){}))}},e.prototype.stopAnimatin=function(){return XQ(this,void 0,void 0,(function(){return JQ(this,(function(e){switch(e.label){case 0:return this.isPaused=!1,this._viewer.clock.onTick.removeEventListener(this.listener),this.serviceManager.plotService.gm?[4,this.serviceManager.plotService.gm.animationManager.stop()]:[3,2];case 1:e.sent(),this.currentTime=0,this._viewer.clock.shouldAnimate=!1,this.serviceManager.plotService.plotEnable(!1),e.label=2;case 2:return[2]}}))}))},e.prototype.stopTimelineAni=function(){this.component.stopAnimation()},e.prototype.deleteAnimationByTargetIdHtml=function(e){var t,i,r,n,o=!1;try{for(var s=KQ(this.allAnimation),a=s.next();!a.done;a=s.next()){var l=a.value;try{for(var h=(r=void 0,KQ(l)),c=h.next();!c.done;c=h.next()){var u=c.value;if(u instanceof FH&&u.htmlElementId===e){ty.Remove(l,u),o=!0,0===l.length&&ty.Remove(this.allAnimation,l);break}}}catch(e){r={error:e}}finally{try{c&&!c.done&&(n=h.return)&&n.call(h)}finally{if(r)throw r.error}}if(o)break}}catch(e){t={error:e}}finally{try{a&&!a.done&&(i=s.return)&&i.call(s)}finally{if(t)throw t.error}}this.needRedraw$.next(1)},e.prototype.getAnimationByTargetIdHtml=function(e){var t,i,r,n,o;try{for(var s=KQ(this.allAnimation),a=s.next();!a.done;a=s.next()){var l=a.value;try{for(var h=(r=void 0,KQ(l)),c=h.next();!c.done;c=h.next()){var u=c.value;if(u instanceof FH&&u.htmlElementId===e){o=u;break}}}catch(e){r={error:e}}finally{try{c&&!c.done&&(n=h.return)&&n.call(h)}finally{if(r)throw r.error}}if(o)break}}catch(e){t={error:e}}finally{try{a&&!a.done&&(i=s.return)&&i.call(s)}finally{if(t)throw t.error}}return o},e.prototype.addSubtitleAnimation=function(e){var t=this.cloneAnimation(e.animation);t.image=e.image,t.title=e.title,1===t.keyframes.length&&(t.keyframes[0].shape="point");var i=[].concat.apply([],this.allAnimation);if(t.label=OP.createEntityName(e.title,i.map((function(e){return e.label}))),t.id=xw.v4(),this.showGlobalTimeLine=!1,this.allAnimation.length>0){var r=this.allAnimation.length;this.allAnimation[r-1].push(t)}else this.allAnimation.push([t])},e.prototype.addPopulationLayer=function(){var e=new Date("2005-06-01"),t=new Date("2020-06-16"),i=Cesium.TimeIntervalCollection.fromIso8601({iso8601:"".concat(WQ(e).format("YYYY-MM-DD"),"/").concat(WQ(t).format("YYYY-MM-DD"),"/P1Y"),leadingInterval:!0,trailingInterval:!0,isStopIncluded:!1,dataCallback:function(e,t){return{Time:0===t?Cesium.JulianDate.toIso8601(e.stop):Cesium.JulianDate.toIso8601(e.start)}}}),r=new Cesium.WebMapTileServiceImageryProvider({url:"https://192.168.160.230:8082/2016-08-15/proxy/svc_container_dynamic_raster/fc_gtiff_cog/cog/timeseries/population/{TileMatrix}/{TileCol}/{TileRow}?datatime={Time}&scale=1&TileMatrixSetId=WebMercatorQuad&resampling_method=nearest&rescale=0%2C577&return_mask=true&colormap_name=coolwarm",layer:"AMSR2_Snow_Water_Equivalent",style:"default",tileMatrixSetID:"2km",maximumLevel:15,format:"image/png",clock:this._viewer.clock,times:i,dimensions:{Layer:"AMSR2_Snow_Water_Equivalent",best:"best"}}),n=Cesium.JulianDate.fromDate(e),o=Cesium.JulianDate.fromDate(t);return this._viewer.clock.startTime=n.clone(),this._viewer.clock.currentTime=n.clone(),this._viewer.clock.stopTime=o.clone(),this.populationLayer=this._viewer.imageryLayers.addImageryProvider(r),{type:null,animation:{type:"PopulationTimeAnimation",keyframes:[{val:e.getTime()-(new Date).getTime()},{val:t.getTime()-e.getTime()}]},title:"人口时序",icon:"",image:"",webp:"",start:e,end:t}},e.prototype.removePopulationLayer=function(){this.populationLayer&&(this._viewer.imageryLayers.remove(this.populationLayer),this.populationLayer=null)},e.prototype.intersectTwoArr=function(e,t){return e.filter((function(e){return t.some((function(t){return t.title===e.title}))}))},e}(),qQ=i(8631),$Q=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),ek=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},tk=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},ik=function(){function e(){this.id=(0,xw.v4)(),this.draws=[],this.updateTime=new Date,this.del=!0,this.star=!1,this.share=!1,this.isDelt=!1,this.isEdited=!1,this.autoPlayTime=5,this.isSaved=!1,this.isPublish=!1}return ek([(0,qQ.w)((function(e){var t=e.value;return new Date(t)}),{toClassOnly:!0}),tk("design:type",Date)],e.prototype,"createTime",void 0),ek([(0,qQ.w)((function(e){var t=e.value;return new Date(t)}),{toClassOnly:!0}),tk("design:type",Date)],e.prototype,"updateTime",void 0),e}(),rk=function(){function e(){this.id=(0,xw.v4)(),this.draws=[],this.star=!1,this.share=!1,this.autoPlayTime=5,this.downCount=0,this.praiseCount=0,this.seeCount=0,this.isDel=!1}return Object.defineProperty(e.prototype,"isEdited",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"updateTime",{get:function(){return new Date},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isSaved",{get:function(){return!0},set:function(e){},enumerable:!1,configurable:!0}),ek([(0,qQ.w)((function(e){var t=e.value;return new Date(t)}),{toClassOnly:!0}),tk("design:type",Date)],e.prototype,"publishTime",void 0),e}(),nk=function(){function e(){this.del=!0}return ek([dy({name:"id",group:"默认",type:"text",order:1}),tk("design:type",String)],e.prototype,"id",void 0),ek([dy({name:"名称",group:"默认",type:"text",order:1}),tk("design:type",String)],e.prototype,"name",void 0),ek([dy({name:"描述",group:"默认",type:"text",order:2}),tk("design:type",String)],e.prototype,"desc",void 0),ek([dy({name:"名称拼音",group:"默认",type:"text",order:2}),tk("design:type",String)],e.prototype,"pinyin",void 0),ek([dy({name:"等级",group:"默认",type:"text",order:2}),tk("design:type",Number)],e.prototype,"level",void 0),ek([dy({name:"中心位置",group:"默认",type:"text",order:2}),tk("design:type",Object)],e.prototype,"center",void 0),ek([dy({name:"位置",group:"默认",type:"text",order:2}),tk("design:type",Object)],e.prototype,"wkt",void 0),ek([(0,qQ.w)((function(e){var t=e.value;return new Date(t)}),{toClassOnly:!0}),tk("design:type",Date)],e.prototype,"startTime",void 0),ek([(0,qQ.w)((function(e){var t=e.value;return new Date(t)}),{toClassOnly:!0}),tk("design:type",Date)],e.prototype,"endTime",void 0),ek([(0,qQ.w)((function(e){var t=e.value;return new Date(t)}),{toClassOnly:!0}),tk("design:type",Date)],e.prototype,"createTime",void 0),ek([(0,qQ.w)((function(e){var t=e.value;return new Date(t)}),{toClassOnly:!0}),tk("design:type",Date)],e.prototype,"updateTime",void 0),e}(),ok=(function(e){function t(){return e.call(this)||this}$Q(t,e)}(nk),function(){function e(){this.id=(0,xw.v4)(),this.viewBtn=!1,this.viewBtnGroup=!0,this.skyBox=!0,this.skyAtmosphere=!0,this.skyWeather=!1,this.isVector=!1,this.isVector2=!1,this.globe=!1,this.sunLight=!1,this.pageTime=new Date,this.clouds=!0,this.cloudSpead=1,this.isEagle=!1,this.compass=!1,this.terrainShading=!1,this.graticule=!1,this.isFrameRate=!1,this.seaMaterial=!0,this.baseWaterColor="#02386C",this.specularIntensity=1,this.amplitude=3,this.isPlace=!1,this.exaggerValue=1,this.animateType="",this.animateTime=3,this.isAutoSetAnimate=!1}return ek([(0,qQ.w)((function(e){var t=e.value;return new Date(t)}),{toClassOnly:!0}),tk("design:type",Date)],e.prototype,"createTime",void 0),ek([(0,qQ.w)((function(e){var t=e.value;return new Date(t)}),{toClassOnly:!0}),tk("design:type",Date)],e.prototype,"updateTime",void 0),ek([dy({name:"名称",type:"title-name",order:1,subOrder:1,noEmpty:!0,hiddenGroupName:!0}),tk("design:type",String)],e.prototype,"name",void 0),ek([dy({name:"保存按钮",group:"视角",order:2,type:"button2",hiddenGroupName:!0}),tk("design:type",Boolean)],e.prototype,"viewBtn",void 0),ek([dy({name:"视角组",group:"视角",order:3,type:"button3",hiddenGroupName:!0}),tk("design:type",Boolean)],e.prototype,"viewBtnGroup",void 0),ek([dy({name:"星空",group:"效果",subOrder:6,type:"weather",order:2,subGroup:"分组1",hiddenGroupName:!0,subGroupLayout:"column",subGroupHeader:!0}),tk("design:type",Boolean)],e.prototype,"skyBox",void 0),ek([dy({name:"大气",group:"效果",subOrder:6,type:"weather",order:2,subGroup:"分组5",hiddenGroupName:!0,subGroupLayout:"column",subGroupHeader:!0}),tk("design:type",Boolean)],e.prototype,"skyAtmosphere",void 0),ek([dy({name:"雾",group:"效果",subOrder:6,type:"weather",order:2,subGroup:"分组6",hiddenGroupName:!0,subGroupLayout:"column",subGroupHeader:!0}),tk("design:type",Boolean)],e.prototype,"skyWeather",void 0),ek([dy({name:"光照",group:"效果",subOrder:7,type:"weather",order:2,subGroup:"分组4",hiddenGroupName:!0,subGroupLayout:"column",subGroupHeader:!0,showSubGroup:!1}),tk("design:type",Boolean)],e.prototype,"globe",void 0),ek([dy({name:"光照类型",group:"效果",subOrder:7,type:"lightType",order:2,subGroup:"分组4",hiddenGroupName:!0,subGroupLayout:"column",subGroupInline:!0}),tk("design:type",Boolean)],e.prototype,"sunLight",void 0),ek([dy({name:"页面时间",group:"效果",subOrder:7,type:"datePage",order:2}),(0,qQ.w)((function(e){var t=e.value;return new Date(t)}),{toClassOnly:!0}),tk("design:type",Date)],e.prototype,"pageTime",void 0),ek([dy({name:"云层",group:"效果",subOrder:6,type:"weather",order:2,subGroup:"分组2",hiddenGroupName:!0,subGroupLayout:"column",subGroupHeader:!0,showSubGroup:!1}),tk("design:type",Boolean)],e.prototype,"clouds",void 0),ek([dy({name:"云层速率",group:"效果",subOrder:6,type:"cloudLayer",order:2,subGroup:"分组2",hiddenGroupName:!0,subGroupLayout:"column"}),tk("design:type",Number)],e.prototype,"cloudSpead",void 0),ek([dy({name:"鸟瞰图",group:"工具",subOrder:6,type:"weather",order:2,subGroup:"分组1",hiddenGroupName:!0,subGroupLayout:"column",subGroupHeader:!0}),tk("design:type",Boolean)],e.prototype,"isEagle",void 0),ek([dy({name:"指北针",group:"工具",subOrder:8,type:"weather",order:2,subGroup:"分组3",hiddenGroupName:!0,subGroupLayout:"column",subGroupHeader:!0}),tk("design:type",Boolean)],e.prototype,"compass",void 0),ek([dy({name:"地形遮挡",group:"工具",subOrder:8,type:"weather",order:2,subGroup:"分组4",hiddenGroupName:!0,subGroupLayout:"column",subGroupHeader:!0}),tk("design:type",Boolean)],e.prototype,"terrainShading",void 0),ek([dy({name:"经纬网",group:"工具",subOrder:6,type:"weather",order:2,subGroup:"分组5",hiddenGroupName:!0,subGroupLayout:"column",subGroupHeader:!0}),tk("design:type",Boolean)],e.prototype,"graticule",void 0),ek([dy({name:"帧率",group:"工具",subOrder:8,type:"weather",order:2,subGroup:"分组6",hiddenGroupName:!0,subGroupLayout:"column",subGroupHeader:!0}),tk("design:type",Boolean)],e.prototype,"isFrameRate",void 0),ek([dy({name:"海洋",group:"效果",subOrder:9,type:"weather",order:2,subGroup:"分组7",hiddenGroupName:!0,subGroupLayout:"column",subGroupHeader:!0,showSubGroup:!1}),tk("design:type",Boolean)],e.prototype,"seaMaterial",void 0),ek([dy({name:"海水颜色",group:"效果",subOrder:9,type:"seaColor",order:2,subGroup:"分组7",hiddenGroupName:!0,subGroupLayout:"column",subGroupInline:!0}),tk("design:type",String)],e.prototype,"baseWaterColor",void 0),ek([dy({name:"光照亮度",group:"效果",subOrder:9,type:"seaSlider",order:2,max:5,subGroup:"分组7",hiddenGroupName:!0,subGroupLayout:"column"}),tk("design:type",Number)],e.prototype,"specularIntensity",void 0),ek([dy({name:"浪高",group:"效果",subOrder:9,type:"seaText",order:2,subGroup:"分组7",hiddenGroupName:!0,subGroupLayout:"column"}),tk("design:type",Number)],e.prototype,"amplitude",void 0),ek([dy({name:"地形",group:"效果",subOrder:6,type:"weather",order:2,subGroup:"分组3",hiddenGroupName:!0,subGroupLayout:"column",subGroupHeader:!0,showSubGroup:!1}),tk("design:type",Boolean)],e.prototype,"isPlace",void 0),ek([dy({name:"夸张类型",group:"效果",subOrder:6,type:"exaggerType",order:2,subGroup:"分组3",hiddenGroupName:!0,subGroupLayout:"column",subGroupInline:!0}),tk("design:type",Boolean)],e.prototype,"exaggerType",void 0),ek([dy({name:"夸张系数",group:"效果",subOrder:6,type:"exagger",order:2,subGroup:"分组3",hiddenGroupName:!0,subGroupLayout:"column"}),tk("design:type",Number)],e.prototype,"exaggerValue",void 0),e}()),sk=(function(e){function t(){return e.call(this)||this}$Q(t,e)}(ok),function(){this.id="",this.alpha=1,this.saturation=1,this.contrast=1,this.brightness=1,this.hue=0,this.gamma=1,this.currentLevel=0});!function(e){e[e.Wechat=1]="Wechat",e[e.QQ=2]="QQ",e[e.Weibo=3]="Weibo"}(GF||(GF={})),function(e){e.Phone="Phone",e.Account="Account",e.Mail="Mail"}(zF||(zF={}));var ak=i(9307),lk=i.n(ak),hk=i(8764),ck=i(5108),uk=function(){function e(e){this.viewer=e,this.notice$=new th.x,this.openPage$=new th.x,this.judgeArrowSub$=new th.x,this.sceneList=[],this.currentPlotList=[],this.testList=[],this.alpha=.1,this.init$=new th.x,this.count=1,this.open$=new th.x,this.import$=new th.x,this.mergeScene$=new th.x,this.openCompleted=new th.x,this.resolutionChanged$=new th.x,this.pageLoadCompleted$=new th.x,this.scene$=new th.x,this.refresh$=new th.x,this.changeList=[],this.notify$=new th.x,this.init=!0,this.recoverScene$=new th.x,this.defaultSceneWidth=1366,this.defaultSceneHeight=768,this._viewer=e,this.manager=new(lk())}return e.prototype.addScene=function(e,t,i){var r=new ik;return"string"!=typeof e&&e.length>=0?r.name=this.genAddSceneName("新场景",e):"string"==typeof e&&(r.name=e||"新场景"),r.type="scene",r.draws=[],r.width=t||this.defaultSceneWidth,r.height=i||this.defaultSceneHeight,this.sceneList.unshift(r),r},e.prototype.genAddSceneName=function(e,t){for(var i=1,r=function(){var r="".concat(e).concat(i);if(null==t.find((function(e){return e==r})))return{value:r};i++};;){var n=r();if("object"==typeof n)return n.value}},e.prototype.convertPageImage=function(e){if(e.url)return e.url;var t=hk.lW.allocUnsafe(e.image.data.length);return t.fill(e.image.data,0),"data:image/jpeg;base64,"+t.toString("base64")},e.prototype.initScene=function(){this.scene=new ik,this.scene.name="新场景".concat(this.count++),this.scene.type="scene",this.scene.draws=[]},e.prototype.drawPoint=function(e){var t={id:xw.v4(),kind:"Point",name:"点",position:e,point:{color:Cesium.Color.RED,pixelSize:10}};this._viewer.entities.add(t);return t},e.prototype.savePlot=function(e,t,i,r){if(this.scene&&this.plotList){var n=new nk;n.id=e.id,n.ownerId=this.scene.id;var o=this._viewer.scene.globe.ellipsoid;if("point"==t){var s=o.cartesianToCartographic(e.position),a=Cesium.Math.toDegrees(s.latitude),l=Cesium.Math.toDegrees(s.longitude),h=s.height;n.name=e.name,n.entity={type:"Point",coordinates:[l,a,h]}}"line"==t&&r&&(n.entity={type:"LineString",coordinates:i},n.name="线".concat(this.count++)),"polygon"==t&&r&&(n.entity={type:"Polygon",coordinates:[i]},n.name="面".concat(this.count++)),n.type=t,this.plotList||(this.plotList=[]);var c=this.plotList.length;return this.create(c,n),this.refresh$.next(!0),n}},e.prototype.remove=function(e){},e.prototype.add=function(e,t){},e.prototype.create=function(e,t){var i=this;this.add(e,t),this.manager.add({undo:function(){i.remove(e)},redo:function(){i.add(e,t)}}),ck.log("添加",this.plotList)},e.prototype.transormFromGraphManager=function(e){var t=e.draws.find((function(e){return"graph"==e.type}));return t||((t=new nk).type="graph",e.draws.push(t)),t.ext=e.ext,t},e.prototype.transformToGraphManager=function(e){var t=e.draws.find((function(e){return"graph"==e.type}));return t&&(e.ext=t.ext),ty.Remove(e.draws,t),t},e.prototype.transformFromEntity=function(e){var t=[];return ck.log("arr",e),e.map((function(e){var i=new nk;Object.defineProperties(i,{name:{value:e.name,writable:!0,enumerable:!0},type:{value:e.type,writable:!0,enumerable:!0},entity:{value:e.geometry,writable:!0,enumerable:!0},style:{value:e.style,writable:!0,enumerable:!0}}),t.push(i)})),ck.log("wwww",t),t},e.prototype.delete=function(e){window.event?e.keyCode:e.which},e.prototype.sceneEdited=function(){!this.scene||this.scene instanceof rk||this.scene.isEdited||(this.scene.isEdited=!0)},e.prototype.removeSceneEditFlag=function(){!this.scene||this.scene instanceof rk||(this.scene.isEdited=!1)},e}();function pk(e,t){e=e||{},this._tilingScheme=e.tilingScheme||new Cesium.GeographicTilingScheme,this._color=e.color||new Cesium.Color(1,1,1,.4),this._tileWidth=e.tileWidth||256,this._tileHeight=e.tileHeight||256,this._ready=!0,this._sexagesimal=e.sexagesimal||!1,this._numLines=e.numLines||50,this._scene=t,this._labels=new Cesium.LabelCollection,t.primitives.add(this._labels),this._polylines=new Cesium.PolylineCollection,t.primitives.add(this._polylines),this._ellipsoid=t.globe.ellipsoid;var i=document.createElement("canvas");i.width=256,i.height=256,this._canvas=i;var r=this;t.camera.moveEnd.addEventListener((function(){r._show&&(r._polylines.removeAll(),r._labels.removeAll(),r._currentExtent=null,r._drawGrid(r._getExtentView()))})),t.imageryLayers.addImageryProvider(this)}var dk=function(){try{return"x"in Object.defineProperty({},"x",{})}catch(e){return!1}}(),mk=Object.defineProperties;function fk(e){return e<.01?2:e<.1?1:0}dk&&mk||(mk=function(e){return e}),mk(pk.prototype,{url:{get:function(){}},proxy:{get:function(){}},tileWidth:{get:function(){return this._tileWidth}},tileHeight:{get:function(){return this._tileHeight}},maximumLevel:{get:function(){return 18}},minimumLevel:{get:function(){return 0}},tilingScheme:{get:function(){return this._tilingScheme}},rectangle:{get:function(){return this._tilingScheme.rectangle}},tileDiscardPolicy:{get:function(){}},errorEvent:{get:function(){return this._errorEvent}},ready:{get:function(){return this._ready}},credit:{get:function(){return this._credit}},hasAlphaChannel:{get:function(){return!0}}}),pk.prototype.makeLabel=function(e,t,i,r,n){this._labels.add({position:this._ellipsoid.cartographicToCartesian(new Cesium.Cartographic(e,t,10)),text:i,font:"16px Helvetica",style:Cesium.LabelStyle.FILL_AND_OUTLINE,fillColor:Cesium.Color.AZURE,outlineColor:Cesium.Color.BLACK,outlineWidth:2,pixelOffset:new Cesium.Cartesian2(5,r?18:-18),eyeOffset:Cesium.Cartesian3.ZERO,horizontalOrigin:Cesium.HorizontalOrigin.LEFT,verticalOrigin:r?Cesium.VerticalOrigin.BOTTOM:Cesium.VerticalOrigin.TOP,scale:1})},pk.prototype._drawGrid=function(e){if(!this._currentExtent||!this._currentExtent.equals(e)){this._currentExtent=e,this._polylines.removeAll(),this._labels.removeAll();this._canvasSize;var t,i=0,r=0;for(t=0;t<gk.length&&i<(e.north-e.south)/10;t++)i=gk[t];for(t=0;t<gk.length&&r<(e.east-e.west)/10;t++)r=gk[t];var n=(e.west<0?Math.ceil(e.west/r):Math.floor(e.west/r))*r,o=(e.south<0?Math.ceil(e.south/i):Math.floor(e.south/i))*i,s=(e.east<0?Math.ceil(e.east/i):Math.floor(e.east/i))*i,a=(e.north<0?Math.ceil(e.north/r):Math.floor(e.north/r))*r;n=Math.max(n-2*r,-Math.PI),s=Math.min(s+2*r,Math.PI),o=Math.max(o-2*i,-Math.PI/2),a=Math.min(a+2*r,Math.PI/2);var l,h,c=this._ellipsoid,u=Cesium.Math.toRadians(1),p=o+Math.floor((a-o)/i/2)*i;for(h=n;h<s;h+=r){var d=[];for(l=o;l<a;l+=u)d.push(new Cesium.Cartographic(h,l));d.push(new Cesium.Cartographic(h,a)),this._polylines.add({positions:c.cartographicArrayToCartesianArray(d),width:1});var m=Cesium.Math.toDegrees(h);this.makeLabel(h,p,this._sexagesimal?this._decToSex(m):m.toFixed(fk(r)),!1)}var f=n+Math.floor((s-n)/r/2)*r;for(l=o;l<a;l+=i){d=[];for(h=n;h<s;h+=u)d.push(new Cesium.Cartographic(h,l));d.push(new Cesium.Cartographic(s,l)),this._polylines.add({positions:c.cartographicArrayToCartesianArray(d),width:1});var g=Cesium.Math.toDegrees(l);this.makeLabel(f,l,this._sexagesimal?this._decToSex(g):g.toFixed(fk(i)),!0)}}},pk.prototype.requestImage=function(e,t,i){return this._show&&this._drawGrid(this._getExtentView()),this._canvas},pk.prototype.setVisible=function(e){this._show=e,e?(this._currentExtent=null,this._drawGrid(this._getExtentView())):(this._polylines.removeAll(),this._labels.removeAll())},pk.prototype.isVisible=function(){return this._show},pk.prototype._decToSex=function(e){var t=Math.floor(e),i=(60*(Math.abs(e)-t)).toFixed(2);return"60.00"==i&&(t+=1,i="0.00"),[t,":",i].join("")},pk.prototype._getExtentView=function(){for(var e=this._scene.camera,t=this._scene.canvas,i=[e.pickEllipsoid(new Cesium.Cartesian2(0,0),this._ellipsoid),e.pickEllipsoid(new Cesium.Cartesian2(t.width,0),this._ellipsoid),e.pickEllipsoid(new Cesium.Cartesian2(0,t.height),this._ellipsoid),e.pickEllipsoid(new Cesium.Cartesian2(t.width,t.height),this._ellipsoid)],r=0;r<4;r++)if(void 0===i[r])return Cesium.Rectangle.MAX_VALUE;return Cesium.Rectangle.fromCartographicArray(this._ellipsoid.cartesianArrayToCartographicArray(i))};var gk=[];"undefined"!=typeof Cesium&&(gk=Cesium.Math?[Cesium.Math.toRadians(.05),Cesium.Math.toRadians(.1),Cesium.Math.toRadians(.2),Cesium.Math.toRadians(.5),Cesium.Math.toRadians(1),Cesium.Math.toRadians(2),Cesium.Math.toRadians(5),Cesium.Math.toRadians(10)]:[]);const Ak=pk;var yk=function(){function e(e){this.layer=new Ak({},e.scene)}return e.prototype.show=function(){this.layer.setVisible(!0)},e.prototype.remove=function(){this.layer.setVisible(!1)},e}(),vk=i(5108),Ck=function(e,t,i,r){return new(i||(i=Promise))((function(n,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?n(e.value):function(e){return e instanceof i?e:new i((function(t){t(e)}))}(e.value).then(s,a)}l((r=r.apply(e,t||[])).next())}))},_k=function(e,t){var i,r,n,o,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,r&&(n=2&o[0]?r.return:o[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,o[1])).done)return n;switch(r=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(n=s.trys,(n=n.length>0&&n[n.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){s.label=o[1];break}if(6===o[0]&&s.label<n[1]){s.label=n[1],n=o;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(o);break}n[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{i=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},bk=function(){function e(){var e=this;this.CesiumCreated=new th.x,this.viewerLoaded$=new th.x,this.HeightChanged=new th.x,this.navDetectChanges2$=new th.x,this.hideLoadingSub$=new th.x,this.changeUnrealSub$=new th.x,this.isReLoad=!1,this.pageChangeLoading=!1,this.isAnimationPlayOrPause=!1,this.viewChangeSub$=new th.x,this.isZoomAnimation=!0,this.is2D=!1,this.clockMultipliers=[.5,1,1.25,1.5,2],this.isBrowserPageShow=!1,this.isZoomInBtnForbidden=!1,this.isZoomOutBtnForbidden=!1,this.maxZoomHeight=7e7,this.minZoomHeight=1e4,this.floatToolRefSub$=new th.x,this.isCtrlKeyPress=!1,this.isFullScreenPlay=!1,this.anchorRefreshSub$=new th.x,this.isTimelineAtDragging=!1,this.show=!1,this.CesiumCreated.subscribe((function(t){e.viewer=t,e.graticuleLayer=new yk(t),e.viewer.cesiumWidget.showErrorPanel=function(e,t,i){vk.error(e,t,i),alert("Cesium运行错误, 出现底层错误，请删除场景或联系客服解决")},e.viewer.camera.moveEnd.addEventListener((function(){e.viewChangeSub$.next(1)})),e.viewer.scene.postRender.addEventListener((function(t){document.querySelectorAll("[id^=gp-o-board-wrapper-]").forEach((function(t){var i=t.id.slice(19),r=e.getEntityByBoardID(i);if(r){var n=r.position.getValue();if(new Cesium.EllipsoidalOccluder(Cesium.Ellipsoid.WGS84,e.viewer.camera.position).isPointVisible(n)){var o=parseInt(t.dataset.offsetX),s=parseInt(t.dataset.offsetY),a=Cesium.SceneTransforms.wgs84ToWindowCoordinates(e.viewer.scene,n);t.style.top="".concat(Math.ceil(a.y)+o,"px"),t.style.left="".concat(Math.ceil(a.x)+s,"px"),"block"!==t.style.display&&(t.style.display="block");var l=document.querySelector("#board-line-".concat(i));if(l){var h=Math.sqrt(Math.pow(o,2)+Math.pow(s,2));l.style.width="".concat(h,"px");var c=2*Math.PI-Math.asin(o/h);s>0&&(c=Math.PI-c),l.style.transform="rotate(".concat(c,"rad)")}}else t.style.display="none"}}))}))})),this.clickHandler=function(e){"app-scenario"===e.target.nodeName.toLowerCase()&&vk.error("请退出预览模式")},Vy.cesService=this}return e.prototype.SetTerrain=function(e){var t=0;switch(e){case 1:this.viewer.terrainProvider=new Cesium.CesiumTerrainProvider({url:window.config.terrain}),t=1;break;case 2:this.viewer.terrainProvider=new Cesium.CesiumTerrainProvider({url:window.config.globalTerrain}),t=2;break;default:this.viewer.terrainProvider instanceof Cesium.EllipsoidTerrainProvider||(this.viewer.terrainProvider=new Cesium.EllipsoidTerrainProvider({ellipsoid:Cesium.Ellipsoid.WGS84})),t=0}return t},e.prototype.SetWater=function(e){return Ck(this,void 0,void 0,(function(){var t;return _k(this,(function(i){switch(i.label){case 0:return this.sea?(this.sea.show=e,[3,3]):[3,1];case 1:return e?[4,of.Render(this.viewer.scene)]:[3,3];case 2:(t=i.sent())&&(this.sea=t),i.label=3;case 3:return[2]}}))}))},e.prototype.getWmsLayer=function(){return{layers:"IMG_IDB-JPEG-4326",url:"http://192.168.3.126:8310/tilecache/service/wms",tileWidth:256,tileHeight:256,parameters:{format:"image/jpeg"},enablePickFeatures:!1}},e.prototype.toDegrees=function(e){var t=Cesium.Cartographic.fromCartesian(e);if(t)return[t.longitude/Math.PI*180,t.latitude/Math.PI*180]},e.prototype.flyToHome=function(){var e;null===(e=this.viewer)||void 0===e||e.camera.flyHome()},e.prototype.addNotAllowedCursor=function(){document.body.style.cursor="not-allowed",document.querySelector(".scenario-wrapper").style.pointerEvents="none",document.querySelector(".appcontent-ele").style.cursor="default";var e=document.querySelector(".multiplier-select .anticon");e&&(e.style.pointerEvents="none",e.style.cursor="default"),this.isAnimationPlayOrPause=!0,document.body.addEventListener("click",this.clickHandler)},e.prototype.removeNotAllowedCursor=function(){var e=this;document.body.style.cursor="",document.querySelector(".scenario-wrapper").style.pointerEvents="all",document.querySelector(".appcontent-ele").style.cursor="auto",setTimeout((function(){e.isAnimationPlayOrPause=!1}),200),document.body.removeEventListener("click",this.clickHandler);var t=document.querySelector(".multiplier-select .anticon");t&&(t.style.pointerEvents="all",t.style.cursor="auto")},e.prototype.showPageLoading=function(){this.pageChangeLoading=!0,document.querySelector(".page-loading").style.display="flex"},e.prototype.hidePageLoading=function(){this.pageChangeLoading=!1,document.querySelector(".page-loading").style.display="none"},e.prototype.zoomInMap=function(){var e=this.minZoomHeight;if(this.viewer){var t=this.viewer.camera.positionCartographic;this.viewer.camera.flyTo({destination:Cesium.Cartesian3.fromRadians(t.longitude,t.latitude,t.height/1.4<e?e:t.height/1.4),orientation:{direction:this.viewer.camera.direction,up:this.viewer.camera.up},duration:.3})}},e.prototype.getPick=function(e){var t;if(this.viewer.scene.mode==Cesium.SceneMode.SCENE3D){var i=this.viewer.camera.getPickRay(e);t=this.viewer.scene.globe.pick(i,this.viewer.scene)}else t=this.viewer.scene.camera.pickEllipsoid(e);return t},e.prototype.zoomInMapByScreenPosition=function(e){var t=this.calculateZoomInBastView(e);this.viewer.camera.flyTo({destination:t.destination,orientation:t.orientation,duration:1})},e.prototype.calculateZoomInBastView=function(e){var t=Cesium.Math,i=new Cesium.Cartesian3,r=new Cesium.Cartesian3,n=new Cesium.Cartesian3,o=new Cesium.Cartesian3,s=new Cesium.Cartesian3,a=new Cesium.Cartesian3,l=new Cesium.Cartesian3,h=new Cesium.Cartesian3,c=new Cesium.Cartesian3,u=new Cesium.Cartesian3,p=new Cesium.Cartesian3,d=new Cesium.Cartesian3,m={orientation:new Cesium.HeadingPitchRoll},f=this.viewer.camera.positionCartographic.height/1.4,g=this.viewer.camera,A=m.orientation;A.heading=g.heading,A.pitch=g.pitch,A.roll=g.roll;var y=this.getPick(e),v=Cesium.Cartesian3.normalize(g.position,i),C=r;Cesium.Cartesian3.clone(g.position,C);var _=y,b=c,w=s;Cesium.Cartesian3.clone(g.direction,w),Cesium.Cartesian3.add(C,Cesium.Cartesian3.multiplyByScalar(w,f,u),b);var P=a,S=l;Cesium.Cartesian3.subtract(_,C,P),Cesium.Cartesian3.normalize(P,S);var x=Cesium.Cartesian3.dot(v,S),B=Math.acos(-x),M=Cesium.Cartesian3.magnitude(C),E=Cesium.Cartesian3.magnitude(_),T=M-f,O=Cesium.Cartesian3.magnitude(P),L=Math.asin(t.clamp(O/E*Math.sin(B),-1,1))-Math.asin(t.clamp(T/E*Math.sin(B),-1,1))+B,D=n;Cesium.Cartesian3.normalize(C,D);var I=o;I=Cesium.Cartesian3.cross(S,D,I),I=Cesium.Cartesian3.normalize(I,I),Cesium.Cartesian3.normalize(Cesium.Cartesian3.cross(D,I,u),w),Cesium.Cartesian3.multiplyByScalar(Cesium.Cartesian3.normalize(b,u),Cesium.Cartesian3.magnitude(b)-f,b),Cesium.Cartesian3.normalize(C,C),Cesium.Cartesian3.multiplyByScalar(C,T,C);var R=h;if(Cesium.Cartesian3.multiplyByScalar(Cesium.Cartesian3.add(Cesium.Cartesian3.multiplyByScalar(D,Math.cos(L)-1,p),Cesium.Cartesian3.multiplyByScalar(w,Math.sin(L),d),u),T,R),Cesium.Cartesian3.add(C,R,C),Cesium.defined(this.screenSpaceCameraController)){var H=this.screenSpaceCameraController;if(H.enableAutoPitch){var F=this.viewer.camera.positionCartographic.height;if(F<=H.autoPitchStartHeight){var N=F/H.autoPitchStartHeight,Q=H.autoPitchMinAngle+(H.autoPitchMaxAngle-H.autoPitchMinAngle)*N;m.orientation.pitch=Cesium.Math.toRadians(-Q)}}}return{destination:C,orientation:m.orientation}},e.prototype.zoomOutMap=function(){var e=this.maxZoomHeight;if(this.viewer){var t=this.viewer.camera.positionCartographic;this.viewer.camera.flyTo({destination:Cesium.Cartesian3.fromRadians(t.longitude,t.latitude,1.4*t.height>e?e:1.4*t.height),orientation:{direction:this.viewer.camera.direction,up:this.viewer.camera.up},duration:.3})}},e.prototype.setZoomAnimation=function(e){this.isMobileAgent()?vk.error("移动端不支持该功能"):(this.viewer.scene.screenSpaceCameraController._aggregator=e?this.userCacheSSCC:this.cacheSSCC,this.viewer.scene._screenSpaceCameraController._aggregator.reset(),localStorage.setItem("cameraZoomAnimation",e))},e.prototype.isMobileAgent=function(){return/Android|webOS|iPhone|iPod|BlackBerry/i.test(navigator.userAgent)},e.prototype.change2D=function(){var e=this,t=this.viewer.scene.camera.positionCartographic.clone(),i=this.viewer.camera.heading,r=this.viewer.camera.pitch,n=this.viewer.camera.roll;this.viewer.scene.morphTime=0;var o=function(){e.viewer.camera.setView({destination:Cesium.Cartesian3.fromRadians(t.longitude,t.latitude,t.height),orientation:{heading:i,pitch:r,roll:n}}),e.viewer.scene.morphComplete.removeEventListener(o)};this.viewer.scene.morphComplete.addEventListener(o),this.is2D?(this.viewer.scene.morphTo3D(),this.is2D=!1):(this.viewer.scene.morphTo2D(),this.is2D=!0)},e.prototype.changeMultiplier=function(e){this.viewer.clock.multiplier=Number(e),Gx.multiplier=this.viewer.clock.multiplier},e.prototype.getEntityByBoardID=function(e){for(var t=this.viewer.entities._entities._array,i=0;i<t.length;i++){if(t[i].graph&&t[i].graph.graphBoardId===e)return t[i];if(t[i].id===e)return t[i]}},e.prototype.getEntityByGraphID=function(e){var t;return null===(t=ey.getGraph(e))||void 0===t?void 0:t.ent},e}(),wk=i(1306),Pk=i.n(wk),Sk=i(5108),xk=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},Bk=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Mk=function(){function e(t,i,r,n,o,s,a,l,h){void 0===a&&(a=[]),void 0===l&&(l=""),void 0===h&&(h="");var c=this;this.options=[],this.error=!1,this.nameArr=new Array({}),this.isbeginChange=!1,this.oldValue=void 0,this.propertysub=new th.x,this.name=t,this.type=i,this.group=r,this.subGroup=n,this.title=s,this.element=o,this.options=a,this.min=l,this.max=h,this.propertysub.pipe((0,jR.b)(200)).subscribe((function(t){c.oldValue!=c.value&&(e.ProperyChanged.next({target:c,oldvalue:c.oldValue,newvalue:c.value}),c.isbeginChange=!1,c.oldValue=void 0)}))}return Object.defineProperty(e.prototype,"value",{get:function(){if("innerHtml"===this.name)return this._value;if("color"===this.type){if(!this._value)return"#FFFFFFF";if(this._value.startsWith("rgb"))return Pk()(this._value).hex}return this._value},set:function(e){this._value;if(this.min){var t=Number.parseFloat(e);if(isNaN(t)||t<Number.parseFloat(this.min))return Sk.log("属性错误",this.name,e),void(this.error=!0);this.error=!1}if(this.max){t=Number.parseFloat(e);if(isNaN(t)||t>Number.parseFloat(this.max))return Sk.log("属性错误",this.name,e),void(this.error=!0);this.error=!1}switch(this._value=e,this.name){case"innerHtml":this.element.innerHTML=e.replace(/\n/g,"<br>").replace(/\s/g,"&nbsp;");break;case"display":this.element.style[this.name]=!1===e?"none":"inline";break;case"isReadOnly":this.element.draggable=!0===e;break;case"top":this.element.style[this.name]=e+"px",this.element.style.bottom="unset";break;case"left":this.element.style[this.name]=e+"px",this.element.style.right="unset";break;case"bottom":this.element.style[this.name]=e+"px",this.element.style.top="unset";break;case"right":this.element.style[this.name]=e+"px",this.element.style.left="unset";break;case"position":this.element.style.left=e[0]+"px",this.element.style.top=e[1]+"px";break;case"height":case"width":case"border-width":case"line-height":case"padding-top":case"padding-left":case"padding-right":case"padding-bottom":case"padding":case"-webkit-text-stroke-width":case"font-size":this.element.style[this.name]=e+"px";break;case"font-weight":this.element.style[this.name]="正常"==e?"normal":"bold";break;case"font-family":default:this.element.style[this.name]=e;break;case"text-align-last":switch(e){case"gp-wenbenzuoduiqi":this.element.style[this.name]="left";break;case"gp-wenbenjuzhongduiqi":this.element.style[this.name]="center";break;case"gp-wenbenyouduiqi":this.element.style[this.name]="right";break;case"gp-wenbenquanbuduiqi":this.element.style[this.name]="justify";break;default:this.element.style[this.name]=e}break;case"text-align-vertical":var i=Number.parseInt(getComputedStyle(this.element).height),r=Number.parseInt(getComputedStyle(this.element)["font-size"]);switch(e){case"center":this.element.style["line-height"]=i+"px";break;case"top":this.element.style["line-height"]=r+"px";break;case"bottom":this.element.style["line-height"]=2*i-r+"px"}break;case"background-opacity":var n=getComputedStyle(this.element)["background-color"].split(","),o=n[0].slice(n[0].indexOf("(")+1),s=Number.parseInt(n[2]),a="rgba(".concat(o,",").concat(n[1],",").concat(s,",").concat(e,")");this.element.style["background-color"]=a;break;case"background-color":var l=1,h=getComputedStyle(this.element)["background-color"].split(",");4===h.length&&(l=Number.parseFloat(h[3]));var c=(255*l).toString(16);c.indexOf(".")>-1&&(c=c.split(".")[0]),this.element.style["background-color"]=e+c;break;case"background-size":switch(e){case"填充":this.element.style["background-size"]="cover";break;case"适应":this.element.style["background-size"]="contain";break;default:this.element.style["background-size"]="auto"}break;case"background-image":this.element.style["background-image"]='url("'.concat(e,'")');break;case"color":this.element.style[this.name]=e,this.element.style["-webkit-text-fill-color"]=e}},enumerable:!1,configurable:!0}),e.prototype.saveLocal=function(e){var t=this.target.classType+"-";-1===["top","bottom","right","left","height","width","innerHtml","background-image"].indexOf(this.name)&&("line-height"===this.name?localStorage.setItem(t+this.name,this.element.style[this.name]):localStorage.setItem(t+this.name,this._value)),this.target&&!this.target.isOperating&&(this.isbeginChange||(this.isbeginChange=!0,this.oldValue=e),this.target.isInit||this.propertysub.next(1))},e.prototype.checkMinValue=function(e){if(!this.min)return!0},e.ProperyChanged=new th.x,xk([(0,fy.o)(),Bk("design:type",th.x)],e.prototype,"propertysub",void 0),e}(),Ek=function(){function e(e){this.groupName=e,this.items=[],this.subGroups=[],this.state=!0}return e.prototype.toggle=function(){this.state=!this.state},e}(),Tk=function(e){this.subgroupName=e,this.items=[]},Ok=function(){function e(t){var i=this;this.options=[],this.error=!1,this.nameArr=new Array({}),this.isbeginChange=!1,this.oldValue=void 0,this.propertysub=new th.x,this.name=t.name,this.type=t.type,this.group=t.group,this.subGroup=t.subGroup,this.title=t.title,this.element=t.element,this.options=t.options,this.min=t.min,this.max=t.max,this.propertysub.pipe((0,jR.b)(200)).subscribe((function(t){i.oldValue!=i.value&&(e.ProperyChanged.next({target:i,oldvalue:i.oldValue,newvalue:i.value}),i.isbeginChange=!1,i.oldValue=void 0)}))}return Object.defineProperty(e.prototype,"value",{get:function(){if("innerHtml"===this.name)return this._value;if("color"===this.type){if(!this._value)return"#00FFFFFF";if(this._value.startsWith("rgb"))return Pk()(this._value).hex}return this._value},set:function(e){var t=this;this._value;if(this.min){var i=Number.parseFloat(e);if(isNaN(i)||i<Number.parseFloat(this.min))return Sk.log("属性错误",this.name,e),void(this.error=!0);this.error=!1}if(this.max){i=Number.parseFloat(e);if(isNaN(i)||i>Number.parseFloat(this.max))return Sk.log("属性错误",this.name,e),void(this.error=!0);this.error=!1}this._value=e,IP.currentBoxList.forEach((function(i){var r=i.element;switch(t.name){case"innerHtml":r.innerHTML=e.replace(/\n/g,"<br>").replace(/\s/g,"&nbsp;");break;case"display":void 0!==e&&(r.style[t.name]=!1===e?"none":"inline");break;case"isReadOnly":void 0!==e&&(!0===e?(r.contentEditable="false",r.draggable=!0):r.draggable=!1);break;case"top":r.style[t.name]=e+"px",r.style.bottom="unset";break;case"left":r.style[t.name]=e+"px",r.style.right="unset";break;case"bottom":r.style[t.name]=e+"px",r.style.top="unset";break;case"right":r.style[t.name]=e+"px",r.style.left="unset";break;case"position":r.style.left=e[0]+"px",r.style.top=e[1]+"px";break;case"height":case"width":case"border-width":case"line-height":case"padding":case"font-size":r.style[t.name]=e+"px";break;case"-webkit-text-stroke-width":var n=r.childNodes;2==n.length?n[1].style[t.name]=e+"px":r.style[t.name]=e+"px";break;case"font-weight":r.style[t.name]="正常"==e?"normal":"bold";break;case"font-family":default:r.style[t.name]=e;break;case"text-align-last":switch(e){case"gp-wenbenzuoduiqi":r.style[t.name]="left";break;case"gp-wenbenjuzhongduiqi":r.style[t.name]="center";break;case"gp-wenbenyouduiqi":r.style[t.name]="right";break;case"gp-wenbenquanbuduiqi":r.style[t.name]="justify";break;default:r.style[t.name]=e}break;case"text-align-vertical":var o=Number.parseInt(getComputedStyle(r).height),s=Number.parseInt(getComputedStyle(r)["font-size"]);switch(e){case"center":r.style["line-height"]=o+"px";break;case"top":r.style["line-height"]=s+"px";break;case"bottom":r.style["line-height"]=2*o-s+"px"}break;case"background-opacity":var a=getComputedStyle(r)["background-color"].split(","),l=a[0].slice(a[0].indexOf("(")+1),h=Number.parseInt(a[2]),c="rgba(".concat(l,",").concat(a[1],",").concat(h,",").concat(e,")");r.style["background-color"]=c;break;case"background-color":var u=1,p=getComputedStyle(r)["background-color"].split(",");4===p.length&&(u=Number.parseFloat(p[3]));var d=(255*u).toString(16);d.indexOf(".")>-1&&(d=d.split(".")[0]),r.style["background-color"]=e+d;break;case"background-size":switch(e){case"填充":r.style["background-size"]="cover";break;case"适应":r.style["background-size"]="contain";break;default:r.style["background-size"]="auto"}break;case"background-image":r.style["background-image"]='url("'.concat(e,'")');break;case"color":r.style[t.name]=e,r.style["-webkit-text-fill-color"]=e}}))},enumerable:!1,configurable:!0}),e.ProperyChanged=new th.x,xk([(0,fy.o)(),Bk("design:type",th.x)],e.prototype,"propertysub",void 0),e}(),Lk=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},Dk=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Ik=function(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],r=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Rk=function(){function e(){this.isOperating=!1,this.id="",this.groups=[],this.isInit=!1,this.propertyChanged=new Cesium.Event}return Object.defineProperty(e.prototype,"text",{get:function(){return this.element.innerHTML},set:function(e){this.element.innerHTML=e},enumerable:!1,configurable:!0}),e.getElementBgOp=function(e){var t=1,i=getComputedStyle(e)["background-color"];if(i.indexOf(",")>-1){var r=i.split(",");4===r.length&&(t=Number.parseFloat(r[3]))}return t},e.prototype.initHtml=function(e){this.element=e},Object.defineProperty(e.prototype,"show",{get:function(){return!!this.displayProps&&this.displayProps.value},set:function(e){this.displayProps&&(this.displayProps.value=e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isReadOnly",{get:function(){return!!this.isReadOnlyProps&&this.isReadOnlyProps.value},set:function(e){this.isReadOnlyProps&&(this.isReadOnlyProps.value=e)},enumerable:!1,configurable:!0}),e.prototype.onPropertyChanged=function(e){this.propertyChanged.raiseEvent(e)},e.prototype.initBase=function(){},e.prototype.initCssBase=function(){var t=this;this.isInit=!0,this.cssPropList.forEach((function(i){switch(i.target=t,i.name){case"background-opacity":i.value=e.getElementBgOp(t.element);break;case"background-size":var r=getComputedStyle(t.element)[i.name];"auto"===r?i.value="默认":"cover"==r?i.value="填充":"contain"==r&&(i.value="适应");break;case"background-image":var n=getComputedStyle(t.element)[i.name];i.value="none"===n?"":getComputedStyle(t.element)[i.name];break;case"innerHtml":i.value=t.element.innerHTML.replace(/<br>/g,"\n").replace(/&nbsp;/g," ");break;case"top":case"left":case"bottom":case"right":case"height":case"width":case"font-size":case"border-width":case"line-height":case"padding-top":case"padding-left":case"padding-right":case"padding-bottom":case"padding":case"-webkit-text-stroke-width":i.value=Number.parseInt(getComputedStyle(t.element)[i.name]);break;case"text-align-vertical":i.value="";break;case"font-weight":var o=getComputedStyle(t.element)[i.name];i.value="400"===o?"正常":"700"===o?"加粗":getComputedStyle(t.element)[i.name];break;case"display":"none"===getComputedStyle(t.element)[i.name]?i.value=!1:i.value=!0;break;case"isReadOnly":"none"===getComputedStyle(t.element)["pointer-events"]?i.value=!0:i.value=!1;break;case"type":i.value=i.target.boxType;break;default:var s=getComputedStyle(t.element)[i.name];s&&(i.value=s)}}))},e.prototype.parseStyleObj=function(e){var t,i;try{for(var r=Ik(Object.keys(e)),n=r.next();!n.done;n=r.next()){var o=n.value,s=this.classType+"-"+o;if(s in localStorage)switch(o){case"background-color":var a=localStorage[s],l=localStorage[this.classType+"-background-opacity"];if(void 0!==l&&null!=l||(l=1),a.indexOf("#")>-1){var h=(255*l).toString(16);h.indexOf(".")>-1&&(h=h.split(".")[0]),e[o]=localStorage.getItem(s)+h}else{var c=a.split(","),u=c[0].slice(c[0].indexOf("(")+1),p=Number.parseInt(c[2]);e[o]="rgba(".concat(u,",").concat(c[1],",").concat(p,",").concat(l,")")}break;case"font-size":case"padding":e[o]=localStorage.getItem(s)+"px";break;default:e[o]=localStorage.getItem(s)}}}catch(e){t={error:e}}finally{try{n&&!n.done&&(i=r.return)&&i.call(r)}finally{if(t)throw t.error}}},e.prototype.initGroup=function(){var e,t;this.cssPropList.forEach((function(e){return e.error=!1}));var i=function(e){if("isReadOnly"===e.name||"display"===e.name)return"continue";if(e.group){var t=r.groups.find((function(t){return t.groupName===e.group}));if(t||(t=new Ek(e.group),r.groups.push(t)),e.subGroup){var i=t.subGroups.find((function(t){return t.subgroupName===e.subGroup}));i||(i=new Tk(e.subGroup),t.subGroups.push(i)),i.items.push(e)}else t.items.push(e)}},r=this;try{for(var n=Ik(this.cssPropList),o=n.next();!o.done;o=n.next()){i(o.value)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}},Lk([(0,fy.o)(),Dk("design:type",Object)],e.prototype,"isOperating",void 0),Lk([(0,fy.o)(),Dk("design:type",Object)],e.prototype,"element",void 0),Lk([(0,fy.o)(),Dk("design:type",Object)],e.prototype,"propertyChanged",void 0),Lk([(0,fy.o)(),Dk("design:type",String),Dk("design:paramtypes",[Object])],e.prototype,"text",null),Lk([(0,fy.o)(),Dk("design:type",Array)],e.prototype,"cssPropList",void 0),Lk([(0,fy.o)(),Dk("design:type",Array)],e.prototype,"groups",void 0),Lk([(0,fy.o)(),Dk("design:type",Mk)],e.prototype,"displayProps",void 0),Lk([(0,fy.o)(),Dk("design:type",Mk)],e.prototype,"isReadOnlyProps",void 0),Lk([(0,fy.o)(),Dk("design:type",Object)],e.prototype,"__meta__",void 0),Lk([(0,fy.o)(),Dk("design:type",Boolean),Dk("design:paramtypes",[Object])],e.prototype,"show",null),Lk([(0,fy.o)(),Dk("design:type",Boolean),Dk("design:paramtypes",[Object])],e.prototype,"isReadOnly",null),e}(),Hk=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Fk=function(e){function t(){var t=e.call(this)||this;return t.classType="html",t}return Hk(t,e),t.prototype.init=function(){this.cssPropList=[new Mk("display","boolean","外观","",this.element,"可见"),new Mk("isReadOnly","boolean","外观","",this.element,"只读"),new Mk("type","boxtype","通用","",this.element,"类型"),new Mk("left","boxsize","通用","第一列",this.element,"X",[]),new Mk("width","boxsize","通用","第一列",this.element,"w",[],"0"),new Mk("top","boxsize","通用","第二列",this.element,"Y",[]),new Mk("height","boxsize","通用","第二列",this.element,"H",[],"0"),new Mk("background-opacity","slider","通用","不透明度",this.element,"不透明度",[],"0"),new Mk("font-family","font-family","文本","字体",this.element,"字体"),new Mk("font-size","font-size","文本","大小粗细",this.element,"文字大小",[],"0"),new Mk("font-weight","option-input","文本","大小粗细",this.element,"文字粗细",["加粗","正常"]),new Mk("position","","","",this.element,"位置"),new Mk("line-height","number","文本","内边距行高",this.element,"行高",[],"0"),new Mk("padding","number","文本","内边距行高",this.element,"内边距",[],"0"),new Mk("text-align-last","align","文本","文字水平对齐",this.element,"文字水平对齐",[["gp-wenbenzuoduiqi","左对齐"],["gp-wenbenjuzhongduiqi","居中"],["gp-wenbenyouduiqi","右对齐"],["gp-wenbenquanbuduiqi","两端对齐"]]),new Mk("color","color","文本","文字颜色",this.element,"文字颜色"),new Mk("-webkit-text-stroke-color","color","文本","描边颜色",this.element,"描边颜色"),new Mk("-webkit-text-stroke-width","strokeWidth","文本","描边线宽",this.element,"描边线宽",[],"0"),new Mk("background-color","color","外观","",this.element,"背景色"),new Mk("border-color","color","外观","",this.element,"边框颜色"),new Mk("border-width","borderwidth","外观","",this.element,"边框宽度",[],"0"),new Mk("border-style","borderstyle","外观","",this.element,"边框样式",["none","solid","double","dotted","dashed","ridge","outset"]),new Mk("background-position","option-input","背景图","",this.element,"背景图位置",["","bottom","top","left","center","right"]),new Mk("background-size","option-input","背景图","",this.element,"背景图大小",["默认","适应","填充"]),new Mk("background-image","image-string","背景图","",this.element,"背景图")],this.displayProps=this.cssPropList[0],this.isReadOnlyProps=this.cssPropList[1],e.prototype.initCssBase.call(this),this.initGroup()},t.prototype.getInitialStyle=function(){var t={"background-color":"#000000",opacity:"1","background-repeat":"no-repeat",width:"0px",height:"0px",position:"absolute",cursor:"text","z-index":9,"background-position":"center","background-size":"contain",padding:"20px",display:"inline"};return Object.assign(t,{color:"#ffffff","text-align":"left","font-size":"22px","font-family":"微软雅黑","font-weight":"400","line-height":"normal"}),e.prototype.parseStyleObj.call(this,t),t},t}(Rk),Nk=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},Qk=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},kk=function(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],r=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Uk=function(){function e(){this.isOperating=!1,this.id="",this.cssPropList=[],this.groups=[],this.isInit=!1,this.propertyChanged=new Cesium.Event,this.classType="htmlBoxMulti"}return Object.defineProperty(e.prototype,"element",{get:function(){return this.boxList.length>0?this.boxList[this.boxList.length-1].element:this._element},set:function(e){this._element=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"text",{get:function(){return this.element.innerHTML},set:function(e){this.element.innerHTML=e},enumerable:!1,configurable:!0}),e.getElementBgOp=function(e){var t=1,i=getComputedStyle(e)["background-color"];if(i.indexOf(",")>-1){var r=i.split(",");4===r.length&&(t=Number.parseFloat(r[3]))}return t},e.prototype.init=function(e){var t,i;this.boxList=e,IP.boxList=e;var r=this.boxList[0].cssPropList,n=function(e){var t,i,r=0;try{for(var n=(t=void 0,kk(o.boxList)),s=n.next();!s.done;s=n.next()){s.value.cssPropList.find((function(t){return t.name==e.name}))&&r++}}catch(e){t={error:e}}finally{try{s&&!s.done&&(i=n.return)&&i.call(n)}finally{if(t)throw t.error}}if(r==o.boxList.length){var a=new Ok(e);o.cssPropList.push(a)}},o=this;try{for(var s=kk(r),a=s.next();!a.done;a=s.next()){n(a.value)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(i=s.return)&&i.call(s)}finally{if(t)throw t.error}}this.displayProps=this.cssPropList[0],this.isReadOnlyProps=this.cssPropList[1],this.initCssBase(),this.initGroup()},e.prototype.initHtml=function(e){this.element=e},Object.defineProperty(e.prototype,"show",{get:function(){return!!this.boxList.every((function(e){return 1==e.show}))},set:function(e){this.displayProps&&(this.displayProps.value=e,this.boxList.forEach((function(t){t.show=e})))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isReadOnly",{get:function(){return!!this.boxList.every((function(e){return 1==e.isReadOnly}))},set:function(e){this.isReadOnlyProps&&(this.isReadOnlyProps.value=e,this.boxList.forEach((function(t){t.isReadOnly=e})))},enumerable:!1,configurable:!0}),e.prototype.onPropertyChanged=function(e){this.propertyChanged.raiseEvent(e)},e.prototype.initCssBase=function(){var e=this;this.isInit=!0,this.cssPropList.forEach((function(t){var i=e.getPublicPropValue(t.name);if(i)switch(t.name){case"background-opacity":t.value=Rk.getElementBgOp(i);break;case"background-size":var r=getComputedStyle(i)[t.name];"auto"===r?t.value="默认":"cover"==r?t.value="填充":"contain"==r&&(t.value="适应"),t.value=void 0;break;case"background-image":var n=getComputedStyle(i)[t.name];t.value="none"===n?"":getComputedStyle(i)[t.name];break;case"innerHtml":t.value=i.innerHTML.replace(/<br>/g,"\n").replace(/&nbsp;/g," ");break;case"top":case"left":case"bottom":case"right":case"height":case"width":case"font-size":case"border-width":case"line-height":case"padding-top":case"padding-left":case"padding-right":case"padding-bottom":case"padding":case"-webkit-text-stroke-width":t.value=Number.parseInt(getComputedStyle(i)[t.name]);break;case"text-align-vertical":t.value="";break;case"font-weight":var o=getComputedStyle(i)[t.name];t.value="400"===o?"正常":"700"===o?"加粗":getComputedStyle(i)[t.name];break;case"display":"none"===getComputedStyle(i)[t.name]?t.value=!1:t.value=!0;break;case"isReadOnly":if(i.children[0].className.includes("scroll_box"))return;"none"===getComputedStyle(i)["pointer-events"]?t.value=!0:t.value=!1;break;case"type":t.value=e.boxList[0].boxType;break;default:var s=getComputedStyle(i)[t.name];s&&(t.value=s)}else t.value=void 0}))},e.prototype.getPublicPropValue=function(e){if(this.boxList&&!(this.boxList.length<1)){for(var t=this.getProp(this.boxList[0],e),i=1;i<this.boxList.length;i++)if(this.getProp(this.boxList[i],e)!=t)return;return this.boxList[0].element}},e.prototype.getProp=function(e,t){var i=e.cssPropList.find((function(e){return e.name==t}));return i?i.value:void 0},e.prototype.initGroup=function(){var e,t;this.cssPropList.forEach((function(e){return e.error=!1}));var i=function(e){if("isReadOnly"===e.name||"display"===e.name)return"continue";if(e.group){var t=r.groups.find((function(t){return t.groupName===e.group}));if(t||(t=new Ek(e.group),r.groups.push(t)),e.subGroup){var i=t.subGroups.find((function(t){return t.subgroupName===e.subGroup}));i||(i=new Tk(e.subGroup),t.subGroups.push(i)),i.items.push(e)}else t.items.push(e)}},r=this;try{for(var n=kk(this.cssPropList),o=n.next();!o.done;o=n.next()){i(o.value)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}},e.prototype.getInitialStyle=function(){var e={"background-color":"#000000",opacity:"1","background-repeat":"no-repeat",width:"0px",height:"0px",position:"absolute",cursor:"text","z-index":9,"background-position":"center","background-size":"contain",padding:"20px",display:"inline"};return Object.assign(e,{color:"#097EFF","text-align":"left","font-size":"22px","font-family":"微软雅黑","font-weight":"400","line-height":"normal"}),this.parseStyleObj(e),e},e.prototype.parseStyleObj=function(e){var t,i;try{for(var r=kk(Object.keys(e)),n=r.next();!n.done;n=r.next()){var o=n.value,s=this.classType+"-"+o;if(s in localStorage)switch(o){case"background-color":var a=localStorage[s],l=localStorage[this.classType+"-background-opacity"];if(void 0!==l&&null!=l||(l=1),a.indexOf("#")>-1){var h=(255*l).toString(16);h.indexOf(".")>-1&&(h=h.split(".")[0]),e[o]=localStorage.getItem(s)+h}else{var c=a.split(","),u=c[0].slice(c[0].indexOf("(")+1),p=Number.parseInt(c[2]);e[o]="rgba(".concat(u,",").concat(c[1],",").concat(p,",").concat(l,")")}break;case"font-size":case"padding":e[o]=localStorage.getItem(s)+"px";break;default:e[o]=localStorage.getItem(s)}}}catch(e){t={error:e}}finally{try{n&&!n.done&&(i=r.return)&&i.call(r)}finally{if(t)throw t.error}}},Nk([(0,fy.o)(),Qk("design:type",Object)],e.prototype,"isOperating",void 0),Nk([(0,fy.o)(),Qk("design:type",HTMLElement)],e.prototype,"_element",void 0),Nk([(0,fy.o)(),Qk("design:type",Object)],e.prototype,"propertyChanged",void 0),Nk([(0,fy.o)(),Qk("design:type",String),Qk("design:paramtypes",[Object])],e.prototype,"text",null),Nk([(0,fy.o)(),Qk("design:type",Ok)],e.prototype,"displayProps",void 0),Nk([(0,fy.o)(),Qk("design:type",Ok)],e.prototype,"isReadOnlyProps",void 0),Nk([(0,fy.o)(),Qk("design:type",Object)],e.prototype,"__meta__",void 0),Nk([(0,fy.o)(),Qk("design:type",Boolean),Qk("design:paramtypes",[Object])],e.prototype,"show",null),Nk([(0,fy.o)(),Qk("design:type",Boolean),Qk("design:paramtypes",[Object])],e.prototype,"isReadOnly",null),e}(),jk=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Gk=function(e){function t(){var t=e.call(this)||this;return t.classType="subtitle",t}return jk(t,e),t.prototype.init=function(){this.cssPropList=[new Mk("display","boolean","外观","",this.element,"可见"),new Mk("isReadOnly","boolean","外观","",this.element,"只读"),new Mk("background-opacity","slider","通用","不透明度",this.element,"不透明度",[],"0"),new Mk("font-family","font-family","文本","字体",this.element,"字体"),new Mk("font-size","font-size","文本","大小粗细",this.element,"文字大小",[],"0"),new Mk("font-weight","option-input","文本","大小粗细",this.element,"文字粗细",["加粗","正常"]),new Mk("position","","","",this.element,"位置"),new Mk("padding","number","文本","内边距行高",this.element,"内边距",[],"0"),new Mk("line-height","number","文本","内边距行高",this.element,"行高",[],"0"),new Mk("text-align-last","align","文本","文字水平对齐",this.element,"文字水平对齐",[["gp-wenbenzuoduiqi","左对齐"],["gp-wenbenjuzhongduiqi","居中"],["gp-wenbenyouduiqi","右对齐"],["gp-wenbenquanbuduiqi","两端对齐"]]),new Mk("color","color","文本","文字颜色",this.element,"文字颜色"),new Mk("background-color","color","外观","",this.element,"背景色"),new Mk("border-color","color","外观","",this.element,"边框颜色"),new Mk("border-width","borderwidth","外观","",this.element,"边框宽度",[],"0"),new Mk("border-style","borderstyle","外观","",this.element,"边框样式",["none","solid","double","dotted","dashed","ridge","outset"])],this.displayProps=this.cssPropList[0],this.isReadOnlyProps=this.cssPropList[1],e.prototype.initCssBase.call(this),this.initGroup()},t.prototype.getInitialStyle=function(){var t={"background-color":"#000000",opacity:1,"background-repeat":"no-repeat",width:"80%",left:"10%",bottom:"100px",position:"absolute",cursor:"move","z-index":9,color:"white","text-align":"center","font-size":"48px","line-height":"40px","background-position":"center","background-size":"contain","font-family":"微软雅黑","font-weight":"400",padding:"20px",display:"none"};return e.prototype.parseStyleObj.call(this,t),t},t}(Rk),zk=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Yk=function(e){function t(){var t=e.call(this)||this;return t.classType="newRichText",t}return zk(t,e),t.prototype.init=function(){this.cssPropList=[new Mk("display","boolean","外观","",this.element,"可见"),new Mk("isReadOnly","boolean","外观","",this.element,"只读"),new Mk("type","boxtype","通用","",this.element,"类型"),new Mk("left","boxsize","通用","第一列",this.element,"X"),new Mk("width","boxsize","通用","第一列",this.element,"w",[],"0"),new Mk("top","boxsize","通用","第二列",this.element,"Y"),new Mk("height","boxsize","通用","第二列",this.element,"H",[],"0"),new Mk("background-opacity","slider","通用","不透明度",this.element,"不透明度",[],"0"),new Mk("background-color","color","外观","",this.element,"背景色"),new Mk("border-color","color","外观","",this.element,"边框颜色"),new Mk("border-width","borderwidth","外观","",this.element,"边框宽度",[],"0"),new Mk("border-style","borderstyle","外观","",this.element,"边框样式",["none","solid","double","dotted","dashed","ridge","outset"]),new Mk("background-position","option-input","背景图","",this.element,"背景图位置",["","bottom","top","left","center","right"]),new Mk("background-size","option-input","背景图","",this.element,"背景图大小",["默认","适应","填充"]),new Mk("background-image","image-string","背景图","",this.element,"背景图")],this.displayProps=this.cssPropList[0],this.isReadOnlyProps=this.cssPropList[1],e.prototype.initCssBase.call(this),this.initGroup()},t.prototype.getInitialStyle=function(){var e={"background-color":"#000000",opacity:"1","background-repeat":"no-repeat",width:"0px",height:"0px",position:"absolute",cursor:"default","z-index":12,"background-position":"center","background-size":"contain",padding:"20px",display:"inline"};return Object.assign(e,{color:"#ffffff","text-align":"left","font-size":"32px","font-family":"微软雅黑","font-weight":"400","line-height":"1.5","overflow-wrap":"anywhere"}),e},t}(Rk),Zk=i(5108),Wk=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Xk=function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},Jk=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Kk=function(e){function t(){var t=e.call(this)||this;return t.picList=[],t.classType="picCollection",t}return Wk(t,e),t.prototype.init=function(){this.cssPropList=[new Mk("display","boolean","外观","",this.element,"可见"),new Mk("isReadOnly","boolean","外观","",this.element,"只读"),new Mk("type","boxtype","通用","",this.element,"类型"),new Mk("left","boxsize","通用","第一列",this.element,"X"),new Mk("width","boxsize","通用","第一列",this.element,"w",[],"0"),new Mk("top","boxsize","通用","第二列",this.element,"Y"),new Mk("height","boxsize","通用","第二列",this.element,"H",[],"0"),new Mk("background-opacity","slider","通用","不透明度",this.element,"不透明度",[],"0"),new Mk("background-color","color","外观","",this.element,"背景色"),new Mk("border-color","color","外观","",this.element,"边框颜色"),new Mk("border-width","borderwidth","外观","",this.element,"边框宽度",[],"0"),new Mk("border-style","borderstyle","外观","",this.element,"边框样式",["none","solid","double","dotted","dashed","ridge","outset"])],this.displayProps=this.cssPropList[0],this.isReadOnlyProps=this.cssPropList[1],e.prototype.initCssBase.call(this),this.initGroup(),this.element.contentEditable=!1,this.setPicList([])},t.prototype.resetPicList=function(e){Zk.log("list",e);var t=document.getElementsByClassName("carouselContainer")[0];t&&(t.innerHTML="")},t.prototype.setPicList=function(e){var t=this;if(Zk.log("imgList",e,this.tnsObj),e.length>0&&(this.picList=e),e.length>0&&(this.picList=e),0!==this.picList.length){var i=document.createElement("div");i.className="carouselContainer",i.style.cssText="width:100%;height:100%;display:flex;justify-content: center;align-items: center;";var r='<button class="btn_left_'.concat(this.id,'" style="position: absolute;\n        background-color: rgba(0, 0, 0, 0.3);\n        z-index: 3;border: none;\n        left: 0;\n        width: 60px;  \n        height: 100%;\n        top: 0;" nz-button nzType="text"><i style="font-size: 40px;" class="iconfont gp-arrow-left"></i></button>'),n='<button class="right_btn_'.concat(this.id,'" style="position: absolute;\n        background-color: rgba(0, 0, 0, 0.3);\n        z-index: 3;border: none;\n        right: 0;\n        width: 60px;\n        height: 100%;\n        top: 0;" nz-button nzType="text"><i style="font-size: 40px;" class="iconfont gp-arrow-right"></i></button>'),o="";this.picList.forEach((function(e){o="".concat(o,'<div style="text-align: center;height:100%"><img style="width: 80%;height:100%" src=\'').concat(e.imgPath,"'></div>")})),o="<div id='edittns_".concat(this.id,"'>").concat(o,"</div>"),i.innerHTML=o+r+n,this.element.innerHTML="",this.element.appendChild(i),document.querySelector(".btn_left_"+this.id).addEventListener("click",(function(e){t.previous()})),document.querySelector(".right_btn_"+this.id).addEventListener("click",(function(e){t.next()})),this.tnsObj=window.tns({container:"#edittns_"+this.id,items:1,swipeAngle:!1,speed:400,controls:!1,navPosition:""})}},t.prototype.previous=function(){this.tnsObj&&this.tnsObj.goTo("prev")},t.prototype.next=function(){this.tnsObj&&this.tnsObj.goTo("next")},t.prototype.getInitialStyle=function(){var t={"background-color":"#000000",opacity:"1","background-repeat":"no-repeat",width:"0px",height:"0px",position:"absolute",cursor:"move","z-index":9,"background-position":"center","background-size":"contain",padding:"20px",display:"inline"};return Object.assign(t,{color:"#097EFF","text-align":"left","font-size":"16px","font-family":"微软雅黑","font-weight":"400","line-height":"21px"}),e.prototype.parseStyleObj.call(this,t),t},Xk([(0,fy.o)(),Jk("design:type",Object)],t.prototype,"tnsObj",void 0),t}(Rk),Vk=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),qk=function(e){function t(){var t=e.call(this)||this;return t.classType="richText",t}return Vk(t,e),t.prototype.init=function(){this.cssPropList=[new Mk("display","boolean","外观","",this.element,"可见"),new Mk("isReadOnly","boolean","外观","",this.element,"只读"),new Mk("type","boxtype","通用","",this.element,"类型"),new Mk("left","boxsize","通用","第一列",this.element,"X"),new Mk("width","boxsize","通用","第一列",this.element,"w",[],"0"),new Mk("top","boxsize","通用","第二列",this.element,"Y"),new Mk("height","boxsize","通用","第二列",this.element,"H",[],"0"),new Mk("background-opacity","slider","通用","不透明度",this.element,"不透明度",[],"0"),new Mk("background-color","color","外观","",this.element,"背景色"),new Mk("border-color","color","外观","",this.element,"边框颜色"),new Mk("border-width","borderwidth","外观","",this.element,"边框宽度",[],"0"),new Mk("border-style","borderstyle","外观","",this.element,"边框样式",["none","solid","double","dotted","dashed","ridge","outset"])],this.displayProps=this.cssPropList[0],this.isReadOnlyProps=this.cssPropList[1],e.prototype.initCssBase.call(this),this.initGroup()},t.prototype.getInitialStyle=function(){var t={"background-color":"#ffffff",opacity:"1","background-repeat":"no-repeat",width:"0px",height:"0px",position:"absolute",cursor:"move","z-index":9,"background-position":"center","background-size":"contain",padding:"20px",display:"inline"};return Object.assign(t,{color:"#000000","text-align":"left","font-size":"16px","font-family":"微软雅黑","font-weight":"400","line-height":"21px","overflow-wrap":"anywhere"}),e.prototype.parseStyleObj.call(this,t),t},t}(Rk),$k=i(5108),eU=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),tU=function(e){function t(){var t=e.call(this)||this;return t.videoPath="",t.classType="videoBox",t}return eU(t,e),t.prototype.init=function(){this.cssPropList=[new Mk("display","boolean","外观","",this.element,"可见"),new Mk("isReadOnly","boolean","外观","",this.element,"只读"),new Mk("type","boxtype","通用","",this.element,"类型"),new Mk("left","boxsize","通用","第一列",this.element,"X"),new Mk("width","boxsize","通用","第一列",this.element,"w",[],"0"),new Mk("top","boxsize","通用","第二列",this.element,"Y"),new Mk("height","boxsize","通用","第二列",this.element,"H",[],"0"),new Mk("background-opacity","slider","通用","不透明度",this.element,"不透明度",[],"0"),new Mk("background-color","color","外观","",this.element,"背景色"),new Mk("border-color","color","外观","",this.element,"边框颜色"),new Mk("border-width","borderwidth","外观","",this.element,"边框宽度",[],"0"),new Mk("border-style","borderstyle","外观","",this.element,"边框样式",["none","solid","double","dotted","dashed","ridge","outset"])],this.displayProps=this.cssPropList[0],this.isReadOnlyProps=this.cssPropList[1],e.prototype.initCssBase.call(this),this.initGroup()},t.prototype.setVideoBox=function(e){$k.log("ele",e,this.videoPath);var t='<video id="'.concat(this.id,'_media" height="100%" width="100%" controls><source src="').concat(e.videoPath,'" type="video/mp4"><video/>'),i=document.createElement("div");i.className="videoContainer",i.style.cssText="width:100%;height:100%;display:flex;justify-content: center;align-items: center;",i.innerHTML=t,this.element.innerHTML="",this.element.appendChild(i)},t.prototype.getInitialStyle=function(){var t={"background-color":"#000000",opacity:"1","background-repeat":"no-repeat",width:"0px",height:"0px",position:"absolute",cursor:"move","z-index":9,"background-position":"center","background-size":"contain",padding:"20px",display:"inline"};return Object.assign(t,{color:"#097EFF","text-align":"left","font-size":"16px","font-family":"微软雅黑","font-weight":"400","line-height":"21px"}),e.prototype.parseStyleObj.call(this,t),t},t}(Rk),iU=function(){function e(){}return e.createBox=function(e){var t;switch(e){case"html":default:(t=new Fk).name="文本框",t.boxType="文本框";break;case"richText":(t=new qk).name="富文本",t.boxType="富文本";break;case"newRichText":(t=new Yk).name="富文本",t.boxType="富文本";break;case"picCollection":(t=new Kk).name="图片集",t.boxType="图片集";break;case"subtitle":(t=new Gk).name="字幕",t.boxType="字幕";break;case"videoBox":(t=new tU).name="视频",t.boxType="视频"}return t},e}(),rU=i(5108),nU=function(e,t,i,r){return new(i||(i=Promise))((function(n,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?n(e.value):function(e){return e instanceof i?e:new i((function(t){t(e)}))}(e.value).then(s,a)}l((r=r.apply(e,t||[])).next())}))},oU=function(e,t){var i,r,n,o,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,r&&(n=2&o[0]?r.return:o[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,o[1])).done)return n;switch(r=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(n=s.trys,(n=n.length>0&&n[n.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){s.label=o[1];break}if(6===o[0]&&s.label<n[1]){s.label=n[1],n=o;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(o);break}n[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{i=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},sU=function(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],r=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},aU=function(){function e(e){var t=this;this._isReadOnly=!1,this.subTitleChange=new th.x,this.scalePercent=1,this.autoScale=!0,this.boxList=new Array,this.onBoxSelected=new th.x,this.onCtrlBoxesSelected=new th.x,this._currentBoxList=[],this.onBoxCreated=new th.x,this.selectedBoxBorderList=[],this.onVideoAnimationInit=new th.x,this.endHtmlPlot$=new th.x,this.obj={},this.isDrawPanelShow=!1,this.startX=0,this.startY=0,this.diffX=0,this.diffY=0,this.dragging=!1,this.isEditing=!1,this.movingBoxElement=null,this.currentBoxTop=null,this.currentBoxLeft=null,this.resizing=!1,this.resizingStartX=0,this.resizingStartY=0,this.heightStartY=0,this.widthStartX=0,this.heightOriginValue=0,this.widthOriginValue=0,this.topOriginValue=0,this.leftOriginValue=0,this.currentBoxHeight=null,this.currentBoxWidth=null,this.operatorEnd=new th.x,this.operatorMoveDiffX=0,this.operatorMoveDiffY=0,this.operatorMoving=!1,this.isCtrlPressedSub$=new th.x,this.tempDirection="",this.scaling=!1,this.mouseStartX=0,this.mouseStartY=0,this.isEdit=!1,this.serviceManager=e,this.serviceManager.richTextService.scalePercentCopySub$.subscribe((function(){t.serviceManager.richTextService.scalePercentCopy=t.scalePercent}))}return Object.defineProperty(e.prototype,"currentBox",{get:function(){return this._currentBox},set:function(e){this._currentBox=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isReadOnly",{get:function(){return this._isReadOnly},set:function(e){this._isReadOnly=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"container",{get:function(){return this._container},set:function(e){this._container=e,e&&this.init()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentBoxList",{get:function(){return this._currentBoxList},set:function(e){this._currentBoxList=e,IP.currentBoxList=e},enumerable:!1,configurable:!0}),e.prototype.getListDataToSave=function(){return this.convertBoxListToString(this.boxList)},e.prototype.convertBoxListToString=function(e){var t,i;e.forEach((function(e){e.html=e.element.outerHTML}));var r=[];try{for(var n=sU(e),o=n.next();!o.done;o=n.next()){var s=o.value,a=(0,Ux.ZE)(s);r.push(a)}}catch(e){t={error:e}}finally{try{o&&!o.done&&(i=n.return)&&i.call(n)}finally{if(t)throw t.error}}return my.ZP.serialize(r)},e.prototype.saveBoxData=function(e){return e.html=e.element.outerHTML,e},e.prototype.setBoxEditable=function(e){this.boxList.forEach((function(e){e.html=e.element.outerHTML}))},e.prototype.setListByData=function(e){var t,i,r=this;if(e&&!(e.length<1)){e.forEach((function(e){var t=document.createElement("div");t.innerHTML=e.html,t.children[0].id=e.id,r.containerDiv.appendChild(t.children[0])}));var n=[],o=this.containerDiv.getElementsByClassName("html-box"),s=Array.from(o),a=function(e){var t=s.find((function(t){return t.id===e.id}));if(!t)return"continue";l.initBoxEvent(t);var i=iU.createBox(e.classType);i.id=e.id?e.id:t.id,i.name=e.name,i.boxType=e.boxType,i.videoPath||(i.videoPath=e.videoPath),i.initHtml(t),i.init(),i instanceof Kk&&i.setPicList(e.picList),l.boxList.push(i),n.push(i)},l=this;try{for(var h=sU(e),c=h.next();!c.done;c=h.next()){a(c.value)}}catch(e){t={error:e}}finally{try{c&&!c.done&&(i=h.return)&&i.call(h)}finally{if(t)throw t.error}}return n}},e.prototype.showHtml=function(e){var t=this;!e||e.length<1||e.forEach((function(e){t.containerDiv.innerHTML+=e.html}))},e.prototype.deleteBox=function(e){ty.Remove(this.boxList,e),this.currentBox===e&&this.setCurrentBox(null);var t=document.getElementById(e.id);t&&this.containerDiv.removeChild(t),this.onBoxSelected.next(null)},e.prototype.deleteBoxList=function(e){var t=this;this.currentBox&&e.find((function(e){return e.id===t.currentBox.id}))&&this.setCurrentBox(null),e.forEach((function(e){var i=document.getElementById(e.id);i&&t.containerDiv.removeChild(i)}))},e.prototype.clearHtmlDiv=function(){this.containerDiv&&(this.containerDiv.innerHTML="",this.boxList=[],this.setCurrentBox(null),this.selectedBoxBorderList=[])},e.prototype.init=function(){var e=this,t=document,i=document.getElementById("html-draw-container");i?(this.containerDiv=i,this.containerDiv.style.pointerEvents="all"):(this.containerDiv=document.createElement("div"),this.containerDiv.id="html-draw-container",this.containerDiv.style.pointerEvents="all",this.container.appendChild(this.containerDiv)),t.onmousedown=function(t){return e.startDraw(t)},t.addEventListener("mousemove",(function(t){return e.updateBoxSize(t)})),t.addEventListener("mouseup",(function(t){return e.drawEnd(t)}))},e.prototype.updateBoxSize=function(e){var t=this.calMouseCurrentOffset();if(this.isDrawPanelShow){var i=document.getElementsByClassName("active_box")[0];if(i){if(this.scaleValue(e.pageX)>this.scaleValue(t.left)+t.width||this.scaleValue(e.pageY)>this.scaleValue(t.top)+t.height)return void rU.log("禁止绘制的范围");i.style.width=this.scaleValue(e.pageX)-this.startX+"px",i.style.height=this.scaleValue(e.pageY)-this.startY+"px"}}},e.prototype.updateOperatorPoint=function(e,t){var i=this;void 0===t&&(t=!1);var r=document.getElementsByClassName("operatorText")[0];if(r){if(r.style.transform="scale(".concat(1/this.scalePercent,")"),t)r.style.display="none";else{if(this.serviceManager.richTextService.editor&&this.serviceManager.richTextService.currentHtmlBox)return;this.currentBoxList[this.currentBoxList.length-1];if("unset"===e.style.top&&(r.style.bottom=Number.parseInt(getComputedStyle(e).bottom)-10+"px"),"unset"===e.style.bottom&&(r.style.top=Number.parseInt(getComputedStyle(e).top)-10+"px"),"unset"===e.style.left&&(r.style.right=Number.parseInt(getComputedStyle(e).right)-10+(Number.parseInt(getComputedStyle(e).width)+20)+"px"),"unset"===e.style.right&&(r.style.left=Number.parseInt(getComputedStyle(e).left)-10+(Number.parseInt(getComputedStyle(e).width)+20)+"px"),r.style.display="flex",this.currentBox instanceof Fk||this.currentBox instanceof qk||this.currentBox instanceof Kk||this.currentBox instanceof Yk){var n=parseFloat(r.style.top.slice(0,r.style.top.length-2)),o=parseFloat(r.style.left.slice(0,r.style.left.length-2)),s=document.getElementById("richTextPanel"),a=parseFloat(s.style.width.slice(0,s.style.width.length-2)),l=parseFloat(s.style.height.slice(0,s.style.height.length-2));n<0&&(rU.log("上边超出拖拽区域！"),r.style.top="10px"),n>l-100&&(rU.log("下边超出拖拽区域！"),r.style.top=l-100+"px"),o<0&&(rU.log("左边超出拖拽区域！"),r.style.left="40px"),o>a-200&&(rU.log("右边超出拖拽区域！"),r.style.left=a-200+"px")}}setTimeout((function(){var e=document.querySelector(".lock");e&&e.firstElementChild&&i.currentBox&&(e.firstElementChild.className=i.currentBox.isReadOnly?"iconfont gp-suodingkaobei":"iconfont gp-jiesuo")}),0)}},e.prototype.hideOperator=function(){var e=document.getElementsByClassName("operatorText")[0];e&&(e.style.display="none")},e.prototype.showOperator=function(e,t){var i=this;void 0===t&&(t=!1),this.updateOperatorPoint(e,t);var r=document.getElementsByClassName("operatorText")[0];document.querySelector(".level_move").onmousedown=function(e){rU.log("开始移动富文本");document.querySelector(".level_move").getBoundingClientRect();r.style.display="none",i.startDragBox(e)},document.querySelector(".all_zoom").onmousedown=function(e){document.querySelector(".all_zoom").getBoundingClientRect();r.style.display="none",i.startScale(e)};var n=document.querySelector(".handler_div"),o=document.querySelector("#tt001");n.onmousedown=function(e){o&&(o.addEventListener("mouseup",i.toolMoverMouseUp),o.addEventListener("mousemove",i.toolMoverMouseMove)),i.operatorMoving=!0,i.operatorMoveDiffX=e.clientX,i.operatorMoveDiffY=e.clientY,i.prevBoxTop=0,i.prevBoxLeft=0},this.toolMoverMouseUp=function(e){i.operatorMoving=!1,e.stopPropagation(),o&&(o.removeEventListener("mouseup",i.toolMoverMouseUp),o.removeEventListener("mousemove",i.toolMoverMouseMove))},this.toolMoverMouseMove=function(e){if(i.operatorMoving){var t=e.clientY-i.operatorMoveDiffY,r=e.clientX-i.operatorMoveDiffX;n.parentElement.style.top=parseFloat(n.parentElement.style.top)+(t-i.prevBoxTop)/i.scalePercent+"px",n.parentElement.style.left=parseFloat(n.parentElement.style.left)+(r-i.prevBoxLeft)/i.scalePercent+"px",i.prevBoxTop=t,i.prevBoxLeft=r}};var s=document.querySelector(".lock");s&&(s.onclick=function(e){i.lockHTMlBox()})},e.prototype.lockHTMlBox=function(e){var t;t=e||this.currentBox;var i;rU.log("锁定",event),i=!t.isReadOnly;var r=document.getElementsByClassName("html-box")[0];i?(t.isReadOnly=!0,t instanceof Yk&&this.serviceManager.richTextService.disable()):(t.isReadOnly=!1,t instanceof Yk&&(this.serviceManager.richTextService.enable(),r&&(r.style.pointerEvents="auto")));var n=document.querySelector(".lock");n&&n.firstElementChild&&(n.firstElementChild.className=i?"iconfont gp-suodingkaobei":"iconfont gp-jiesuo")},e.prototype.showSelectBox=function(e,t){void 0===t&&(t=!1),e||(e=this.currentBox.element);var i=this.selectedBoxBorderList.find((function(t){return t.id===e.id+"-s"}));i?i.style.display="block":((i=document.createElement("div")).id=e.id+"-s",i.className="select-box",i.style.position="absolute",t||(i.style.border="3px dashed #E3C42E"),this.containerDiv.appendChild(i),t||this.addControlBar(i),this.selectedBoxBorderList.push(i)),t?(i.style.left="9%",i.style.width="82%",i.style.bottom=Number.parseInt(getComputedStyle(e).bottom)-10+"px",i.onkeydown=function(e){e.ctrlKey&&86==e.keyCode&&e.stopPropagation()},i.onkeyup=function(e){e.ctrlKey&&86==e.keyCode&&e.stopPropagation()}):("unset"===e.style.top&&(i.style.bottom=Number.parseInt(getComputedStyle(e).bottom)-3+"px"),"unset"===e.style.bottom&&(i.style.top=Number.parseInt(getComputedStyle(e).top)-3+"px"),"unset"===e.style.left&&(i.style.right=Number.parseInt(getComputedStyle(e).right)-3+"px"),"unset"===e.style.right&&(i.style.left=Number.parseInt(getComputedStyle(e).left)-3+"px"),i.style.width=Number.parseInt(getComputedStyle(e).width)+40+"px",i.style.height=Number.parseInt(getComputedStyle(e).height)+40+"px")},e.prototype.addControlBar=function(e){var t=this;[{tempDirection:"WN",cursor:"nw-resize",top:"-10px",left:"-10px"},{tempDirection:"W",cursor:"w-resize",top:"50%",left:"-11px"},{tempDirection:"WS",cursor:"sw-resize",left:"-10px",bottom:"-10px"},{tempDirection:"S",cursor:"s-resize",left:"50%",bottom:"-11px"},{tempDirection:"ES",cursor:"se-resize",right:"-10px",bottom:"-10px"},{tempDirection:"E",cursor:"e-resize",top:"50%",right:"-11px"},{tempDirection:"N",cursor:"n-resize",top:"-11px",left:"50%"},{tempDirection:"EN",cursor:"ne-resize",top:"-11px",right:"-11px"}].forEach((function(i){var r=document.createElement("div");r.className="html-control-bar";var n="height: 18px;width: 18px;z-index: 10;position: absolute;background-color: #FFFFFF;border: 2px solid #F3B713;border-radius: 50%;";n=n+"cursor:"+i.cursor+";",i.left&&(n=n+"left:"+i.left+";"),i.top&&(n=n+"top:"+i.top+";"),i.bottom&&(n=n+"bottom:"+i.bottom+";"),i.right&&(n=n+"right:"+i.right+";"),r.style.cssText=n,r.onmousedown=function(e){t.tempDirection=i.tempDirection,t.startResizing(e)},e.appendChild(r)}))},e.prototype.startScale=function(e){this.mouseStartX=e.clientX,this.mouseStartY=e.clientY,this.movingBoxElement=this.currentBox.element,this.scaling=!0},e.prototype.getOwnerElement=function(){return(window.viewerHtmlElement?window.viewerHtmlElement:this.viewer.scene.canvas).parentElement},e.prototype.startResizing=function(e){this.resizing=!0,this.currentBoxHeight=this.currentBox.cssPropList.find((function(e){return"height"===e.name})),this.heightOriginValue=this.currentBoxHeight.value,this.currentBoxWidth=this.currentBox.cssPropList.find((function(e){return"width"===e.name})),this.widthOriginValue=this.currentBoxWidth.value,this.currentBoxTop=this.currentBox.cssPropList.find((function(e){return"top"===e.name})),this.topOriginValue=this.currentBoxTop.value,this.currentBoxLeft=this.currentBox.cssPropList.find((function(e){return"left"===e.name})),this.leftOriginValue=this.currentBoxLeft.value,this.resizingStartY=this.scaleValue(e.clientY),this.resizingStartX=this.scaleValue(e.clientX),this.movingBoxElement=this.currentBox.element},e.prototype.topHeightResizing=function(e){var t=this.scaleValue(e.clientY)-this.resizingStartY;this.heightOriginValue-t<=40?(this.currentBoxTop&&(this.currentBoxTop.value=this.topOriginValue+this.heightOriginValue-40),this.currentBoxHeight&&(this.currentBoxHeight.value=40)):(this.currentBoxTop&&(this.currentBoxTop.value=this.topOriginValue+t),this.currentBoxHeight&&(this.currentBoxHeight.value=this.heightOriginValue-t))},e.prototype.leftWidthResizing=function(e){var t=this.scaleValue(e.clientX)-this.resizingStartX;this.widthOriginValue-t<=40?(this.currentBoxLeft&&(this.currentBoxLeft.value=this.leftOriginValue+this.widthOriginValue-40),this.currentBoxWidth&&(this.currentBoxWidth.value=40)):(this.currentBoxLeft&&(this.currentBoxLeft.value=this.leftOriginValue+t),this.currentBoxWidth&&(this.currentBoxWidth.value=this.widthOriginValue-t))},e.prototype.widthResizing=function(e){var t=this.scaleValue(e.clientX)-this.resizingStartX;t+this.widthOriginValue<=40?this.currentBoxWidth&&(this.currentBoxWidth.value=40):this.currentBoxWidth&&(this.currentBoxWidth.value=this.widthOriginValue+t)},e.prototype.heightResizing=function(e){var t=this.scaleValue(e.clientY)-this.resizingStartY;t+this.heightOriginValue<=40?this.currentBoxHeight&&(this.currentBoxHeight.value=40):this.currentBoxHeight&&(this.currentBoxHeight.value=this.heightOriginValue+t)},e.prototype.startMoveHeight=function(e){this.resizing=!0,this.currentBoxHeight=this.currentBox.cssPropList.find((function(e){return"height"===e.name})),this.heightStartY=e.clientY,this.movingBoxElement=this.currentBox.element,this.heightOriginValue=this.currentBoxHeight.value},e.prototype.startMoveWidth=function(e){this.resizing=!0,this.currentBoxWidth=this.currentBox.cssPropList.find((function(e){return"width"===e.name})),this.widthStartX=e.clientX,this.movingBoxElement=this.currentBox.element,this.currentBoxWidth&&(this.widthOriginValue=this.currentBoxWidth.value)},e.prototype.updateSelectBox=function(){var e=this;this.currentBoxList.length>1?this.currentBoxList.forEach((function(t){e.selectedBoxBorderList.find((function(e){return e.id===t.id+"-s"}))&&e.showSelectBox(t.element)})):this.currentBox&&this.showSelectBox(this.currentBox.element)},e.prototype.scaleValue=function(e){return Math.ceil(e/this.scalePercent)},e.prototype.reScaleValue=function(e){return Math.ceil(e*this.scalePercent)},e.prototype.calMouseCurrentOffset=function(){this.scalePercent;var e=this.container,t=e.getBoundingClientRect();return{top:t.top,left:t.left,width:e.offsetWidth,height:e.offsetHeight}},e.prototype.initParam=function(e){rU.log("this.containerDiv//",this.containerDiv);var t=this.containerDiv.getElementsByClassName("html-box").length+1;this.setCurrentBox(null),this.isEditing=!0;var i=document.createElement("div");this.newBox=iU.createBox(e.kind);var r=this.newBox.getInitialStyle();Object.assign(i.style,r),i.id=Yy.newGuid(),i.className="html-box active_box",i.style.width="400px",i.style.height="500px",i.style.left=30+30*t+"px",i.style.top=135+30*t+"px",i.innerHTML='<label class="box_placeholder" style="color:rgba(255,255,255,0.65);font-size:32px; ">单击选中富文本<br>双击编辑文本内容...</label>',i.onkeypress=function(e){e.stopPropagation()},this.initBoxEvent(i),this.containerDiv.appendChild(i);var n=i.style.backgroundColor,o=this.serviceManager.richTextService.rgbToRgba(n,.6);o&&(i.style.backgroundColor=o),this.newBox.id=i.id,this.newBox.name=OP.createEntityName(this.newBox.name,this.boxList.map((function(e){return e.name}))),this.newBox.initHtml(i),this.newBox.init();var s=this.newBox.cssPropList.find((function(e){return"type"===e.name}));s&&(s.value=this.newBox.boxType),this.boxList.push(this.newBox),this.setCurrentBox(this.newBox),this.onBoxCreated.next(this.newBox),this.newBox.isInit=!1,rU.log("initParam",this.newBox)},e.prototype.startDraw=function(e){if(this.isDrawPanelShow){var t=this.calMouseCurrentOffset();if(this.setCurrentBox(null),this.isEditing=!0,this.startX=this.scaleValue(e.pageX),this.startY=this.scaleValue(e.pageY),e.target.className.match(/html-box/))this.startDragBox(e);else{var i=document.createElement("div");this.newBox=iU.createBox(this.currentBoxType);var r=this.newBox.getInitialStyle();Object.assign(i.style,r),i.id=Yy.newGuid(),i.className="html-box active_box",i.style.top=this.scaleValue(e.pageY-t.top)+"px",i.style.left=this.scaleValue(e.pageX-t.left)+"px",i.onkeypress=function(e){e.stopPropagation()},this.initBoxEvent(i),this.containerDiv.appendChild(i)}}},e.prototype.drawEnd=function(e){this.isDrawPanelShow=!1;var t=document.getElementsByClassName("active_box")[0];if(t){if(t.className="html-box",t.offsetWidth<50||t.offsetHeight<50)this.containerDiv.removeChild(t),this.onBoxCreated.next(1);else{if(this.newBox.id)return;this.newBox.id=t.id,this.newBox.name=OP.createEntityName(this.newBox.name,this.boxList.map((function(e){return e.name}))),this.newBox.initHtml(t),this.newBox.init();var i=this.newBox.cssPropList.find((function(e){return"type"===e.name}));i&&(i.value=this.newBox.boxType),this.boxList.push(this.newBox),this.setCurrentBox(this.newBox),this.onBoxCreated.next(this.newBox),this.newBox.isInit=!1,"videoBox"===this.newBox.classType&&(this.newBox.videoPath=this.currentBoxPath,this.currentBox.setVideoBox(this.newBox))}this.endHtmlPlot$.next(1)}},e.prototype.setSubtitleListByData=function(e){var t,i,r=this;if(!e||0===e.length)return[];e.forEach((function(e){var t=document.createElement("div");t.innerHTML=e.html,t.children[0].id=e.id,r.containerDiv.appendChild(t.children[0])}));var n=this.containerDiv.getElementsByClassName("html-box-subtitle"),o=Array.from(n),s=[],a=function(e){var t=o.find((function(t){return t.id===e.id}));if(!t)return"continue";t.contentEditable="true",t.addEventListener("input",(function(){r.subTitleChange.next(1)})),t.addEventListener("keydown",(function(e){e.stopPropagation()})),t.addEventListener("keyup",(function(e){e.stopPropagation()})),t.style.display="none";var i=new Gk;i.id=e.id?e.id:t.id,i.name=e.name,i.initHtml(t),i.init(),s.push(i)};try{for(var l=sU(e),h=l.next();!h.done;h=l.next()){a(h.value)}}catch(e){t={error:e}}finally{try{h&&!h.done&&(i=l.return)&&i.call(l)}finally{if(t)throw t.error}}return s},e.prototype.addSubtitleBox=function(e){var t=this,i=document.createElement("div");i.id=Yy.newGuid(),i.className="html-box-subtitle",i.innerHTML=e,i.onkeydown=function(e){e.stopPropagation()},i.contentEditable="true",this.containerDiv.appendChild(i),i.addEventListener("input",(function(e){t.subTitleChange.next(1)})),i.addEventListener("keydown",(function(e){e.stopPropagation()})),i.addEventListener("keyup",(function(e){e.stopPropagation()}));var r=new Gk;r.id=i.id,r.name="字幕",r.initHtml(i);var n=r.getInitialStyle();return Object.assign(i.style,n),r.init(),r.show=!1,r.element.onmousedown=function(e){rU.log("e",e),!t.isDrawPanelShow&&e&&r&&t.setCurrentBox(r)},r},e.prototype.initBoxEvent=function(e){var t=this;e.onmousedown=function(e){e.ctrlKey&&IP.currentEditGraphList.length>0?t.setBoxEditable(!1):t.setBoxEditable(!0),t.boxOnMouseDown(e)},window.onmousemove=function(e){e.ctrlKey&&IP.currentEditGraphList.length>0?t.setBoxEditable(!1):t.setBoxEditable(!0),t.controlCurrentBox(e)},e.onmouseup=function(e){e.ctrlKey&&IP.currentEditGraphList.length>0?t.setBoxEditable(!1):t.setBoxEditable(!0),t.endDragBox()},window.onmouseup=function(e){t.scaling=!1,t.resizing=!1,t.endDragBox(),t.currentBoxHeight=null,t.currentBoxWidth=null,t.currentBox&&t.currentBox.element&&"subtitle"!==t.currentBox.classType&&t.updateOperatorPoint(t.currentBox.element)},e.onkeydown=function(e){e.stopPropagation()}},e.prototype.boxOnMouseDown=function(e){var t;if(!this.isReadOnly&&(!this.isDrawPanelShow&&e))if(t=this.boxList.find((function(t){return t.id===e.currentTarget.id})))this.setCurrentBox(t),this.currentBox instanceof Rk||this.currentBox instanceof Uk||this.startDragBox(e);else if(e.target.parentElement||e.target.parentElement.id){var i=this.boxList.find((function(t){return t.id===e.target.parentElement.id}));i&&(this.setCurrentBox(i),e.target.style.cursor="text")}},e.prototype.setCurrentBox=function(e,t,i){var r=this;if(void 0===t&&(t=!0),void 0===i&&(i=!1),this.currentBox instanceof Yk&&this.currentBox!==e&&this.serviceManager.richTextService.clear(),this.currentBox=e,e&&document.getElementById(e.id))if(document.getElementById(e.id).onkeydown=function(e){e.ctrlKey&&67==e.keyCode&&e.stopPropagation()},document.getElementById(e.id).onkeyup=function(e){e.ctrlKey&&67==e.keyCode&&e.stopPropagation()},e instanceof Gk||this.initBoxEvent(e.element),e instanceof Gk?(this.currentBox=e,this.showSelectBox(e.element,!0)):e instanceof Yk?(this.serviceManager.richTextService.currentHtmlBox||this.serviceManager.richTextService.editor||(this.showSelectBox(e.element),this.showOperator(e.element)),document.getElementById(e.id).ondblclick=function(t){e.isReadOnly||(r.serviceManager.richTextService.setCurrentRichText(e,r.currentBox,r.scalePercent),r.hideOperator())}):(this.showSelectBox(e.element),this.showOperator(e.element)),window.event&&window.event.ctrlKey||i){if(e instanceof Gk)return;this.isCtrlPressedSub$.next(!0);var n=this.currentBoxList.indexOf(e);if(n>-1){var o,s=this.selectedBoxBorderList.find((function(t){return t.id===e.id+"-s"}));if(s&&(s.childNodes.forEach((function(e){e.style.backgroundColor="#FFFFFF"})),s.style.display="none"),this.currentBoxList.splice(n,1),this.currentBoxList.length>=1)(o=new Uk).init(this.currentBoxList),this.currentBox=o,t&&this.onCtrlBoxesSelected.next(this.currentBoxList);else this.onCtrlBoxesSelected.next(null)}else this.currentBoxList.push(e),this.currentBox=e,t&&0===IP.currentEditGraphList.length?this.onBoxSelected.next(e):t&&this.onCtrlBoxesSelected.next(this.currentBoxList);if(this.currentBoxList.length>1)(o=new Uk).init(this.currentBoxList),this.currentBox=o,t&&0===IP.currentEditGraphList.length&&(this.onBoxSelected.next(e),this.onCtrlBoxesSelected.next(this.currentBoxList));this.serviceManager.richTextService.clear(),IP.currentBoxList=this.currentBoxList,this.isCtrlPressedSub$.next(!1)}else this.currentBox=e,this.currentBoxList=[],this.currentBoxList.push(e),IP.currentBoxList=this.currentBoxList,this.selectedBoxBorderList.forEach((function(t){t.childNodes.forEach((function(e){e.style.backgroundColor="#FFFFFF"})),t.id!=e.id+"-s"&&(t.style.display="none")})),t&&this.onBoxSelected.next(e);else this.hideOperator(),this.currentBoxList=[],this.selectedBoxBorderList.forEach((function(e){return e.style.display="none"})),this.currentBox},e.prototype.addImage=function(e,t,i){this.calMouseCurrentOffset();var r=document.createElement("div");r.id=Yy.newGuid(),r.className="html-box",r.style.top=this.scaleValue(t)+"px",r.style.left=this.scaleValue(e)+"px",this.initBoxEvent(r),this.containerDiv.appendChild(r);var n=new Fk;n.name="图片",n.boxType="文本框",n.id=r.id,n.initHtml(r),n.init();var o=n.getInitialStyle();o.height="200px",o.width="200px",Object.assign(r.style,o);var s=n.cssPropList.find((function(e){return"type"===e.name}));s&&(s.value=n.boxType);var a=n.cssPropList.find((function(e){return"background-image"===e.name}));a&&(a.value=i);var l=n.cssPropList.find((function(e){return"background-size"===e.name}));l&&(l.value="适应"),this.boxList.push(n),this.setCurrentBox(n),this.onBoxCreated.next(n)},e.prototype.startDragBox=function(e){if(null!=this.currentBox&&null!=this.currentBox.cssPropList){var t=this.currentBox.cssPropList.find((function(e){return"isReadOnly"===e.name}));if(!t||1!=t.value){this.dragging=!0,this.currentBox.isOperating=!0;var i=document.getElementsByClassName("moving_box")[0];if(i&&(i.className=i.className.replace("moving_box","")),e.target.className+=" moving_box",this.currentBox instanceof Rk)this.diffX=this.scaleValue(e.clientX)-this.currentBox.element.offsetLeft,this.diffY=this.scaleValue(e.clientY)-this.currentBox.element.offsetTop,this.movingBoxElement=this.currentBox.element,this.currentBoxTop=this.currentBox.cssPropList.find((function(e){return"top"===e.name})),this.currentBoxLeft=this.currentBox.cssPropList.find((function(e){return"left"===e.name})),this.currentBoxTop&&this.currentBoxLeft&&(this.beginDragValue={top:this.currentBoxTop.value,left:this.currentBoxLeft.value});else if(this.currentBox instanceof Uk){var r=this.currentBoxList[this.currentBoxList.length-1];this.diffX=this.scaleValue(e.clientX)-r.element.offsetLeft,this.diffY=this.scaleValue(e.clientY)-r.element.offsetTop,this.movingBoxElement=r.element,this.currentBoxTop=r.cssPropList.find((function(e){return"top"===e.name})),this.currentBoxLeft=r.cssPropList.find((function(e){return"left"===e.name})),this.currentBoxTop&&this.currentBoxLeft&&(this.beginDragValue={top:this.currentBoxTop.value,left:this.currentBoxLeft.value});var n=new Map;this.currentBoxList.forEach((function(e){var t=e.cssPropList.find((function(e){return"top"===e.name})),i=e.cssPropList.find((function(e){return"left"===e.name}));if(t&&i){var r={top:t.value,left:i.value};n.set(e.id,r)}})),this.multiBeginValue=n}rU.log(this.diffX,"-----",this.diffY)}}},e.prototype.endDragBox=function(){if(this.dragging){var e=void 0;this.currentBoxTop&&this.currentBoxLeft&&(e={top:this.currentBoxTop.value,left:this.currentBoxLeft.value}),this.operatorEnd.next({target:this.currentBox,beginvalue:this.beginDragValue,endvalue:e,multiBeginValue:this.multiBeginValue}),this.dragging=!1,this.currentBox.isOperating=!1}},e.prototype.controlCurrentBox=function(e){var t=this,i=window.getSelection();if((null==i||""===i.toString().trim())&&null!=this.currentBox&&null!=this.currentBox.cssPropList){var r=this.currentBox.cssPropList.find((function(e){return"isReadOnly"===e.name}));if(!r||!0!==r.value){this.calMouseCurrentOffset();if(this.dragging||this.resizing||this.scaling){if(this.dragging){if(this.movingBoxElement){var n=this.scaleValue(e.pageY)-this.diffY,o=this.scaleValue(e.pageX)-this.diffX;if(this.currentBox instanceof Rk)this.currentBoxTop&&(this.currentBoxTop.value=n),this.currentBoxLeft&&(this.currentBoxLeft.value=o);else if(this.currentBox instanceof Uk){var s=0,a=0;this.currentBoxTop&&(s=n-this.currentBoxTop.value,this.currentBoxTop.value=n),this.currentBoxLeft&&(a=o-this.currentBoxLeft.value,this.currentBoxLeft.value=o);for(var l=0;l<this.currentBoxList.length-1;l++){var h=this.currentBoxList[l].cssPropList.find((function(e){return"top"===e.name})),c=this.currentBoxList[l].cssPropList.find((function(e){return"left"===e.name}));h&&c&&(h.value=h.value+s,c.value=c.value+a),this.showSelectBox(this.currentBoxList[l].element)}}}}else if(this.resizing){if(this.currentBoxList.length>1)return;switch(this.tempDirection){case"WN":this.topHeightResizing(e),this.leftWidthResizing(e);break;case"W":this.leftWidthResizing(e);break;case"WS":this.leftWidthResizing(e),this.heightResizing(e);break;case"S":this.heightResizing(e);break;case"ES":this.widthResizing(e),this.heightResizing(e);break;case"E":this.widthResizing(e);break;case"N":this.topHeightResizing(e);break;case"EN":this.topHeightResizing(e),this.widthResizing(e)}}else if(this.scaling){var u=e.clientX-this.mouseStartX;if(this.currentBox instanceof Rk){var p=this.currentBox.cssPropList.find((function(e){return"width"===e.name})),d=this.currentBox.cssPropList.find((function(e){return"height"===e.name}));d.value=p.value*(d.value+u)/p.value,p.value+=u,this.mouseStartX=e.clientX}else this.currentBox instanceof Uk&&(this.currentBoxList.forEach((function(e){var i=e.cssPropList.find((function(e){return"width"===e.name})),r=e.cssPropList.find((function(e){return"height"===e.name}));r.value=r.value*(i.value+u)/i.value,i.value+=u,t.showSelectBox(e.element)})),this.mouseStartX=e.clientX)}this.showSelectBox(this.movingBoxElement)}}}},e.prototype.resetRichToolbarPos=function(){var e,t=document.getElementById("rich-text-tool-container");t&&((null===(e=this.currentBoxTop)||void 0===e?void 0:e.value)<50?t.style.top="0":t.style.top="-35px")},e.prototype.saveImage=function(e){return nU(this,void 0,void 0,(function(){var t,i;return oU(this,(function(r){return t=e.target.files[0],(i=new FormData).append("type","other"),i.append("file",t),[2]}))}))},e}(),lU=i(2392),hU=function(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var r,n,o=i.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){n={error:e}}finally{try{r&&!r.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}return s};function cU(e,t){for(var i="",r=(e.attr("style")||"").split(";"),n=r.length,o=0;o<n;o++){var s=r[o];if(s){var a=s.split(":");a[0].trim()===t&&(i=a[1].trim())}}return i}lU.R3&&(lU.ZP.fn.append=lU.R3),lU.Ce&&(lU.ZP.fn.prepend=lU.Ce),lU.on&&(lU.ZP.fn.on=lU.on),lU.T_&&(lU.ZP.fn.focus=lU.T_),lU.Lj&&(lU.ZP.fn.attr=lU.Lj),lU.P0&&(lU.ZP.fn.val=lU.P0),lU.dy&&(lU.ZP.fn.html=lU.dy),lU.qm&&(lU.ZP.fn.parent=lU.qm),lU.pv&&(lU.ZP.fn.hasClass=lU.pv),lU.cS&&(lU.ZP.fn.empty=lU.cS),lU.iv&&(lU.ZP.fn.css=lU.iv),lU.cn&&(lU.ZP.fn.addClass=lU.cn),lU.IV&&(lU.ZP.fn.removeClass=lU.IV),lU.uV&&(lU.ZP.fn.removeAttr=lU.uV),lU.Cp&&(lU.ZP.fn.hide=lU.Cp),lU.$Z&&(lU.ZP.fn.show=lU.$Z),lU.cv&&(lU.ZP.fn.offset=lU.cv),lU.bf&&(lU.ZP.fn.width=lU.bf),lU.Cb&&(lU.ZP.fn.height=lU.Cb),lU.wV&&(lU.ZP.fn.parents=lU.wV),lU.is&&(lU.ZP.fn.is=lU.is),lU.gx&&(lU.ZP.fn.dataset=lU.gx),lU.fL&&(lU.ZP.fn.text=lU.fL),lU.pI&&(lU.ZP.fn.children=lU.pI),lU.Od&&(lU.ZP.fn.remove=lU.Od),lU.sE&&(lU.ZP.fn.find=lU.sE),lU.S6&&(lU.ZP.fn.each=lU.S6);const uU=lU.ZP;var pU=["rgb(0, 0, 0)","rgb(38, 38, 38)","rgb(89, 89, 89)","rgb(140, 140, 140)","rgb(191, 191, 191)","rgb(217, 217, 217)","rgb(233, 233, 233)","rgb(245, 245, 245)","rgb(250, 250, 250)","rgb(255, 255, 255)","rgb(225, 60, 57)","rgb(231, 95, 51)","rgb(235, 144, 58)","rgb(245, 219, 77)","rgb(114, 192, 64)","rgb(89, 191, 192)","rgb(66, 144, 247)","rgb(54, 88, 226)","rgb(106, 57, 201)","rgb(216, 68, 147)","rgb(251, 233, 230)","rgb(252, 237, 225)","rgb(252, 239, 212)","rgb(252, 251, 207)","rgb(231, 246, 213)","rgb(218, 244, 240)","rgb(217, 237, 250)","rgb(224, 232, 250)","rgb(237, 225, 248)","rgb(246, 226, 234)","rgb(255, 163, 158)","rgb(255, 187, 150)","rgb(255, 213, 145)","rgb(255, 251, 143)","rgb(183, 235, 143)","rgb(135, 232, 222)","rgb(145, 213, 255)","rgb(173, 198, 255)","rgb(211, 173, 247)","rgb(255, 173, 210)","rgb(255, 77, 79)","rgb(255, 122, 69)","rgb(255, 169, 64)","rgb(255, 236, 61)","rgb(115, 209, 61)","rgb(54, 207, 201)","rgb(64, 169, 255)","rgb(89, 126, 247)","rgb(146, 84, 222)","rgb(247, 89, 171)","rgb(207, 19, 34)","rgb(212, 56, 13)","rgb(212, 107, 8)","rgb(212, 177, 6)","rgb(56, 158, 13)","rgb(8, 151, 156)","rgb(9, 109, 217)","rgb(29, 57, 196)","rgb(83, 29, 171)","rgb(196, 29, 127)","rgb(130, 0, 20)","rgb(135, 20, 0)","rgb(135, 56, 0)","rgb(97, 71, 0)","rgb(19, 82, 0)","rgb(0, 71, 79)","rgb(0, 58, 140)","rgb(6, 17, 120)","rgb(34, 7, 94)","rgb(120, 6, 80)"],dU=function(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var r,n,o=i.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){n={error:e}}finally{try{r&&!r.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}return s},mU=function(){function e(){this.title="描边颜色",this.iconSvg='<svg t="1649915937162" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="12814" width="64" height="64"><path d="M907.562667 907.562667h-230.4l-59.733334-159.829334H416.853333l-57.728 159.829334H128L431.317333 128h172.885334l303.317333 779.562667z m-196.992-46.933334h126.677333L570.965333 175.146667H465.066667L197.76 860.416h127.104l55.466667-159.872h271.104l59.221333 159.872zM614.4 604.842667H413.866667l99.370666-283.989334 101.12 283.946667z m-132.010667-47.189334h64l-33.109333-91.989333-30.848 91.989333z" p-id="12815"></path></svg>',this.tag="button",this.showDropPanel=!0,this.mark="textStrokeColor",this.$content=null}return e.prototype.exec=function(e,t){},e.prototype.getValue=function(e){var t=this.mark,i=window.wangEditor.SlateEditor.marks(e);return i&&i[t]?i[t]:""},e.prototype.isActive=function(e){return!!this.getValue(e)},e.prototype.isDisabled=function(e){return null==e.selection||!!dU(window.wangEditor.SlateEditor.nodes(e,{match:function(t){return"pre"===window.wangEditor.DomEditor.getNodeType(t)||!!window.wangEditor.SlateEditor.isVoid(e,t)},universal:!0}),1)[0]},e.prototype.getPanelContentElem=function(e){var t=this.mark;if(null==this.$content){var i=uU('<ul class="w-e-panel-content-color"></ul>');i.on("click","li",(function(t){var i=t.target;if(null!=i&&(t.preventDefault(),null!=e.selection)){var r=uU(i).attr("data-value");if("0"===r)window.wangEditor.SlateEditor.removeMark(e,"textStrokeColor"),e.removeMark("textStrokeWidth");else{window.wangEditor.SlateEditor.addMark(e,"textStrokeColor",r);var n=window.wangEditor.SlateEditor.marks(e);n.textStrokeWidth&&"0px"!==n.textStrokeWidth||e.addMark("textStrokeWidth","1px")}}})),this.$content=i}var r=this.$content;if(null==r)return document.createElement("ul");r.empty();var n=this.getValue(e);e.getMenuConfig(t);pU.forEach((function(e){var t=uU('<div class="color-block" data-value="'.concat(e,'"></div>'));t.css("background-color",e);var i=uU('<li data-value="'.concat(e,'"></li>'));n===e&&i.addClass("active"),i.append(t),r.append(i)}));var o=uU('\n            <li data-value="0" class="clear">\n                '.concat('<svg viewBox="0 0 1024 1024"><path d="M236.8 128L896 787.2V128H236.8z m614.4 704L192 172.8V832h659.2zM192 64h704c38.4 0 64 25.6 64 64v704c0 38.4-25.6 64-64 64H192c-38.4 0-64-25.6-64-64V128c0-38.4 25.6-64 64-64z"></path></svg>',"\n                ").concat("无","\n            </li>\n        "));return r.prepend(o),r[0]},e}(),fU=function(){function e(){this.title="描边宽度",this.iconSvg="mk",this.tag="select",this.width=60}return e.prototype.getOptions=function(e){var t=[{value:"textStrokeWidth0px",text:"无"},{value:"textStrokeWidth1px",text:"1px"},{value:"textStrokeWidth2px",text:"2px"},{value:"textStrokeWidth3px",text:"3px"},{value:"textStrokeWidth4px",text:"4px"},{value:"textStrokeWidth5px",text:"5px"},{value:"textStrokeWidth6px",text:"6px"},{value:"textStrokeWidth7px",text:"7px"},{value:"textStrokeWidth8px",text:"8px"},{value:"textStrokeWidth9px",text:"9px"},{value:"textStrokeWidth10px",text:"10px"}],i=this.getValue(e);return t.forEach((function(e){e.value===i?e.selected=!0:delete e.selected})),t},e.prototype.isActive=function(e){return!1},e.prototype.getValue=function(e){var t=window.wangEditor.SlateEditor.marks(e);if(t&&t.textStrokeWidth)return"textStrokeWidth".concat(t.textStrokeWidth);var i=function(e){var t=hU(window.wangEditor.SlateEditor.nodes(e,{match:function(e){if(e.textStrokeWidth)return e.textStrokeWidth.slice(0,-2)},universal:!0}),1),i=t[0];if(null==i)return"textStrokeWidth0px";var r=hU(i,1)[0].textStrokeWidth;return r.includes("px")?"textStrokeWidth".concat(r):"textStrokeWidth0px"}(e);return i||"textStrokeWidth0px"},e.prototype.isDisabled=function(e){return function(e){return null==e.selection||!hU(window.wangEditor.SlateEditor.nodes(e,{match:function(e){var t=window.wangEditor.DomEditor.getNodeType(e);return"paragraph"===t||!!t.startsWith("header")},universal:!0,mode:"highest"}),1)[0]}(e)},e.prototype.exec=function(e,t){var i=t.toString().slice(15);"0"===i?e.removeMark("textStrokeWidth"):e.addMark("textStrokeWidth","".concat(i))},e}();function gU(e,t){null==e.data&&(e.data={});var i=e.data;null==i.style&&(i.style={}),Object.assign(i.style,t)}function AU(e,t){var i=e,r=i.textStrokeColor,n=i.textStrokeWidth,o=(i.textAlignLast,i.textAlign,t);return r&&gU(o,{"-webkit-text-stroke-color":r}),n&&gU(o,{"-webkit-text-stroke-width":n}),o}var yU={insertKeys:{index:5,keys:["text-stroke-color","text-stroke-width"]},toolbarKeys:["|","fontFamily","fontSize","color","bgColor","bold","italic","underline","through",{iconSvg:'<svg viewBox="0 0 1024 1024"><path d="M768 793.6v102.4H51.2v-102.4h716.8z m204.8-230.4v102.4H51.2v-102.4h921.6z m-204.8-230.4v102.4H51.2v-102.4h716.8zM972.8 102.4v102.4H51.2V102.4h921.6z"></path></svg>',key:"group-justify",menuKeys:["justifyLeft","justifyRight","justifyCenter","justifyJustify"],title:"对齐"},{iconSvg:'<svg viewBox="0 0 1024 1024"><path d="M0 64h1024v128H0z m384 192h640v128H384z m0 192h640v128H384z m0 192h640v128H384zM0 832h1024v128H0z m0-128V320l256 192z"></path></svg>',key:"group-indent",menuKeys:["indent","delIndent"],title:"缩进"},"lineHeight","insertLink",{iconSvg:'<svg viewBox="0 0 1024 1024"><path d="M959.877 128l0.123 0.123v767.775l-0.123 0.122H64.102l-0.122-0.122V128.123l0.122-0.123h895.775zM960 64H64C28.795 64 0 92.795 0 128v768c0 35.205 28.795 64 64 64h896c35.205 0 64-28.795 64-64V128c0-35.205-28.795-64-64-64zM832 288.01c0 53.023-42.988 96.01-96.01 96.01s-96.01-42.987-96.01-96.01S682.967 192 735.99 192 832 234.988 832 288.01zM896 832H128V704l224.01-384 256 320h64l224.01-192z"></path></svg>',key:"group-image",menuKeys:["uploadImage","insertImage"],title:"图片"},"divider","|"]},vU={};function CU(e,t){if(!window.wangEditor.SlateText.isText(e))return t;var i,r,n,o=e.textStrokeColor,s=e.textStrokeWidth;if(!o&&!s)return t;(n=t,0===(0,lU.ZP)("<div>".concat(n,"</div>")).children().filter((function(e){return"BR"!==e.tagName})).length)?i=(0,lU.ZP)("<span>".concat(t,"</span>")):(i=(0,lU.ZP)(t),"span"!==((r=i).length?r[0].tagName.toLowerCase():"")&&(i=(0,lU.ZP)("<span>".concat(t,"</span>"))));return o&&i.css("-webkit-text-stroke-color",o),s&&i.css("-webkit-text-stroke-width",s),function(e){if(0===e.length)return"";return e[0].outerHTML}(i)}function _U(e,t){if(e=(0,lU.ZP)(e),!window.wangEditor.SlateText.isText(t))return t;var i=t,r=cU(e,"-webkit-text-stroke-color");r&&(i.textStrokeColor=r);var n=cU(e,"-webkit-text-stroke-width");n&&(i.textStrokeWidth=n);var o=cU(e,"-webkit-text-stroke");if(o){var s=o.split(" ")[0];i.textStrokeWidth=s,i.textStrokeColor=o.slice(s.length,o.length).trim()}return i}vU.placeholder="请输入内容",vU.onChange=function(e){},vU.hoverbarKeys={text:{menuKeys:[]}},vU.MENU_CONF={},vU.MENU_CONF.fontFamily={fontFamilyList:["宋体","仿宋","楷体","隶书","幼圆","黑体"]},vU.MENU_CONF.fontSize={fontSizeList:["12px","16px","18px","20px","24px","32px","40px","48px","56px","72px","88px","104px","120px","140px","160px","180px","200px"]},vU.MENU_CONF.lineHeight={lineHeightList:["1.0","1.5","2.0","2.5","3.0"]},vU.MENU_CONF.uploadImage={base64LimitSize:524288e3};var bU=i(5108),wU=function(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var r,n,o=i.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){n={error:e}}finally{try{r&&!r.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}return s},PU=function(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],r=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},SU=function(){function e(e){if(this.prevChangeContent="",this.sceneEditSub$=new th.x,this.scalePercentCopy=1,this.scalePercentCopySub$=new th.x,this.beyondRange=!1,this.serviceManager=e,window.wangEditor){var t={key:"text-stroke-color",factory:function(){return new mU}};window.wangEditor.Boot.registerMenu(t);var i={key:"text-stroke-width",factory:function(){return new fU}};window.wangEditor.Boot.registerMenu(i),window.wangEditor.Boot.registerRenderStyle(AU),window.wangEditor.Boot.registerStyleToHtml(CU),window.wangEditor.Boot.registerParseStyleHtml(_U)}}return e.prototype.setCurrentRichText=function(e,t,i){var r;if(e&&e!==this.currentHtmlBox){t&&t.element.innerHTML.includes("box_placeholder")&&(e.element.innerHTML=""),this.currentHtmlBox=e;var n=e.element.innerHTML;if(n.includes("scroll_box")){var o=this.parseElement(n),s=void 0;if(o.childNodes.length>0){s=o.childNodes[0].outerHTML;for(var a=1;a<o.childNodes.length;a++)s+=o.childNodes[a].outerHTML}n=s}var l=e.element.childNodes;for(a=l.length-1;a>=0;a--)e.element.removeChild(l.item(a));var h=document.createElement("div");h.id="rich-text-tool-container",e.element.appendChild(h);var c=this.updateToolPos(e.element,i,705);h.style.position="absolute",h.style.left=c.curleft,h.style.top=c.curtop,h.style.width="".concat(695,"px"),h.style.height="40px",h.style.transform="scale(".concat(1/i,")"),h.style.zIndex="20";var u=document.createElement("div");u.className="wt-editor-content-wrapper",e.element.appendChild(u),u.style.zIndex="19",u.onkeydown=function(e){e.stopPropagation()},u.onkeyup=function(e){e.stopPropagation()},this.init(h,u,n);var p=document.getElementsByClassName("w-e-bar")[0];this.beyondRange?p&&p.setAttribute("type","bottom"):p&&p.setAttribute("type",""),this.mouseStateUpdate(e),e.isReadOnly&&(null===(r=this.editor)||void 0===r||r.disable())}},e.prototype.modelScale=function(e){var t=document.getElementsByClassName("w-e-modal")[0];bU.log("model",t),t.style.transform="scale(".concat(1/e,")")},e.prototype.updateToolPos=function(e,t,i){var r={curleft:"",curtop:""},n=parseFloat(e.style.top.slice(0,e.style.top.length-2)),o=parseFloat(e.style.left.slice(0,e.style.left.length-2)),s=(parseFloat(e.style.width.slice(0,e.style.width.length-2)),parseFloat(e.style.height.slice(0,e.style.height.length-2))),a=document.getElementById("richTextPanel"),l=parseFloat(a.style.width.slice(0,a.style.width.length-2)),h=parseFloat(a.style.height.slice(0,a.style.height.length-2));n<170?(this.beyondRange=!0,bU.log("上边超出显示区域！"),r.curtop=s+50+"px"):n>h-100?(this.beyondRange=!1,bU.log("下边超出显示区域！"),r.curtop=h-100+"px"):(this.beyondRange=!1,r.curtop=-40/t/2-10/t-20+"px");var c=(i-i*t)/(2*t);return o<0?(bU.log("左边超出显示区域！"),r.curleft=Math.abs(o)+c+"px"):o>l-i/t?(bU.log("右边超出显示区域！"),r.curleft=l-i-o-c+"px",bU.log("curValue.curleft ",r.curleft)):r.curleft="".concat(c,"px"),r},e.prototype.init=function(e,t,i){var r=this,n=window.wangEditor.createEditor({html:i,selector:t,config:Object.assign(vU,{onChange:function(e){var t,i;if(e.getText()){var n=e.getHtml();if(n&&r.prevChangeContent){if(r.prevChangeContent!==n){r.sceneEditSub$.next(!0),r.prevChangeContent=n;var o=window.wangEditor.SlateEditor.nodes(e,{match:function(e){return"image"===e.type},universal:!0});if(null!==o){var s=function(e){var t=wU(e,2),i=t[0];t[1];bU.log("粘贴或修改了图片节点------",i),setTimeout((function(){var e,t=r.editor.toDOMNode(i),n=null===(e=r.editor.getEditableContainer())||void 0===e?void 0:e.querySelector(".w-e-scroll");if(t&&n){var o=t.getBoundingClientRect(),s=n.getBoundingClientRect();o.top>s.top&&o.bottom<s.bottom||t.scrollIntoView(!1)}}))};try{for(var a=PU(o),l=a.next();!l.done;l=a.next()){s(l.value)}}catch(e){t={error:e}}finally{try{l&&!l.done&&(i=a.return)&&i.call(a)}finally{if(t)throw t.error}}}}}else r.prevChangeContent=n}}}),mode:"simple"}),o=(window.wangEditor.createToolbar({editor:n,selector:e,config:yU,mode:"default"}),n.hidePanelOrModal);return n.hidePanelOrModal=function(){"isClickOnColorPickPanel"!==window.wangeditorClickTarget&&o();var e=document.querySelectorAll(".w-e-bar .show-item-menus-dy");e&&e.length&&e.forEach((function(e){e.classList.remove("show-item-menus-dy")}))},setTimeout((function(){var e=document.querySelectorAll(".w-e-bar .w-e-bar-item");e&&e.length&&e.forEach((function(e,t){if(e.className&&e.className.includes("w-e-bar-item-group")){var i=void 0;switch(t){case 10:i="对齐方式";break;case 15:i="缩进设置";break;case 20:i="上传图片"}e.setAttribute("data-tooltip",i),e.classList.add("w-e-menu-tooltip-v5"),e.addEventListener("click",(function(){var t=document.querySelectorAll(".w-e-bar .w-e-select-list");t&&t.length&&t.forEach((function(e){e.style.display="none"})),e.classList.add("show-item-menus-dy")}))}e.addEventListener("mouseleave",(function(e){var t=e.currentTarget,i=t.querySelector(".w-e-select-list");!i&&((i=t.querySelector(".w-e-bar-item-menus-container"))&&i.parentNode.classList.contains("show-item-menus-dy")&&i.parentNode.classList.remove("show-item-menus-dy"),i)||(i||(i=t.querySelector(".w-e-drop-panel")),i&&(i.style.display="none"))}))}))}),100),this.editor=n,setTimeout((function(){var e=window.wangEditor.SlateEditor.end(n,[]);r.editor.select(e)})),this.editor.on("modalOrPanelShow",(function(e){var t;if("modal"===e.type){document.documentElement.style.setProperty("--rich-text-zdy-modal-transform-value","0px, 0px");var i,n=e.$elem[0],o=n.textContent,s="",a="";if(o.includes("链接文本")||o.includes("链接地址")?s="linkModal":o.includes("图片地址")&&(s="picModal"),!o)return;var l=null===(t=window.wangEditor.DomEditor.getToolbar(r.editor))||void 0===t?void 0:t.$toolbar[0];if(!l)return;if(i="bottom"===l.getAttribute("type")?"bottom":"top","linkModal"===s?a=l.querySelector('.w-e-menu-tooltip-v5[data-tooltip="超链接"]'):"picModal"===s&&(a=l.querySelector('.w-e-menu-tooltip-v5[data-tooltip="上传图片"]')),!a)return;if(n.classList.add("rich-text-modal-position-set"),"bottom"===i){var h=l.getBoundingClientRect().top-r.editor.getEditableContainer().getBoundingClientRect().top-n.getBoundingClientRect().height,c=a.getBoundingClientRect().right-n.getBoundingClientRect().right;document.documentElement.style.setProperty("--rich-text-zdy-modal-transform-value","".concat(c/window.scalePercent,"px, ").concat(h/window.scalePercent,"px"))}else if("top"===i){h=l.getBoundingClientRect().bottom-r.editor.getEditableContainer().getBoundingClientRect().top,c=a.getBoundingClientRect().right-n.getBoundingClientRect().right;document.documentElement.style.setProperty("--rich-text-zdy-modal-transform-value","".concat(c/window.scalePercent,"px, ").concat(h/window.scalePercent,"px"))}}})),this.editor},e.prototype.clear=function(){if(this.editor||!this.currentHtmlBox)if(!this.editor||this.currentHtmlBox){if(this.editor&&this.currentHtmlBox){var e=this.editor.getHtml();this.editor.clear(),this.prevChangeContent="";for(var t,i=this.currentHtmlBox.element.childNodes,r=i.length-1;r>=0;r--)this.currentHtmlBox.element.removeChild(i.item(r));if((t=document.createElement("div")).className="scroll_box",t.style.height="100%",t.style.overflowY="auto",t.style.overflowX="hidden",t.style.boxSizing="content-box",e.includes("scroll_box"))this.currentHtmlBox.element.innerHTML=e;else{t.innerHTML=e;var n=this.stringIze(t);this.currentHtmlBox.element.innerHTML=n}"\n"===this.currentHtmlBox.element.innerText&&(this.currentHtmlBox.element.innerHTML='<label class="box_placeholder" style="color:rgba(255,255,255,0.65);font-size:32px; ">单击选中富文本<br>双击编辑文本内容...</label>'),this.currentHtmlBox.element.style.cursor="default",this.currentHtmlBox=void 0,this.editor=void 0}}else this.editor=void 0;else this.currentHtmlBox=void 0},e.prototype.stringIze=function(e){var t=document.createElement("div");return t.appendChild(e),t.innerHTML},e.prototype.parseElement=function(e){var t=document.createElement("div");return t.innerHTML=e,t.childNodes[0]},e.prototype.setTooltip=function(){this.serviceManager.advancedHtmlService.isHtmlEditContent=!1},e.prototype.disable=function(){this.editor&&this.currentHtmlBox&&this.editor.disable()},e.prototype.enable=function(){this.editor&&this.currentHtmlBox&&this.editor.enable()},e.prototype.mouseStateUpdate=function(e){e.element&&(e.element.style.cursor="text")},e.prototype.backColorUpdate=function(e){var t,i,r=e.cssPropList.find((function(e){return"background-color"===e.name})),n=e.cssPropList.find((function(e){return"background-opacity"===e.name})),o=document.getElementsByClassName("w-e-text-container")[0],s=o.firstElementChild.childNodes;if(o&&(r.value&&!n.value&&(o.style.backgroundColor=r.value),r.value&&n.value)){var a=this.hexToRgba(r.value,n.value);if(a){o.style.backgroundColor=a;try{for(var l=PU(s),h=l.next();!h.done;h=l.next()){var c=h.value;"p"===c.localName&&(c.style.backgroundColor="transparent")}}catch(e){t={error:e}}finally{try{h&&!h.done&&(i=l.return)&&i.call(l)}finally{if(t)throw t.error}}}}},e.prototype.hexToRgba=function(e,t){return"rgba("+parseInt("0x"+e.slice(1,3))+","+parseInt("0x"+e.slice(3,5))+","+parseInt("0x"+e.slice(5,7))+","+t+")"},e.prototype.rgbToRgba=function(e,t){var i=e.match(/[\d.]+/g);if(i.length>=3){return"rgba("+i[0]+","+i[1]+","+i[2]+","+t+")"}bU.error("颜色格式不正确！")},e}(),xU=i(4406),BU=i(5108),MU=function(){function e(t){var i=this;this.boardOffsetX="100",this.boardOffsetY="100",this.wordNumberLimit=15,this.boardMoveZIndex=1,this.graphBoardStyle=[{id:1,pic:"/assets/images/label/label1.png",line:{"border-bottom":"3px solid rgba(255, 255, 255, 0.8)","margin-top":"10px"},boardLine:"3px solid rgba(255, 255, 255, 0.8)",boardPic:"/assets/images/label/board1.png",wordNumber:4},{id:2,pic:"/assets/images/label/label2.png",line:{"border-bottom":"3px dotted rgba(255, 229, 14, 0.8)","margin-top":"10px"},boardLine:"3px dotted rgba(255, 229, 14, 0.8)",boardPic:"/assets/images/label/board2.png",wordNumber:4},{id:3,pic:"/assets/images/label/label3.png",line:{"border-bottom":"3px dashed rgba(13, 217, 168, 0.8)","margin-top":"10px"},boardLine:"3px dashed rgba(13, 217, 168, 0.8)",boardPic:"/assets/images/label/board3.png",wordNumber:4},{id:4,pic:"/assets/images/label/label4.png",line:{"border-bottom":"3px solid rgba(255, 255, 255, 0.8)","margin-top":"10px"},boardLine:"3px solid rgba(255, 255, 255, 0.8)",boardPic:"/assets/images/label/board4.png",wordNumber:4},{id:5,pic:"/assets/images/label/label5.png",line:{"border-bottom":"3px dotted rgba(0, 168, 133, 0.8)","margin-top":"10px"},boardLine:"3px dotted rgba(0, 168, 133, 0.8)",boardPic:"/assets/images/label/board5.png",wordNumber:4},{id:6,pic:"/assets/images/label/label6.png",line:{"border-bottom":"3px dashed rgba(255, 255, 255, 0.8)","margin-top":"9px"},boardLine:"3px dashed rgba(255, 255, 255, 0.8)",boardPic:"/assets/images/label/board6.png",wordNumber:8},{id:7,pic:"/assets/images/label/label7.png",line:{"border-bottom":"3px solid rgba(0, 136, 240, 0.8)","margin-top":"10px"},boardLine:"3px solid rgba(0, 136, 240, 0.8)",boardPic:"/assets/images/label/board7.png",wordNumber:8},{id:8,pic:"/assets/images/label/label8.png",line:{"border-bottom":"3px dotted rgba(5, 167, 254, 0.8)","margin-top":"10px"},boardLine:"3px dotted rgba(5, 167, 254, 0.8)",boardPic:"/assets/images/label/board8.png",wordNumber:8},{id:9,pic:"/assets/images/label/label9.png",line:{"border-bottom":"3px dashed rgba(245, 230, 4, 0.8)","margin-top":"10px"},boardLine:"3px dashed rgba(245, 230, 4, 0.8)",boardPic:"/assets/images/label/board9.png",wordNumber:8},{id:10,pic:"/assets/images/label/label10.png",line:{"border-bottom":"3px solid rgba(169, 16, 0, 0.8)","margin-top":"10px"},boardLine:"3px solid rgba(169, 16, 0, 0.8)",boardPic:"/assets/images/label/board10.png",wordNumber:8},{id:11,pic:"/assets/images/label/label11.png",line:{"border-bottom":"3px dotted rgba(255, 255, 255, 0.8)","margin-top":"10px"},boardLine:"3px dotted rgba(255, 255, 255, 0.8)",boardPic:"/assets/images/label/board11.png",wordNumber:15},{id:12,pic:"/assets/images/label/label12.png",line:{"border-bottom":"3px dashed rgba(249, 74, 143, 0.8)","margin-top":"10px"},boardLine:"3px dashed rgba(249, 74, 143, 0.8)",boardPic:"/assets/images/label/board12.png",wordNumber:15},{id:13,pic:"/assets/images/label/label13.png",line:{"border-bottom":"3px solid rgba(15, 126, 75, 0.8)","margin-top":"10px"},boardLine:"3px solid rgba(15, 126, 75, 0.8)",boardPic:"/assets/images/label/board13.png",wordNumber:15},{id:14,pic:"/assets/images/label/label14.png",line:{"border-bottom":"3px dotted rgba(255, 255, 255, 0.8)","margin-top":"10px"},boardLine:"3px dotted rgba(255, 255, 255, 0.8)",boardPic:"/assets/images/label/board14.png",wordNumber:15},{id:15,pic:"/assets/images/label/label15.png",line:{"border-bottom":"3px dashed rgba(241, 72, 113, 0.8)","margin-top":"10px"},boardLine:"3px dashed rgba(241, 72, 113, 0.8)",boardPic:"/assets/images/label/board15.png",wordNumber:15}],this.boardGraphMap={},this.maxLengthTextSub$=new th.x,this.changeBoardStyleUndoRedoSub$=new th.x,this.isPrevent=!1,this.needDetchanged$=new th.x,this.both2DAnd3DSelectChanged=!1,this.serviceManager=t,e.instance=this,this.serviceManager.plotService.onSelectChanged.subscribe((function(e){i.propertyItem=e})),this.serviceManager.htmlDrawService.onBoxSelected.subscribe((function(e){i.propertyItem=e,"3D"!==i.serviceManager.plotService.isCrossSelectedNodes2Or3||i.serviceManager.animationService.isMultiSelect||i.serviceManager.plotService.clearCrossSelectedNodes$.next(null)})),this.serviceManager.htmlDrawService.onCtrlBoxesSelected.subscribe((function(e){i.propertyItem=e})),this.serviceManager.drawbigfileService.isRefresh$.subscribe((function(e){i.propertyItem=e,i.propertyType="bigfile"})),this.serviceManager.musicService.chooseMusic$.subscribe((function(e){i.propertyItem=e})),this.maxLengthTextSub$.pipe((0,xU.p)(2e3)).subscribe((function(){BU.warn("输入内容不能超过".concat(i.wordNumberLimit,"个字"))}))}return Object.defineProperty(e.prototype,"propertyItem",{get:function(){return this._propertyItem},set:function(e){this.isPrevent||(this.isPrevent=!0,this._propertyItem instanceof bF||this._propertyItem instanceof xF?this._propertyItem.removePathLine():this._propertyItem instanceof Array&&this._propertyItem.forEach((function(e){(e instanceof bF||e instanceof xF)&&e.removePathLine()})),e instanceof bF||e instanceof xF?e.createPathLine():e instanceof Array&&e[0]instanceof Px&&e.forEach((function(e){(e instanceof bF||e instanceof xF)&&e.createPathLine()})),this._propertyItem=e,e instanceof rv||e instanceof Array&&e[0]instanceof rv?(this.propertyType="Graph",this.serviceManager.layerService.isLayerCtrlPressed||this.serviceManager.plotService.gm.editor.isCtrlPressed||this.both2DAnd3DSelectChanged||this.serviceManager.plotService.showFrameSelection||(this.serviceManager.htmlDrawService.setCurrentBox(null,!1),this.serviceManager.geojsonService.currentGeojson=null),this.serviceManager.animationService.selectTimeLine=null):e instanceof Rk||e instanceof Array&&e[0]instanceof Rk?(this.propertyType="HtmlBox",this.serviceManager.layerService.isLayerCtrlPressed||this.serviceManager.plotService.gm.editor.isCtrlPressed||this.both2DAnd3DSelectChanged||this.serviceManager.plotService.showFrameSelection||(this.serviceManager.plotService.changeSelect(null),this.serviceManager.geojsonService.currentGeojson=null),this.serviceManager.animationService.selectTimeLine=null):e instanceof cP?(this.propertyType="Geojson",this.serviceManager.layerService.isLayerCtrlPressed||this.serviceManager.plotService.gm.editor.isCtrlPressed||this.both2DAnd3DSelectChanged||this.serviceManager.plotService.showFrameSelection||(this.serviceManager.htmlDrawService.setCurrentBox(null,!1),this.serviceManager.plotService.changeSelect(null)),this.serviceManager.animationService.selectTimeLine=null):e instanceof BP||e instanceof Array&&e[0]instanceof BP?(this.propertyType="Music",this.serviceManager.layerService.isLayerCtrlPressed||this.serviceManager.plotService.gm.editor.isCtrlPressed||this.both2DAnd3DSelectChanged||this.serviceManager.plotService.showFrameSelection||(this.serviceManager.htmlDrawService.setCurrentBox(null,!1),this.serviceManager.geojsonService.currentGeojson=null),this.serviceManager.animationService.selectTimeLine=null):e instanceof Tw||e instanceof Array&&e[0]instanceof Tw?(this.propertyType="GpLayer",this.serviceManager.layerService.isLayerCtrlPressed||this.serviceManager.plotService.gm.editor.isCtrlPressed||this.both2DAnd3DSelectChanged||this.serviceManager.plotService.showFrameSelection||(this.serviceManager.htmlDrawService.setCurrentBox(null,!1),this.serviceManager.geojsonService.currentGeojson=null),this.serviceManager.animationService.selectTimeLine=null):null!=e?(this.serviceManager.htmlDrawService.setCurrentBox(null,!1),this.serviceManager.plotService.changeSelect(null)):(this.propertyType="",!this.serviceManager.plotService.gm||this.serviceManager.plotService.gm.editor.isCtrlPressed||this.serviceManager.layerService.isLayerCtrlPressed||this.both2DAnd3DSelectChanged||this.serviceManager.plotService.showFrameSelection||(this.serviceManager.htmlDrawService.setCurrentBox(null,!1),this.serviceManager.plotService.changeSelect(null),this.serviceManager.musicService.clearMultiSelectMusics()),this.serviceManager.animationService.selectTimeLine=null),e instanceof Px?this.serviceManager.animationService.itemAnimation=[]:this.serviceManager.animationService.initAnimationList(e),this.isPrevent=!1)},enumerable:!1,configurable:!0}),e.prototype.setselectItem=function(e){this.isPrevent=!0,this.serviceManager.htmlDrawService.setCurrentBox(null,!1),this.serviceManager.animationService.selectTimeLine=null,this.serviceManager.geojsonService.currentGeojson=null,this.serviceManager.plotService.changeSelect(null),this.isPrevent=!1,e instanceof rv||e instanceof Array&&e[0]instanceof rv?this.serviceManager.plotService.changeSelect(e):e instanceof Rk?this.serviceManager.htmlDrawService.setCurrentBox(e,!1):e instanceof cP?this.serviceManager.geojsonService.currentGeojson=e:this.serviceManager.animationService.selectTimeLine=e},e.prototype.changeGraphBoardShow=function(e,t){var i=this.serviceManager.plotService.gm.editor.currentEditGraphList;if(i.length>1)BU.warn("只可同时为一个元素".concat(e?"添加":"取消","标牌"));else{t.o.graphBoardShow=e;var r=i[0].graphBoardId?i[0].graphBoardId:i[0].id;t.o.graphBoardShow?this.addGraphBoard(r):this.removeGraphBoard(r)}},e.prototype.changeGraphBoardStyle=function(e,t){var i=this.serviceManager.plotService.gm.editor.currentEditGraphList;if(i.length>1)BU.warn("只可为一个元素添加标牌");else if(t.o.graphBoardShow){var r=t.o.graphBoardStyle;t.o.graphBoardStyle=e.id,t.o.graphBoardPic=e.boardPic;var n=this.selectEntityByBoardId(i[0].id).position.getValue(),o=this.getBoardDivByModel(i),s=document.querySelector("#gp-o-board-wrapper-".concat(o));s?this.setBoardStyle(s,e,o):this.createGraphBoard(e,o,t.o.graphBoardLinePosition,n),i[0].graphBoardId=o,this.changeBoardStyleUndoRedoSub$.next({o:t.o,meta:t.meta,oldValue:r}),BU.log("已切换成标牌".concat(e.id))}},e.prototype.setBoardStyle=function(e,t,i){var r;this.wordNumberLimit=t.wordNumber,e.style.backgroundImage="url(".concat(t.boardPic,")");var n,o=e.querySelector("#board-line-".concat(i)),s=e.querySelector("#board-input-".concat(i));switch(o.style.borderBottom=t.boardLine,t.id){case 1:n="138px",e.style.width="264px",e.style.height="60px",e.style.padding="11px 25px 10px 25px",s.placeholder="四字标题",s.style.width=n,s.style.fontSize="32px",s.dataset.inputnocontentwidth=n;break;case 2:n="138px",e.style.width="239px",e.style.height="84px",e.style.padding="19px 25px 10px 25px",s.placeholder="四字标题",s.style.width=n,s.style.fontSize="32px",s.dataset.inputnocontentwidth=n;break;case 3:n="138px",e.style.width="244px",e.style.height="68px",e.style.padding="16px 25px 10px 25px",s.placeholder="四字标题",s.style.width=n,s.style.fontSize="32px",s.dataset.inputnocontentwidth=n;break;case 4:n="138px",e.style.width="216px",e.style.height="100px",e.style.padding="32px 25px 10px 25px",s.placeholder="四字标题",s.style.width=n,s.style.fontSize="32px",s.dataset.inputnocontentwidth=n;break;case 5:n="138px",e.style.width="250px",e.style.height="98px",e.style.padding="22px 25px 10px 25px",s.placeholder="四字标题",s.style.width=n,s.style.fontSize="32px",s.dataset.inputnocontentwidth=n;break;case 6:n="215px",e.style.width="291px",e.style.height="87px",e.style.padding="12px 25px 10px 25px",s.placeholder="最多可输入八个字",s.style.fontSize="24px",s.style.width=n,s.dataset.inputnocontentwidth=n;break;case 7:n="215px",e.style.width="283px",e.style.height="65px",e.style.padding="18px 25px 10px 25px",s.placeholder="最多可输入八个字",s.style.fontSize="24px",s.style.width=n,s.dataset.inputnocontentwidth=n;break;case 8:n="215px",e.style.width="376px",e.style.height="77px",e.style.padding="25px 25px 10px 25px",s.placeholder="最多可输入八个字",s.style.fontSize="24px",s.style.width=n,s.dataset.inputnocontentwidth=n;break;case 9:n="215px",e.style.width="297px",e.style.height="78px",e.style.padding="25px 25px 10px 25px",s.placeholder="最多可输入八个字",s.style.fontSize="24px",s.style.width=n,s.dataset.inputnocontentwidth=n;break;case 10:n="215px",e.style.width="309px",e.style.height="65px",e.style.padding="14px 25px 10px 25px",s.placeholder="最多可输入八个字",s.style.fontSize="24px",s.style.width=n,s.dataset.inputnocontentwidth=n;break;case 11:n="345px",e.style.width="421px",e.style.height="73px",e.style.padding="26px 25px 10px 25px",s.placeholder="此处最多可输入十五个文字内容...",s.style.fontSize="20px",s.style.width=n,s.dataset.inputnocontentwidth=n;break;case 12:n="345px",e.style.width="402px",e.style.height="62px",e.style.padding="20px 5px 10px 15px",s.placeholder="此处最多可输入十五个文字内容...",s.style.fontSize="20px",s.style.width=n,s.dataset.inputnocontentwidth=n;break;case 13:n="345px",e.style.width="410px",e.style.height="61px",e.style.padding="20px 5px 10px 45px",s.placeholder="此处最多可输入十五个文字内容...",s.style.fontSize="20px",s.style.width=n,s.dataset.inputnocontentwidth=n;break;case 14:n="345px",e.style.width="478px",e.style.height="79px",e.style.padding="18px 5px 10px 55px",s.placeholder="此处最多可输入十五个文字内容...",s.style.fontSize="20px",s.style.width=n,s.dataset.inputnocontentwidth=n;break;case 15:n="345px",e.style.width="383px",e.style.height="64px",e.style.padding="22px 25px 10px 25px",s.placeholder="此处最多可输入十五个文字内容...",s.style.fontSize="20px",s.style.width=n,s.dataset.inputnocontentwidth=n}s.className="board-input-style-".concat(t.id),s.style.letterSpacing="3px",s.setAttribute("maxlength","".concat(this.wordNumberLimit)),s.value&&s.value.length>this.wordNumberLimit&&(s.value=s.value.slice(0,this.wordNumberLimit)),this.computeInputWidth(s),this.boardGraphMap[i]=null===(r=document.querySelector("#gp-o-board-wrapper-".concat(i)))||void 0===r?void 0:r.outerHTML},e.prototype.createGraphBoard=function(e,t,i,r){var n,o=Cesium.SceneTransforms.wgs84ToWindowCoordinates(this.serviceManager.viewer.scene,r),s=document.createElement("div");s.id="gp-o-board-wrapper-".concat(t),s.style.position="absolute",s.dataset.offsetX=this.boardOffsetX,s.dataset.offsetY=this.boardOffsetY,s.style.backgroundSize="100% 100%",s.style.backgroundRepeat="no-repeat",s.style.padding="10px",s.style.textAlign="center";var a=document.createElement("input");a.type="text",a.autocomplete="off",a.id="board-input-".concat(t),a.style.outline="none",a.style.border="none",a.style.padding="0px",a.style.margin="0px",a.dataset.iszhcn="false",this.addEventToBoard(s,a);var l=document.createElement("div");l.id="board-line-".concat(t),l.style.height="0px",l.style.position="absolute",l.contentEditable="false",this.setBoardPosition(o,i,s,l),s.appendChild(a),s.appendChild(l),null===(n=document.querySelector("#cesium-div"))||void 0===n||n.appendChild(s),this.setBoardStyle(s,e,t),this.setGraphBoardRelation(t,s.id)},e.prototype.setBoardPosition=function(e,t,i,r){if(null!==i.dataset.offsetX&&void 0!==i.dataset.offsetX||(i.dataset.offsetX=this.boardOffsetX),null!==i.dataset.offsetY&&void 0!==i.dataset.offsetY||(i.dataset.offsetY=this.boardOffsetY),i.dataset.linePosition=t,"leftTop"===t){i.dataset.offsetX="-100",i.dataset.offsetY="-100",i.style.top="".concat(Math.ceil(e.y)+parseInt(i.dataset.offsetX),"px"),i.style.left="".concat(Math.ceil(e.x)+parseInt(i.dataset.offsetY),"px"),i.style.transform="translate(-100%, -100%)";var n=Math.floor(Math.sqrt(Math.pow(parseInt(i.dataset.offsetX),2)+Math.pow(parseInt(i.dataset.offsetY),2)));r.style.width="".concat(n,"px"),r.style.top="100%",r.style.left="100%",r.style.transformOrigin="left"}else if("leftBottom"===t){i.dataset.offsetX="100",i.dataset.offsetY="-100",i.style.top="".concat(Math.ceil(e.y)+parseInt(this.boardOffsetY),"px"),i.style.left="".concat(Math.ceil(e.x)+parseInt(this.boardOffsetX),"px");n=Math.floor(Math.sqrt(Math.pow(parseInt(i.dataset.offsetX),2)+Math.pow(parseInt(i.dataset.offsetY),2)));i.style.transform="translate(-100%, 0%)",r.style.width="".concat(n,"px"),r.style.top="0%",r.style.left="100%",r.style.transformOrigin="left"}else if("rightTop"===t){i.dataset.offsetX="-100",i.dataset.offsetY="100",i.style.top="".concat(Math.ceil(e.y)+parseInt(this.boardOffsetY),"px"),i.style.left="".concat(Math.ceil(e.x)+parseInt(this.boardOffsetX),"px");n=Math.floor(Math.sqrt(Math.pow(parseInt(i.dataset.offsetX),2)+Math.pow(parseInt(i.dataset.offsetY),2)));i.style.transform="translate(0%, -100%)",r.style.width="".concat(n,"px"),r.style.top="100%",r.style.left="0%",r.style.transformOrigin="left"}else if("rightBottom"===t){i.dataset.offsetX="100",i.dataset.offsetY="100",i.style.top="".concat(Math.ceil(e.y)+parseInt(this.boardOffsetY),"px"),i.style.left="".concat(Math.ceil(e.x)+parseInt(this.boardOffsetX),"px");n=Math.floor(Math.sqrt(Math.pow(parseInt(i.dataset.offsetX),2)+Math.pow(parseInt(i.dataset.offsetY),2)));i.style.transform="translate(0%, 0%)",r.style.width="".concat(n,"px"),r.style.top="0px",r.style.left="0px",r.style.transformOrigin="left"}},e.prototype.changeBoardPosition=function(e){var t=this.serviceManager.plotService.gm.editor.currentEditGraphList,i=this.getBoardDivByModel(t),r=document.querySelector("#gp-o-board-wrapper-".concat(i));if(r){var n=document.querySelector("#board-line-".concat(i)),o=this.selectEntityByBoardId(t[0].id).position.getValue(),s=Cesium.SceneTransforms.wgs84ToWindowCoordinates(this.serviceManager.viewer.scene,o);n&&this.setBoardPosition(s,e,r,n)}},e.prototype.setGraphBoardRelation=function(e,t){var i;this.boardGraphMap[e]||(this.selectEntityByBoardId(e).graph.graphBoardId=e);this.boardGraphMap[e]=null===(i=document.querySelector("#".concat(t)))||void 0===i?void 0:i.outerHTML},e.prototype.removeGraphBoard=function(e){var t,i=document.querySelector("#gp-o-board-wrapper-".concat(e));i&&(null===(t=document.querySelector("#cesium-div"))||void 0===t||t.removeChild(i))},e.prototype.addGraphBoard=function(e){var t,i,r=this.boardGraphMap[e];if(r)if("string"==typeof r){var n=document.createElement("div");n.innerHTML=r,null===(t=document.querySelector("#cesium-div"))||void 0===t||t.appendChild(n.childNodes[0])}else null===(i=document.querySelector("#cesium-div"))||void 0===i||i.appendChild(r);else{var o=this.serviceManager.plotService.gm.editor.currentEditGraphList;this.changeGraphBoardStyle(this.graphBoardStyle[0],{o:o[0]})}var s=document.querySelector("#gp-o-board-wrapper-".concat(e)),a=document.querySelector("#board-input-".concat(e));if(s&&a&&this.addEventToBoard(s,a),s){var l=parseInt(s.style.zIndex);this.boardMoveZIndex<l&&(this.boardMoveZIndex=l+1)}},e.prototype.getBoardDivByModel=function(e){var t=e[0].graphBoardId;return t||(t=e[0].id),t},e.prototype.addEventToBoard=function(e,t){var i,r=this;e.onmousedown=function(n){r.serviceManager.plotService.gm.editor.isReadOnly?i=null:(i=n,e.style.zIndex="".concat(r.boardMoveZIndex++),setTimeout((function(){i&&(e.style.cursor="move",t.style.cursor="move")}),300))},e.onmouseup=function(r){i=null,e.style.cursor="default",t.style.cursor="default"},e.onmouseleave=function(r){i&&(i=null,e.style.cursor="default",t.style.cursor="default")},e.onmousemove=function(t){i&&e.dataset.offsetX&&e.dataset.offsetY&&(e.dataset.offsetX="".concat(parseInt(e.dataset.offsetX)-i.y+t.y),e.dataset.offsetY="".concat(parseInt(e.dataset.offsetY)-i.x+t.x),i=t)},e.onclick=function(t){if(!r.serviceManager.plotService.gm.editor.isReadOnly){var i=e.id.slice(19);r.serviceManager.plotService.gm.editor.nextMode("select",r.selectEntityByBoardId(i))}},t.addEventListener("compositionstart",(function(e){t.dataset.iszhcn="true"})),t.addEventListener("compositionend",(function(e){e.target.value.length>=r.wordNumberLimit&&r.maxLengthTextSub$.next(null),t.dataset.iszhcn="false"})),t.oninput=function(e){var i=e.key;"false"===t.dataset.iszhcn&&"delete"!==i&&"backspace"!==i&&"arrowup"!==i&&"arrowleft"!==i&&"arrowdown"!==i&&"arrowright"!==i&&e.target.value.length>=r.wordNumberLimit&&r.maxLengthTextSub$.next(null),r.computeInputWidth(t)}},e.prototype.selectEntityByBoardId=function(e){var t,i,r=this.serviceManager.plotService.gm.editor.currentEditGraphList;if(e&&1===r.length&&r[0].graphBoardId===e)return r[0].ent;for(var n=this.serviceManager.viewer.entities._entities._array,o=0;o<n.length;o++)if((null===(i=null===(t=n[o])||void 0===t?void 0:t.graph)||void 0===i?void 0:i.graphBoardId)===e)return n[o];var s=this.serviceManager.viewer.entities.getById(e);return s||null},e.prototype.computeInputWidth=function(e){if(e.value){var t=e.value,i=document.createElement("span");i.innerText=t,i.style.fontSize=e.style.fontSize,i.style.letterSpacing=e.style.letterSpacing,i.style.visibility="hidden",document.body.appendChild(i),e.style.width="".concat(i.getBoundingClientRect().width,"px"),document.body.removeChild(i)}else e.dataset.inputnocontentwidth&&(e.style.width=e.dataset.inputnocontentwidth);e.setAttribute("value",e.value)},e}();const EU=function(){function e(e){this._engine=e,this._viewer=e.viewer}return e.prototype.load=function(e){this._baseUrl=e,this.plotService._baseUrl=e,this._propertyService||(this._propertyService=new MU(this))},Object.defineProperty(e.prototype,"engine",{get:function(){return this._engine},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"viewer",{get:function(){return this._viewer},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"baseUrl",{get:function(){return this._baseUrl},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cesiumService",{get:function(){return this._cesiumService||(this._cesiumService=new bk),this._cesiumService},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"configService",{get:function(){return this._configService||(this._configService=new Sw),this._configService},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"actionService",{get:function(){return this._actionService||(this._actionService=new mN(this)),this._actionService},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"httpService",{get:function(){return this._httpService||(this._httpService=PP),this._httpService},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"clusterService",{get:function(){return this._clusterService||(this._clusterService=new Pw),this._clusterService},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"layerService",{get:function(){return this._layerService||(this._layerService=new xH(this)),this._layerService},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"geojsonPlotService",{get:function(){return this._geojsonPlotService||(this._geojsonPlotService=new gP(this.viewer)),this._geojsonPlotService},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"drawbigfileService",{get:function(){return this._drawbigfileService||(this._drawbigfileService=new Fw(this)),this._drawbigfileService},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"musicService",{get:function(){return this._musicService||(this._musicService=new HP(this.message)),this._musicService},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"plotService",{get:function(){return this._plotService||(this._plotService=new CH(this.engine)),this._plotService},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"message",{get:function(){return this._message||(this._message=new MH),this._message},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"geojsonService",{get:function(){return this._geojsonService||(this._geojsonService=new gP(this.viewer)),this._geojsonService},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"animationService",{get:function(){return this._animationService||(this._animationService=new VQ(this)),this._animationService},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"drawService",{get:function(){return this._drawService||(this._drawService=new uk(this.viewer)),this._drawService},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pinyinTool",{get:function(){return this._pinyinTool||(this._pinyinTool=new LH),this._pinyinTool},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"htmlDrawService",{get:function(){return this._htmlDrawService||(this._htmlDrawService=new aU(this)),this._htmlDrawService},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"richTextService",{get:function(){return this._richTextService||(this._richTextService=new SU(this)),this._richTextService},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"advancedHtmlService",{get:function(){return this._advancedHtmlService||(this._advancedHtmlService=new TH),this._advancedHtmlService},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"propertyService",{get:function(){return this._propertyService||(this._propertyService=new MU(this)),this._propertyService},enumerable:!1,configurable:!0}),e}();var TU=i(5108),OU=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),LU=function(e){function t(t){var i=e.call(this)||this;return i._serviceManager=t,i}return OU(t,e),t.prototype.createPlot=function(e,t,i,r){var n,o;if(this.curTreeList&&this.curTreeList.length||(this.curTreeList=this._serviceManager.plotService.gm.treeList),this.plotDataBasic=this.curTreeList.find((function(e){return e.label===t})),this.plotDataBasic&&(n=this.plotDataBasic.children.find((function(e){return e.label===i}))),n?(o=n.data.find((function(e){return e.label===r})))&&e&&e.properties&&Object.assign(o.params,e.properties):(e&&e.properties&&(e=JSON.parse(JSON.stringify(e).replace(/properties/g,"params"))),o=e),Pt.isEmpty(o))return TU.warn("无效的参数，请认真阅读接口指南"),null;var s=this._serviceManager.actionService.createPlot(o,!0);if(!s)return TU.warn("无效的参数，请认真阅读接口指南"),null;var a=new ia(s);return this._serviceManager.engine.sceneTree.addSceneObject(a),this.fire("add",a),a},t.prototype.createPlotPicture=function(){this.plotDataPic=this.curTreeList.find((function(e){return"图片"===e.label}))},t.prototype.createPlotModel=function(){this.plotDataModel=this.curTreeList.find((function(e){return"模型"===e.label}))},t.prototype.loaded=function(){this.curTreeList=this._serviceManager.plotService.gm.treeList},t.prototype.onPick=function(e){this.editor&&(this.editor.onEditChanged=e)},t.prototype.open=function(){this._serviceManager.plotService.gm.start()},t.prototype.close=function(){this._serviceManager.plotService.gm.destroyHandler()},Object.defineProperty(t.prototype,"editor",{get:function(){return this._serviceManager.plotService.gm?this._serviceManager.plotService.gm.editor:void 0},enumerable:!1,configurable:!0}),t}(p),DU=i(5108),IU=function(){return IU=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},IU.apply(this,arguments)},RU=function(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],r=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},HU=function(){function e(e){this.attrList=["show","alpha","saturation","contrast","brightness","hue"],this.gpList=[],this.viewer=e}return e.prototype.setListByData=function(e){var t,i,r=this;if(e&&e.length>0){try{for(var n=RU(e),o=n.next();!o.done;o=n.next()){var s=o.value;this.initListData(s)}}catch(e){t={error:e}}finally{try{o&&!o.done&&(i=n.return)&&i.call(n)}finally{if(t)throw t.error}}this.gpList.sort((function(e,t){return e.currentLevel-t.currentLevel})),DU.log("gplist>>>",this.gpList),this.gpList.forEach((function(e){var t;t="mbtiles"===e.serviceInfo.type?r.getLayer({url:e.serviceInfo.serviceUrl,maxZoom:e.serviceInfo.metaInfo.maxZoom},"mbtiles"):"shp"===e.serviceInfo.type?r.getLayer({url:e.serviceInfo.serviceUrl},"shp"):r.getLayer({url:e.serviceInfo.serviceUrl},"tif",e.serviceInfo),e.cesiumLayer=t}))}},e.prototype.initListData=function(e){var t=this.createGpObjectNoLayer(IU({},e));this.gpList.length>0&&this.gpList.find((function(t){return t.id===e.id}))||this.gpList.push(t)},e.prototype.createGpObjectNoLayer=function(e){var t=new Tw;return t.id=e.id,t.name=e.name,t.type=e.type,t.thumb=e.thumb,t._src=e._src,t.isAni=!0,t.serviceInfo=e.serviceInfo?e.serviceInfo:e.service_info,this.attrList.concat("currentLevel").forEach((function(i){void 0!==e["_".concat(i)]?t[i]=e["_".concat(i)]:"show"===i?t.show=!0:"hue"===i?t.hue=0:t[i]=1})),Ow.register(t),t},e.prototype.getLayer=function(e,t,i){var r,n;if("mbtiles"===t)n=new Cesium.UrlTemplateImageryProvider({url:e.url,maximumLevel:Number(null==e?void 0:e.maxZoom),minimumLevel:Number(null==e?void 0:e.minZoom),tilingScheme:new Cesium.GeographicTilingScheme});else if("shp"===t)n=new Cesium.UrlTemplateImageryProvider({url:e.url});else if("tif"===t)if((null===(r=null==i?void 0:i.metaInfo)||void 0===r?void 0:r.bounds)&&parseFloat(null==i?void 0:i.maxZoom)>=0&&parseFloat(null==i?void 0:i.minZoom)>=0){var o=i.metaInfo.bounds.split(",");n=new Cesium.UrlTemplateImageryProvider({url:e.url,rectangle:Cesium.Rectangle.fromDegrees(Number(o[0]),Number(o[1]),Number(o[2]),Number(o[3])),maximumLevel:i.maxZoom,minimumLevel:i.minZoom})}else n=new Cesium.UrlTemplateImageryProvider({url:e.url});return this.viewer.imageryLayers.addImageryProvider(n)},e.prototype.cleanAll=function(){var e=this;this.gpList.forEach((function(t){var i=t.cesiumLayer;e.viewer.imageryLayers.remove(i)})),this.gpList.splice(0,this.gpList.length)},e}();const FU=HU;var NU=i(5108),QU=function(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],r=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},kU=function(){function e(e){this.boxList=new Array,this.scalePercent=1,this.init(e)}return e.prototype.init=function(e){var t=document.getElementById("html-draw-container");if(t)this.containerDiv=t;else{this.outsideHtml=document.createElement("div"),this.outsideHtml.style.pointerEvents="none",this.outsideHtml.style.width="100%",this.outsideHtml.style.height="100%",this.outsideHtml.style.position="absolute",this.outsideHtml.style.top="0px",this.outsideHtml.style.left="0px",e.container.appendChild(this.outsideHtml);var i=document.createElement("div");i.id="html-draw-container",i.style.pointerEvents="all",this.containerDiv=i,this.outsideHtml.appendChild(this.containerDiv)}this.calculateScale()},e.prototype.calculateScale=function(){this.containerDiv.style.transform="scale("+this.scalePercent+")"},e.prototype.setListByData=function(e){var t,i,r=this;if(NU.log("data",e),e&&!(e.length<1)){e.forEach((function(e){var t=document.createElement("div");t.innerHTML=e.html,t.children[0].id=e.id,r.containerDiv.appendChild(t.children[0])}));var n=[],o=this.containerDiv.getElementsByClassName("html-box"),s=Array.from(o),a=function(e){var t=s.find((function(t){return t.id===e.id}));if(!t)return"continue";var i=iU.createBox(e.classType);i.id=e.id?e.id:t.id,i.name=e.name,i.boxType=e.boxType,i.videoPath||(i.videoPath=e.videoPath),i.initHtml(t),i.init(),i instanceof Kk&&i.setPicList(e.picList),l.boxList.push(i),n.push(i)},l=this;try{for(var h=QU(e),c=h.next();!c.done;c=h.next()){a(c.value)}}catch(e){t={error:e}}finally{try{c&&!c.done&&(i=h.return)&&i.call(h)}finally{if(t)throw t.error}}return n}},e.prototype.clearHtmlDiv=function(){this.containerDiv&&(this.containerDiv.innerHTML="",this.boxList=[])},e}();const UU=kU;var jU=i(5108),GU=function(){function e(){this.musicList=[]}return e.prototype.recoverData=function(e){var t=this;jU.log("recoverdata",e),this.musicList.length=0,Array.isArray(e)&&e.length>0&&((e=this.removeRepeat(e)).forEach((function(e){var i=t.makeMusic(e);t.musicList.push(i),DP.register(i)})),this.currentMusic=this.musicList[0])},e.prototype.removeRepeat=function(e){var t={};return e=e.reduce((function(e,i){return!t[i.id]&&(t[i.id]=e.push(i)),e}),[])},e.prototype.makeMusic=function(e){var t=new BP;return t.id=e.id,t.name=e.name,t.type="音频",t.iconName=e.iconName,t.src=e._src,t.muted=e._muted,t.volume=e._volume,t},e.prototype.clean=function(){this.musicList.length=0},e}();const zU=GU;var YU=function(){function e(e){this.containerDiv=e}return e.prototype.setSubtitleList=function(e){var t=this;if(!e||0===e.length)return[];e.forEach((function(e){var i=document.createElement("div");i.innerHTML=e.html,i.children[0].id=e.id,t.containerDiv.appendChild(i.children[0])}))},e}();const ZU=YU;var WU=function(e,t,i,r){return new(i||(i=Promise))((function(n,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?n(e.value):function(e){return e instanceof i?e:new i((function(t){t(e)}))}(e.value).then(s,a)}l((r=r.apply(e,t||[])).next())}))},XU=function(e,t){var i,r,n,o,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,r&&(n=2&o[0]?r.return:o[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,o[1])).done)return n;switch(r=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(n=s.trys,(n=n.length>0&&n[n.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){s.label=o[1];break}if(6===o[0]&&s.label<n[1]){s.label=n[1],n=o;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(o);break}n[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{i=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};const JU=function(){function e(e,t,i){this.cloudOpacity=.5,this.viewer=e,this.terrainUrl=t,this.globalTerrainUrl=i,this.graticuleLayer=new yk(e),this.init()}return e.prototype.init=function(){if(this.viewer);try{this.viewer.imageryLayers;var e=this.viewer.scene,t=new Cesium.SunLight;e.light=t,e.globe.dynamicAtmosphereLighting=!0,e.globe.dynamicAtmosphereLightingFromSun=!1,e.globe.enableLighting=!0,e.globe.lightingFadeOutDistance=1e7,e.globe.nightFadeInDistance=25e6}catch(e){}},e.prototype.SetWater=function(e){return WU(this,void 0,void 0,(function(){var t;return XU(this,(function(i){switch(i.label){case 0:return this.sea?(this.sea.show=e,[3,3]):[3,1];case 1:return e?[4,of.Render(this.viewer.scene)]:[3,3];case 2:(t=i.sent())&&(this.sea=t),i.label=3;case 3:return[2]}}))}))},e.prototype.SetTerrain=function(e){var t=0;switch(e){case 1:this.viewer.terrainProvider=new Cesium.CesiumTerrainProvider({url:this.terrainUrl}),t=1;break;case 2:this.viewer.terrainProvider=new Cesium.CesiumTerrainProvider({url:this.globalTerrainUrl}),t=2;break;default:this.viewer.terrainProvider instanceof Cesium.EllipsoidTerrainProvider||(this.viewer.terrainProvider=new Cesium.EllipsoidTerrainProvider({ellipsoid:Cesium.Ellipsoid.WGS84})),t=0}return t},e}();const KU=function(){function e(e){var t=this;this.isCenterMoved=!1,this.eagleEyeWidthNum=180,this.eagleEyeHeightNum=90,this.centerWidthNum=14,this.centerHeightNum=14,this.centerBottom=0,this.centerLeft=0,this.centerTop=0,this.latTop=0,this.longLeft=0,this.viewer=e,this.initEagleDiv(),this.viewer.camera.changed.addEventListener((function(e){t.isCenterMoved?t.isCenterMoved=!1:t.setEagleCenterPosition()})),this.showEagleDiv(!1)}return e.prototype.initEagleDiv=function(){var e=this;this.eagleDiv=document.createElement("div"),this.eagleDiv.className="cesiumEagleEye";var t=this.eagleDivStyle();Object.assign(this.eagleDiv.style,t),this.eagleDiv.contentEditable="false",document.getElementById("cesiumContainer").appendChild(this.eagleDiv),this.eagleDiv.addEventListener("click",(function(t){e.getMousePosition(t)})),this.latDiv=document.createElement("div"),this.latDiv.className="lat",this.latDiv.contentEditable="false",this.eagleDiv.appendChild(this.latDiv),this.lonDiv=document.createElement("div"),this.lonDiv.className="long",this.lonDiv.contentEditable="false",this.eagleDiv.appendChild(this.lonDiv),this.eagleCenterDiv=document.createElement("div"),this.eagleCenterDiv.className="eagleEyeCenter",this.eagleCenterDiv.innerHTML='<img src="./resources/images/point.png" style="position: absolute;width: 100%;">',this.eagleDiv.appendChild(this.eagleCenterDiv),this.setEagleCenterPosition()},e.prototype.updateDivStyle=function(){var e=this.latDivStyle();Object.assign(this.latDiv.style,e);var t=this.lonDivStyle();Object.assign(this.lonDiv.style,t);var i=this.eagleCenterDivStyle();Object.assign(this.eagleCenterDiv.style,i)},e.prototype.showEagleDiv=function(e){this.eagleDiv&&(e?(this.eagleDiv.style.display="block",this.setEagleCenterPosition()):this.eagleDiv.style.display="none")},e.prototype.getMousePosition=function(e){this.isCenterMoved=!0;var t=e.offsetY,i=e.offsetX,r=t-this.centerHeightNum/2,n=i-this.centerHeightNum/2;this.centerTop=r,this.centerLeft=n,this.setEagleCenterByTopLeft(r,n)},e.prototype.setEagleCenterByTopLeft=function(e,t){var i=e+this.centerHeightNum/2,r=t+this.centerWidthNum/2;r>this.eagleEyeWidthNum-this.centerWidthNum/2&&(r=this.eagleEyeWidthNum-this.centerWidthNum/2),r<this.centerWidthNum/2&&(r=this.centerWidthNum/2),i>this.eagleEyeHeightNum-this.centerHeightNum/2&&(i=this.eagleEyeHeightNum-this.centerHeightNum/2),i<this.centerHeightNum/2&&(i=this.centerHeightNum/2),this.latTop=i,this.longLeft=r,this.longNum=2*t-180,this.centerTopNum=e,this.latNum=Number(2*(this.eagleEyeHeightNum-this.centerTopNum-this.centerHeightNum/2)-90);var n=this.viewer.camera.positionCartographic.height;this.longNum>179&&(this.longNum=179),(this.longNum<-179||"NaN"==this.longNum.toString())&&(this.longNum=-179),this.latNum>90&&(this.latNum=90),(this.latNum<-90||"NaN"==this.latNum.toString())&&(this.latNum=-90),this.viewer.camera.setView({destination:Cesium.Cartesian3.fromDegrees(this.longNum,this.latNum,n)}),this.updateDivStyle()},e.prototype.eagleDivStyle=function(){return{"border-radius":"6px",background:"url('./resources/images/world.jpg') no-repeat","background-size":"100% 100%",bottom:"0px",left:"0px",position:"absolute",width:this.eagleEyeWidthNum+"px",height:this.eagleEyeHeightNum+"px","caret-color":"transparent"}},e.prototype.lonDivStyle=function(){return{width:"0px",height:this.eagleEyeHeightNum+"px","margin-left":this.longLeft+"px","border-left":"1px solid white","pointer-events":"none","caret-color":"transparent"}},e.prototype.latDivStyle=function(){return{height:"0px",width:this.eagleEyeWidthNum+"px","margin-top":this.latTop+"px","border-top":"1px solid white","pointer-events":"none",float:"left","caret-color":"transparent"}},e.prototype.eagleCenterDivStyle=function(){return{width:this.centerWidthNum+"px",height:this.centerHeightNum+"px",position:"absolute",top:this.centerTop+"px",left:this.centerLeft+"px",color:"white","font-size":"26px","pointer-events":"none"}},e.prototype.calcLeft=function(e){var t=(e+=180)/360*this.eagleEyeWidthNum;return t>this.eagleEyeWidthNum-this.centerWidthNum/2&&(t=this.eagleEyeWidthNum-this.centerWidthNum/2),t<this.centerWidthNum/2&&(t=this.centerWidthNum/2),t},e.prototype.calcBottom=function(e){var t=(e+=90)/180*this.eagleEyeHeightNum;return t>this.eagleEyeHeightNum-this.centerHeightNum/2&&(t=this.eagleEyeHeightNum-this.centerHeightNum/2),t<this.centerHeightNum/2&&(t=this.centerHeightNum/2),t},e.prototype.setEagleCenterPosition=function(){var e=this.viewer.camera.positionCartographic;this.longNum=Number(Cesium.Math.toDegrees(e.longitude)),this.latNum=Number(Cesium.Math.toDegrees(e.latitude));var t=this.calcLeft(this.longNum);this.centerBottom=this.calcBottom(this.latNum);var i=this.eagleEyeHeightNum-this.centerBottom,r=t-this.centerWidthNum/2;this.centerTop=i-this.centerHeightNum/2,this.centerLeft=r,this.latTop=i,this.longLeft=t,this.updateDivStyle()},e}();var VU=i(5108);const qU=function(){function e(e){this.viewer=e}return e.prototype.enable=function(e){VU.log("exaggeration enable"),e?this.invokeCameraChanged(this.viewer):this.clearTerrain(this.viewer.scene)},e.prototype.invokeCameraChanged=function(e){var t=this;e.scene.cameraEventWaitTime=100,this.updateTerrain(e.scene,1),this.removeListener&&this.removeListener(),this.removeListener=e.camera.changed.addEventListener((function(i){var r=t.getLevel(Math.ceil(e.camera.positionCartographic.height));r&&r<=50&&t.updateTerrain(e.scene,r)}))},e.prototype.getLevel=function(e){return e>3e6?50:e>15e5?30:e>75e4?15:e>375e3?10:e>187500||e>93750?5:e>46875||e>23437.5?1:void 0},e.prototype.clearTerrain=function(e){e.globe.terrainExaggeration=1,e.globe.material=void 0,this.removeListener&&(this.removeListener(),VU.log("clear terrain",this.removeListener))},e.prototype.updateTerrain=function(e,t){void 0===t&&(t=50),e.globe.terrainExaggeration=t},e.prototype.updateTerrain1=function(e){e.globe.terrainExaggeration=1;var t=e.globe;t.terrainExaggerationRelativeHeight=1e3;var i=t.terrainExaggerationRelativeHeight,r=.5,n={entries:[{height:i+0,color:Cesium.Color.TRANSPARENT},{height:i+.01,color:Cesium.Color.DARKGREEN.withAlpha(r)},{height:i+100,color:Cesium.Color.GREEN.withAlpha(r)},{height:i+200,color:Cesium.Color.LIGHTGREEN.withAlpha(r)},{height:i+500,color:Cesium.Color.YELLOWGREEN.withAlpha(r)},{height:i+1e3,color:Cesium.Color.YELLOW.withAlpha(r)},{height:i+1500,color:Cesium.Color.ORANGE.withAlpha(r)},{height:i+2e3,color:Cesium.Color.ORANGERED.withAlpha(r)},{height:i+3e3,color:Cesium.Color.RED.withAlpha(r)},{height:i+4e3,color:Cesium.Color.ALICEBLUE.withAlpha(r)},{height:i+5e3,color:Cesium.Color.SNOW.withAlpha(r)},{height:i+6e3,color:Cesium.Color.WHITE.withAlpha(r)}],extendDownwards:!0,extendUpwards:!0};e.globe.material=Cesium.createElevationBandMaterial({scene:e,layers:[n]})},e}();var $U=function(){function e(e,t,i){this.viewer=e,this.cesiumManager=new JU(e,t,i),this.terrainManager=new qU(e),this.eagleManager=new KU(e)}return e.prototype.initStatus=function(e,t){var i=this;void 0===t&&(t=!0),this.page=e;["skyBox","graticule","isEagle","isPlace","placeType","skyAtmosphere","globe","seaMaterial","sunLight","clouds","cloudSpead","skyWeather","isName","isVector","isVector2","isFrameRate","compass","baseWaterColor","specularIntensity","amplitude","terrainShading","exaggerValue"].forEach((function(t){i.click(t,e[t])}))},e.prototype.click=function(e,t){null!=t&&this.imagetransform(e,t)},e.prototype.imagetransform=function(e,t){switch(e){case"skyAtmosphere":this.viewer.scene.skyAtmosphere.show!==t&&(this.viewer.scene.skyAtmosphere.show=t),this.viewer.scene.globe.showGroundAtmosphere=this.viewer.scene.skyAtmosphere.show;break;case"skyBox":this.viewer.scene.skyBox.show!==t&&(this.viewer.scene.skyBox.show=t);break;case"globe":if(!t){var i=new Cesium.SunLight;(r=this.viewer.scene).light=i,this.fixLightFunc&&this.viewer.scene.preRender.removeEventListener(this.fixLightFunc)}this.viewer.scene.globe.enableLighting!==t&&(this.viewer.scene.globe.enableLighting=t),t&&this.imagetransform("sunLight",this.viewer.scene.globe.dynamicAtmosphereLighting);break;case"sunLight":if(this.fixLightFunc&&this.viewer.scene.preRender.removeEventListener(this.fixLightFunc),!this.viewer.scene.globe.enableLighting)return;if(1==t){i=new Cesium.SunLight;(r=this.viewer.scene).light=i,r.globe.dynamicAtmosphereLighting=!0}else{var r=this.viewer.scene,n=new Cesium.DirectionalLight({direction:r.camera.directionWC});r.light=n,r.globe.dynamicAtmosphereLighting=!1,this.fixLightFunc=function(e,t){e.light.direction=Cesium.Cartesian3.clone(e.camera.directionWC,e.light.direction)},r.preRender.addEventListener(this.fixLightFunc)}break;case"exaggerValue":-1==t?(this.viewer.scene.globe.terrainExaggeration=1,this.terrainManager.enable(!0)):(this.terrainManager.enable(!1),this.viewer.scene.globe.terrainExaggeration=t);break;case"skyWeather":this.viewer.scene.fog.enabled!==t&&(this.viewer.scene.fog.enabled=t);break;case"clouds":this.viewer.scene.globe.enableCloud!==t&&(this.viewer.scene.globe.enableCloud=t);break;case"cloudSpead":this.viewer.scene.cloudSpeedTimes=t;break;case"graticule":this.graticuleLayerShow!==t&&t?(this.cesiumManager.graticuleLayer.show(),this.graticuleLayerShow=t):this.graticuleLayerShow===t||t||(this.cesiumManager.graticuleLayer.remove(),this.graticuleLayerShow=t);break;case"isEagle":this.eagleManager.showEagleDiv(t);break;case"seaMaterial":this.waterShow!==t&&(this.cesiumManager.SetWater(t),this.waterShow=t);break;case"isPlace":this.terrainShow!==t&&(t?this.placeType?this.cesiumManager.SetTerrain(2):this.cesiumManager.SetTerrain(1):this.cesiumManager.SetTerrain(0),this.terrainShow=t);break;case"placeType":if(!this.terrainShow)return;this.placeType!==t&&(this.placeType=t,this.placeType?this.cesiumManager.SetTerrain(2):this.cesiumManager.SetTerrain(1));break;case"isVector":case"isVector2":case"isName":break;case"isFrameRate":this.viewer.scene.debugShowFramesPerSecond!==t&&(this.viewer.scene.debugShowFramesPerSecond=t);break;case"compass":this.viewer.cesiumNavigation.navigationViewModel.showCompass=t;break;case"baseWaterColor":this.cesiumManager.sea?this.cesiumManager.sea.appearance.material.uniforms.baseWaterColor=Cesium.Color.fromCssColorString(t).withAlpha(.5):of.baseWaterColor=Cesium.Color.fromCssColorString(t).withAlpha(.5);break;case"specularIntensity":this.cesiumManager.sea?this.cesiumManager.sea.appearance.material.uniforms.specularIntensity=t:of.specularIntensity=t;break;case"amplitude":this.cesiumManager.sea?this.cesiumManager.sea.appearance.material.uniforms.amplitude=t:of.amplitude=t;break;case"terrainShading":this.viewer.scene.globe.depthTestAgainstTerrain!==t&&(this.viewer.scene.globe.depthTestAgainstTerrain=t)}},e}();const ej=$U,tj=52.35987755982988,ij=3.141592653589793,rj=6378245,nj=.006693421622965943;const oj=class{static BD09ToGCJ02(e,t){let i=+e-.0065,r=+t-.006,n=Math.sqrt(i*i+r*r)-2e-5*Math.sin(r*tj),o=Math.atan2(r,i)-3e-6*Math.cos(i*tj);return[n*Math.cos(o),n*Math.sin(o)]}static GCJ02ToBD09(e,t){t=+t,e=+e;let i=Math.sqrt(e*e+t*t)+2e-5*Math.sin(t*tj),r=Math.atan2(t,e)+3e-6*Math.cos(e*tj);return[i*Math.cos(r)+.0065,i*Math.sin(r)+.006]}static WGS84ToGCJ02(e,t){if(t=+t,e=+e,this.out_of_china(e,t))return[e,t];{let i=this.delta(e,t);return[e+i[0],t+i[1]]}}static GCJ02ToWGS84(e,t){if(t=+t,e=+e,this.out_of_china(e,t))return[e,t];{let i=this.delta(e,t);return[2*e-(e+i[0]),2*t-(t+i[1])]}}static delta(e,t){let i=this.transformLng(e-105,t-35),r=this.transformLat(e-105,t-35);const n=t/180*ij;let o=Math.sin(n);o=1-nj*o*o;const s=Math.sqrt(o);return i=180*i/(rj/s*Math.cos(n)*ij),r=180*r/(rj*(1-nj)/(o*s)*ij),[i,r]}static transformLng(e,t){let i=300+(e=+e)+2*(t=+t)+.1*e*e+.1*e*t+.1*Math.sqrt(Math.abs(e));return i+=2*(20*Math.sin(6*e*ij)+20*Math.sin(2*e*ij))/3,i+=2*(20*Math.sin(e*ij)+40*Math.sin(e/3*ij))/3,i+=2*(150*Math.sin(e/12*ij)+300*Math.sin(e/30*ij))/3,i}static transformLat(e,t){let i=2*(e=+e)-100+3*(t=+t)+.2*t*t+.1*e*t+.2*Math.sqrt(Math.abs(e));return i+=2*(20*Math.sin(6*e*ij)+20*Math.sin(2*e*ij))/3,i+=2*(20*Math.sin(t*ij)+40*Math.sin(t/3*ij))/3,i+=2*(160*Math.sin(t/12*ij)+320*Math.sin(t*ij/30))/3,i}static out_of_china(e,t){return t=+t,!((e=+e)>73.66&&e<135.05&&t>3.86&&t<53.55)}};class sj extends Cesium.WebMercatorTilingScheme{constructor(e){super(e);let t=new Cesium.WebMercatorProjection;this._projection.project=function(e,i){return i=oj.WGS84ToGCJ02(Cesium.Math.toDegrees(e.longitude),Cesium.Math.toDegrees(e.latitude)),i=t.project(new Cesium.Cartographic(Cesium.Math.toRadians(i[0]),Cesium.Math.toRadians(i[1]))),new Cesium.Cartesian2(i.x,i.y)},this._projection.unproject=function(e,i){let r=t.unproject(e);return i=oj.GCJ02ToWGS84(Cesium.Math.toDegrees(r.longitude),Cesium.Math.toDegrees(r.latitude)),new Cesium.Cartographic(Cesium.Math.toRadians(i[0]),Cesium.Math.toRadians(i[1]))}}}const aj=sj;var lj=i(5108),hj=function(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],r=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},cj=function(){function e(e,t,i){this.baseLayerList=new Array,this.otherLayerList=new Array,this.districtLayerList=new Array,this.customLayerList=new Array,this.isWebp=!1,this.viewer=i,this.geopptWebUrl=e,this.geopptServiceUrl=t}return e.prototype.getConfig=function(){var e=this,t=this.geopptWebUrl+"/resources/online_data.json";fetch(t).then((function(e){return e.json()})).then((function(t){e.layerConfig=t,e.getDefaultConfigByOriginal(e.layerConfig);var i=e.layerConfig.find((function(e){return"底图"===e.label}));i&&(e.baseLayerList=i.data,e.baseLayerList=e.formatData(e.baseLayerList));var r=e.layerConfig.find((function(e){return"其他"===e.label}));r&&(e.otherLayerList=r.data,e.otherLayerList=e.formatData(e.otherLayerList));var n=e.layerConfig.find((function(e){return"自定义"===e.label}));return n&&(e.customLayerList=n.data,e.customLayerList=e.formatData(e.customLayerList)),e.layerConfig}))},e.prototype.pageToLayerList=function(e){if(this.layerConfig&&e){var t;try{t="string"==typeof e.pageConfig?JSON.parse(e.pageConfig):e.pageConfig}catch(e){lj.log(e)}t||(t=this.getConfig()),this.updateLayerList(t,e),this.currentConfig=t,e.pageConfig=t}},e.prototype.getDefaultConfigByOriginal=function(e){var t=this;this.defaultConfig={base:[],other:[]};var i=["alpha","saturation","contrast","brightness","hue","gamma","currentLevel"];function r(e){var t,r=new sk;if(e.visible&&(t={id:e.id,visible:!0}),i.forEach((function(i){if(void 0!==e[i]){var r=parseFloat(e[i]);t||(t={id:e.id}),t[i]=r}})),t)return!0!==t.visible&&(t.visible=!1),i.forEach((function(e){void 0===t[e]&&(t[e]=r[e])})),t}var n=e.find((function(e){return"底图"===e.label}));n&&n.data&&n.data.forEach((function(e){var i=r(e);i&&t.defaultConfig.base.push(i)}));var o=e.find((function(e){return"其他"===e.label}));o&&o.data&&o.data.forEach((function(e){var i=r(e);i&&t.defaultConfig.other.push(i)}))},e.prototype.resetLayerConfig=function(){var e=this;this.baseLayerList.forEach((function(t){var i=e.defaultConfig.base.find((function(e){return e.id===t.id}));e.initLayerAttr(t,i),t.showProperty=!1})),this.otherLayerList.forEach((function(t){var i=e.defaultConfig.other.find((function(e){return e.id===t.id}));e.initLayerAttr(t,i),t.showProperty=!1})),this.customLayerList.forEach((function(t){e.initLayerAttr(t),t.showProperty=!1}))},e.prototype.initLayerAttr=function(e,t){if(t){if(e.id!==t.id)return e}else t=new sk;for(var i in t)"id"!==i&&"visible"!==i&&(e["".concat(i)]=t[i]);return e},e.prototype.updateLayerList=function(e,t){var i=this,r=JSON.stringify(e);if(e=JSON.parse(r),this.resetLayerConfig(),e.baseAttr){var n=this.getLayerById(e.baseAttr.id);n&&(this.initLayerAttr(n,e.baseAttr),this.setBaseMap(n))}else this.setBaseMap();var o=this.otherLayerList.concat(this.customLayerList),s=e.otherAttr.concat(e.customAttr);o.forEach((function(e){s.find((function(t){return t.id===e.id}))||i.hideImage(e)})),s.sort((function(e,t){return e.currentLevel-t.currentLevel})),s.forEach((function(e){i.updateLayerByConfig(e)})),this.currentConfig=e,t&&(t.pageConfig=e)},e.prototype.updateLayerByConfig=function(e){var t=this.getLayerById(e.id);if(t)return this.initLayerAttr(t,e),t.visible&&t.cesiumLayer||this.showImage(t),t},e.prototype.getLayerById=function(e){var t;return(t=this.baseLayerList.find((function(t){return t.id===e})))||(t=this.otherLayerList.find((function(t){return t.id===e})))?t:(t=this.customLayerList.find((function(t){return t.id===e})))||void 0},e.prototype.setBaseMap=function(e){this.baseImageLayer!==e&&(this.baseImageLayer&&this.hideImage(this.baseImageLayer),e&&this.showImage(e,!0),this.baseImageLayer=e)},e.prototype.showImage=function(e,t){var i=this,r=this.viewer;if("tileSet"!==e.paramType){if(e.visible&&e.cesiumLayer)return;if("url-mix"==e.paramType){var n=this.getMapProviders(e);n&&n.forEach((function(n){if(t)e.cesiumLayer=r.imageryLayers.addImageryProvider(n,0);else if(e.isTop)e.cesiumLayer=r.imageryLayers.addImageryProvider(n);else{var o=i.calculateIndex(r.imageryLayers);e.cesiumLayer=r.imageryLayers.addImageryProvider(n,o)}})),["alpha","saturation","contrast","brightness","hue","gamma","currentLevel"].forEach((function(t){e.cesiumLayer[t]=e[t]}))}else if("url-arcgis"===e.paramType){var o=void 0;o=e.param.layerId?new Cesium.ArcGisMapServerImageryProvider({url:e.param.url,layers:e.param.layerId}):new Cesium.ArcGisMapServerImageryProvider({url:e.param.url}),e.cesiumLayer=r.imageryLayers.addImageryProvider(o),["alpha","saturation","contrast","brightness","hue","gamma","currentLevel"].forEach((function(t){e.cesiumLayer[t]=e[t]}))}else{var s=this.getMapProvider(e);if(t)e.cesiumLayer=r.imageryLayers.addImageryProvider(s,0);else if(e.isTop)e.cesiumLayer=r.imageryLayers.addImageryProvider(s);else{var a=this.calculateIndex(r.imageryLayers);e.cesiumLayer=r.imageryLayers.addImageryProvider(s,a)}["alpha","saturation","contrast","brightness","hue","gamma","currentLevel"].forEach((function(t){e.cesiumLayer[t]=e[t]}))}}else{if(e.visible&&e.cesiumTile)return;if(!e.param||!e.param.url)return;var l=void 0;if(e.param.type||"building"==e.param.type){if(e.param.shadows){u=void 0;"disabled"===e.param.shadows?u=Cesium.ShadowMode.DISABLED:"enabled"===e.param.shadows?u=Cesium.ShadowMode.ENABLED:"receive_only"===e.param.shadows?u=Cesium.ShadowMode.RECEIVE_ONLY:"cast_only"===e.param.shadows&&(u=Cesium.ShadowMode.CAST_ONLY),l=new Cesium.Cesium3DTileset({url:e.param.url,shadows:u})}else l=new Cesium.Cesium3DTileset({url:e.param.url});l.readyPromise.then((function(e){var t=e.boundingSphere,i=Cesium.Cartographic.fromCartesian(t.center),r=Cesium.Cartesian3.fromRadians(i.longitude,i.latitude,0),n=Cesium.Cartesian3.fromRadians(i.longitude,i.latitude,30),o=Cesium.Cartesian3.subtract(n,r,new Cesium.Cartesian3);e.modelMatrix=Cesium.Matrix4.fromTranslation(o)})).otherwise((function(e){lj.log(e)}))}else{Cesium.ExperimentalFeatures.enableModelExperimental=!0;var h=performance.now(),c=new Cesium.CustomShader({uniforms:{u_time:{value:h,type:Cesium.UniformType.FLOAT}},varyings:{v_distanceFromTop:Cesium.VaryingType.FLOAT},mode:Cesium.CustomShaderMode.MODIFY_MATERIAL,lightingModel:Cesium.LightingModel.PBR,vertexShaderText:"\n        varying vec3 v_outPos;\n        void vertexMain(VertexInput vsInput, inout czm_modelVertexOutput vsOutput) {\n            v_outPos = vsOutput.positionMC;\n        }\n        ",fragmentShaderText:"\n        varying vec3 v_outPos;\n        void fragmentMain(FragmentInput fsInput, inout czm_modelMaterial material) {\n                float rmaxH = 100.0;\n                float gmaxH = 200.0;\n                float bmaxH = 200.0;\n                float rz = clamp(v_outPos.z / rmaxH, 0.01, 1.0);\n                float gz = clamp(v_outPos.z / gmaxH, 0.15, 0.6);\n                float bz = clamp(v_outPos.z / bmaxH, 0.1, 0.7);\n                vec3 c = vec3(rz,rz,rz);\n                material.emissive = c;\n        } \n        "});if(e.param.shadows){var u=void 0;"disabled"===e.param.shadows?u=Cesium.ShadowMode.DISABLED:"enabled"===e.param.shadows?u=Cesium.ShadowMode.ENABLED:"receive_only"===e.param.shadows?u=Cesium.ShadowMode.RECEIVE_ONLY:"cast_only"===e.param.shadows&&(u=Cesium.ShadowMode.CAST_ONLY);var p={url:e.param.url,customShader:c,shadows:u};l=new Cesium.Cesium3DTileset(p)}else{p={url:e.param.url,customShader:c};l=new Cesium.Cesium3DTileset(p)}l.readyPromise.then((function(e){var t=e.boundingSphere,i=Cesium.Cartographic.fromCartesian(t.center),r=Cesium.Cartesian3.fromRadians(i.longitude,i.latitude,0),n=Cesium.Cartesian3.fromRadians(i.longitude,i.latitude,30),o=Cesium.Cartesian3.subtract(n,r,new Cesium.Cartesian3);e.modelMatrix=Cesium.Matrix4.fromTranslation(o)})).otherwise((function(e){lj.log(e)}))}l&&(r.scene.primitives.add(l),e.cesiumTile=l),["alpha","saturation","contrast","brightness","hue","gamma","currentLevel"].forEach((function(t){e.cesiumTile[t]=e[t]}))}e.visible=!0},e.prototype.hideImage=function(e){var t=this.viewer;if("tileSet"!==e.paramType){if(!e.visible&&!e.cesiumLayer)return;t.imageryLayers.remove(e.cesiumLayer),e.cesiumLayer=void 0}else t.scene.primitives.remove(e.cesiumTile);e.visible=!1},e.prototype.getMapProviders=function(e){if(null==e)return null;if("url-mix"!==e.paramType)switch(e.id){case"moren":case"tencent":e.param.customTags={sx:function(e,t,i,r){return t>>4},sy:function(e,t,i,r){return(1<<r)-i>>4}};break;case"skyearth_global":case"own_data":e.param.tilingScheme=new Cesium.GeographicTilingScheme}var t=[];return e.param.urls.forEach((function(i){e.param.url=i;var r=new Cesium.UrlTemplateImageryProvider(e.param);t.push(r)})),t},e.prototype.getMapProvider=function(e){if(null==e)return null;switch(e.id){case"moren":case"tencent":e.param.customTags={sx:function(e,t,i,r){return t>>4},sy:function(e,t,i,r){return(1<<r)-i>>4}};break;case"skyearth_global":case"own_data":e.param.tilingScheme=new Cesium.GeographicTilingScheme;break;case"gaode_satellite":var t={style:"img",crs:"WGS84"};return new Cesium.AmapImageryProvider(t);case"gaode":t={style:"img、elec、cva",crs:"WGS84"};return new Cesium.AmapImageryProvider(t);case"tencent":return new Cesium.TencentImageryProvider({style:"dem"});case"pic":return new Cesium.GoogleImageryProvider({style:"img"})}var i;switch(e.paramType){case"tms":"4326"==e.param.crs&&(e.param.tilingScheme=new Cesium.GeographicTilingScheme),i=new Cesium.TileMapServiceImageryProvider(e.param);break;case"url":"4326"==e.param.crs&&(e.param.tilingScheme=new Cesium.GeographicTilingScheme),i=new Cesium.UrlTemplateImageryProvider(e.param);break;case"url-ceshi":e.param.tilingScheme=new Cesium.WebMercatorTilingScheme,e.param.rectangle=new Cesium.Rectangle(Cesium.Math.toRadians(114.989864173882),Cesium.Math.toRadians(39.32319860444451),Cesium.Math.toRadians(117.0101335928688),Cesium.Math.toRadians(41.343470315312)),i=new Cesium.TileMapServiceImageryProvider(e.param);break;case"url-baidu":break;case"wms":this.resolveWmsWmtsParam(e),i=new Cesium.WebMapServiceImageryProvider(e.param);break;case"wmts":this.resolveWmsWmtsParam(e),i=new Cesium.WebMapTileServiceImageryProvider(e.param);break;case"tileSet":i=new Cesium.Cesium3DTileset(e.param);break;case"bing":i=new Cesium.UrlTemplateImageryProvider({url:e.param.url,subdomains:["0","1","2","3"],tilingScheme:"amap"==e.param.tilingScheme?new aj:new Cesium.WebMercatorTilingScheme,customTags:{q:function(e,t,i,r){var n=function(e,t,i){for(var r="",n=i;n>=0;--n){var o=1<<n,s=0;0!=(e&o)&&(s|=1),0!=(t&o)&&(s|=2),r+=s}return"0"===r[0]&&(r=r.substr(1)),r}(t,i,r);return n}}});break;case"baidutest":t={style:"pl",crs:"WGS84"}}return i},e.prototype.resolveWmsWmtsParam=function(e){e.param.tilingScheme&&("mct"===e.param.tilingScheme?e.param.tilingScheme=new Cesium.WebMercatorTilingScheme:e.param.tilingScheme.x&&(e.param.tilingScheme=new Cesium.GeographicTilingScheme({numberOfLevelZeroTilesX:e.param.tilingScheme.x,numberOfLevelZeroTilesY:e.param.tilingScheme.y}))),e.param.parameters&&e.param.parameters.minX&&(e.param.rectangle=Cesium.Rectangle.fromDegrees(e.param.parameters.minX,e.param.parameters.minY,e.param.parameters.maxX,e.param.parameters.maxY)),e.param.rectangle&&this.viewer.camera.flyTo({destination:e.param.rectangle})},e.prototype.calculateIndex=function(e){for(var t=e._layers.length-1;t>=0;t--){var i=this.getGpLayerByImageLayer(e._layers[t]);if(i&&!i.isTop)return i.currentLevel+1}return 0},e.prototype.getGpLayerByImageLayer=function(e){return this.baseLayerList.concat(this.otherLayerList,this.customLayerList).find((function(t){if(t.cesiumLayer)return t.cesiumLayer===e||void 0}))},e.prototype.formatData=function(e){var t,i,r,n,o=[];if(e&&e.length>0)try{for(var s=hj(e),a=s.next();!a.done;a=s.next()){var l=a.value;if(l.json_str){var h=JSON.parse(l.json_str),c=new Tw;for(var u in h)c[u]=h[u];c.visible=!1,o.push(c)}else{c=new Tw;for(var u in l)c[u]=l[u];c.visible=!1,c.initAttr={alpha:c.alpha,saturation:c.saturation,contrast:c.contrast,brightness:c.brightness,hue:c.hue,gamma:c.gamma},o.push(c)}}}catch(e){t={error:e}}finally{try{a&&!a.done&&(i=s.return)&&i.call(s)}finally{if(t)throw t.error}}if(o&&o.length>0)try{for(var p=hj(o),d=p.next();!d.done;d=p.next()){var m=d.value;this.formatLayerUnit(m)}}catch(e){r={error:e}}finally{try{d&&!d.done&&(n=p.return)&&n.call(p)}finally{if(r)throw r.error}}return o},e.prototype.formatLayerUnit=function(e){if("string"==typeof e.param)try{e.param=JSON.parse(e.param)}catch(t){e.param={},lj.error(t)}if(e.param&&e.param.url){e.param.url=this.icUrlTransform(e.param.url);var t=e.param.url.match(/format=png/||0);t&&(e.format=t[0].split("=")[1],this.isWebp=!1);var i=e.param.url.match(/format=webp/);i&&(e.format=i[0].split("=")[1],this.isWebp=!0)}return e},e.prototype.icUrlTransform=function(e){var t;if(-1!==e.indexOf("https://")||e.startsWith("wss://"))t=e;else if(-1!==e.indexOf("http://"))if(-1!==e.indexOf("icenter")||-1!==e.indexOf(":8310")){var i=(n=e.split("/"))[0]+"//"+n[2],r=this.geopptServiceUrl+"/proxyhttp/"+n[2];t=e.replace(i,r)}else{var n;t="https://"+(n=e.split("//"))[1]}else lj.log("其他");return t},e}();const uj=cj;var pj=i(5108),dj=function(){function e(){var e,t,i=this;this.$support=(e=document.createElement("canvas"),{canvas:!!(t=e.getContext("2d")),imageData:!!t.getImageData,dataURL:!!e.toDataURL,btoa:!!window.btoa}),this.downloadMime="image/octet-stream",this.genBitmapImage=function(e){var t=e.width,r=e.height,n=t*r*3,o=n+54,s=[66,77,255&o,o>>8&255,o>>16&255,o>>24&255,0,0,0,0,54,0,0,0],a=[40,0,0,0,255&t,t>>8&255,t>>16&255,t>>24&255,255&r,r>>8&255,r>>16&255,r>>24&255,1,0,24,0,0,0,0,0,255&n,n>>8&255,n>>16&255,n>>24&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],l=(4-3*t%4)%4,h=e.data,c="",u=t<<2,p=r,d=String.fromCharCode;do{for(var m=u*(p-1),f="",g=0;g<t;g++){var A=g<<2;f+=d(h[m+A+2])+d(h[m+A+1])+d(h[m+A])}for(var y=0;y<l;y++)f+=String.fromCharCode(0);c+=f}while(--p);return i.encodeData(s.concat(a))+i.encodeData(c)},this.saveAsImage=function(e,t,r,n){if(i.$support.canvas&&i.$support.dataURL)if("string"==typeof e&&(e=document.getElementById(e)),null==n&&(n="png"),n=i.fixType(n),/bmp/.test(n)){var o=i.getImageData(i.scaleCanvas(e,t,r)),s=i.genBitmapImage(o);i.saveFile(i.makeURI(s,i.downloadMime))}else{var a=i.getDataURL(e,n,t,r);i.saveFile(a.replace(n,i.downloadMime))}},this.convertToImage=function(e,t,r,n){if(i.$support.canvas&&i.$support.dataURL){if("string"==typeof e&&(e=document.getElementById(e)),null==n&&(n="png"),n=i.fixType(n),/bmp/.test(n)){var o=i.getImageData(i.scaleCanvas(e,t,r)),s=i.genBitmapImage(o);return i.makeURI(s,"image/bmp")}return i.getDataURL(e,n,t,r)}}}return e.prototype.scaleCanvas=function(e,t,i){var r=e.width,n=e.height;null==t&&(t=r),null==i&&(i=n);try{var o=document.createElement("canvas"),s=o.getContext("2d");return o.width=t,o.height=i,s.drawImage(e,0,0,r,n,(t-r)/2,(i-n)/2,r,n),s.fillStyle="black",s.strokeStyle="black",s.font="16px",s.textBaseline="hanging",s.fillText(WQ().format("L"),0,0),o}catch(e){pj.log(e)}},e.prototype.getDataURL=function(e,t,i,r){return(e=this.scaleCanvas(e,i,r)).toDataURL(t)},e.prototype.saveFile=function(e){document.location.href=e},e.prototype.genImage=function(e){var t=document.createElement("img");return t.src=e,t},e.prototype.fixType=function(e){return"image/"+(e=e.toLowerCase().replace(/jpg/i,"jpeg")).match(/png|jpeg|bmp|gif/)[0]},e.prototype.encodeData=function(e){if(!window.btoa)throw"btoa undefined";var t="";if("string"==typeof e)t=e;else for(var i=0;i<e.length;i++)t+=String.fromCharCode(e[i]);return btoa(t)},e.prototype.getImageData=function(e){var t=e.width,i=e.height;return e.getContext("2d").getImageData(0,0,t,i)},e.prototype.makeURI=function(e,t){return"data:"+t+";base64,"+e},e.prototype.scaleCanvasByResolution=function(e,t,i){var r=Number(JSON.parse(localStorage.getItem("resolutionScale")));r||(r=1);var n=e.width,o=e.height;void 0===t&&(t=n),void 0===i&&(i=o);try{var s=document.createElement("canvas"),a=s.getContext("2d");return s.width=t,s.height=i,a.drawImage(e,0,0,n,o,(t-n/r)/2,(i-o/r)/2,n/r,o/r),a.fillStyle="black",a.strokeStyle="black",a.font="16px",a.textBaseline="hanging",a.fillText(WQ().format("L"),0,0),s}catch(e){pj.log(e)}},e}(),mj=function(){function e(e){var t=this;this.animationList=[{groupName:"",groupList:[{name:"无效果",value:"",animatePic:""}]},{groupName:"基础效果",groupList:[{name:"淡入",value:"animate__custom animate__custom__fadeIn"},{name:"闪白",value:"animate__custom animate__flash__white"},{name:"百叶窗",value:"animate__custom animate__custom__blind"},{name:"叠化",value:"animate__custom animate__custom__dissolve"}]}],this.isAutoSet=!1,this.pageAnimateTime=3,this.blindNum=6,this.pageAnimationCompleted$=new th.x,this.viewer=e,window.addEventListener("resize",(function(){})),this.animationEndCallBack=function(){t.hideAnimationWrapper(),t.removeAddedElement(),t.isPageAnimationCompleted=!0,t.pageAnimationCompleted$.next(1);var e=document.querySelector(".pre-add-animation-wrapper");e&&e.remove()}}return Object.defineProperty(e.prototype,"isPageAnimationCompleted",{get:function(){return this._isPageAnimationCompleted},set:function(e){this._isPageAnimationCompleted=e},enumerable:!1,configurable:!0}),e.prototype.addAnimationToElement=function(e,t){if(!document.querySelector(".pre-add-animation-wrapper")){var i=document.createElement("div");i.className="pre-add-animation-wrapper";var r=document.createElement("div");r.className="pre-add-animation",i.appendChild(r),document.body.appendChild(i)}var n=t.animateType;t.animateTime=t.animateTime,this.isPageAnimationCompleted=!1;var o=document.querySelector(".pre-add-animation");if(this.restartAnimation(e,o),document.querySelector(".pre-add-animation-wrapper").style.zIndex="100",null==n?void 0:n.includes("animate__custom"))if(this.showAnimationWrapper(),this.clearPreAddElement(),this.removeAddedElement(),n.includes("animate__flash__white"))o.style.backgroundImage="",o.style.animationDuration="".concat(t.animateTime,"s"),this.addClassToPreAddElement(n);else if(n.includes("animate__custom__blind")){var s=this.viewer.scene.canvas,a=(d=new dj).scaleCanvasByResolution(s,o.getBoundingClientRect().width,o.getBoundingClientRect().height);o.style.backgroundImage="",o.style.animationDuration="".concat(t.animateTime,"s"),this.addClassToPreAddElement(n);for(var l=0;l<this.blindNum;l++){var h=document.createElement("div"),c=Math.ceil(o.getBoundingClientRect().width),u=Math.ceil(o.getBoundingClientRect().height/this.blindNum);h.style.width="".concat(o.getBoundingClientRect().width,"px"),h.style.height="".concat(u,"px"),h.style.display="inline-block",h.style.position="absolute",h.style.left="0px",h.style.top=u*l+"px",h.style.animationDuration="".concat(t.animateTime,"s"),h.classList.add("blind-tranform");var p=this.captureImage(o.getBoundingClientRect().width,o.getBoundingClientRect().height,c,u,l,a);h.style.backgroundImage="url(".concat(p,")"),h.style.backgroundSize="".concat(c,"px ").concat(u,"px"),h.style.backgroundRepeat="no-repeat",o.parentNode.appendChild(h)}}else if(n.includes("animate__custom__dissolve")){o.style.animationDuration="".concat(t.animateTime,"s"),this.addClassToPreAddElement(n);var d=new dj;s=this.viewer.scene.canvas,a=d.scaleCanvasByResolution(s,o.getBoundingClientRect().width,o.getBoundingClientRect().height),c=Math.ceil(o.getBoundingClientRect().width),u=Math.ceil(o.getBoundingClientRect().height),p=this.captureImage(o.getBoundingClientRect().width,o.getBoundingClientRect().height,c,u,0,a);o.style.backgroundImage="url(".concat(p,")"),o.style.backgroundRepeat="no-repeat"}else n.includes("animate__custom__fadeIn")&&(o.style.backgroundImage="",o.style.animationDuration="".concat(t.animateTime,"s"),this.addClassToPreAddElement(n));else this.showAnimationWrapper(),this.clearPreAddElement(),this.removeAddedElement(),this.addClassToPreAddElement("animate__custom__xxxx"),o.style.animationDuration="2s",document.querySelector(".pre-add-animation-wrapper").style.zIndex="-1";document.querySelector(".pre-add-animation-wrapper").removeEventListener("animationend",this.animationEndCallBack),document.querySelector(".pre-add-animation-wrapper").addEventListener("animationend",this.animationEndCallBack)},e.prototype.clearPreAddElement=function(){var e=document.querySelector(".pre-add-animation");e&&e.style&&(e.style.backgroundImage="",e.style.animationDuration="0s")},e.prototype.captureImage=function(e,t,i,r,n,o){if(i&&r)return this.partialCapture(o,i,r,n);var s=this.viewer.scene.canvas;return(new dj).convertToImage(s,e,t,"jpeg").toString()},e.prototype.hideAnimationWrapper=function(){var e=document.querySelector(".pre-add-animation-wrapper");e&&(e.style.display="none")},e.prototype.showAnimationWrapper=function(){document.querySelector(".pre-add-animation-wrapper").style.display="block"},e.prototype.removeAddedElement=function(){document.querySelectorAll(".blind-tranform").forEach((function(e){e.parentNode.removeChild(e)}))},e.prototype.endAnimation=function(){this.removeAddedElement(),this.clearPreAddElement(),this.hideAnimationWrapper()},e.prototype.addClassToPreAddElement=function(e){document.querySelector(".pre-add-animation").className="pre-add-animation ".concat(e)},e.prototype.restartAnimation=function(e,t){e.style.animation="none",t.style.animation="none",e.offsetHeight,e.style.animation=null,t.style.animation=null},e.prototype.partialCapture=function(e,t,i,r){var n=document.createElement("canvas");n.width=t,n.height=i;var o=n.getContext("2d");return null==o||o.drawImage(e,0,i*r,t,i,0,0,t,i),null==n?void 0:n.toDataURL("image/png")},e}(),fj=i(5108),gj=i(3085).lW,Aj=function(e,t,i,r){return new(i||(i=Promise))((function(n,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?n(e.value):function(e){return e instanceof i?e:new i((function(t){t(e)}))}(e.value).then(s,a)}l((r=r.apply(e,t||[])).next())}))},yj=function(e,t){var i,r,n,o,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,r&&(n=2&o[0]?r.return:o[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,o[1])).done)return n;switch(r=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(n=s.trys,(n=n.length>0&&n[n.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){s.label=o[1];break}if(6===o[0]&&s.label<n[1]){s.label=n[1],n=o;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(o);break}n[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{i=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},vj=function(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],r=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Cj=function(){function e(e,t,i,r){void 0===i&&(i=!1),void 0===r&&(r=!1);var n=this;this.fallBackPic="/resources/images/scene-pic.jpg",this.geopptServicePlaceHolder="-gsph-",this.placeHolderReg=new RegExp(this.geopptServicePlaceHolder,"g"),this.currentPageIndex=0,this.autoPlayMode=!1,this.stopRotate=!1,this.animationOnStop=function(e){n.stopRotate=e,n.gm.animationManager.canNextAnimation()||n.stopAnimatin(),n.onAnimationChanged&&n.onAnimationChanged()},this.ani=e.animationService;var o=e.configService.getGeopptWebUrlIp(),s=e.configService.getGeopptServiceUrlIp(),a=e.configService.getTerrainUrlIp(),l=e.configService.getGlobalTerrainUrlIp();e.configService.getPageUrlIp();this.engine=t,this.geopptWebUrl=o,this.geopptServiceUrl=s,t.viewer.scene.orderGroundPrimitives=new Cesium.OrderedGroundPrimitiveCollection,t.viewer.scene.primitives.add(t.viewer.scene.orderGroundPrimitives),this.viewer=t.viewer,this.showLayer=i,Ax.DefaultConfig(),this.showLayer&&(this.lm=new uj(o,s,this.viewer),this.layerConfig=this.lm.getConfig()),this.showImageEffect=r,this.showImageEffect&&(this.iem=new ej(this.viewer,a,l)),this.pam=new mj(this.viewer)}return e.prototype.fetchPage=function(e){var t=this;fetch(e).then((function(e){return e.json()})).then((function(e){t.openScene(e).then((function(){var e=document.getElementById("pageList");if(e&&t.pages){for(var i=0;i<t.pages.length;i++){var r=t.pages[i],n=document.createElement("option");n.setAttribute("label",r.name),n.setAttribute("value",i.toString()),e.appendChild(n)}e.onchange=function(){var i=e.selectedIndex;t.changeSelect(t.pages[i]),t.currentPageIndex=i}}}))})).catch((function(e){return fj.error("Request Failed",e)}))},e.prototype.openScene=function(e){return Aj(this,void 0,void 0,(function(){var t,i,r,n,o,s,a,l,h,c;return yj(this,(function(u){switch(u.label){case 0:return fj.log("this.drawService.open$.subscribe$",e),this.currentScene=e,i=[],(r=t instanceof rk)&&(t=(0,Ux.d8)(rk,e)),this.pages=[],i=this.currentScene.draws,fj.log("pages",i),0!==i.length?[3,2]:[4,this.add()];case 1:return u.sent(),[3,10];case 2:u.trys.push([2,7,8,9]),n=vj(i),o=n.next(),u.label=3;case 3:return o.done?[3,6]:((s=o.value).url||s.image?s.url=this.convertPageImage(s):s.url=this.fallBackPic,a=s,[4,this.getByPage(s.id,r)]);case 4:a.draws=u.sent(),this.transformToGraphManager(s),this.pages.push(s),u.label=5;case 5:return o=n.next(),[3,3];case 6:return[3,9];case 7:return l=u.sent(),h={error:l},[3,9];case 8:try{o&&!o.done&&(c=n.return)&&c.call(n)}finally{if(h)throw h.error}return[7];case 9:this.changeSelect(this.pages[0]),u.label=10;case 10:return[2]}}))}))},e.prototype.changeSelect=function(e,t,i){return void 0===t&&(t=!0),void 0===i&&(i=!1),Aj(this,void 0,void 0,(function(){var r;return yj(this,(function(n){return qN.getInstance().stop(),this.clean(),this.stopAnimatin(),(r=document.querySelector("#GvolContainer"))&&this.pam.addAnimationToElement(r,e),this.loadPage(t,e,i),[2]}))}))},e.prototype.stopAnimatin=function(){return Aj(this,void 0,void 0,(function(){return yj(this,(function(e){switch(e.label){case 0:return this.gm?[4,this.gm.animationManager.stop()]:[3,2];case 1:e.sent(),this.viewer.clock.shouldAnimate=!1,e.label=2;case 2:return[2]}}))}))},e.prototype.loadPage=function(e,t,i){return Aj(this,void 0,void 0,(function(){return yj(this,(function(e){switch(e.label){case 0:return[4,this.createOrEdit(this.viewer,t.ext)];case 1:return e.sent(),this.currentPage=t,this.showLayer&&this.lm.pageToLayerList(this.currentPage),this.showImageEffect&&this.iem.initStatus(this.currentPage),this.pageLoadCompleted(),[2]}}))}))},e.prototype.pageLoadCompleted=function(){var e=this;this.gm.animationManager.playByGroup(new Date),this.plotEnable(!0),null==this.onAnimationChanged&&void 0===this.onAnimationChanged||this.autoPlayMode&&(this.pam.isPageAnimationCompleted?this.autoPlay():(this.pageAnimationCompletedSubscription&&(this.pageAnimationCompletedSubscription.unsubscribe(),this.pageAnimationCompletedSubscription=null),this.pageAnimationCompletedSubscription=this.pam.pageAnimationCompleted$.subscribe((function(t){e.autoPlay()}))))},e.prototype.plotEnable=function(e){this.gm&&(this.gm.editor.isReadOnly=e)},e.prototype.createOrEdit=function(e,t){return void 0===t&&(t=null),Aj(this,void 0,void 0,(function(){var i,r,n,o,s;return yj(this,(function(a){return fj.log("恢复对象>>>",t),this.gm||(this.layerConfig={layerId:"plot"+Yy.newGuid(),editAfterCreate:!0,operatorEnable:!0,isReadOnly:!1},this.gm=new mH(this.engine,this.layerConfig),this.gm.animationManager.saStop$.subscribe(this.animationOnStop)),this.hm=new UU(e),this.hm.outsideHtml&&this.currentScene&&(i=getComputedStyle(this.hm.outsideHtml),r=parseInt(i.width.substr(0,i.width.indexOf("p")))/this.currentScene.width,n=parseInt(i.height.substr(0,i.height.indexOf("p")))/this.currentScene.height,o=r<n?r:n,this.hm.scalePercent=o,this.hm.calculateScale()),this.sm=new ZU(this.hm.containerDiv),this.bfm=new FU(e),this.mm=new zU,t?(fj.log("createOrEdit",t),s=(s=JSON.stringify(t)).replace(this.placeHolderReg,this.geopptServiceUrl),t=JSON.parse(s),this.gm.load(t),t.html&&this.hm.setListByData(t.html),t.subtitle?this.sm.setSubtitleList(t.subtitle):this.sm.setSubtitleList([]),t.bigfile&&(fj.log("json bigfile",t.bigfile),this.bfm.setListByData(t.bigfile)),t.music&&this.mm.recoverData(t.music),this.plotList=this.gm.graphList,[2]):(this.sm.setSubtitleList([]),[2])}))}))},e.prototype.convertPageImage=function(e){if(e.url)return e.url;var t=gj.allocUnsafe(e.image.data.length);return t.fill(e.image.data,0),"data:image/jpeg;base64,"+t.toString("base64")},e.prototype.transformToGraphManager=function(e){var t=e.draws.find((function(e){return"graph"==e.type}));return t&&(e.ext=t.ext),ty.Remove(e.draws,t),t},e.prototype.add=function(e){return Aj(this,void 0,void 0,(function(){var t;return yj(this,(function(i){return null==window.viewer?(fj.log("球实例 未创建"),[2]):((t=new ok).pageTime=new Date,t.index=e?Number(e+1):this.pages.length+1,t.draws=[],this.changeSelect(this.pages[e]),[2])}))}))},e.prototype.getPage=function(e,t){return void 0===t&&(t=!1),Aj(this,void 0,void 0,(function(){var i;return yj(this,(function(r){switch(r.label){case 0:return i="".concat(this.geopptServiceUrl,"/page/getPage?id=").concat(e,"&isFromPublish=").concat(t),fj.log("getPage",i),[4,fetch(i)];case 1:return[4,r.sent().json()];case 2:return[2,r.sent()]}}))}))},e.prototype.getByPage=function(e,t){return void 0===t&&(t=!1),Aj(this,void 0,void 0,(function(){return yj(this,(function(i){switch(i.label){case 0:return[4,fetch("".concat(this.geopptServiceUrl,"/plot/getByPage?id=").concat(e,"&isFromPublish=").concat(t))];case 1:return[4,i.sent().json()];case 2:return[2,i.sent()]}}))}))},e.prototype.previousPage=function(){return Aj(this,void 0,void 0,(function(){return yj(this,(function(e){switch(e.label){case 0:return this.pages&&this.pages.length>1&&this.currentPageIndex>0?[4,this.gm.animationManager.stop()]:[3,2];case 1:e.sent(),this.currentPageIndex=this.currentPageIndex-1,this.playState=bj.stoped,this.stopRotate=!1,this.changeSelect(this.pages[this.currentPageIndex]),e.label=2;case 2:return[2]}}))}))},e.prototype.nextPage=function(){return Aj(this,void 0,void 0,(function(){return yj(this,(function(e){switch(e.label){case 0:return this.pages&&this.pages.length>1&&this.currentPageIndex<this.pages.length-1?[4,this.gm.animationManager.stop()]:[3,2];case 1:e.sent(),this.currentPageIndex=this.currentPageIndex+1,this.playState=bj.stoped,this.stopRotate=!1,this.changeSelect(this.pages[this.currentPageIndex]),e.label=2;case 2:return[2]}}))}))},e.prototype.playAndPause=function(){this.autoPlayMode?this.playState!=bj.playing||this.gm.animationManager.clock.isPaused?this.playState==bj.paused?this.continue():this.autoPlay():this.pause():this.playState!=bj.playing||this.gm.animationManager.clock.isPaused?this.playState==bj.paused?this.continue():this.next():this.pause()},e.prototype.pause=function(e){void 0===e&&(e=!1),this.playState=bj.paused,this.gm.animationManager.clock.pause(),this.stopRotate=!1,e&&this.clearAutoChanged()},e.prototype.continue=function(e){void 0===e&&(e=!1),this.gm.animationManager.clock.resume(),this.stopRotate=!0,this.playState=bj.playing,e&&this.setAutoChanged()},e.prototype.next=function(){var e=this;if(this.gm.animationManager.canNextAnimation()){var t=this.pages.find((function(t){return t.index==e.currentPageIndex+1}));this.ani.startPlay(t),this.gm.animationManager.next(),this.playState=bj.playing,this.stopRotate=!0}else this.nextPage()},e.prototype.autoPlay=function(e){void 0===e&&(e=2),this.autoPlayMode&&(this.setAutoChanged(),this.next())},e.prototype.setAutoChanged=function(){var e=this;this.onAnimationChanged=function(){e.gm.animationManager.canNextAnimation()?(e.gm.animationManager.currentIndex+=1,e.gm.animationManager.clock.resume(),e.playState=bj.playing,e.stopRotate=!0):(e.playState=bj.stoped,e.hasFinished()?(e.onAnimationChanged=void 0,e.stopRotate=!1):e.next())}},e.prototype.clearAutoChanged=function(){this.onAnimationChanged=null},e.prototype.hasFinished=function(){return!(!this.pages||!this.gm)&&(this.currentPageIndex==this.pages.length-1&&this.gm.animationManager.currentIndex==this.gm.animationManager.animationGroupList.length-1&&this.playState==bj.stoped)},e.prototype.clean=function(){this.gm&&(this.gm.close(),this.gm.animationManager.destroy()),this.hm&&this.hm.clearHtmlDiv(),this.bfm&&this.bfm.cleanAll(),this.mm&&this.mm.clean()},e}();const _j=Cj;var bj;!function(e){e[e.stoped=0]="stoped",e[e.playing=1]="playing",e[e.paused=2]="paused"}(bj||(bj={}));var wj=i(5108);const Pj=class extends cf{constructor(e,t,i=null){super(e,t,i),this._serviceManager=new EU(this),this._serviceManager.load(t.resourceUrl),this._sceneManager=new _j(this._serviceManager,this,!1,!1),this._analysisModule=new ah(this),this._layerManager=new yv(this),this._plot=new LU(this._serviceManager),this._plot.loaded(),wj.log("服务加载完成...")}capture(e,t,i){return capture(this._scene,e,t,i)}captureScreenExport(){const e=this.captureScreenshot();e&&e.then((e=>{e&&this.captureScreenSave(e,`${Date.now()}.png`)}))}captureScreenshot(){const{when:e}=Cesium,t=e.defer();var i=this.viewer.scene.postRender.addEventListener((function(){i();try{this.viewer.scene.canvas.toBlob((function(e){t.resolve(e)}),"image/png")}catch(e){t.reject(e)}}),this);return this.viewer.scene.render(this.viewer.clock.currentTime),t.promise}captureScreenSave(e,t){if(null!==e)if(window.navigator.msSaveOrOpenBlob)navigator.msSaveBlob(e,t);else{const i=document.createElement("a"),r=document.querySelector("body");i.href=window.URL.createObjectURL(e),i.download=t,i.style.display="none",r.appendChild(i),i.click(),r.removeChild(i),window.URL.revokeObjectURL(i.href)}}get layerManager(){return this._layerManager}get tileLayer(){return this.layerManager.tileLayer}get graphicLayer(){return this.layerManager.graphicLayer}get plotLayer(){return this.layerManager.plotLayer}get dynamicLayer(){return this.layerManager.dynamicLayer}get serviceManager(){return this._serviceManager}get sceneManager(){return this._sceneManager}get analysisModule(){return this._analysisModule}get plot(){return this._plot}};const Sj=class{threeMesh=null;minWGS84=null;maxWGS84=null};class xj extends h.Z{constructor(e,t){super();const i={ambientLightColor:2236962,ambientLightVisible:!1,fov:45,near:1,far:1e7};if(t)for(var r in i)Cesium.defined(t[r])||(t[r]=i[r]);else t=i;this._engine=e;let n=t.fov,o=this._engine.viewer.cesiumWidget.canvas.width/this._engine.viewer.cesiumWidget.canvas.height,s=t.near,a=t.far;this._scene=new THREE.Scene,this._renderer=new THREE.WebGLRenderer({alpha:!0,antialias:!0}),this._renderer.outputEncoding=THREE.sRGBEncoding,this._renderer.shadowMap.enabled=!0;let l=new THREE.AmbientLight(t.ambientLightColor);l.visible=t.ambientLightVisible,this._scene.add(l),this._camera=new THREE.PerspectiveCamera(n,o,s,a),this._threeObjects=[],this._root=new Sj,this._root.threeMesh=new THREE.Group;this._root.minWGS84=[115.56936458615716,39.284100766866445],this._root.maxWGS84=[117.10745052365716,41.107831235616445],this._root.threeMesh.scale.set(1,1,1),this._scene.add(this._root.threeMesh),this._threeObjects.push(this._root),this._engine.viewer.cesiumWidget.canvas.parentElement.appendChild(this._renderer.domElement)}renderLoop(){this.renderCesium(),this.render()}renderCesium(){this._engine.viewer.render()}time=0;render(){this.time++;var e=.01*this.time;Math.sin(e);this._camera.fov=Cesium.Math.toDegrees(this._engine.viewer.camera.frustum.fovy);let t=function(e){return new THREE.Vector3(e.x,e.y,e.z)};for(let e in this._threeObjects){let i=this._threeObjects[e].minWGS84,r=this._threeObjects[e].maxWGS84,n=Cesium.Cartesian3.fromDegrees((i[0]+r[0])/2,(i[1]+r[1])/2),o=Cesium.Cartesian3.fromDegrees((i[0]+r[0])/2,(i[1]+r[1])/2,1),s=t(Cesium.Cartesian3.fromDegrees(i[0],i[1])),a=t(Cesium.Cartesian3.fromDegrees(i[0],r[1])),l=(new THREE.Vector3).subVectors(s,a).normalize();this._threeObjects[e].threeMesh.position.copy(n),this._threeObjects[e].threeMesh.lookAt(o.x,o.y,o.z),this._threeObjects[e].threeMesh.up.copy(l)}this._camera.matrixAutoUpdate=!1;let i=this._engine.viewer.camera.viewMatrix,r=this._engine.viewer.camera.inverseViewMatrix;this._camera.lookAt(0,0,0),this._camera.matrixWorld.set(r[0],r[4],r[8],r[12],r[1],r[5],r[9],r[13],r[2],r[6],r[10],r[14],r[3],r[7],r[11],r[15]),this._camera.matrixWorldInverse.set(i[0],i[4],i[8],i[12],i[1],i[5],i[9],i[13],i[2],i[6],i[10],i[14],i[3],i[7],i[11],i[15]);let n=this._engine.viewer.cesiumWidget.canvas.width,o=this._engine.viewer.cesiumWidget.canvas.height,s=n/o;this._camera.aspect=s,this._camera.updateProjectionMatrix(),this._renderer.setSize(n,o),this._renderer.clear(),this._renderer.render(this._scene,this._camera)}renderOnly(){this.renderer.render(this._scene,this._camera)}get threeObjects(){return this._threeObjects}get root(){return this._root}get scene(){return this._scene}get camera(){return this._camera}get renderer(){return this._renderer}}const Bj=xj,Mj=/{[^}]+}/g;const Ej={OCT_VERTEX_NORMALS:1,WATER_MASK:2,METADATA:4};function Tj(e){if(!Cesium.defined(e)||0===e.length)return{Accept:"application/vnd.quantized-mesh,application/octet-stream;q=0.9,*/*;q=0.01"};return{Accept:`application/vnd.quantized-mesh;extensions=${e.join("-")},application/octet-stream;q=0.9,*/*;q=0.01`}}const Oj=function(e){Cesium.CesiumTerrainProvider.prototype.requestTileGeometry=function(e,t,i,r){if(!this._ready)throw new Cesium.DeveloperError("requestTileGeometry must not be called before the terrain provider is ready.");const n=this._layers;let o;const s=n.length;if(1===s)o=n[0];else for(let r=0;r<s;++r){const s=n[r];if(!Cesium.defined(s.availability)||s.availability.isTileAvailable(i,e,t)){o=s;break}}return function(e,t,i,r,n,o){if(!Cesium.defined(n))return Cesium.when.reject(new Cesium.RuntimeError("Terrain tile doesn't exist"));const s=n.tileUrlTemplates;if(0===s.length)return;let a;if(e._scheme&&"tms"!==e._scheme)a=i;else{a=e._tilingScheme.getNumberOfYTilesAtLevel(r)-i-1}const l=[];e._requestVertexNormals&&n.hasVertexNormals&&l.push(n.littleEndianExtensionSize?"octvertexnormals":"vertexnormals");e._requestWaterMask&&n.hasWaterMask&&l.push("watermask");e._requestMetadata&&n.hasMetadata&&l.push("metadata");let h,c;const u=s[(t+a+r)%s.length],p=n.resource;Cesium.defined(p._ionEndpoint)&&!Cesium.defined(p._ionEndpoint.externalType)?(0!==l.length&&(c={extensions:l.join("-")}),h=Tj(void 0)):h=Tj(l);let d=function(e,t,i){const r=(e+t+i)%GVOL._terrainsubdomains.length;return GVOL._terrainsubdomains[r]}(t,a,r);const m=GVOL._terrainOptions.url.match(Mj);Cesium.defined(m)&&(p._url=GVOL._terrainOptions.url.replace(m,d).split("?")[0],p._url+="/");const f=p.getDerivedResource({url:u,templateValues:{version:n.version,z:r,x:t,y:a},queryParameters:c,headers:h,request:o}).fetchArrayBuffer();if(!Cesium.defined(f))return;return f.then((function(o){return Cesium.defined(e._heightmapStructure)?function(e,t,i,r,n){const o=new Uint16Array(t,0,e._heightmapWidth*e._heightmapWidth);return new Cesium.HeightmapTerrainData({buffer:o,childTileMask:new Uint8Array(t,o.byteLength,1)[0],waterMask:new Uint8Array(t,o.byteLength+1,t.byteLength-o.byteLength-1),width:e._heightmapWidth,height:e._heightmapWidth,structure:e._heightmapStructure,credits:e._tileCredits})}(e,o):function(e,t,i,r,n,o){const s=o.littleEndianExtensionSize;let a=0;const l=3,h=l+1,c=Float64Array.BYTES_PER_ELEMENT*l,u=Float64Array.BYTES_PER_ELEMENT*h,p=3,d=Uint16Array.BYTES_PER_ELEMENT*p,m=3;let f=Uint16Array.BYTES_PER_ELEMENT,g=f*m;const A=new DataView(t),y=new Cesium.Cartesian3(A.getFloat64(a,!0),A.getFloat64(a+8,!0),A.getFloat64(a+16,!0));a+=c;const v=A.getFloat32(a,!0);a+=Float32Array.BYTES_PER_ELEMENT;const C=A.getFloat32(a,!0);a+=Float32Array.BYTES_PER_ELEMENT;const _=new Cesium.BoundingSphere(new Cesium.Cartesian3(A.getFloat64(a,!0),A.getFloat64(a+8,!0),A.getFloat64(a+16,!0)),A.getFloat64(a+c,!0));a+=u;const b=new Cesium.Cartesian3(A.getFloat64(a,!0),A.getFloat64(a+8,!0),A.getFloat64(a+16,!0));a+=c;const w=A.getUint32(a,!0);a+=Uint32Array.BYTES_PER_ELEMENT;const P=new Uint16Array(t,a,3*w);a+=w*d,w>65536&&(f=Uint32Array.BYTES_PER_ELEMENT,g=f*m);const S=P.subarray(0,w),x=P.subarray(w,2*w),B=P.subarray(2*w,3*w);Cesium.AttributeCompression.zigZagDeltaDecode(S,x,B),a%f!=0&&(a+=f-a%f);const M=A.getUint32(a,!0);a+=Uint32Array.BYTES_PER_ELEMENT;const E=Cesium.IndexDatatype.createTypedArrayFromArrayBuffer(w,t,a,M*m);a+=M*g;let T=0;const O=E.length;for(let e=0;e<O;++e){const t=E[e];E[e]=T-t,0===t&&++T}const L=A.getUint32(a,!0);a+=Uint32Array.BYTES_PER_ELEMENT;const D=Cesium.IndexDatatype.createTypedArrayFromArrayBuffer(w,t,a,L);a+=L*f;const I=A.getUint32(a,!0);a+=Uint32Array.BYTES_PER_ELEMENT;const R=Cesium.IndexDatatype.createTypedArrayFromArrayBuffer(w,t,a,I);a+=I*f;const H=A.getUint32(a,!0);a+=Uint32Array.BYTES_PER_ELEMENT;const F=Cesium.IndexDatatype.createTypedArrayFromArrayBuffer(w,t,a,H);a+=H*f;const N=A.getUint32(a,!0);a+=Uint32Array.BYTES_PER_ELEMENT;const Q=Cesium.IndexDatatype.createTypedArrayFromArrayBuffer(w,t,a,N);let k,U;a+=N*f;for(;a<A.byteLength;){const l=A.getUint8(a,!0);a+=Uint8Array.BYTES_PER_ELEMENT;const h=A.getUint32(a,s);if(a+=Uint32Array.BYTES_PER_ELEMENT,l===Ej.OCT_VERTEX_NORMALS&&e._requestVertexNormals)k=new Uint8Array(t,a,2*w);else if(l===Ej.WATER_MASK&&e._requestWaterMask)U=new Uint8Array(t,a,h);else if(l===Ej.METADATA&&e._requestMetadata){const s=A.getUint32(a,!0);if(s>0){const r=Cesium.getJsonFromTypedArray(new Uint8Array(t),a+Uint32Array.BYTES_PER_ELEMENT,s).available;if(defined(r))for(let t=0;t<r.length;++t){const n=i+t+1,s=r[t],a=e._tilingScheme.getNumberOfYTilesAtLevel(n);for(let t=0;t<s.length;++t){const i=s[t],r=a-i.endY-1,l=a-i.startY-1;e.availability.addAvailableTileRange(n,i.startX,r,i.endX,l),o.availability.addAvailableTileRange(n,i.startX,r,i.endX,l)}}}o.availabilityTilesLoaded.addAvailableTileRange(i,r,n,r,n)}a+=h}const j=5*e.getLevelMaximumGeometricError(i),G=e._tilingScheme.tileXYToRectangle(r,n,i),z=Cesium.OrientedBoundingBox.fromRectangle(G,v,C,e._tilingScheme.ellipsoid);return new Cesium.QuantizedMeshTerrainData({center:y,minimumHeight:v,maximumHeight:C,boundingSphere:_,orientedBoundingBox:z,horizonOcclusionPoint:b,quantizedVertices:P,encodedNormals:k,indices:E,westIndices:D,southIndices:R,eastIndices:F,northIndices:Q,westSkirtHeight:j,southSkirtHeight:j,eastSkirtHeight:j,northSkirtHeight:j,childTileMask:e.availability.computeChildMaskForTile(i,r,n),waterMask:U,credits:e._tileCredits})}(e,o,r,t,i,n)}))}(this,e,t,i,o,r)},GVOL._terrainsubdomains=e.subdomains,Array.isArray(e._subdomains)&&(GVOL._terrainsubdomains=GVOL._terrainsubdomains.slice()),GVOL._terrainOptions=Object.assign({},e);const t=e.url.match(Mj);return Cesium.defined(t)&&(e.url=e.url.replace(t,"")),new Cesium.CesiumTerrainProvider(e)},Lj={Graticule:Vm,GvolTerrainProvider:Oj};function Dj(){return!!JA.isReady}window.GVOL||(window.GVOL={});Dj();var Ij=new KA,Rj=Rj||WebGLRenderingContext,Hj={copyright:a,get VERSION(){return a._printVersion(),"V1.0.1"},GvolEngine:Pj,GvolScene:Bj,Obj:NA,Core:b,Scene:Lj,SceneTree:la,LayerMgr:yw,MVVM:Js,HTML:R.Z,Tool:ei,Mixins:ww,ready:JA,isReady:Dj,pool:Ij,cso:void 0,csn:void 0};window.GVOL_BASE_URL||(window.GVOL_BASE_URL="./"),Object.assign(window.GVOL,Hj)},1932:e=>{e.exports="czm_material czm_getMaterial(czm_materialInput materialInput)\n{\n    czm_material material = czm_getDefaultMaterial(materialInput);\n    material.diffuse = 1.5 * color.rgb;\n\n    vec2 st = materialInput.st;\n    float dis = distance(st, vec2(0.5, 0.5));\n\n    float per = fract(time);\n    if(dis > per * 0.5){\n       //material.alpha = 0.0;\n       discard;\n    }else {\n         material.alpha = color.a  * dis / per / 2.0;\n    }\n    return material;\n}"},7413:e=>{e.exports="uniform vec4 color;\nuniform float glowPower;\n\nvarying float v_width;\n\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\n    czm_material material = czm_getDefaultMaterial(materialInput);\n\n    vec2 st = materialInput.st;\n    float glow = glowPower / abs(st.t - 0.5) - (glowPower / 0.5);\n\n    material.emission = max(vec3(glow - 1.0 + color.rgb), color.rgb);\n    material.alpha = clamp(0.0, 1.0, glow) * color.a * st.s;\n\n    //material.emission =  color.rgb;\n    //material.alpha =  color.a;\n\n    return material;\n}\n"},9272:e=>{e.exports="czm_material czm_getMaterial(czm_materialInput materialInput)\n{\n    czm_material material = czm_getDefaultMaterial(materialInput);\n    vec2 st = materialInput.st;\n\n    if(texture2D(image, vec2(0.0, 0.0)).a == 1.0){\n        discard;\n    }else{\n         material.alpha = texture2D(image, vec2(1.0 - fract(time - st.s), st.t)).a * color.a;\n    }\n\n    material.diffuse = max(color.rgb * material.alpha * 3.0, color.rgb);\n\n    return material;\n}"},1756:e=>{e.exports="czm_material czm_getMaterial(czm_materialInput materialInput)\n{\n    czm_material material = czm_getDefaultMaterial(materialInput);\n    vec2 st = materialInput.st;\n\n    if(texture2D(image, vec2(0.0, 0.0)).a == 1.0){\n        discard;\n    }else{\n         material.alpha = texture2D(image, vec2(1.0 - fract(time - st.s), st.t)).a * color.a;\n    }\n\n    material.diffuse = max(color.rgb * material.alpha * 10.0, color.rgb);\n\n    return material;\n}"},989:e=>{e.exports="czm_material czm_getMaterial(czm_materialInput materialInput)\n{\n    czm_material material = czm_getDefaultMaterial(materialInput);\n    vec2 st = materialInput.st;\n\n    if(texture2D(image, vec2(0.0, 0.0)).a == 1.0){\n        discard;\n    }else{\n         material.alpha = texture2D(image, st).a * color.a;\n    }\n\n   /* if(texture2D(image, st).a > 0.9){\n       material.diffuse = vec3(1.0);\n    }else{\n     material.diffuse = color.rgb;\n    }*/\n\n    material.diffuse = max( material.diffuse* material.alpha * 3.0,  material.diffuse);\n\n    return material;\n}"},8122:e=>{e.exports="uniform vec4 u_intersectionColor;\nuniform float u_intersectionWidth;\nuniform vec4 u_lineColor;\n\nbool inSensorShadow(vec3 coneVertexWC, czm_ellipsoid ellipsoidEC, vec3 pointWC)\n{\n    // Diagonal matrix from the unscaled ellipsoid space to the scaled space.    \n    vec3 D = ellipsoidEC.inverseRadii;\n\n    // Sensor vertex in the scaled ellipsoid space\n    vec3 q = D * coneVertexWC;\n    float qMagnitudeSquared = dot(q, q);\n    float test = qMagnitudeSquared - 1.0;\n    \n    // Sensor vertex to fragment vector in the ellipsoid's scaled space\n    vec3 temp = D * pointWC - q;\n    float d = dot(temp, q);\n    \n    // Behind silhouette plane and inside silhouette cone\n    return (d < -test) && (d / length(temp) < -sqrt(test));\n}\n\n///////////////////////////////////////////////////////////////////////////////\n\nvec4 getLineColor()\n{\n    return u_lineColor;\n}\n\nvec4 getIntersectionColor()\n{\n    return u_intersectionColor;\n}\n\nfloat getIntersectionWidth()\n{\n    return u_intersectionWidth;\n}\n\nvec2 sensor2dTextureCoordinates(float sensorRadius, vec3 pointMC)\n{\n    // (s, t) both in the range [0, 1]\n    float t = pointMC.z / sensorRadius;\n    float s = 1.0 + (atan(pointMC.y, pointMC.x) / czm_twoPi);\n    s = s - floor(s);\n    \n    return vec2(s, t);\n}\n"},2443:e=>{e.exports='#ifdef GL_OES_standard_derivatives\n    #extension GL_OES_standard_derivatives : enable\n#endif\n\nuniform bool u_showIntersection;\nuniform bool u_showThroughEllipsoid;\n\nuniform float u_radius;\nuniform float u_xHalfAngle;\nuniform float u_yHalfAngle;\nuniform float u_normalDirection;\nuniform float u_type;\n\nvarying vec3 v_position;\nvarying vec3 v_positionWC;\nvarying vec3 v_positionEC;\nvarying vec3 v_normalEC;\n\nvec4 getColor(float sensorRadius, vec3 pointEC)\n{\n    czm_materialInput materialInput;\n\n    vec3 pointMC = (czm_inverseModelView * vec4(pointEC, 1.0)).xyz;\n    materialInput.st = sensor2dTextureCoordinates(sensorRadius, pointMC);\n    materialInput.str = pointMC / sensorRadius;\n\n    vec3 positionToEyeEC = -v_positionEC;\n    materialInput.positionToEyeEC = positionToEyeEC;\n\n    vec3 normalEC = normalize(v_normalEC);\n    materialInput.normalEC = u_normalDirection * normalEC;\n\n    czm_material material = czm_getMaterial(materialInput);\n\n    return mix(czm_phong(normalize(positionToEyeEC), material), vec4(material.diffuse, material.alpha), 0.4);\n\n}\n\nbool isOnBoundary(float value, float epsilon)\n{\n    float width = getIntersectionWidth();\n    float tolerance = width * epsilon;\n\n#ifdef GL_OES_standard_derivatives\n    float delta = max(abs(dFdx(value)), abs(dFdy(value)));\n    float pixels = width * delta;\n    float temp = abs(value);\n    // There are a couple things going on here.\n    // First we test the value at the current fragment to see if it is within the tolerance.\n    // We also want to check if the value of an adjacent pixel is within the tolerance,\n    // but we don\'t want to admit points that are obviously not on the surface.\n    // For example, if we are looking for "value" to be close to 0, but value is 1 and the adjacent value is 2,\n    // then the delta would be 1 and "temp - delta" would be "1 - 1" which is zero even though neither of\n    // the points is close to zero.\n    return temp < tolerance && temp < pixels || (delta < 10.0 * tolerance && temp - delta < tolerance && temp < pixels);\n#else\n    return abs(value) < tolerance;\n#endif\n}\n\nvec4 shade(bool isOnBoundary)\n{\n    if (u_showIntersection && isOnBoundary)\n    {\n        return getIntersectionColor();\n    }\n    if(u_type == 1.0){\n        return getLineColor();\n    }\n    return getColor(u_radius, v_positionEC);\n}\n\nfloat ellipsoidSurfaceFunction(czm_ellipsoid ellipsoid, vec3 point)\n{\n    vec3 scaled = ellipsoid.inverseRadii * point;\n    return dot(scaled, scaled) - 1.0;\n}\n\nvoid main()\n{\n    vec3 sensorVertexWC = czm_model[3].xyz;      // (0.0, 0.0, 0.0) in model coordinates\n    vec3 sensorVertexEC = czm_modelView[3].xyz;  // (0.0, 0.0, 0.0) in model coordinates\n\n    //vec3 pixDir = normalize(v_position);\n    float positionX = v_position.x;\n    float positionY = v_position.y;\n    float positionZ = v_position.z;\n\n    vec3 zDir = vec3(0.0, 0.0, 1.0);\n    vec3 lineX = vec3(positionX, 0 ,positionZ);\n    vec3 lineY = vec3(0, positionY, positionZ);\n    float resX = dot(normalize(lineX), zDir);\n    if(resX < cos(u_xHalfAngle)-0.00001){\n        discard;\n    }\n    float resY = dot(normalize(lineY), zDir);\n    if(resY < cos(u_yHalfAngle)-0.00001){\n        discard;\n    }\n\n\n    czm_ellipsoid ellipsoid = czm_getWgs84EllipsoidEC();\n    float ellipsoidValue = ellipsoidSurfaceFunction(ellipsoid, v_positionWC);\n\n    // Occluded by the ellipsoid?\n\tif (!u_showThroughEllipsoid)\n\t{\n\t    // Discard if in the ellipsoid\n\t    // PERFORMANCE_IDEA: A coarse check for ellipsoid intersection could be done on the CPU first.\n\t    if (ellipsoidValue < 0.0)\n\t    {\n            discard;\n\t    }\n\n\t    // Discard if in the sensor\'s shadow\n\t    if (inSensorShadow(sensorVertexWC, ellipsoid, v_positionWC))\n\t    {\n\t        discard;\n\t    }\n    }\n\n    // Notes: Each surface functions should have an associated tolerance based on the floating point error.\n    bool isOnEllipsoid = isOnBoundary(ellipsoidValue, czm_epsilon3);\n    //isOnEllipsoid = false;\n    //if((resX >= 0.8 && resX <= 0.81)||(resY >= 0.8 && resY <= 0.81)){\n    /*if(false){\n        gl_FragColor = vec4(1.0,0.0,0.0,1.0);\n    }else{\n        gl_FragColor = shade(isOnEllipsoid);\n    }\n*/\n    gl_FragColor = shade(isOnEllipsoid);\n\n}'},4549:e=>{e.exports='#ifdef GL_OES_standard_derivatives\n    #extension GL_OES_standard_derivatives : enable\n#endif\n\nuniform bool u_showIntersection;\nuniform bool u_showThroughEllipsoid;\n\nuniform float u_radius;\nuniform float u_xHalfAngle;\nuniform float u_yHalfAngle;\nuniform float u_normalDirection;\nuniform vec4 u_color;\n\nvarying vec3 v_position;\nvarying vec3 v_positionWC;\nvarying vec3 v_positionEC;\nvarying vec3 v_normalEC;\n\nvec4 getColor(float sensorRadius, vec3 pointEC)\n{\n    czm_materialInput materialInput;\n\n    vec3 pointMC = (czm_inverseModelView * vec4(pointEC, 1.0)).xyz;\n    materialInput.st = sensor2dTextureCoordinates(sensorRadius, pointMC);\n    materialInput.str = pointMC / sensorRadius;\n\n    vec3 positionToEyeEC = -v_positionEC;\n    materialInput.positionToEyeEC = positionToEyeEC;\n\n    vec3 normalEC = normalize(v_normalEC);\n    materialInput.normalEC = u_normalDirection * normalEC;\n\n    czm_material material = czm_getMaterial(materialInput);\n\n    material.diffuse = u_color.rgb;\n    material.alpha = u_color.a;\n\n    return mix(czm_phong(normalize(positionToEyeEC), material), vec4(material.diffuse, material.alpha), 0.4);\n\n}\n\nbool isOnBoundary(float value, float epsilon)\n{\n    float width = getIntersectionWidth();\n    float tolerance = width * epsilon;\n\n#ifdef GL_OES_standard_derivatives\n    float delta = max(abs(dFdx(value)), abs(dFdy(value)));\n    float pixels = width * delta;\n    float temp = abs(value);\n    // There are a couple things going on here.\n    // First we test the value at the current fragment to see if it is within the tolerance.\n    // We also want to check if the value of an adjacent pixel is within the tolerance,\n    // but we don\'t want to admit points that are obviously not on the surface.\n    // For example, if we are looking for "value" to be close to 0, but value is 1 and the adjacent value is 2,\n    // then the delta would be 1 and "temp - delta" would be "1 - 1" which is zero even though neither of\n    // the points is close to zero.\n    return temp < tolerance && temp < pixels || (delta < 10.0 * tolerance && temp - delta < tolerance && temp < pixels);\n#else\n    return abs(value) < tolerance;\n#endif\n}\n\nvec4 shade(bool isOnBoundary)\n{\n    if (u_showIntersection && isOnBoundary)\n    {\n        return getIntersectionColor();\n    }\n    return getColor(u_radius, v_positionEC);\n}\n\nfloat ellipsoidSurfaceFunction(czm_ellipsoid ellipsoid, vec3 point)\n{\n    vec3 scaled = ellipsoid.inverseRadii * point;\n    return dot(scaled, scaled) - 1.0;\n}\n\nvoid main()\n{\n    vec3 sensorVertexWC = czm_model[3].xyz;      // (0.0, 0.0, 0.0) in model coordinates\n    vec3 sensorVertexEC = czm_modelView[3].xyz;  // (0.0, 0.0, 0.0) in model coordinates\n\n    //vec3 pixDir = normalize(v_position);\n    float positionX = v_position.x;\n    float positionY = v_position.y;\n    float positionZ = v_position.z;\n\n    vec3 zDir = vec3(0.0, 0.0, 1.0);\n    vec3 lineX = vec3(positionX, 0 ,positionZ);\n    vec3 lineY = vec3(0, positionY, positionZ);\n    float resX = dot(normalize(lineX), zDir);\n    if(resX < cos(u_xHalfAngle) - 0.0001){\n        discard;\n    }\n    float resY = dot(normalize(lineY), zDir);\n    if(resY < cos(u_yHalfAngle)- 0.0001){\n        discard;\n    }\n\n\n    czm_ellipsoid ellipsoid = czm_getWgs84EllipsoidEC();\n    float ellipsoidValue = ellipsoidSurfaceFunction(ellipsoid, v_positionWC);\n\n    // Occluded by the ellipsoid?\n\tif (!u_showThroughEllipsoid)\n\t{\n\t    // Discard if in the ellipsoid\n\t    // PERFORMANCE_IDEA: A coarse check for ellipsoid intersection could be done on the CPU first.\n\t    if (ellipsoidValue < 0.0)\n\t    {\n            discard;\n\t    }\n\n\t    // Discard if in the sensor\'s shadow\n\t    if (inSensorShadow(sensorVertexWC, ellipsoid, v_positionWC))\n\t    {\n\t        discard;\n\t    }\n    }\n\n    // Notes: Each surface functions should have an associated tolerance based on the floating point error.\n    bool isOnEllipsoid = isOnBoundary(ellipsoidValue, czm_epsilon3);\n    gl_FragColor = shade(isOnEllipsoid);\n\n}'},4298:e=>{e.exports="attribute vec4 position;\nattribute vec3 normal;\n\nvarying vec3 v_position;\nvarying vec3 v_positionWC;\nvarying vec3 v_positionEC;\nvarying vec3 v_normalEC;\n\nvoid main()\n{\n    gl_Position = czm_modelViewProjection * position;\n    v_position = vec3(position);\n    v_positionWC = (czm_model * position).xyz;\n    v_positionEC = (czm_modelView * position).xyz;\n    v_normalEC = czm_normal * normal;\n}"}},__webpack_module_cache__={},deferred;function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var i=__webpack_module_cache__[e]={id:e,loaded:!1,exports:{}};return __webpack_modules__[e].call(i.exports,i,i.exports,__webpack_require__),i.loaded=!0,i.exports}__webpack_require__.m=__webpack_modules__,deferred=[],__webpack_require__.O=(e,t,i,r)=>{if(!t){var n=1/0;for(l=0;l<deferred.length;l++){for(var[t,i,r]=deferred[l],o=!0,s=0;s<t.length;s++)(!1&r||n>=r)&&Object.keys(__webpack_require__.O).every((e=>__webpack_require__.O[e](t[s])))?t.splice(s--,1):(o=!1,r<n&&(n=r));if(o){deferred.splice(l--,1);var a=i();void 0!==a&&(e=a)}}return e}r=r||0;for(var l=deferred.length;l>0&&deferred[l-1][2]>r;l--)deferred[l]=deferred[l-1];deferred[l]=[t,i,r]},__webpack_require__.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return __webpack_require__.d(t,{a:t}),t},__webpack_require__.d=(e,t)=>{for(var i in t)__webpack_require__.o(t,i)&&!__webpack_require__.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),__webpack_require__.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},__webpack_require__.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),(()=>{var e={83:0};__webpack_require__.O.j=t=>0===e[t];var t=(t,i)=>{var r,n,[o,s,a]=i,l=0;if(o.some((t=>0!==e[t]))){for(r in s)__webpack_require__.o(s,r)&&(__webpack_require__.m[r]=s[r]);if(a)var h=a(__webpack_require__)}for(t&&t(i);l<o.length;l++)n=o[l],__webpack_require__.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return __webpack_require__.O(h)},i=self.webpackChunkgeovisearth=self.webpackChunkgeovisearth||[];i.forEach(t.bind(null,0)),i.push=t.bind(null,i.push.bind(i))})();var __webpack_exports__=__webpack_require__.O(void 0,[255],(()=>__webpack_require__(6389)));__webpack_exports__=__webpack_require__.O(__webpack_exports__)})();